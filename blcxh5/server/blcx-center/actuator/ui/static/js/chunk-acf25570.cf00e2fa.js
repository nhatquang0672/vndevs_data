(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-acf25570"],{"2f95":function(t,e,i){},"333d":function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"pagination-container",class:{hidden:t.hidden}},[i("el-pagination",t._b({attrs:{background:t.background,"current-page":t.currentPage,"page-size":t.pageSize,layout:t.layout,"page-sizes":t.pageSizes,total:t.total},on:{"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e},"update:pageSize":function(e){t.pageSize=e},"update:page-size":function(e){t.pageSize=e},"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}},"el-pagination",t.$attrs,!1))],1)},o=[];i("a9e3");Math.easeInOutQuad=function(t,e,i,n){return t/=n/2,t<1?i/2*t*t+e:(t--,-i/2*(t*(t-2)-1)+e)};var a=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}();function r(t){document.documentElement.scrollTop=t,document.body.parentNode.scrollTop=t,document.body.scrollTop=t}function s(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop}function l(t,e,i){var n=s(),o=t-n,l=20,u=0;e="undefined"===typeof e?500:e;var c=function t(){u+=l;var s=Math.easeInOutQuad(u,n,o,e);r(s),u<e?a(t):i&&"function"===typeof i&&i()};c()}var u={name:"Pagination",props:{total:{required:!0,type:Number},page:{type:Number,default:1},limit:{type:Number,default:20},pageSizes:{type:Array,default:function(){return[10,20,30,50]}},layout:{type:String,default:"total, sizes, prev, pager, next, jumper"},background:{type:Boolean,default:!0},autoScroll:{type:Boolean,default:!0},hidden:{type:Boolean,default:!1}},computed:{currentPage:{get:function(){return this.page},set:function(t){this.$emit("update:page",t)}},pageSize:{get:function(){return this.limit},set:function(t){this.$emit("update:limit",t)}}},methods:{handleSizeChange:function(t){this.$emit("pagination",{page:this.currentPage,limit:t}),this.autoScroll&&l(0,800)},handleCurrentChange:function(t){this.$emit("pagination",{page:t,limit:this.pageSize}),this.autoScroll&&l(0,800)}}},c=u,d=(i("5660"),i("2877")),p=Object(d["a"])(c,n,o,!1,null,"6af373ef",null);e["a"]=p.exports},5660:function(t,e,i){"use strict";i("7a30")},6085:function(t,e,i){"use strict";i.d(e,"b",(function(){return s})),i.d(e,"d",(function(){return l})),i.d(e,"c",(function(){return u})),i.d(e,"a",(function(){return c}));i("d3b7"),i("e9c4"),i("b64b"),i("159b");var n=i("4360"),o=i("5c96"),a=18e5,r="x-session";function s(){var t=n["a"].getters.lastActiveTime,e=(new Date).getTime(),i=e-t>a;return i&&o["MessageBox"].alert("会话过期,请重新登录","Confirm logout",{confirmButtonText:"重新登录",type:"warning",showClose:!1}).then((function(){n["a"].dispatch("user/resetToken").then((function(){location.reload()}))})),i}function l(){return new Promise((function(t,e){e("会话过期,请重新登录")}))}function u(t){t.headers[r]=JSON.stringify({id:n["a"].getters.id,time:n["a"].getters.time,token:n["a"].getters.token,roles:[]})}function c(){return JSON.stringify({id:n["a"].getters.id,time:n["a"].getters.time,token:n["a"].getters.token,roles:[]})}},6724:function(t,e,i){"use strict";i("8d41");var n="@@wavesContext";function o(t,e){function i(i){var n=Object.assign({},e.value),o=Object.assign({ele:t,type:"hit",color:"rgba(0, 0, 0, 0.15)"},n),a=o.ele;if(a){a.style.position="relative",a.style.overflow="hidden";var r=a.getBoundingClientRect(),s=a.querySelector(".waves-ripple");switch(s?s.className="waves-ripple":(s=document.createElement("span"),s.className="waves-ripple",s.style.height=s.style.width=Math.max(r.width,r.height)+"px",a.appendChild(s)),o.type){case"center":s.style.top=r.height/2-s.offsetHeight/2+"px",s.style.left=r.width/2-s.offsetWidth/2+"px";break;default:s.style.top=(i.pageY-r.top-s.offsetHeight/2-document.documentElement.scrollTop||document.body.scrollTop)+"px",s.style.left=(i.pageX-r.left-s.offsetWidth/2-document.documentElement.scrollLeft||document.body.scrollLeft)+"px"}return s.style.backgroundColor=o.color,s.className="waves-ripple z-active",!1}}return t[n]?t[n].removeHandle=i:t[n]={removeHandle:i},i}var a={bind:function(t,e){t.addEventListener("click",o(t,e),!1)},update:function(t,e){t.removeEventListener("click",t[n].removeHandle,!1),t.addEventListener("click",o(t,e),!1)},unbind:function(t){t.removeEventListener("click",t[n].removeHandle,!1),t[n]=null,delete t[n]}},r=function(t){t.directive("waves",a)};window.Vue&&(window.waves=a,Vue.use(r)),a.install=r;e["a"]=a},"7a30":function(t,e,i){},"8d41":function(t,e,i){},"9fe8":function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"app-container"},[i("div",{staticClass:"filter-container"},[i("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-refresh"},on:{click:function(e){return t.getList()}}},[t._v("刷新")]),i("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-plus"},on:{click:t.showAddDialog}},[t._v("新增")])],1),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],attrs:{data:t.list,"row-key":"version",border:""}},[i("el-table-column",{attrs:{align:"center",prop:"version",label:"版本",width:"250"}}),i("el-table-column",{attrs:{align:"center",prop:"items",label:"文件"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return t._l(n.items,(function(e){return i("el-button",{key:e,attrs:{type:"primary",plain:"",closable:"","disable-transitions":!1},on:{click:function(i){return t.showFileListDialog(n.version,e)}}},[t._v(t._s(e))])}))}}])}),i("el-table-column",{attrs:{align:"center",label:"操作",width:"250"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[i("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.showUpdateDialog(n.version)}}},[t._v("修改")]),i("el-button",{attrs:{type:"success"},on:{click:function(e){return t.showUploadDialog(n.version)}}},[t._v("上传")])]}}])})],1),i("pagination",{directives:[{name:"show",rawName:"v-show",value:t.total>0,expression:"total>0"}],attrs:{total:t.total,page:t.listQuery.page,limit:t.listQuery.limit},on:{"update:page":function(e){return t.$set(t.listQuery,"page",e)},"update:limit":function(e){return t.$set(t.listQuery,"limit",e)},pagination:t.getList}}),i("el-dialog",{attrs:{visible:t.versionEditDialogVisible,"close-on-click-modal":!1,width:"50%"},on:{"update:visible":function(e){t.versionEditDialogVisible=e}}},[i("div",[i("el-form",{ref:"form",attrs:{"label-width":"120px"}},[i("el-form-item",{attrs:{label:"版本"}},[i("el-input",{staticStyle:{width:"256px"},model:{value:t.versionEdit.newVersion,callback:function(e){t.$set(t.versionEdit,"newVersion",e)},expression:"versionEdit.newVersion"}})],1),i("el-form-item",{attrs:{label:"复制上版本lib"}},[i("el-switch",{model:{value:t.versionEdit.isCopyLib,callback:function(e){t.$set(t.versionEdit,"isCopyLib",e)},expression:"versionEdit.isCopyLib"}})],1)],1)],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.versionEditDialogVisible=!1}}},[t._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:t.versionSubmit}},[t._v("确 定")])],1)]),i("el-dialog",{attrs:{title:t.versionEdit.version,visible:t.uploadDialogVisible,"close-on-click-modal":!1,width:"50%"},on:{"update:visible":function(e){t.uploadDialogVisible=e}}},[i("div",[t._v(" 选择类型："),i("el-radio-group",{on:{change:t.uploadTypeChange},model:{value:t.uploadType,callback:function(e){t.uploadType=e},expression:"uploadType"}},t._l(t.uploadTypes,(function(t){return i("el-radio-button",{key:t.label,attrs:{label:t.label}})})),1)],1),i("div",{staticStyle:{"margin-top":"10px"}},[i("span",{staticStyle:{"font-weight":"bold"}},[t._v(t._s(t.uploadTypeText))])]),i("div",{staticStyle:{"margin-top":"50px"}},[i("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:t.versionUploadUrl(),"file-list":t.uploadFileList,headers:t.headers,"on-change":t.uploadHandleChange,"on-success":t.uploadHandleSuccess,"auto-upload":!1,multiple:"",drag:""}},[i("i",{staticClass:"el-icon-upload"}),i("div",{staticClass:"el-upload__text"},[t._v("将文件拖到此处，或"),i("em",[t._v("点击上传")])])])],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.uploadDialogVisible=!1}}},[t._v("取 消")]),i("el-button",{attrs:{disabled:t.submitButtonDisabled,type:"primary"},on:{click:t.uploadAction}},[t._v("确 定")])],1)]),i("el-dialog",{attrs:{visible:t.fileListDialogVisible,"close-on-click-modal":!1},on:{"update:visible":function(e){t.fileListDialogVisible=e}}},[i("el-table",{attrs:{data:t.fileList}},[i("el-table-column",{attrs:{prop:"name",label:"文件",width:"380"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[i("el-link",{attrs:{href:t.getLink(n.path),target:"_blank"}},[t._v(t._s(n.name))])]}}])}),i("el-table-column",{attrs:{prop:"lastModified",label:"修改时间",width:"180"}}),i("el-table-column",{attrs:{align:"center",label:"操作",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[i("el-link",{attrs:{icon:"el-icon-delete"},on:{click:function(e){return t.fileDelete(n)}}},[t._v("删除")])]}}])})],1)],1)],1)},o=[],a=(i("498a"),i("c740"),i("a434"),i("d3b7"),i("159b"),i("b0c0"),i("6724")),r=i("e0ac"),s=i("6085"),l=i("333d"),u=i("ed08"),c={directives:{waves:a["a"]},components:{Pagination:l["a"]},data:function(){return{list:[],fileList:[],total:0,listQuery:{limit:50,page:1},listLoading:!1,uploadType:null,uploadTypeText:null,uploadTypes:[{type:"code",label:"工程代码jar包",txt:"工程代码打成jar包上传，名字自定义"},{type:"lib",label:"lib依赖包",txt:"可以上传多个jar文件"},{type:"db_structure",label:"数据库结构语句",txt:"可以上传多个sql文件,一个文件对应一个库"},{type:"db_update",label:"数据库更新语句",txt:"对应上个版本的结构更新SQL,可以上传多个sql文件,一个文件对应一个库"}],versionEdit:{type:null,version:null,newVersion:null,isCopyLib:!0},versionEditDialogVisible:!1,fileListDialogVisible:!1,uploadDialogVisible:!1,submitButtonDisabled:!1,headers:{},uploadFileList:[]}},created:function(){this.getList()},methods:{getList:function(){var t=this;this.listLoading=!0,Object(r["g"])("version/pageList",this.listQuery).then((function(e){t.total=e.total,t.list=e.list,t.listLoading=!1}))},showAddDialog:function(){this.versionEdit.type="add",this.versionEditDialogVisible=!0},showUpdateDialog:function(t){this.versionEdit.version=t,this.versionEdit.newVersion=t,this.versionEdit.type="update",this.versionEditDialogVisible=!0},versionSubmit:function(){var t=this;this.versionEdit.newVersion&&0!==this.versionEdit.newVersion.trim().length?"add"===this.versionEdit.type?Object(r["g"])("version/add",{version:this.versionEdit.newVersion,isCopyLib:this.versionEdit.isCopyLib}).then((function(e){e&&(t.$message.success("添加成功"),t.getList(),t.versionEditDialogVisible=!1)})):Object(r["g"])("version/update",{newVersion:this.versionEdit.newVersion,version:this.versionEdit.version}).then((function(e){e&&(t.$message.success("修改成功"),t.getList(),t.versionEditDialogVisible=!1)})):this.$message.warning("请输入 版本")},tagHandleClose:function(t,e){var i=this;this.$confirm("确定删除【"+t+"】版本中的【"+e+"】文件 ?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(r["g"])("version/itemRemove",{version:t,item:e}).then((function(e){if(e){i.$message.success("删除成功");var n=i.list.findIndex((function(e){return e.version===t}));n>-1&&i.list.splice(n,1,e)}}))}))},showUploadDialog:function(t){this.versionEdit.version=t,this.uploadType=null,this.uploadTypeText=null,this.uploadDialogVisible=!0,this.submitButtonDisabled=!1},versionUploadUrl:function(){return Object(r["f"])()},uploadHandleChange:function(t,e){return this.uploadFileList=e,!0},uploadHandleSuccess:function(t,e,i){var n=this;if(this.uploadFileList=[],this.$refs.upload.clearFiles(),this.submitButtonDisabled=!1,t.result){this.$message.success("上传成功");var o=this.list.findIndex((function(t){return t.version===n.versionEdit.version}));o>-1&&this.list.splice(o,1,t.content)}else this.$message.error("上传失败:"+t.content)},uploadAction:function(){var t=this;return this.uploadType?0===this.uploadFileList.length?(this.$message.error("请选取上传文件"),!1):void this.$confirm("是否更新【"+this.versionEdit.version+"】版本库 ?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){for(var e=null,i=0,n=t.uploadTypes.length;i<n;i++)if(t.uploadType===t.uploadTypes[i].label){e=t.uploadTypes[i].type;break}t.headers["x-session"]=Object(s["a"])(),t.headers["version"]=t.versionEdit.version,t.headers["type"]=e,t.submitButtonDisabled=!0,t.$refs.upload.submit()})):(this.$message.error("请选择类型"),!1)},uploadTypeChange:function(){this.uploadTypeText=null;for(var t=0,e=this.uploadTypes.length;t<e;t++)if(this.uploadType===this.uploadTypes[t].label){this.uploadTypeText=this.uploadTypes[t].txt;break}},showFileListDialog:function(t,e){var i=this;this.fileList=[],this.fileListDialogVisible=!0,Object(r["g"])("version/fileList",{version:t,type:e}).then((function(n){var o=[];n.forEach((function(i){i.version=t,i.versionType=e,i.lastModified=Object(u["f"])(i.lastModified),i.path="/"+t+"/"+e+"/"+i.name,o.push(i)})),i.fileList=o}))},getLink:function(t){return Object(r["e"])()+t+"?t="+Date.now()},fileDelete:function(t){var e=this;this.$confirm("确定删除文件【"+t.name+"】 ?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(r["g"])("version/fileDelete",t.version+"/"+t.versionType+"/"+t.name).then((function(i){e.showFileListDialog(t.version,t.versionType)}))}))}}},d=c,p=(i("aa10"),i("2877")),f=Object(p["a"])(d,n,o,!1,null,null,null);e["default"]=f.exports},aa10:function(t,e,i){"use strict";i("2f95")},e0ac:function(t,e,i){"use strict";i.d(e,"g",(function(){return c})),i.d(e,"d",(function(){return d})),i.d(e,"f",(function(){return p})),i.d(e,"e",(function(){return f})),i.d(e,"c",(function(){return g})),i.d(e,"b",(function(){return v})),i.d(e,"a",(function(){return h}));i("d3b7");var n=i("bc3a"),o=i.n(n),a=i("5c96"),r=i("4360"),s=i("5f87"),l=i("6085"),u=o.a.create({baseURL:"http://127.0.0.1:9503/actuator/",timeout:5e3});function c(t,e){return Object(l["b"])()?Object(l["d"])():new Promise((function(i,n){u({url:t,method:"POST",data:e}).then((function(t){r["a"].dispatch("user/active",r["a"].getters.token),i(t)})).catch((function(t){n(t)}))}))}function d(){return"http://127.0.0.1:9503/actuator/hotUpdate/upload"}function p(){return"http://127.0.0.1:9503/actuator/version/upload"}function f(){return"http://127.0.0.1:9503/actuator/resource/version"}function g(){return"http://127.0.0.1:9503/actuator/deployment/templateUpload"}function v(){return"http://127.0.0.1:9503/actuator/resource/deployment"}function h(){return"http://127.0.0.1:9503/actuator/client/upload"}u.interceptors.request.use((function(t){return r["a"].getters.token&&(t.headers["X-Token"]=Object(s["a"])()),Object(l["c"])(t),t}),(function(t){return console.log(t),Promise.reject(t)})),u.interceptors.response.use((function(t){var e=t.data;return e.result||null===e.content?e.content:("string"===typeof e&&(e=JSON.parse(e)),Object(a["Message"])({message:e.content||"Error",type:"error",duration:5e3}),Promise.reject(new Error(e.content||"Error")))}),(function(t){return console.log("err"+t),Object(a["Message"])({message:t.message,type:"error",duration:5e3}),Promise.reject(t)}))},e9c4:function(t,e,i){var n=i("23e7"),o=i("d066"),a=i("d039"),r=o("JSON","stringify"),s=/[\uD800-\uDFFF]/g,l=/^[\uD800-\uDBFF]$/,u=/^[\uDC00-\uDFFF]$/,c=function(t,e,i){var n=i.charAt(e-1),o=i.charAt(e+1);return l.test(t)&&!u.test(o)||u.test(t)&&!l.test(n)?"\\u"+t.charCodeAt(0).toString(16):t},d=a((function(){return'"\\udf06\\ud834"'!==r("\udf06\ud834")||'"\\udead"'!==r("\udead")}));r&&n({target:"JSON",stat:!0,forced:d},{stringify:function(t,e,i){var n=r.apply(null,arguments);return"string"==typeof n?n.replace(s,c):n}})}}]);