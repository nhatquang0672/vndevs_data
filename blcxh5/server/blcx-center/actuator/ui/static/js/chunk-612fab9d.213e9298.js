(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-612fab9d"],{"32e4":function(t,e,n){},5167:function(t,e,n){"use strict";n("32e4")},6085:function(t,e,n){"use strict";n.d(e,"b",(function(){return s})),n.d(e,"d",(function(){return l})),n.d(e,"c",(function(){return c})),n.d(e,"a",(function(){return u}));n("d3b7"),n("e9c4"),n("b64b"),n("159b");var a=n("4360"),i=n("5c96"),o=18e5,r="x-session";function s(){var t=a["a"].getters.lastActiveTime,e=(new Date).getTime(),n=e-t>o;return n&&i["MessageBox"].alert("会话过期,请重新登录","Confirm logout",{confirmButtonText:"重新登录",type:"warning",showClose:!1}).then((function(){a["a"].dispatch("user/resetToken").then((function(){location.reload()}))})),n}function l(){return new Promise((function(t,e){e("会话过期,请重新登录")}))}function c(t){t.headers[r]=JSON.stringify({id:a["a"].getters.id,time:a["a"].getters.time,token:a["a"].getters.token,roles:[]})}function u(){return JSON.stringify({id:a["a"].getters.id,time:a["a"].getters.time,token:a["a"].getters.token,roles:[]})}},6724:function(t,e,n){"use strict";n("8d41");var a="@@wavesContext";function i(t,e){function n(n){var a=Object.assign({},e.value),i=Object.assign({ele:t,type:"hit",color:"rgba(0, 0, 0, 0.15)"},a),o=i.ele;if(o){o.style.position="relative",o.style.overflow="hidden";var r=o.getBoundingClientRect(),s=o.querySelector(".waves-ripple");switch(s?s.className="waves-ripple":(s=document.createElement("span"),s.className="waves-ripple",s.style.height=s.style.width=Math.max(r.width,r.height)+"px",o.appendChild(s)),i.type){case"center":s.style.top=r.height/2-s.offsetHeight/2+"px",s.style.left=r.width/2-s.offsetWidth/2+"px";break;default:s.style.top=(n.pageY-r.top-s.offsetHeight/2-document.documentElement.scrollTop||document.body.scrollTop)+"px",s.style.left=(n.pageX-r.left-s.offsetWidth/2-document.documentElement.scrollLeft||document.body.scrollLeft)+"px"}return s.style.backgroundColor=i.color,s.className="waves-ripple z-active",!1}}return t[a]?t[a].removeHandle=n:t[a]={removeHandle:n},n}var o={bind:function(t,e){t.addEventListener("click",i(t,e),!1)},update:function(t,e){t.removeEventListener("click",t[a].removeHandle,!1),t.addEventListener("click",i(t,e),!1)},unbind:function(t){t.removeEventListener("click",t[a].removeHandle,!1),t[a]=null,delete t[a]}},r=function(t){t.directive("waves",o)};window.Vue&&(window.waves=o,Vue.use(r)),o.install=r;e["a"]=o},"8a79":function(t,e,n){"use strict";var a=n("23e7"),i=n("06cf").f,o=n("50c4"),r=n("5a34"),s=n("1d80"),l=n("ab13"),c=n("c430"),u="".endsWith,d=Math.min,p=l("endsWith"),f=!c&&!p&&!!function(){var t=i(String.prototype,"endsWith");return t&&!t.writable}();a({target:"String",proto:!0,forced:!f&&!p},{endsWith:function(t){var e=String(s(this));r(t);var n=arguments.length>1?arguments[1]:void 0,a=o(e.length),i=void 0===n?a:d(o(n),a),l=String(t);return u?u.call(e,l,i):e.slice(i-l.length,i)===l}})},"8d41":function(t,e,n){},b406:function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"app-container"},[n("div",{staticStyle:{"margin-left":"50px","margin-bottom":"20px"}},[n("div",[t._v("部署文件使用 "),n("el-tag",{attrs:{type:"info"}},[t._v("velocity 1.7")]),t._v(" 文件格式")],1),n("div",{staticStyle:{margin:"5px 0"}},[t._v("服相关参数有： "),n("el-tag",{attrs:{type:"info"}},[t._v("服ID ${serverId}")]),n("el-tag",{attrs:{type:"info"}},[t._v("服名称 ${serverName}")]),n("el-tag",{attrs:{type:"info"}},[t._v("服主机 ${serverHost}")]),n("el-tag",{attrs:{type:"info"}},[t._v("服渠道 ${serverChannel}")])],1),n("div",[t._v("Socket启动端口可以根据${serverId}为变量设置，如："),n("el-tag",{attrs:{type:"info"}},[t._v("#set($serverPort = ${serverId} + 1000)")])],1),n("div",{staticStyle:{margin:"5px 0"}},[t._v("JVM启动参数有： "),n("el-tag",{attrs:{type:"info"}},[t._v("启动内存 ${Xmx}")]),n("el-tag",{attrs:{type:"info"}},[t._v("最大内存 ${Xms}")]),n("el-tag",{attrs:{type:"info"}},[t._v("新生代内存 ${Xmn}")]),n("el-tag",{attrs:{type:"info"}},[t._v("每线程内存 ${Xss}")])],1),n("div",[t._v("根目录下必须有："),n("el-tag",{attrs:{type:"info"}},[t._v("startup.sh")]),n("el-tag",{attrs:{type:"info"}},[t._v("shutdown.sh")]),n("el-tag",{attrs:{type:"info"}},[t._v("deploy.sh")])],1)]),n("el-card",{staticClass:"box-card"},[n("div",{staticClass:"filter-container"},[n("el-button-group",t._l(t.paths,(function(e){return n("el-button",{key:e.path,staticClass:"filter-item",attrs:{disabled:t.listLoading},on:{click:function(n){return t.goto(e.path)}}},[t._v(t._s(e.name)),n("i",{staticClass:"el-icon-arrow-right el-icon--right"})])})),1),n("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",staticStyle:{"margin-left":"50px"},attrs:{type:"primary",icon:"el-icon-folder-opened"},on:{click:function(e){t.addFolderDialogVisible=!0}}},[t._v("新建文件夹")]),n("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",staticStyle:{"margin-left":"25px"},attrs:{type:"primary",icon:"el-icon-upload"},on:{click:t.showUploadDialog}},[t._v("上传")]),n("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"25px"},attrs:{type:"success",icon:"el-icon-files"},on:{click:t.effective}},[t._v("部署生效")])],1),n("div",{staticStyle:{"margin-left":"50px"}},[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],attrs:{data:t.list,"row-key":"version"}},[n("el-table-column",{attrs:{prop:"name",label:"文件",width:"350"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[1===a.type?n("el-link",{attrs:{href:t.getLink(a.path),target:"_blank"}},[t._v(t._s(a.name))]):n("el-link",{attrs:{icon:"el-icon-folder-opened"},on:{click:function(e){return t.goto(a.path)}}},[t._v(t._s(a.name))])]}}])}),n("el-table-column",{attrs:{prop:"lastModified",label:"修改时间",width:"200"}}),n("el-table-column",{attrs:{align:"center",label:"操作",width:"500"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return["../"!==a.name?n("el-link",{attrs:{icon:"el-icon-delete"},on:{click:function(e){return t.deleteOne(a)}}},[t._v("删除")]):t._e()]}}])})],1)],1),n("el-dialog",{attrs:{title:"新建文件夹",visible:t.addFolderDialogVisible,"close-on-click-modal":!1,width:"50%"},on:{"update:visible":function(e){t.addFolderDialogVisible=e}}},[n("div",[n("span",{staticStyle:{"font-size":"14px","font-weight":"bold","padding-right":"5px"}},[t._v(t._s(t.path.length>1?t.path+"/":t.path))]),n("el-input",{staticStyle:{width:"256px"},attrs:{placeholder:"请输入 文件夹"},model:{value:t.folderName,callback:function(e){t.folderName=e},expression:"folderName"}})],1),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.addFolderDialogVisible=!1}}},[t._v("取 消")]),n("el-button",{attrs:{type:"primary"},on:{click:t.addFolder}},[t._v("确 定")])],1)]),n("el-dialog",{attrs:{visible:t.uploadDialogVisible,"close-on-click-modal":!1,width:"50%"},on:{"update:visible":function(e){t.uploadDialogVisible=e}}},[n("div",[n("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:t.deploymentUploadUrl(),"file-list":t.uploadFileList,headers:t.headers,"on-change":t.uploadHandleChange,"on-success":t.uploadHandleSuccess,"auto-upload":!1,multiple:"",drag:""}},[n("i",{staticClass:"el-icon-upload"}),n("div",{staticClass:"el-upload__text"},[t._v("将文件拖到此处，或"),n("em",[t._v("点击上传")])])])],1),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.uploadDialogVisible=!1}}},[t._v("取 消")]),n("el-button",{attrs:{disabled:t.submitButtonDisabled,type:"primary"},on:{click:t.uploadAction}},[t._v("确 定")])],1)])],1)],1)},i=[],o=(n("8a79"),n("d3b7"),n("159b"),n("b0c0"),n("498a"),n("6724")),r=n("e0ac"),s=n("6085"),l=n("ed08"),c={directives:{waves:o["a"]},components:{},data:function(){return{path:"/",paths:[],list:[],folderName:null,listLoading:!1,addFolderDialogVisible:!1,uploadDialogVisible:!1,submitButtonDisabled:!1,headers:{},uploadFileList:[]}},created:function(){this.getList()},methods:{getList:function(){var t=this;this.listLoading=!0,this.getPaths(),Object(r["g"])("deployment/templateList",this.path).then((function(e){var n=[],a=t.path.endsWith("/")?t.path:t.path+"/";if("/"!==a){var i=a.lastIndexOf("/"),o=a.substring(0,i);i=o.lastIndexOf("/"),o=i>0?o.substring(0,i):"/",n.push({name:"../",path:o,lastModified:null,type:2})}e.forEach((function(t){2===t.type&&(t.path=a+t.name,t.lastModified=Object(l["f"])(t.lastModified),n.push(t))})),e.forEach((function(t){1===t.type&&(t.path=a+t.name,t.lastModified=Object(l["f"])(t.lastModified),n.push(t))})),t.list=n,t.listLoading=!1}))},getPaths:function(){var t=[{name:"根目录",path:"/"}],e=this.path.split("/"),n="";e.forEach((function(e){e.length>0&&(n+="/"+e,t.push({name:e,path:n}))})),this.paths=t},goto:function(t){this.path=t,this.getList()},getLink:function(t){return Object(r["b"])()+t+"?t="+Date.now()},showUploadDialog:function(){this.uploadDialogVisible=!0,this.submitButtonDisabled=!1},deploymentUploadUrl:function(){return Object(r["c"])()},uploadHandleChange:function(t,e){return this.uploadFileList=e,!0},uploadHandleSuccess:function(t,e,n){this.uploadFileList=[],this.$refs.upload.clearFiles(),this.submitButtonDisabled=!1,t.result&&(this.getList(),this.$message.success("上传成功"))},uploadAction:function(){if(0===this.uploadFileList.length)return this.$message.error("请选取上传文件"),!1;this.headers["x-session"]=Object(s["a"])(),this.headers["path"]=encodeURIComponent(this.path),this.submitButtonDisabled=!0,this.$refs.upload.submit()},deleteOne:function(t){var e=this;this.$confirm("是否删除文件 【"+t.name+"】?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(r["g"])("deployment/templateDelete",t.path).then((function(t){e.$message.success("删除成功"),e.getList()})).catch((function(){e.$message.error("如果删除文件夹，先清除该文件夹下面的所有文件")}))}))},addFolder:function(){var t=this;if(!this.folderName||0===this.folderName.trim().length)return this.$message.error("请输入文件夹名称"),!1;var e=(this.path.length>1?this.path+"/":this.path)+this.folderName;Object(r["g"])("deployment/templateAddFolder",e).then((function(e){t.$message.success("操作成功"),t.getList(),t.addFolderDialogVisible=!1}))},effective:function(){var t=this;this.$confirm("确定生效?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(r["g"])("deployment/templateEffective").then((function(e){t.$message.success("删除成功")}))}))}}},u=c,d=(n("5167"),n("2877")),p=Object(d["a"])(u,a,i,!1,null,null,null);e["default"]=p.exports},e0ac:function(t,e,n){"use strict";n.d(e,"g",(function(){return u})),n.d(e,"d",(function(){return d})),n.d(e,"f",(function(){return p})),n.d(e,"e",(function(){return f})),n.d(e,"c",(function(){return h})),n.d(e,"b",(function(){return g})),n.d(e,"a",(function(){return v}));n("d3b7");var a=n("bc3a"),i=n.n(a),o=n("5c96"),r=n("4360"),s=n("5f87"),l=n("6085"),c=i.a.create({baseURL:"http://127.0.0.1:9503/actuator/",timeout:5e3});function u(t,e){return Object(l["b"])()?Object(l["d"])():new Promise((function(n,a){c({url:t,method:"POST",data:e}).then((function(t){r["a"].dispatch("user/active",r["a"].getters.token),n(t)})).catch((function(t){a(t)}))}))}function d(){return"http://127.0.0.1:9503/actuator/hotUpdate/upload"}function p(){return"http://127.0.0.1:9503/actuator/version/upload"}function f(){return"http://127.0.0.1:9503/actuator/resource/version"}function h(){return"http://127.0.0.1:9503/actuator/deployment/templateUpload"}function g(){return"http://127.0.0.1:9503/actuator/resource/deployment"}function v(){return"http://127.0.0.1:9503/actuator/client/upload"}c.interceptors.request.use((function(t){return r["a"].getters.token&&(t.headers["X-Token"]=Object(s["a"])()),Object(l["c"])(t),t}),(function(t){return console.log(t),Promise.reject(t)})),c.interceptors.response.use((function(t){var e=t.data;return e.result||null===e.content?e.content:("string"===typeof e&&(e=JSON.parse(e)),Object(o["Message"])({message:e.content||"Error",type:"error",duration:5e3}),Promise.reject(new Error(e.content||"Error")))}),(function(t){return console.log("err"+t),Object(o["Message"])({message:t.message,type:"error",duration:5e3}),Promise.reject(t)}))},e9c4:function(t,e,n){var a=n("23e7"),i=n("d066"),o=n("d039"),r=i("JSON","stringify"),s=/[\uD800-\uDFFF]/g,l=/^[\uD800-\uDBFF]$/,c=/^[\uDC00-\uDFFF]$/,u=function(t,e,n){var a=n.charAt(e-1),i=n.charAt(e+1);return l.test(t)&&!c.test(i)||c.test(t)&&!l.test(a)?"\\u"+t.charCodeAt(0).toString(16):t},d=o((function(){return'"\\udf06\\ud834"'!==r("\udf06\ud834")||'"\\udead"'!==r("\udead")}));r&&a({target:"JSON",stat:!0,forced:d},{stringify:function(t,e,n){var a=r.apply(null,arguments);return"string"==typeof a?a.replace(s,u):a}})}}]);