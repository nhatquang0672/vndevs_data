window.__require=function t(e,r,o){function n(a,l){if(!r[a]){if(!e[a]){var s=a.split("/");if(s=s[s.length-1],!e[s]){var c="function"==typeof __require&&__require;if(!l&&c)return c(s,!0);if(i)return i(s,!0);throw new Error("Cannot find module '"+a+"'")}a=s}var u=r[a]={exports:{}};e[a][0].call(u.exports,function(t){return n(e[a][1][t]||t)},u,u.exports,t,e,r,o)}return r[a].exports}for(var i="function"==typeof __require&&__require,a=0;a<o.length;a++)n(o[a]);return n}({ActivityObjectList:[function(t,e,r){"use strict";cc._RF.push(e,"d90e1C9OgBKtoa7/GzeIEh6","ActivityObjectList");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.ActivityObjectList=void 0;var s=t("../../../../framework/FW"),c=t("../../../../framework/base/ScriptObject"),u=t("../../../../framework/container/Container"),p=t("../../../../framework/event/EventProxy"),f=t("../../../../framework/utils/Toolset"),h=t("./ActivityObject"),y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tmIdActivityObject=new Map,e.eventProxy=new p.EventProxy,e}return n(e,t),e.prototype.InitEnumKind=function(t){this.kind=t},e.prototype.EnterWrap=function(){this.toolSet||(this.toolSet=f.ToolSet.createToolSet()),this.Enter_cor()},e.prototype.ExitWrap=function(){var t,e;this.Exit_cor();try{for(var r=a(this.tmIdActivityObject),o=r.next();!o.done;o=r.next()){var n=l(o.value,2),i=(n[0],n[1]);this.RemoveActivityObjectById(i.GetId())}}catch(s){t={error:s}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}this.toolSet&&(f.ToolSet.destroyToolSet(this.toolSet),this.toolSet=null)},e.prototype.GetActivityObjectById=function(t){return this.tmIdActivityObject.get(t)},e.prototype.RemoveActivityObjectById=function(t){var e=this.tmIdActivityObject.get(t);return!!e&&(this.tmIdActivityObject.set(t,null),this.eventProxy.execute("OnRemove",t),e=null,!0)},e.prototype.AddActivityObject=function(t){var e=t.GetId();null==this.tmIdActivityObject.get(e)&&(this.tmIdActivityObject.set(e,t),this.eventProxy.execute("OnAdd",t))},e.prototype.Enter_cor=function(){var t=this,e=this.ModelVO.ActivityBag.GetEventProxy();this.toolSet.addListener(e,"OnAdd",function(e){var r=t.GetOrCreateActivityObject(e);r&&t.eventProxy.execute("OnAdd",r)}),this.toolSet.addListener(e,"OnUpdate",function(e){var r=t.GetOrCreateActivityObject(e);r&&t.eventProxy.execute("OnUpdate",r)}),this.toolSet.addListener(e,"OnRemove",function(e){t.RemoveActivityObjectById(e.GetId())}),this.ModelVO.ActivityBag.BagFilter(function(e){return t.GetOrCreateActivityObject(e),!1})},e.prototype.Exit_cor=function(){},e.prototype.GetOrCreateActivityObject=function(t){var e=this;if(t.GetActivityKind()==this.kind){var r=this.GetActivityObjectById(t.GetId());if(r)r.SetData(t);else{(r=new h.ActivityObject).SetAOList(this),r.SetData(t),u.Container.inst().inject(r),this.AddActivityObject(r);var o=r.GetExpr();o?this.toolSet.AddScriptListener(o,function(){var t=s.FW.ExprMgr.GetResult(o);r.SetResult(t),e.eventProxy.execute("OnUpdate",r)},this):r.SetResult(!0)}return r}},e.prototype.ActivityObjectFilter=function(t){var e,r;try{for(var o=a(this.tmIdActivityObject),n=o.next();!n.done;n=o.next()){var i=l(n.value,2),s=i[0];if(t(i[1],s))return}}catch(c){e={error:c}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}},e.__cname="ActivityObjectList",i([u.injectField("ModelVO")],e.prototype,"ModelVO",void 0),e}(c.ScriptObject);r.ActivityObjectList=y,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/base/ScriptObject":void 0,"../../../../framework/container/Container":void 0,"../../../../framework/event/EventProxy":void 0,"../../../../framework/utils/Toolset":void 0,"./ActivityObject":"ActivityObject"}],ActivityObjectSubset:[function(t,e,r){"use strict";cc._RF.push(e,"6813fbjTFRFjZoHtSFkvz6q","ActivityObjectSubset");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.ActivityObjectSubset=void 0;var l=t("../../../../framework/base/ScriptObject"),s=t("../../../../framework/event/EventProxy"),c=t("../../../../framework/utils/Toolset"),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tlAO=null,e.tmAO=null,e.toolSet=c.ToolSet.createToolSet(),e.tmActivityObjectList=new Map,e.eventProxy=new s.EventProxy,e.filter=null,e.isDirty=!0,e.isDispatchDirty=!1,e}return n(e,t),e.prototype.Init=function(t,e){var r=this;this.tmActivityObjectList=t,this.toolSet.addListener(e,"OnAdd",function(t){r.OnAdd(t)}),this.toolSet.addListener(e,"OnRemove",function(t){r.OnRemove(t)}),this.toolSet.addListener(e,"OnUpdate",function(t){r.OnUpdate(t)})},e.prototype.onDestroy=function(){if(this.disposeCallback)try{this.disposeCallback()}catch(t){}this.tmAO=null,this.tlAO=null,this.eventProxy.destroy(),c.ToolSet.destroyToolSet(this.toolSet)},e.prototype.SetDisposeCallback=function(t){return this.disposeCallback=t,this},e.prototype.OnTimerUpdate=function(){this.isDispatchDirty&&(this.isDispatchDirty=!1,this.eventProxy.execute("OnChanged"))},e.prototype.InitTmAO=function(){var t,e,r=this;this.tmAO=new Map;var o=this.tmAO;try{for(var n=i(this.tmActivityObjectList),l=n.next();!l.done;l=n.next()){var s=a(l.value,2);s[0],s[1].ActivityObjectFilter(function(t){return null!=r.filter&&r.filter(t)&&o.set(t.GetId(),t),!1})}}catch(c){t={error:c}}finally{try{l&&!l.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}},e.prototype.FindActivityObject=function(t){var e,r;try{for(var o=i(this.tmActivityObjectList),n=o.next();!n.done;n=o.next()){var l=a(n.value,2),s=(l[0],l[1].GetActivityObjectById(t));if(null!=s)return s}}catch(c){e={error:c}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return null},e.prototype.GetFilterObject=function(t){var e=this.FindActivityObject(t);return e&&null!=this.filter&&this.filter(e)?e:null},e.prototype.MarkDirty=function(){this.isDirty=!0,this.MarkDispatchDirty()},e.prototype.MarkDispatchDirty=function(){this.isDispatchDirty=!0},e.prototype.GetEventProxy=function(){return this.eventProxy},e.prototype.GetTlAO=function(){var t,e,r=this;if(this.isDirty){this.tlAO=[];var o=this.tlAO;try{for(var n=i(this.tmActivityObjectList),l=n.next();!l.done;l=n.next()){var s=a(l.value,2);s[0],s[1].ActivityObjectFilter(function(t){return null!=r.filter&&r.filter(t)&&o.push(t),!1})}}catch(c){t={error:c}}finally{try{l&&!l.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.sorter&&o.sort(function(t,e){return r.sorter(t,e)}),this.isDirty=!1}return this.tlAO},e.prototype.GetOne=function(){return this.tlAO||this.GetTlAO(),this.tlAO[0]},e.prototype.OnAdd=function(t){this.filter?(!(this.tmAO&&null!=t)&&this.filter(t)&&this.tmAO.set(t.GetId(),t),this.MarkDirty(),this.eventProxy.execute("OnAdd",t)):this.MarkDirty()},e.prototype.OnRemove=function(t){this.filter?(this.tmAO&&null!=this.tmAO.get(t)&&this.tmAO.set(t,null),this.MarkDirty(),this.eventProxy.execute("OnRemove",t)):this.MarkDirty()},e.prototype.OnUpdate=function(t){if(this.filter){var e=this.tmAO&&null!=t;if(e){var r=this.filter(t);!r!=!e?(this.tmAO.set(t.GetId(),t),this.MarkDirty()):r&&this.MarkDispatchDirty(),this.eventProxy.execute("OnUpdate",t)}}else this.MarkDirty()},e.prototype.SetFilter=function(t){this.filter=t,this.MarkDirty(),this.InitTmAO()},e.prototype.SetSorter=function(t){this.sorter=t,null!=t&&this.MarkDirty()},e.__cname="ActivityObjectSubset",e}(l.ScriptObject);r.ActivityObjectSubset=u,cc._RF.pop()},{"../../../../framework/base/ScriptObject":void 0,"../../../../framework/event/EventProxy":void 0,"../../../../framework/utils/Toolset":void 0}],ActivityObject:[function(t,e,r){"use strict";cc._RF.push(e,"ce129PXkchJ17hgKbmalVFf","ActivityObject");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.ActivityObject=void 0;var a=t("../../../../framework/base/ScriptObject"),l=t("../../../../framework/container/Container"),s=t("../../../../framework/dataBinder/DataBinder"),c=t("../../../../framework/event/EventProxy"),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.eventProxy=new c.EventProxy,e.result=!1,e.dataBinder=new s.DataBinder,e}return n(e,t),e.prototype.GetEventProxy=function(){return this.eventProxy},e.prototype.SetAOList=function(t){this.aoList=t},e.prototype.GetAOList=function(){return this.aoList},e.prototype.SetResult=function(t){this.result=t,this.eventProxy.execute("OnChanged")},e.prototype.GetResult=function(){return this.result},e.prototype.SetData=function(t){return this.dataBinder.set(t),this.eventProxy.execute("OnChanged"),this},e.prototype.GetData=function(){return this.dataBinder.get()},e.prototype.GetVOActivity=function(){return this.GetData()},e.prototype.GetId=function(){return this.GetData().GetId()},e.prototype.GetName=function(){return this.GetData().GetName()},e.prototype.GetIcon=function(){return this.GetData().GetIcon()},e.prototype.GetEffect=function(){return this.GetData().GetEffect()},e.prototype.GetBelond=function(){return this.GetData().GetBelond()},e.prototype.GetStartTime=function(){return this.GetData().GetStartTime()},e.prototype.GetEndTime=function(){return this.GetData().GetEndTime()},e.prototype.GetAwardTime=function(){return this.GetData().GetAwardTime()},e.prototype.GetDeTail=function(){return this.GetData().GetDeTail()},e.prototype.GetExpr=function(){return this.GetData().GetExpr()},e.prototype.GetCanShow=function(){var t=1e3*this.TimeUtil.now(),e=this.GetData().GetStartTime(),r=this.GetData().GetEndTime(),o=this.GetData().GetAwardTime();this.log("\u6d3b\u52a8id:"+this.GetData().GetId()),this.log("\u6d3b\u52a8Refid:"+this.GetData().GetRefId()),this.log("\u6d3b\u52a8\u5f53\u524d\u65f6\u95f4\uff1a"+t),this.log("\u6d3b\u52a8\u5f00\u59cb\u65f6\u95f4\uff1a"+e),this.log("\u6d3b\u52a8\u7ed3\u675f\u65f6\u95f4\uff1a"+r);var n=this.GetResult();return e<=t&&o>=t&&n},e.prototype.GetOrder=function(){return this.GetData().GetOrder()},e.prototype.GetActivityKind=function(){return this.GetData().GetActivityKind()},e.__cname="ActivityObject",i([l.injectField("TimeUtil")],e.prototype,"TimeUtil",void 0),e}(a.ScriptObject);r.ActivityObject=u,cc._RF.pop()},{"../../../../framework/base/ScriptObject":void 0,"../../../../framework/container/Container":void 0,"../../../../framework/dataBinder/DataBinder":void 0,"../../../../framework/event/EventProxy":void 0}],AppBridge:[function(t,e,r){"use strict";cc._RF.push(e,"9ef871v6t1Cd7MjKnRaqJcu","AppBridge");var o=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a},n=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(o(arguments[e]));return t};Object.defineProperty(r,"__esModule",{value:!0}),r.AppBridge=r.AppBridgeEvent=void 0;var i=t("../../framework/event/EventProxy"),a=t("../../framework/FW");(function(t){t.OnPause="OnPause",t.OnResume="OnResume"})(r.AppBridgeEvent||(r.AppBridgeEvent={}));var l=function(){function t(){}return Object.defineProperty(t,"eventProxy",{get:function(){return this._eventProxy||(this._eventProxy=new i.EventProxy)},enumerable:!1,configurable:!0}),t.CallJSBridge=function(t,e,r,o){console.log("CallJSBridge",t,e,r,o),this.eventProxy.execute(t,e,r,o)},t.JavaCallStatic=function(t,e){for(var r,o=[],i=2;i<arguments.length;i++)o[i-2]=arguments[i];var a=o.map(function(t){return null==t?'""':t}),l="com/fn/app/JavaProxy";return console.log(" : "+l+" "+t+"["+e+"] params:"+a),(r=jsb.reflection).callStaticMethod.apply(r,n([l,t,e],a))},t.ShowAlert=function(t,e,r){this.eventProxy.removeEvent("ShowAlert"),this.eventProxy.add("ShowAlert",function(){r()}),this.JavaCallStatic("ShowAlert","(Ljava/lang/String;Ljava/lang/String;)V",t,e)},t.OpenUrl=function(t){return this.JavaCallStatic("OpenUrl","(Ljava/lang/String)Z",t)},t.GetSDKInited=function(){return this.JavaCallStatic("GetSDKInited","()Z")},t.SDKExitGame=function(){this.JavaCallStatic("SDKExitGame","()V")},t.SDKLogin=function(t,e){this.eventProxy.removeEvent("SDKLogin"),this.eventProxy.add("SDKLogin",function(t,r){e("true"==t,r)}),this.JavaCallStatic("SDKLogin","(Ljava/lang/String;)V",t)},t.SDKHasLogout=function(){return this.JavaCallStatic("SDKHasLogout","()Z")},t.SDKLogout=function(t){this.eventProxy.removeEvent("SDKLogout"),this.eventProxy.add("SDKLogout",function(e){t("true"==e)}),this.JavaCallStatic("SDKLogout","()V")},t.SDKHasPay=function(){return this.JavaCallStatic("SDKHasPay","()Z")},t.SDKPay=function(t,e){this.eventProxy.removeEvent("SDKPay"),this.eventProxy.add("SDKPay",function(t,r){e("true"==t,r)}),this.JavaCallStatic("SDKPay","(Ljava/lang/String;)V",t)},t.SDKRedeemGift=function(t,e){this.eventProxy.removeEvent("SDKRedeemGift"),this.eventProxy.add("SDKRedeemGift",function(t){e("true"==t)}),this.JavaCallStatic("SDKRedeemGift","(Ljava/lang/String;)V",t)},t.ReportTrackEvent=function(t,e){this.JavaCallStatic("ReportTrackEvent","(Ljava/lang/String;Ljava/lang/String;)V",t,e)},t.ReportTrackEventByJson=function(t){this.JavaCallStatic("ReportTrackEvent","(Ljava/lang/String;)V",t)},t.SDKShowAd=function(t,e){this.eventProxy.removeEvent("SDKShowAd"),this.eventProxy.add("SDKShowAd",function(t){var r="true"==t;a.FW.Log.log("SDKShowAd success:"+r),e(r)}),this.JavaCallStatic("SDKShowAd","(Ljava/lang/String;)V",t)},t.AddEventListener=function(t,e,r){var o=function(){e.call(r)},n={event:t,caller:r,listener:o,eventProxy:this.eventProxy};return this.eventProxy.addListener(t,r,o),n},t.RemoveEventListener=function(t){this.eventProxy.removeListener(t.event,t.caller,t.listener)},t.__cname="AppBridge",t.FW=a.FW,t}();r.AppBridge=l,cc._RF.pop()},{"../../framework/FW":void 0,"../../framework/event/EventProxy":void 0}],AppCustomData:[function(t,e,r){"use strict";cc._RF.push(e,"ab625OB+3xJqaSci1HlCUMH","AppCustomData");var o=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},n=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.AppCustomData=void 0;var i=t("../../../../../ConstFork"),a=t("../../../../AppStep/AppFirstInfo"),l=t("../../../../engine/EngineMain"),s=t("../../../../engine/ResourceMgr"),c=t("../../../../framework/base/ScriptObject"),u=t("../../../../framework/container/Container"),p=t("../../../../framework/fork/Fork"),f=t("../../../../framework/utils/HttpLoader"),h=t("../../../../framework/utils/StringUtil"),y=t("../../../../framework/utils/WxUtil"),d=t("../../ctrl/DataReporting/DataReportingInterface"),m=t("../../ctrl/sdk/ConstSDK"),v=t("./AppCustomInfo"),_=function(){function t(){this.fileName="version.json",this.fork=i.FORK_DEFAULT}return Object.defineProperty(t,"instance",{get:function(){var e=this._instance;return null==e&&(e=new t,this._instance=e),e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"backstageurl",{get:function(){return this._backstageurl},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"url",{get:function(){return this._url},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"channel",{get:function(){return this._channel},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"channelCode",{get:function(){return this._channelCode},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"clientVersion",{get:function(){return this._clientVersion},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"serverVersion",{get:function(){return this._serverVersion},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"versionCode",{get:function(){return this._versionCode},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sdkType",{get:function(){return this._sdkType||m.SdkTypeEnum.YouaiSDK},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"defaultSdkType",{get:function(){return m.SdkTypeEnum.YouaiSDK},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isEdit",{get:function(){return!(l.EngineMain.isMiniGameWeiXin&&y.WxUtil.isRelease()||"1"!=this._editType)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"audit",{get:function(){return(!l.EngineMain.isMiniGameWeiXin||!y.WxUtil.isRelease())&&(this._audit||!1)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"gameId",{get:function(){return this._gameId||0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"plateInfo",{get:function(){return this._plateInfo||""},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isWss",{get:function(){return this._isWss||!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isNeiWang",{get:function(){return this._isNeiWang||!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"apkUrl",{get:function(){return this._apkUrl},enumerable:!1,configurable:!0}),t.prototype.GetFork=function(){return this.fork},Object.defineProperty(t.prototype,"errorId",{get:function(){if(null==this._errorId){var e=l.EngineMain.os+t.instance.channelCode+Math.floor(Date.now());this._errorId=l.EngineMain.readLocalStorage("errorId",e)}return this._errorId},enumerable:!1,configurable:!0}),t.prototype.init=function(){return o(this,void 0,void 0,function(){var t,e,r,o,i,m,_,S,g,b;return n(this,function(n){switch(n.label){case 0:return(t=u.Container.inst().getByAlias("DataReporting")).PushBuriedList(d.SingleBuriedPointType.start_load_local_version),e=this,[4,s.ResourceMgr.loadJson(e.fileName)];case 1:return(r=n.sent())?(console.log("local version data :",JSON.stringify(r)),e._clientVersion=r.version,o=v.AppCustomInfo,i=r.index,i=null!=o.versionFlag?o.versionFlag:a.AppFirstInfo.fixVersionFlag(i,r.tl,o.appFlag),e._versionFlag=i,e._isNeiWang=i.indexOf("internal")>=0,m=r.fork,p.ForkMgr.instance.Has(m)&&(e.fork=m),t.PushBuriedList(d.SingleBuriedPointType.end_load_local_version),t.PushBuriedList(d.SingleBuriedPointType.start_request_server_data),_=h.StringUtil.format("http://127.0.0.1:99/{0}.json",e._versionFlag),[4,f.HttpLoader.RequestJson(_,!0)]):(console.error("initVersion fail",e.fileName),[2]);case 2:return S=n.sent(),g=S.json.gameConfig,console.log(g.name),e._backstageurl=o.backstageurl||g.backstageurl,e._url=o.url||g.url,l.EngineMain.isMiniGameWeiXin&&!y.WxUtil.isRelease()&&(e._url=g.tsUrl),e._channel=o.channel||g.channel,e._channelCode=g.channelCode,e._serverVersion=g.version,(b=g.versionCode)||(b=0),e._versionCode=parseInt(b),e._sdkType=o.sdkType||g.sdkType,console.log("AppCustomData t.sdkType:",e.sdkType),e._editType=g.edit,c.ScriptObject.editLog=!1,e._audit=g.audit,e._gameId=g.gameId,e._plateInfo=g.plateInfo,e._isWss=g.isWss,e._apkUrl=g.apkUrl,t.PushBuriedList(d.SingleBuriedPointType.end_request_server_data),[2]}})})},t.prototype.isNeedDownloadApk=function(){if(l.EngineMain.isNative){var t=this.clientVersion,e=this.serverVersion,r=t.split("."),o=e.split(".");if(console.log("\u5ba2\u6237\u7aef\u7248\u672c\uff1a",t),console.log("\u540e\u53f0\u7248\u672c\uff1a",e),r[1]<o[1])return!0}return!1},t.__cname="AppCustomData",t}();r.AppCustomData=_,cc._RF.pop()},{"../../../../../ConstFork":void 0,"../../../../AppStep/AppFirstInfo":void 0,"../../../../engine/EngineMain":void 0,"../../../../engine/ResourceMgr":void 0,"../../../../framework/base/ScriptObject":void 0,"../../../../framework/container/Container":void 0,"../../../../framework/fork/Fork":void 0,"../../../../framework/utils/HttpLoader":void 0,"../../../../framework/utils/StringUtil":void 0,"../../../../framework/utils/WxUtil":void 0,"../../ctrl/DataReporting/DataReportingInterface":"DataReportingInterface","../../ctrl/sdk/ConstSDK":"ConstSDK","./AppCustomInfo":"AppCustomInfo"}],AppCustomInfo:[function(t,e,r){"use strict";cc._RF.push(e,"87fc1FERqZClIwQ/tZB/edf","AppCustomInfo"),Object.defineProperty(r,"__esModule",{value:!0}),r.AppCustomInfo=void 0;var o=function(){function t(){}return t.appFlag="def",t.versionFlag=null,t.sdkType=null,t.customVersionName="0.0.0",t.customVersionCode=0,t.statusHeight=0,t.barHeight=0,t.packageName="",t.appName="",t.appVersionName="",t.appVersionCode="",t.systemName="",t.systemVersion="",t.manufacturer="",t.deviceModel="",t.channel=null,t.url=null,t.backstageurl=null,t.bgUrl=null,t.logoUrl=null,t}();r.AppCustomInfo=o,cc._RF.pop()},{}],AppGloaderEx:[function(t,e,r){"use strict";cc._RF.push(e,"07361PVkb1E5Ix1dpmD0qzr","AppGloaderEx");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.AppGloaderEx=void 0;var i=t("../../../framework/container/Container"),a=t("../../../framework/fgui/gloader/GLoaderEx"),l=t("../../../framework/FW"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),Object.defineProperty(e.prototype,"Ref",{get:function(){return i.Container.inst().getByAlias("Ref")},enumerable:!1,configurable:!0}),e.prototype.SetUrlByIcon=function(e){if(null!=e){var r=this.Ref.RefMgricon.getRef("key",e);return r?t.prototype.SetUrl.call(this,r.path):(l.FW.Log.error("iconRef\u8868\u627e\u4e0d\u5230\u8be5\u56fe\u6807key:",e),t.prototype.SetUrl.call(this,null))}t.prototype.SetUrl.call(this,null)},e.prototype.SetUrlByModel=function(e){var r=this.Ref.RefMgrmodelRef.getRef("key",e);return r?t.prototype.SetUrl.call(this,r.path):(l.FW.Log.error("model\u8868\u627e\u4e0d\u5230\u8be5\u8d44\u6e90key:",e),t.prototype.SetUrl.call(this,null))},e.prototype.SeturlByTest=function(e){var r=this.Ref.RefMgricon.getRef("key",e);return r?t.prototype.TestUrl.call(this,r.path):(l.FW.Log.error("iconRef\u8868\u627e\u4e0d\u5230\u8be5\u56fe\u6807key:",e),t.prototype.SetUrl.call(this,null))},e.__cname="AppGloaderEx",e}(a.GLoaderEx);r.AppGloaderEx=s,cc._RF.pop()},{"../../../framework/FW":void 0,"../../../framework/container/Container":void 0,"../../../framework/fgui/gloader/GLoaderEx":void 0}],AppMain:[function(t,e,r){"use strict";cc._RF.push(e,"47b0aND6mBLA6jrLyo9aeUH","AppMain");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0});var a=t("./App"),l=cc._decorator,s=l.ccclass,c=(l.property,l.help),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.frameworkUpdate=function(){},e}return n(e,t),e.prototype.onLoad=function(){},e.prototype.start=function(){this.frameworkUpdate=window.frameworkUpdate,window.frameworkUpdate=null,delete window.frameworkUpdate,(new a.App).start()},e.prototype.update=function(t){t*=1e3,this.frameworkUpdate(t)},i([s,c("https://www.cocos.com/docs")],e)}(cc.Component);r.default=u,cc._RF.pop()},{"./App":"App"}],App:[function(t,e,r){"use strict";cc._RF.push(e,"fcd91KTEQBHypsIsh+oz1p+","App");var o=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},n=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},i=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.App=void 0;var l=t("../../ConstFork"),s=t("../engine/EngineMain"),c=t("../engine/ResourceMgr"),u=t("../framework/container/Container"),p=t("../framework/fork/Fork"),f=t("../framework/FrameworkInit"),h=t("../framework/Func"),y=t("../framework/FW"),d=t("../framework/layer/PopLayerMgr"),m=t("../framework/log/Log"),v=t("../framework/utils/WxUtil"),_=t("./bridge/AppBridge"),S=t("./game/ctrl/CtrlMgr"),g=t("./game/ctrl/DataReporting/DataReporting"),b=t("./game/ctrl/DataReporting/DataReportingInterface"),C=t("./game/ctrl/DataReporting/helper/DataReportingHelperMgr"),R=t("./game/ctrl/DataReporting/SDKDataReporting"),M=t("./game/ctrl/sdk/SDKMgr"),w=t("./game/fguiExtend/FguiExtendMgr"),O=t("./game/gamestate/GameStateMgr"),B=t("./game/model/ModelMgr"),P=t("./game/model/public/AppCustomData"),G=t("./net/CacheMgr"),k=t("./net/NetMgr"),x=t("./newScreenAdapter"),T=t("./ref/Ref"),j=t("./utils/OnOff/OnOffMgr"),I=t("./utils/TimeUtil");p.ForkMgr.instance.Register(l.FORK_BLCX),p.ForkMgr.instance.Register(l.FORK_SGTG),p.ForkMgr.instance.Use(l.FORK_DEFAULT);var D=function(){function t(){}return t.prototype.start=function(){try{this.startInner()}catch(t){t&&y.FW.Log.error(t.message)}},t.prototype.startInner=function(){return o(this,void 0,void 0,function(){var t,e,r,o,l,p,f,h,w,x,D,F,L,E,A,V,U,W,H,N,q,K,X,z;return n(this,function(n){switch(n.label){case 0:return u.Container.inst().collectClass(G.CacheMgr),u.Container.inst().collectClass(S.CtrlMgr),u.Container.inst().collectClass(B.ModelMgr),u.Container.inst().collectObj(M.SDKMgr.instance),u.Container.inst().collectClass(g.DataReporting),u.Container.inst().collectClass(R.SDKDataReporting),u.Container.inst().collectObj(C.DataReportingHelperMgr.instance),u.Container.inst().collectObj(O.GameStateMgr.instance),u.Container.inst().collectObj(P.AppCustomData.instance),u.Container.inst().collectObj(k.NetMgr.instance),u.Container.inst().collectObj(k.NetMgr.instance.get(u.Container.inst()),"Net"),u.Container.inst().collectClass(T.default),u.Container.inst().collectClass(I.TimeUtil),u.Container.inst().collectClass(j.OnOffMgr),u.Container.inst().collectClass(d.PopLayerMgr),u.Container.inst().start(),t=u.Container.inst().get("DataReportingHelperMgr"),e=cc.sys.platform,[4,t.createDataReportingHelper(e)];case 1:return n.sent(),(r=u.Container.inst().getByAlias("DataReporting")).PushBuriedList(b.SingleBuriedPointType.open_game),[4,P.AppCustomData.instance.init()];case 2:return n.sent(),this.fitScreen(),[4,this.loadRuntimeConfig()];case 3:return n.sent(),r.PushBuriedList(b.SingleBuriedPointType.start_load_game_framework),[4,this.loadFramework()];case 4:return n.sent(),r.PushBuriedList(b.SingleBuriedPointType.end_load_game_framework),r.PushBuriedList(b.SingleBuriedPointType.start_load_ui_config),[4,c.ResourceMgr.initConfig()];case 5:return n.sent(),r.PushBuriedList(b.SingleBuriedPointType.end_load_ui_config),[4,u.Container.inst().getByClass(T.default).RefMgraudioConfig.preloadRef()];case 6:n.sent(),r.PushBuriedList(b.SingleBuriedPointType.start_fgui_load_package),(o=[]).push(y.FW.FairyMgr.loadByPkgNameAsync("font",!0)),o.push(y.FW.FairyMgr.loadByPkgNameAsync("\u5171\u7528\u52a0\u8f7d\u4e2d",!0)),o.push(y.FW.FairyMgr.loadByPkgNameAsync("\u5171\u7528_\u5b57\u4f53",!0)),r.PushBuriedList(b.SingleBuriedPointType.end_fgui_load_package),l=P.AppCustomData.instance.url+"/center/clientLog",p=P.AppCustomData.instance.errorId,f=P.AppCustomData.instance.gameId,y.FW.ErrorLogMgr.InitData(l,p,f),y.FW.Log.setErrorCallback(function(t,e){y.FW.ErrorLogMgr.PushError(t,e)}),this.initFWFunc(),h=u.Container.inst().get("ModelMgr"),w=h.ModelPublicData.appCustomData,x=w.sdkType,D=u.Container.inst().get("SDKMgr"),console.log("sdkType: "+x),n.label=7;case 7:return n.trys.push([7,9,,11]),[4,D.createSDK(x)];case 8:return n.sent(),[3,11];case 9:return F=n.sent(),y.FW.Log.error(F),[4,D.createSDK(w.defaultSdkType)];case 10:return n.sent(),[3,11];case 11:if(r.PushBuriedList(b.SingleBuriedPointType.start_check_res_version),L=P.AppCustomData.instance.apkUrl,P.AppCustomData.instance.isNeedDownloadApk()&&null!=L&&""!=L)return E=y.FW.G_W("\u63d0\u793a"),A=y.FW.G_W("\u53d1\u73b0\u65b0\u7248\u672c\uff0c\u70b9\u51fb\u8df3\u8f6c\u66f4\u65b0"),_.AppBridge.ShowAlert(E,A,function(){cc.sys.openURL(L)}),[2];r.PushBuriedList(b.SingleBuriedPointType.end_check_res_version),V=s.EngineMain.getFPSFrameRate(),cc.game.setFrameRate(V),s.EngineMain.setFpsWeixinIosStop(),U=!s.EngineMain.isNative&&s.EngineMain.isBrowser&&P.AppCustomData.instance.isEdit&&P.AppCustomData.instance.isNeiWang,cc.debug.setDisplayStats(U),m.Log.editLog=P.AppCustomData.instance.isEdit,y.FW.Log.log("==---==="),W=u.Container.inst().getByAlias("OnOffMgr");try{for(H=i(m.Log.tmLogsss),N=H.next();!N.done;N=H.next())q=a(N.value,2),K=q[0],q[1],K!=m.LOG_MAIN_NAME&&W.CreateLogOnOff(K)}catch(J){X={error:J}}finally{try{N&&!N.done&&(z=H.return)&&z.call(H)}finally{if(X)throw X.error}}return y.FW.Log.log("==---==="),s.EngineMain.isMiniGameWeiXin?[4,v.WxUtil.CheckForUpdate()]:[3,13];case 12:n.sent(),n.label=13;case 13:return y.FW.Log.log(""),y.FW.Log.log(cc.game.config),y.FW.Log.log("==---==="),y.FW.Log.log("ENGINE_VERSION: ",cc.ENGINE_VERSION),y.FW.Log.log("\u663e\u793a\u5e27\u7387: ",cc.debug.isDisplayStats()),y.FW.Log.log("\u5e27\u7387: ",cc.game.getFrameRate()),y.FW.Log.log("\u5206\u8fa8\u7387: ",cc.view.getFrameSize()),y.FW.Log.log("sys.os: ",cc.sys.os),y.FW.Log.log("platform: "+cc.sys.platform),y.FW.Log.log("languageCode: ",cc.sys.languageCode),y.FW.Log.log("language: ",cc.sys.language),y.FW.Log.log("\u5fae\u4fe1-IOS\u9ad8\u6027\u80fd\u6a21\u5f0f",v.WxUtil.isIOSHighPerformanceMode),y.FW.Log.log("==---==="),[4,Promise.all(o)];case 14:return n.sent(),O.GameStateMgr.instance.startup(),[2]}})})},t.prototype.loadRuntimeConfig=function(){return o(this,void 0,void 0,function(){var t,e,r;return n(this,function(){return window.location?(t=window.location.protocol,e=window.location.host,r=window.location.port,s.EngineMain.isBrowser&&"9020"==r&&(y.FW.refPath=t+"//"+e+"/ref/",y.FW.isRemoteRef=!0,y.FW.Log.log('\u5185\u7f51\u4fee\u6539\u914d\u7f6e\u8868\u5730\u5740: FW.refPath = "'+y.FW.refPath+'"')),[2]):[2]})})},t.prototype.parseUrl=function(){if(!window.location)return null;var t=window.location.href.split("?");return 0==t.length?null:t.reduce(function(t,e){var r=e.split("=");return t[r[0]]=r[1],t},{})},t.prototype.loadFramework=function(){return o(this,void 0,void 0,function(){var t;return n(this,function(e){switch(e.label){case 0:return window.preload_img?[4,new Promise(function(t){cc.resources.load("res/previewImg",function(e,r){e&&(r=null),t(r)})})]:[3,2];case 1:e.sent(),e.label=2;case 2:return t=u.Container.inst().getByAlias("DataReporting"),fgui.UIConfig.buttonSoundCustom="\u767e\u604b_\u70b9\u51fb",t.PushBuriedList(b.SingleBuriedPointType.start_fw_init),y.FW.init(),t.PushBuriedList(b.SingleBuriedPointType.end_fw_init),t.PushBuriedList(b.SingleBuriedPointType.start_fgui_init),[4,f.FrameworkInit.initFgui()];case 3:return e.sent(),t.PushBuriedList(b.SingleBuriedPointType.end_fgui_init),w.default.initFguiExtend(),[2]}})})},t.prototype.fitScreen=function(){var t;if(s.EngineMain.isFullPhone=x.default.isFullPhone,x.default.resizeCallback=function(){s.EngineMain.isFullPhone=x.default.isFullPhone,y.FW.FWEvent.dispatchViewResizeEvent()},s.EngineMain.isMiniGameWeiXin||s.EngineMain.isPC){var e=70;return s.EngineMain.liuhaiHeight=e,void console.log("liuhaiHeight: ",s.EngineMain.liuhaiHeight)}if(s.EngineMain.isFullPhone){var r=s.EngineMain.readLocalStorage("liuhaiHeight");console.log("localLiuhaiHeight: ",r),null!=r&&(null==(t=h.Func.toNum(r))||t<0)&&(t=null),e=44,null!=t?(console.log("customLiuHai: ",t),e=t):(s.EngineMain.isMiniGameWeiXin?s.EngineMain.isPC&&(e=0):s.EngineMain.isMiniGameVivo?e=97:s.EngineMain.isBrowser&&(e=0),e=70),null==e?e=44:e>100?e=100:e<0&&(e=0),s.EngineMain.liuhaiHeight=e}console.log("liuhaiHeight: ",s.EngineMain.liuhaiHeight)},t.prototype.initFWFunc=function(){y.FW.showTip=function(t){u.Container.inst().getByAlias("LayerMessage").addMessage(t)},y.FW.showLoading=function(){var t=u.Container.inst().getByAlias("CtrlAlert");0==t.LayerWaiting.isLoad&&t.LayerWaiting.load(),t.LayerWaiting.setVisible(!0)},y.FW.removeLoading=function(){u.Container.inst().getByAlias("CtrlAlert").LayerWaiting.setVisible(!1)},y.FW.playSound=function(t){u.Container.inst().getByAlias("CtrlAudio").PlaySound(t)},y.FW.CacheMgr=u.Container.inst().get("CacheMgr")},t.__cname="App",t}();r.App=D,cc._RF.pop()},{"../../ConstFork":void 0,"../engine/EngineMain":void 0,"../engine/ResourceMgr":void 0,"../framework/FW":void 0,"../framework/FrameworkInit":void 0,"../framework/Func":void 0,"../framework/container/Container":void 0,"../framework/fork/Fork":void 0,"../framework/layer/PopLayerMgr":void 0,"../framework/log/Log":void 0,"../framework/utils/WxUtil":void 0,"./bridge/AppBridge":"AppBridge","./game/ctrl/CtrlMgr":"CtrlMgr","./game/ctrl/DataReporting/DataReporting":"DataReporting","./game/ctrl/DataReporting/DataReportingInterface":"DataReportingInterface","./game/ctrl/DataReporting/SDKDataReporting":"SDKDataReporting","./game/ctrl/DataReporting/helper/DataReportingHelperMgr":"DataReportingHelperMgr","./game/ctrl/sdk/SDKMgr":"SDKMgr","./game/fguiExtend/FguiExtendMgr":"FguiExtendMgr","./game/gamestate/GameStateMgr":"GameStateMgr","./game/model/ModelMgr":"ModelMgr","./game/model/public/AppCustomData":"AppCustomData","./net/CacheMgr":"CacheMgr","./net/NetMgr":"NetMgr","./newScreenAdapter":"newScreenAdapter","./ref/Ref":"Ref","./utils/OnOff/OnOffMgr":"OnOffMgr","./utils/TimeUtil":"TimeUtil"}],AttrWrapHandler:[function(t,e,r){"use strict";cc._RF.push(e,"9e768GxF95HoKs5sHKFcyW9","AttrWrapHandler");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.AttrWrapHandler=void 0;var s=t("../../../../framework/base/ScriptObject"),c=t("../../../../framework/container/Container"),u=t("../../../../framework/event/EventCallback"),p=t("../../../../framework/FW"),f=t("./AttrWrap"),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tmAttr=new Map,e.ChangeCallback=new u.EventCallback,e._temp=new f.AttrWrap,e}return n(e,t),e.prototype.onDestroy=function(){this.ChangeCallback.destroy()},e.prototype.GetTmAttr=function(){return this.tmAttr},e.prototype.GetChangeCallback=function(){return this.ChangeCallback},e.prototype.CreateAttr=function(t){if(!this.tmAttr.has(t)){var e=new f.AttrWrap;return this.tmAttr.set(t,e),e}},e.prototype.ModifyByResId=function(t,e){var r=this.ModelAttr.GetRefRoleAttribute(t);if(null!=r){var o=r.ParseValue(e);"\u56fa\u5b9a\u503c"==r.GetType()?this.ModifyAttr(r.GetKey(),o,0):"\u767e\u5206\u6bd4"==r.GetType()?this.ModifyAttr(r.GetKey(),0,o):"\u4f5c\u7528\u503c"==r.GetType()&&this.ModifyAttr(r.GetKey(),0,0,e)}else p.FW.ZJJ.warn("\u5c5e\u6027\u4e0d\u5b58\u5728:"+t)},e.prototype.ModifyAttr=function(t,e,r,o){void 0===e&&(e=0),void 0===r&&(r=0);var n=this.tmAttr.get(t);if(null!=n){var i=n.GetValue();o?n.setEffectId(o):(n.base+=e,n.rate+=r);var a=n.GetValue();(0!=e||0!=r||o)&&this.ChangeCallback.execute(t,a,i)}else p.FW.ZJJ.warn("\u5c5e\u6027\u503c\u672a\u6ce8\u518c\uff1a:"+t)},e.prototype.MarkChange=function(){this.ChangeCallback.execute()},e.prototype.GetAttr=function(t){return this.tmAttr.get(t)},e.prototype.Dump=function(){var t,e,r="";try{for(var o=a(this.tmAttr),n=o.next();!n.done;n=o.next()){var i=l(n.value,2),s=i[0],c=i[1];0==c.base&&0==c.rate&&0==c.addition||(r+=s+":"+c.GetValue()+"("+c.base+", "+c.addition+", "+c.rate+");")}}catch(u){t={error:u}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}p.FW.ZJJ.log("attr dump:",r)},e.prototype.CalAttr=function(t,e){return this.CalAttrAdd(t,e)},e.prototype.CalAttrAdd=function(t,e){var r=this.GetAttr(t),o=e;if(r){var n=this._temp;n.Clear(),n.AddAttr(r),n.base+=e,o=n.GetValue()}return o},e.__cname="AttrWrapHandler",i([c.injectField("ModelAttr")],e.prototype,"ModelAttr",void 0),e}(s.ScriptObject);r.AttrWrapHandler=h,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/base/ScriptObject":void 0,"../../../../framework/container/Container":void 0,"../../../../framework/event/EventCallback":void 0,"./AttrWrap":"AttrWrap"}],AttrWrap:[function(t,e,r){"use strict";cc._RF.push(e,"ae624bedG5HKaiUvi8YoYFH","AttrWrap"),Object.defineProperty(r,"__esModule",{value:!0}),r.AttrWrap=void 0;var o=function(){function t(){this.base=0,this.addition=0,this.rate=0,this.ids=[],this.extraAdd=0}return t.prototype.GetValue=function(){return(this.base+this.addition)*(1+this.rate*(1+this.extraAdd))},t.prototype.Clear=function(){this.base=0,this.addition=0,this.rate=0},t.prototype.AddAttr=function(t){this.base+=t.base,this.addition+=t.addition,this.rate+=t.rate,this.extraAdd+=t.extraAdd},t.prototype.Dump=function(){return this.GetValue()},t.prototype.Equal=function(t){return this.base==t.base&&this.addition==t.addition&&this.rate==t.rate},t.prototype.setEffectId=function(t){this.ids.includes(t)||this.ids.push(t)},t.prototype.getEffectId=function(t){return this.ids.includes(t)},t.prototype.setExtraAdd=function(t){this.extraAdd=t},t}();r.AttrWrap=o,cc._RF.pop()},{}],BL_LayerMain:[function(t,e,r){"use strict";cc._RF.push(e,"f1001UZcnxHC5xuJ0teVTjQ","BL_LayerMain");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.BL_LayerMain=void 0;var a=t("../../../../../ConstFork"),l=t("../../../../framework/fork/Fork"),s=t("../../../game/ctrl/main/LayerMain"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.xxx=function(){console.log("fff: blcx")},e.__cname="BL_LayerMain",i([l.forkClass(s.LayerMain,a.FORK_BLCX)],e)}(s.LayerMain);r.BL_LayerMain=c,cc._RF.pop()},{"../../../../../ConstFork":void 0,"../../../../framework/fork/Fork":void 0,"../../../game/ctrl/main/LayerMain":"LayerMain"}],BOBagSubset:[function(t,e,r){"use strict";cc._RF.push(e,"e827ffPLNVH/IYyPI9+dVt4","BOBagSubset");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.BOBagSubset=void 0;var i=t("../../../../../../framework/base/ScriptObject"),a=t("../../../../../../framework/event/EventProxy"),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.eventProxy=new a.EventProxy,e.tlbo=[],e}return n(e,t),e.prototype.onDestroy=function(){this._onDestroyCallback&&this._onDestroyCallback(),t.prototype.onDestroy.call(this)},e.prototype.SetDestroyCallback=function(t){this._onDestroyCallback=t},e.prototype.GetEventProxy=function(){return this.eventProxy},e.prototype.GetTlBO=function(){return this.tlbo},e.__cname="BOBagSubset",e}(i.ScriptObject);r.BOBagSubset=l,cc._RF.pop()},{"../../../../../../framework/base/ScriptObject":void 0,"../../../../../../framework/event/EventProxy":void 0}],BOBag:[function(t,e,r){"use strict";cc._RF.push(e,"56e4cSBn+hIKpFtQpvvpuf6","BOBag");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.BOBag=void 0;var i=t("../../../../../../framework/base/ScriptObject"),a=t("./BOBagSubset"),l=function(t){function e(e){var r=t.call(this)||this;return r.tmSubset=new Map,r.tlBO=[],r.bag=new Map,r.container=e,r.OnInit(),r}return n(e,t),e.prototype.Enter=function(){this.OnEnter()},e.prototype.Exit=function(){this.OnExit()},e.prototype.OnInit=function(){},e.prototype.OnEnter=function(){},e.prototype.OnExit=function(){},e.prototype.CreteSubset=function(){var t=this,e=new a.BOBagSubset;return this.tmSubset.set(e,e),e.SetDestroyCallback(function(){t.tmSubset.set(e,null)}),e},e.prototype.DestroySubset=function(t){this.assert(this.tmSubset.has(t),"\u5220\u9664\u4e0d\u5b58\u5728\u7684bosubset"),t.destroy()},e.prototype.GetBag=function(){return this.bag},e.prototype.Add=function(){},e.__cname="BOBag",e}(i.ScriptObject);r.BOBag=l,cc._RF.pop()},{"../../../../../../framework/base/ScriptObject":void 0,"./BOBagSubset":"BOBagSubset"}],BOMgr:[function(t,e,r){"use strict";cc._RF.push(e,"74c02crWk1ORoJNez0EGwMi","BOMgr");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.BOSystem=void 0;var l=t("../../../../../../framework/container/Container"),s=function(t){function e(e){var r=t.call(this)||this;return r.tlBag=[],r.container=e,r}return n(e,t),e.prototype.onStart=function(){var t,e;try{for(var r=a(this.tlBag),o=r.next();!o.done;o=r.next()){var n=o.value;this.container.inject(n),n.Enter()}}catch(i){t={error:i}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},e.prototype.onDestroy=function(){var e,r,o,n;try{for(var i=a(this.tlBag),l=i.next();!l.done;l=i.next()){var s=l.value;this.container.inject(s),s.Exit()}}catch(p){e={error:p}}finally{try{l&&!l.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}try{for(var c=a(this.tlBag),u=c.next();!u.done;u=c.next())s=u.value,this.container.inject(s),s.destroy()}catch(f){o={error:f}}finally{try{u&&!u.done&&(n=c.return)&&n.call(c)}finally{if(o)throw o.error}}this.tlBag.length=0,t.prototype.onDestroy.call(this)},e.prototype.GetTlBag=function(){return this.GetTlBag},e.prototype.CreateBag=function(t){var e=new t(this.container);return this.tlBag.push(e),e},e.__cname="BOMgr",i([l.injectField("Ref")],e.prototype,"Ref",void 0),e}(t("../BaseLogicSystem").BaseLogicSystem);r.BOSystem=s,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../BaseLogicSystem":"BaseLogicSystem"}],BO:[function(t,e,r){"use strict";cc._RF.push(e,"d149fxhkjhBrLTzZTY0Fdw6","BO");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.BO=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnInit=function(){},e.prototype.OnEnter=function(){},e.prototype.OnExit=function(){},e.__cname="BO",e}(t("../../../../../../framework/base/ScriptObject").ScriptObject);r.BO=i,cc._RF.pop()},{"../../../../../../framework/base/ScriptObject":void 0}],BPropBoom:[function(t,e,r){"use strict";cc._RF.push(e,"fff7e4otohAp5dDHoyKHQgB","BPropBoom");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.BPropBoom=void 0;var a=t("../../../../../../framework/container/Container"),l=t("./BProp"),s=t("./SystemCommon"),c=function(t){function e(){return t.call(this,s.EBProp.BOOM)||this}return n(e,t),e.prototype.OnAdd=function(){},e.prototype.OnDelete=function(){},e.prototype.Pick=function(){this.SystemEvent.sendKillMonsterBoom(),this.SystemEvent.sendShake()},e.__cname="BPropBoom",i([a.injectField("SystemCommon")],e.prototype,"SystemCommon",void 0),i([a.injectField("Battle")],e.prototype,"Battle",void 0),i([a.injectField("SystemEvent")],e.prototype,"SystemEvent",void 0),e}(l.BProp);r.BPropBoom=c,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"./BProp":"BProp","./SystemCommon":"SystemCommon"}],BPropExpBall:[function(t,e,r){"use strict";cc._RF.push(e,"4a513SB5FpAv62TmFrZjwtH","BPropExpBall");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.BPropExpBall=void 0;var a=t("../../../../../../framework/container/Container"),l=t("./BProp"),s=t("./SystemCommon"),c=function(t){function e(){return t.call(this,s.EBProp.EXPBALL)||this}return n(e,t),e.prototype.OnAdd=function(){},e.prototype.OnDelete=function(){},e.prototype.Pick=function(t){var e=this.params.get(t);this.ComVar.takeExp(e)},e.__cname="BPropExpBall",i([a.injectField("ComVar")],e.prototype,"ComVar",void 0),e}(l.BProp);r.BPropExpBall=c,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"./BProp":"BProp","./SystemCommon":"SystemCommon"}],BPropGoldChest:[function(t,e,r){"use strict";cc._RF.push(e,"bba06rcSmtOdbO8nBKPc5Pa","BPropGoldChest");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.BPropGoldChest=void 0;var a=t("../../../../../../framework/container/Container"),l=t("./BProp"),s=t("./SystemCommon"),c=function(t){function e(){return t.call(this,s.EBProp.GOLD_CHEST)||this}return n(e,t),e.prototype.OnAdd=function(){},e.prototype.OnDelete=function(){},e.prototype.Pick=function(t){var e=this.ComVar.HEROID;if(this.ComVar.ALIVE[e]&&0==this.GPGameover.getGameState()){var r=this.params.get(t);this.SystemEvent.sendGoldChest(r)}},e.__cname="BPropGoldChest",i([a.injectField("ComVar")],e.prototype,"ComVar",void 0),i([a.injectField("SystemEvent")],e.prototype,"SystemEvent",void 0),i([a.injectField("GPGameover")],e.prototype,"GPGameover",void 0),e}(l.BProp);r.BPropGoldChest=c,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"./BProp":"BProp","./SystemCommon":"SystemCommon"}],BPropGold:[function(t,e,r){"use strict";cc._RF.push(e,"35f88VnHmlP5qct6q9XKzfP","BPropGold");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.BPropGold=void 0;var a=t("../../../../../../framework/container/Container"),l=t("./BProp"),s=t("./SystemCommon"),c=function(t){function e(){return t.call(this,s.EBProp.GOLD)||this}return n(e,t),e.prototype.OnAdd=function(){},e.prototype.OnDelete=function(){},e.prototype.Pick=function(t){var e=this.params.get(t);this.ComVar.takeGold(e)},e.__cname="BPropGold",i([a.injectField("ComVar")],e.prototype,"ComVar",void 0),e}(l.BProp);r.BPropGold=c,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"./BProp":"BProp","./SystemCommon":"SystemCommon"}],BPropItem:[function(t,e,r){"use strict";cc._RF.push(e,"119afKrABFNA793NC67udTu","BPropItem");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.BPropItem=void 0;var a=t("../../../../../../framework/container/Container"),l=t("./BProp"),s=t("./SystemCommon"),c=function(t){function e(){return t.call(this,s.EBProp.ITEM)||this}return n(e,t),e.prototype.GetModel=function(){var t;return null===(t=this.ref)||void 0===t?void 0:t.modelKey},e.prototype.GetModel2=function(){var t;return null===(t=this.ref)||void 0===t?void 0:t.modelKey},e.prototype.OnAdd=function(){},e.prototype.OnDelete=function(){},e.prototype.Pick=function(){},e.__cname="BPropItem",i([a.injectField("SystemCommon")],e.prototype,"SystemCommon",void 0),i([a.injectField("Battle")],e.prototype,"Battle",void 0),i([a.injectField("SystemEvent")],e.prototype,"SystemEvent",void 0),e}(l.BProp);r.BPropItem=c,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"./BProp":"BProp","./SystemCommon":"SystemCommon"}],BPropMagnet:[function(t,e,r){"use strict";cc._RF.push(e,"607e9zqEfpBA7MxV9VWLxFl","BPropMagnet");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.BPropMagnet=void 0;var a=t("../../../../../../framework/container/Container"),l=t("./BProp"),s=t("./SystemCommon"),c=function(t){function e(){return t.call(this,s.EBProp.MAGNET)||this}return n(e,t),e.prototype.OnAdd=function(){},e.prototype.OnDelete=function(){},e.prototype.Pick=function(){this.SystemCommon.pickAllOfType(s.EBProp.EXPBALL),this.Battle.startConfig.superMagnet&&this.SystemCommon.pickAllOfType(s.EBProp.GOLD)},e.__cname="BPropMagnet",i([a.injectField("SystemCommon")],e.prototype,"SystemCommon",void 0),i([a.injectField("Battle")],e.prototype,"Battle",void 0),e}(l.BProp);r.BPropMagnet=c,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"./BProp":"BProp","./SystemCommon":"SystemCommon"}],BPropRestore:[function(t,e,r){"use strict";cc._RF.push(e,"ebcaaAX4v5CObPdTJQdwYhP","BPropRestore");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.BPropRestore=void 0;var a=t("../../../../../../framework/container/Container"),l=t("./BProp"),s=t("./SystemCommon"),c=function(t){function e(){return t.call(this,s.EBProp.RESTORE)||this}return n(e,t),e.prototype.OnAdd=function(){},e.prototype.OnDelete=function(){},e.prototype.Pick=function(t){var e=this.ComVar.HEROID,r=this.params.get(t),o=this.ComVar.HP_Max[e];r=Math.floor(.3*o),r=this.ComVar.CalAttr(e,"rfb",r),r=this.ComVar.CalAttr(e,"rfp",r),this.ComVar.takeRestore(e,r),this.SystemViewEffect.AddEffectEntity("\u767e\u604b_\u6218\u6597\u573a\u666f\u7279\u6548_\u56de\u8840",this.ComVar.HEROREF,!1,!0)},e.__cname="BPropRestore",i([a.injectField("ComVar")],e.prototype,"ComVar",void 0),i([a.injectField("SystemViewEffect")],e.prototype,"SystemViewEffect",void 0),e}(l.BProp);r.BPropRestore=c,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"./BProp":"BProp","./SystemCommon":"SystemCommon"}],BPropSkillChest:[function(t,e,r){"use strict";cc._RF.push(e,"0b1dccGl11HOJjD7dOR5fQB","BPropSkillChest");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.BPropSkillChest=void 0;var a=t("../../../../../../framework/container/Container"),l=t("../../view/nodeproxy/NodeProxy"),s=t("./BProp"),c=t("./SystemCommon"),u=function(t){function e(){return t.call(this,c.EBProp.SKILL_CHEST)||this}return n(e,t),e.prototype.OnAdd=function(){},e.prototype.OnDelete=function(){},e.prototype.Pick=function(t){var e=this.ComVar.HEROID;if(this.ComVar.ALIVE[e]&&0==this.GPGameover.getGameState()){var r=this.params.get(t);this.SystemEvent.sendSkillChest(r)}},e.prototype.GetOrder=function(){return l.NodeProxyOrder.Role},e.__cname="BPropSkillChest",i([a.injectField("SystemEvent")],e.prototype,"SystemEvent",void 0),i([a.injectField("GPGameover")],e.prototype,"GPGameover",void 0),i([a.injectField("ComVar")],e.prototype,"ComVar",void 0),e}(s.BProp);r.BPropSkillChest=u,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../view/nodeproxy/NodeProxy":"NodeProxy","./BProp":"BProp","./SystemCommon":"SystemCommon"}],BPropVulcan:[function(t,e,r){"use strict";cc._RF.push(e,"25efbEyqmdFbYKuVdJ7t09b","BPropVulcan");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.BPropVulcan=void 0;var a=t("../../../../../../framework/container/Container"),l=t("../role/RoleBuilder"),s=t("./BProp"),c=t("./SystemCommon"),u=function(t){function e(){return t.call(this,c.EBProp.Vulcan)||this}return n(e,t),e.prototype.OnAdd=function(){},e.prototype.OnDelete=function(){},e.prototype.Pick=function(){var t=this.ref.GetValue();if(t){var e=this.Battle.getRef(this.ComVar.HEROID),r=new l.RBContext;r.sender=e;var o=Number(t),n=new(this.SystemRole.GetBulletBuilder(o));n.Setup(r),n.SetProperty("resId",o),n.SetProperty("builder",n),this.SystemRole.ApplyBuilder(n),this.Battle.applyModify()}},e.__cname="BPropVulcan",i([a.injectField("SystemCommon")],e.prototype,"SystemCommon",void 0),i([a.injectField("Battle")],e.prototype,"Battle",void 0),i([a.injectField("SystemEvent")],e.prototype,"SystemEvent",void 0),i([a.injectField("SystemRole")],e.prototype,"SystemRole",void 0),i([a.injectField("ComVar")],e.prototype,"ComVar",void 0),e}(s.BProp);r.BPropVulcan=u,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../role/RoleBuilder":"RoleBuilder","./BProp":"BProp","./SystemCommon":"SystemCommon"}],BProp:[function(t,e,r){"use strict";cc._RF.push(e,"ec9fcNBfthNI5R7Zm4g1O7V","BProp");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.BProp=void 0;var i=t("../../../../../../framework/base/ScriptObject"),a=t("../../view/nodeproxy/NodeProxy"),l=function(t){function e(e){var r=t.call(this)||this;return r.ids=new Set,r.params=new Map,r.type=e,r}return n(e,t),e.prototype.Add=function(t){this.ids.add(t)&&(this.OnAdd(t),this.params.delete(t))},e.prototype.Delete=function(t){this.ids.delete(t)&&(this.OnDelete(t),this.params.delete(t))},e.prototype.SetParam=function(t,e){this.params.set(t,e)},e.prototype.GetModel=function(){var t;return null===(t=this.ref)||void 0===t?void 0:t.GetModel()},e.prototype.GetModel2=function(){var t;return null===(t=this.ref)||void 0===t?void 0:t.GetModel2()},e.prototype.GetOrder=function(){return a.NodeProxyOrder.Ground},e}(i.ScriptObject);r.BProp=l,cc._RF.pop()},{"../../../../../../framework/base/ScriptObject":void 0,"../../view/nodeproxy/NodeProxy":"NodeProxy"}],BTActionIdle:[function(t,e,r){"use strict";cc._RF.push(e,"91d42U7jThGUbft4hknhS0l","BTActionIdle");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a},l=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(a(arguments[e]));return t};Object.defineProperty(r,"__esModule",{value:!0}),r.BTActionIdle=void 0;var s=t("../../../../../../../../framework/container/Container"),c=t("../core/BTAction"),u=t("../data/ConstBattleBT"),p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.Setup=function(e,r){for(var o=[],n=2;n<arguments.length;n++)o[n-2]=arguments[n];return t.prototype.Setup.apply(this,l([e,r],o)),this},e.prototype.OnEnterAction=function(){this.ComState.SwitchStatic(this.id)},e.prototype.OnExitAction=function(){},e.prototype.OnExecuteAction=function(){return u.BTResult.Success},e.__cname="BTActionIdle",i([s.injectField("ComState")],e.prototype,"ComState",void 0),e}(c.BTAction);r.BTActionIdle=p,cc._RF.pop()},{"../../../../../../../../framework/container/Container":void 0,"../core/BTAction":"BTAction","../data/ConstBattleBT":"ConstBattleBT"}],BTActionRun:[function(t,e,r){"use strict";cc._RF.push(e,"387cf+7t29AUrmMyfwPVEtk","BTActionRun");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.BTActionRun=void 0;var a=t("../../../../../../../../framework/container/Container"),l=t("../core/BTAction"),s=t("../data/ConstBattleBT"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.Setup=function(e,r,o){return t.prototype.Setup.call(this,e,r),this.EnableTimer(o),this.duration=o,this},e.prototype.OnEnterAction=function(){this.processToTarget()},e.prototype.OnExitAction=function(){},e.prototype.OnExecuteAction=function(){return s.BTResult.Success},e.prototype.processToTarget=function(){var t=this.ComPos.x,e=this.ComPos.y,r=this.ComVar.SHOOT_TARGET,o=this.id,n=this.ComState,i=this.ComVelocity.speed,a=this.duration,l=r[o];if(null==l)return!1;var s=t[l]-t[o],c=e[l]-e[o],u=Math.atan2(c,s),p=i[o]*a,f=t[o]+Math.cos(u)*p,h=e[o]+Math.sin(u)*p;return n.SwitchMove(this.entityRef,f,h,20),!0},e.__cname="BTActionRun",i([a.injectField("ComVar")],e.prototype,"ComVar",void 0),i([a.injectField("ComPos")],e.prototype,"ComPos",void 0),i([a.injectField("ComVelocity")],e.prototype,"ComVelocity",void 0),e}(l.BTAction);r.BTActionRun=c,cc._RF.pop()},{"../../../../../../../../framework/container/Container":void 0,"../core/BTAction":"BTAction","../data/ConstBattleBT":"ConstBattleBT"}],BTActionUseSkill:[function(t,e,r){"use strict";cc._RF.push(e,"b239fBo6fhNzLkH+eZyR5Jz","BTActionUseSkill");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.BTActionUseSkill=void 0;var a=t("../core/BTAction"),l=t("../data/ConstBattleBT"),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._tempReady=[],e}return n(e,t),e.prototype.Setup=function(e,r){for(var o=[],n=2;n<arguments.length;n++)o[n-2]=arguments[n];return t.prototype.Setup.call(this,e,r),this},e.prototype.OnEnterAction=function(t){this.activeSkillData=null;var e=this.RandomReadySkill(t);if(e&&e.skillContext){this.id;var r=e.skillContext;r.skill.TryRun(r)&&(this.activeSkillData=e,t.lastConjureTime=cc.director.getTotalTime(),this.tmDebug.set("UseSkill",r.toString()))}},e.prototype.OnExitAction=function(){this.activeSkillData=null},e.prototype.OnExecuteAction=function(){var t=this.activeSkillData;if(this.id,null==t||null==t.skillContext)return l.BTResult.Failure;if(t&&t.skillContext){var e=t.skillContext;if(e.skill&&e.skill.GetIsRunning(e))return l.BTResult.Running}return l.BTResult.Success},e.prototype.RandomReadySkill=function(t){var e,r,o=this._tempReady;o.length=0;try{for(var n=i(t.skillData),a=n.next();!a.done;a=n.next()){var l=a.value;l.isReady&&l.isInDistance&&o.push(l)}}catch(s){e={error:s}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}return o.length>0?o[Math.floor(Math.random()*o.length)]:null},e.__cname="BTActionUseSkill",e}(a.BTAction);r.BTActionUseSkill=s,cc._RF.pop()},{"../core/BTAction":"BTAction","../data/ConstBattleBT":"ConstBattleBT"}],BTAction:[function(t,e,r){"use strict";cc._RF.push(e,"14533/XbElHt44iPv3OhiwH","BTAction");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.BTAction=void 0;var i=t("../data/ConstBattleBT"),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._istimer=!1,e}return n(e,t),e.prototype.Setup=function(e,r){for(var o=[],n=2;n<arguments.length;n++)o[n-2]=arguments[n];return t.prototype.Setup.call(this,e),this.percondition=r,this.state=i.BTState.Ready,this},e.prototype.EnterAction=function(t){this.isExcuteResult=null,this.OnEnterTimer(),this.OnEnterAction(t)},e.prototype.OnEnterAction=function(){},e.prototype.ExitAction=function(t){this.OnExitTimer(),this.OnExitAction(t)},e.prototype.OnExitAction=function(){},e.prototype.ExcuteAction=function(t){var e;return null==this.isExcuteResult&&(e=this.OnExecuteAction(t))!=i.BTResult.Running&&(this.isExcuteResult=e),null==e&&(0==this.CheckTimer()?e=i.BTResult.Running:(e=this.isExcuteResult,this.isExcuteResult=null)),e},e.prototype.OnExecuteAction=function(){return i.BTResult.Success},e.prototype.OnTick=function(t){var e=i.BTResult.Success;return this.state==i.BTState.Ready&&(this.EnterAction(t),this.state=i.BTState.Running),this.state==i.BTState.Running&&(e=this.ExcuteAction(t))!=i.BTResult.Running&&(this.ExitAction(t),this.state=i.BTState.Ready),this.tmDebug.set("actionState",i.BTResult[e]),e},e.prototype.Clear=function(){t.prototype.Clear.call(this),this.state=i.BTState.Ready},e.prototype.EnableTimer=function(t){this._istimer=!0,this._time=t},e.prototype.DisableTimer=function(){this._istimer=!1,this._time=null},e.prototype.HasTimer=function(){return this._istimer},e.prototype.CheckTimer=function(){if(null==this._nexttime)return!0;var t=cc.director.getTotalTime()/1e3;return this._nexttime<t},e.prototype.OnEnterTimer=function(){this.HasTimer()&&(this._nexttime=cc.director.getTotalTime()/1e3+this._time)},e.prototype.OnExitTimer=function(){this._nexttime=null},e.__cname="BTAction",e}(t("./BTNode").BTNode);r.BTAction=a,cc._RF.pop()},{"../data/ConstBattleBT":"ConstBattleBT","./BTNode":"BTNode"}],BTBossCharge:[function(t,e,r){"use strict";cc._RF.push(e,"75709H0mWpNDLEAp4x3tLq9","BTBossCharge");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.BTBossCharge=void 0;var i=t("../behaviorTree/action/BTActionIdle"),a=t("../behaviorTree/action/BTActionRun"),l=t("../behaviorTree/action/BTActionUseSkill"),s=t("../behaviorTree/core/BTFactory"),c=t("../behaviorTree/percondition/BTCheckSkillReady"),u=t("../behaviorTree/priority/BTPrioritySelector"),p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.Setup=function(t){var e=t,r=s.BTFactory.instance(),o=r.Create(u.BTPrioritySelector).Setup(e),n=r.Create(c.BTCheckSkillReady).Setup(e,5),p=r.Create(l.BTActionUseSkill).Setup(e,n);return o.AddChild(p),n=null,p=r.Create(a.BTActionRun).Setup(e,n,2),o.AddChild(p),n=null,p=r.Create(i.BTActionIdle).Setup(e,n),o.AddChild(p),this.root=o,this},e.__cname="BTBossCharge",e}(t("./BTBoss").BTBoss);r.BTBossCharge=p,cc._RF.pop()},{"../behaviorTree/action/BTActionIdle":"BTActionIdle","../behaviorTree/action/BTActionRun":"BTActionRun","../behaviorTree/action/BTActionUseSkill":"BTActionUseSkill","../behaviorTree/core/BTFactory":"BTFactory","../behaviorTree/percondition/BTCheckSkillReady":"BTCheckSkillReady","../behaviorTree/priority/BTPrioritySelector":"BTPrioritySelector","./BTBoss":"BTBoss"}],BTBossRemote:[function(t,e,r){"use strict";cc._RF.push(e,"8c2f3HXeMlFLJUolIO5Y3cX","BTBossRemote");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.BTBossRemote=void 0;var i=t("../behaviorTree/action/BTActionIdle"),a=t("../behaviorTree/action/BTActionRun"),l=t("../behaviorTree/action/BTActionUseSkill"),s=t("../behaviorTree/core/BTFactory"),c=t("../behaviorTree/percondition/BTCheckDistance"),u=t("../behaviorTree/percondition/BTCheckSkillReady"),p=t("../behaviorTree/priority/BTPrioritySelector"),f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.Setup=function(t){var e=t,r=s.BTFactory.instance(),o=r.Create(p.BTPrioritySelector).Setup(e),n=r.Create(u.BTCheckSkillReady).Setup(e,5),f=r.Create(l.BTActionUseSkill).Setup(e,n);return o.AddChild(f),n=r.Create(c.BTCheckDistance).Setup(e,"large",50),f=r.Create(a.BTActionRun).Setup(e,n,.5),o.AddChild(f),n=null,f=r.Create(i.BTActionIdle).Setup(e,n),o.AddChild(f),this.root=o,this},e.__cname="BTBossRemote",e}(t("./BTBoss").BTBoss);r.BTBossRemote=f,cc._RF.pop()},{"../behaviorTree/action/BTActionIdle":"BTActionIdle","../behaviorTree/action/BTActionRun":"BTActionRun","../behaviorTree/action/BTActionUseSkill":"BTActionUseSkill","../behaviorTree/core/BTFactory":"BTFactory","../behaviorTree/percondition/BTCheckDistance":"BTCheckDistance","../behaviorTree/percondition/BTCheckSkillReady":"BTCheckSkillReady","../behaviorTree/priority/BTPrioritySelector":"BTPrioritySelector","./BTBoss":"BTBoss"}],BTBossStatic:[function(t,e,r){"use strict";cc._RF.push(e,"089ecbe6udLSrpW6Hzr0XGF","BTBossStatic");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.BTBossStatic=void 0;var i=t("../behaviorTree/action/BTActionIdle"),a=t("../behaviorTree/action/BTActionUseSkill"),l=t("../behaviorTree/core/BTFactory"),s=t("../behaviorTree/percondition/BTCheckSkillReady"),c=t("../behaviorTree/priority/BTPrioritySelector"),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.Setup=function(t){var e=t,r=l.BTFactory.instance(),o=r.Create(c.BTPrioritySelector).Setup(e),n=r.Create(s.BTCheckSkillReady).Setup(e,5),u=r.Create(a.BTActionUseSkill).Setup(e,n);return o.AddChild(u),n=null,u=r.Create(i.BTActionIdle).Setup(e,n),o.AddChild(u),this.root=o,this},e.__cname="BTBossStatic",e}(t("./BTBoss").BTBoss);r.BTBossStatic=u,cc._RF.pop()},{"../behaviorTree/action/BTActionIdle":"BTActionIdle","../behaviorTree/action/BTActionUseSkill":"BTActionUseSkill","../behaviorTree/core/BTFactory":"BTFactory","../behaviorTree/percondition/BTCheckSkillReady":"BTCheckSkillReady","../behaviorTree/priority/BTPrioritySelector":"BTPrioritySelector","./BTBoss":"BTBoss"}],BTBoss:[function(t,e,r){"use strict";cc._RF.push(e,"c9e256VQs1J4YZ8W59TgNnz","BTBoss");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.BTBoss=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.__cname="BTBoss",e}(t("../behaviorTree/core/BTTree").BTTree);r.BTBoss=i,cc._RF.pop()},{"../behaviorTree/core/BTTree":"BTTree"}],BTCheckDistance:[function(t,e,r){"use strict";cc._RF.push(e,"0a958Zx9UtGepeStzcUSux0","BTCheckDistance");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.BTCheckDistance=void 0;var a=t("../../../../../../../../framework/container/Container"),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.Setup=function(e,r,o){for(var n=[],i=3;i<arguments.length;i++)n[i-3]=arguments[i];return t.prototype.Setup.call(this,e),this.model=r,this.value=o,this},e.prototype.Clear=function(){t.prototype.Clear.call(this),this.model=null,this.value=null},e.prototype.OnCheck=function(){var t=this.ComPos.x,e=this.ComPos.y,r=this.ComVar.SHOOT_TARGET,o=this.id,n=this.value*this.value,i=r[o];if(null==i)return!1;var a=t[i]-t[o],l=e[i]-e[o],s=a*a+l*l;switch(this.model){case"less":return s<n;case"large":return s>n;case"equal":return Math.abs(n-s)<.01;default:return!1}},e.__cname="BTCheckDistance",i([a.injectField("ComPos")],e.prototype,"ComPos",void 0),i([a.injectField("ComVar")],e.prototype,"ComVar",void 0),e}(t("./BTPercondiction").BTPercondiction);r.BTCheckDistance=l,cc._RF.pop()},{"../../../../../../../../framework/container/Container":void 0,"./BTPercondiction":"BTPercondiction"}],BTCheckSkillReady:[function(t,e,r){"use strict";cc._RF.push(e,"56ab7qWSvxHeL/yKqGGkSxF","BTCheckSkillReady");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.BTCheckSkillReady=void 0;var l=t("../../../../../../../../framework/container/Container"),s=t("../data/BTDataSkill"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.Setup=function(e,r){return t.prototype.Setup.call(this,e),this.BTDataSkillMgr=this.factory.Create(s.BTDataSkillMgr),this.cdms=1e3*r,this},e.prototype.OnCheck=function(t){var e=!0;return this.id,this.SystemSkill,(e=e&&this.CheckCD(t))&&this.FindReadySkill(t)},e.prototype.CheckCD=function(t){var e=t.lastConjureTime;return null==e||cc.director.getTotalTime()>e+this.cdms},e.prototype.FindReadySkill=function(t){var e,r,o,n,i=this.id,l=(this.SystemSkill,this.ComSkill,this.ComVar.SHOOT_TARGET),s=(this.ComPos.x,this.ComPos.y,this.BTDataSkillMgr);try{for(var c=a(t.skillData),u=c.next();!u.done;u=c.next()){var p=u.value;s.ReturnData(p)}}catch(v){e={error:v}}finally{try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(e)throw e.error}}t.skillData.length=0;var f=this.ComSkill.GetSkillBy(i);if(f){var h=!1;try{for(var y=a(f),d=y.next();!d.done;d=y.next()){var m=d.value;p=s.GetData(i,l[i],m),t.skillData.push(p),p.isReady&&p.isInDistance&&(h=!0)}}catch(_){o={error:_}}finally{try{d&&!d.done&&(n=y.return)&&n.call(y)}finally{if(o)throw o.error}}t.hasReadySkill=h}return t.hasReadySkill},e.__cname="BTCheckSkillReady",i([l.injectField("ComSkill")],e.prototype,"ComSkill",void 0),i([l.injectField("ComPos")],e.prototype,"ComPos",void 0),i([l.injectField("ComVar")],e.prototype,"ComVar",void 0),i([l.injectField("SystemSkill")],e.prototype,"SystemSkill",void 0),e}(t("./BTPercondiction").BTPercondiction);r.BTCheckSkillReady=c,cc._RF.pop()},{"../../../../../../../../framework/container/Container":void 0,"../data/BTDataSkill":"BTDataSkill","./BTPercondiction":"BTPercondiction"}],BTDataSkill:[function(t,e,r){"use strict";cc._RF.push(e,"0d16dHVGGdMEr6rTKpTHv6f","BTDataSkill");var o=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.BTDataSkillMgr=r.BTDataSkill=void 0;var n=t("../../../../../../../../framework/container/Container"),i=function(){function t(){}return t.prototype.Reset=function(){this.eid=null,this.skillContext=null,this.isReady=!1,this.isInDistance=!1},t.prototype.Setup=function(t,e,r){this.eid=t,this.skillContext=r;var o=this.ComPos.x,n=this.ComPos.y;if(r)for(;;){if(!r.skill.GetIsReady(r)){this.isReady=!1;break}if(this.isReady=!0,null==e){this.isInDistance=!1;break}var i=r.skill.GetDistance(r);if(0==i)break;var a=o[e]-o[t],l=n[e]-n[t];if(a*a+l*l<=i*i){this.isInDistance=!0;break}this.isInDistance=!1;break}},t.__cname="BTDataSkill",o([n.injectField("ComPos")],t.prototype,"ComPos",void 0),t}();r.BTDataSkill=i;var a=function(){function t(){this.tlData=[]}return t.prototype.GetData=function(t,e,r){var o=this.tlData.shift();return null==o&&(o=this.factory.Create(i)),o.Reset(),o.Setup(t,e,r),o},t.prototype.ReturnData=function(t){t.Reset(),this.tlData.push(t)},t.__cname="BTDataSkillMgr",t}();r.BTDataSkillMgr=a,cc._RF.pop()},{"../../../../../../../../framework/container/Container":void 0}],BTFactory:[function(t,e,r){"use strict";cc._RF.push(e,"fbbcfdU0y5Aj5pPUZaA8pnq","BTFactory");var o=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a},n=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(o(arguments[e]));return t};Object.defineProperty(r,"__esModule",{value:!0}),r.BTFactory=void 0;var i=t("../../../../../../../../framework/FW"),a=function(){function t(){}return t.instance=function(){return this._instance||(this._instance=new t)},t.prototype.SetContainer=function(t){this.container=t},t.prototype.Create=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];null==this.container&&i.FW.Log.error("\u884c\u4e3a\u6811\u5de5\u5382\u672a\u521d\u59cb\u5316");var o=new(t.bind.apply(t,n([void 0],e)));return o.container=this.container,o.factory=this,this.container.inject(o),o},t.__cname="BTFactory",t}();r.BTFactory=a,cc._RF.pop()},{"../../../../../../../../framework/FW":void 0}],BTInvert:[function(t,e,r){"use strict";cc._RF.push(e,"51ceeEDNVdGJaNj5Fejbc4G","BTInvert");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.BTInvert=void 0;var i=t("../data/ConstBattleBT"),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.AddChild=function(e){throw 0==this.childrens.length&&(t.prototype.AddChild.call(this,e),this.activityChild=e),new Error("BTInvert \u4e0d\u80fd\u6dfb\u52a0\u66f4\u591a\u5b50\u8282\u70b9")},e.prototype.DoEvaluate=function(t){return!!this.activityChild&&!this.activityChild.Evaluate(t)},e.prototype.OnTick=function(t){return this.activityChild?this.activityChild.Tick(t):i.BTResult.Success},e.__cname="BTInvert",e}(t("./BTPriority").BTPriority);r.BTInvert=a,cc._RF.pop()},{"../data/ConstBattleBT":"ConstBattleBT","./BTPriority":"BTPriority"}],BTNode:[function(t,e,r){"use strict";cc._RF.push(e,"f4057D6cLJGL5nk0W0tykO/","BTNode");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.BTNode=void 0;var s=t("../../../../../../../../framework/base/ScriptObject"),c=t("../../../../../../../../framework/container/Container"),u=t("../data/ConstBattleBT"),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tmDebug=new Map,e}return n(e,t),e.prototype.Setup=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return this.id=t,this.entityRef=this.Battle.getRef(t),this.lastChild=null,this.childrens=[],this},e.prototype.AddChild=function(t){this.childrens.push(t)},e.prototype.RemoveChild=function(t){for(var e=this.childrens,r=0;r<e.length;r++){var o=e[r];if(o==t)return o.Clear(),void e.splice(r,1)}},e.prototype.Evaluate=function(t){this.tmDebug.clear();var e=this.OnEvaluate(t);return this.tmDebug.set("Evaluate",""+e),e},e.prototype.OnEvaluate=function(t){var e=!0;return this.percondition&&(e=this.percondition.Check(t)),e&&this.DoEvaluate(t)},e.prototype.DoEvaluate=function(){return!0},e.prototype.Tick=function(t){var e=this.OnTick(t);return this.tmDebug.set("Tick",u.BTResult[e]),e},e.prototype.OnTick=function(){return u.BTResult.Success},e.prototype.Clear=function(){var t,e;this.tmDebug.clear();try{for(var r=a(this.childrens),o=r.next();!o.done;o=r.next())o.value.Clear()}catch(n){t={error:n}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}this.childrens.length=0},e.prototype.Printf=function(t){var e,r,o=this.GetDebugString(t);this.percondition&&(o+=this.percondition.Printf(t+1));try{for(var n=a(this.childrens),i=n.next();!i.done;i=n.next())o+=i.value.Printf(t+1)}catch(l){e={error:l}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}return o},e.prototype.GetDebugString=function(t){var e=this.className,r=this.OnGetDebugString();return"\n"+"\t".repeat(t)+"["+e+"]"+r+" "},e.prototype.OnGetDebugString=function(){var t,e,r="";try{for(var o=a(this.tmDebug),n=o.next();!n.done;n=o.next()){var i=l(n.value,2);r+=i[0]+"="+i[1]+","}}catch(s){t={error:s}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}return r},e.__cname="BTNode",i([c.injectField("ComPrefab")],e.prototype,"ComPrefab",void 0),i([c.injectField("ComState")],e.prototype,"ComState",void 0),i([c.injectField("Battle")],e.prototype,"Battle",void 0),e}(s.ScriptObject);r.BTNode=p,cc._RF.pop()},{"../../../../../../../../framework/base/ScriptObject":void 0,"../../../../../../../../framework/container/Container":void 0,"../data/ConstBattleBT":"ConstBattleBT"}],BTParallel:[function(t,e,r){"use strict";cc._RF.push(e,"efc22u4h0RAMo5t11NZhJPJ","BTParallel");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.BTParallel=void 0;var a=t("../data/ConstBattleBT"),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.childEvaluates=new Set,e.hasSuccess=!1,e}return n(e,t),e.prototype.DoEvaluate=function(t){var e=this.childrens,r=this.childEvaluates;r.clear(),this.hasSuccess=!1;for(var o=0;o<e.length;o++){var n=e[o];n.Evaluate(t)&&r.add(n)}return r.size>0},e.prototype.OnTick=function(t){var e,r,o=!1,n=this.childEvaluates;try{for(var l=i(n),s=l.next();!s.done;s=l.next()){var c=s.value;switch(c.Tick(t)){case a.BTResult.Failure:n.delete(c);break;case a.BTResult.Success:this.hasSuccess=!0,n.delete(c);break;case a.BTResult.Running:o=!0}}}catch(u){e={error:u}}finally{try{s&&!s.done&&(r=l.return)&&r.call(l)}finally{if(e)throw e.error}}return o?a.BTResult.Running:this.hasSuccess?a.BTResult.Success:a.BTResult.Failure},e.__cname="BTParallel",e}(t("./BTPriority").BTPriority);r.BTParallel=l,cc._RF.pop()},{"../data/ConstBattleBT":"ConstBattleBT","./BTPriority":"BTPriority"}],BTPercondiction:[function(t,e,r){"use strict";cc._RF.push(e,"ce082NVF65PcoCtvRlaiKtm","BTPercondiction");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.BTPercondiction=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.Check=function(t){var e=this.OnCheck(t);return this.tmDebug.set("check",""+e),e},e.prototype.OnCheck=function(){return!0},e.__cname="BTPercondiction",e}(t("../core/BTNode").BTNode);r.BTPercondiction=i,cc._RF.pop()},{"../core/BTNode":"BTNode"}],BTPrioritySelector:[function(t,e,r){"use strict";cc._RF.push(e,"f09c01Htw1M/ITCALeAghe4","BTPrioritySelector");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.BTPrioritySelector=void 0;var i=t("../data/ConstBattleBT"),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.DoEvaluate=function(t){if(null!=this.activityChild)return!0;for(var e=this.childrens,r=0;r<e.length;r++){var o=e[r];if(o.Evaluate(t))return this.activityChild=o,!0}return!1},e.prototype.OnTick=function(t){var e;return this.activityChild&&(e=this.activityChild.Tick(t),this.tmDebug.set("activityChild",this.activityChild.className),e==i.BTResult.Running)?i.BTResult.Running:(this.activityChild=null,e)},e.__cname="BTPrioritySelector",e}(t("./BTPriority").BTPriority);r.BTPrioritySelector=a,cc._RF.pop()},{"../data/ConstBattleBT":"ConstBattleBT","./BTPriority":"BTPriority"}],BTPrioritySequence:[function(t,e,r){"use strict";cc._RF.push(e,"415c4HLCrtEx74R1KgfqfFn","BTPrioritySequence");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a},a=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(i(arguments[e]));return t};Object.defineProperty(r,"__esModule",{value:!0}),r.BTPrioritySequence=void 0;var l=t("../data/ConstBattleBT"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),Object.defineProperty(e.prototype,"lastIndex",{get:function(){return this.childrens.length-1},enumerable:!1,configurable:!0}),e.prototype.Setup=function(e){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];return t.prototype.Setup.apply(this,a([e],r)),this},e.prototype.DoEvaluate=function(t){var e=this.childrens,r=0;null!=this.activeIndex&&(r=this.activeIndex);for(var o=r;o<e.length;o++)if(e[o].Evaluate(t))return this.activeIndex=o,!0;return this.ClearActive(),!1},e.prototype.OnTick=function(t){if(null!=this.activeIndex){var e=this.childrens[this.activeIndex].Tick(t);if(e==l.BTResult.Failure)return l.BTResult.Failure;if(e==l.BTResult.Success&&this.activeIndex==this.lastIndex)return l.BTResult.Success}return l.BTResult.Running},e.prototype.ClearActive=function(){this.activeIndex=null},e.__cname="BTPrioritySequence",e}(t("./BTPriority").BTPriority);r.BTPrioritySequence=s,cc._RF.pop()},{"../data/ConstBattleBT":"ConstBattleBT","./BTPriority":"BTPriority"}],BTPriority:[function(t,e,r){"use strict";cc._RF.push(e,"28044k4CAlEYKhFxFH7Mp+E","BTPriority");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.BTPriority=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.__cname="BTPriority",e}(t("../core/BTNode").BTNode);r.BTPriority=i,cc._RF.pop()},{"../core/BTNode":"BTNode"}],BTTest:[function(t,e,r){"use strict";cc._RF.push(e,"04ce5mdPeNNrY+97ZdPmvL4","BTTest"),Object.defineProperty(r,"__esModule",{value:!0}),t("../../../../../../../framework/container/Container"),t("./action/BTActionRun"),t("./action/BTActionUseSkill"),t("./core/BTFactory"),t("./core/BTTree"),t("./percondition/BTCheckSkillReady"),t("./priority/BTPrioritySelector"),cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"./action/BTActionRun":"BTActionRun","./action/BTActionUseSkill":"BTActionUseSkill","./core/BTFactory":"BTFactory","./core/BTTree":"BTTree","./percondition/BTCheckSkillReady":"BTCheckSkillReady","./priority/BTPrioritySelector":"BTPrioritySelector"}],BTTree:[function(t,e,r){"use strict";cc._RF.push(e,"81a96bs6c9M84VqTiQdXYsc","BTTree"),Object.defineProperty(r,"__esModule",{value:!0}),r.BTTree=void 0;var o=t("../../../../../../../../framework/FW"),n=t("../data/ConstBattleBT"),i=function(){function t(){this.debug=!1,this.root=null,this.context=new n.BTContext,this.context.tree=this}return t.prototype.Update=function(){if(null!=this.root){var t=this.context;this.root.Evaluate(t)&&(this.root.Tick(t),this.debug&&o.FW.Log.log(this.root.Printf(0)))}},t.prototype.Clear=function(){this.root&&(this.root.Clear(),this.root=null),this.context=null},t.__cname="BTTree",t}();r.BTTree=i,cc._RF.pop()},{"../../../../../../../../framework/FW":void 0,"../data/ConstBattleBT":"ConstBattleBT"}],BaseBattleBehavior:[function(t,e,r){"use strict";cc._RF.push(e,"13138GfKYJB5598X2I8pELN","BaseBattleBehavior"),Object.defineProperty(r,"__esModule",{value:!0}),r.BaseBattleBehavior=void 0;r.BaseBattleBehavior=function(){},cc._RF.pop()},{}],BaseBattleBuffBehavior:[function(t,e,r){"use strict";cc._RF.push(e,"61af4NSRTtBAp31GY8ya/hr","BaseBattleBuffBehavior");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.BaseBattleBuffBehavior=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.__cname="BaseBattleBuffBehavior",e}(t("../../../buff/base/BuffBehavior").BuffBehavior);r.BaseBattleBuffBehavior=i,cc._RF.pop()},{"../../../buff/base/BuffBehavior":"BuffBehavior"}],BaseBattleCustomBehavior:[function(t,e,r){"use strict";cc._RF.push(e,"9c0816FQWtCZ6iA0G2kXJA/","BaseBattleCustomBehavior");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.BaseBattleCustomBehavior=void 0;var a=t("../../../../../../../framework/container/Container"),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetBuffTriggerType=function(){return this._BuffTriggerType||(this._BuffTriggerType=this.OnGetBuffTriggerType())},e.prototype.OnGetRef=function(){return this.ModelSkill.GetBuff(this.resIdOrGroupId)},e.prototype.OnGetBuffTriggerType=function(){return[]},e.prototype.OnTrigger=function(){},e.__cname="BaseBattleCustomBehavior",i([a.injectField("ModelSkill")],e.prototype,"ModelSkill",void 0),e}(t("../BaseBattleBuffBehavior").BaseBattleBuffBehavior);r.BaseBattleCustomBehavior=l,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../BaseBattleBuffBehavior":"BaseBattleBuffBehavior"}],BaseBattleGroupSet:[function(t,e,r){"use strict";cc._RF.push(e,"11d51KW6sJOB6sAImjmGTxy","BaseBattleGroupSet");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.BaseBattleGroupSet=void 0;var l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tmSubSystem=new Map,e}return n(e,t),e.prototype.Start=function(){var e,r,o,n;try{for(var l=i(this.tmSubSystem),s=l.next();!s.done;s=l.next()){var c=a(s.value,2),u=(c[0],c[1]);this.container.inject(u)}}catch(y){e={error:y}}finally{try{s&&!s.done&&(r=l.return)&&r.call(l)}finally{if(e)throw e.error}}try{for(var p=i(this.tmSubSystem),f=p.next();!f.done;f=p.next()){var h=a(f.value,2);h[0],(u=h[1]).OnEnter()}}catch(d){o={error:d}}finally{try{f&&!f.done&&(n=p.return)&&n.call(p)}finally{if(o)throw o.error}}t.prototype.Start.call(this)},e.prototype.Release=function(){var e,r,o,n;try{for(var l=i(this.tmSubSystem),s=l.next();!s.done;s=l.next()){var c=a(s.value,2);c[0],c[1].OnExit()}}catch(h){e={error:h}}finally{try{s&&!s.done&&(r=l.return)&&r.call(l)}finally{if(e)throw e.error}}try{for(var u=i(this.tmSubSystem),p=u.next();!p.done;p=u.next()){var f=a(p.value,2);f[0],f[1].destroy()}}catch(y){o={error:y}}finally{try{p&&!p.done&&(n=u.return)&&n.call(u)}finally{if(o)throw o.error}}this.tmSubSystem.clear(),t.prototype.Release.call(this)},e.prototype.Update=function(e){var r,o;try{for(var n=i(this.tmSubSystem),l=n.next();!l.done;l=n.next()){var s=a(l.value,2);s[0],s[1].OnUpdate(e)}}catch(c){r={error:c}}finally{try{l&&!l.done&&(o=n.return)&&o.call(n)}finally{if(r)throw r.error}}t.prototype.Update.call(this,e)},e.prototype.AddSubSystem=function(t){var e=new t(this.container);return this.tmSubSystem.set(t,e),e.parent=this,e.OnInit(),e},e.prototype.GetSubSystem=function(t){return this.tmSubSystem.get(t)},e.__cname="BaseBattleGroupSet",e}(t("../../../../../framework/ecs/GroupSet").GroupSet);r.BaseBattleGroupSet=l,cc._RF.pop()},{"../../../../../framework/ecs/GroupSet":void 0}],BaseBattleSystem:[function(t,e,r){"use strict";cc._RF.push(e,"e0ba911AmVGrbgSw1wn+Dw/","BaseBattleSystem");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.BaseBattleSystem=void 0;var s=t("../../../../../framework/container/Container"),c=t("../../../../../framework/ecs/System"),u=(t("../../../../../framework/FW"),new Map,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tmSubSystem=new Map,e}return n(e,t),e.prototype.beforeStartAsync=function(){return null},e.prototype.Start=function(){var e,r,o,n;try{for(var i=a(this.tmSubSystem),s=i.next();!s.done;s=i.next()){var c=l(s.value,2),u=(c[0],c[1]);this.container.inject(u)}}catch(y){e={error:y}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}try{for(var p=a(this.tmSubSystem),f=p.next();!f.done;f=p.next()){var h=l(f.value,2);h[0],(u=h[1]).OnEnter()}}catch(d){o={error:d}}finally{try{f&&!f.done&&(n=p.return)&&n.call(p)}finally{if(o)throw o.error}}t.prototype.Start.call(this)},e.prototype.Release=function(){var e,r,o,n;try{for(var i=a(this.tmSubSystem),s=i.next();!s.done;s=i.next()){var c=l(s.value,2);c[0],c[1].OnExit()}}catch(h){e={error:h}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}try{for(var u=a(this.tmSubSystem),p=u.next();!p.done;p=u.next()){var f=l(p.value,2);f[0],f[1].destroy()}}catch(y){o={error:y}}finally{try{p&&!p.done&&(n=u.return)&&n.call(u)}finally{if(o)throw o.error}}this.tmSubSystem.clear(),t.prototype.Release.call(this)},e.prototype.Update=function(e){var r,o;try{for(var n=a(this.tmSubSystem),i=n.next();!i.done;i=n.next()){var s=l(i.value,2);s[0],s[1].OnUpdate(e)}}catch(c){r={error:c}}finally{try{i&&!i.done&&(o=n.return)&&o.call(n)}finally{if(r)throw r.error}}t.prototype.Update.call(this,e)},e.prototype.AddSubSystem=function(t){var e=new t(this.container);return this.tmSubSystem.set(t,e),e.parent=this,e.OnInit(),e},e.prototype.GetSubSystem=function(t){return this.tmSubSystem.get(t)},e.__cname="BaseBattleSystem",i([s.injectField("SystemBrocast")],e.prototype,"systemBrocast",void 0),i([s.injectField("SystemHandler")],e.prototype,"systemHandler",void 0),e}(c.System));r.BaseBattleSystem=u,cc._RF.pop()},{"../../../../../framework/FW":void 0,"../../../../../framework/container/Container":void 0,"../../../../../framework/ecs/System":void 0}],BaseBulletSubState:[function(t,e,r){"use strict";cc._RF.push(e,"120abpth0pBobdKMz/rXuAr","BaseBulletSubState");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.BaseBulletSubState=void 0;var l=t("../../../../../../../framework/container/Container"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.Update=function(e){var r,o;t.prototype.Update.call(this,e);try{for(var n=a(this.ids),i=n.next();!i.done;i=n.next()){var l=i.value;this.UpdateAttr_bve(l)}}catch(s){r={error:s}}finally{try{i&&!i.done&&(o=n.return)&&o.call(n)}finally{if(r)throw r.error}}},e.prototype.UpdateAttr_bve=function(t){var e=this.ComVar.BULLET_ATTR_BVE,r=this.ComCollision.r,o=this.ComVar.BULLET_MODEL_PROTOTYPE_SIZE,n=this.ComVar.BULLET_SENDER;if(this.ComPrefab.model,e[t]){if(null==n[t])return;var i=o[t],a=this.ComVar.CalBulletPrototypeSize(t,i),l=o[t]/2,s=this.ComVar.CalBulletPrototypeSize(t,l);r[t]=s,this.ComPrefab.ChangeModel(t,null,null,null,null,a)}},e.__cname="BaseBulletSubState",i([l.injectField("ComVar")],e.prototype,"ComVar",void 0),i([l.injectField("ComPrefab")],e.prototype,"ComPrefab",void 0),i([l.injectField("ComCollision")],e.prototype,"ComCollision",void 0),e}(t("../SubState").SubState);r.BaseBulletSubState=s,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../SubState":"SubState"}],BaseHeroSkill:[function(t,e,r){"use strict";cc._RF.push(e,"bcf1fseh/hHlpjaBAJjmoVK","BaseHeroSkill");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.BaseHeroSkill=void 0;var l=t("../../../../../../../framework/container/Container"),s=t("../../../../attr/AttrWrap"),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._attr_cd=new s.AttrWrap,e}return n(e,t),e.prototype.ChangeParams=function(e){var r=this.tlContext[e];this._ref=r.refSkillPlan,this.OnAttrChange(),this._scriptParam=this.OnGetScriptParam(this._ref),t.prototype.ChangeParams.call(this,e)},e.prototype.GetTlScriptParam=function(){var t=this._ref.GetParam();return this.GPSkillData.HasSkillParam(this.resId)&&(t=this.GPSkillData.GetSkillParam(this.resId)),t},e.prototype.OnGetScriptParam=function(){return null},e.prototype.hasAttr=function(t){return this._tlAttr.has(t)},e.prototype.GetCD=function(t){var e=this._attr_cd;e.Clear();var r=this._ref.GetCd();if(e.base=r,this._tlAttr.has("cd")){var o=this.ComVar.GetAttr(t,"cd");e.AddAttr(o)}this.GPSkillData.HasSkillAttr(this.resId,"cd")&&(o=this.GPSkillData.GetSkillAttr(this.resId,"cd"),e.AddAttr(o));var n=r;return n-=Math.max(0,e.GetValue()-r),Math.max(0,n)},e.prototype.CalCD=function(t,e){var r=this.tlContext[t].eid;return this._tlAttr.has("cd")&&(e=this.ComVar.CalAttr(r,"cd",e)),e},e.prototype.GetInterval=function(t){var e=this.tlContext[t].eid,r=this._ref.GetInterval();return this._tlAttr.has("aiv")&&(r=this.ComVar.CalAttr(e,"aiv",r)),this.Battle.startConfig.isVulcan&&this._ref.GetSkillId()==this.Battle.startConfig.mainSkill?1e7:r},e.prototype.CalAttr_aiv=function(t,e){var r=this.tlContext[t].eid;return this._tlAttr.has("aiv")&&(e=this.ComVar.CalAttr(r,"aiv",e)),e},e.prototype.GetAttr_arg=function(t){var e=this.tlContext[t].eid,r=null;return this._tlAttr.has("arg")&&(r=this.ComVar.GetAttr(e,"arg")),r},e.prototype.CalAttr_arg=function(t,e){var r=this.tlContext[t].eid;return this.hasAttr("arg")&&(e=this.ComVar.CalAttr(r,"arg",e)),e},e.prototype.GetHasBVE=function(){return this._tlAttr.has("bve")?1:0},e.prototype.GetHasLET=function(){return this._tlAttr.has("let")?1:0},e.prototype.GetNum=function(t){var e=this.tlContext[t].eid,r=this._ref.GetNum();return(r+=this.ComVar.GetAttrValue(e,"bnm",0))+this.GPSkillData.GetSkillAttrValue(this.resId,"bnm",0)},e.prototype.GetBullet=function(t,e){this.tlContext[t].eid;var r=this._ref.GetLevel(),o=this.GPSkillData.GetSkillBullet(this.resId,r);return(null==o||(null==o?void 0:o.length)<1)&&(o=this._ref.GetBullets()),o[e]},e.prototype.GetBulletLength=function(){var t=this._ref.GetLevel(),e=this.GPSkillData.GetSkillBullet(this.resId,t);return null==e&&(e=this._ref.GetBullets()),e.length},e.prototype.GetIsSingleMode=function(){return this._ref.GetIsSingleMode()},e.prototype.SetMainSkillCD=function(t,e,r,o){this.tlContext[t].eid==this.ComVar.HEROID&&this.resId==this.Battle.startConfig.mainSkill&&(this.ComVar.MAIN_SKILL_CD=r,this.ComVar.MAIN_SKILL_CD_MAX=o,this.ComVar.MAIN_SKILL_CD_TYPE=e)},e.prototype.clearBullet=function(t){var e=this,r=this.Battle;t.forEach(function(t){var o=r.ref2id(t);o&&e.SystemRole.DestroyRole(o)})},e.prototype.checkNeedDestroyBullet=function(){var t,e=this._ref.GetRef(),r=e.skillId,o=this.Ref.RefMgrbattleSkillEvolutionRef.getRef("skillId",e.skillId);o&&(r=null===(t=o.need[0])||void 0===t?void 0:t.resId);var n=e.level,i=r+"_"+n;if(n>1)for(var a=this.SystemRole._needDestoryIds,l=1;l<n;l++){var s=r+"_"+l,c=a.get(s);c&&(this.clearBullet(c),a.delete(s))}return i},e.prototype.OnAttrChange=function(){var t,e;this._tlAttr=new Set;try{for(var r=a(this.OnGetAttr()),o=r.next();!o.done;o=r.next()){var n=o.value;this._tlAttr.add(n)}}catch(i){t={error:i}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},e.prototype.GetDistance=function(t){return this.ComVar.REACTION[t.cid]},e.prototype.triggerSkill=function(t){this.SystemEvent.SendTriggerATK(this.tlContext[t].skillTypeId)},e.__cname="BaseHeroSkill",i([l.injectField("GPSkillData")],e.prototype,"GPSkillData",void 0),i([l.injectField("Battle")],e.prototype,"Battle",void 0),i([l.injectField("Ref")],e.prototype,"Ref",void 0),i([l.injectField("SystemEvent")],e.prototype,"SystemEvent",void 0),e}(t("../BaseSkill").BaseSkill);r.BaseHeroSkill=c,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../../../attr/AttrWrap":"AttrWrap","../BaseSkill":"BaseSkill"}],BaseLogicSystem:[function(t,e,r){"use strict";cc._RF.push(e,"bb482gWAs9GXIKKe+1Y98Op","BaseLogicSystem");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.BaseLogicSystem=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.broadcast=function(t){return this.systemBrocast.Send(t)},e.__cname="BaseLogicSystem",e}(t("../base/BaseBattleSystem").BaseBattleSystem);r.BaseLogicSystem=i,cc._RF.pop()},{"../base/BaseBattleSystem":"BaseBattleSystem"}],BaseOthersSkill:[function(t,e,r){"use strict";cc._RF.push(e,"375d0BUj+BNfZUPBYyTxicD","BaseOthersSkill");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.BaseOthersSkill=void 0;var a=t("../../../../../../../framework/container/Container"),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._param=[],e._refSkill=[],e}return n(e,t),e.prototype.AddContextWrap=function(e){this._param[e.cid]={},t.prototype.AddContextWrap.call(this,e)},e.prototype.RemoveContextWrap=function(e){this._param[e.cid]=null,this._refSkill[e.cid]=null,t.prototype.RemoveContextWrap.call(this,e)},e.prototype.ChangeParams=function(e){var r=this.tlContext[e].refSkillPlan;this._refSkill[e]=r;var o=r.GetSkillParam();this.OnUpdateParam(e,o),t.prototype.ChangeParams.call(this,e)},e.prototype.Enter=function(e){t.prototype.Enter.call(this,e),this._ref=this.ModelBattleSkill.GetSkillTypeMonster(this.resId)},e.prototype.GetCD=function(t){return this._refSkill[t].GetCd()},e.prototype.GetInterval=function(t){return this._refSkill[t].GetInterval()},e.prototype.GetNum=function(t){return this._refSkill[t].GetNum()},e.prototype.GetBullet=function(t,e){return this._refSkill[t].GetBullet(e)},e.prototype.GetHasAnimationClip=function(t,e){var r=this.tlContext[t].eid,o=this.SystemView.GetNodeProxy(r);return!!o&&null!=o.GetAnimationClip(e)},e.prototype.GetAnimationClipDuration=function(t,e){var r=this.tlContext[t];this.assert(null!=r,"context \u4e0d\u5b58\u5728 cid:"+t);var o=r.eid,n=null,i=this.SystemView.GetNodeProxy(o);return i&&(n=i.GetAnimationDruation(e)),n},e.prototype.GetAnimationDruationConjure=function(t,e){return this.tlContext[t].eid,.6*this.GetAnimationClipDuration(t,e)},e.prototype.GetDistance=function(t){var e=this._refSkill,r=0,o=t.cid;return e[o]&&(r=e[o].GetConjureDistance()),r},e.__cname="BaseOthersSkill",i([a.injectField("ModelBattleSkill")],e.prototype,"ModelBattleSkill",void 0),i([a.injectField("Battle")],e.prototype,"Battle",void 0),i([a.injectField("SystemView")],e.prototype,"SystemView",void 0),i([a.injectField("ComState")],e.prototype,"ComState",void 0),e}(t("../BaseSkill").BaseSkill);r.BaseOthersSkill=l,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../BaseSkill":"BaseSkill"}],BasePrefabBehavior:[function(t,e,r){"use strict";cc._RF.push(e,"d96be7yIipLG60LZzwRlq9g","BasePrefabBehavior"),Object.defineProperty(r,"__esModule",{value:!0}),r.BasePrefabBehavior=void 0;var o=function(){function t(){}return t.prototype.Update=function(){},t.__cname="BasePrefabBehavior",t}();r.BasePrefabBehavior=o,cc._RF.pop()},{}],BaseSDKComponent:[function(t,e,r){"use strict";cc._RF.push(e,"38d05oXYv9Lx7pAl7w2MPN3","BaseSDKComponent");var o=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},n=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.BaseSDKComponent=void 0;var i=t("../../../../../framework/FW"),a=t("../../../../bridge/AppBridge"),l=function(){function t(){}return t.prototype.OnDestroy=function(){this.ClearHandler()},t.prototype.ClearHandler=function(){this.pauseHandler&&(a.AppBridge.RemoveEventListener(this.pauseHandler),this.pauseHandler=null),this.resumeHandler&&(a.AppBridge.RemoveEventListener(this.resumeHandler),this.resumeHandler=null)},t.prototype.CallOvertime=function(t,e){return o(this,void 0,void 0,function(){var r,o,l,s,c,u;return n(this,function(n){switch(n.label){case 0:return r=null,o=!1,this.ClearHandler(),l=a.AppBridge.AddEventListener(a.AppBridgeEvent.OnPause,function(){o=!0},this),this.pauseHandler=l,s=a.AppBridge.AddEventListener(a.AppBridgeEvent.OnResume,function(){o=!1,r=cc.director.getTotalTime()+1e3*t},this),this.resumeHandler=s,c=null,u=null,e(function(t){u=t,c=!0}),[4,i.FW.Task.waitUntil(function(){return null==l||null==s?(i.FW.Log.log("\u5220\u9664\u4e0a\u4e00\u6b21\u7684handler"),!0):!o&&(null!=c||(null!=r&&cc.director.getTotalTime()>r?(c=!1,!0):void 0))})];case 1:return n.sent(),[2,u||[]]}})})},t.__cname="BaseSDKComponent",t}();r.BaseSDKComponent=l,cc._RF.pop()},{"../../../../../framework/FW":void 0,"../../../../bridge/AppBridge":"AppBridge"}],BaseSDKObject:[function(t,e,r){"use strict";cc._RF.push(e,"21a957Vs2pAQZjtQV0QFI9I","BaseSDKObject");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.BaseSDKObject=void 0;var l=function(t){function e(e){var r=t.call(this)||this;return r.tmCom=new Map,r.container=e,r}return n(e,t),e.prototype.onDestroy=function(){var t,e;try{for(var r=i(this.tmCom),o=r.next();!o.done;o=r.next()){var n=a(o.value,2);n[0],n[1].OnDestroy()}}catch(l){t={error:l}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},e.prototype.AddComponent=function(t){if(!this.tmCom.has(t)){var e=new t;return this.container.inject(e),e.parent=this,this.tmCom.set(t,e),e}},e.prototype.TryGetComponent=function(t){var e=this.tmCom.get(t);return null==e&&(e=this.AddComponent(t)),e},e.__cname="BaseSDKObject",e}(t("../../../../../framework/base/ScriptObject").ScriptObject);r.BaseSDKObject=l,cc._RF.pop()},{"../../../../../framework/base/ScriptObject":void 0}],BaseSkillHandler:[function(t,e,r){"use strict";cc._RF.push(e,"7044cBtci5AGYTolG/qtiF0","BaseSkillHandler");var o=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},n=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.BaseSkillHandler=void 0;var i=t("../../../../../../../framework/container/Container"),a=function(){function t(){this._findNear=[]}return t.prototype.GetBulletBuilder=function(t){var e=this.ModelBattleSkill.GetBullet(t).GetScript();return this.SystemRole.GetBuilderByAlias(e)},t.prototype.findNear=function(t){var e,r,o=this.ComPos.x,i=this.ComPos.y,a=this.ComVar.REACTION[t],l=(this.ComVar.ALIVE,this.ComVar.CAMP),s=this._findNear;if(s.length=0,this.SystemMove.findOtherCampNoBullet(l[t],o[t],i[t],a,s),0!=s.length){var c,u=Number.MAX_SAFE_INTEGER;try{for(var p=n(s),f=p.next();!f.done;f=p.next()){var h=f.value,y=(o[h]-o[t])*(o[h]-o[t])+(i[h]-i[t])*(i[h]-i[t]);y<u&&(c=h,u=y)}}catch(d){e={error:d}}finally{try{f&&!f.done&&(r=p.return)&&r.call(p)}finally{if(e)throw e.error}}return c}},t.__cname="BaseSkillHandler",o([i.injectField("GPAudio")],t.prototype,"GPAudio",void 0),o([i.injectField("Battle")],t.prototype,"Battle",void 0),o([i.injectField("ModelBattleSkill")],t.prototype,"ModelBattleSkill",void 0),o([i.injectField("SystemRole")],t.prototype,"SystemRole",void 0),o([i.injectField("ComPos")],t.prototype,"ComPos",void 0),o([i.injectField("SystemMove")],t.prototype,"SystemMove",void 0),o([i.injectField("ComVar")],t.prototype,"ComVar",void 0),t}();r.BaseSkillHandler=a,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0}],BaseSkill:[function(t,e,r){"use strict";cc._RF.push(e,"13470RtDkhCpJqvtbxJ4MZ6","BaseSkill");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.BaseSkill=r.SkillState=void 0;var l,s=t("../../../../../../framework/base/ScriptObject"),c=t("../../../../../../framework/container/Container"),u=t("../type/ComType"),p=t("./SkillEventHelper"),f=t("./SkillTriggerHelper");(function(t){t[t.Idle=0]="Idle",t[t.Ready=1]="Ready",t[t.Running=2]="Running"})(l=r.SkillState||(r.SkillState={}));var h=function(t){function e(){var e=t.call(this)||this;return e.tlContextId=new Set,e.tlContext=[],e._findNear=[],e._findRandom=[],e._findRandomMonster=[],e.OnInit(),e}return n(e,t),e.prototype.onDestroy=function(){this.OnRelease()},e.prototype.SetResId=function(t){this.resId=t},e.prototype.GetResId=function(){return this.resId},e.prototype.Enter=function(t){this.triggerHelper=f.SkillTriggerHelper.Create(t),this.eventHelper=p.SkillEventHelper.Create(t),this.OnEnter()},e.prototype.Exit=function(){this.triggerHelper.destroy(),this.eventHelper.destroy(),this.OnExit()},e.prototype.AddContextWrap=function(t){0==this.tlContextId.has(t.cid)&&(this.tlContextId.add(t.cid),this.OnAddContext(t.cid))},e.prototype.RemoveContextWrap=function(t){this.tlContextId.has(t.cid)&&(this.OnRemoveContext(t.cid),this.tlContextId.delete(t.cid))},e.prototype.AddTrigger=function(t){return this.triggerHelper.AddTrigger(t)},e.prototype.AddEvent=function(t){return this.eventHelper.Add(t)},e.prototype.trigeEvent=function(t){this.eventHelper.Trigge(t)},e.prototype.OnInit=function(){},e.prototype.OnRelease=function(){},e.prototype.OnEnter=function(){},e.prototype.OnExit=function(){},e.prototype.OnAddContext=function(){},e.prototype.OnRemoveContext=function(){},e.prototype.ChangeParams=function(t){this.OnChangeParams(t)},e.prototype.findNear=function(t,e){var r,o;void 0===e&&(e=!0);var n=this.tlContext[t].eid,i=this.ComPos.x,l=this.ComPos.y,s=this.ComVar.REACTION[n],c=this.ComVar.ALIVE,p=this.ComVar.CAMP,f=(this.ComType,this._findNear);if(f.length=0,e?this.SystemMove.findOtherCampNoBullet(p[n],i[n],l[n],s,f):this.SystemMove.findNear(i[n],l[n],s,f,function(t){return 0!=c[t]&&p[t]!=p[n]}),0!=f.length){var h,y=Number.MAX_SAFE_INTEGER;try{for(var d=a(f),m=d.next();!m.done;m=d.next()){var v=m.value,_=(i[v]-i[n])*(i[v]-i[n])+(l[v]-l[n])*(l[v]-l[n]),S=this.ComType.GetType(v);_<y&&S!=u.EComType.BossGuardMonster&&(h=v,y=_)}}catch(g){r={error:g}}finally{try{m&&!m.done&&(o=d.return)&&o.call(d)}finally{if(r)throw r.error}}return h}},e.prototype.findRandom=function(){var t,e,r,o=this.ComPos.x,n=this.ComPos.y,i=this.ComType.GetGroup(u.EComType.Monster);if(i.length>0){var l=this._findRandomMonster;l.length=0;try{for(var s=a(i),c=s.next();!c.done;c=s.next()){var p=c.value;this.SystemMove.GetIsGridInView(o[p],n[p])&&l.push(p)}}catch(f){t={error:f}}finally{try{c&&!c.done&&(e=s.return)&&e.call(s)}finally{if(t)throw t.error}}l.length>0&&(r=l[Math.floor(Math.random()*l.length)])}return r},e.prototype.GetBulletBuilder=function(t){return this.SystemRole.GetBulletBuilder(t)},e.prototype.GetIsReady=function(t){return this.GetState(t)==l.Ready},e.prototype.GetIsRunning=function(t){return this.GetState(t)==l.Running},e.prototype.TryRun=function(){return!1},e.prototype.AddContext=function(t){this.tlContext[t.cid]=t,this.AddContextWrap(t)},e.prototype.RemoveContext=function(t){this.RemoveContextWrap(t),this.tlContextId.delete(t.cid)},e.prototype.resetSkillState=function(){},e.__cname="BaseSkill",i([c.injectField("Ref")],e.prototype,"Ref",void 0),i([c.injectField("ComPos")],e.prototype,"ComPos",void 0),i([c.injectField("ComVar")],e.prototype,"ComVar",void 0),i([c.injectField("SystemMove")],e.prototype,"SystemMove",void 0),i([c.injectField("ModelBattleSkill")],e.prototype,"ModelBattleSkill",void 0),i([c.injectField("SystemRole")],e.prototype,"SystemRole",void 0),i([c.injectField("ComType")],e.prototype,"ComType",void 0),e}(s.ScriptObject);r.BaseSkill=h,cc._RF.pop()},{"../../../../../../framework/base/ScriptObject":void 0,"../../../../../../framework/container/Container":void 0,"../type/ComType":"ComType","./SkillEventHelper":"SkillEventHelper","./SkillTriggerHelper":"SkillTriggerHelper"}],BaseSubBattleSystem:[function(t,e,r){"use strict";cc._RF.push(e,"1b2c1/D2B1AU4If12N9OwCm","BaseSubBattleSystem");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.BaseSubBattleSystem=void 0;var i=function(t){function e(e){var r=t.call(this)||this;return r.container=e,r}return n(e,t),e.prototype.OnInit=function(){},e.prototype.onDestroy=function(){},e.prototype.OnEnter=function(){},e.prototype.OnExit=function(){},e.prototype.OnUpdate=function(){},e.__cname="BaseSubBattleSystem",e}(t("../../../../../framework/base/ScriptObject").ScriptObject);r.BaseSubBattleSystem=i,cc._RF.pop()},{"../../../../../framework/base/ScriptObject":void 0}],BaseSubBuffCarrier:[function(t,e,r){"use strict";cc._RF.push(e,"0b51959+9pP+LsuEn/GaM5v","BaseSubBuffCarrier");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a},l=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(a(arguments[e]));return t},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.BaseSubBuffCarrier=void 0;var c=t("../../../../../../../framework/base/ScriptObject"),u=t("../../../../../../../framework/container/Container"),p=t("../../../../../../ref/RefBuffCarrier"),f=t("../../../BattleUtil"),h=t("../trigger/SBCTrigger"),y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.enabled=!1,e.ids=new Map,e.tmContext=new Map,e._gettarget=[],e._near=[],e.tlTrigger=new Set,e}return n(e,t),e.prototype.Setup=function(){this.OnSetup()},e.prototype.AddEntity=function(t){var e=t.Hash();if(this.ids.has(e)){var r=this.ids.get(e);this.ReEnter(r)}else this.ids.set(e,t),this.OnAddEntity(t)},e.prototype.RemoveEntity=function(t){this.ClearTrigger(),this.OnRemoveEntity(t),this.ids.delete(t.Hash())},e.prototype.ReEnter=function(t){this.OnReEnter(t)},e.prototype.OnSetup=function(){},e.prototype.OnReEnter=function(t){if(t.triggerContext){var e=t.triggerContext;e.trigger.Start(e)}},e.prototype.OnAddEntity=function(t){this.tmContext.has(t)&&this.OnRemoveEntity(t);var e=t.sender,r=t.ref,o=this.OnTrigger.bind(this,t),n=this.OnEnd.bind(this,t),i=h.SBCTriggerContext.Create(e,r,o,n);this.tmContext.set(t,i),this.AddTrigger(i),t.triggerContext=i,i.trigger.Start(i)},e.prototype.OnRemoveEntity=function(t){var e=this.tmContext.get(t);e&&this.RemoveTrigger(e)},e.prototype.Update=function(){},e.prototype.OnTrigger=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var o=this.SystemBuffCarrier.GetEffect(t);o.Apply.apply(o,l([t],e))},e.prototype.OnEnd=function(t){this.SystemBuffCarrier.GetEffect(t).Unuse(t),this.SystemBuffCarrier.DeleteHandler(t)},e.prototype.GetTarget=function(t){var e=this,r=this.ComPos.x,o=this.ComPos.y,n=this.ComVar.REACTION,i=this.ComVar.ALIVE,a=this.ComVar.HP,l=this._gettarget;l.length=0;var s=this._near;s.length=0;var c=function(){var i=t.sender;return e.SystemMove.findNear(r[i],o[i],n[i],s),s};switch(this.ModelSkill.GetBuffCarrier(t.resId).GetTargetType()){case p.RefBuffCarrier_TargetType.DEFAULT:l.push(t.target);break;case p.RefBuffCarrier_TargetType.SELF:l.push(t.sender);break;case p.RefBuffCarrier_TargetType.ENEMY_CLOSE:var u=t.sender,h=c();null!=(y=f.BattleUtil.FilterArrByCloser(h,function(t){return(r[t]-r[u])*(r[t]-r[u])+(o[t]-o[u])*(o[t]-o[u])}))&&l.push(y);break;case p.RefBuffCarrier_TargetType.ENEMY_LOW_HP:h=c(),null!=(y=f.BattleUtil.FilterArrByCloser(h,function(t){return 0==i[t]?Number.MAX_SAFE_INTEGER:a[t]}))&&l.push(y);break;case p.RefBuffCarrier_TargetType.ENEMY_RANDOM:var y;(h=c()).length>0&&(y=h[Math.floor(Math.random()*h.length)])&&l.push(y)}return l},e.prototype.AddTrigger=function(t){t=this.SystemBuffCarrier.SubSysBCTrigger.CreateTrigger(t),this.tlTrigger.add(t)},e.prototype.RemoveTrigger=function(t){this.tlTrigger.has(t)&&(this.SystemBuffCarrier.SubSysBCTrigger.DestroyTrigger(t),this.tlTrigger.delete(t))},e.prototype.ClearTrigger=function(){var t,e;try{for(var r=s(this.tlTrigger),o=r.next();!o.done;o=r.next()){var n=o.value;this.RemoveTrigger(n)}}catch(i){t={error:i}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},e.prototype.AllocateTriggerHandler=function(){},e.__cname="BaseSubBuffCarrier",i([u.injectField("ModelSkill")],e.prototype,"ModelSkill",void 0),i([u.injectField("SystemMove")],e.prototype,"SystemMove",void 0),i([u.injectField("ComPos")],e.prototype,"ComPos",void 0),i([u.injectField("ComVar")],e.prototype,"ComVar",void 0),i([u.injectField("SystemBuffCarrier")],e.prototype,"SystemBuffCarrier",void 0),e}(c.ScriptObject);r.BaseSubBuffCarrier=y,cc._RF.pop()},{"../../../../../../../framework/base/ScriptObject":void 0,"../../../../../../../framework/container/Container":void 0,"../../../../../../ref/RefBuffCarrier":"RefBuffCarrier","../../../BattleUtil":"BattleUtil","../trigger/SBCTrigger":"SBCTrigger"}],BaseViewSystem:[function(t,e,r){"use strict";cc._RF.push(e,"9620bjdg9ZKN6jiUhcYh/yF","BaseViewSystem");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.BaseViewSystem=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.request=function(t){return this.systemHandler.Request(t)},e.__cname="BaseViewSystem",e}(t("../base/BaseBattleSystem").BaseBattleSystem);r.BaseViewSystem=i,cc._RF.pop()},{"../base/BaseBattleSystem":"BaseBattleSystem"}],BattleAttrBehavior:[function(t,e,r){"use strict";cc._RF.push(e,"435f3YnACFLD5uO5ISN04/M","BattleAttrBehavior");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.BattleAttrBehavior=void 0;var l=t("../../../../../../../framework/container/Container"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnGetRef=function(){return this.ModelSkill.GetBuff(this.resIdOrGroupId)},e.prototype.OnApply=function(){var t,e;try{for(var r=a(this.ref.GetEffect()),o=r.next();!o.done;o=r.next()){var n=o.value,i=n.resId,l=n.value,s=this.ComVar.HERO_ATTR;i&&s.ModifyByResId(i,l)}}catch(c){t={error:c}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},e.prototype.OnUnuse=function(){var t,e;try{for(var r=a(this.ref.GetEffect()),o=r.next();!o.done;o=r.next()){var n=o.value,i=n.resId,l=n.value,s=this.ComVar.HERO_ATTR;i&&s.ModifyByResId(i,-l)}}catch(c){t={error:c}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},e.__cname="BattleAttrBehavior",i([l.injectField("ComVar")],e.prototype,"ComVar",void 0),i([l.injectField("ModelSkill")],e.prototype,"ModelSkill",void 0),e}(t("../BaseBattleBuffBehavior").BaseBattleBuffBehavior);r.BattleAttrBehavior=s,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../BaseBattleBuffBehavior":"BaseBattleBuffBehavior"}],BattleAttr:[function(t,e,r){"use strict";cc._RF.push(e,"a66054d3EpIYZF7iHGVRFqN","BattleAttr"),Object.defineProperty(r,"__esModule",{value:!0}),r.BattleAttr=void 0;r.BattleAttr=function(){},cc._RF.pop()},{}],BattleBuffBehaviorMgr:[function(t,e,r){"use strict";cc._RF.push(e,"85ad3nVBQVOiYVBYkxnKGhu","BattleBuffBehaviorMgr");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.BattleBuffBehaviorMgr=r.BattleBuffBehaviorContext=void 0;var s=t("../../../../../../framework/container/Container"),c=t("../../../../../../framework/FW"),u=t("../../../../../ref/RefBuff"),p=t("../../../buff/base/BuffBehavior"),f=t("./custom/BaseBattleCustomBehavior"),h=t("./luncher/BattleLuncherBehavior"),y=t("./luncher/BattleLuncher_1010331");r.BattleBuffBehaviorContext=function(){};var d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tmType2Behavior=new Map,e.tmTrigger2Behavior=new Map,e.tmBehavior2Trigger=new Map,e.tmLuncherClass=new Map,e}return n(e,t),e.Create=function(t){var r=new e;return r.container=t,t.inject(r),r},e.prototype.OnFilter=function(t){return!(t instanceof u.RefBuff&&1==t.GetPreCalculate())},e.prototype.Start=function(){var t,e,r,o,n=[];try{for(var i=a(this.ModelSkill.GetTmBuff()),s=i.next();!s.done;s=i.next()){var u=l(s.value,2),p=(u[0],u[1]),f=p.GetEventType(),h=this.GetBuffByType(f),d=p.GetRef().refId;null!=h?this.SetBuffClass(d,h):n.push(d)}}catch(S){t={error:S}}finally{try{s&&!s.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}n.length>0&&c.FW.ZJJ.warn("buff \u4e8b\u4ef6\u7c7b\u578b\u672a\u6ce8\u518c:"+n.join(",")),this.RegistLuncherClass(1010331,y.BattleLuncher_1010331);try{for(var m=a(this.ModelSkill.GetTlLuncherGroup()),v=m.next();!v.done;v=m.next()){var _=v.value;this.HandleLuncherClass(_)}}catch(g){r={error:g}}finally{try{v&&!v.done&&(o=m.return)&&o.call(m)}finally{if(r)throw r.error}}},e.prototype.Update=function(){},e.prototype.CreateBehavior=function(t){var e;if(null==e){var r=this.ModelSkill.GetBuff(t);if(null!=r){var o=r.GetEventType();e=this.GetBuffByType(o)}}if(null==e&&this.tmBehavior.has(t)&&(e=this.tmBehavior.get(t)),null==e)return c.FW.ZJJ.warn("buff id \u672a\u6ce8\u518c:"+t),null;var n=new e;return this.container.inject(n),n.Init(t),this.OnFilter(n.GetRef())?this.OnCreateBehavior(t,n):n=null,n},e.prototype.OnCreateBehavior=function(t,e){var r,o;if(null!=e&&e instanceof f.BaseBattleCustomBehavior!=0)try{for(var n=a(e.GetBuffTriggerType()),i=n.next();!i.done;i=n.next()){var l=i.value;this.RegisterTriggerEvent(l,e)}}catch(s){r={error:s}}finally{try{i&&!i.done&&(o=n.return)&&o.call(n)}finally{if(r)throw r.error}}},e.prototype.OnDestroyBehavior=function(t){this.UnRegisterTriggerEvent(t)},e.prototype.SetBuffByType=function(t,e){this.tmType2Behavior.set(t,e)},e.prototype.GetBuffByType=function(t){return this.tmType2Behavior.get(t)},e.prototype.GetTrigger2Behavior=function(t){var e=this.tmTrigger2Behavior.get(t);return null==e&&(e=new Set,this.tmTrigger2Behavior.set(t,e)),e},e.prototype.GetBehavior2Trigger=function(t){var e=this.tmBehavior2Trigger.get(t);return null==e&&(e=new Set,this.tmBehavior2Trigger.set(t,e)),e},e.prototype.SendTriggerEvent=function(t,e){var r,o;try{for(var n=a(this.GetTrigger2Behavior(t)),i=n.next();!i.done;i=n.next())i.value.OnTrigger(t,e)}catch(l){r={error:l}}finally{try{i&&!i.done&&(o=n.return)&&o.call(n)}finally{if(r)throw r.error}}},e.prototype.RegisterTriggerEvent=function(t,e){this.GetTrigger2Behavior(t).add(e),this.GetBehavior2Trigger(e).add(t)},e.prototype.UnRegisterTriggerEvent=function(t){var e,r;try{for(var o=a(this.GetBehavior2Trigger(t)),n=o.next();!n.done;n=o.next()){var i=n.value;this.tmTrigger2Behavior.get(i).delete(t)}}catch(l){e={error:l}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}this.tmBehavior2Trigger.delete(t)},e.prototype.RegistLuncherClass=function(t,e){this.assert(0==this.tmLuncherClass.has(t),"\u53d1\u5c04\u5668\u91cd\u590d\u6ce8\u518c:"+t),this.tmLuncherClass.set(t,e)},e.prototype.HandleLuncherClass=function(t){var e=this.tmLuncherClass.get(t);null==e&&(e=h.BattleLuncherBehavior),this.SetBuffClass(t,e)},e.__cname="BattleBuffBehaviorMgr",i([s.injectField("ModelSkill")],e.prototype,"ModelSkill",void 0),e}(p.BuffBehaviorMgr);r.BattleBuffBehaviorMgr=d,cc._RF.pop()},{"../../../../../../framework/FW":void 0,"../../../../../../framework/container/Container":void 0,"../../../../../ref/RefBuff":"RefBuff","../../../buff/base/BuffBehavior":"BuffBehavior","./custom/BaseBattleCustomBehavior":"BaseBattleCustomBehavior","./luncher/BattleLuncherBehavior":"BattleLuncherBehavior","./luncher/BattleLuncher_1010331":"BattleLuncher_1010331"}],BattleBuffProxy:[function(t,e,r){"use strict";cc._RF.push(e,"9f8acaHZptCYY4UzxOGlA05","BattleBuffProxy");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.BattleBuffProxyMgr=r.BattleBuffProxy=void 0;var i=t("../../../buff/base/BuffProxy"),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.SetupBehavior=function(){t.prototype.SetupBehavior.call(this)},e.__cname="BattleBuffProxy",e}(i.BuffProxy);r.BattleBuffProxy=a;var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.Create=function(t,r){var o=new e;return o.container=t,o.BuffBehaviorMgr=r,t.inject(o),o},e.prototype.GetProxyClazz=function(){return a},e.__cname="BattleBuffProxyMgr",e}(i.BuffProxyMgr);r.BattleBuffProxyMgr=l,cc._RF.pop()},{"../../../buff/base/BuffProxy":"BuffProxy"}],BattleBuff_201104:[function(t,e,r){"use strict";cc._RF.push(e,"43159qkyuJGm4H1PlsWJ0TS","BattleBuff_201104");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.BattleBuff_201104=void 0;var a=t("../../../../../../../framework/container/Container"),l=t("../../../../../../../framework/FW"),s=t("../../../../../../../framework/utils/Toolset"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnGetRef=function(){return this.ModelSkill.GetBuff(this.resIdOrGroupId)},e.prototype.OnInit=function(){this.toolSet=s.ToolSet.createToolSet()},e.prototype.OnRelease=function(){s.ToolSet.destroyToolSet(this.toolSet)},e.prototype.OnApply=function(){var t=this;this.GPSkillData.skillReday?this.OnSkillReady():this.toolSet.addCallback(this.GPSkillData.SkillReadyCallback,function(){t.OnSkillReady(),t.toolSet.removeAllCallback()})},e.prototype.OnUnuse=function(){this.toolSet.removeAllCallback()},e.prototype.OnSkillReady=function(){var t=this.ref.GetEvent(),e=parseInt(t.p1),r=parseInt(t.p2);if(null!=e&&null!=r){var o=this.GPHeroSkill.GetSkill(e);(null==o?void 0:o.GetLevel())<r&&(this.GPHeroSkill.UpgradeSkill(e,r),o.Apply())}else l.FW.ZJJ.error("\u8bf7\u7b56\u5212\u68c0\u67e5 buff type: "+this.ref.GetRefId()+" skillId:"+e+" level:"+r)},e.__cname="BattleBuff_201104",i([a.injectField("ComVar")],e.prototype,"ComVar",void 0),i([a.injectField("ModelSkill")],e.prototype,"ModelSkill",void 0),i([a.injectField("GPHeroSkill")],e.prototype,"GPHeroSkill",void 0),i([a.injectField("GPSkillData")],e.prototype,"GPSkillData",void 0),i([a.injectField("SystemSkill")],e.prototype,"SystemSkill",void 0),e}(t("../BaseBattleBuffBehavior").BaseBattleBuffBehavior);r.BattleBuff_201104=c,cc._RF.pop()},{"../../../../../../../framework/FW":void 0,"../../../../../../../framework/container/Container":void 0,"../../../../../../../framework/utils/Toolset":void 0,"../BaseBattleBuffBehavior":"BaseBattleBuffBehavior"}],BattleBuff_201206:[function(t,e,r){"use strict";cc._RF.push(e,"1e948zz5jBDSIKA3Hvf0B+u","BattleBuff_201206");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.BattleBuff_201206=void 0;var a=t("../../../../../../../framework/container/Container"),l=t("../../../../../../../framework/utils/Toolset"),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.SKILL_ID=[10006,10007],e}return n(e,t),e.prototype.OnInit=function(){this.toolset=l.ToolSet.createToolSet(),t.prototype.OnInit.call(this)},e.prototype.OnRelease=function(){l.ToolSet.destroyToolSet(this.toolset),t.prototype.OnRelease.call(this)},e.prototype.OnApply=function(){this.handler=this.toolset.addListener(this.BuffVarMgr.GetEventProxy(),"OnDamage",this.OnDamage,this)},e.prototype.OnUnuse=function(){this.handler&&(this.toolset.removeListener(this.handler),this.handler=null)},e.prototype.OnDamage=function(t,e){var r=e.GetSkillId();if(null!=r&&-1!=this.SKILL_ID.indexOf(r)){var o=this.ref.GetEvent();if(o){var n=parseInt(o.p2)/1e4,i=this.ComVar.HEROID,a=this.ComVar.HP_Max[i],l=Math.max(0,a*n);l>0&&this.ComVar.takeRDE(i,l)}}},e.__cname="BattleBuff_201206",i([a.injectField("BuffVarMgr")],e.prototype,"BuffVarMgr",void 0),i([a.injectField("SystemBuffCarrier")],e.prototype,"SystemBuffCarrier",void 0),i([a.injectField("ComVar")],e.prototype,"ComVar",void 0),e}(t("./BaseBattleCustomBehavior").BaseBattleCustomBehavior);r.BattleBuff_201206=s,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../../../../../../framework/utils/Toolset":void 0,"./BaseBattleCustomBehavior":"BaseBattleCustomBehavior"}],BattleBuff_201304:[function(t,e,r){"use strict";cc._RF.push(e,"f6cc5AUrwNP+aXQRDf1D7we","BattleBuff_201304");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.BattleBuff_201304=void 0;var a=t("../../../../../../../framework/container/Container"),l=t("../../../../../../../framework/utils/Toolset"),s=t("../../event/SystemEvent"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnInit=function(){this.toolset=l.ToolSet.createToolSet(),t.prototype.OnInit.call(this)},e.prototype.OnRelease=function(){l.ToolSet.destroyToolSet(this.toolset),t.prototype.OnRelease.call(this)},e.prototype.OnApply=function(){var t=this;this.handler=this.toolset.addListener(this.SystemEvent.GetEventPorxy(),s.EBattleEvent.TriggerReadyDie,function(e){var r=e.GetSkillId();10004!=r&&10005!=r||t.SystemSkill.GetSkillById(r).recoverBullet()})},e.prototype.OnUnuse=function(){this.handler&&(this.toolset.removeListener(this.handler),this.handler=null)},e.__cname="BattleBuff_201304",i([a.injectField("BuffVarMgr")],e.prototype,"BuffVarMgr",void 0),i([a.injectField("SystemBuffCarrier")],e.prototype,"SystemBuffCarrier",void 0),i([a.injectField("ComVar")],e.prototype,"ComVar",void 0),i([a.injectField("SystemEvent")],e.prototype,"SystemEvent",void 0),i([a.injectField("SystemSkill")],e.prototype,"SystemSkill",void 0),e}(t("./BaseBattleCustomBehavior").BaseBattleCustomBehavior);r.BattleBuff_201304=c,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../../../../../../framework/utils/Toolset":void 0,"../../event/SystemEvent":"SystemEvent","./BaseBattleCustomBehavior":"BaseBattleCustomBehavior"}],BattleBuff_201503:[function(t,e,r){"use strict";cc._RF.push(e,"b9e17N5BxFOU4S2ZPJ6V1kd","BattleBuff_201503");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.BattleBuff_201503=void 0;var a=t("../../../../../../../framework/container/Container"),l=t("../../../../../../../framework/utils/Toolset"),s=t("../../buffCarrier/role/BuffCarrierHandler"),c=t("./BaseBattleCustomBehavior"),u=[10038,10037,10021],p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnInit=function(){this.toolset=l.ToolSet.createToolSet(),t.prototype.OnInit.call(this)},e.prototype.OnRelease=function(){l.ToolSet.destroyToolSet(this.toolset),t.prototype.OnRelease.call(this)},e.prototype.OnApply=function(){this.handler=this.toolset.addListener(this.BuffVarMgr.GetEventProxy(),"OnDamage",this.OnDamage,this)},e.prototype.OnUnuse=function(){this.handler&&(this.toolset.removeListener(this.handler),this.handler=null)},e.prototype.OnDamage=function(t,e){if(e.GetSender()==this.ComVar.HEROID||10021==e.GetSkillId()){var r=e.GetSkillId();if(null!=r&&-1!=u.indexOf(r)){if(10021==r&&0==this.ComVar.CalHeroAttr("s7066",0))return;var o=this.ref.GetEvent();if(o){var n=parseInt(o.p1),i=s.BuffCarrierHandler.Create(e.sid,e.tid,n);this.SystemBuffCarrier.HandlerBuff(i)}}}},e.__cname="BattleBuff_201503",i([a.injectField("BuffVarMgr")],e.prototype,"BuffVarMgr",void 0),i([a.injectField("SystemBuffCarrier")],e.prototype,"SystemBuffCarrier",void 0),i([a.injectField("ComVar")],e.prototype,"ComVar",void 0),e}(c.BaseBattleCustomBehavior);r.BattleBuff_201503=p,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../../../../../../framework/utils/Toolset":void 0,"../../buffCarrier/role/BuffCarrierHandler":"BuffCarrierHandler","./BaseBattleCustomBehavior":"BaseBattleCustomBehavior"}],BattleBuff_201504:[function(t,e,r){"use strict";cc._RF.push(e,"b8dd59+osREeIphpvlH0vpD","BattleBuff_201504");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.BattleBuff_201504=void 0;var a=t("../../../../../../../framework/container/Container"),l=t("../../../../../../../framework/utils/Toolset"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnInit=function(){this.toolset=l.ToolSet.createToolSet(),t.prototype.OnInit.call(this)},e.prototype.OnRelease=function(){l.ToolSet.destroyToolSet(this.toolset),t.prototype.OnRelease.call(this)},e.prototype.OnApply=function(){this.ComVar.SKILL_REPEL[10038]=1,this.ComVar.SKILL_REPEL[10037]=1},e.prototype.OnUnuse=function(){this.ComVar.SKILL_REPEL[10038]=0,this.ComVar.SKILL_REPEL[10037]=0},e.__cname="BattleBuff_201504",i([a.injectField("BuffVarMgr")],e.prototype,"BuffVarMgr",void 0),i([a.injectField("SystemBuffCarrier")],e.prototype,"SystemBuffCarrier",void 0),i([a.injectField("ComVar")],e.prototype,"ComVar",void 0),e}(t("./BaseBattleCustomBehavior").BaseBattleCustomBehavior);r.BattleBuff_201504=s,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../../../../../../framework/utils/Toolset":void 0,"./BaseBattleCustomBehavior":"BaseBattleCustomBehavior"}],BattleConfigBase:[function(t,e,r){"use strict";cc._RF.push(e,"ecabdpaO41AEb3cJrSKdXRn","BattleConfigBase");var o=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},n=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.BattleConfigBase=void 0;var i=t("../../../../../framework/container/Container"),a=t("../../../../../framework/FW"),l=t("../../../model/vo/Goods/Goods"),s=function(){function t(){}return t.prototype.GetConfig=function(){return this.config},t.prototype.UpdateMap=function(t){var e=this.config,r=this.ModelFuben.GetFuben(t);e.fubenId=t,e.waveId=r.GetRef().waveId,e.map=r.GetRef().mapId,e.enterGold=r.GetRef().chestId||null},t.prototype.UpdateHero=function(t){var e,r=this.ModelFuben.GetFuben(t).GetModify(),o=this.config,n=this.ModelEquip.GetWearData().get(l.EGoodsType.weapon);n&&(e=this.ModelEquip.GetEquipMainSkill(n.GetRefId(),n.GetQuality()));var i=(null==r?void 0:r.hero)||this.ModelMgr.ModelRole.GetRole().GetHeroId(),a=this.ModelMgr.ModelHero.GetHeroRef(i),s=a&&a.weapon;o.hero=i,o.roleLevelMonster=1,o.roleLevelGold=1,o.mainSkill=(null==r?void 0:r.mainSkill)||e||s||1e4},t.prototype.UpdateSkill=function(t){var e,r,o,i,l=this.config,s=this.ModelFuben.GetFuben(t),c=this.Ref.RefMgrfuBenCanUseSkillGroupRef.getRef("resId",s.GetRef().canUseSkillGroupResId),u=new Set;try{for(var p=n(c.skill),f=p.next();!f.done;f=p.next()){var h=f.value;u.add(h)}}catch(S){e={error:S}}finally{try{f&&!f.done&&(r=p.return)&&r.call(p)}finally{if(e)throw e.error}}a.FW.LWX.log("\u5f53\u524d\u8fdb\u5165\u526f\u672c\u53ef\u7528\u6b66\u5668id:",u);var y=this.ModelBattle.GetUnlockCommonSkill();a.FW.LWX.log("\u5f53\u524d\u8fdb\u5165\u73a9\u5bb6\u53ef\u7528\u6b66\u5668id:",y),l.skills=[];try{for(var d=n(y||[]),m=d.next();!m.done;m=d.next()){var v=m.value;u.has(v)&&l.skills.push(v)}}catch(g){o={error:g}}finally{try{m&&!m.done&&(i=d.return)&&i.call(d)}finally{if(o)throw o.error}}var _=this.config.mainSkill;_&&-1==l.skills.indexOf(_)&&l.skills.push(_)},t.prototype.UpdateSupply=function(t){var e,r,o,i,l=this.config,s=this.ModelFuben.GetFuben(t),c=this.Ref.RefMgrfuBenCanUseSkillGroupRef.getRef("resId",s.GetRef().canUseSkillGroupResId),u=new Set;try{for(var p=n(c.supply),f=p.next();!f.done;f=p.next()){var h=f.value;u.add(h)}}catch(_){e={error:_}}finally{try{f&&!f.done&&(r=p.return)&&r.call(p)}finally{if(e)throw e.error}}a.FW.LWX.log("\u5f53\u524d\u8fdb\u5165\u526f\u672c\u53ef\u7528\u88ab\u52a8id:",u);var y=this.ModelBattle.GetUnlockCommonSupply();a.FW.LWX.log("\u5f53\u524d\u8fdb\u5165\u73a9\u5bb6\u53ef\u7528\u88ab\u52a8id:",y),l.supply=[];try{for(var d=n(this.ModelBattle.GetUnlockCommonSupply()),m=d.next();!m.done;m=d.next()){var v=m.value;u.has(v)&&l.supply.push(v)}}catch(S){o={error:S}}finally{try{m&&!m.done&&(i=d.return)&&i.call(d)}finally{if(o)throw o.error}}},t.prototype.UpdateOthers=function(){var t=this.config;t.starttime=0,t.skillLimit=6,t.skillSelectNum=3,t.syncData=!0,t.debug=!1,this.UpdateAttr()},t.prototype.UpdateBuff=function(t,e){var r,o,i=this,a=[];this.config.buffs=a;try{for(var l=n(this.CtrlBuff.GetTlAllSkillGroupId()),s=l.next();!s.done;s=l.next()){var c=s.value;a.push(c)}}catch(u){r={error:u}}finally{try{s&&!s.done&&(o=l.return)&&o.call(l)}finally{if(r)throw r.error}}(null==e?void 0:e.length)>0&&e.forEach(function(t){var e=i.Ref.RefMgrchapterBuff.getRef("resId",t);(null==e?void 0:e.buffId)&&a.push(e.buffId)})},t.prototype.UpdateAttr=function(){var t=this.config;t.refreshSkill=0,t.enterSelector=!1;var e=this.CtrlAttr.GetAttrByKey("\u5f3a\u8fd0");t.enterSelector=0!=e.GetValue(),e=this.CtrlAttr.GetAttrByKey("\u7075\u6d3b"),t.refreshSkill=Math.floor(e.GetValue())},o([i.injectField("Ref")],t.prototype,"Ref",void 0),o([i.injectField("ModelMgr")],t.prototype,"ModelMgr",void 0),o([i.injectField("ModelFuben")],t.prototype,"ModelFuben",void 0),o([i.injectField("ModelBattle")],t.prototype,"ModelBattle",void 0),o([i.injectField("ModelEquip")],t.prototype,"ModelEquip",void 0),o([i.injectField("CtrlBuff")],t.prototype,"CtrlBuff",void 0),o([i.injectField("CtrlAttr")],t.prototype,"CtrlAttr",void 0),t}();r.BattleConfigBase=s,cc._RF.pop()},{"../../../../../framework/FW":void 0,"../../../../../framework/container/Container":void 0,"../../../model/vo/Goods/Goods":"Goods"}],BattleConfigChapter:[function(t,e,r){"use strict";cc._RF.push(e,"b9d64gN+JREyog3Rz8ZzqvQ","BattleConfigChapter");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.BattleConfigChapter=void 0;var a=t("../../../../../framework/container/Container"),l=t("../BattleStartConfig"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.Setup=function(t){this.config=new l.BattleStartConfig;var e=this.Ref.RefMgrchapterRef.getRef("resId",t.resId);this.config.notDropGold=e.difficulty>1,this.UpdateMap(e.fuben),this.UpdateHero(e.fuben),this.UpdateSkill(e.fuben),this.UpdateSupply(e.fuben),this.UpdateBuff(e.fuben,e.bonus),this.UpdateOthers(),this.UpdateChapterKey(),this.UpdateDifficult(e),this.SetUnlockSkill(e)},e.prototype.UpdateChapterKey=function(){var t=this.ModelChapter.GetChapterMonsterStrong();this.config.roleLevelMonster=t.GetStrong_Chapter()},e.prototype.UpdateDifficult=function(t){var e=this.config;t.difficulty>1&&(e.skillChestGoldDisable=!0,e.levelUpGuaranteeHp=!0)},e.prototype.SetUnlockSkill=function(t){var e=this.ModelVO.VOChapterBag.Get(t.resId);if(!e||!e.GetIsClearance()){var r=this.config;t.unlockSkill&&t.unlockSkill.length>0&&(r.tlUnlockSkillId=t.unlockSkill)}},e.__cname="BattleConfigChapter",i([a.injectField("ModelChapter")],e.prototype,"ModelChapter",void 0),i([a.injectField("ModelVO")],e.prototype,"ModelVO",void 0),e}(t("./BattleConfigBase").BattleConfigBase);r.BattleConfigChapter=s,cc._RF.pop()},{"../../../../../framework/container/Container":void 0,"../BattleStartConfig":"BattleStartConfig","./BattleConfigBase":"BattleConfigBase"}],BattleConfigDaily:[function(t,e,r){"use strict";cc._RF.push(e,"e50bbSrKE5OaJyfHT+7rNaY","BattleConfigDaily");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.BattleConfigDaily=void 0;var a=t("../../../../../framework/container/Container"),l=t("../BattleStartConfig"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.Setup=function(t){this.config=new l.BattleStartConfig;var e=this.Ref.RefMgrfuBenDailyPlan.getRef("resId",t.resId);this.UpdateMap(e.fuben),this.UpdateHero(e.fuben),this.UpdateSkill(e.fuben),this.UpdateSupply(e.fuben),this.UpdateBuff(e.fuben),this.UpdateOthers(),this.UpdateChapterKey()},e.prototype.UpdateChapterKey=function(){var t=this.ModelChapter.GetChapterMonsterStrongLvPass();this.config.roleLevelMonster=t.GetStrong_Daily()},e.__cname="BattleConfigDaily",i([a.injectField("Ref")],e.prototype,"Ref",void 0),i([a.injectField("ModelHero")],e.prototype,"ModelHero",void 0),i([a.injectField("ModelChapter")],e.prototype,"ModelChapter",void 0),e}(t("./BattleConfigBase").BattleConfigBase);r.BattleConfigDaily=s,cc._RF.pop()},{"../../../../../framework/container/Container":void 0,"../BattleStartConfig":"BattleStartConfig","./BattleConfigBase":"BattleConfigBase"}],BattleConfigField:[function(t,e,r){"use strict";cc._RF.push(e,"3d557Bm6aNIS4TdZQsZoWn3","BattleConfigField");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.BattleConfigField=void 0;var l=t("../BattleStartConfig"),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._skill=new Map,e}return n(e,t),e.prototype.Setup=function(){this.config=new l.BattleStartConfig},e.prototype.SetupByParam=function(t,e,r,o){var n=t;this.UpdateMap(n),this.UpdateHero(n),this.UpdateSkill(n),this.UpdateSupply(n),this.UpdateBuff(n),this.UpdateOthers(),this.UpdateConfigField(n),this.config.noEvent=!0,this.config.syncData=!1,this.config.roleLevelMonster=o,this.config.debugField=!0,this.config.debugFieldMonster=e,this.config.debugFieldFieldType=r},e.prototype.UpdateConfigField=function(){var t,e,r={cmdBattleBeat:{}};r.cmdBattleBeat.roles=[];var o={roleId:this.config.hero,level:0,exp:0,skill:[],supply:[]};r.cmdBattleBeat.roles.push(o);try{for(var n=i(this._skill),l=n.next();!l.done;l=n.next()){var s=a(l.value,2),c=s[0],u=s[1];o.skill.push({resId:c,level:u})}}catch(p){t={error:p}}finally{try{l&&!l.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.GetMainSkill()&&(this.config.mainSkill=this.GetMainSkill()),this.config.resumeData=r},e.prototype.SetSkill=function(t,e){this._skill.set(t,e)},e.prototype.ResetSkill=function(){this._skill.clear()},e.prototype.SetMainSkill=function(t){this._MainSkill=t},e.prototype.GetMainSkill=function(){return this._MainSkill},e.__cname="BattleConfigField",e}(t("./BattleConfigBase").BattleConfigBase);r.BattleConfigField=s,cc._RF.pop()},{"../BattleStartConfig":"BattleStartConfig","./BattleConfigBase":"BattleConfigBase"}],BattleConfigGold:[function(t,e,r){"use strict";cc._RF.push(e,"10439jmScVMapnFcYAHrSbo","BattleConfigGold");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.BattleConfigGold=void 0;var a=t("../../../../../framework/container/Container"),l=t("../BattleStartConfig"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.Setup=function(t){this.config=new l.BattleStartConfig;var e=this.Ref.RefMgrfuBenGoldPlan.getRef("resId",t.resId);this.UpdateMap(e.fuben),this.UpdateHero(e.fuben),this.UpdateSkill(e.fuben),this.UpdateSupply(e.fuben),this.UpdateBuff(e.fuben),this.UpdateOthers(),this.UpdateMagnet(),this.UpdateRoleLevel(t.level),this.UpdateChapterKey()},e.prototype.UpdateMagnet=function(){this.config.superMagnet=!0},e.prototype.UpdateRoleLevel=function(){this.config},e.prototype.UpdateChapterKey=function(){var t=this.ModelChapter.GetChapterMonsterStrongLvPass(),e=this.config;e.roleLevelMonster=t.GetStrong_Gold(),e.roleLevelGold=t.GetGold_Gold()},e.__cname="BattleConfigGold",i([a.injectField("Ref")],e.prototype,"Ref",void 0),i([a.injectField("ModelHero")],e.prototype,"ModelHero",void 0),i([a.injectField("ModelRole")],e.prototype,"ModelRole",void 0),i([a.injectField("ModelFuben")],e.prototype,"ModelFuben",void 0),i([a.injectField("ModelChapter")],e.prototype,"ModelChapter",void 0),e}(t("./BattleConfigBase").BattleConfigBase);r.BattleConfigGold=s,cc._RF.pop()},{"../../../../../framework/container/Container":void 0,"../BattleStartConfig":"BattleStartConfig","./BattleConfigBase":"BattleConfigBase"}],BattleConfigGuide:[function(t,e,r){"use strict";cc._RF.push(e,"a92ddnuu1lPS7TlSxhqp+Wq","BattleConfigGuide");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.BattleConfigGuide=void 0;var a=t("../BattleStartConfig"),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.Setup=function(){this.config=new a.BattleStartConfig,this.UpdateMap(100004),this.UpdateHero(100004),this.UpdateSkill(100004),this.UpdateSupply(100004),this.UpdateBuff(100004),this.UpdateOthers(),this.UpdateConfigGuide(100004),this.config.syncData=!1},e.prototype.UpdateConfigGuide=function(t){var e,r,o={cmdBattleBeat:{}};o.cmdBattleBeat.roles=[];var n={roleId:this.config.hero,level:0,exp:0,skill:[],supply:[]};o.cmdBattleBeat.roles.push(n);var a=this.ModelFuben.GetFuben(t).GetModifySkill();if(a)try{for(var l=i(a),s=l.next();!s.done;s=l.next()){var c=s.value;n.skill.push({resId:c.resId,level:c.level})}}catch(u){e={error:u}}finally{try{s&&!s.done&&(r=l.return)&&r.call(l)}finally{if(e)throw e.error}}this.config.resumeData=o},e.__cname="BattleConfigGuide",e}(t("./BattleConfigBase").BattleConfigBase);r.BattleConfigGuide=l,cc._RF.pop()},{"../BattleStartConfig":"BattleStartConfig","./BattleConfigBase":"BattleConfigBase"}],BattleDoAddBuff:[function(t,e,r){"use strict";cc._RF.push(e,"01183BIythJbL+sVa7dJKUa","BattleDoAddBuff");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.BattleDoAddBuff=void 0;var l=t("../../../../../../../framework/container/Container"),s=t("../../buffCarrier/role/BuffCarrierHandler"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnGetRef=function(){return this.ModelSkill.GetBuff(this.resIdOrGroupId)},e.prototype.OnApply=function(){var t=parseInt(this.ref.GetEvent().p1),e=this.ComVar.HEROID,r=s.BuffCarrierHandler.Create(e,e,t);this.tlHandler=this.SystemBuffCarrier.HandlerBuff(r)},e.prototype.OnUnuse=function(){var t,e;if(this.tlHandler)try{for(var r=a(this.tlHandler),o=r.next();!o.done;o=r.next()){var n=o.value;this.SystemBuffCarrier.DeleteHandler(n)}}catch(i){t={error:i}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},e.__cname="BattleDoAddBuff",i([l.injectField("ModelSkill")],e.prototype,"ModelSkill",void 0),i([l.injectField("ComVar")],e.prototype,"ComVar",void 0),i([l.injectField("SystemBuffCarrier")],e.prototype,"SystemBuffCarrier",void 0),e}(t("../BaseBattleBuffBehavior").BaseBattleBuffBehavior);r.BattleDoAddBuff=c,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../buffCarrier/role/BuffCarrierHandler":"BuffCarrierHandler","../BaseBattleBuffBehavior":"BaseBattleBuffBehavior"}],BattleLayerOrder:[function(t,e,r){"use strict";cc._RF.push(e,"e08d63qkmZAcZCc6igCpgLb","BattleLayerOrder"),Object.defineProperty(r,"__esModule",{value:!0}),r.BattleLayerOrder=void 0,function(t){t[t.Scene=1]="Scene",t[t.Joystick=100]="Joystick",t[t.Main=200]="Main",t[t.CameraEffect=300]="CameraEffect",t[t.OneLevel=400]="OneLevel",t[t.TwoLevel=500]="TwoLevel",t[t.ThreeLevel=600]="ThreeLevel",t[t.Tips=1e3]="Tips"}(r.BattleLayerOrder||(r.BattleLayerOrder={})),cc._RF.pop()},{}],BattleLuncherBehavior:[function(t,e,r){"use strict";cc._RF.push(e,"c501dniceZMuLfQZHoh4syV","BattleLuncherBehavior");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.BattleLuncherBehavior=void 0;var l=t("../../../../../../../framework/container/Container"),s=t("../../../../buff/base/BuffBehavior"),c=t("../../gameplay/sub/GPSkillData"),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnGetRef=function(){var t=this.resIdOrGroupId;return this.ModelSkill.GetTlRefSkillLuncher(t)},e.prototype.OnApply=function(){var t,e,r,o,n=c.ModifyBulletReason.Weapon;try{for(var i=a(this.ref),l=i.next();!l.done;l=i.next()){var s=l.value,u=s.GetSkillId(),p=s.GetBullet(),f=s.GetLevel();this.assert(null!=u,"\u6280\u80fd\u53d1\u5c04\u5668\u9519\u8bef",this.ref),this.GPSkillData.SetSkillBullet(n,u,f,p);try{for(var h=(r=void 0,a(s.GetAttr())),y=h.next();!y.done;y=h.next()){var d=y.value;this.GPSkillData.SetSkillAttr(u,this,d.resId,d.value)}}catch(S){r={error:S}}finally{try{y&&!y.done&&(o=h.return)&&o.call(h)}finally{if(r)throw r.error}}var m=s.GetParam();null!=m&&m.length>0&&this.GPSkillData.SetSkillParam(u,m,this);var v=s.GetBulletParam();if(null!=v&&v.length>0){var _=p[0];_&&this.GPSkillData.SetBulletParam(_,v,this)}}}catch(g){t={error:g}}finally{try{l&&!l.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}},e.prototype.OnUnuse=function(){var t,e,r,o,n=c.ModifyBulletReason.Weapon;try{for(var i=a(this.ref),l=i.next();!l.done;l=i.next()){var s=l.value,u=s.GetSkillId(),p=s.GetLevel();this.GPSkillData.DeleteSkillBullet(n,u,p);try{for(var f=(r=void 0,a(s.GetAttr())),h=f.next();!h.done;h=f.next()){var y=h.value;this.GPSkillData.SetSkillAttr(u,this,y.resId,-y.value)}}catch(_){r={error:_}}finally{try{h&&!h.done&&(o=f.return)&&o.call(f)}finally{if(r)throw r.error}}var d=s.GetParam();null!=d&&d.length>0&&this.GPSkillData.DeleteSkillParam(u,this);var m=s.GetBulletParam();if(null!=m&&m.length>0){var v=s.GetBullet()[0];v&&this.GPSkillData.DeleteBulletParam(v,this)}}}catch(S){t={error:S}}finally{try{l&&!l.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}},e.__cname="BattleLuncherBehavior",i([l.injectField("GPSkillData")],e.prototype,"GPSkillData",void 0),i([l.injectField("ModelSkill")],e.prototype,"ModelSkill",void 0),e}(s.BuffBehavior);r.BattleLuncherBehavior=u,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../../../buff/base/BuffBehavior":"BuffBehavior","../../gameplay/sub/GPSkillData":"GPSkillData"}],BattleLuncher_1010331:[function(t,e,r){"use strict";cc._RF.push(e,"b71e3Fw4Q5PCpSeJGUllxDo","BattleLuncher_1010331");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.BattleLuncher_1010331=void 0;var l=t("../../../../../../../framework/container/Container"),s=t("../../skill/hero/HeroSkillBow"),c=t("./BattleLuncherBehavior"),u=[10004,10005],p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnApply=function(){var e,r;t.prototype.OnApply.call(this);try{for(var o=a(u),n=o.next();!n.done;n=o.next()){var i=n.value,l=this.SystemSkill.GetSkillById(i);l&&l instanceof s.HeroSkillBow&&l.SetIsRed(!0)}}catch(c){e={error:c}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}},e.prototype.OnUnuse=function(){var e,r;try{for(var o=a(u),n=o.next();!n.done;n=o.next()){var i=n.value,l=this.SystemSkill.GetSkillById(i);l&&l instanceof s.HeroSkillBow&&l.SetIsRed(!1)}}catch(c){e={error:c}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}t.prototype.OnUnuse.call(this)},e.__cname="BattleLuncher_1010331",i([l.injectField("SystemSkill")],e.prototype,"SystemSkill",void 0),e}(c.BattleLuncherBehavior);r.BattleLuncher_1010331=p,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../skill/hero/HeroSkillBow":"HeroSkillBow","./BattleLuncherBehavior":"BattleLuncherBehavior"}],BattleSkillAttrBehavior:[function(t,e,r){"use strict";cc._RF.push(e,"ab82fqMW4tMHJieUX0+KvsF","BattleSkillAttrBehavior");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.BattleSkillAttrBehavior=void 0;var a=t("../../../../../../../framework/container/Container"),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnApply=function(){var t=this.ref.GetEvent();if(t){var e=parseInt(t.p1),r=parseInt(t.p2),o=parseInt(t.p3);this.skillId=e,this.attrId=r,this.value=o,this.GPSkillData.SetSkillAttr(e,this,r,o)}},e.prototype.OnUnuse=function(){this.skillId&&(this.GPSkillData.DeleteSkillAttr(this.skillId,this,this.attrId,this.value),this.skillId=null,this.attrId=null)},e.__cname="BattleSkillAttrBehavior",i([a.injectField("GPSkillData")],e.prototype,"GPSkillData",void 0),e}(t("./BaseBattleCustomBehavior").BaseBattleCustomBehavior);r.BattleSkillAttrBehavior=l,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"./BaseBattleCustomBehavior":"BaseBattleCustomBehavior"}],BattleStartConfig:[function(t,e,r){"use strict";cc._RF.push(e,"fdf0fi4LcBKrrKADlByvoZ8","BattleStartConfig"),Object.defineProperty(r,"__esModule",{value:!0}),r.BattleDebugConfig=r.BattleStartConfig=void 0;var o=function(){function t(){this.multeSpeed=1,this.whosyourdaddy=!1,this.noEvent=!1,this.killBoss=0,this.skillReplace=!1,this.bossNodeChest=!1,this.bossAreaType=1,this.bossAreaRadius=500,this.bossAreaModel=2000159,this.notDropGold=!1,this.isVulcan=!1,this.debugField=!1,this.debugFieldMonster=null,this.debugFieldFieldType=null,this.debugFieldSparse=null,this.superMagnet=!1,this.skillChestGoldDisable=!1,this.levelUpGuaranteeHp=!1,this.tlUnlockSkillId=null,this.bossShow=!0}return t.prototype.takeRefreshSkill=function(){this.refreshSkill--},t.prototype.takeEnterSelector=function(){this.enterSelector=!1},t.__cname="BattleStartConfig",t}();r.BattleStartConfig=o;var n=new o;n.skills=[1e4,10010,10014,10027],n.supply=[1003,1010,1007,1004],n.buffs=[],n.mainSkill=1e4,n.map=1e3,n.hero=1,n.roleLevelMonster=1,n.skillLimit=6,n.refreshSkill=1,n.skillSelectNum=3,n.enterSelector=!0,n.waveId=1,n.starttime=0,n.syncData=!0,n.fubenId=1e5,r.BattleDebugConfig=n,cc._RF.pop()},{}],BattleUtil:[function(t,e,r){"use strict";cc._RF.push(e,"92850kSWI9F76VV4M8d/8Sd","BattleUtil"),Object.defineProperty(r,"__esModule",{value:!0}),r.BattleUtil=void 0;var o=function(){function t(){}return t.PrepareWeightedRandom=function(t,e){return this.PrepareWeightedRandom2(t,e)[0]},t.PrepareWeightedRandom2=function(t,e){for(var r={},o=0,n=0;n<t.length;n++)o+=e[n],r[n]=o;var i=Math.random()*o,a=0;for(a=0;a<e.length&&!(r[a]>i);a++);return[t[a],a]},t.PrepareRandomStep=function(t,e,r){var o=(e-t)/r;return t+Math.floor(Math.random()*o)*r},t.Knuth=function(t){for(var e=this.Knuth_swap,r=this.Knuth_rand,o=t.length-1;o>=0;o--)e(t,o,r(0,o));return t},t.Knuth_swap=function(t,e,r){var o=t[e];t[e]=t[r],t[r]=o},t.Knuth_rand=function(t,e){return Math.ceil(t)+Math.floor(Math.random()*Math.floor(e-t))},t.FilterArrByCloser=function(t,e){for(var r,o,n=0;n<t.length;n++){var i=e(t[n]);(0==n||i<o)&&(r=t[n],o=i)}return r},t}();r.BattleUtil=o,cc._RF.pop()},{}],Battle:[function(t,e,r){"use strict";cc._RF.push(e,"79695ZMRyxLIbDNbCtnogZG","Battle");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},l=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},s=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.Battle=void 0;var c=t("../../../../framework/container/Container"),u=t("../../../../framework/ecs/World"),p=t("../../../../framework/FW"),f=t("../../../../framework/utils/PromiseWrap"),h=t("../../../../framework/utils/Toolset"),y=t("./base/BaseBattleSystem"),d=t("./debug/SystemDebug"),m=t("./logic/ai/behaviorTree/core/BTFactory"),v=t("./logic/ai/ComAI"),_=t("./logic/ai/SystemAI"),S=t("./logic/buff/SystemBuff"),g=t("./logic/buffCarrier/ComBuffCarrier"),b=t("./logic/buffCarrier/SystemBuffCarrier"),C=t("./logic/common/SystemCommon"),R=t("./logic/equipment/SystemEquipment"),M=t("./logic/event/SystemEvent"),w=t("./logic/gameplay/sub/GPChest"),O=t("./logic/gameplay/sub/GPDamageStastic"),B=t("./logic/gameplay/sub/GPGameover"),P=t("./logic/gameplay/sub/GPLevelUp"),G=t("./logic/gameplay/sub/GPNetSync"),k=t("./logic/gameplay/sub/GPStartDrop"),x=t("./logic/gameplay/SystemGamePlay"),T=t("./logic/handler/SystemHandler"),j=t("./logic/move/ComPos"),I=t("./logic/move/ComVelocity"),D=t("./logic/move/SystemMove"),F=t("./logic/physical/ComCollision"),L=t("./logic/physical/SystemCollision"),E=t("./logic/physical/SystemRigidbody"),A=t("./logic/role/SystemRole"),V=t("./logic/skill/ComSkill"),U=t("./logic/skill/SystemSkill"),W=t("./logic/spwan/SystemSpawn"),H=t("./logic/state/ComState"),N=t("./logic/state/SystemState"),q=t("./logic/SystemDamage"),K=t("./logic/SystemMap"),X=t("./logic/SystemTarget"),z=t("./logic/type/ComType"),J=t("./logic/var/ComVar"),Y=t("./logic/var/SystemVar"),Z=t("./view/brocast/SystemBrocast"),Q=t("./view/camera/SubSysCameraZoom"),$=t("./view/camera/SystemCamera"),tt=t("./view/CullingGroup"),et=t("./view/joystick/SystemJoystick"),rt=t("./view/nodeproxy/SystemNode"),ot=t("./view/prefab/ComPrefab"),nt=t("./view/spawn/SystemSpawnPreload"),it=t("./view/SystemDamageText"),at=t("./view/SystemView"),lt=t("./view/SystemViewCulling"),st=t("./view/SystemViewEffect"),ct=t("./view/SystemViewProp"),ut=t("./view/SystemViewWedgit"),pt=function(t){function e(e){var r,o=t.call(this)||this;o.tmPaused=new Map,o._starting=!1,o._beforeStart_promise=[],o._isdoApplyModify=!1,o.addCullingSet=new Set,o.removeCullingSet=new Set,o.tlCullingGroup=[],o.syncKey=["skills","supply","skillLimit","skillSelectNum","mainSkill","map","refreshSkill","enterSelector","debug","waveId","hero","roleLevelMonster","roleLevelGold","enterGold","fubenId","superMagnet","multeSpeed","whosyourdaddy","syncData"],o.tmRuntimeData=new Map,o.promise=new f.PromiseWrap,o.startConfig=e,o.ResumeRumtimeData(),m.BTFactory.instance().SetContainer(o.container),c.Container.inst().getByAlias("CtrlBattleView").SetContainer(o.GetContainer()),o.addCom(j.ComPos),o.addCom(I.ComVelocity),o.addCom(v.ComAI),o.addCom(H.ComState),o.addCom(J.ComVar),o.addCom(F.ComCollision),o.addCom(ot.ComPrefab),o.addCom(z.ComType),o.addCom(V.ComSkill),o.addCom(g.ComBuffCarrier),o.addSystem(x.SystemGamePlay),o.addSystem(K.SystemMap),o.addSystem(D.SystemMove),o.addSystem(_.SystemAI),o.addSystem(N.SystemState),o.addSystem(T.SystemHandler),o.addSystem(Z.SystemBrocast),o.addSystem(L.SystemCollision),o.addSystem(Y.SystemVar),o.addSystem(A.SystemRole),o.addSystem(R.SystemEquipment),o.addSystem(E.SystemRigidbody),o.addSystem(M.SystemEvent),o.addSystem(C.SystemCommon),o.addSystem(U.SystemSkill),o.addSystem(q.SystemDamage),o.addSystem(W.SystemSpawn),o.addSystem(X.SystemTarget),o.addSystem(S.SystemBuff),o.addSystem(b.SystemBuffCarrier),o.addSystem(at.SystemView),o.addSystem(lt.SystemViewCulling),o.addSystem(ct.SystemViewProp),o.addSystem(et.SystemJoystick),o.addSystem(it.SystemDamageText),o.addSystem(st.SystemViewEffect),o.addSystem(ut.SystemViewWedgit),o.addSystem(rt.SystemNode),o.addSystem(nt.SystemSpawnPreload),o.addSystem($.SystemCamera),c.Container.inst().getByAlias("ModelPublicData").getIsGM()&&o.addSystem(d.SystemDebug),o._initCulling(),o.SetRuntimeDataAble(o.getSystem(x.SystemGamePlay).GetSub(B.GPGameover)),o.SetRuntimeDataAble(o.getSystem(x.SystemGamePlay).GetSub(O.GPDamageStastic)),o.SetRuntimeDataAble(o.getSystem(x.SystemGamePlay).GetSub(k.GPStartDrop)),o.SetRuntimeDataAble(o.getSystem(x.SystemGamePlay).GetSub(w.GPChest)),o.SetRuntimeDataAble(o.getSystem(x.SystemGamePlay).GetSub(P.GPLevelUp)),o.SetRuntimeDataAble(o.getSystem($.SystemCamera).GetSubSystem(Q.SubSysCameraZoom)),o.SetRuntimeDataAble(o.getSystem(S.SystemBuff).BuffVarMgr),o.ResumeRuntimeDataAble();var n=!0;(n=(n=n&&o.startConfig.syncData)&&null!=(null===(r=o.startConfig.resumeData)||void 0===r?void 0:r.bossSavePoint))&&o.getSystem(x.SystemGamePlay).GetSub(B.GPGameover).resetReboren(),o.toolSet=h.ToolSet.createToolSet();var i=o.getSystem(M.SystemEvent).GetEventPorxy();return o.toolSet.addListener(i,M.EBattleEvent.Paused,function(t){o.tmPaused.set(t,!0),o.updatePauseState()}),o.toolSet.addListener(i,M.EBattleEvent.Resume,function(t){o.tmPaused.delete(t),o.updatePauseState()}),o}return n(e,t),e.prototype.GetPaused=function(){return this._paused},e.prototype.GetPromise=function(){return this.promise},e.prototype.GetContainer=function(){return this.container},e.prototype.onDestroy=function(){t.prototype.onDestroy.call(this),h.ToolSet.destroyToolSet(this.toolSet),this.addCullingSet=null,this.removeCullingSet=null,this.tlCullingGroup=null,m.BTFactory.instance().SetContainer(null)},e.prototype.start=function(){var t=this;this.container.start(),this._starting=!0;var e=function(){t._starting=!1,t.promise.resolve()};this.startInner().then(function(){return e()}).catch(function(t){e(),t&&(p.FW.Log.log((new Error).stack),p.FW.Log.error(t))})},e.prototype.startInner=function(){return i(this,void 0,Promise,function(){return a(this,function(t){switch(t.label){case 0:return[4,c.Container.inst().getByAlias("CtrlBattleView").EnterBattle()];case 1:return t.sent(),[4,this.beforeStart()];case 2:return t.sent(),this.startSystem(),this.getSystem(x.SystemGamePlay).GetSub(G.GPNetSync).ResumeData(),[2]}})})},e.prototype.beforeStart=function(){return i(this,void 0,void 0,function(){var t,e,r,o,n,i,s;return a(this,function(a){switch(a.label){case 0:(t=this._beforeStart_promise).length=0;try{for(e=l(this.tlSystem),r=e.next();!r.done;r=e.next())(o=r.value)instanceof y.BaseBattleSystem&&null!=(n=o.beforeStartAsync())&&t.push(n)}catch(c){i={error:c}}finally{try{r&&!r.done&&(s=e.return)&&s.call(e)}finally{if(i)throw i.error}}return t.length?[4,Promise.all(t)]:[3,2];case 1:a.sent(),a.label=2;case 2:return[2]}})})},e.prototype.update=function(){if(!this._starting){var t=cc.director.getDeltaTime();this._paused?this.updatePause(t):this.updateSystem(t)}},e.prototype.updatePauseState=function(){var t,e,r=!1;try{for(var o=l(this.tmPaused),n=o.next();!n.done;n=o.next()){var i=s(n.value,2);if(i[0],i[1]){r=!0;break}}}catch(a){t={error:a}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}this._paused=r},e.prototype.updatePause=function(t){this.getSystem(x.SystemGamePlay).Update(t),this.getSystem(at.SystemView).Update(t),this.getSystem(ut.SystemViewWedgit).Update(t),this.getSystem(lt.SystemViewCulling).Update(t),this.getSystem(K.SystemMap).Update(t),this.getSystem(ct.SystemViewProp).Update(t),this.getSystem(rt.SystemNode).Update(t),this.getSystem(T.SystemHandler).Update(t),this.getSystem(Z.SystemBrocast).Update(t);var e=this.getSystem(d.SystemDebug);e&&e.Update(t)},e.prototype.updateSystem=function(e){var r,o;if(this.getSystem(x.SystemGamePlay).Update(e),this.getSystem(_.SystemAI).Update(e),this.getSystem(N.SystemState).Update(e),this.getSystem(nt.SystemSpawnPreload).Update(e),this.getSystem(W.SystemSpawn).Update(e),this.getSystem(A.SystemRole).Update(e),this.getSystem(D.SystemMove).Update(e),this.getSystem(X.SystemTarget).Update(e),this.getSystem(L.SystemCollision).Update(e),this.getSystem(E.SystemRigidbody).Update(e),this.getSystem(U.SystemSkill).Update(e),this.getSystem(q.SystemDamage).Update(e),this.getSystem(S.SystemBuff).Update(e),this.getSystem(b.SystemBuffCarrier).Update(e),this.getSystem(Y.SystemVar).Update(e),this.getSystem(it.SystemDamageText).Update(e),this.getSystem(C.SystemCommon).Update(e),this.getSystem(st.SystemViewEffect).Update(e),this.getSystem(at.SystemView).Update(e),this.getSystem(ut.SystemViewWedgit).Update(e),this.getSystem(lt.SystemViewCulling).Update(e),this.getSystem(ct.SystemViewProp).Update(e),this.getSystem(K.SystemMap).Update(e),this.getSystem(T.SystemHandler).Update(e),this.getSystem(Z.SystemBrocast).Update(e),this.getSystem(rt.SystemNode).Update(e),this.getSystem($.SystemCamera).Update(e),this._isdoApplyModify){this._isdoApplyModify=!1;var n=[];try{for(var i=l(this.addSet),a=i.next();!a.done;a=i.next()){var s=a.value;n.push(s)}}catch(u){r={error:u}}finally{try{a&&!a.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}t.prototype.applyModify.call(this)}(this.addCullingSet.size>0||this.removeCullingSet.size>0)&&this._applyCulling();var c=this.getSystem(d.SystemDebug);c&&c.Update(e)},e.prototype.applyModify=function(){this._isdoApplyModify=!0},e.prototype._initCulling=function(){var t,e;try{for(var r=l(this.tlSystem),o=r.next();!o.done;o=r.next()){var n=o.value;n instanceof tt.CullingGroup&&this.tlCullingGroup.push(n)}}catch(i){t={error:i}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},e.prototype._removeCullingEntity=function(t){this.removeCullingSet.add(t)},e.prototype._addCullingEntity=function(t){this.addCullingSet.add(t)},e.prototype._isHaventAdd=function(t){return this.addCullingSet.has(t)},e.prototype._applyCulling=function(){var t,e,r,o,n,i,a,s,c,u;try{for(var p=l(this.removeCullingSet),f=p.next();!f.done;f=p.next()){var h=f.value;try{for(var y=(r=void 0,l(this.tlCullingGroup)),d=y.next();!d.done;d=y.next())(b=d.value).onRemoveEntity(h)}catch(O){r={error:O}}finally{try{d&&!d.done&&(o=y.return)&&o.call(y)}finally{if(r)throw r.error}}this.removeCullingSet.delete(h)}}catch(B){t={error:B}}finally{try{f&&!f.done&&(e=p.return)&&e.call(p)}finally{if(t)throw t.error}}try{for(var m=l(this.addCullingSet),v=m.next();!v.done;v=m.next()){h=v.value;var _=!1;try{for(var S=(a=void 0,l(this.tlCullingGroup)),g=S.next();!g.done;g=S.next()){var b=g.value,C=!0;try{for(var R=(c=void 0,l(b.tlComClazz)),M=R.next();!M.done;M=R.next()){var w=M.value;if(!this.tmCom.get(w).active[h]){C=!1;break}}}catch(P){c={error:P}}finally{try{M&&!M.done&&(u=R.return)&&u.call(R)}finally{if(c)throw c.error}}C&&(_=!0,b.onAddEntity(h))}}catch(G){a={error:G}}finally{try{g&&!g.done&&(s=S.return)&&s.call(S)}finally{if(a)throw a.error}}_&&this.addCullingSet.delete(h)}}catch(k){n={error:k}}finally{try{v&&!v.done&&(i=m.return)&&i.call(m)}finally{if(n)throw n.error}}},e.prototype.SetRuntimeDataAble=function(t){this.tmRuntimeData.set(t.GetRuntimeKey(),t)},e.prototype.ResumeRuntimeDataAble=function(){var t,e,r=this._runtimedata;if(null!=r)try{for(var o=l(this.tmRuntimeData),n=o.next();!n.done;n=o.next()){var i=s(n.value,2),a=i[0];i[1].ResumeRuntmeData(r[a])}}catch(c){t={error:c}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}},e.prototype.GetRuntimeData=function(){var t,e,r,o,n={};try{for(var i=l(this.syncKey),a=i.next();!a.done;a=i.next())n[h=a.value]=this.startConfig[h]}catch(y){t={error:y}}finally{try{a&&!a.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}try{for(var c=l(this.tmRuntimeData),u=c.next();!u.done;u=c.next()){var p=s(u.value,2),f=(p[0],p[1]),h=f.GetRuntimeKey();this.assert(null==n[h],"\u8bb0\u5f55\u7cfb\u7edf\u51fa\u9519,\u91cd\u590dkey\u503c"+h),n[h]=f.GetRuntimtData()}}catch(d){r={error:d}}finally{try{u&&!u.done&&(o=c.return)&&o.call(c)}finally{if(r)throw r.error}}return JSON.stringify(n)},e.prototype.ResumeRumtimeData=function(){var t,e,r,o,n=null===(o=null===(r=this.startConfig.resumeData)||void 0===r?void 0:r.cmdBattleBeat)||void 0===o?void 0:o.extend;if(n){var i=JSON.parse(n);this._runtimedata=i;try{for(var a=l(this.syncKey),s=a.next();!s.done;s=a.next()){var c=s.value;this.startConfig[c]=i[c]}}catch(u){t={error:u}}finally{try{s&&!s.done&&(e=a.return)&&e.call(a)}finally{if(t)throw t.error}}}},e.__cname="Battle",e}(u.World);r.Battle=pt,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/container/Container":void 0,"../../../../framework/ecs/World":void 0,"../../../../framework/utils/PromiseWrap":void 0,"../../../../framework/utils/Toolset":void 0,"./base/BaseBattleSystem":"BaseBattleSystem","./debug/SystemDebug":"SystemDebug","./logic/SystemDamage":"SystemDamage","./logic/SystemMap":"SystemMap","./logic/SystemTarget":"SystemTarget","./logic/ai/ComAI":"ComAI","./logic/ai/SystemAI":"SystemAI","./logic/ai/behaviorTree/core/BTFactory":"BTFactory","./logic/buff/SystemBuff":"SystemBuff","./logic/buffCarrier/ComBuffCarrier":"ComBuffCarrier","./logic/buffCarrier/SystemBuffCarrier":"SystemBuffCarrier","./logic/common/SystemCommon":"SystemCommon","./logic/equipment/SystemEquipment":"SystemEquipment","./logic/event/SystemEvent":"SystemEvent","./logic/gameplay/SystemGamePlay":"SystemGamePlay","./logic/gameplay/sub/GPChest":"GPChest","./logic/gameplay/sub/GPDamageStastic":"GPDamageStastic","./logic/gameplay/sub/GPGameover":"GPGameover","./logic/gameplay/sub/GPLevelUp":"GPLevelUp","./logic/gameplay/sub/GPNetSync":"GPNetSync","./logic/gameplay/sub/GPStartDrop":"GPStartDrop","./logic/handler/SystemHandler":"SystemHandler","./logic/move/ComPos":"ComPos","./logic/move/ComVelocity":"ComVelocity","./logic/move/SystemMove":"SystemMove","./logic/physical/ComCollision":"ComCollision","./logic/physical/SystemCollision":"SystemCollision","./logic/physical/SystemRigidbody":"SystemRigidbody","./logic/role/SystemRole":"SystemRole","./logic/skill/ComSkill":"ComSkill","./logic/skill/SystemSkill":"SystemSkill","./logic/spwan/SystemSpawn":"SystemSpawn","./logic/state/ComState":"ComState","./logic/state/SystemState":"SystemState","./logic/type/ComType":"ComType","./logic/var/ComVar":"ComVar","./logic/var/SystemVar":"SystemVar","./view/CullingGroup":"CullingGroup","./view/SystemDamageText":"SystemDamageText","./view/SystemView":"SystemView","./view/SystemViewCulling":"SystemViewCulling","./view/SystemViewEffect":"SystemViewEffect","./view/SystemViewProp":"SystemViewProp","./view/SystemViewWedgit":"SystemViewWedgit","./view/brocast/SystemBrocast":"SystemBrocast","./view/camera/SubSysCameraZoom":"SubSysCameraZoom","./view/camera/SystemCamera":"SystemCamera","./view/joystick/SystemJoystick":"SystemJoystick","./view/nodeproxy/SystemNode":"SystemNode","./view/prefab/ComPrefab":"ComPrefab","./view/spawn/SystemSpawnPreload":"SystemSpawnPreload"}],BrocastDamage:[function(t,e,r){"use strict";cc._RF.push(e,"3b505pfPWpJa7UgIS9zD6ua","BrocastDamage");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.BrocastDamage=void 0;var i=t("../../../../../../framework/FW"),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.process=function(){i.FW.ZJJ.log("target:"+this.target+" damageValue:"+this.damageValue)},e.__cname="BrocastDamage",e}(t("./Brocast").Brocast);r.BrocastDamage=a,cc._RF.pop()},{"../../../../../../framework/FW":void 0,"./Brocast":"Brocast"}],Brocast:[function(t,e,r){"use strict";cc._RF.push(e,"aff7670HGtJtrqS0+bwbmY6","Brocast");var o=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.Brocast=void 0;var n=t("../../../../../../framework/container/Container"),i=function(){function t(){}return o([n.injectField("Battle")],t.prototype,"Battle",void 0),t}();r.Brocast=i,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0}],BrowserDataReportingHelper:[function(t,e,r){"use strict";cc._RF.push(e,"bddf6BWakdO3ZO1OFM084EZ","BrowserDataReportingHelper");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.BrowserDataReportingHelper=void 0;var i=t("../../../../../engine/EngineMain"),a=t("./DataReportingHelper"),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetAPIVersion=function(){return""},e.prototype.GetClientVersion=function(){return this.appCustomData.serverVersion},e.prototype.GetCreative=function(){return this.appCustomData.channel},e.prototype.GetExtra=function(){return"1"},e.prototype.GetGameId=function(){return this.appCustomData.gameId},e.prototype.GetPhone=function(){return"1"},e.prototype.GetRatio=function(){return cc.view.getFrameSize().toString()},e.prototype.GetServerId=function(){var t,e=(null===(t=this.ModelMgr.ModelAccount.getServerAddress())||void 0===t?void 0:t.id)||0;return String(e)},e.prototype.GetSource=function(){return cc.sys.os},e.prototype.GetSystem=function(){return"1"},e.prototype.GetUdId=function(){var t=i.EngineMain.readLocalStorage("account_num","null"),e=i.EngineMain.readLocalStorage("UUID"+t,"");return""!=e&&(this._udid=e),""==this._udid&&(this._udid=a.UniqueId.createUniqueId()+"-"+this.GetPhone()+"-"+this.GetSystem()),this._udid},e.__cname="BrowserDataReportingHelper",e}(a.DataReportingHelper);r.BrowserDataReportingHelper=l,cc._RF.pop()},{"../../../../../engine/EngineMain":void 0,"./DataReportingHelper":"DataReportingHelper"}],BuffBehavior:[function(t,e,r){"use strict";cc._RF.push(e,"00fffy90ElC+ZUJTz/+9xyG","BuffBehavior");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.BuffBehaviorMgr=r.BuffBehavior=void 0;var i=t("../../../../../framework/base/ScriptObject"),a=t("../../../../../framework/FW"),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isUse=!1,e}return n(e,t),e.prototype.Init=function(t){this.resIdOrGroupId=t,this.ref=this.OnGetRef(),this.OnInit()},e.prototype.onDestroy=function(){this.OnRelease()},e.prototype.Apply=function(){this.isUse||(this.isUse=!0,this.OnApply())},e.prototype.Unuse=function(){1==this.isUse&&(this.isUse=!1,this.OnUnuse())},e.prototype.GetIsUse=function(){return this.isUse},e.prototype.GetRef=function(){return this.ref},e.prototype.OnInit=function(){},e.prototype.OnRelease=function(){},e.__cname="BuffBehavior",e}(i.ScriptObject);r.BuffBehavior=l;var s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tmBehavior=new Map,e}return n(e,t),e.prototype.Start=function(){},e.prototype.SetBuffClass=function(t,e){this.assert(0==this.tmBehavior.has(t),"\u91cd\u590d\u6dfb\u52a0buff"),this.tmBehavior.set(t,e)},e.prototype.CreateBehavior=function(t){var e;if(this.tmBehavior.has(t)&&(e=this.tmBehavior.get(t)),null==e)return a.FW.ZJJ.warn("buff id \u672a\u6ce8\u518c:"+t),null;var r=new e;return this.container.inject(r),r.Init(t),this.OnFilter(r.GetRef())?this.OnCreateBehavior(t,r):r=null,r},e.prototype.DestroyBehavior=function(t){this.OnDestroyBehavior(t),t.destroy()},e.prototype.OnCreateBehavior=function(){},e.prototype.OnDestroyBehavior=function(){},e.__cname="BuffBehaviorMgr",e}(i.ScriptObject);r.BuffBehaviorMgr=s,cc._RF.pop()},{"../../../../../framework/FW":void 0,"../../../../../framework/base/ScriptObject":void 0}],BuffCarrierBleed:[function(t,e,r){"use strict";cc._RF.push(e,"26ee8Xyu95LQLloIwSpot1G","BuffCarrierBleed");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.BuffCarrierBleed=void 0;var a=t("../../../../../../../framework/container/Container"),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnSetup=function(){},e.prototype.OnAddEntity=function(e){this.SystemBuffCarrier.AddRoleStatus(e.target,"\u89d2\u8272\u72b6\u6001_\u6d41\u8840"),t.prototype.OnAddEntity.call(this,e)},e.prototype.OnRemoveEntity=function(e){this.SystemBuffCarrier.RemoveRoleStatus(e.target,"\u89d2\u8272\u72b6\u6001_\u6d41\u8840"),t.prototype.OnRemoveEntity.call(this,e)},e.prototype.Update=function(){},e.__cname="BuffCarrierBleed",i([a.injectField("SystemDamage")],e.prototype,"SystemDamage",void 0),e}(t("./BaseSubBuffCarrier").BaseSubBuffCarrier);r.BuffCarrierBleed=l,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"./BaseSubBuffCarrier":"BaseSubBuffCarrier"}],BuffCarrierHandler:[function(t,e,r){"use strict";cc._RF.push(e,"2940aDcrOdDHqmRTNqCNixC","BuffCarrierHandler"),Object.defineProperty(r,"__esModule",{value:!0}),r.BuffCarrierHandlerMgr=r.BuffCarrierHandler=void 0;var o=t("../../../../../../../framework/FW"),n=t("../../../../../../../framework/pool/Pool"),i=function(){function t(){}return t.__CreateEmpty=function(){return new t},t.Create=function(t,e,r){null==this.m_mgr&&o.FW.Log.error("BuffCarrierHandlerMgr\u7ba1\u7406\u5668\u5c1a\u672a\u521d\u59cb\u5316");var n=this.m_mgr.Allocate();return n.sender=t,n.target=e,n.resId=r,n},t.prototype.Copy=function(t){this.sender=t.sender,this.resId=t.resId,this.target=t.target,this.ref=t.ref},t.prototype.Clear=function(){this.sender=null,this.resId=null,this.target=null,this.ref=null,this.triggerContext=null},t.prototype.Hash=function(){return this.sender+"-"+this.resId+"-"+this.target},t.__cname="BuffCarrierHandler",t}();r.BuffCarrierHandler=i;var a=function(){function t(){i.m_mgr=this,this.pool=new n.Pool(function(){return i.__CreateEmpty()},function(){},function(t,e,r,o){t.sender=e,t.resId=o,t.target=r},function(t){return t.Clear(),!0})}return t.prototype.Allocate=function(){return this.pool.getFromPool()},t.prototype.Recyle=function(t){return this.pool.returnToPool(t)},t.prototype.Destroy=function(){i.m_mgr=null,this.pool.returnAllToPool(),this.pool.destroy()},t}();r.BuffCarrierHandlerMgr=a,cc._RF.pop()},{"../../../../../../../framework/FW":void 0,"../../../../../../../framework/pool/Pool":void 0}],BuffCarrierInsectCoat:[function(t,e,r){"use strict";cc._RF.push(e,"7596anxnrhAx4wDZm2R2INI","BuffCarrierInsectCoat");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.BuffCarrierInsectCoat=void 0;var a=t("../../../../../../../framework/container/Container"),l=t("../../role/RoleBuilder"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.SetCount=function(t){this.count=t,this.BuffVarMgr.SetData("\u866b\u58f3\u5916\u8863",""+t)},e.prototype.GetCount=function(){if(null==this.count){var t=this.BuffVarMgr.GetData("\u866b\u58f3\u5916\u8863"),e=null==t?0:parseInt(t);this.count=e}return this.count},e.prototype.GetScriptParam=function(t){var e=this.scriptParam;if(null==e){e={};var r=t.ref.GetScriptParam();e.attrId=parseInt(r[0]),e.precent=parseInt(r[1]),e.bulletId=parseInt(r[2]),this.scriptParam=e}return e},e.prototype.OnSetup=function(){},e.prototype.OnTrigger=function(t,e){var r=this.GetCount();if(!(r>=100)&&e.damageTag.Remote){var o=this.GetScriptParam(t),n=100;if(n-=r,e.damageValue.rate-=n/100,o.bulletId){var i=this.Battle.getRef(t.sender),a=new l.RBContext;a.sender=i;var s=o.bulletId,c=new(this.SystemRole.GetBulletBuilder(s));c.Setup(a),c.SetProperty("resId",s),c.SetProperty("builder",c),this.SystemRole.ApplyBuilder(c),this.Battle.applyModify()}var u=r+o.precent;this.SetCount(u)}},e.__cname="BuffCarrierInsectCoat",i([a.injectField("BuffVarMgr")],e.prototype,"BuffVarMgr",void 0),i([a.injectField("SystemRole")],e.prototype,"SystemRole",void 0),i([a.injectField("Battle")],e.prototype,"Battle",void 0),e}(t("./BaseSubBuffCarrier").BaseSubBuffCarrier);r.BuffCarrierInsectCoat=s,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../role/RoleBuilder":"RoleBuilder","./BaseSubBuffCarrier":"BaseSubBuffCarrier"}],BuffCarrierJacket:[function(t,e,r){"use strict";cc._RF.push(e,"10d8foZto1PVLSdeu9CyNtd","BuffCarrierJacket");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.BuffCarrierJacket=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnTrigger=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var o=t.ref,n=o.GetEffectData();this.ComVar.takePrecentRestore(this.ComVar.HEROID,n.hpp)},e.__cname="BuffCarrierJacket",e}(t("./BaseSubBuffCarrier").BaseSubBuffCarrier);r.BuffCarrierJacket=i,cc._RF.pop()},{"./BaseSubBuffCarrier":"BaseSubBuffCarrier"}],BuffCarrierProtective:[function(t,e,r){"use strict";cc._RF.push(e,"7bb59LAu8xCBoaxYPEHvpGX","BuffCarrierProtective");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.BuffCarrierProtective=void 0;var a=t("../../../../../../../framework/container/Container"),l=t("../../role/RoleBuilder"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnTrigger=function(t){var e=t.ref.GetEffectData().bulletId;if(console.log("\u89e6\u53d1 \u8f90\u5c04"),e){var r=this.Battle.getRef(t.sender),o=new l.RBContext;o.sender=r;var n=Number(e),i=new(this.SystemRole.GetBulletBuilder(n));i.Setup(o),i.SetProperty("resId",n),i.SetProperty("builder",i),this.SystemRole.ApplyBuilder(i),this.Battle.applyModify()}},e.__cname="BuffCarrierProtective",i([a.injectField("BuffVarMgr")],e.prototype,"BuffVarMgr",void 0),i([a.injectField("SystemRole")],e.prototype,"SystemRole",void 0),i([a.injectField("Battle")],e.prototype,"Battle",void 0),e}(t("./BaseSubBuffCarrier").BaseSubBuffCarrier);r.BuffCarrierProtective=s,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../role/RoleBuilder":"RoleBuilder","./BaseSubBuffCarrier":"BaseSubBuffCarrier"}],BuffCarrierRebornEffect:[function(t,e,r){"use strict";cc._RF.push(e,"e6599qQ7DJKZq9QmwgBpbTV","BuffCarrierRebornEffect");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a},l=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(a(arguments[e]));return t};Object.defineProperty(r,"__esModule",{value:!0}),r.BuffCarrierRebornEffect=void 0;var s=t("../../../../../../../framework/container/Container"),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.count=0,e}return n(e,t),e.prototype.OnTrigger=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var o=this.count;if(!(o>=1)){this.count++;var n=this.SystemBuffCarrier.GetEffect(t);n.Apply.apply(n,l([t],e))}},e.__cname="BuffCarrierRebornEffect",i([s.injectField("BuffVarMgr")],e.prototype,"BuffVarMgr",void 0),i([s.injectField("ModelAttr")],e.prototype,"ModelAttr",void 0),e}(t("./BaseSubBuffCarrier").BaseSubBuffCarrier);r.BuffCarrierRebornEffect=c,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"./BaseSubBuffCarrier":"BaseSubBuffCarrier"}],BuffCarrierReborn:[function(t,e,r){"use strict";cc._RF.push(e,"bdf5cZt6UVKVaVLag0hg1Cq","BuffCarrierReborn");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.BuffCarrierReborn=void 0;var a=t("../../../../../../../framework/container/Container"),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.SetCount=function(t){this.count=t,this.BuffVarMgr.SetData("\u91d1\u5c5e\u4f5c\u6218\u8863",""+t)},e.prototype.GetCount=function(){if(null==this.count){var t=this.BuffVarMgr.GetData("\u91d1\u5c5e\u4f5c\u6218\u8863"),e=null==t?0:parseInt(t);this.count=e}return this.count},e.prototype.OnTrigger=function(t,e){var r=this.GetCount();if(!(r>=1)){e.damageTag.IsStopDie=!0;var o=t.ref.GetEffectData(),n=t.target,i=this.ComVar.HP_Max[n],a=o.hpp*i;this.ComVar.takeReborn(n,a);var l=this.ComVar.HEROID,s=this.ComPos.x[l],c=this.ComPos.y[l];this.SystemViewEffect.AddEffectXY("\u767e\u604b_\u6218\u6597\u573a\u666f\u7279\u6548_\u590d\u6d3b",s,c);var u=r+1;this.SetCount(u)}},e.__cname="BuffCarrierReborn",i([a.injectField("BuffVarMgr")],e.prototype,"BuffVarMgr",void 0),i([a.injectField("Battle")],e.prototype,"Battle",void 0),i([a.injectField("ComState")],e.prototype,"ComState",void 0),i([a.injectField("SystemViewEffect")],e.prototype,"SystemViewEffect",void 0),e}(t("./BaseSubBuffCarrier").BaseSubBuffCarrier);r.BuffCarrierReborn=l,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"./BaseSubBuffCarrier":"BaseSubBuffCarrier"}],BuffCarrierSlow:[function(t,e,r){"use strict";cc._RF.push(e,"98615a/b5VKCKkuJexeDcg1","BuffCarrierSlow");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.BuffCarrierSlow=void 0;var l=t("../../../../../../../framework/container/Container"),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.time=[],e.handlers=new Map,e}return n(e,t),e.prototype.OnAddEntity=function(e){e.target,t.prototype.OnAddEntity.call(this,e)},e.prototype.OnRemoveEntity=function(e){t.prototype.OnRemoveEntity.call(this,e)},e.prototype.OnTrigger=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];if(this.handlers.set(t.target,t),!this.time[t.target]){this.SystemBuffCarrier.AddRoleStatus(t.target,"\u89d2\u8272\u72b6\u6001_\u8303\u56f4\u51cf\u901f");var o=this.SystemBuffCarrier.GetEffect(t);o.Apply(t);var n=t.ref.GetEffectData();this.ComVar.SPEED_REDUCE[t.target]=-n.attrs[0].value}this.time[t.target]=t.ref.GetRef().duration/1e3},e.prototype.Update=function(t){var e,r;try{for(var o=a(this.handlers),n=o.next();!n.done;n=o.next()){var i=n.value,l=i[1],s=this.time[l.target];this.time[l.target]&&((s-=t)<=0?(this.SystemBuffCarrier.RemoveRoleStatus(l.target,"\u89d2\u8272\u72b6\u6001_\u8303\u56f4\u51cf\u901f"),this.time[l.target]=0,this.handlers.delete(i[0]),this.ComVar.SPEED_REDUCE[l.target]=0):this.time[l.target]=s)}}catch(c){e={error:c}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}},e.__cname="BuffCarrierSlow",i([l.injectField("ComVelocity")],e.prototype,"ComVelocity",void 0),e}(t("./BaseSubBuffCarrier").BaseSubBuffCarrier);r.BuffCarrierSlow=s,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"./BaseSubBuffCarrier":"BaseSubBuffCarrier"}],BuffCarrier_300060:[function(t,e,r){"use strict";cc._RF.push(e,"45393mLjgNKYq76pcZ6CfFv","BuffCarrier_300060");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.BuffCarrier_300060=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnTrigger=function(e){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];t.prototype.OnTrigger.call(this,e,r)},e.__cname="BuffCarrier_300060",e}(t("./BaseSubBuffCarrier").BaseSubBuffCarrier);r.BuffCarrier_300060=i,cc._RF.pop()},{"./BaseSubBuffCarrier":"BaseSubBuffCarrier"}],BuffCarrier_300061:[function(t,e,r){"use strict";cc._RF.push(e,"55f7cWyh/JJwp1ybtHPnW2k","BuffCarrier_300061");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.BuffCarrier_300061=void 0;var a=t("../../../../../../../framework/container/Container"),l=t("../../../../../../../framework/utils/Toolset"),s=t("../../event/SystemEvent"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnSetup=function(){console.log("123")},e.prototype.OnAddEntity=function(e){var r=this;if(!this.handle){this.toolSet=l.ToolSet.createToolSet();var o=this.SystemEvent.GetEventPorxy();this.handle||(this.handle=e),this.toolSet.addListener(o,s.EBattleEvent.TriggerBehit,function(){r.handle&&(r.RemoveEntity(r.handle),r.handle=null)},this),this.SystemBuffCarrier.AddRoleStatus(e.target,"\u89d2\u8272\u72b6\u6001_\u6fc0\u52b1"),t.prototype.OnAddEntity.call(this,e)}},e.prototype.OnRemoveEntity=function(e){this.SystemBuffCarrier.RemoveRoleStatus(e.target,"\u89d2\u8272\u72b6\u6001_\u6fc0\u52b1"),t.prototype.OnRemoveEntity.call(this,e)},e.prototype.OnTrigger=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var o=t.ref.GetEffectData(),n=t.target,i=this.ComVar.HP_Max[n],a=o.hpp*i;this.ComVar.takeRDE(n,a)},e.__cname="BuffCarrier_300061",i([a.injectField("SystemEvent")],e.prototype,"SystemEvent",void 0),i([a.injectField("SystemViewWedgit")],e.prototype,"SystemViewWedgit",void 0),e}(t("./BaseSubBuffCarrier").BaseSubBuffCarrier);r.BuffCarrier_300061=c,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../../../../../../framework/utils/Toolset":void 0,"../../event/SystemEvent":"SystemEvent","./BaseSubBuffCarrier":"BaseSubBuffCarrier"}],BuffCarrier_300070:[function(t,e,r){"use strict";cc._RF.push(e,"48bd1pbXHFCg6wSQqMCz7al","BuffCarrier_300070");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.BuffCarrier_300070=void 0;var a=t("../../../../../../../framework/container/Container"),l=t("../../role/RoleBuilder"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnSetup=function(){},e.prototype.OnTrigger=function(t){var e=t.ref.GetScriptParam()[0];if(e){var r=this.Battle.getRef(t.sender),o=new l.RBContext;o.sender=r;var n=Number(e),i=new(this.SystemRole.GetBulletBuilder(n));i.Setup(o),i.SetProperty("resId",n),i.SetProperty("builder",i),this.SystemRole.ApplyBuilder(i),this.Battle.applyModify()}},e.__cname="BuffCarrier_300070",i([a.injectField("BuffVarMgr")],e.prototype,"BuffVarMgr",void 0),i([a.injectField("SystemRole")],e.prototype,"SystemRole",void 0),i([a.injectField("Battle")],e.prototype,"Battle",void 0),e}(t("./BaseSubBuffCarrier").BaseSubBuffCarrier);r.BuffCarrier_300070=s,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../role/RoleBuilder":"RoleBuilder","./BaseSubBuffCarrier":"BaseSubBuffCarrier"}],BuffCarrier_300080:[function(t,e,r){"use strict";cc._RF.push(e,"2192cfNIExF8aB/cigDOTtm","BuffCarrier_300080");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.BuffCarrier_300080=void 0;var l=t("../../../../../../../framework/container/Container"),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.add=0,e}return n(e,t),e.prototype.Setup=function(){this.add=0},e.prototype.OnTrigger=function(t){for(var e,r,o=[],n=1;n<arguments.length;n++)o[n-1]=arguments[n];var i=t.ref.GetEffectData(),l=t.ref.GetScriptParam()[0];if(!(Number(l)<=this.add)){var s=t.target,c=this.ModelAttr;try{for(var u=a(i.attrs),p=u.next();!p.done;p=u.next()){var f=p.value,h=c.GetAttributeKeyByResId(f.attrId);this.ComVar.SetAttr(s,h,f.value),this.add+=f.value/100}}catch(y){e={error:y}}finally{try{p&&!p.done&&(r=u.return)&&r.call(u)}finally{if(e)throw e.error}}}},e.__cname="BuffCarrier_300080",i([l.injectField("ModelAttr")],e.prototype,"ModelAttr",void 0),e}(t("./BaseSubBuffCarrier").BaseSubBuffCarrier);r.BuffCarrier_300080=s,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"./BaseSubBuffCarrier":"BaseSubBuffCarrier"}],BuffCarrier_300090:[function(t,e,r){"use strict";cc._RF.push(e,"8c9a0hwrJpO/oESlHKj6+Fa","BuffCarrier_300090");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.BuffCarrier_300090=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.__cname="BuffCarrier_300090",e}(t("./BaseSubBuffCarrier").BaseSubBuffCarrier);r.BuffCarrier_300090=i,cc._RF.pop()},{"./BaseSubBuffCarrier":"BaseSubBuffCarrier"}],BuffCarrier_300100:[function(t,e,r){"use strict";cc._RF.push(e,"5c652D1DYNFnbUxhtk1tGyA","BuffCarrier_300100");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.BuffCarrier_300100=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.__cname="BuffCarrier_300100",e}(t("./BaseSubBuffCarrier").BaseSubBuffCarrier);r.BuffCarrier_300100=i,cc._RF.pop()},{"./BaseSubBuffCarrier":"BaseSubBuffCarrier"}],BuffCarrier_300101:[function(t,e,r){"use strict";cc._RF.push(e,"1120ahgujRHJLlgGFqf+oKr","BuffCarrier_300101");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a},l=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(a(arguments[e]));return t};Object.defineProperty(r,"__esModule",{value:!0}),r.BuffCarrier_300101=void 0;var s=t("../../../../../../../framework/container/Container"),c=t("../../../../../../../framework/utils/Toolset"),u=t("../../event/SystemEvent"),p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnSetup=function(){},e.prototype.OnAddEntity=function(e){var r=this;if(!this.handle){this.toolSet=c.ToolSet.createToolSet();var o=this.SystemEvent.GetEventPorxy();this.handle||(this.handle=e),this.toolSet.addListener(o,u.EBattleEvent.TriggerBehit,function(){r.handle&&(r.SystemBuffCarrier.RemoveRoleStatus(r.handle.target,"\u89d2\u8272\u72b6\u6001_\u6fc0\u52b1"),r.time=null,r.SystemBuffCarrier.GetEffect(r.handle).Unuse(r.handle),r.handle=null)},this),t.prototype.OnAddEntity.call(this,e)}},e.prototype.OnTrigger=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];if(!this.time){this.SystemBuffCarrier.AddRoleStatus(t.target,"\u89d2\u8272\u72b6\u6001_\u6fc0\u52b1"),this.handle=t;var o=this.SystemBuffCarrier.GetEffect(t);o.Apply.apply(o,l([t],e))}this.time=1},e.__cname="BuffCarrier_300101",i([s.injectField("SystemEvent")],e.prototype,"SystemEvent",void 0),i([s.injectField("SystemViewWedgit")],e.prototype,"SystemViewWedgit",void 0),e}(t("./BaseSubBuffCarrier").BaseSubBuffCarrier);r.BuffCarrier_300101=p,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../../../../../../framework/utils/Toolset":void 0,"../../event/SystemEvent":"SystemEvent","./BaseSubBuffCarrier":"BaseSubBuffCarrier"}],BuffCarrier_300110:[function(t,e,r){"use strict";cc._RF.push(e,"d8ab0f5XWVFgJ0ALh/XrsdJ","BuffCarrier_300110");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.BuffCarrier_300110=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnSetup=function(){console.log("222")},e.prototype.OnTrigger=function(e){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];t.prototype.OnTrigger.call(this,e,r)},e.__cname="BuffCarrier_300110",e}(t("./BaseSubBuffCarrier").BaseSubBuffCarrier);r.BuffCarrier_300110=i,cc._RF.pop()},{"./BaseSubBuffCarrier":"BaseSubBuffCarrier"}],BuffCarrier_300111:[function(t,e,r){"use strict";cc._RF.push(e,"4c96eS5NrJJzqV7dV/SaTCD","BuffCarrier_300111");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.BuffCarrier_300111=void 0;var i=t("../../SystemDamage"),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onTrigger=!1,e.time=0,e}return n(e,t),e.prototype.Setup=function(){this.onTrigger=!1,this.time=0,this.handler=null},e.prototype.OnAddEntity=function(e){this.SystemBuffCarrier.AddRoleStatus(e.target,"\u89d2\u8272\u72b6\u6001_\u4e00\u6b21\u62a4\u76fe"),t.prototype.OnAddEntity.call(this,e)},e.prototype.OnRemoveEntity=function(e){this.SystemBuffCarrier.RemoveRoleStatus(e.target,"\u89d2\u8272\u72b6\u6001_\u4e00\u6b21\u62a4\u76fe"),t.prototype.OnRemoveEntity.call(this,e)},e.prototype.OnTrigger=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var o=e;o&&o instanceof i.DamageInfo&&(o.damageTag.IsStopDie=!0,o.damageTag.Failure=!0),this.onTrigger||(this.time=Number(t.ref.GetScriptParam()[0])/1e3,this.time>.001&&(this.SystemBuffCarrier.RemoveRoleStatus(t.target,"\u89d2\u8272\u72b6\u6001_\u4e00\u6b21\u62a4\u76fe"),this.SystemBuffCarrier.AddRoleStatus(t.target,"\u89d2\u8272\u72b6\u6001_\u65e0\u654c")),this.onTrigger=!0,this.handler=t)},e.prototype.Update=function(t){this.onTrigger&&(this.time-=t,this.time<=0&&(this.OnEnd(this.handler),this.onTrigger=!1,this.SystemBuffCarrier.RemoveRoleStatus(this.handler.target,"\u89d2\u8272\u72b6\u6001_\u65e0\u654c")))},e.__cname="BuffCarrier_300111",e}(t("./BaseSubBuffCarrier").BaseSubBuffCarrier);r.BuffCarrier_300111=a,cc._RF.pop()},{"../../SystemDamage":"SystemDamage","./BaseSubBuffCarrier":"BaseSubBuffCarrier"}],BuffCarrier_300120:[function(t,e,r){"use strict";cc._RF.push(e,"b3c669PEOBGw4vI/wNS9g86","BuffCarrier_300120");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.BuffCarrier_300120=void 0;var a=t("../../../../../../../framework/container/Container"),l=t("../../SystemDamage"),s=t("../../role/RoleBuilder"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnTrigger=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var o=e[0];if(o&&o instanceof l.DamageInfo){var n=t.ref.GetEffectData(),i=n.bulletId;if(i){var a=t.ref.GetScriptParam()[0],c=o.GetDamage()*Number(a)/100,u=this.Battle.getRef(t.sender),p=new s.RBContext;p.sender=u;var f=i,h=this.SystemRole.GetBulletBuilder(f),y=new h;y.Setup(p),y.SetProperty("resId",f),y.SetProperty("builder",y);var d=this.SystemRole.ApplyBuilder(y);this.Battle.applyModify(),this.ComVar.SPECIAL_ATK[d]=c}}},e.__cname="BuffCarrier_300120",i([a.injectField("SystemRole")],e.prototype,"SystemRole",void 0),i([a.injectField("Battle")],e.prototype,"Battle",void 0),i([a.injectField("ComVar")],e.prototype,"ComVar",void 0),e}(t("./BaseSubBuffCarrier").BaseSubBuffCarrier);r.BuffCarrier_300120=c,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../SystemDamage":"SystemDamage","../../role/RoleBuilder":"RoleBuilder","./BaseSubBuffCarrier":"BaseSubBuffCarrier"}],BuffCarrier_300130:[function(t,e,r){"use strict";cc._RF.push(e,"dee18qJCBRITLd7VQNI4I7u","BuffCarrier_300130");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.BuffCarrier_300130=void 0;var a=t("../../../../../../../framework/container/Container"),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tState=[],e}return n(e,t),e.prototype.OnAddEntity=function(e){t.prototype.OnAddEntity.call(this,e),this.OnTrigger(e)},e.prototype.OnTrigger=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var o=t.ref,n=o.GetScriptParam(),i=n[1],a=Number(n[0])/100,l=this.ComVar.HEROID,s=this.ComVar.HP[l]/this.ComVar.HP_Max[l],c="1"==i?s>a:s<=a,u=this.SystemBuffCarrier.GetEffect(t);c&&1!=this.tState[t.resId]?(u.Apply(t),this.tState[t.resId]=1):c||1!=this.tState[t.resId]||(u.Unuse(t),this.tState[t.resId]=2)},e.__cname="BuffCarrier_300130",i([a.injectField("SystemRole")],e.prototype,"SystemRole",void 0),i([a.injectField("Battle")],e.prototype,"Battle",void 0),i([a.injectField("ComVar")],e.prototype,"ComVar",void 0),e}(t("./BaseSubBuffCarrier").BaseSubBuffCarrier);r.BuffCarrier_300130=l,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"./BaseSubBuffCarrier":"BaseSubBuffCarrier"}],BuffCarrier_300140:[function(t,e,r){"use strict";cc._RF.push(e,"4fe57u8g4FNgLgKfoL0vyAP","BuffCarrier_300140");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.BuffCarrier_300140=void 0;var l=t("../../../../../../../framework/container/Container"),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.count=[],e}return n(e,t),e.prototype.Setup=function(){},e.prototype.OnTrigger=function(t){for(var e,r,o=[],n=1;n<arguments.length;n++)o[n-1]=arguments[n];var i=this.count[t.resId]||0,l=t.ref.GetScriptParam();if(!(i>=Number(l[0]))){var s=t.ref.GetEffectData(),c=t.target,u=this.ModelAttr;try{for(var p=a(s.attrs),f=p.next();!f.done;f=p.next()){var h=f.value,y=u.GetAttributeKeyByResId(h.attrId),d=u.GetRefRoleAttribute(h.attrId).GetType();"\u56fa\u5b9a\u503c"==d?this.ComVar.SetAttr(c,y,null,h.value):"\u767e\u5206\u6bd4"==d&&this.ComVar.SetAttr(c,y,null,null,h.value),this.count[t.resId]=i+100*h.value}}catch(m){e={error:m}}finally{try{f&&!f.done&&(r=p.return)&&r.call(p)}finally{if(e)throw e.error}}}},e.__cname="BuffCarrier_300140",i([l.injectField("BuffVarMgr")],e.prototype,"BuffVarMgr",void 0),i([l.injectField("ModelAttr")],e.prototype,"ModelAttr",void 0),e}(t("./BaseSubBuffCarrier").BaseSubBuffCarrier);r.BuffCarrier_300140=s,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"./BaseSubBuffCarrier":"BaseSubBuffCarrier"}],BuffCarrier_300150:[function(t,e,r){"use strict";cc._RF.push(e,"ce21aC1VlJIC5s0G9/7A2Xz","BuffCarrier_300150");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.BuffCarrier_300150=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnTrigger=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];for(var o=t.ref.GetEffectData(),n=7==o.attrs[0].attrId?[1,2,3,4,5,6]:[o.attrs[0].attrId],i=o.attrs[0].value,a=0;a<n.length;a++){var l=n[a];this.ComVar.SetSupplyAdd(l,i)}},e.__cname="BuffCarrier_300150",e}(t("./BaseSubBuffCarrier").BaseSubBuffCarrier);r.BuffCarrier_300150=i,cc._RF.pop()},{"./BaseSubBuffCarrier":"BaseSubBuffCarrier"}],BuffCarrier_300160:[function(t,e,r){"use strict";cc._RF.push(e,"c1cfahz/hRHAbL7ecxWkxJL","BuffCarrier_300160");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.BuffCarrier_300160=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnTrigger=function(e){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];t.prototype.OnTrigger.call(this,e,r)},e.__cname="BuffCarrier_300160",e}(t("./BaseSubBuffCarrier").BaseSubBuffCarrier);r.BuffCarrier_300160=i,cc._RF.pop()},{"./BaseSubBuffCarrier":"BaseSubBuffCarrier"}],BuffCarrier_300161:[function(t,e,r){"use strict";cc._RF.push(e,"098e7GwxsNHELLYWovoS2AY","BuffCarrier_300161");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.BuffCarrier_300161=void 0;var a=t("../../../../../../../framework/container/Container"),l=t("../../role/RoleBuilder"),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isTrigger=!1,e}return n(e,t),e.prototype.Setup=function(){this.isTrigger=!1},e.prototype.OnAddEntity=function(e){this.SystemBuffCarrier.AddRoleStatus(e.target,"\u89d2\u8272\u72b6\u6001_\u4e00\u6b21\u62a4\u76fe"),t.prototype.OnAddEntity.call(this,e)},e.prototype.OnRemoveEntity=function(e){this.SystemBuffCarrier.RemoveRoleStatus(e.target,"\u89d2\u8272\u72b6\u6001_\u4e00\u6b21\u62a4\u76fe"),t.prototype.OnRemoveEntity.call(this,e)},e.prototype.OnTrigger=function(t){for(var e=this,r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];var n=t.ref;this.SystemBuffCarrier.RemoveRoleStatus(t.target,"\u89d2\u8272\u72b6\u6001_\u4e00\u6b21\u62a4\u76fe");var i=n.GetScriptParam(),a=i[0];if(a){var s=this.Battle.getRef(t.sender),c=new l.RBContext;c.sender=s;var u=Number(a),p=this.SystemRole.GetBulletBuilder(u),f=new p;f.Setup(c),f.SetProperty("resId",u),f.SetProperty("builder",f),this.SystemRole.ApplyBuilder(f),this.Battle.applyModify()}var h=n.GetEffectData();if(h.attrs.length>0){if(this.isTrigger)return;var y=this.SystemBuffCarrier.GetEffect(t);y.Apply(t),this.SystemBuffCarrier.AddRoleStatus(t.target,"\u89d2\u8272\u72b6\u6001_\u6218\u573a\u7edf\u6cbb\u8005"),setTimeout(function(){e.isTrigger=!1,e.OnEnd(t),e.SystemBuffCarrier.RemoveRoleStatus(t.target,"\u89d2\u8272\u72b6\u6001_\u6218\u573a\u7edf\u6cbb\u8005")},5e3)}else this.isTrigger=!1,this.OnEnd(t);this.isTrigger=!0},e.__cname="BuffCarrier_300161",i([a.injectField("SystemRole")],e.prototype,"SystemRole",void 0),i([a.injectField("Battle")],e.prototype,"Battle",void 0),i([a.injectField("ComVar")],e.prototype,"ComVar",void 0),i([a.injectField("ModelAttr")],e.prototype,"ModelAttr",void 0),e}(t("./BaseSubBuffCarrier").BaseSubBuffCarrier);r.BuffCarrier_300161=s,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../role/RoleBuilder":"RoleBuilder","./BaseSubBuffCarrier":"BaseSubBuffCarrier"}],BuffCarrier_300170:[function(t,e,r){"use strict";cc._RF.push(e,"f683cixRD9CVa5uwayKjY1y","BuffCarrier_300170");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.BuffCarrier_300170=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnTrigger=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];this.ComVar.THUMP_BLOOD=!0},e.__cname="BuffCarrier_300170",e}(t("./BaseSubBuffCarrier").BaseSubBuffCarrier);r.BuffCarrier_300170=i,cc._RF.pop()},{"./BaseSubBuffCarrier":"BaseSubBuffCarrier"}],BuffCarrier_300180:[function(t,e,r){"use strict";cc._RF.push(e,"3578aWJoPtMfqYU6lk8uUzp","BuffCarrier_300180");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.BuffCarrier_300180=void 0;var l=t("../../../../../../../framework/container/Container"),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.add=0,e}return n(e,t),e.prototype.Setup=function(){this.add=0},e.prototype.OnTrigger=function(t){for(var e,r,o=[],n=1;n<arguments.length;n++)o[n-1]=arguments[n];var i=this.add,l=t.ref.GetScriptParam();if(!(i>=Number(l[0]))){var s=t.ref.GetEffectData(),c=t.target,u=this.ModelAttr;try{for(var p=a(s.attrs),f=p.next();!f.done;f=p.next()){var h=f.value,y=u.GetAttributeKeyByResId(h.attrId),d=u.GetRefRoleAttribute(h.attrId).GetType();"\u56fa\u5b9a\u503c"==d?this.ComVar.SetAttr(c,y,null,h.value):"\u767e\u5206\u6bd4"==d&&this.ComVar.SetAttr(c,y,null,null,h.value),this.add+=100*h.value}}catch(m){e={error:m}}finally{try{f&&!f.done&&(r=p.return)&&r.call(p)}finally{if(e)throw e.error}}}},e.__cname="BuffCarrier_300180",i([l.injectField("ModelAttr")],e.prototype,"ModelAttr",void 0),e}(t("./BaseSubBuffCarrier").BaseSubBuffCarrier);r.BuffCarrier_300180=s,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"./BaseSubBuffCarrier":"BaseSubBuffCarrier"}],BuffCarrier_300190:[function(t,e,r){"use strict";cc._RF.push(e,"3da7cTZQbdG7Jz3LA4qroGx","BuffCarrier_300190");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.BuffCarrier_300190=void 0;var a=t("../../../../../../../framework/container/Container"),l=t("../../role/RoleBuilder"),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.num=0,e}return n(e,t),e.prototype.OnTrigger=function(t,e){var r=this,o=t.ref.GetEffectData();if(o.bulletId){var n=t.ref.GetScriptParam(),i=Number(n[0]);if(this.num>=i)return;var a=Number(n[1])/100;if(Math.random()>a)return;this.num++,setTimeout(function(){r.num--},1e3);var s=this.Battle.getRef(t.sender),c=new l.RBContext;c.sender=s;var u=o.bulletId,p=new(this.SystemRole.GetBulletBuilder(u));p.Setup(c),p.SetProperty("resId",u),p.SetProperty("builder",p);var f=this.ComPos.x[e],h=this.ComPos.y[e];p.SetProperty("pos",[f,h]),setTimeout(function(){r.SystemRole.ApplyBuilder(p),r.Battle.applyModify()},100)}},e.__cname="BuffCarrier_300190",i([a.injectField("SystemRole")],e.prototype,"SystemRole",void 0),i([a.injectField("Battle")],e.prototype,"Battle",void 0),e}(t("./BaseSubBuffCarrier").BaseSubBuffCarrier);r.BuffCarrier_300190=s,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../role/RoleBuilder":"RoleBuilder","./BaseSubBuffCarrier":"BaseSubBuffCarrier"}],BuffCarrier_300200:[function(t,e,r){"use strict";cc._RF.push(e,"abda7TqKvNH96hpGxJqFQeb","BuffCarrier_300200");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.BuffCarrier_300200=void 0;var a=t("../../../../../../../framework/container/Container"),l=t("../../role/RoleBuilder"),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.num=0,e}return n(e,t),e.prototype.OnTrigger=function(t,e){var r=this,o=t.ref.GetEffectData();if(o.bulletId){var n=t.ref.GetScriptParam(),i=Number(n[0]);if(this.num>=i)return;var a=Number(n[1])/100;if(Math.random()>a)return;this.num++,setTimeout(function(){r.num--},1e3);var s=this.Battle.getRef(t.sender),c=new l.RBContext;c.sender=s;var u=o.bulletId,p=new(this.SystemRole.GetBulletBuilder(u));p.Setup(c),p.SetProperty("resId",u),p.SetProperty("builder",p);var f=this.ComPos.x[e],h=this.ComPos.y[e];p.SetProperty("pos",[f,h]),this.SystemRole.ApplyBuilder(p),this.Battle.applyModify()}},e.__cname="BuffCarrier_300200",i([a.injectField("SystemRole")],e.prototype,"SystemRole",void 0),i([a.injectField("Battle")],e.prototype,"Battle",void 0),e}(t("./BaseSubBuffCarrier").BaseSubBuffCarrier);r.BuffCarrier_300200=s,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../role/RoleBuilder":"RoleBuilder","./BaseSubBuffCarrier":"BaseSubBuffCarrier"}],BuffCarrier_300210:[function(t,e,r){"use strict";cc._RF.push(e,"8984cSNAJJIjpkzzMhDjbeH","BuffCarrier_300210");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.BuffCarrier_300210=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.__cname="BuffCarrier_300210",e}(t("./BaseSubBuffCarrier").BaseSubBuffCarrier);r.BuffCarrier_300210=i,cc._RF.pop()},{"./BaseSubBuffCarrier":"BaseSubBuffCarrier"}],BuffCarrier_300220:[function(t,e,r){"use strict";cc._RF.push(e,"2c252w43QtK3Icl0tC7nD+N","BuffCarrier_300220");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a},a=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(i(arguments[e]));return t};Object.defineProperty(r,"__esModule",{value:!0}),r.BuffCarrier_300220=void 0;var l,s=t("./BaseSubBuffCarrier");(function(t){t[t.Idle=0]="Idle",t[t.Active=1]="Active",t[t.End=2]="End"})(l||(l={}));var c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.Setup=function(){},e.prototype.OnTrigger=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];if(!this.time){this.SystemBuffCarrier.AddRoleStatus(t.target,"\u89d2\u8272\u72b6\u6001_\u52a0\u901f"),this.target=t.target,this.handle=t;var o=this.SystemBuffCarrier.GetEffect(t);o.Apply.apply(o,a([t],e))}var n=t.ref.GetScriptParam()[0];this.time=Number(n)},e.prototype.Update=function(t){this.time>0&&(this.time-=t,this.time<=0&&(this.SystemBuffCarrier.RemoveRoleStatus(this.target,"\u89d2\u8272\u72b6\u6001_\u52a0\u901f"),this.time=null,this.SystemBuffCarrier.GetEffect(this.handle).Unuse(this.handle)))},e.__cname="BuffCarrier_300220",e}(s.BaseSubBuffCarrier);r.BuffCarrier_300220=c,cc._RF.pop()},{"./BaseSubBuffCarrier":"BaseSubBuffCarrier"}],BuffCarrier_300230:[function(t,e,r){"use strict";cc._RF.push(e,"d8dd67prbxJA6wXwkNedddk","BuffCarrier_300230");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a},l=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(a(arguments[e]));return t};Object.defineProperty(r,"__esModule",{value:!0}),r.BuffCarrier_300230=void 0;var s=t("../../../../../../../framework/container/Container"),c=t("../../role/RoleBuilder"),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.Setup=function(){},e.prototype.OnTrigger=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var o=t.ref.GetScriptParam(),n=o[o.length-1];if(n){var i=this.Battle.getRef(t.sender),a=new c.RBContext;a.sender=i;var s=Number(n),u=this.SystemRole.GetBulletBuilder(s),p=new u;p.Setup(a),p.SetProperty("resId",s),p.SetProperty("builder",p),this.SystemRole.ApplyBuilder(p),this.Battle.applyModify()}var f=t.ref.GetEffectData();if(!this.time&&f.attrs.length>0){this.handle=t;var h=this.SystemBuffCarrier.GetEffect(t);h.Apply.apply(h,l([t],e));var y=t.ref.GetScriptParam()[0];this.time=Number(y)}},e.prototype.Update=function(t){this.time>0&&(this.time-=t,this.time<=0&&(this.time=null,this.SystemBuffCarrier.GetEffect(this.handle).Unuse(this.handle)))},e.__cname="BuffCarrier_300230",i([s.injectField("SystemRole")],e.prototype,"SystemRole",void 0),i([s.injectField("Battle")],e.prototype,"Battle",void 0),e}(t("./BaseSubBuffCarrier").BaseSubBuffCarrier);r.BuffCarrier_300230=u,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../role/RoleBuilder":"RoleBuilder","./BaseSubBuffCarrier":"BaseSubBuffCarrier"}],BuffCarrier_300240:[function(t,e,r){"use strict";cc._RF.push(e,"73b6c16/n1Lx7D/iOWMvb+m","BuffCarrier_300240");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a},a=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(i(arguments[e]));return t};Object.defineProperty(r,"__esModule",{value:!0}),r.BuffCarrier_300240=void 0;var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.Setup=function(){},e.prototype.OnTrigger=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];if(!this.time){var o=t.ref.GetScriptParam()[1];o&&this.SystemBuffCarrier.AddRoleStatus(t.target,"\u89d2\u8272\u72b6\u6001_\u4f24\u5bb3\u51cf\u514d"),this.target=t.target,this.handle=t;var n=this.SystemBuffCarrier.GetEffect(t);n.Apply.apply(n,a([t],e))}var i=t.ref.GetScriptParam()[0];this.time=Number(i)},e.prototype.Update=function(t){this.time>0&&(this.time-=t,this.time<=0&&(this.handle.ref.GetScriptParam()[1]&&this.SystemBuffCarrier.RemoveRoleStatus(this.target,"\u89d2\u8272\u72b6\u6001_\u4f24\u5bb3\u51cf\u514d"),this.time=null,this.SystemBuffCarrier.GetEffect(this.handle).Unuse(this.handle)))},e.__cname="BuffCarrier_300240",e}(t("./BaseSubBuffCarrier").BaseSubBuffCarrier);r.BuffCarrier_300240=l,cc._RF.pop()},{"./BaseSubBuffCarrier":"BaseSubBuffCarrier"}],BuffCarrier_300241:[function(t,e,r){"use strict";cc._RF.push(e,"99518g/sDFNcJkNzMDSvmZQ","BuffCarrier_300241");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a},a=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(i(arguments[e]));return t};Object.defineProperty(r,"__esModule",{value:!0}),r.BuffCarrier_300241=void 0;var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.Setup=function(){},e.prototype.OnTrigger=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];if(!this.time){this.target=t.target,this.handle=t;var o=this.SystemBuffCarrier.GetEffect(t);o.Apply.apply(o,a([t],e))}var n=t.ref.GetScriptParam()[0];this.time=Number(n)},e.prototype.Update=function(t){this.time>0&&(this.time-=t,this.time<=0&&(this.time=null,this.SystemBuffCarrier.GetEffect(this.handle).Unuse(this.handle)))},e.__cname="BuffCarrier_300241",e}(t("./BaseSubBuffCarrier").BaseSubBuffCarrier);r.BuffCarrier_300241=l,cc._RF.pop()},{"./BaseSubBuffCarrier":"BaseSubBuffCarrier"}],BuffCarrier_300250:[function(t,e,r){"use strict";cc._RF.push(e,"4b7b2mE3W1ESosvoUVPBGY2","BuffCarrier_300250");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a},l=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(a(arguments[e]));return t};Object.defineProperty(r,"__esModule",{value:!0}),r.BuffCarrier_300250=void 0;var s=t("../../../../../../../framework/container/Container"),c=t("../../../../../../../framework/utils/Toolset"),u=t("../../event/SystemEvent"),p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.Setup=function(){},e.prototype.OnAddEntity=function(e){var r=this;this.toolSet=c.ToolSet.createToolSet();var o=this.SystemEvent.GetEventPorxy();this.toolSet.addListener(o,u.EBattleEvent.TriggerBehit,function(){r.handle&&r.time&&(r.SystemBuffCarrier.GetEffect(e).Unuse(e),r.SystemBuffCarrier.RemoveRoleStatus(e.target,"\u89d2\u8272\u72b6\u6001_\u6fc0\u52b1"),r.handle=null,r.time=null)},this),t.prototype.OnAddEntity.call(this,e)},e.prototype.OnTrigger=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];if(!this.time){this.handle=t;var o=this.SystemBuffCarrier.GetEffect(t);o.Apply.apply(o,l([t],e)),this.SystemBuffCarrier.AddRoleStatus(t.target,"\u89d2\u8272\u72b6\u6001_\u6fc0\u52b1")}this.time=1},e.__cname="BuffCarrier_300250",i([s.injectField("SystemEvent")],e.prototype,"SystemEvent",void 0),e}(t("./BaseSubBuffCarrier").BaseSubBuffCarrier);r.BuffCarrier_300250=p,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../../../../../../framework/utils/Toolset":void 0,"../../event/SystemEvent":"SystemEvent","./BaseSubBuffCarrier":"BaseSubBuffCarrier"}],BuffCarrier_300500:[function(t,e,r){"use strict";cc._RF.push(e,"6857ebYgUpAb7HcKAYdMWCy","BuffCarrier_300500");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.BuffCarrier_300500=void 0;var a=t("../../../../../../../framework/container/Container"),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.Setup=function(){this.time=0},e.prototype.OnTrigger=function(t,e){var r=t.ref.GetScriptParam(),o=Number(r[0]);if(!(this.time>=o)){e.damageTag.IsStopDie=!0;var n=Number(r[1])/100,i=t.target,a=n*this.ComVar.HP_Max[i];this.ComVar.takeReborn(i,a);var l=this.ComVar.HEROID,s=this.ComPos.x[l],c=this.ComPos.y[l];this.SystemViewEffect.AddEffectXY("\u767e\u604b_\u6218\u6597\u573a\u666f\u7279\u6548_\u590d\u6d3b",s,c),0==this.time&&this.SystemBuffCarrier.GetEffect(t).Apply(t),this.time+=1}},e.__cname="BuffCarrier_300500",i([a.injectField("SystemViewEffect")],e.prototype,"SystemViewEffect",void 0),e}(t("./BaseSubBuffCarrier").BaseSubBuffCarrier);r.BuffCarrier_300500=l,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"./BaseSubBuffCarrier":"BaseSubBuffCarrier"}],BuffCarrier_300520:[function(t,e,r){"use strict";cc._RF.push(e,"c54b18Xm2hM6JG85i20eIAq","BuffCarrier_300520");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a},a=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(i(arguments[e]));return t};Object.defineProperty(r,"__esModule",{value:!0}),r.BuffCarrier_300520=void 0;var l=t("../../SystemDamage"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.Setup=function(){},e.prototype.OnTrigger=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var o=e[0];o&&o instanceof l.DamageInfo&&(o.damageTag.IsStopDie=!0,o.damageTag.Failure=!0);var n=this.SystemBuffCarrier.GetEffect(t);n.Apply.apply(n,a([t],e))},e.__cname="BuffCarrier_300520",e}(t("./BaseSubBuffCarrier").BaseSubBuffCarrier);r.BuffCarrier_300520=s,cc._RF.pop()},{"../../SystemDamage":"SystemDamage","./BaseSubBuffCarrier":"BaseSubBuffCarrier"}],BuffCarrier_300521:[function(t,e,r){"use strict";cc._RF.push(e,"a0bc8dRSOdPdbjuO0uhpwDS","BuffCarrier_300521");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a},a=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(i(arguments[e]));return t};Object.defineProperty(r,"__esModule",{value:!0}),r.BuffCarrier_300521=void 0;var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.Setup=function(){},e.prototype.OnTrigger=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];if(!this.time){this.SystemBuffCarrier.AddRoleStatus(t.target,"\u89d2\u8272\u72b6\u6001_\u65e0\u654c"),this.handle=t;var o=this.SystemBuffCarrier.GetEffect(t);o.Apply.apply(o,a([t],e))}this.time=3},e.prototype.Update=function(t){this.time>0&&(this.time-=t,this.time<=0&&(this.SystemBuffCarrier.RemoveRoleStatus(this.handle.target,"\u89d2\u8272\u72b6\u6001_\u65e0\u654c"),this.time=null,this.SystemBuffCarrier.GetEffect(this.handle).Unuse(this.handle)))},e.__cname="BuffCarrier_300521",e}(t("./BaseSubBuffCarrier").BaseSubBuffCarrier);r.BuffCarrier_300521=l,cc._RF.pop()},{"./BaseSubBuffCarrier":"BaseSubBuffCarrier"}],BuffCarrier_300530:[function(t,e,r){"use strict";cc._RF.push(e,"6651fzlvGpDtY4idYX6zLlq","BuffCarrier_300530");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.BuffCarrier_300530=void 0;var a=t("../../../../../../../framework/container/Container"),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tState=0,e}return n(e,t),e.prototype.OnAddEntity=function(e){t.prototype.OnAddEntity.call(this,e),this.OnTrigger(e)},e.prototype.OnTrigger=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var o=t.ref,n=o.GetScriptParam(),i=Number(n[0])/100,a=this.ComVar.HEROID,l=this.ComVar.HP[a]/this.ComVar.HP_Max[a],s=l>i,c=this.SystemBuffCarrier.GetEffect(t);s&&1!=this.tState?(c.Apply(t),this.tState=1):1==this.tState&&(c.Unuse(t),this.tState=2)},e.__cname="BuffCarrier_300530",i([a.injectField("SystemRole")],e.prototype,"SystemRole",void 0),i([a.injectField("Battle")],e.prototype,"Battle",void 0),i([a.injectField("ComVar")],e.prototype,"ComVar",void 0),e}(t("./BaseSubBuffCarrier").BaseSubBuffCarrier);r.BuffCarrier_300530=l,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"./BaseSubBuffCarrier":"BaseSubBuffCarrier"}],BuffCarrier_300540:[function(t,e,r){"use strict";cc._RF.push(e,"5ff2fYc2Z1P7aSmknE8qDPG","BuffCarrier_300540");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.BuffCarrier_300540=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.__cname="BuffCarrier_300540",e}(t("./BaseSubBuffCarrier").BaseSubBuffCarrier);r.BuffCarrier_300540=i,cc._RF.pop()},{"./BaseSubBuffCarrier":"BaseSubBuffCarrier"}],BuffCarrier_300550:[function(t,e,r){"use strict";cc._RF.push(e,"10368YViwRMsIlVe1Ge+K8n","BuffCarrier_300550");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.BuffCarrier_300550=void 0;var a=t("../../../../../../../framework/container/Container"),l=t("../../../view/nodeproxy/NodeProxy"),s=t("../../role/RoleBuilder"),c=t("../../var/ComVar"),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnTrigger=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var o=t.sender,n=this.Battle.getRef(o),i=t.ref.GetEffectData(),a=new s.RBContext;a.sender=n;var u=i.bulletId,p=this.SystemRole.GetBulletBuilder(u),f=new p;f.Setup(a),f.SetProperty("resId",u),f.SetProperty("builder",f),f.SetProperty("order",l.NodeProxyOrder.Ground);var h=[];this.SystemMove.findOtherCampNoBullet(c.EComCamp.Hero,this.ComPos.x[o],this.ComPos.y[o],1e3,h),this.SkillHandlerDart.Shoot(t.sender,o,u,f,h[0])},e.__cname="BuffCarrier_300550",i([a.injectField("Battle")],e.prototype,"Battle",void 0),i([a.injectField("SystemRole")],e.prototype,"SystemRole",void 0),i([a.injectField("SkillHandlerDart")],e.prototype,"SkillHandlerDart",void 0),i([a.injectField("SystemMove")],e.prototype,"SystemMove",void 0),e}(t("./BaseSubBuffCarrier").BaseSubBuffCarrier);r.BuffCarrier_300550=u,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../../view/nodeproxy/NodeProxy":"NodeProxy","../../role/RoleBuilder":"RoleBuilder","../../var/ComVar":"ComVar","./BaseSubBuffCarrier":"BaseSubBuffCarrier"}],BuffProxy:[function(t,e,r){"use strict";cc._RF.push(e,"65be9E97JlO6ZqJ5gURK3xO","BuffProxy");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.BuffProxyMgr=r.BuffProxy=void 0;var l=t("../../../../../engine/EngineMain"),s=t("../../../../../framework/base/ScriptObject"),c=t("../../../../../framework/container/Container"),u=function(){function t(){this.isUse=!1,this.tlBehavior=[]}return t.prototype.SetSkillGroupId=function(t){this.skillgroupId=t},t.prototype.OnInit=function(){},t.prototype.OnDestroy=function(){this.isUse&&this.Unuse()},t.prototype.Apply=function(){1!=this.isUse&&(this.isUse=!0,this.SetupBehavior())},t.prototype.Unuse=function(){0!=this.isUse&&(this.isUse=!1,this.ClearBehavior())},t.prototype.SetupBehavior=function(){var t,e;this.ClearBehavior();var r=this.ModelSkill.GetSkillGroup(this.skillgroupId),o=this.parent.BuffBehaviorMgr;if(r){var n=JSON.parse(l.EngineMain.readLocalStorage("filterIds","[]"));try{for(var i=a(r.GetSkillGroup()),s=i.next();!s.done;s=i.next()){var c=s.value;if(!n.includes(c)){var u=o.CreateBehavior(c);if(u&&(this.tlBehavior.push(u),u.Apply(),1011121==c)){var p=o.CreateBehavior(201503);this.tlBehavior.push(p),p.Apply()}}}}catch(f){t={error:f}}finally{try{s&&!s.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}}},t.prototype.ClearBehavior=function(){var t,e,r=this.parent.BuffBehaviorMgr;try{for(var o=a(this.tlBehavior),n=o.next();!n.done;n=o.next()){var i=n.value;i.Unuse(),r.DestroyBehavior(i)}}catch(l){t={error:l}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}this.tlBehavior.length=0},t.__cname="BuffProxy",i([c.injectField("ModelSkill")],t.prototype,"ModelSkill",void 0),i([c.injectField("CtrlBuff")],t.prototype,"CtrlBuff",void 0),t}();r.BuffProxy=u;var p=function(t){function e(){var e=t.call(this)||this;return e.tlProxy=new Set,e}return n(e,t),e.Create=function(t,r){var o=new e;return o.container=t,o.BuffBehaviorMgr=r,t.inject(o),o},e.prototype.onDestroy=function(){this.ClearAllProxy()},e.prototype.GetProxyClazz=function(){return u},e.prototype.CreateProxy=function(){var t=new(this.GetProxyClazz());return this.container.inject(t),t.parent=this,t.OnInit(),this.tlProxy.add(t),t},e.prototype.DestroyProxy=function(t){this.tlProxy.has(t)&&(t.OnDestroy(),this.tlProxy.delete(t))},e.prototype.ClearAllProxy=function(){var t,e;try{for(var r=a(this.tlProxy),o=r.next();!o.done;o=r.next())o.value.OnDestroy()}catch(n){t={error:n}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}this.tlProxy.clear()},e.__cname="BuffProxyMgr",e}(s.ScriptObject);r.BuffProxyMgr=p,cc._RF.pop()},{"../../../../../engine/EngineMain":void 0,"../../../../../framework/base/ScriptObject":void 0,"../../../../../framework/container/Container":void 0}],BuffTriggerCounter:[function(t,e,r){"use strict";cc._RF.push(e,"c0d12jOWARHfrQAAgx99t7Y","BuffTriggerCounter");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.BuffTriggerCounter=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.__cname="BuffTriggerCounter",e}(t("../../../../../framework/base/ScriptObject").ScriptObject);r.BuffTriggerCounter=i,cc._RF.pop()},{"../../../../../framework/base/ScriptObject":void 0}],BuffTrigger:[function(t,e,r){"use strict";cc._RF.push(e,"ad565ujYStOlonoeC/Jpzq+","BuffTrigger");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.BuffTrigger=void 0;var i=t("../../../../../framework/base/ScriptObject"),a=t("../../../../../framework/event/EventCallback"),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.TriggerCallback=new a.EventCallback,e}return n(e,t),e.prototype.onDestroy=function(){this.TriggerCallback.destroy()},e.prototype.OnInit=function(){},e.prototype.OnRelease=function(){},e.prototype.OnEnable=function(){},e.prototype.OnDisable=function(){},e.prototype.SetType=function(t){this.type=t},e.prototype.Trigger=function(){this.OnTrigger(),this.TriggerCallback.execute()},e.__cname="BuffTrigger",e}(i.ScriptObject);r.BuffTrigger=l,cc._RF.pop()},{"../../../../../framework/base/ScriptObject":void 0,"../../../../../framework/event/EventCallback":void 0}],BuffVar:[function(t,e,r){"use strict";cc._RF.push(e,"1d7c9Qi0TVMhqEQrk28J1Sr","BuffVar");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.BuffVarMgr=r.BuffVar=void 0;var l=t("../../../../../../framework/base/ScriptObject"),s=t("../../../../../../framework/event/EventProxy"),c=function(){function t(){}return t.__cname="BuffVar",t}();r.BuffVar=c;var u=function(t){function e(){var e=t.call(this)||this;return e.eventProxy=new s.EventProxy,e.tmData=new Map,e}return n(e,t),e.prototype.onDestroy=function(){this.eventProxy.destroy()},e.prototype.GetEventProxy=function(){return this.eventProxy},e.prototype.SendOnDamage=function(t,e){this.eventProxy.execute("OnDamage",t,e)},e.prototype.SetData=function(t,e){this.tmData.set(t,e)},e.prototype.GetData=function(t){return this.tmData.get(t)},e.prototype.GetRuntimeKey=function(){return this.className},e.prototype.GetRuntimtData=function(){var t,e,r={};try{for(var o=i(this.tmData),n=o.next();!n.done;n=o.next()){var l=a(n.value,2),s=l[0],c=l[1];r[s]=c}}catch(u){t={error:u}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}return JSON.stringify(r)},e.prototype.ResumeRuntmeData=function(t){var e,r;if(t){var o=JSON.parse(t);this.tmData.clear();try{for(var n=i(Object.keys(o)),a=n.next();!a.done;a=n.next()){var l=a.value,s=l;this.tmData.set(s,o[l])}}catch(c){e={error:c}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}}},e.__cname="BuffVarMgr",e}(l.ScriptObject);r.BuffVarMgr=u,cc._RF.pop()},{"../../../../../../framework/base/ScriptObject":void 0,"../../../../../../framework/event/EventProxy":void 0}],BuyPayObj:[function(t,e,r){"use strict";cc._RF.push(e,"1e6ce+Ua6FLK4vBeq+NQPnw","BuyPayObj");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.DirectPurchase=r.BuyStaPayObj=r.MallDailyShopPayObj=r.MallCoinPayObj=void 0;var l=t("../../../../framework/FW"),s=t("../../ctrl/main/Xiulian/LayerBuySta"),c=t("./PayObj"),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.RedefinitionType=function(){},e.prototype.Auth=function(){return i(this,void 0,Promise,function(){var t,e,r;return a(this,function(){return t=this._payInfo,e=this.ModelMgr.ModelGoods.CreateGoodsByCmd({resId:t.payResId,number:String(t.payNumber)}),(r=this.ModelMgr.ModelRole.getPropertyById(e.GetRefId()))>=t.payNumber?(l.FW.LWX.log("\u70b9\u51fb\u8d2d\u4e70"),this._cmd={mallId:t.mallId,resId:t.resId,type:t.type},[2,!0]):(this.tipsInfo={type:c.TipsType.buyTips,resId:t.payResId,currency:t.payNumber-r},[2,!1])})})},e.prototype.Pay=function(){return i(this,void 0,Promise,function(){return a(this,function(){return this.ModelMgr.ModelMallGloden.RequestMallCoinBuy(this._cmd),[2,null]})})},e.__cname="MallCoinPayObj",e}(c.PayObj);r.MallCoinPayObj=u;var p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.RedefinitionType=function(){},e.prototype.Auth=function(){return i(this,void 0,Promise,function(){var t,e,r;return a(this,function(){return t=this._payInfo,e=this.ModelMgr.ModelGoods.CreateGoodsByCmd({resId:t.payResId,number:String(t.payNumber)}),(r=this.ModelMgr.ModelRole.getPropertyById(e.GetRefId()))>=t.payNumber?(l.FW.LWX.log("\u70b9\u51fb\u8d2d\u4e70"),this._cmd={mallId:t.mallId,planId:t.planId,isAd:t.isAd},[2,!0]):(this.tipsInfo={type:c.TipsType.buyTips,resId:t.payResId,currency:t.payNumber-r},[2,!1])})})},e.prototype.Pay=function(){return i(this,void 0,Promise,function(){return a(this,function(){return this.ModelMgr.ModelMallDailyShop.RequestMallDailyShopBuy(this._cmd),[2,null]})})},e.__cname="MallDailyShopPayObj",e}(c.PayObj);r.MallDailyShopPayObj=p;var f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.RedefinitionType=function(){},e.prototype.Auth=function(){return i(this,void 0,Promise,function(){var t,e,r,o,n,i,l,u;return a(this,function(a){switch(a.label){case 0:return t=this._payInfo,e=t.ref,r=t.buyStaData,e.payType!=s.BuyStaType.Gem?[3,1]:(o=r&&r.state||0,n=e.numbers,i=Math.min(n.length-1,o),l=this.ModelMgr.ModelGoods.CreateGoodsByCmd({resId:e.resId,number:n[i]}),(u=this.ModelMgr.ModelRole.getPropertyById(l.GetRefId()))>=n[i]?[3,3]:(this.tipsInfo={type:c.TipsType.buyTips,resId:e.resId,currency:n[i]-u},[2,!1]));case 1:return e.payType!=s.BuyStaType.Ad?[3,3]:(this._cmd={resId:e.id},[4,this.CtrlPay.PayforAdVideo()]);case 2:return[2,a.sent()];case 3:return this._cmd={resId:e.id},[2,!0]}})})},e.prototype.Pay=function(){return i(this,void 0,Promise,function(){var t;return a(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this.ModelMgr.ModelSta.RequestBuyStaBuy(this._cmd)];case 1:return[2,e.sent()];case 2:return t=e.sent(),l.FW.LWX.error("\u8d2d\u4e70\u4f53\u529b\u5931\u8d25!+",t),[2,!1];case 3:return[2]}})})},e.__cname="BuyStaPayObj",e}(c.PayObj);r.BuyStaPayObj=f;var h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.RedefinitionType=function(){this._cmd=this._cmd},e.prototype.Auth=function(){return i(this,void 0,Promise,function(){var t,e;return a(this,function(){return t=this._payInfo,null==(e=this.ModelMgr.ModelPayChannel.GetPayGoodsByFormId(t.formId))?(l.FW.LWX.error("paychannel\u4e0d\u5b58\u5728formid:"+t.formId),[2,!1]):t.isBusy?[2,!1]:(this._cmd={id:e.GetId(),type:e.GetGoodsType(),formId:e.GetFromId()},[2,!0])})})},e.prototype.Pay=function(){return i(this,void 0,Promise,function(){return a(this,function(t){switch(t.label){case 0:return[4,this.SDKMgr.getSDK().PPP(this._cmd.id,this._cmd.type,this._cmd.formId)];case 1:return[2,t.sent()]}})})},e.__cname="DirectPurchase",e}(c.PayObj);r.DirectPurchase=h,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../ctrl/main/Xiulian/LayerBuySta":"LayerBuySta","./PayObj":"PayObj"}],CacheMgrGen:[function(t,e,r){"use strict";cc._RF.push(e,"0732aW17DhLfZaPSNd/AAZz","CacheMgrGen");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.CacheMgrGen=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getCmdActivity=function(t){return this.get("CmdActivity",t)},e.prototype.getTlCmdActivity=function(){return this.getValues("CmdActivity")},e.prototype.getCmdApplyFriendCache=function(t){return this.get("CmdApplyFriendCache",t)},e.prototype.getTlCmdApplyFriendCache=function(){return this.getValues("CmdApplyFriendCache")},e.prototype.getCmdBattle=function(t){return this.get("CmdBattle",t)},e.prototype.getTlCmdBattle=function(){return this.getValues("CmdBattle")},e.prototype.getCmdBlackFriendCache=function(t){return this.get("CmdBlackFriendCache",t)},e.prototype.getTlCmdBlackFriendCache=function(){return this.getValues("CmdBlackFriendCache")},e.prototype.getCmdBreach=function(t){return this.get("CmdBreach",t)},e.prototype.getTlCmdBreach=function(){return this.getValues("CmdBreach")},e.prototype.getCmdCardCache=function(t){return this.get("CmdCardCache",t)},e.prototype.getTlCmdCardCache=function(){return this.getValues("CmdCardCache")},e.prototype.getCmdChapter=function(t){return this.get("CmdChapter",t)},e.prototype.getTlCmdChapter=function(){return this.getValues("CmdChapter")},e.prototype.getCmdCode=function(t){return this.get("CmdCode",t)},e.prototype.getTlCmdCode=function(){return this.getValues("CmdCode")},e.prototype.getCmdDayWeekMonthGift=function(t){return this.get("CmdDayWeekMonthGift",t)},e.prototype.getTlCmdDayWeekMonthGift=function(){return this.getValues("CmdDayWeekMonthGift")},e.prototype.getCmdEquip=function(t){return this.get("CmdEquip",t)},e.prototype.getTlCmdEquip=function(){return this.getValues("CmdEquip")},e.prototype.getCmdEveryDaySign=function(t){return this.get("CmdEveryDaySign",t)},e.prototype.getTlCmdEveryDaySign=function(){return this.getValues("CmdEveryDaySign")},e.prototype.getCmdFirstRecharge=function(t){return this.get("CmdFirstRecharge",t)},e.prototype.getTlCmdFirstRecharge=function(){return this.getValues("CmdFirstRecharge")},e.prototype.getCmdFriendCache=function(t){return this.get("CmdFriendCache",t)},e.prototype.getTlCmdFriendCache=function(){return this.getValues("CmdFriendCache")},e.prototype.getCmdFuBen=function(t){return this.get("CmdFuBen",t)},e.prototype.getTlCmdFuBen=function(){return this.getValues("CmdFuBen")},e.prototype.getCmdFund=function(t){return this.get("CmdFund",t)},e.prototype.getTlCmdFund=function(){return this.getValues("CmdFund")},e.prototype.getCmdGuide=function(t){return this.get("CmdGuide",t)},e.prototype.getTlCmdGuide=function(){return this.getValues("CmdGuide")},e.prototype.getCmdHang=function(t){return this.get("CmdHang",t)},e.prototype.getTlCmdHang=function(){return this.getValues("CmdHang")},e.prototype.getCmdHero=function(t){return this.get("CmdHero",t)},e.prototype.getTlCmdHero=function(){return this.getValues("CmdHero")},e.prototype.getCmdItem=function(t){return this.get("CmdItem",t)},e.prototype.getTlCmdItem=function(){return this.getValues("CmdItem")},e.prototype.getCmdLuckyCatCache=function(t){return this.get("CmdLuckyCatCache",t)},e.prototype.getTlCmdLuckyCatCache=function(){return this.getValues("CmdLuckyCatCache")},e.prototype.getCmdMall=function(t){return this.get("CmdMall",t)},e.prototype.getTlCmdMall=function(){return this.getValues("CmdMall")},e.prototype.getCmdOpenCache=function(t){return this.get("CmdOpenCache",t)},e.prototype.getTlCmdOpenCache=function(){return this.getValues("CmdOpenCache")},e.prototype.getCmdRedDotCache=function(t){return this.get("CmdRedDotCache",t)},e.prototype.getTlCmdRedDotCache=function(){return this.getValues("CmdRedDotCache")},e.prototype.getCmdRole=function(t){return this.get("CmdRole",t)},e.prototype.getTlCmdRole=function(){return this.getValues("CmdRole")},e.prototype.getCmdRune=function(t){return this.get("CmdRune",t)},e.prototype.getTlCmdRune=function(){return this.getValues("CmdRune")},e.prototype.getCmdShare=function(t){return this.get("CmdShare",t)},e.prototype.getTlCmdShare=function(){return this.getValues("CmdShare")},e.prototype.getCmdSpecialGiftCache=function(t){return this.get("CmdSpecialGiftCache",t)},e.prototype.getTlCmdSpecialGiftCache=function(){return this.getValues("CmdSpecialGiftCache")},e.prototype.getCmdTask=function(t){return this.get("CmdTask",t)},e.prototype.getTlCmdTask=function(){return this.getValues("CmdTask")},e.__cname="CacheMgrGen",e}(t("../../../framework/cache/GameCacheMgr").GameCacheMgr);r.CacheMgrGen=i,cc._RF.pop()},{"../../../framework/cache/GameCacheMgr":void 0}],CacheMgr:[function(t,e,r){"use strict";cc._RF.push(e,"a6e13n4MDxNKYSmwv7k/Iq8","CacheMgr");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.CacheMgr=void 0;var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getTlCmdItemNew=function(){var t,e,r=this.getValues("CmdItem"),o=[];try{for(var n=i(r),a=n.next();!a.done;a=n.next()){var l=a.value;l.number>0&&o.push(l)}}catch(s){t={error:s}}finally{try{a&&!a.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}return o},e.prototype.getCmdItem=function(){return null},e.__cname="CacheMgr",e.instance=new e,e}(t("../generated/netProto/CacheMgrGen").CacheMgrGen);r.CacheMgr=a,cc._RF.pop()},{"../generated/netProto/CacheMgrGen":"CacheMgrGen"}],ChestMgr:[function(t,e,r){"use strict";cc._RF.push(e,"fa4047DbnBA5LvAriCVS/Ou","ChestMgr");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.ChestMgr=void 0;var l=t("../../../../../../framework/base/ScriptObject"),s=t("../../../../../../framework/container/Container"),c=t("../../../../../../framework/event/EventCallback"),u=function(t){function e(){var e=t.call(this)||this;return e.ids_loading=new Set,e.ids=new Set,e.picks=new Set,e.ani_time=[],e.addOrUpdateCallback=new c.EventCallback,e.deleteCallback=new c.EventCallback,e._picked=[],e}return n(e,t),Object.defineProperty(e.prototype,"idpool",{get:function(){return this.SystemCommon.idpool},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"posData",{get:function(){return this.SystemCommon.posData},enumerable:!1,configurable:!0}),e.prototype.createChest=function(t,e,r,o){var n=t.GetType(),i=this.SystemCommon.GetSub(n);i.ref=t,this.assert(null!=i,"\u7c7b\u578b\u672a\u6ce8\u518c"+n);var a=this.idpool.Add(n);this.ids_loading.add(a),this.posData.setupXY(a,r,o),this.posData.model[a]=i.GetModel(a),this.posData.loaded[a]=!1,i.Add(a),i.SetParam(a,e),this.addOrUpdateCallback.execute(a),this.__print()},e.prototype.destroyChest=function(t){var e=this.idpool.GetItem(t);this.SystemCommon.GetSub(e).Delete(t),this.posData.model[t]=null,this.posData.upsetXY(t),this.posData.loaded[t]=!1,this.idpool.Remove(t),this.ids.delete(t),this.ani_time[t]=null,this.picks.delete(t),this.deleteCallback.execute(t),this.__print()},e.prototype.__print=function(){},e.prototype.pickChest=function(t){if(this.ids.delete(t)){this.ani_time[t]=0,this.picks.add(t),this.GPAudio.chest();try{var e=this.idpool.GetItem(t),r=this.SystemCommon.GetSub(e);this.posData.model[t]=r.GetModel2(t),this.addOrUpdateCallback.execute(t)}catch(o){console.error(o)}}},e.prototype.updatePick=function(t){var e,r,o,n,i=this._picked;i.length=0;try{for(var l=a(this.picks),s=l.next();!s.done;s=l.next()){var c=s.value;this.ani_time[c]+=t,this.ani_time[c]>=.58&&(this.ani_time[c]=null,i.push(c))}}catch(f){e={error:f}}finally{try{s&&!s.done&&(r=l.return)&&r.call(l)}finally{if(e)throw e.error}}try{for(var u=a(i),p=u.next();!p.done;p=u.next())c=p.value,this.takeChest(c)}catch(h){o={error:h}}finally{try{p&&!p.done&&(n=u.return)&&n.call(u)}finally{if(o)throw o.error}}},e.prototype.takeChest=function(t){var e=this.idpool.GetItem(t);this.picks.delete(t)&&(this.SystemCommon.GetSub(e).Pick(t),this.destroyChest(t))},e.prototype.findNear=function(t,e,r,o){var n,i,l=this.posData.x,s=this.posData.y,c=this.posData.loaded,u=r*r;try{for(var p=a(this.ids),f=p.next();!f.done;f=p.next()){var h=f.value;0!=c[h]&&(l[h]-t)*(l[h]-t)+(s[h]-e)*(s[h]-e)<=u&&o.push(h)}}catch(y){n={error:y}}finally{try{f&&!f.done&&(i=p.return)&&i.call(p)}finally{if(n)throw n.error}}return o},e.__cname="ChestMgr",i([s.injectField("SystemCommon")],e.prototype,"SystemCommon",void 0),i([s.injectField("GPAudio")],e.prototype,"GPAudio",void 0),e}(l.ScriptObject);r.ChestMgr=u,cc._RF.pop()},{"../../../../../../framework/base/ScriptObject":void 0,"../../../../../../framework/container/Container":void 0,"../../../../../../framework/event/EventCallback":void 0}],ClickScript:[function(t,e,r){"use strict";cc._RF.push(e,"bd027Ozs2RLG7kSyG+tgQZ+","ClickScript");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},l=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},s=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.ClickScript=void 0;var c=t("../../../../../framework/coroutine/Cor"),u=t("../../../../../framework/layer/common/UIOrder"),p=t("../../../../../framework/layer/common/UIProxyMgr"),f=t("../../../ui/GameLayer"),h=t("../GuideSectionMgr"),y=t("./GuideScript"),d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isNeedWaitClick=!1,e.isEnterClickUI=!1,e}return n(e,t),e.prototype.OnEnter_cor=function(e){return i(this,void 0,void 0,function(){var r,o,n,i=this;return a(this,function(a){switch(a.label){case 0:return t.prototype.OnEnter_cor.call(this,e),[4,c.Cor.Wait_cor(e,function(){return null!=i.GetCom()})];case 1:return a.sent(),null==(r=this.GetCom())?[2]:(o=function(){i.destroyed||(i.isClickChoose=!0)},n=function(){i.destroyed||(i.isClickUnChoose=!0)},r.tm("\u7ec4\u4ef6_\u70b9\u51fb\u533a\u57df").setClick(o,this),r.tm("\u7ec4\u4ef6_\u906e\u6321\u533a\u57df").setClick(n,this),this.toolSet.addDefer(function(){r.tm("\u7ec4\u4ef6_\u70b9\u51fb\u533a\u57df").removeClick(),r.tm("\u7ec4\u4ef6_\u906e\u6321\u533a\u57df").removeClick()}),[2])}})})},e.prototype.EnableClickOutSizeQuit=function(){var t=this,e=function(){t.destroyed||t.isClickChoose||(t.isClickOutSize=!0)};fgui.GRoot.inst.setClick(e,this),this.toolSet.addDefer(function(){fgui.GRoot.inst.removeClick(e)})},e.prototype.OnRun_cor=function(t){return i(this,void 0,void 0,function(){var e,r=this;return a(this,function(o){switch(o.label){case 0:return this.CtrlMgr.CtrlGuide.LayerGuide.SetOpaque(!0),e=this.TimeUtil.now(),h.GuideSectionMgr.isCanStopGuide?(h.GuideSectionMgr.isCanStopGuide=!1,[4,c.Cor.Wait_cor(t,function(){return r.GetIsInitUI()||r.TimeUtil.now()-e>2})]):[3,2];case 1:if(o.sent(),0==this.GetIsInitUI())return[2];o.label=2;case 2:return e=this.TimeUtil.now(),[4,c.Cor.Wait_cor(t,function(){return r.GetCanStart()||r.TimeUtil.now()-e>10})];case 3:return o.sent(),this.log("getcanStart:",this.GetCanStart()),0==this.GetCanStart()?[2]:(null!=this.quitSectionJudge&&this.CtrlMgr.CtrlGuide.LayerGuide.SetOpaque(!1),this.frameCount=cc.director.getTotalFrames(),[4,c.Cor.Wait_cor(t,function(){return r.CheckQuit()||r.Update()||r.GetCanFinish()})]);case 4:return o.sent(),this.GetCanFinish()?[2]:this.isNeedWaitClick?[4,c.Cor.WaitTime_cor(t,.4)]:[3,6];case 5:o.sent(),o.label=6;case 6:return[2]}})})},e.prototype.onDestroy=function(){var e=this.GetCom();null!=e&&(e.setSelectedPage("\u662f\u5426\u70b9\u51fb","\u5426"),e.setSelectedPage("\u663e\u793a\u52a8\u6548","\u5426")),this.tipsPos=null,this.isClickChoose=!1,this.isClickUnChoose=!1,this.isClickOutSize=!1,this.isNeedWaitClick=!1,t.prototype.onDestroy.call(this)},e.prototype.CheckQuit=function(){if(null==this.quitSectionJudge)return!1;var t=this.GetClickGObject();if(null==t&&this.isClickOutSize)return this.reSult=y.GuideScriptResult.QUIT,!0;var e=this.isClickOutSize||this.quitSectionJudge(t);return this.reSult=e&&y.GuideScriptResult.QUIT||null,e},e.prototype.Update=function(){0==this.isEnterClickUI&&this.UnloadTopLayerAndSwichTab();var t=this.GetClickGObject();if(!t)return!1;if(null==this.GetCom())return!1;this.OnShowEffectAndSetPosition(t);var e=this.isClickChoose;if(e){this.isEnterClickUI=!0;var r=cc.director.getTotalFrames();if(null==this.frameCount||this.frameCount==r)return!1;if(null!=this.clickScript){var o=this.GetUICom();this.clickScript(o,t)}else{var n=t.asButton;null!=n?(n.fireClick(),this.isNeedWaitClick=!0):t.onClick.call(this)}}if(this.isClickUnChoose&&null==this.quitSectionJudge){this.isClickUnChoose=!1;var i=this.GetCom();i.setSelectedPage("\u663e\u793a\u52a8\u6548","\u5426"),i.setSelectedPage("\u663e\u793a\u52a8\u6548","\u662f")}return this.reSult=e&&y.GuideScriptResult.NORMAL||null,e},e.prototype.UnloadTopLayerAndSwichTab=function(){var t,e;if(null==this.curLayerProxy){if(null==this.layerClazz)return;if(null==(d=p.UIProxyMgr.instance.getUIProxy(this.layerClazz)))return;this.curLayerProxy=d}var r=this.curLayerProxy,o=r.getSortOrder(),n=r.getSortOrder2(),i=p.UIProxyMgr.instance.GetTmLoadUIProxy();this.log("tm:",i);try{for(var a=l(i),c=a.next();!c.done;c=a.next()){var h=s(c.value,2),y=h[0];if(h[1],y instanceof f.GameLayerProxy){var d,m=(d=y).getSortOrder();m>=u.LayerOrder.OneLevel&&m<=u.LayerOrder.ThreeLevel&&(m>o?d.unload():m==o&&d.getSortOrder2()>n&&d.unload())}}}catch(_){t={error:_}}finally{try{c&&!c.done&&(e=a.return)&&e.call(a)}finally{if(t)throw t.error}}if(null!=this.tabClazz){var v=r.getTab(this.tabClazz,this.tabName);if(null==v)return;r.getRunningTab()!=v&&r.switchTab(this.tabClazz,this.tabName)}},e.prototype.GetUI=function(){if(null==this.layerClazz)return null;var t,e=p.UIProxyMgr.instance.getUIProxy(this.layerClazz);if(null==e)return null;if(null==(t=e.ui))return null;if(null!=this.tabClazz){var r=e.getTab(this.tabClazz,this.tabName);if(null==r)return null;if(null==(t=r.ui))return null}if(null!=this.panelClazz){var o=e.GetPanelByClassName(this.panelClazz.__cname);if(null==o)return null;if(null==(t=o.ui))return null}return t},e.prototype.GetUICom=function(){var t=this.GetUI();return null==t?null:t.getGuideCom()},e.prototype.GetClickGObject=function(){var t=this.GetUICom();if(null==t)return null;var e=null;return null==this.clickUrl?(this.error("\u7f3a\u5c11clickUrl\uff0c\u8bf7\u4f20\u5165"),null):("string"==typeof this.clickUrl?e=t.tm(this.clickUrl):"function"==typeof this.clickUrl&&(e=this.clickUrl(t)),null==e?null:e)},e.prototype.OnShowEffectAndSetPosition=function(t){var e=this.GetCom(),r=s(this.GetObjToRootXYAndWH(t),4),o=r[0],n=r[1],i=r[2],a=r[3],l=o+i/2+(this.showPivotX||0)*i,c=n+a/2+(this.showPivotY||0)*a,u=this.expand||10;e.tm("\u7ec4\u4ef6_\u70b9\u51fb\u533a\u57df").setPosition(o+i/2,n+a/2),e.tm("\u7ec4\u4ef6_\u70b9\u51fb\u533a\u57df").setSize(i+2*u,a+2*u),e.tm("\u53ef\u89c6\u5316").setPosition(o+i/2,n+a/2),e.tm("\u53ef\u89c6\u5316").setSize(i+2*u,a+2*u),e.tm("\u7ec4\u4ef6_\u70b9\u51fb\u63d0\u793a").setPosition(l,c),e.tm("\u5f3a\u5236\u70b9\u51fb\u63d0\u793a").setPosition(l,c),e.setSelectedPage("\u662f\u5426\u70b9\u51fb","\u662f")},e.prototype.GetObjToRootXYAndWH=function(t){var e=0,r=0,o=t.width,n=t.height;t.pivotAsAnchor&&(e=-t.pivotX*t.width,r=-t.pivotY*t.height,o=(1-t.pivotX)*t.width,n=(1-t.pivotY)*t.height);var i=t.localToGlobal(e,r),a=t.localToGlobal(o,n),l=a.x-i.x,s=a.y-i.y;return[i.x,i.y,l,s]},e.prototype.OnGetStartFunc=function(){return!0},e.prototype.OnGetFinishFunc=function(){return null},e.prototype.GetIsInitUI=function(){if(null==this.layerClazz)return!1;var t=p.UIProxyMgr.instance.getUIProxy(this.layerClazz);return null!=t&&0!=t.isLoad},e.prototype.GetCanStart=function(){var t=this.GetUI();return null!=t&&this.OnGetStartFunc(t)},e.prototype.GetCanFinish=function(){var t=this.GetUI();if(null==t)return!0;var e=this.OnGetFinishFunc(t);return null==e?!this.OnGetStartFunc(t):e},e.__cname="ClickScript",e}(y.GuideScript);r.ClickScript=d,cc._RF.pop()},{"../../../../../framework/coroutine/Cor":void 0,"../../../../../framework/layer/common/UIOrder":void 0,"../../../../../framework/layer/common/UIProxyMgr":void 0,"../../../ui/GameLayer":"GameLayer","../GuideSectionMgr":"GuideSectionMgr","./GuideScript":"GuideScript"}],CmdInterface:[function(t,e,r){"use strict";cc._RF.push(e,"368ffvk9m1N2a1bZUAtjOHD","CmdInterface"),Object.defineProperty(r,"__esModule",{value:!0}),r.CmdRedDotType=r.CmdRankType=r.CmdTaskType=r.CmdCommonState=r.CmdClientAppendDataModelEnum=r.CmdFuBenType=void 0,function(t){t[t.CHAPTER=1]="CHAPTER",t[t.MONEY=2]="MONEY",t[t.DAILY=3]="DAILY"}(r.CmdFuBenType||(r.CmdFuBenType={})),function(t){t[t.CmdGuideList=1]="CmdGuideList"}(r.CmdClientAppendDataModelEnum||(r.CmdClientAppendDataModelEnum={})),function(t){t[t.UNDONE=0]="UNDONE",t[t.FINISH=1]="FINISH",t[t.REWARDED=2]="REWARDED"}(r.CmdCommonState||(r.CmdCommonState={})),function(t){t[t.DAILY_TASK=0]="DAILY_TASK",t[t.WEEKLY_TASK=1]="WEEKLY_TASK",t[t.ACHIEVEMENT_TASK=2]="ACHIEVEMENT_TASK"}(r.CmdTaskType||(r.CmdTaskType={})),function(t){t[t.SERVER_POWER_RANK=1]="SERVER_POWER_RANK",t[t.SERVER_VIRTUE_RANK=2]="SERVER_VIRTUE_RANK",t[t.SERVER_POPULARITY_RANK=3]="SERVER_POPULARITY_RANK",t[t.FRIEND_POWER_RANK=4]="FRIEND_POWER_RANK",t[t.FRIEND_VIRTUE_RANK=5]="FRIEND_VIRTUE_RANK",t[t.FRIEND_POPULARITY_RANK=6]="FRIEND_POPULARITY_RANK"}(r.CmdRankType||(r.CmdRankType={})),function(t){t[t.TEST=1]="TEST",t[t.DAILY_TASK=2]="DAILY_TASK",t[t.WEEKLY_TASK=3]="WEEKLY_TASK",t[t.ACHIEVEMENT_TASK=4]="ACHIEVEMENT_TASK",t[t.HERO_TASK=5]="HERO_TASK",t[t.EVERY_DAY_SIGN=6]="EVERY_DAY_SIGN",t[t.DAY_WEEK_MONTH_GIFT=7]="DAY_WEEK_MONTH_GIFT",t[t.MONTH_CARD=8]="MONTH_CARD",t[t.MAIL=9]="MAIL"}(r.CmdRedDotType||(r.CmdRedDotType={})),cc._RF.pop()},{}],CollisionUtil:[function(t,e,r){"use strict";cc._RF.push(e,"57af389u3FITK2xLkZ2ubKV","CollisionUtil"),Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function t(){}return t.CheckCollisionAABB=function(t,e,r,o,n,i,a,l){return t+r>=n&&n+a>=t&&e+o>=i&&i+l>=e},t}();r.default=o,cc._RF.pop()},{}],ComAI:[function(t,e,r){"use strict";cc._RF.push(e,"d4a4bBpg4lMSYNfsFzqo5Z0","ComAI");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.ComAI=r.EComAITree=r.ComAIType=void 0;var i,a,l=t("../../../../../../framework/ecs/Com"),s=t("./boss/BTBossCharge"),c=t("./boss/BTBossRemote"),u=t("./boss/BTBossStatic");(function(t){t[t.IDLE=0]="IDLE",t[t.WANDER=1]="WANDER",t[t.CONTROLLABLE=2]="CONTROLLABLE",t[t.SEEK=3]="SEEK",t[t.BEHAVIOR_TREE=4]="BEHAVIOR_TREE",t[t.COUNT=5]="COUNT"})(i=r.ComAIType||(r.ComAIType={})),function(t){t[t.BossCharge=0]="BossCharge",t[t.BossRemote=1]="BossRemote",t[t.BossStatic=2]="BossStatic"}(a=r.EComAITree||(r.EComAITree={}));var p=function(t){function e(){var e=t.call(this)||this;return e.type=e.CreateNumber(-1),e.param=e.Create(),e.nextType=e.CreateNumber(0),e.nextParam=e.Create(),e.tmBTBoss=new Map,e.tree=e.Create(),e.SetBehaviorTree(a.BossCharge,s.BTBossCharge),e.SetBehaviorTree(a.BossRemote,c.BTBossRemote),e.SetBehaviorTree(a.BossStatic,u.BTBossStatic),e}return n(e,t),e.prototype.onDestroy=function(){t.prototype.onDestroy.call(this),this.type=null,this.param=null,this.nextType=null,this.nextParam=null},e.prototype.SwitchWander=function(t,e){var r={step:e,lastTime:.001*cc.director.getTotalTime()-Math.random()*e};return this.nextType[t]=i.WANDER,this.nextParam[t]=r,r},e.prototype.SwitchControllable=function(t){var e={degree:0,moving:!1};return this.nextType[t]=i.CONTROLLABLE,this.nextParam[t]=e,e},e.prototype.SetBehaviorTree=function(t,e){this.tmBTBoss.set(t,e)},e.prototype.CreateBehaviorTree=function(t,e){var r=new(this.tmBTBoss.get(e));return r.Setup(t),r},e.prototype.DestroyBehaviorTree=function(t){t.Clear()},e.prototype.SwitchBehaviorTree=function(t,e){var r={type:e};return this.nextType[t]=i.BEHAVIOR_TREE,this.nextParam[t]=r,r},e.__cname="ComAI",e}(l.Com);r.ComAI=p,cc._RF.pop()},{"../../../../../../framework/ecs/Com":void 0,"./boss/BTBossCharge":"BTBossCharge","./boss/BTBossRemote":"BTBossRemote","./boss/BTBossStatic":"BTBossStatic"}],ComBuffCarrier:[function(t,e,r){"use strict";cc._RF.push(e,"6c7a3kpfKZAopvif0AlKJ56","ComBuffCarrier");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.ComBuffCarrier=void 0;var a=t("../../../../../../framework/container/Container"),l=t("../../../../../../framework/ecs/Com"),s=t("./role/BuffCarrierHandler"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.DoBleed=function(t,e){var r=s.BuffCarrierHandler.Create(t,e,300010);this.SystemBuffCarrier.HandlerBuff(r)},e.prototype.DoSlow=function(t,e){var r=s.BuffCarrierHandler.Create(t,e,400140);this.SystemBuffCarrier.HandlerBuff(r)},e.__cname="ComBuffCarrier",i([a.injectField("SystemBuffCarrier")],e.prototype,"SystemBuffCarrier",void 0),e}(l.Com);r.ComBuffCarrier=c,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../../../../../framework/ecs/Com":void 0,"./role/BuffCarrierHandler":"BuffCarrierHandler"}],ComCollision:[function(t,e,r){"use strict";cc._RF.push(e,"2ec3dmHG1NJCpq6M6hdvYW+","ComCollision");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.ComCollision=void 0;var l=t("../../../../../../framework/ecs/Com"),s=.8,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.activeCollision=e.CreateBoolean(!0),e.isTrigger=e.CreateBoolean(!1),e.r=e.CreateNumber(0),e.mass=e.CreateNumber(1),e.cr=e.CreateNumber(s),e.colliding=e.CreateBoolean(!1),e.collisons=e.Create(null),e.collisionsMonster=e.Create(null),e.customCollided=e.Create(null),e.customCaller=e.Create(null),e.recycle=e.CreateBoolean(!1),e.tlDirty=new Set,e}return n(e,t),e.prototype.onDestroy=function(){t.prototype.onDestroy.call(this),this.r=null},e.prototype.OnAddEntity=function(t){this.collisons[t]=new Set,this.collisionsMonster[t]=new Set},e.prototype.OnRemoveEntity=function(t){delete this.collisons[t],delete this.collisionsMonster[t]},e.prototype.GetClosePoint=function(t,e,r,o,n){var i=Math.atan2(n-e,o-t);return[t+r*Math.cos(i),e+r*Math.sin(i)]},e.prototype.GetDistance=function(t,e,r,o,n,a){var l=i(this.GetClosePoint(t,e,r,o,n),2),s=l[0],c=l[1],u=i(this.GetClosePoint(o,n,a,t,e),2),p=u[0],f=u[1],h=(p-s)*(p-s)+(f-c)*(f-c);return Math.sqrt(h)},e.prototype.CheckCollision=function(t,e,r,o,n,i){return(o-t)*(o-t)+(n-e)*(n-e)<=(r+i)*(r+i)},e.prototype.ResetCollide=function(){for(var t,e,r,o,n=this.colliding,i=0;i<n.length;i++)n[i]=!1;try{for(var l=a(this.collisons),s=l.next();!s.done;s=l.next())(p=s.value)&&p.clear()}catch(f){t={error:f}}finally{try{s&&!s.done&&(e=l.return)&&e.call(l)}finally{if(t)throw t.error}}try{for(var c=a(this.collisionsMonster),u=c.next();!u.done;u=c.next()){var p;(p=u.value)&&p.clear()}}catch(h){r={error:h}}finally{try{u&&!u.done&&(o=c.return)&&o.call(c)}finally{if(r)throw r.error}}},e.prototype.SetActive=function(t,e){this.activeCollision[t]=e},e.prototype.SetCustomCollided=function(t,e,r){this.customCollided[t]=e,this.customCaller[t]=r},e.__cname="ComCollision",e}(l.Com);r.ComCollision=c,cc._RF.pop()},{"../../../../../../framework/ecs/Com":void 0}],ComPos:[function(t,e,r){"use strict";cc._RF.push(e,"59c95+3Th1A7q6YbrLr/x3A","ComPos");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.ComPos=r.EDirectionType=void 0;var i,a=t("../../../../../../framework/ecs/Com");(function(t){t[t.Normal=0]="Normal",t[t.LeftRight=1]="LeftRight"})(i=r.EDirectionType||(r.EDirectionType={}));var l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.x=e.CreateNumber(0),e.y=e.CreateNumber(0),e.dType=e.CreateNumber(i.Normal),e.d=e.CreateNumber(0),e.gx=e.CreateNumber(-1),e.gy=e.CreateNumber(-1),e}return n(e,t),e.prototype.onDestroy=function(){t.prototype.onDestroy.call(this),this.x=null,this.y=null,this.d=null,this.gx=null,this.gy=null},e.prototype.check=function(t,e,r,o){var n=this.x[t],i=this.y[t],a=this.x[r]-n,l=this.y[r]-i;return a*a+l*l<=(e+o)*(e+o)},e.__cname="ComPos",e}(a.Com);r.ComPos=l,cc._RF.pop()},{"../../../../../../framework/ecs/Com":void 0}],ComPrefab:[function(t,e,r){"use strict";cc._RF.push(e,"e5e82ICOptGPLq9yNUzNdXq","ComPrefab");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.ComPrefab=void 0;var a=t("../../../../../../framework/container/Container"),l=t("../../../../../../framework/ecs/Com"),s=t("../nodeproxy/NodeProxy"),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.model=e.Create(null),e.anim=e.CreateNumber(0),e.white=e.CreateNumber(0),e.scale=e.CreateNumber(1),e.order=e.Create(s.NodeProxyOrder.Role),e.alpha=e.CreateNumber(1),e.prototypeSize=e.CreateNumber(null),e.nextModel=e.Create(null),e.nextAnim=e.CreateNumber(null),e.nextWhite=e.CreateNumber(0),e.nextScale=e.CreateNumber(1),e.nextPrototypeSize=e.CreateNumber(null),e.addWedgit=e.Create(),e.removeWedgit=e.Create(),e}return n(e,t),e.prototype.OnAddEntity=function(t){this.addWedgit[t]=new Set,this.removeWedgit[t]=new Set},e.prototype.OnRemoveEntity=function(t){this.addWedgit[t]=null,this.removeWedgit[t]=null},e.prototype.ChangeModel=function(t,e,r,o,n,i){var a=this.model[t],l=this.anim[t],s=this.white[t],c=this.scale[t],u=this.prototypeSize[t];e=null==e?a:e,r=null==r?l:r,o=null==o?s:o,n=null==n?c:n,i=null==i?u:i;for(var p=!1;;){a!=e&&(this.nextModel[t]=e,p=!0),l!=r&&(this.nextAnim[t]=r,p=!0),s!=o&&(this.nextWhite[t]=o,p=!0),c!=n&&(this.nextScale[t]=n,p=!0),u!=i&&(this.nextPrototypeSize[t]=i,p=!0);break}p&&this.MarkDirty(t)},e.prototype.MarkDirty=function(t){this.SystemView.pushStateQueue(t)},e.prototype.AddWedgit=function(t,e){this.addWedgit[t].add(e),this.SystemViewWedgit.MarkDirty(t)},e.prototype.RemoveWedgit=function(t,e){this.removeWedgit[t].add(e),this.SystemViewWedgit.MarkDirty(t)},e.__cname="ComPrefab",i([a.injectField("ModelPrefab")],e.prototype,"ModelPrefab",void 0),i([a.injectField("ComType")],e.prototype,"ComType",void 0),i([a.injectField("SystemView")],e.prototype,"SystemView",void 0),i([a.injectField("SystemViewWedgit")],e.prototype,"SystemViewWedgit",void 0),e}(l.Com);r.ComPrefab=c,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../../../../../framework/ecs/Com":void 0,"../nodeproxy/NodeProxy":"NodeProxy"}],ComRole:[function(t,e,r){"use strict";cc._RF.push(e,"1c1d4ZJVB5OI5zh/GYAoCqN","ComRole");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.ComRole=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.__cname="ComRole",e}(t("../../../../../../framework/ecs/Com").Com);r.ComRole=i,cc._RF.pop()},{"../../../../../../framework/ecs/Com":void 0}],ComSkill:[function(t,e,r){"use strict";cc._RF.push(e,"f2397LHW1VGnI5IGJy6RtKg","ComSkill");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.ComSkill=void 0;var l=t("../../../../../../framework/container/Container"),s=t("../../../../../../framework/ecs/Com"),c=t("./data/SkillContext"),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.SkillContextMgr=new c.SkillContextMgr,e.tlContext=e.Create(),e.ids=new Set,e._RemoveSkillByTypeId=[],e._GetSkillBy=[],e}return n(e,t),e.prototype.OnAddEntity=function(t){this.tlContext[t]=new Set},e.prototype.BeforeRemoveEntity=function(t){var e,r,o=this.tlContext[t];try{for(var n=a(o),i=n.next();!i.done;i=n.next()){var l=i.value;this.RemoveSkill(t,l)}}catch(s){e={error:s}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}},e.prototype.SetSkill=function(t,e){var r=e.refSkillType.GetRefId(),o=(e.refSkillPlan.GetRefId(),e.cid),n=this.SystemSkill.GetSkillById(r);this.assert(0==this.ids.has(o),"\u6280\u80fd"+e.toString()+", \u91cd\u590d\u6ce8\u518c\u7ed9\u540c\u4e00\u5355\u4f4d"),e.skill=n,n.AddContext(e),n.ChangeParams(e.cid),this.ids.add(o)},e.prototype.RemoveSkill=function(t,e){e.skill.RemoveContext(e),this.ids.delete(e.cid),this.DestroyContext(e)},e.prototype.RemoveSkillBy=function(t,e,r){for(var o,n,i;null==i;){var l=this.tlContext[t];if(null==l)break;try{for(var s=(o=void 0,a(l)),c=s.next();!c.done;c=s.next()){var u=c.value;if(u.skillTypeId==e&&u.skillPlanId==r){i=u;break}}}catch(p){o={error:p}}finally{try{c&&!c.done&&(n=s.return)&&n.call(s)}finally{if(o)throw o.error}}break}i&&this.RemoveSkill(t,i)},e.prototype.RemoveSkillByTypeId=function(t,e){var r,o,n,i,l=this._RemoveSkillByTypeId;for(l.length=0;;){var s=this.tlContext[t];if(null==s)break;try{for(var c=(r=void 0,a(s)),u=c.next();!u.done;u=c.next())(h=u.value).skillTypeId==e&&l.push(h)}catch(y){r={error:y}}finally{try{u&&!u.done&&(o=c.return)&&o.call(c)}finally{if(r)throw r.error}}break}try{for(var p=a(l),f=p.next();!f.done;f=p.next()){var h=f.value;this.RemoveSkill(t,h)}}catch(d){n={error:d}}finally{try{f&&!f.done&&(i=p.return)&&i.call(p)}finally{if(n)throw n.error}}l.length=0},e.prototype.SetOtherSkill=function(t,e,r,o){void 0===o&&(o=!0);var n=this.CreateContext(t),i=this.ModelBattleSkill.GetSkillTypeMonster(e),a=this.ModelBattleSkill.GetSkillMonster(r),l=c.SkillContextType.Monster;n.Setup(t,l,i,a),n.isAuto=o,this.SetSkill(t,n)},e.prototype.SetHeroSkill=function(t,e,r){var o=this.ModelBattleSkill.FindSkillLevel(e,r);if(o){this.RemoveSkillByTypeId(t,e);var n=this.CreateContext(t),i=this.ModelBattleSkill.GetSkill(e),a=c.SkillContextType.Hero;n.Setup(t,a,i,o),this.SetSkill(t,n)}},e.prototype.GetSkillBy=function(t){var e,r,o=this._GetSkillBy;for(o.length=0;;){var n=this.tlContext[t];if(null==n)break;try{for(var i=(e=void 0,a(n)),l=i.next();!l.done;l=i.next()){var s=l.value;o.push(s)}}catch(c){e={error:c}}finally{try{l&&!l.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}break}return o},e.prototype.SetIsAuto=function(t,e){this.SystemSkill;var r,o,n=this.tlContext;if(n)try{for(var i=a(n[t]),l=i.next();!l.done;l=i.next())l.value.isAuto=e}catch(s){r={error:s}}finally{try{l&&!l.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}},e.prototype.CreateContext=function(t){var e=this.tlContext[t],r=this.SkillContextMgr.GetData();return r.eid=t,e.add(r),r},e.prototype.DestroyContext=function(t){var e=t.eid;this.tlContext[e].delete(t),t.Clear(),this.SkillContextMgr.ReturnData(t)},e.__cname="ComSkill",i([l.injectField("SystemSkill")],e.prototype,"SystemSkill",void 0),i([l.injectField("ModelBattleSkill")],e.prototype,"ModelBattleSkill",void 0),e}(s.Com);r.ComSkill=u,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../../../../../framework/ecs/Com":void 0,"./data/SkillContext":"SkillContext"}],ComState:[function(t,e,r){"use strict";cc._RF.push(e,"90d45F3a/5CG63fEB9N7Aq9","ComState");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.ComState=void 0;var a=t("../../../../../../framework/container/Container"),l=t("../../../../../../framework/ecs/Com"),s=t("../../../../../../framework/FW"),c=t("./SystemState"),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=e.CreateNumber(-1),e.param=e.Create(),e.nextType=e.Create(c.ComStateType.IDLE),e.nextParam=e.Create(),e.nextDestory=e.CreateBoolean(!1),e.lastType=e.Create(c.ComStateType.IDLE),e.lastParam=e.Create(),e.locked=e.CreateBoolean(!1),e}return n(e,t),e.prototype.onDestroy=function(){t.prototype.onDestroy.call(this),this.type=null,this.param=null,this.nextType=null,this.nextParam=null},e.prototype.checkSwitch=function(t,e){var r=this.Battle.ref2id(t);if(!r)return!1;var o=this.nextType[r]||this.type[r];return e==c.ComStateType.REBORN||o!=c.ComStateType.DIE&&o!=c.ComStateType.DESTROY},e.prototype.ResumeLastState=function(t){var e=this.lastType,r=this.lastParam;null!=e[t]&&(this.nextType[t]=e[t],this.nextParam[t]=r[t])},e.prototype.SwitchMove=function(t,e,r,o){var n=this.Battle.ref2id(t);if(n&&this.checkSwitch(t,c.ComStateType.MOVE)){this.nextType[n]=c.ComStateType.MOVE;var i={tx:e,ty:r,stop:o};return this.nextParam[n]=i,i}},e.prototype.SwitchIdle=function(t){var e=this.Battle.ref2id(t);if(e)return this.nextType[e]=c.ComStateType.IDLE,this.nextParam[e]=null,null},e.prototype.SwitchDie=function(t){var e=this.Battle.ref2id(t);if(e&&this.checkSwitch(t,c.ComStateType.DIE))return this.nextType[e]=c.ComStateType.DIE,this.nextParam[e]=null,null},e.prototype.SwitchReborn=function(t){var e=this.Battle.ref2id(t);if(e&&this.checkSwitch(t,c.ComStateType.REBORN))return this.nextType[e]=c.ComStateType.REBORN,this.nextParam[e]=null,null},e.prototype.SwitchDestroy=function(t){return this.nextType[t]=c.ComStateType.DESTROY,this.nextParam[t]=null,null},e.prototype.SwitchSeek=function(t,e,r){var o={target:e,stop:r};return this.nextType[t]=c.ComStateType.SEEK,this.nextParam[t]=o,o},e.prototype.SwitchCharge=function(t,e,r,o){var n={target:e,distance:r,stop:o};return this.nextType[t]=c.ComStateType.CHARGE,this.nextParam[t]=n,n},e.prototype.SwitchChargeLeave=function(t,e){var r={target:e};return this.nextType[t]=c.ComStateType.CHARGE_LEAVE,this.nextParam[t]=r,r},e.prototype.SwitchKeep=function(t,e,r,o){var n={target:e,distance:r,stop:o};return this.nextType[t]=c.ComStateType.KEEP,this.nextParam[t]=n,n},e.prototype.SwitchWanderVeritical=function(t,e,r){var o={target:e,distance:r};return this.nextType[t]=c.ComStateType.WANDER_VERTICAL,this.nextParam[t]=o,o},e.prototype.SwitchWander=function(t,e,r){var o={target:e,distance:r};return this.nextType[t]=c.ComStateType.WANDER,this.nextParam[t]=o,o},e.prototype.SwitchConjure=function(t,e){void 0===e&&(e=!0);var r={isresume:e};return this.nextType[t]=c.ComStateType.CONJURE,this.nextParam[t]=r,r},e.prototype.SwitchSelfBoom=function(t,e,r){var o={target:e,stop:r};return this.nextType[t]=c.ComStateType.SELF_BOOM,this.nextParam[t]=o,o},e.prototype.SwitchDebugBullet=function(t,e){s.FW.ZJJ.log("\u5b50\u5f39\u72b6\u6001\u672a\u5f00\u53d1",e);var r={};return this.nextType[t]=c.ComStateType.IDLE,this.nextParam[t]=r,r},e.prototype.SwitchSwordField=function(t,e,r){var o={stop:e,resId:r};return this.nextType[t]=c.ComStateType.SWORD_FIELD,this.nextParam[t]=o,o},e.prototype.SwitchBoomerange=function(t,e){var r={resId:e};return this.nextType[t]=c.ComStateType.BOOMERANGE,this.nextParam[t]=r,r},e.prototype.SwitchBoomerangeSuper=function(t,e){var r={resId:e};return this.nextType[t]=c.ComStateType.BOOMERANGE_SUPER,this.nextParam[t]=r,r},e.prototype.SwitchLightning=function(t,e,r){var o={resId:r,target:e};return this.nextType[t]=c.ComStateType.LIGHTNING,this.nextParam[t]=o,o},e.prototype.SwitchLightningSuper=function(t,e,r){var o={resId:r,target:e};return this.nextType[t]=c.ComStateType.LIGHTNING_SUPER,this.nextParam[t]=o,o},e.prototype.SwitchDart=function(t,e,r){var o={sender:e,resId:r};return this.nextType[t]=c.ComStateType.DART,this.nextParam[t]=o,o},e.prototype.SwitchDartSuperRed=function(t,e){var r={resId:e};return this.nextType[t]=c.ComStateType.DART_SUPER_RED,this.nextParam[t]=r,r},e.prototype.SwitchField=function(t,e){var r={sender:e};return this.nextType[t]=c.ComStateType.FIELD,this.nextParam[t]=r,r},e.prototype.SwitchGuarder=function(t,e,r,o,n){var i={sender:e,startangle:r,r:o,resId:n};return this.nextType[t]=c.ComStateType.GUARDER,this.nextParam[t]=i,i},e.prototype.SwitchMissile=function(t,e,r){var o={degree:e,resId:r};return this.nextType[t]=c.ComStateType.MISSILE,this.nextParam[t]=o,o},e.prototype.SwitchFootball=function(t,e,r){var o={degree:e,resId:r};return this.nextType[t]=c.ComStateType.FOOTBALL,this.nextParam[t]=o,o},e.prototype.SwitchBrick=function(t,e){var r={resId:e};return this.nextType[t]=c.ComStateType.BRICK,this.nextParam[t]=r,r},e.prototype.SwitchDurian=function(t,e){var r={resId:e};return this.nextType[t]=c.ComStateType.DURIAN,this.nextParam[t]=r,r},e.prototype.SwitchDrill=function(t,e){var r={resId:e};return this.nextType[t]=c.ComStateType.DRILL,this.nextParam[t]=r,r},e.prototype.SwitchDrillSuper=function(t,e,r){var o={sender:e,resId:r};return this.nextType[t]=c.ComStateType.DRILL_SUPER,this.nextParam[t]=o,o},e.prototype.SwitchStraight=function(t,e){var r={resId:e};return this.nextType[t]=c.ComStateType.STRAIGHT,this.nextParam[t]=r,r},e.prototype.SwitchMolotov=function(t,e){var r={resId:e};return this.nextType[t]=c.ComStateType.MOLOTOV,this.nextParam[t]=r,r},e.prototype.SwitchRobotBullet=function(t,e,r,o){var n={resId:e,x:r,y:o};return this.nextType[t]=c.ComStateType.ROBOT_BULLET,this.nextParam[t]=n,n},e.prototype.SwitchBat=function(t,e,r,o){var n={resId:e,sender:r,radius:o};return this.nextType[t]=c.ComStateType.BAT,this.nextParam[t]=n,n},e.prototype.SwitchVenom=function(t,e,r){var o={resId:r,sender:e};return this.nextType[t]=c.ComStateType.VENOM,this.nextParam[t]=o,o},e.prototype.SwitchCrossBow=function(t,e){var r={resId:e};return this.nextType[t]=c.ComStateType.CROSS_BOW,this.nextParam[t]=r,r},e.prototype.SwitchStatic=function(t){return this.nextType[t]=c.ComStateType.STATIC,this.nextParam[t]=null,null},e.prototype.SwitchFieldSlow=function(t,e){var r={resId:e};return this.nextType[t]=c.ComStateType.FIELD_SLOW,this.nextParam[t]=r,r},e.prototype.SwitchStorm=function(t,e){var r={resId:e};return this.nextType[t]=c.ComStateType.STORM,this.nextParam[t]=r,r},e.prototype.SwitchPulses=function(t,e){var r={resId:e};return this.nextType[t]=c.ComStateType.PULSES,this.nextParam[t]=r,r},e.prototype.SwitchRadiation=function(t,e){var r={sender:e};return this.nextType[t]=c.ComStateType.RADIATION,this.nextParam[t]=r,r},e.prototype.SwitchBoom=function(t,e,r){var o={resId:r,target:e};return this.nextType[t]=c.ComStateType.BOOM,this.nextParam[t]=o,o},e.prototype.SwitchFollow=function(t,e){var r={sender:e};return this.nextType[t]=c.ComStateType.FOLLOW,this.nextParam[t]=r,r},e.__cname="ComState",i([a.injectField("Battle")],e.prototype,"Battle",void 0),e}(l.Com);r.ComState=u,cc._RF.pop()},{"../../../../../../framework/FW":void 0,"../../../../../../framework/container/Container":void 0,"../../../../../../framework/ecs/Com":void 0,"./SystemState":"SystemState"}],ComType:[function(t,e,r){"use strict";cc._RF.push(e,"e3933hxR1xG1KUQgeWQ91Wa","ComType");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.ComType=r.EComTag=r.EComType=void 0;var l,s=t("../../../../../../framework/container/Container"),c=t("../../../../../../framework/ecs/Com");function u(t,e,r){var o=t[e];t[e]=t[r],t[r]=o}(function(t){t[t.None=0]="None",t[t.PropBox=1]="PropBox",t[t.Monster=2]="Monster",t[t.BossGuardMonster=3]="BossGuardMonster",t[t.Player=4]="Player",t[t.Bullet=5]="Bullet",t[t.Count=6]="Count"})(l=r.EComType||(r.EComType={})),function(t){t[t.MonsterBullet=0]="MonsterBullet"}(r.EComTag||(r.EComTag={}));var p=function(t){function e(){var e=t.call(this)||this;e.typeSet=new Map,e.nextType=e.Create(l.None),e.tidSet=new Map,e.groupSet=new Map,e.tlChanged=new Set,e.tmTag=new Map,e.tmTagGroup=new Map;for(var r=0;r<l.Count;r++){var o=r;e.groupSet.set(o,[])}return e}return n(e,t),e.prototype.onDestroy=function(){},e.prototype.OnAddEntity=function(t){this.tlChanged.add(t)},e.prototype.OnRemoveEntity=function(t){this.ClearTag(t);var e=this.tidSet,r=this.typeSet,o=this.groupSet;if(r.has(t)){var n=r.get(t),i=(e.get(t),o.get(n));if(i.length>1){var a=t,l=e.get(a),s=i.length-1,c=i[s];u(i,l,s),e.set(c,l)}i.length-=1,r.delete(t),e.delete(t)}},e.prototype.ApplyAdd=function(){var t,e;if(0!=this.tlChanged.size){var r=this.typeSet,o=this.tidSet,n=this.nextType,i=this.groupSet;try{for(var l=a(this.tlChanged),s=l.next();!s.done;s=l.next()){var c=s.value,u=n[c];r.set(c,u);var p=i.get(u),f=p.length;p.push(c),o.set(c,f)}}catch(h){t={error:h}}finally{try{s&&!s.done&&(e=l.return)&&e.call(l)}finally{if(t)throw t.error}}this.tlChanged.clear()}},e.prototype.GetType=function(t){return this.typeSet.get(t)},e.prototype.GetGroup=function(t){return this.groupSet.get(t)},e.prototype.GetTagList=function(t){var e=this.tmTag.get(t);return null==e&&(e=[],this.tmTag.set(t,e)),e},e.prototype.GetTagGroup=function(t){var e=this.tmTagGroup.get(t);return null==e&&(e=new Set,this.tmTagGroup.set(t,e)),e},e.prototype.AddTag=function(t,e){this.GetTagList(t)[e]=!0,this.GetTagGroup(e).add(t)},e.prototype.DeleteTag=function(t,e){var r=!1;return this.tmTag.has(t)&&(this.GetTagGroup(e).delete(t),delete this.GetTagList(t)[e],r=!0),r},e.prototype.ClearTag=function(t){if(this.tmTag.has(t)){for(var e=this.GetTagList(t),r=0;r<e.length;r++){var o=r;e[o]&&this.GetTagGroup(o).delete(t)}this.tmTag.delete(t)}},e.prototype.HasTag=function(t,e){var r=!1;return this.tmTag.has(t)&&(r=1==this.GetTagList(t)[e]),r},e.prototype.GetGroupByTag=function(t){return this.GetTagGroup(t)},e.__cname="ComType",i([s.injectField("Battle")],e.prototype,"Battle",void 0),e}(c.Com);r.ComType=p,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../../../../../framework/ecs/Com":void 0}],ComVar:[function(t,e,r){"use strict";cc._RF.push(e,"2bfd9jYmUFCjKeyIWhXREO0","ComVar");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.ComVar=r.EComEvent=r.EComCamp=void 0;var l,s=t("../../../../../../framework/container/Container"),c=t("../../../../../../framework/ecs/Com"),u=t("../../../../../../framework/event/EventCallback"),p=t("../../../../../../framework/event/EventProxy"),f=t("../../../../../../framework/Func"),h=t("../../BattleUtil"),y=t("../common/SystemCommon"),d=t("../SystemDamage"),m=t("../type/ComType");(function(t){t[t.Monster=1]="Monster",t[t.Hero=10]="Hero"})(r.EComCamp||(r.EComCamp={})),function(t){t[t.TakeDamage=0]="TakeDamage"}(l=r.EComEvent||(r.EComEvent={}));var v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.HP=e.CreateNumber(1),e.HP_Max=e.CreateNumber(1),e.ATK=e.CreateNumber(1),e.SPECIAL_ATK=e.CreateNumber(0),e.DEFENCE=e.CreateNumber(0),e.SHOOT_TARGET=e.CreateNumber(),e.CAMP=e.Create(),e.REACTION=e.CreateNumber(500),e.ALIVE=e.CreateBoolean(!0),e.DESTROY=e.CreateBoolean(!1),e.NAME=e.CreateString(""),e.RESID=e.CreateNumber(null),e.SEARCHABLE=e.CreateBoolean(!0),e.BULLET_SENDER=e.CreateNumber(null),e.BULLET_SKILL=e.CreateNumber(null),e.PENETRATE=e.CreateNumber(0),e.PENETRATE_DESTROY=e.CreateBoolean(!0),e.BULLET_KILLER=e.CreateNumber(0),e.BULLET_REBOUND=e.CreateNumber(0),e.BULLET_REPEL=e.CreateNumber(0),e.BULLET_EFFECT_TIME=e.CreateNumber(0),e.BULLET_DAMAGE_INTERVAL=e.CreateNumber(0),e.BULLET_LIFETIME=e.CreateNumber(0),e.BULLET_SCRIPT_PARAMS=e.Create(null),e.BULLET_SCALE_RATE=e.CreateNumber(1),e.BULLET_ATTR_SPEED=e.CreateNumber(1),e.BULLET_BUILDER=e.Create(null),e.BULLET_REF=e.Create(null),e.BULLET_ATTR_BVE=e.CreateBoolean(!1),e.BULLET_MODEL_PROTOTYPE_SIZE=e.CreateNumber(0),e.BULLET_ATTR_DAMAGE_RATE=e.CreateNumber(1),e.BULLET_ATTR_FIRST_HIT=e.CreateBoolean(!1),e.BULLET_IS_FIRST_HIT=e.CreateBoolean(!1),e.SKILL_REPEL=e.CreateNumber(0),e.PICK_RANGE=e.CreateNumber(null),e.CRIT_RATE=e.CreateNumber(0),e.CRIT_DAMAGE=e.CreateNumber(2),e.TEN_DAMAGE_RATE=e.CreateNumber(0),e.MONSTER_HP_DROP=0,e.UP_ADD_HP=1,e.UP_ADD_HP_FIX=0,e.SUPPLY_ADD=e.Create(null),e.THUMP_BLOOD=!1,e.MONSTER_CAN_REPEL=e.CreateBoolean(!0),e.MONSTER_DEF_REPEL=e.CreateNumber(0),e.MONSTER_REF=e.Create(null),e.MONSTER_COLLID=e.Create(!0),e.MONSTER_AI=e.Create(null),e.MONSTER_NO_HP=e.CreateBoolean(!1),e.BOSS_COPY=e.CreateNumber(0),e.HURT_ADD=e.CreateNumber(0),e.SPEED_REDUCE=e.CreateNumber(0),e.INVINCIBLE=e.Create(),e.BEHIT_DURATION=e.Create(),e.BEHIT_TIME=e.Create(),e.BEHIT_SENDER=e.Create(),e.REPL_MAX=200,e.HEROHP=0,e.HEROID=null,e.HEROREF=null,e.LEVEL=0,e.EXP=0,e.EXP_MAX=10,e.KILL=0,e.KILL_BOSS=0,e.GOLD=0,e.STARTTIME=0,e.GAMETIME=0,e.GAME_PROCESS=0,e.GAME_TOTALTIME=0,e.MONSTER_STRONG_LEVEL=0,e.MAIN_SKILL_CD=0,e.MAIN_SKILL_CD_MAX=1,e.MAIN_SKILL_CD_TYPE=0,e.MONSTER_HP_ADD=1,e.MONSTER_SPEED_ADD=1,e.MONSTER_ATK_ADD=1,e.MONSTER_DROP_RATE=1,e.BOSS_CREATE_NUM=1,e.ROLE_VIEW_RADIUS=0,e.HERO_SKILL_LIMIT=0,e.DIELIST=new Set,e.INVINCIBLELIST=new Set,e.BE_HIT_LIST=new Set,e.HeroChangeCallback=new u.EventCallback,e.HeroBeHitCallback=new u.EventCallback,e.eventProxy=new p.EventProxy,e.isTakeLevelUp=!1,e._drop=[],e}return n(e,t),e.prototype.GetHeroChangeCallback=function(){return this.HeroChangeCallback},e.prototype.GetHeroBeHitCallback=function(){return this.HeroBeHitCallback},e.prototype.GetEventProxy=function(){return this.eventProxy},e.prototype.onDestroy=function(){this.eventProxy.destroy(),t.prototype.onDestroy.call(this)},e.prototype.calDamage=function(t){t.damageTag.Remote&&(e=this.GetAttr(t.tid,"bdr"))&&(t.damageValue.base-=e.base,t.damageValue.fixed-=e.addition,t.damageValue.rate-=e.rate),t.damageTag.Melee&&(e=this.GetAttr(t.tid,"ddr"))&&(t.damageValue.base-=e.base,t.damageValue.fixed-=e.addition,t.damageValue.rate-=e.rate),(e=this.GetAttr(t.tid,"dmr"))&&(t.damageValue.base+=e.addition,t.damageValue.fixed+=e.addition,t.damageValue.rate+=e.rate);var e,r=this.MONSTER_REF[t.tid];if(((null==r?void 0:r.GetIsBoss())||(null==r?void 0:r.GetIsElite()))&&(e=this.GetAttr(this.HEROID,"bdi"))&&(t.damageValue.rate+=e.rate),t.tid!=this.HEROID&&(e=this.GetAttr(this.HEROID,"hhk"))){var o=this.HP[t.tid]/this.HP_Max[t.tid]-.5;if(o>0){var n=cc.misc.lerp(0,e.rate,2*o);t.damageValue.rate+=n}}t.tid!=this.HEROID&&this.HP[t.tid]==this.HP_Max[t.tid]&&(e=this.GetAttr(this.HEROID,"fdi"))&&(t.damageValue.rate+=e.rate),(e=this.HURT_ADD[t.tid])>1&&(t.damageValue.rate+=e-1),t.damageValue.base=Math.max(0,t.damageValue.base),t.damageValue.fixed=Math.max(0,t.damageValue.fixed)},e.prototype.takeDamage=function(t,e,r){if(this.Battle.startConfig.bossShow){this.eventProxy.execute(l.TakeDamage,t,e,r);var o=!1;e==this.HEROID&&(o=this.Battle.startConfig.debugField);var n=r.GetDamage(),i=this.BOSS_COPY[e]||e,a=this.HP[i],s=this.MONSTER_NO_HP[i];if(a-=n,a=Math.max(a,0),this.HP[i]=a,e==this.HEROID&&this.SystemEvent.SendTriggerHpChange(i),0==o&&a<=0&&!s)if(this.SystemEvent.SendTriggerReadyDie(r),r.damageTag.IsStopDie)this.HP[i]<1&&(this.HP[i]=1);else{if(10015==this.BULLET_SKILL[t]){var c=this.CalHeroAttr("s7036",0);c>0&&this.takeExp(c)}this.ALIVE[i]=!1,this.DIELIST.add(i),this.BOSS_COPY[e]&&(this.ALIVE[e]=!1,this.DIELIST.add(e))}i==this.HEROID&&(this.HeroChangeCallback.execute(),this.HeroBeHitCallback.execute())}},e.prototype.takeDie=function(t){this.HP[t]=0,this.ALIVE[t]=!1,this.DIELIST.add(t)},e.prototype.takeHpMax=function(t,e){var r=this.HP_Max[t];this.HP_Max[t]=e;var o=e,n=o-r;if(0!=n){var i=this.HP[t]+n;i=Math.max(0,Math.min(o,i)),this.HP[t]=i,this.SystemEvent.SendTriggerHpChange(t)}this.HeroChangeCallback.execute()},e.prototype.takeHitRestore=function(t,e){e=e||0,e=this.CalAttr(t,"eor",e);var r=this.HP[t],o=Math.min(r+e,this.HP_Max[t]);this.HP[t]=o,r!=o&&(this.HeroChangeCallback.execute(),this.SystemEvent.SendTriggerHpChange(t))},e.prototype.takeRDE=function(t,e){e=e||0,e=this.CalAttr(t,"eor",e);var r=this.HP[t],o=Math.min(r+e,this.HP_Max[t]);if(this.HP[t]=o,r!=o){this.HeroChangeCallback.execute();var n=d.DamageInfo.CreateEmpty();n.damageValue.base=e,n.damageTag.Cure=1,this.SystemEvent.sendDamageText(t,n),this.SystemEvent.SendTriggerRestore(n),this.SystemEvent.SendTriggerHpChange(t)}},e.prototype.takeRestore=function(t,e){e=e||0,e=this.CalAttr(t,"eor",e);var r=this.HP[t],o=Math.min(r+e,this.HP_Max[t]);if(this.HP[t]=o,r!=o){this.HeroChangeCallback.execute();var n=d.DamageInfo.CreateEmpty();n.damageValue.base=e,n.damageTag.Cure=1,this.SystemEvent.sendDamageText(t,n),this.SystemEvent.SendTriggerRestore(n),this.SystemEvent.SendTriggerHpChange(t)}this.SystemEvent.SendTriggerTake()},e.prototype.takePrecentRestore=function(t,e){var r=this.HP_Max[t],o=Math.floor(r*e);this.takeRestore(t,o)},e.prototype.takeExp=function(t){t=this.CalAttr(this.HEROID,"bxp",t),this.EXP+=t,this.HeroChangeCallback.execute()},e.prototype.sendExpChange=function(){this.HeroChangeCallback.execute()},e.prototype.takeLevelUp=function(){this.isTakeLevelUp=!0;var t=this.HEROID,e=this.HP[t],r=e*this.UP_ADD_HP;if(r=this.CalAttr(t,"eor",r),r+=this.UP_ADD_HP_FIX,(r=Math.min(r,this.HP_Max[t]))!=e){this.HP[t]=r,this.HeroChangeCallback.execute();var o=d.DamageInfo.CreateEmpty();o.damageValue.base=r-e,o.damageTag.Cure=1,this.SystemEvent.sendDamageText(t,o),this.SystemViewEffect.AddEffectEntity("\u767e\u604b_\u6218\u6597\u573a\u666f\u7279\u6548_\u56de\u8840",this.HEROREF,!1,!0)}},e.prototype.canLevelup=function(){return!(this.IS_MAX_LEVEL||this.EXP<this.EXP_MAX)},e.prototype.updateExpMax=function(){var t=this.LEVEL,e=this.ModelBattleLevel.isMaxLevel(t),r=0;e||(r=this.ModelBattleLevel.getNextExp(t)),this.EXP_MAX=r,this.IS_MAX_LEVEL=e,this.takeLevelUpMonster(),this.HeroChangeCallback.execute()},e.prototype.takeLevelUpMonster=function(){this.MONSTER_STRONG_LEVEL=this.LEVEL},e.prototype.takeKill=function(){this.KILL+=1,this.HeroChangeCallback.execute(),this.checkEquipDrop(1,this.KILL)},e.prototype.takeBossDown=function(t){this.BOSS_COPY.includes(t)||(this.KILL_BOSS++,this.checkEquipDrop(1,this.KILL_BOSS,t))},e.prototype.takeGametime=function(t){this.GAMETIME=t,this.updateGameProcess(),this.HeroChangeCallback.execute(),this.checkEquipDrop(3,t)},e.prototype.checkEquipDrop=function(t,e,r){for(var o=this.Ref.RefMgrbattleEquipDrawingRef.getTlRef("type",t),n=function(n){var a=o[n];if(a.need==e){var l=i.getBattleDrop(a.id);if((null==l?void 0:l.length)>0){var s=[];l.forEach(function(t){s.push(t.resId)}),i.SystemCommon.handleBattleDrop(t,s,r)}return"break"}},i=this,a=0;a<o.length&&"break"!==n(a);a++);},e.prototype.getBattleDrop=function(t){var e=this.ModelBattleDrop.battleDrop;if(e){var r=e.find(function(e){return e.resId==t});if(null==r?void 0:r.cmdGoods)return r.cmdGoods}},e.prototype.takeStartTime=function(t){this.STARTTIME=t},e.prototype.takeTotalTime=function(t){this.GAME_TOTALTIME=t},e.prototype.updateGameProcess=function(){var t=this.GAME_TOTALTIME,e=this.GAMETIME,r=0;return t&&0!=t&&(r=e/t,this.GAME_PROCESS=r),Math.max(0,Math.min(r,1))},e.prototype.takeGold=function(t,e){void 0===e&&(e=!1),e||(t=this.CalAttr(this.HEROID,"bcp",t),t*=this.Battle.startConfig.roleLevelGold),this.GOLD+=t,this.HeroChangeCallback.execute()},e.prototype.takeMonsterDrop=function(t){var e=this;if(!this.Battle.startConfig.noEvent){if(this.ComType.GetType(t)==m.EComType.Monster){var r=this.RESID[t],o=this.ModelBattleWave.GetMonster(r),n=this.SystemSpawn.GetPoint(),i=this.Battle.startConfig.fubenId,a=this.ModelBattleDrop.GetDropPlanBy(i,n),l=o.GetDropLevel(),s=a.GetMonsterDrop(l);if(null!=s){var c=this.RandomDrop(s);return c.forEach(function(t){3==t.ref.GetType()&&(t.value*=e.MONSTER_DROP_RATE)}),c}}return null}},e.prototype.takeBox=function(){var t=this.SystemSpawn.GetPoint(),e=this.Battle.startConfig.fubenId,r=this.ModelBattleDrop.GetDropPlanBy(e,t);if(r)return this.RandomDrop(r.GetBoxDrop())},e.prototype.RandomDrop=function(t){var e,r,o=this,n=this._drop;if(n.length=0,null==t)return n;var i=this.ModelBattleDrop.GetDrop(t),l=function(t){if(0==t.reward.length)return"continue";if(1==t.reward.length)return(r=s.GetDropReward(t.reward[0]))&&n.push(r),"continue";var e=f.Func.deepCopy(t.weight);t.reward.forEach(function(t,r){3==o.ModelBattleDrop.GetReward(t).GetType()&&(e[r]*=o.MONSTER_DROP_RATE)});var r,i=h.BattleUtil.PrepareWeightedRandom(t.reward,e);(r=s.GetDropReward(i))&&n.push(r)},s=this;try{for(var c=a(i.param),u=c.next();!u.done;u=c.next())l(u.value)}catch(p){e={error:p}}finally{try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(e)throw e.error}}return n},e.prototype.GetDropReward=function(t){var e=this.ModelBattleDrop.GetReward(t);return this.assert(null!=e,"battleChestRewardRef.json id\u4e0d\u5b58\u5728",t),e.GetType()==y.EBProp.SKILL_CHEST?this.GetDropSkillChest(e):this.GetDropNormal(e)},e.prototype.GetDropNormal=function(t){var e=null;return t&&(t.GetType(),e={ref:t,value:t.GetValue()}),e},e.prototype.GetDropSkillChest=function(t){if(!t)return null;var e=this.Battle.startConfig.fubenId,r=this.SystemSpawn.GetPoint(),o=this.ModelBattleDrop.GetDropPlanBy(e,r);return null==o?null:{ref:t,value:o.GetSkillChest()}},e.prototype.takeReborn=function(t,e){this.HP[t]=null==e?this.HP_Max[t]:e,this.ALIVE[t]=!0,this.DESTROY[t]=!1,this.INVINCIBLE[t]=2,this.INVINCIBLELIST.add(t),this.HeroChangeCallback.execute()},e.prototype.takeBehit=function(t,e,r){void 0===r&&(r=.3),this.BEHIT_SENDER[t]=e,this.BEHIT_TIME[t]=0,this.BEHIT_DURATION[t]=r,this.BE_HIT_LIST.add(t)},e.prototype.canTakeBehit=function(t,e){var r=this.MONSTER_CAN_REPEL,o=this.BULLET_REPEL[e],n=this.MONSTER_DEF_REPEL;if(0==r[t])return!1;var i=this.BULLET_SKILL[e];return i&&(o+=o*this.SKILL_REPEL[i]),!(Math.max(0,Math.min(this.REPL_MAX,o-n[t]))<=0)},e.prototype.SetAttr=function(t,e,r,o,n){var i,a=!1;return null==i&&t==this.HEROID&&(i=this.HERO_ATTR.GetAttr(e)),null!=i&&(a=!0,null!=r&&(i.base+=r),null!=o&&(i.addition+=o),null!=n&&(i.rate+=n)),"atk"==e&&(this.ATK[t]=this.GetAttrValue(t,"atk",0)),"spd"==e&&(this.ComVelocity.speed[t]=this.GetAttrValue(t,"spd",100)),a},e.prototype.SetSupplyAdd=function(t,e){this.SUPPLY_ADD[t]=e},e.prototype.CalAttr=function(t,e,r){var o=r;return t==this.HEROID&&(o=this.HERO_ATTR.CalAttr(e,r)),o},e.prototype.CalHeroAttr=function(t,e){return this.HERO_ATTR.CalAttr(t,e)},e.prototype.GetAttr=function(t,e,r){void 0===r&&(r=null);var o=r;return t==this.HEROID&&(o=this.HERO_ATTR.GetAttr(e)),o},e.prototype.GetAttrValue=function(t,e,r){var o=r;return t==this.HEROID&&(o=this.HERO_ATTR.GetAttr(e).GetValue()),o},e.prototype.CalBulletScale=function(t,e){var r=0;if(this.BULLET_ATTR_BVE[t]){var o=this.BULLET_SENDER[t];if(o){var n=this.GetAttr(o,"bve",null);n&&n.rate}}return e*(1+(r+(this.BULLET_SCALE_RATE[t]||0)))},e.prototype.CalBulletPrototypeSize=function(t,e){return e*this.CalBulletScale(t,1)},e.prototype.CheckBulletCollision=function(t,e){for(var r=!1;;){var o=this.ComType.GetType(t),n=this.ComType.GetType(e);if(o!=m.EComType.Bullet)break;if(o!=n)break;var i=this.BULLET_REF[t],a=this.BULLET_REF[e];if(null==i||null==a)break;if(0==i.GetBulletKiller())break;var l=i.GetTlTag(),s=a.GetTlTag();if(this.ModelBattleSkill.GetBulletCanCollision(l,s)){r=!0;break}break}return r},e.prototype.CheckBulletKill=function(t,e){for(var r=!1;;){var o=this.ComType.GetType(t),n=this.ComType.GetType(e);if(o!=m.EComType.Bullet)break;if(o!=n)break;var i=this.BULLET_REF[t],a=this.BULLET_REF[e];if(null==i||null==a)break;if(i.GetBulletKiller()-a.GetBulletKillerDef()>0){r=!0;break}break}return r},e.__cname="ComVar",i([s.injectField("SystemEvent")],e.prototype,"SystemEvent",void 0),i([s.injectField("SystemSpawn")],e.prototype,"SystemSpawn",void 0),i([s.injectField("SystemCommon")],e.prototype,"SystemCommon",void 0),i([s.injectField("ModelBattleLevel")],e.prototype,"ModelBattleLevel",void 0),i([s.injectField("ModelBattleDrop")],e.prototype,"ModelBattleDrop",void 0),i([s.injectField("ModelBattleWave")],e.prototype,"ModelBattleWave",void 0),i([s.injectField("ModelBattleSkill")],e.prototype,"ModelBattleSkill",void 0),i([s.injectField("GPNetSync")],e.prototype,"GPNetSync",void 0),i([s.injectField("Ref")],e.prototype,"Ref",void 0),i([s.injectField("SystemViewEffect")],e.prototype,"SystemViewEffect",void 0),i([s.injectField("ComVelocity")],e.prototype,"ComVelocity",void 0),i([s.injectField("ComType")],e.prototype,"ComType",void 0),i([s.injectField("Battle")],e.prototype,"Battle",void 0),e}(c.Com);r.ComVar=v,cc._RF.pop()},{"../../../../../../framework/Func":void 0,"../../../../../../framework/container/Container":void 0,"../../../../../../framework/ecs/Com":void 0,"../../../../../../framework/event/EventCallback":void 0,"../../../../../../framework/event/EventProxy":void 0,"../../BattleUtil":"BattleUtil","../SystemDamage":"SystemDamage","../common/SystemCommon":"SystemCommon","../type/ComType":"ComType"}],ComVelocity:[function(t,e,r){"use strict";cc._RF.push(e,"dd073ao8jVF1oFG4lDZ6edL","ComVelocity");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.ComVelocity=void 0;var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.vx=e.CreateNumber(0),e.vy=e.CreateNumber(0),e.vgx=e.CreateNumber(0),e.vgy=e.CreateNumber(0),e.basespeed=e.CreateNumber(0),e.speed=e.CreateNumber(0),e.moving=e.CreateBoolean(!1),e}return n(e,t),e.prototype.onDestroy=function(){t.prototype.onDestroy.call(this),this.vx=null,this.vy=null,this.speed=null,this.moving=null},e.__cname="ComVelocity",e}(t("../../../../../../framework/ecs/Com").Com);r.ComVelocity=i,cc._RF.pop()},{"../../../../../../framework/ecs/Com":void 0}],CommonUtlis:[function(t,e,r){"use strict";cc._RF.push(e,"85715g69D1K5ogAfpL/eSTm","CommonUtlis");var o=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.CommonUtils=void 0;var n=t("../../../../framework/container/Container"),i=t("../../../../framework/FW"),a=function(){function t(){}return t.ChangeTxtByQ=function(t,e){var r;switch(t){case 0:r="[color=#FFFFFF]"+e+"[/color]";break;case 1:r="[color=#52A731]"+e+"[/color]";break;case 2:r="[color=#5C9DFF]"+e+"[/color]";break;case 3:r="[color=#E889FF]"+e+"[/color]";break;case 4:r="[color=#FFA34F]"+e+"[/color]";break;case 5:r="[color=#CB3737]"+e+"[/color]";break;case 6:r="[color=#FFEF3A]"+e+"[/color]";break;default:r=e}return r},t.GetColorByQuality=function(t){var e;switch(t){case 1:e=5416753;break;case 2:e=6069759;break;case 3:e=15239679;break;case 4:e=16753487;break;case 5:e=13317943;break;case 6:e=16772922;break;default:e=16777215}return e},t.GetColorByQualityReStr=function(t){var e;switch(t){case 1:e="#52A731";break;case 2:e="#5C9DFF";break;case 3:e="#E889FF";break;case 4:e="#FFA34F";break;case 5:e="#CB3737";break;case 6:e="#FFEF3A";break;default:e="#FFFFFF"}return e},t.getForceNameStr=function(){return null},t.getHeroQualityNameStr=function(t){return{1:i.FW.G_W("\u666e\u901a"),2:i.FW.G_W("\u77e5\u540d"),3:i.FW.G_W("\u7a00\u6709"),4:i.FW.G_W("\u53f2\u8bd7"),5:i.FW.G_W("\u4f20\u5947"),6:i.FW.G_W("\u9ed1\u91d1")}[t]},t.getHeroTacticsColorNameStr=function(t){return{1:i.FW.G_W("\u767d\u8272"),2:i.FW.G_W("\u7eff\u8272"),3:i.FW.G_W("\u84dd\u8272"),4:i.FW.G_W("\u7d2b\u8272"),5:i.FW.G_W("\u6a59\u8272"),6:i.FW.G_W("\u7ea2\u8272")}[t]},t.getHeroTacticsSolidNameStr=function(t){return{0:i.FW.G_W("\u5168\u519b"),1:i.FW.G_W("\u6b65\u5175"),2:i.FW.G_W("\u9a91\u5175"),3:i.FW.G_W("\u5c04\u624b"),4:i.FW.G_W("\u6218\u8f66"),5:i.FW.G_W("\u524d\u519b"),6:i.FW.G_W("\u540e\u519b")}[t]},t.getSkillConditionEventStr=function(t){return{0:i.FW.G_W("\u5e73\u65f6"),1:i.FW.G_W("\u5f00\u573a"),2:i.FW.G_W("\u8fdc\u6218\u7b2c\u4e00\u56de\u5408"),3:i.FW.G_W("\u8fdc\u6218\u7b2c\u4e8c\u56de\u5408"),4:i.FW.G_W("\u8fd1\u6218\u7b2c\u4e00\u56de\u5408"),5:i.FW.G_W("\u8fd1\u6218\u7b2c\u4e8c\u56de\u5408"),6:i.FW.G_W("\u88ab\u653b\u51fb\u65f6"),7:i.FW.G_W("\u654c\u65b9\u6b7b\u4ea1\u65f6"),8:i.FW.G_W("\u8fdc\u6218\u6240\u6709\u56de\u5408"),9:i.FW.G_W("\u8fd1\u6218\u6240\u6709\u56de\u5408"),10:i.FW.G_W("\u653b\u51fb\u540e"),11:i.FW.G_W("\u6240\u6709\u56de\u5408 "),12:i.FW.G_W("\u88ab\u51fb\u6740\u65f6"),13:i.FW.G_W("\u82f1\u96c4\u6280\u80fd\u540e\u89e6\u53d1"),14:i.FW.G_W("\u5175\u79cd\u6280\u80fd\u540e\u89e6\u53d1"),15:i.FW.G_W("\u666e\u653b\u540e\u89e6\u53d1"),16:i.FW.G_W("\u8fdc\u6218\u56de\u5408\u7ed3\u675f\u65f6+\u6740\u6b7b\u654c\u65b9\u540e"),17:i.FW.G_W("\u6240\u6709\u56de\u5408\u7ed3\u675f\u65f6+\u6740\u6b7b\u654c\u65b9\u540e")}[t]},t.getSkillTypeStr=function(t){return{1:i.FW.G_W("\u82f1\u96c4\u6280\u80fd"),2:i.FW.G_W("\u6b65\u5175\u6280\u80fd"),3:i.FW.G_W("\u9a91\u5175\u6280\u80fd"),4:i.FW.G_W("\u5c04\u624b\u6280\u80fd"),5:i.FW.G_W("\u6218\u8f66\u6280\u80fd"),6:i.FW.G_W("\u8f85\u52a9\u6280\u80fd"),7:i.FW.G_W("\u5185\u653f\u6280\u80fd"),8:i.FW.G_W("\u5176\u4ed6"),9:i.FW.G_W("\u5929\u8d4b"),10:i.FW.G_W("\u88c5\u5907"),11:i.FW.G_W("\u5408\u51fb\u6280")}[t]},o([n.injectField("Ref")],t.prototype,"ref",void 0),t}();r.CommonUtils=a,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/container/Container":void 0}],ConstAttr:[function(t,e,r){"use strict";cc._RF.push(e,"9bcf1kMdAVCQad7n8mvp0FQ","ConstAttr"),Object.defineProperty(r,"__esModule",{value:!0}),r.EAttrType=void 0,function(t){t[t.Phy=0]="Phy",t[t.Weg=1]="Weg",t[t.Hp=2]="Hp",t[t.Dmr=3]="Dmr",t[t.Spd=4]="Spd",t[t.Rde=5]="Rde",t[t.Crs=6]="Crs",t[t.Crd=7]="Crd",t[t.LV=8]="LV",t[t.Exp=9]="Exp",t[t.Pkr=10]="Pkr",t[t.Coin=11]="Coin",t[t.Kill=12]="Kill"}(r.EAttrType||(r.EAttrType={})),cc._RF.pop()},{}],ConstBattleBT:[function(t,e,r){"use strict";cc._RF.push(e,"e131csCpPxNz46HLOK6D2ji","ConstBattleBT"),Object.defineProperty(r,"__esModule",{value:!0}),r.BTContext=r.BTResult=r.BTState=void 0,function(t){t[t.Ready=0]="Ready",t[t.Running=1]="Running"}(r.BTState||(r.BTState={})),function(t){t[t.Success=0]="Success",t[t.Failure=1]="Failure",t[t.Running=2]="Running"}(r.BTResult||(r.BTResult={}));r.BTContext=function(){this.skillData=[]},cc._RF.pop()},{}],ConstBattle:[function(t,e,r){"use strict";cc._RF.push(e,"42164+ZFsNAgbxB1ToLeIr8","ConstBattle"),Object.defineProperty(r,"__esModule",{value:!0}),r.BATTLE_MAX_TIME_MULIT=void 0,r.BATTLE_MAX_TIME_MULIT=30,cc._RF.pop()},{}],ConstBradge:[function(t,e){"use strict";var r;cc._RF.push(e,"e2170Hs/X5MRpWegwNFN+vE","ConstBradge"),function(t){t[t.SDKInit=0]="SDKInit",t[t.SDKInitSuccess=1]="SDKInitSuccess",t[t.SDKInitFail=2]="SDKInitFail",t[t.NeedGameUnzip=3]="NeedGameUnzip",t[t.GameUnzip=4]="GameUnzip",t[t.GameUnzipSuccess=5]="GameUnzipSuccess"}(r||(r={})),cc._RF.pop()},{}],ConstFiends:[function(t,e,r){"use strict";cc._RF.push(e,"7fc03mRs1RGMI6heop9AA2N","ConstFiends"),Object.defineProperty(r,"__esModule",{value:!0}),r.FriendsType=void 0,function(t){t[t.friend=0]="friend",t[t.staReceive=1]="staReceive",t[t.applicationList=2]="applicationList",t[t.blacklist=3]="blacklist"}(r.FriendsType||(r.FriendsType={})),cc._RF.pop()},{}],ConstSDK:[function(t,e,r){"use strict";cc._RF.push(e,"f96dev432FDY5+E6zN8Q2mu","ConstSDK");var o=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},n=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.LoadSdk=r.SdkTypeEnum=void 0;var i,a=t("../../../../framework/FW");(function(t){t.YouaiSDK="YouaiSDK",t.JiYinSDK="JiYinSDK",t.XinHeSDK="XinHeSDK",t.HuolangSDK="HuolangSDK",t.GuweiSDK="GuweiSDK",t.MuzhiwanSDK="MuzhiwanSDK"})(i=r.SdkTypeEnum||(r.SdkTypeEnum={})),r.LoadSdk=function(e){return o(this,void 0,void 0,function(){var r,o;return n(this,function(n){switch(n.label){case 0:switch(a.FW.Log.log("LoadSdk"),e){case i.YouaiSDK:return[3,1];case i.JiYinSDK:return[3,4];case i.GuweiSDK:return[3,7];case i.XinHeSDK:return[3,10];case i.HuolangSDK:return[3,13];case i.MuzhiwanSDK:return[3,16]}return[3,19];case 1:return[4,a.FW.AssetMgr.getBundle("sdk_youai").load()];case 2:return n.sent(),[4,Promise.resolve().then(function(){return t("../../../../module/sdk_youai/YouaiSDK")})];case 3:return r=new(n.sent().YouaiSDK),[3,20];case 4:return[4,a.FW.AssetMgr.getBundle("sdk_jiyin").load()];case 5:return n.sent(),[4,Promise.resolve().then(function(){return t("../../../../module/sdk_jiyin/jiyinSDK")})];case 6:return r=new(n.sent().jiyinSDK),[3,20];case 7:return a.FW.Log.log("LoadSdk GuweiSDK"),[4,a.FW.AssetMgr.getBundle("sdk_guwei").load()];case 8:return n.sent(),[4,Promise.resolve().then(function(){return t("../../../../module/sdk_guwei/minigame/GuweiSDKMiniGame")})];case 9:return r=new(n.sent().GuweiSDKMiniGame),[3,20];case 10:return[4,a.FW.AssetMgr.getBundle("sdk_xinghe").load()];case 11:return n.sent(),[4,Promise.resolve().then(function(){return t("../../../../module/sdk_xinghe/XHSDK")})];case 12:return o=n.sent().XHSDK,r=o.Create(),[3,20];case 13:return[4,a.FW.AssetMgr.getBundle("sdk_huolang").load()];case 14:return n.sent(),[4,Promise.resolve().then(function(){return t("../../../../module/sdk_huolang/huolangSDK")})];case 15:return r=new(n.sent().HuolangSDK),[3,20];case 16:return a.FW.Log.log("LoadSdk MuzhiwanSDK"),[4,a.FW.AssetMgr.getBundle("sdk_muzhiwan").load()];case 17:return n.sent(),[4,Promise.resolve().then(function(){return t("../../../../module/sdk_muzhiwan/minigame/MuzhiwanSDKMiniGame")})];case 18:return r=new(n.sent().MuzhiwanSDKMiniGame),[3,20];case 19:n.label=20;case 20:return[2,r]}})})},cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../module/sdk_guwei/minigame/GuweiSDKMiniGame":void 0,"../../../../module/sdk_huolang/huolangSDK":void 0,"../../../../module/sdk_jiyin/jiyinSDK":void 0,"../../../../module/sdk_muzhiwan/minigame/MuzhiwanSDKMiniGame":void 0,"../../../../module/sdk_xinghe/XHSDK":void 0,"../../../../module/sdk_youai/YouaiSDK":void 0}],ConstSpawn:[function(t,e,r){"use strict";cc._RF.push(e,"5a550pjrPdDR4zv+k68Hsx/","ConstSpawn"),Object.defineProperty(r,"__esModule",{value:!0}),r.SpawnSpacing=r.WaveData=r.WaveTips=void 0;var o=t("../../../../../../framework/FW"),n=t("./WaveType");(function(t){t[t.None=0]="None",t[t.Monster=1]="Monster",t[t.Boss=2]="Boss"})(r.WaveTips||(r.WaveTips={}));var i=function(){function t(){}return t.prototype.SetupByRef=function(t,e,r){this.ref=t,this.refWave=e,this.refWaveType=r},t.prototype.GetPoint=function(){return this.ref.point},t.prototype.GetDuration=function(){return this.ref.duration},t.prototype.IsBoss=function(){return this.refWaveType.GetType()==n.WaveType.Boss},t.prototype.GetTypeId=function(){return this.ref.typeId},t.prototype.GetType=function(){return this.refWaveType.GetType()},t.prototype.GetCameraZoom=function(){return this.GetPoint()>=100?2:1},t.prototype.GetMonster=function(){var t=this.ref.monster,e=this.refWave.monster[t];return null==e&&o.FW.ZJJ.error("\u6218\u6597\u5237\u602a\u914d\u7f6e\u8868\uff0c\u602a\u7269\u4e0b\u6807\u4e0d\u5b58\u5728 \u6ce2\u6b21id:"+this.refWave.id+" \u4e0b\u6807:"+t+" \u5237\u602a\u6ce2\u6b21\uff1a"+this.ref.id),e},t.prototype.GetSparseByTime=function(t){var e=Math.max(0,t-this.GetPoint()),r=this.GetDuration(),o=this.ref.from,n=this.ref.to;return cc.misc.lerp(o,n,e/r)},t}();r.WaveData=i,r.SpawnSpacing=10,cc._RF.pop()},{"../../../../../../framework/FW":void 0,"./WaveType":"WaveType"}],ConstSubGameplay:[function(t,e,r){"use strict";cc._RF.push(e,"92f0cbIF4pGX7fRbdGfdf7u","ConstSubGameplay");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.GPObjUpgradeable=r.GPObj=void 0;var i=function(){function t(){this.isEmpty=!0}return t.prototype.Clear=function(){this.resId=null,this.ref=null,this.isEmpty=!0},t.prototype.IsEmpty=function(){return this.isEmpty},t.prototype.IsShowLevel=function(){return!1},t.prototype.GetRef=function(){return this.ref},t.prototype.GetResId=function(){return this.resId},t.prototype.UpdateResId=function(t){this.isEmpty=!1,this.resId=t,this.ref=this.LoadRef(t),this.OnUpdateResId(t)},t.prototype.OnClear=function(){},t}();r.GPObj=i;var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.IsShowLevel=function(){return!0},e.prototype.GetMaxLevel=function(){var t=0;return this.ref.GetMaxLevel&&(t=this.ref.GetMaxLevel()),t},e.prototype.GetLevel=function(){return this.level},e.prototype.UpdateLevel=function(t){this.level=t},e.prototype.OnClear=function(){this.level=null,t.prototype.Clear.call(this)},e}(i);r.GPObjUpgradeable=a,cc._RF.pop()},{}],CtrlActivity:[function(t,e,r){"use strict";cc._RF.push(e,"2c2a9nItu5KrJ9pwltTE18h","CtrlActivity");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.CtrlActivity=void 0;var s=t("../../../../framework/container/Container"),c=t("../../../../framework/event/FWEventCenter"),u=t("../../../../framework/FW"),p=t("../../../../framework/utils/Toolset"),f=t("../../model/Activity/ModelActivity"),h=t("../CtrlBehavior"),y=t("./LayerNewPlayerSign"),d=t("./LayerSevenDayChallenge"),m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.LayerNewPlayerSign=e.createUI(y.LayerNewPlayerSign),e.LayerSevenDayChallenge=e.createUI(d.LayerSevenDayChallenge),e.dayDirty=!1,e}return n(e,t),e.prototype.enter=function(){return a(this,void 0,Promise,function(){var t;return l(this,function(){return(t=this).toolSet=p.ToolSet.createToolSet(),t.toolSet.addListener(u.FW.FWEvent.eventProxy,c.FWEventType.theNextDay,function(){t.dayDirty=!0},t),t.toolSet.addUpdateFrame(t.update,t),[2,null]})})},e.prototype.exit=function(){return p.ToolSet.destroyToolSet(this.toolSet),this.toolSet=null,null},e.prototype.update=function(){this.dayDirty&&(this.dayDirty=!1,this.ModelMgr.ModelDayWeekMonthGift.ReqestInfo())},e.prototype.Load=function(t){var e=this.ModelMgr.ModelActivity.GetTlAo(function(e){return e.GetId()==t});if(e.length>0){var r=e[0],o=this.GetUrl(r.GetActivityKind()),n=s.Container.inst().getByAlias(o);if(!n)return void u.FW.Log.error("\u627e\u4e0d\u5230layer\u754c\u9762",o);n.SetActivity(r),n.load()}},e.prototype.GetRDExprByActivityKind=function(t){var e=this.GetUrl(t),r=s.Container.inst().getByAlias(e);if(r)return r.GetRDExpr();u.FW.Log.error("\u627e\u4e0d\u5230layer\u754c\u9762",e)},e.prototype.GetActiviIdByKind=function(t){var e=this.ModelMgr.ModelActivity.GetTlAo(function(e){return e.GetActivityKind()==t});return e.length>0?e[0].GetId():0},e.prototype.GetUrl=function(t){switch(t){case f.EnumActivityKind.SevenDay:return"LayerSevenDayChallenge";case f.EnumActivityKind.EveryDay:return"LayerXinShouQianDao";case f.EnumActivityKind.NewPlayerSign:return"LayerNewPlayerSign";default:this.error("\u8bf7\u6dfb\u52a0\u5bf9\u5e94\u7684layerUrl, EnumActivityKind:",t)}},e.__cname="CtrlActivity",i([s.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(h.CtrlBehavior);r.CtrlActivity=m,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/container/Container":void 0,"../../../../framework/event/FWEventCenter":void 0,"../../../../framework/utils/Toolset":void 0,"../../model/Activity/ModelActivity":"ModelActivity","../CtrlBehavior":"CtrlBehavior","./LayerNewPlayerSign":"LayerNewPlayerSign","./LayerSevenDayChallenge":"LayerSevenDayChallenge"}],CtrlAdventure:[function(t,e,r){"use strict";cc._RF.push(e,"9e4f4ZGDJ9NBrqn/9FCEAAa","CtrlAdventure");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.CtrlAdventure=void 0;var i=t("../../CtrlBehavior"),a=t("./LayerAdventureBuff"),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.LayerAdventureBuff=e.createUI(a.LayerAdventureBuff),e}return n(e,t),e.__cname="CtrlAdventure",e}(i.CtrlBehavior);r.CtrlAdventure=l,cc._RF.pop()},{"../../CtrlBehavior":"CtrlBehavior","./LayerAdventureBuff":"LayerAdventureBuff"}],CtrlAlert:[function(t,e,r){"use strict";cc._RF.push(e,"a364aSCOAFLBbjI84+VRVnf","CtrlAlert");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.CtrlAlert=r.particlesMap=void 0;var c,u=t("../../../../framework/FW"),p=t("../../../../framework/container/Container"),f=t("../../../../framework/layer/PopLayerMgr"),h=t("../../../../framework/utils/StringUtil"),y=t("../../../../framework/utils/Toolset"),d=t("../../model/vo/Goods/Goods"),m=t("../CtrlBehavior"),v=t("../main/Xiulian/LayerMainStaConsumeAnimation"),_=t("./Layer/LayerHeroGet"),S=t("./Layer/LayerRewardDetail"),g=t("./Layer/LayerShowRewards"),b=t("./LayerBuyGoods"),C=t("./LayerDisconnect"),R=t("./LayerMessage"),M=t("./LayerShowTip"),w=t("./LayerTipBuy"),O=t("./LayerWaiting");(function(t){t.gem="gem",t.coin="coin",t.end="end",t.exp="exp",t.number="number",t.energy="energy",t.dailyActive="dailyActive",t.weeklyActive="weeklyActive"})(c||(c={})),r.particlesMap=new Map,r.particlesMap.set("\u9ec4\u8272\u7c92\u5b50","\u767e\u604b_\u7c92\u5b50\u7279\u6548_\u9ec4\u8272"),r.particlesMap.set("\u7ea2\u8272\u7c92\u5b50","\u767e\u604b_\u7c92\u5b50\u7279\u6548_\u7ea2\u8272"),r.particlesMap.set("\u7eff\u8272\u7c92\u5b50","\u767e\u604b_\u7c92\u5b50\u7279\u6548_\u7eff\u8272"),r.particlesMap.set("\u91d1\u8272\u7c92\u5b50","\u767e\u604b_\u7c92\u5b50\u7279\u6548_\u91d1\u8272"),r.particlesMap.set("\u591a\u8272\u7c92\u5b50","\u767e\u604b_\u7c92\u5b50\u7279\u6548_\u591a\u8272"),r.particlesMap.set("\u53f3\u6269\u6563\u91d1\u8272\u7c92\u5b50","\u767e\u604b_\u7c92\u5b50\u7279\u6548_\u53f3\u6269\u6563\u91d1\u8272"),r.particlesMap.set("\u5de6\u6269\u6563\u91d1\u8272\u7c92\u5b50","\u767e\u604b_\u7c92\u5b50\u7279\u6548_\u5de6\u6269\u6563\u91d1\u8272"),r.particlesMap.set("\u56db\u5468\u6269\u6563\u91d1\u8272\u7c92\u5b50","\u767e\u604b_\u7c92\u5b50\u7279\u6548_\u56db\u5468\u6269\u6563\u91d1\u8272"),r.particlesMap.set("\u56db\u5468\u6269\u6563\u706b\u7130\u7c92\u5b50","\u767e\u604b_\u7c92\u5b50\u7279\u6548_\u56db\u5468\u6269\u6563\u706b\u7130"),r.particlesMap.set("\u53f3\u7167\u5c04\u91d1\u8272\u7c92\u5b50","\u767e\u604b_\u7c92\u5b50\u7279\u6548_\u53f3\u7167\u5c04\u91d1\u8272"),r.particlesMap.set("\u5de6\u7167\u5c04\u91d1\u8272\u7c92\u5b50","\u767e\u604b_\u7c92\u5b50\u7279\u6548_\u5de6\u7167\u5c04\u91d1\u8272");var B=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.LayerMessage=e.createUI(R.LayerMessage),e.LayerShowRewards=e.createUI(g.LayerShowRewards),e.LayerHeroGet=e.createUI(_.LayerHeroGet),e.LayerDisconnect=e.createUI(C.LayerDisconnect),e.LayerRewardDetail=e.createUI(S.LayerRewardDetail),e.LayerMainStaConsumeAnimation=e.createUI(v.LayerMainStaConsumeAnimation),e.LayerShowTip=e.createUI(M.LayerShowTip),e.LayerTipBuy=e.createUI(w.LayerTipBuy),e.LayerWaiting=e.createUI(O.LayerWaiting),e.LayerBuyGoods=e.createUI(b.LayerBuyGoods),e.toolSet=y.ToolSet.createToolSet(),e.tlCmd=[],e}return n(e,t),e.prototype.destroy=function(){this.toolSet&&y.ToolSet.destroyToolSet(this.toolSet)},e.prototype.enter=function(){return a(this,void 0,Promise,function(){var t=this;return l(this,function(){return this.toolSet.addListener(this.CtrlMgr.CtrlGameNet.getEventProxy(),"CmdGoodsRewardBroMsg",function(e){t.tlCmd.push(e)}),this.toolSet.addUpdateFrame(this.UpdateRewardView,this),[2]})})},e.prototype.exit=function(){return a(this,void 0,Promise,function(){return l(this,function(){return this.toolSet.removeAll(),[2]})})},e.prototype.UpdateRewardView=function(){var t,e,r,o,n={tlGoodsReward:[]},i={tlGoodsReward:[]};if(!(this.tlCmd.length<=0)){this.log("taa;",this.tlCmd);try{for(var a=s(this.tlCmd),l=a.next();!l.done;l=a.next()){var c=l.value;try{for(var u=(r=void 0,s(c.tlGoodsReward)),p=u.next();!p.done;p=u.next()){var f=p.value;f.tip?n.tlGoodsReward.push(f):i.tlGoodsReward.push(f)}}catch(h){r={error:h}}finally{try{p&&!p.done&&(o=u.return)&&o.call(u)}finally{if(r)throw r.error}}}}catch(y){t={error:y}}finally{try{l&&!l.done&&(e=a.return)&&e.call(a)}finally{if(t)throw t.error}}this.ShowGetReward(n.tlGoodsReward),this.ShowGetReward(i.tlGoodsReward),this.tlCmd=[]}},e.prototype.ShowGetReward=function(t,e,r,o){var n,i,a=this;if(t&&!(t.length<=0)){var l=!0,c=t[0].tip,u=this.ModelMgr.ModelGoods.CreateTlGoods(t,function(t){return t.GetGoodsType()!=d.EGoodsType.huobiziyuan&&(l=!1),!0});if(u.length>0){if(l&&!o){try{for(var p=s(u),h=p.next();!h.done;h=p.next()){var y=h.value;this.CtrlMgr.CtrlAnimation.OpenLayerAnimationByGoods(r,y)}}catch(m){n={error:m}}finally{try{h&&!h.done&&(i=p.return)&&i.call(p)}finally{if(n)throw n.error}}return}if(c)return void this.ShowRewardsTips(u);if(e){if(this.CtrlMgr.CtrlGuide.GetGuideIsRunning())return;f.PopLayerMgr.inst().AddLayer(this,this.LayerShowRewards,function(){a.LayerShowRewards.SetTlGoods(u),a.LayerShowRewards.load()})}else this.LayerShowRewards.SetTlGoods(u),this.LayerShowRewards.load()}}},e.prototype.ShowRewardsTips=function(t){var e,r,o="",n=0;try{for(var i=s(t),a=i.next();!a.done;a=i.next()){var l=a.value;o+=h.StringUtil.format("{0}*{1}",l.GetName(),l.GetNumber()),n<t.length-1&&(o+="; "),n++}}catch(c){e={error:c}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}this.ShowTips(h.StringUtil.format(u.FW.G_W("\u83b7\u5f97\u5956\u52b1:{0}"),o))},e.prototype.ShowTips=function(t){this.LayerMessage.addMessage(t)},e.__cname="CtrlAlert",i([p.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([p.injectField("CtrlMgr")],e.prototype,"CtrlMgr",void 0),e}(m.CtrlBehavior);r.CtrlAlert=B,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/container/Container":void 0,"../../../../framework/layer/PopLayerMgr":void 0,"../../../../framework/utils/StringUtil":void 0,"../../../../framework/utils/Toolset":void 0,"../../model/vo/Goods/Goods":"Goods","../CtrlBehavior":"CtrlBehavior","../main/Xiulian/LayerMainStaConsumeAnimation":"LayerMainStaConsumeAnimation","./Layer/LayerHeroGet":"LayerHeroGet","./Layer/LayerRewardDetail":"LayerRewardDetail","./Layer/LayerShowRewards":"LayerShowRewards","./LayerBuyGoods":"LayerBuyGoods","./LayerDisconnect":"LayerDisconnect","./LayerMessage":"LayerMessage","./LayerShowTip":"LayerShowTip","./LayerTipBuy":"LayerTipBuy","./LayerWaiting":"LayerWaiting"}],CtrlAnimation:[function(t,e,r){"use strict";cc._RF.push(e,"328baCkXItIhr7iuQjhOvU4","CtrlAnimation");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.CtrlAnimation=r.AnimationEnum=void 0;var i,a=t("../../../../framework/event/EventCallback"),l=t("../../model/vo/Goods/Goods"),s=t("../CtrlBehavior");(function(t){t[t.FlyResource=0]="FlyResource"})(i=r.AnimationEnum||(r.AnimationEnum={}));var c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.playResourceAnimation=new a.EventCallback,e.onChangeResourceCallBack=new a.EventCallback,e}return n(e,t),e.prototype.OpenLayerAnimationByGoods=function(t,e){if(e.GetGoodsType()==l.EGoodsType.huobiziyuan||e.GetGoodsType()==l.EGoodsType.normal){var r=i.FlyResource;this.playResourceAnimation.execute(r,t,e),this.onChangeResourceCallBack.execute(e.GetRefId())}},e.__cname="CtrlAnimation",e}(s.CtrlBehavior);r.CtrlAnimation=c,cc._RF.pop()},{"../../../../framework/event/EventCallback":void 0,"../../model/vo/Goods/Goods":"Goods","../CtrlBehavior":"CtrlBehavior"}],CtrlAttr:[function(t,e,r){"use strict";cc._RF.push(e,"95187GL3KpHEooT/8atdD1E","CtrlAttr");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},c=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.CtrlAttr=void 0;var u=t("../../../../framework/FW"),p=t("../../../../framework/container/Container"),f=t("../../../../framework/event/EventCallback"),h=t("../../../../framework/utils/Toolset"),y=t("../../gamestate/state/GameStateRunning"),d=t("../CtrlBehavior"),m=t("./AttrWrap"),v=t("./SubAttrBreach"),_=t("./SubAttrBuff"),S=t("./SubAttrEquip"),g=t("./SubAttrHero"),b=t("./SubAttrRune"),C=function(t){function e(){var e=t.call(this)||this;return e.tmSub=new Map,e._dirty=!1,e.tmAttr=new Map,e.changeCallback=new f.EventCallback,e.toolSet=h.ToolSet.createToolSet(),e}return n(e,t),e.prototype.onDestroy=function(){var t,e;try{for(var r=s(this.tmSub),o=r.next();!o.done;o=r.next()){var n=c(o.value,2);n[0],n[1].destroy()}}catch(i){t={error:i}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}this.tmSub.clear(),h.ToolSet.destroyToolSet(this.toolSet)},e.prototype.enter=function(){return a(this,void 0,Promise,function(){var t,e,r,o,n,i,a,u,f,h,y;return l(this,function(){this.CreateSub(S.SubAttrEquip),this.CreateSub(b.SubAttrRune),this.CreateSub(g.SubAttrHero),this.CreateSub(v.SubAttrBreach),this.CreateSub(_.SubAttrBuff),this.InitAttr();try{for(t=s(this.tmSub),e=t.next();!e.done;e=t.next())(r=c(e.value,2))[0],a=r[1],p.Container.inst().inject(a)}catch(l){u={error:l}}finally{try{e&&!e.done&&(f=t.return)&&f.call(t)}finally{if(u)throw u.error}}try{for(o=s(this.tmSub),n=o.next();!n.done;n=o.next())(i=c(n.value,2))[0],(a=i[1]).Enter()}catch(d){h={error:d}}finally{try{n&&!n.done&&(y=o.return)&&y.call(o)}finally{if(h)throw h.error}}return this.toolSet.addUpdateFrame(this.Update,this),[2]})})},e.prototype.exit=function(){return a(this,void 0,Promise,function(){var t,e,r,o,n;return l(this,function(){try{for(t=s(this.tmSub),e=t.next();!e.done;e=t.next())(r=c(e.value,2))[0],r[1].Exit()}catch(i){o={error:i}}finally{try{e&&!e.done&&(n=t.return)&&n.call(t)}finally{if(o)throw o.error}}return[2]})})},e.prototype.Update=function(t){var e,r;if(0!=y.GameStateRunning.isReady){try{for(var o=s(this.tmSub),n=o.next();!n.done;n=o.next()){var i=c(n.value,2);i[0],i[1].Update(t)}}catch(a){e={error:a}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}this._dirty&&(this._dirty=!1,this.ReCalAttr(),this.changeCallback.execute())}},e.prototype.CreateSub=function(t){var e=new t;return this.tmSub.set(t,e),e.Init(this),e},e.prototype.GetSub=function(t){return this.tmSub.get(t)},e.prototype.MarkDirty=function(){this._dirty=!0},e.prototype.InitAttr=function(){var t,e,r=this.tmAttr;r.clear();var o=this.ModelAttr.RefAttr.getRefAll();try{for(var n=s(o),i=n.next();!i.done;i=n.next()){var a=i.value.key;r.set(a,new m.AttrWrap)}}catch(l){t={error:l}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}},e.prototype.ReCalAttr=function(){var t,e,r,o,n,i,a=this.tmAttr;try{for(var l=s(a),p=l.next();!p.done;p=l.next()){var f=c(p.value,2);f[0],f[1].Clear()}}catch(C){t={error:C}}finally{try{p&&!p.done&&(e=l.return)&&e.call(l)}finally{if(t)throw t.error}}try{for(var h=s(this.tmSub),y=h.next();!y.done;y=h.next()){var d=c(y.value,2),m=(d[0],d[1]);u.FW.ZJJ.log("\u5b50\u5c5e\u6027\u503c",m.Dump());try{for(var v=(n=void 0,s(m.GetTmAttr())),_=v.next();!_.done;_=v.next()){var S=c(_.value,2),g=S[0],b=S[1];a.get(g).AddAttr(b)}}catch(R){n={error:R}}finally{try{_&&!_.done&&(i=v.return)&&i.call(v)}finally{if(n)throw n.error}}}}catch(M){r={error:M}}finally{try{y&&!y.done&&(o=h.return)&&o.call(h)}finally{if(r)throw r.error}}u.FW.ZJJ.log(this.tmAttr)},e.prototype.GetTmAttr=function(){return this.tmAttr},e.prototype.GetAttrByKey=function(t){return this.tmAttr.get(t)},e.prototype.GetAttrByTypeAndKey=function(t,e){var r,o;try{for(var n=s(this.tmSub),i=n.next();!i.done;i=n.next()){var a=c(i.value,2),l=(a[0],a[1]);if(l instanceof t&&l.GetTmAttr().has(e))return l.GetTmAttr().get(e)}}catch(p){r={error:p}}finally{try{i&&!i.done&&(o=n.return)&&o.call(n)}finally{if(r)throw r.error}}return u.FW.LWX.log("\u8bf7\u68c0\u67e5\u662f\u5426\u4e8b\u65b0\u589e\u5c5e\u6027type\u6216\u8005IRefroleAttribute_key",t.__cname,e),new m.AttrWrap},e.prototype.GetChangeCallback=function(){return this.changeCallback},e.__cname="CtrlAttr",i([p.injectField("ModelAttr")],e.prototype,"ModelAttr",void 0),e}(d.CtrlBehavior);r.CtrlAttr=C,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/container/Container":void 0,"../../../../framework/event/EventCallback":void 0,"../../../../framework/utils/Toolset":void 0,"../../gamestate/state/GameStateRunning":"GameStateRunning","../CtrlBehavior":"CtrlBehavior","./AttrWrap":"AttrWrap","./SubAttrBreach":"SubAttrBreach","./SubAttrBuff":"SubAttrBuff","./SubAttrEquip":"SubAttrEquip","./SubAttrHero":"SubAttrHero","./SubAttrRune":"SubAttrRune"}],CtrlAudio:[function(t,e,r){"use strict";cc._RF.push(e,"ab602Z0LfhKPpcxOPFcwDRs","CtrlAudio");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},c=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.CtrlAudio=void 0;var u=t("../../../../framework/asset/AssetMgr"),p=t("../../../../framework/container/Container"),f=t("../../../../framework/FW"),h=t("../../../../framework/utils/PromiseWrap"),y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.prefab2Key=new Map,e.tmPrefab=new Map,e}return n(e,t),Object.defineProperty(e.prototype,"data",{get:function(){var t,e;if(null==this._data){this._data=new Map;var r=this._data,o=this.Ref.RefMgraudioConfig.getRefAll();try{for(var n=s(o),i=n.next();!i.done;i=n.next()){var a=i.value;r.set(a.key,a.value)}}catch(l){t={error:l}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}}return this._data},enumerable:!1,configurable:!0}),e.prototype.enter=function(){return a(this,void 0,Promise,function(){return l(this,function(){return[2]})})},e.prototype.exit=function(){return a(this,void 0,Promise,function(){var t,e,r,o,n;return l(this,function(){try{for(t=s(this.tmPrefab),e=t.next();!e.done;e=t.next())(r=c(e.value,2))[0],r[1].removeRef(this)}catch(i){o={error:i}}finally{try{e&&!e.done&&(n=t.return)&&n.call(t)}finally{if(o)throw o.error}}return[2]})})},e.prototype.AddAssetRef=function(t,e){var r=this,o=this.tmPrefab.get(t);if(null==o){var n=this.data.get(t);if(null==n)return void f.FW.Log.error("\u914d\u7f6e\u9519\u8bef\uff0c\u8bf7\u68c0\u67e5\u8868\u914d\u7f6e\uff1a"+t);o=u.AssetMgr.instance.getAsset(n,cc.AudioClip),this.prefab2Key.set(o,t),o.getPromise().then(function(){o.addRef(r),e(o)})}else o.addRef(this),e(o)},e.prototype.AddAssetRefAsync=function(t){var e=new h.PromiseWrap;return this.AddAssetRef(t,function(t){e.resolve(t)}),e.promise},e.prototype.RemoveAssetRef=function(t){var e=this.tmPrefab.get(t);e&&e.removeRef(this)},e.prototype.PlayMusic=function(t,e){return void 0===e&&(e=!0),a(this,void 0,void 0,function(){var r,o=this;return l(this,function(){return this.lastMusic&&this.StopMusic(),r=t,this.AddAssetRef(t,function(t){var n=o.prefab2Key.get(t);r!=n||(o.lastMusic=r,t.addRef(o),cc.audioEngine.playMusic(t.getAsset(),e))}),[2]})})},e.prototype.StopMusic=function(){this.lastMusic&&(this.RemoveAssetRef(this.lastMusic),this.lastMusic=null,cc.audioEngine.stopMusic())},e.prototype.PauseMusic=function(){this.lastMusic&&cc.audioEngine.pauseMusic()},e.prototype.ResumeMusic=function(){this.lastMusic&&cc.audioEngine.resumeMusic()},e.prototype.PlaySound=function(t,e,r){return void 0===r&&(r=!1),a(this,void 0,void 0,function(){var o,n=this;return l(this,function(i){switch(i.label){case 0:return this.AddAssetRef(t,function(t){t.addRef(n),o=cc.audioEngine.playEffect(t.getAsset(),r),e&&cc.audioEngine.setFinishCallback(o,e)}),[4,f.FW.Task.waitUntil(function(){return null!=o})];case 1:return i.sent(),[2,o]}})})},e.prototype.Stop=function(t){cc.audioEngine.stop(t)},e.prototype.GetState=function(t){return cc.audioEngine.getState(t)},e.prototype.SetMusicVolume=function(t){cc.audioEngine.setMusicVolume(t)},e.prototype.GetMusicVolume=function(){return cc.audioEngine.getMusicVolume()},e.prototype.SetSoundVolume=function(t){cc.audioEngine.setEffectsVolume(t)},e.prototype.GetSoundVolume=function(){return cc.audioEngine.getEffectsVolume()},e.__cname="CtrlAudio",i([p.injectField("Ref")],e.prototype,"Ref",void 0),e}(t("../CtrlBehavior").CtrlBehavior);r.CtrlAudio=y,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/asset/AssetMgr":void 0,"../../../../framework/container/Container":void 0,"../../../../framework/utils/PromiseWrap":void 0,"../CtrlBehavior":"CtrlBehavior"}],CtrlBattleView:[function(t,e,r){"use strict";cc._RF.push(e,"b40cb65/9VBH5DfgmwQg/SO","CtrlBattleView");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},l=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},s=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.CtrlBattleView=void 0;var c=t("../../../../../framework/layer/common/UIProxyMgr"),u=t("../../CtrlBehavior"),p=t("../debug/LayerBatterCommand"),f=t("./common/LayerBatterCamerEffect"),h=t("./common/LayerBattleChest"),y=t("./common/LayerBattleDamageText"),d=t("./common/LayerBattleExitTips"),m=t("./common/LayerBattlePause"),v=t("./common/LayerDamageStastic"),_=t("./common/LayerFightGuide"),S=t("./common/LayerJoystick"),g=t("./common/LayerReborn"),b=t("./common/LayerRolePanel"),C=t("./common/LayerSelectUpgrade"),R=t("./common/LayerSettle"),M=t("./common/LayerSkillReplace"),w=t("./common/LayerSkillReplaceTips"),O=t("./common/LayerTopMenu"),B=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.LayerJoystick=e.createUI(S.LayerJoystick),e.LayerTopMenu=e.createUI(O.LayerTopMenu),e.LayerBattlePause=e.createUI(m.LayerBattlePause),e.LayerBattleExitTips=e.createUI(d.LayerBattleExitTips),e.LayerRolePanel=e.createUI(b.LayerRolePanel),e.LayerSelectUpgrade=e.createUI(C.LayerSelectUpgrade),e.LayerSettle=e.createUI(R.LayerSettle),e.LayerReborn=e.createUI(g.LayerReborn),e.LayerBattleChest=e.createUI(h.LayerBattleChest),e.LayerBatterCamerEffect=e.createUI(f.LayerBatterCamerEffect),e.LayerBattleDamageText=e.createUI(y.LayerBattleDamageText),e.LayerBatterCommand=e.createUI(p.LayerBatterCommand),e.LayerDamageStastic=e.createUI(v.LayerDamageStastic),e.LayerSkillReplace=e.createUI(M.LayerSkillReplace),e.LayerSkillReplaceTips=e.createUI(w.LayerSkillReplaceTips),e.LayerFightGuide=e.createUI(_.LayerFightGuide),e}return n(e,t),e.prototype.SetContainer=function(t){this._container=t,this.collectUI()},e.prototype.GetContainer=function(){return this._container},e.prototype.createUI=function(t){var e=c.UIProxyMgr.instance.getUIProxy(t);return null!=e?(this.error("\u65e0\u6cd5\u91cd\u590d\u6dfb\u52a0UI"),e):(e=c.UIProxyMgr.instance.addUIProxy(t),this.tmUI.set(t,e),e)},e.prototype.collectUI=function(){var t,e,r=this._container;try{for(var o=l(this.tmUI),n=o.next();!n.done;n=o.next()){var i=s(n.value,2),a=(i[0],i[1]);r.collectObj(a),a.setDependContainer(r)}}catch(c){t={error:c}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}},e.prototype.EnterBattle=function(){return i(this,void 0,Promise,function(){return a(this,function(t){switch(t.label){case 0:return[4,this.LayerBatterCamerEffect.preloadRes()];case 1:return t.sent(),[2]}})})},e.prototype.ExitBattle=function(){return i(this,void 0,Promise,function(){return a(this,function(t){switch(t.label){case 0:return[4,this.LayerBatterCamerEffect.unloadRes()];case 1:return t.sent(),[2]}})})},e.__cname="CtrlBattleView",e}(u.CtrlBehavior);r.CtrlBattleView=B,cc._RF.pop()},{"../../../../../framework/layer/common/UIProxyMgr":void 0,"../../CtrlBehavior":"CtrlBehavior","../debug/LayerBatterCommand":"LayerBatterCommand","./common/LayerBatterCamerEffect":"LayerBatterCamerEffect","./common/LayerBattleChest":"LayerBattleChest","./common/LayerBattleDamageText":"LayerBattleDamageText","./common/LayerBattleExitTips":"LayerBattleExitTips","./common/LayerBattlePause":"LayerBattlePause","./common/LayerDamageStastic":"LayerDamageStastic","./common/LayerFightGuide":"LayerFightGuide","./common/LayerJoystick":"LayerJoystick","./common/LayerReborn":"LayerReborn","./common/LayerRolePanel":"LayerRolePanel","./common/LayerSelectUpgrade":"LayerSelectUpgrade","./common/LayerSettle":"LayerSettle","./common/LayerSkillReplace":"LayerSkillReplace","./common/LayerSkillReplaceTips":"LayerSkillReplaceTips","./common/LayerTopMenu":"LayerTopMenu"}],CtrlBattle:[function(t,e,r){"use strict";cc._RF.push(e,"d51dfnsqjdOZ5NMtYfKpwu/","CtrlBattle");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.CtrlBattle=r.EBattleType=void 0;var s,c=t("../../../../framework/FW"),u=t("../../../../framework/container/Container"),p=t("../../../../framework/utils/PromiseWrap"),f=t("../../../../framework/utils/Toolset"),h=t("../CtrlBehavior"),y=t("../login/LayerLoginLoading"),d=t("./Battle"),m=t("./LayerBattle"),v=t("./LayerBattleDebug"),_=t("./config/BattleConfigChapter"),S=t("./config/BattleConfigDaily"),g=t("./config/BattleConfigField"),b=t("./config/BattleConfigGold"),C=t("./config/BattleConfigGuide"),R=t("./logic/event/SystemEvent");(function(t){t[t.Chapter=1]="Chapter",t[t.Gold=2]="Gold",t[t.Daily=3]="Daily",t[t.Guide=99]="Guide",t[t.Field=100]="Field"})(s=r.EBattleType||(r.EBattleType={}));var M=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.LayerBattle=e.createUI(m.LayerBattle),e.LayerBattleDebug=e.createUI(v.LayerBattleDebug),e.toolSet=f.ToolSet.createToolSet(),e.skillReplaceTips=!1,e.tmSub=new Map,e}return n(e,t),e.prototype.onDestroy=function(){f.ToolSet.destroyToolSet(this.toolSet)},e.prototype.enter=function(){return a(this,void 0,Promise,function(){return l(this,function(){return this.CreateSub(s.Chapter,_.BattleConfigChapter),this.CreateSub(s.Gold,b.BattleConfigGold),this.CreateSub(s.Daily,S.BattleConfigDaily),this.CreateSub(s.Guide,C.BattleConfigGuide),this.CreateSub(s.Field,g.BattleConfigField),[2,null]})})},e.prototype.TryExitBattle=function(){return a(this,void 0,void 0,function(){var t=this;return l(this,function(){return[2,new p.PromiseWrap(function(e){return a(t,void 0,void 0,function(){var t=this;return l(this,function(r){switch(r.label){case 0:return this.battlePromise&&(this.battlePromise.resolve(),this.battlePromise=null),[4,this.CtrlBattleView.ExitBattle()];case 1:return r.sent(),this.CtrlMain.LayerMain.load(),[4,c.FW.Task.waitUntil(function(){return null==t.battle})];case 2:return r.sent(),[4,c.FW.Task.delay(500)];case 3:return r.sent(),e(),[2]}})})}).promise]})})},e.prototype.CreateSub=function(t,e){var r=new e;return u.Container.inst().inject(r),this.tmSub.set(t,r),r},e.prototype.GetSub=function(t){return this.tmSub.get(t)},e.prototype.StartByConfig=function(t){return a(this,void 0,void 0,function(){var e,r=this;return l(this,function(){return this.CtrlLogin.LayerLoginLoading.SetTitle(c.FW.G_W("\u6253\u626b\u6218\u573a\u4e2d....")),this.CtrlLogin.LayerLoginLoading.SetType(y.LoadingType.Fight),this.CtrlLogin.LayerLoginLoading.ResetProgress(),this.CtrlLogin.LayerLoginLoading.SetProgress(100),this.CtrlLogin.LayerLoginLoading.setVisible(!0),e=function(){r.CtrlLogin.LayerLoginLoading.setVisible(!1)},this.LayerBattle.Start(t).then(function(){e()}).catch(function(t){e(),t&&c.FW.ZJJ.error(t)}),[2]})})},e.prototype.StartByNet=function(t,e){return void 0===e&&(e=!1),c.FW.ZJJ.log("\u5c1d\u8bd5\u8fd8\u539f\u6218\u6597",t),this.battlePromise&&this.battlePromise.reject(),this.battlePromise=new p.PromiseWrap,e?(this._isBossNode=!0,this.StartByCache(t)):t&&t.cmdBattleBeat&&t.cmdBattleBeat.roles.length>0?this.StartByCache(t):this.Start(t).then(),this.battlePromise},e.prototype.StartByCache=function(t,e){var r;return void 0===e&&(e=!1),a(this,void 0,void 0,function(){var o,n;return l(this,function(){return(o=this.GetSub(t.type)).Setup(t),n=o.GetConfig(),this.ModelMgr.ModelBattleDrop.battleDrop=null===(r=t.cmdBattleBeat)||void 0===r?void 0:r.items,n.resumeData=t,e&&(n.enterSelector=!1,n.skillReplace=!0),this.StartByConfig(n),[2]})})},e.prototype.Start=function(t){var e;return a(this,void 0,void 0,function(){var r,o;return l(this,function(n){switch(n.label){case 0:return(r=this.GetSub(t.type)).Setup(t),o=r.GetConfig(),this.ModelMgr.ModelBattleDrop.battleDrop=null===(e=t.cmdBattleBeat)||void 0===e?void 0:e.items,this.OnOffMgr.OnOffBattleParams.GetValue()?[4,this.ShowBattlePrams(o)]:[3,2];case 1:o=n.sent(),n.label=2;case 2:return this.StartByConfig(o),[2]}})})},e.prototype.ShowBattlePrams=function(t){return a(this,void 0,void 0,function(){var e,r=this;return l(this,function(){return e=new p.PromiseWrap,this.LayerBattleDebug.load(),this.LayerBattleDebug.SetConfig(t),this.LayerBattleDebug.setCloseCallBack(function(){var t=r.LayerBattleDebug.GetConfig();r.LayerBattleDebug.SetConfig(null),e.resolve(t)}),[2,e.promise]})})},e.prototype.StartGuideBattle=function(t){return void 0===t&&(t=!0),a(this,void 0,Promise,function(){var t,e;return l(this,function(r){switch(r.label){case 0:return(t=this.GetSub(s.Guide)).Setup(null),e=t.GetConfig(),this.OnOffMgr.OnOffBattleParams.GetValue()?[4,this.ShowBattlePrams(e)]:[3,2];case 1:e=r.sent(),r.label=2;case 2:return this.StartByConfig(e),this.battlePromise&&this.battlePromise.reject(),this.battlePromise=new p.PromiseWrap,[2,this.battlePromise]}})})},e.prototype.StartBattleField=function(t){return a(this,void 0,Promise,function(){var e;return l(this,function(r){switch(r.label){case 0:return e=t.GetConfig(),this.OnOffMgr.OnOffBattleParams.GetValue()?[4,this.ShowBattlePrams(e)]:[3,2];case 1:e=r.sent(),r.label=2;case 2:return this.StartByConfig(e),this.battlePromise&&this.battlePromise.reject(),this.battlePromise=new p.PromiseWrap,[2,this.battlePromise]}})})},e.prototype.StartBattleByFubenId=function(t,e){return a(this,void 0,void 0,function(){var r,o,n,i,a;return l(this,function(l){switch(l.label){case 0:return r=this.GetSub(t),o=this.ModelMgr.ModelRole.GetRole().GetHeroId(),n=this.ModelMgr.ModelVO.VOHeroBag.Get(o),i={type:t,resId:e,cmdBattleBeat:null,level:n&&n.GetLevel()||0},r.Setup(i),(a=r.GetConfig()).syncData=!1,this.OnOffMgr.OnOffBattleParams.GetValue()?[4,this.ShowBattlePrams(a)]:[3,2];case 1:a=l.sent(),l.label=2;case 2:return this.StartByConfig(a),[2]}})})},e.prototype.GetIsBattleRunning=function(){return null!=this.battle},e.prototype.GetRunningBattle=function(){return this.battle},e.prototype.PauseRunningBattle=function(){this.battle.getSystem(R.SystemEvent).sendPaused(this)},e.prototype.ResumeRunningBattle=function(){this.battle.getSystem(R.SystemEvent).sendResume(this)},e.prototype.CreateBattle=function(t){return this.assert(null==this.battle,"\u6218\u6597\u672a\u7ed3\u675f\uff0c\u65e0\u6cd5\u6784\u9020\u65b0\u6218\u573a"),this._isBossNode&&(t.bossNodeChest=!0,this._isBossNode=!1),this.battle=new d.Battle(t),this.battle},e.prototype.DestroyBattle=function(){this.battle&&(this.battle.destroy(),this.battle=null)},e.__cname="CtrlBattle",i([u.injectField("CtrlMain")],e.prototype,"CtrlMain",void 0),i([u.injectField("Net")],e.prototype,"Net",void 0),i([u.injectField("Ref")],e.prototype,"Ref",void 0),i([u.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([u.injectField("OnOffMgr")],e.prototype,"OnOffMgr",void 0),i([u.injectField("CtrlLogin")],e.prototype,"CtrlLogin",void 0),i([u.injectField("CtrlBattleView")],e.prototype,"CtrlBattleView",void 0),e}(h.CtrlBehavior);r.CtrlBattle=M,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/container/Container":void 0,"../../../../framework/utils/PromiseWrap":void 0,"../../../../framework/utils/Toolset":void 0,"../CtrlBehavior":"CtrlBehavior","../login/LayerLoginLoading":"LayerLoginLoading","./Battle":"Battle","./LayerBattle":"LayerBattle","./LayerBattleDebug":"LayerBattleDebug","./config/BattleConfigChapter":"BattleConfigChapter","./config/BattleConfigDaily":"BattleConfigDaily","./config/BattleConfigField":"BattleConfigField","./config/BattleConfigGold":"BattleConfigGold","./config/BattleConfigGuide":"BattleConfigGuide","./logic/event/SystemEvent":"SystemEvent"}],CtrlBehavior:[function(t,e,r){"use strict";cc._RF.push(e,"e8cca+3N3tInoVXuzlJkSJj","CtrlBehavior");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},l=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},s=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.CtrlBehavior=void 0;var c=t("../../../framework/container/Container"),u=t("../../../framework/layer/common/UIProxyMgr"),p=function(t){function e(){var e=t.call(this)||this;return e.tmUI=new Map,e}return n(e,t),e.prototype.createUI=function(t){var e=u.UIProxyMgr.instance.getUIProxy(t);return null!=e?(this.error("\u65e0\u6cd5\u91cd\u590d\u6dfb\u52a0UI"),e):(e=u.UIProxyMgr.instance.addUIProxy(t),c.Container.inst().collectObj(e),e.setDependContainer(c.Container.inst()),this.tmUI.set(t,e),e)},e.prototype.exitWrap=function(){return i(this,void 0,void 0,function(){var e,r,o,n,i,c;return a(this,function(a){switch(a.label){case 0:e=this.tmUI;try{for(r=l(e),o=r.next();!o.done;o=r.next())(n=s(o.value,2))[0],n[1].unload()}catch(u){i={error:u}}finally{try{o&&!o.done&&(c=r.return)&&c.call(r)}finally{if(i)throw i.error}}return[4,t.prototype.exitWrap.call(this)];case 1:return a.sent(),[2]}})})},e.__cname="CtrlBehavior",e}(t("../GameBehavior").GameBehavior);r.CtrlBehavior=p,cc._RF.pop()},{"../../../framework/container/Container":void 0,"../../../framework/layer/common/UIProxyMgr":void 0,"../GameBehavior":"GameBehavior"}],CtrlBuff:[function(t,e,r){"use strict";cc._RF.push(e,"59bf9M93u1NCJGVAfvRMNW9","CtrlBuff");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},l=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.CtrlBuff=void 0;var s=t("../../../../framework/container/Container"),c=t("../CtrlBehavior"),u=t("./base/BuffProxy"),p=t("./sysbuff/SysBuffBehaviorMgr"),f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isEnter=!1,e.tmBuffProxy=new Map,e.tlSkillGroupId=new Set,e.tlEnter=new Set,e}return n(e,t),e.prototype.enter=function(){return i(this,void 0,Promise,function(){var t;return a(this,function(){return t=s.Container.inst(),this.BuffBehaviorMgr=p.SysBuffBehaviorMgr.Create(t),this.BuffProxyMgr=u.BuffProxyMgr.Create(t,this.BuffBehaviorMgr),t.inject(this.BuffProxyMgr),[2]})})},e.prototype.exit=function(){return i(this,void 0,Promise,function(){return a(this,function(){return this.BuffProxyMgr.destroy(),[2]})})},e.prototype.afterEnterGame=function(){return i(this,void 0,Promise,function(){return a(this,function(){return this.BuffBehaviorMgr.Start(),this.OnEnterUpdateSkill(),[2]})})},e.prototype.OnEnterUpdateSkill=function(){var t,e;this.isEnter=!0;try{for(var r=l(this.tlEnter),o=r.next();!o.done;o=r.next()){var n=o.value;this.AddSkillGroupId(n)}}catch(i){t={error:i}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}this.tlEnter.clear()},e.prototype.AddSkillGroupId=function(t){0==this.isEnter?this.tlEnter.add(t):this.AddSkillGroupIdInner(t)},e.prototype.AddSkillGroupIdInner=function(t){this.RemoveSkillGroupId(t);var e=this.BuffProxyMgr.CreateProxy();this.tmBuffProxy.set(t,e),this.tlSkillGroupId.add(t),e.SetSkillGroupId(t),e.Apply()},e.prototype.RemoveSkillGroupId=function(t){0==this.isEnter?this.tlEnter.delete(t):this.RemoveSkillGroupIdInner(t)},e.prototype.RemoveSkillGroupIdInner=function(t){var e=this.tmBuffProxy;if(e.has(t)){var r=e.get(t);this.BuffProxyMgr.DestroyProxy(r),e.delete(t),this.tlSkillGroupId.delete(t)}},e.prototype.GetTlAllSkillGroupId=function(){return this.tlSkillGroupId},e.__cname="CtrlBuff",e}(c.CtrlBehavior);r.CtrlBuff=f,cc._RF.pop()},{"../../../../framework/container/Container":void 0,"../CtrlBehavior":"CtrlBehavior","./base/BuffProxy":"BuffProxy","./sysbuff/SysBuffBehaviorMgr":"SysBuffBehaviorMgr"}],CtrlClickOnEffect:[function(t,e,r){"use strict";cc._RF.push(e,"52863FiOYdLvLtdTJvBhNci","CtrlClickOnEffect");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.CtrlClickOnEffect=void 0;var i=t("../CtrlBehavior"),a=t("./LayerClickOnEffect"),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.LayerClickOnEffect=e.createUI(a.LayerClickOnEffect),e}return n(e,t),e.prototype.InitListen=function(){var t=this;fgui.GRoot.inst.on(fairygui.Event.TOUCH_BEGIN,function(e){var r=e.pos;t.LayerClickOnEffect.setVisible(!0),t.LayerClickOnEffect.SetPostition(r),t.LayerClickOnEffect.ui.SetEffectPos()},this)},e.prototype.OnEnter=function(){0==this.LayerClickOnEffect.isLoad&&this.LayerClickOnEffect.load(),this.LayerClickOnEffect.setVisible(!1),this.InitListen()},e.prototype.OnExit=function(){},e.__cname="CtrlClickOnEffect",e}(i.CtrlBehavior);r.CtrlClickOnEffect=l,cc._RF.pop()},{"../CtrlBehavior":"CtrlBehavior","./LayerClickOnEffect":"LayerClickOnEffect"}],CtrlFriends:[function(t,e,r){"use strict";cc._RF.push(e,"2ac0feNMtVKy4/cDgqpjHE6","CtrlFriends");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.CtrlFriends=void 0;var i=t("../../../CtrlBehavior"),a=t("./LayerAddFriend"),l=t("./LayerContacts"),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._LayerContacts=e.createUI(l.LayerContacts),e._LayerAddFriend=e.createUI(a.LayerAddFriend),e}return n(e,t),e.__cname="CtrlFriends",e}(i.CtrlBehavior);r.CtrlFriends=s,cc._RF.pop()},{"../../../CtrlBehavior":"CtrlBehavior","./LayerAddFriend":"LayerAddFriend","./LayerContacts":"LayerContacts"}],CtrlGM:[function(t,e,r){"use strict";cc._RF.push(e,"56e46EtvjxOb4mCf76N8cRG","CtrlGM");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.CtrlGM=void 0;var s=t("../../../../framework/container/Container"),c=t("../../../../framework/utils/Toolset"),u=t("../../../example/TestGloader"),p=t("../../../example/TestGobjGoods"),f=t("../../../example/TestPopupPanel"),h=t("../CtrlBehavior"),y=t("./LayerGMEntrance"),d=t("./LayerGMMain"),m=function(t){function e(){var e=t.call(this)||this;return e.LayerGMEntrance=e.createUI(y.LayerGMEntrance),e.LayerGMMain=e.createUI(d.LayerGMMain),e.LayerTestGloader=e.createUI(u.LayerTestGloader),e.LayerTestGobjGoods=e.createUI(p.LayerTestGobjGoods),e.LayerTestPopupPanel=e.createUI(f.LayerTestPopupPanel),e.toolSet=c.ToolSet.createToolSet(),e}return n(e,t),e.prototype.onDestroy=function(){this.toolSet.destroy()},e.prototype.enter=function(){return a(this,void 0,Promise,function(){return l(this,function(){return this.InitListener(),[2]})})},e.prototype.exit=function(){return a(this,void 0,Promise,function(){return l(this,function(){return[2]})})},e.prototype.InitListener=function(){var t=this;if(0!=this.modelPublicData.getIsGM()){var e=function(e){e.keyCode==cc.macro.KEY.space&&t.LayerGMMain.load()};cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,e,this),this.toolSet.addDefer(function(){cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN,e,t)})}},e.prototype.tryShowGM=function(){this.modelPublicData.getIsGM()&&this.LayerGMEntrance.load()},e.prototype.hideGM=function(){this.LayerGMEntrance.unload()},e.__cname="CtrlGM",i([s.injectField("ModelPublicData")],e.prototype,"modelPublicData",void 0),i([s.injectField("CtrlBattle")],e.prototype,"CtrlBattle",void 0),e}(h.CtrlBehavior);r.CtrlGM=m,cc._RF.pop()},{"../../../../framework/container/Container":void 0,"../../../../framework/utils/Toolset":void 0,"../../../example/TestGloader":"TestGloader","../../../example/TestGobjGoods":"TestGobjGoods","../../../example/TestPopupPanel":"TestPopupPanel","../CtrlBehavior":"CtrlBehavior","./LayerGMEntrance":"LayerGMEntrance","./LayerGMMain":"LayerGMMain"}],CtrlGameLogin:[function(t,e,r){"use strict";cc._RF.push(e,"ec515Wer3FH67/QpBXoqqU8","CtrlGameLogin");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.CtrlGameLogin=void 0;var s=t("../../../../framework/FW"),c=t("../../../../framework/container/Container"),u=t("../../../generated/requestMsg/RequestRoleMsg"),p=t("../../model/public/AppCustomData"),f=t("../CtrlBehavior"),h=t("../login/CtrlLogin"),y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._firstLogin=0,e}return n(e,t),e.prototype.playerLogin=function(t,e){return a(this,void 0,void 0,function(){var r,o,n,i,a,c;return l(this,function(){return r=this.ModelMgr.ModelAccount.getUserInfo(),o=this.ModelMgr.ModelAccount.getRoleInfo(),n={imei:"",mac:"",idfa:"",mobileBrand:"",mobileModel:"",versionName:"",versionCode:"",systemName:"",systemVersion:"",networkType:"",bigChannel:"",smallChannel:"",smallChannelPack:"",appType:"",appId:""},i=t||r.code,a={cmdClientInfo:n,platform:p.AppCustomData.instance.channelCode,code:i,roleId:o.roleId,time:o.time,token:o.token,reconnect:!!e},s.FW.Log.log("==============playerLogin=============="),s.FW.Log.log("platform:",a.platform),s.FW.Log.log("code:",a.code),s.FW.Log.log("code.type:",typeof a.code),s.FW.Log.log("roleId:",a.roleId),s.FW.Log.log("time:",a.time),s.FW.Log.log("token:",a.token),s.FW.Log.log("reconnect:",a.reconnect),[2,(c=this).Net.send(new u.RequestRoleLogin(a,c,function(t){c._firstLogin=t.status}))]})})},e.prototype.playerRegist=function(t,e,r,o){return void 0===t&&(t=""),void 0===o&&(o=!1),a(this,void 0,void 0,function(){var t,e,r,o,n;return l(this,function(){return t=this.ModelMgr.ModelAccount.getUserInfo(),e=this.ModelMgr.ModelAccount.getRoleInfo(),r={cmdClientInfo:{imei:"",mac:"",idfa:"",mobileBrand:"",mobileModel:"",versionName:"",versionCode:"",systemName:"",systemVersion:"",networkType:"",bigChannel:"",smallChannel:"",smallChannelPack:"",appType:"",appId:""},platform:h.platformType.default,code:t.code,token:e.token,roleId:e.roleId,time:e.time,sex:1,name:"",avatar:""},o=this,n={},this.Net.send(new u.RequestRoleRegister(r,o,function(t){n.rsp=t,o._firstLogin=t.status},function(t){n.errMsg=t||"error"})),[2,n]})})},Object.defineProperty(e.prototype,"firstLogin",{get:function(){return this._firstLogin},enumerable:!1,configurable:!0}),e.__cname="CtrlGameLogin",i([c.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([c.injectField("Net")],e.prototype,"Net",void 0),e}(f.CtrlBehavior);r.CtrlGameLogin=y,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/container/Container":void 0,"../../../generated/requestMsg/RequestRoleMsg":"RequestRoleMsg","../../model/public/AppCustomData":"AppCustomData","../CtrlBehavior":"CtrlBehavior","../login/CtrlLogin":"CtrlLogin"}],CtrlGameNet:[function(t,e,r){"use strict";cc._RF.push(e,"09279Yy3WtCI7ryd3zv5PtQ","CtrlGameNet");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.CtrlGameNet=void 0;var s,c=t("../../../../framework/container/Container"),u=t("../../../../framework/utils/PromiseWrap"),p=t("../../../../framework/utils/Toolset"),f=t("../CtrlBehavior");(function(t){t[t.offline=1]="offline",t[t.kitoff=2]="kitoff"})(s||(s={}));var h=new Map;h.set(s.offline,"msg_CmdRoleOfflineBroMsg_type_1"),h.set(s.kitoff,"msg_CmdRoleOfflineBroMsg_type_2");var y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isLogin=!1,e.isOffline=!1,e}return n(e,t),e.prototype.setLogin=function(t){this.isLogin=t},e.prototype.getLogin=function(){return this.isLogin},e.prototype.enter=function(){return a(this,void 0,Promise,function(){return l(this,function(){return this.toolSet=p.ToolSet.createToolSet(),this.InitListenOffline(),[2,null]})})},e.prototype.exit=function(){return p.ToolSet.destroyToolSet(this.toolSet),this.toolSet=null,null},e.prototype.getEventProxy=function(){return this.Net.getEventProxy()},e.prototype.send=function(t,e){return void 0===e&&(e=!0),!this.isLogin||this.isOffline||this._OnRoleOffline?(t.fErrorCallback&&t.fErrorCallback("\u8fd8\u6ca1\u6709\u767b\u5f55\uff0cSocket\u65e0\u6cd5\u4ea4\u4e92"),new Promise(function(t){t(!1)})):this.Net.send(t,e)},e.prototype.InitListenOffline=function(){var t=this;this.isOffline=!1;var e=this.Net.getEventProxy();this.toolSet.addListener(e,"CmdRoleOfflineBroMsg",function(e){t.OnRoleOffline(e)},this)},e.prototype.OnRoleOffline=function(t){var e=this;if(!this._OnRoleOffline){var r=this.OnRoleOfflineInner(t);r.then(function(){e._OnRoleOffline=null}),this._OnRoleOffline=r}},e.prototype.OnRoleOfflineInner=function(t){return a(this,void 0,void 0,function(){var e,r,o,n;return l(this,function(){return e=new u.PromiseWrap,this.isOffline=!0,r=t.type,(o=h.get(r))&&(n=this.ModelML.GetTranslate(o),this.LayerDisconnect.SetMsg(n)),this.LayerDisconnect.load(),this.LayerDisconnect.setCloseCallBack(function(){e.resolve()}),[2,e.promise]})})},e.__cname="CtrlGameNet",i([c.injectField("Net")],e.prototype,"Net",void 0),i([c.injectField("LayerDisconnect")],e.prototype,"LayerDisconnect",void 0),i([c.injectField("ModelML")],e.prototype,"ModelML",void 0),e}(f.CtrlBehavior);r.CtrlGameNet=y,cc._RF.pop()},{"../../../../framework/container/Container":void 0,"../../../../framework/utils/PromiseWrap":void 0,"../../../../framework/utils/Toolset":void 0,"../CtrlBehavior":"CtrlBehavior"}],CtrlGoods:[function(t,e,r){"use strict";cc._RF.push(e,"d0ef5N+1OJIEZzy1c9ME84D","CtrlGoods");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},l=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},s=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.CtrlGoods=void 0;var c=t("../../../../framework/pool/Pool"),u=t("../CtrlBehavior"),p=t("./behavior/EquipBehavior"),f=t("./behavior/ItemBehavior"),h=t("./behavior/RuneBehavior"),y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.poolMap=new Map,e}return n(e,t),e.prototype.enter=function(){return i(this,void 0,void 0,function(){return a(this,function(){return this.CreateGoodsBehavior_cor(f.ItemBehavior),this.CreateGoodsBehavior_cor(h.RuneBehavior),this.CreateGoodsBehavior_cor(p.EquipBehavior),[2]})})},e.prototype.exit=function(){return i(this,void 0,Promise,function(){var t,e,r,o,n;return a(this,function(){try{for(t=l(this.poolMap),e=t.next();!e.done;e=t.next())(r=s(e.value,2))[0],r[1].destroy()}catch(i){o={error:i}}finally{try{e&&!e.done&&(n=t.return)&&n.call(t)}finally{if(o)throw o.error}}return this.poolMap.clear(),[2]})})},e.prototype.CreateGoodsBehavior_cor=function(t){var e=this.poolMap.get(t);return e||(e=new c.Pool(function(){var e=new t;return e.init(),e},function(t){t.destroy()},function(t,e){t.enter(e)},function(t){return t.exit(),!0}),this.poolMap.set(t,e)),e},e.prototype.GetPool=function(t){return this.poolMap.get(t)},e.__cname="CtrlGoods",e}(u.CtrlBehavior);r.CtrlGoods=y,cc._RF.pop()},{"../../../../framework/pool/Pool":void 0,"../CtrlBehavior":"CtrlBehavior","./behavior/EquipBehavior":"EquipBehavior","./behavior/ItemBehavior":"ItemBehavior","./behavior/RuneBehavior":"RuneBehavior"}],CtrlGuide:[function(t,e,r){"use strict";cc._RF.push(e,"ac2cagWlvVMdJfGCYQ7EMCb","CtrlGuide");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.CtrlGuide=void 0;var s=t("../../../../framework/container/Container"),c=t("../../../../framework/utils/PromiseWrap"),u=t("../../../../framework/utils/Toolset"),p=t("../CtrlBehavior"),f=t("./GuideSectionMgr"),h=t("./LayerGuide"),y=function(t){function e(){var e=t.call(this)||this;return e.LayerGuide=e.createUI(h.LayerGuide),e.toolSet=u.ToolSet.createToolSet(),e.isInit=!1,e}return n(e,t),e.prototype.Start_cor=function(){return a(this,void 0,void 0,function(){var t=this;return l(this,function(){return this.isInit?[2]:(this.isInit=!0,null==this.mgr&&(this.mgr=new f.GuideSectionMgr,s.Container.inst().inject(this.mgr)),this.mgr.Enter(),this.toolSet.addUpdateFrame(function(){t.mgr.OnUpdate()},this),this.LayerGuide.load(),[2])})})},e.prototype.Stop_cor=function(){return a(this,void 0,void 0,function(){return l(this,function(){return this.isInit?(this.isInit=!1,this.mgr.Exit(),this.toolSet.removeAll(),this.LayerGuide.unload(),[2]):[2]})})},e.prototype.CheckAndStartClientTriggerSection=function(t){var e=this,r=new c.PromiseWrap(null);return this.ModelMgr.ModelGuide.CheckClientTriggerSection(t).then(function(o){o?r.resolve(e.StartClientTriggerSection(t)):r.resolve(null)}).catch(function(){r.resolve(null)}),r},e.prototype.StartClientTriggerSection=function(t){var e=this,r=this.mgr.StartClientTriggerSection(t);return r.then(function(){e.ModelMgr.ModelGuide.RequestGuideRecord(t)}),r},e.prototype.GetGuideIsRunning=function(){return null!=this.mgr&&this.mgr.GetIsRuning()},e.prototype.GetMgr=function(){return this.mgr},e.prototype.GetIsShowClickEnable=function(){return!1},e.__cname="CtrlGuide",i([s.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(p.CtrlBehavior);r.CtrlGuide=y,cc._RF.pop()},{"../../../../framework/container/Container":void 0,"../../../../framework/utils/PromiseWrap":void 0,"../../../../framework/utils/Toolset":void 0,"../CtrlBehavior":"CtrlBehavior","./GuideSectionMgr":"GuideSectionMgr","./LayerGuide":"LayerGuide"}],CtrlJoint:[function(t,e,r){"use strict";cc._RF.push(e,"23d86PKLVtAKrr8Oi0ImlQh","CtrlJoint");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.CtrlJoint=void 0;var l=t("../../../../engine/EngineMain"),s=t("../../../../framework/container/Container"),c=t("../../model/public/AppCustomData"),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.enter=function(){return i(this,void 0,Promise,function(){return a(this,function(){return[2]})})},e.prototype.InitData=function(){var t=c.AppCustomData.instance,e=s.Container.inst().getByAlias("CtrlPay");if(!l.EngineMain.isIOS)return l.EngineMain.isAndroid?(t.audit,e.setCantPay(!1),void e.setPayVisible(!1)):void 0;t.audit?(e.setCantPay(!0),e.setPayVisible(!0)):(e.setCantPay(!1),e.setPayVisible(!1))},e.__cname="CtrlJoint",e}(t("../CtrlBehavior").CtrlBehavior);r.CtrlJoint=u,cc._RF.pop()},{"../../../../engine/EngineMain":void 0,"../../../../framework/container/Container":void 0,"../../model/public/AppCustomData":"AppCustomData","../CtrlBehavior":"CtrlBehavior"}],CtrlLogin:[function(t,e,r){"use strict";cc._RF.push(e,"71a728b48tL4L9R8Bvj9kvb","CtrlLogin");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.CtrlLogin=r.platformType=void 0;var i=t("../CtrlBehavior"),a=t("./LayerAccount"),l=t("./LayerAgeTip"),s=t("./LayerLogin"),c=t("./LayerLoginLoading");(function(t){t[t.default=0]="default",t[t.weixi=3]="weixi"})(r.platformType||(r.platformType={}));var u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.LayerAccount=e.createUI(a.LayerAccount),e.layerLogin=e.createUI(s.LayerLogin),e.LayerAgeTip=e.createUI(l.LayerAgeTip),e.LayerLoginLoading=e.createUI(c.LayerLoginLoading),e}return n(e,t),e.__cname="CtrlLogin",e}(i.CtrlBehavior);r.CtrlLogin=u,cc._RF.pop()},{"../CtrlBehavior":"CtrlBehavior","./LayerAccount":"LayerAccount","./LayerAgeTip":"LayerAgeTip","./LayerLogin":"LayerLogin","./LayerLoginLoading":"LayerLoginLoading"}],CtrlLuckyCat:[function(t,e,r){"use strict";cc._RF.push(e,"52c4cNQJptMDrKRQOxcF144","CtrlLuckyCat");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.CtrlLuckyCat=void 0;var i=t("../CtrlBehavior"),a=t("./LayerLuckyCat"),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._LayerLuckyCat=e.createUI(a.LayerLuckyCat),e}return n(e,t),e.__cname="CtrlLuckyCat",e}(i.CtrlBehavior);r.CtrlLuckyCat=l,cc._RF.pop()},{"../CtrlBehavior":"CtrlBehavior","./LayerLuckyCat":"LayerLuckyCat"}],CtrlMain:[function(t,e,r){"use strict";cc._RF.push(e,"cb73do1hHBNcoiNzLjGz6yn","CtrlMain");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.CtrlMain=void 0;var s=t("../../../../framework/FW"),c=t("../../../../framework/container/Container"),u=t("../../../../framework/event/FWEventCenter"),p=t("../../../../framework/utils/Toolset"),f=t("../CtrlBehavior"),h=t("../DayWeekMonthGift/LayerDayWeekMonthGift"),y=t("../EveryDaySignIn/LayerEveryDaySignIn"),d=t("../animation/CtrlAnimation"),m=t("../firstRechagre/LayerFirstRecharge"),v=t("../fund/LayerFund"),_=t("../specialGift/LayerSpecialGift"),S=t("./Hero/LayerEquipDecomposition"),g=t("./Hero/LayerHeroBag"),b=t("./Hero/LayerOneKeySynthesisDisplay"),C=t("./Hero/Rune/LayerRuneBag"),R=t("./Hero/Rune/LayerRuneDetails"),M=t("./Hero/Rune/LayerRuneMain"),w=t("./Hero/Rune/LayerRuneReplace"),O=t("./Hero/Rune/LayerRuneSynthesis"),B=t("./Hero/Rune/LayerRuneSynthesisDisplay"),P=t("./LayerEquipSynthesis"),G=t("./LayerItemDetail"),k=t("./LayerMain"),x=t("./LayerMainAnimation"),T=t("./LayerMainMenu"),j=t("./LayerMainResources"),I=t("./LayerSynthesisDisplay"),D=t("./Xiulian/LayerBreach"),F=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.LayerMain=e.createUI(k.LayerMain),e.LayerEquipSynthesis=e.createUI(P.LayerEquipSynthesis),e.LayerItemDetail=e.createUI(G.LayerItemDetail),e.LayerMainMenu=e.createUI(T.LayerMainMenu),e.LayerMainResources=e.createUI(j.LayerMainResources),e.LayerMainAnimation=e.createUI(x.LayerMainAnimation),e.LayerEquipDecomposition=e.createUI(S.LayerEquipDecomposition),e.LayerSynthesisDisplay=e.createUI(I.LayerSynthesisDisplay),e.LayerBreach=e.createUI(D.LayerBreach),e.LayerOneKeySynthesisDisplay=e.createUI(b.LayerOneKeySynthesisDisplay),e.LayerHeroBag=e.createUI(g.LayerHeroBag),e.LayerRuneMain=e.createUI(M.LayerRuneMain),e.LayerRuneBag=e.createUI(C.LayerRuneBag),e.LayerRuneDetails=e.createUI(R.LayerRuneDetails),e.LayerRuneReplace=e.createUI(w.LayerRuneReplace),e.LayerRuneSynthesis=e.createUI(O.LayerRuneSynthesis),e.LayerRuneSynthesisDisplay=e.createUI(B.LayerRuneSynthesisDisplay),e.LayerDayWeekMonthGift=e.createUI(h.LayerDayWeekMonthGift),e.LayerEveryDaySignIn=e.createUI(y.LayerEveryDaySignIn),e.LayerFirstRecharge=e.createUI(m.LayerFirstRecharge),e.LayerFund=e.createUI(v.LayerFund),e.LayerSpecialGift=e.createUI(_.LayerSpecialGift),e.isShowAbanbon=!1,e.everyDataSignDrity=!1,e}return n(e,t),Object.defineProperty(e.prototype,"ShowAbandon",{get:function(){return this.isShowAbanbon},set:function(t){this.isShowAbanbon=t},enumerable:!1,configurable:!0}),e.prototype.enter=function(){return a(this,void 0,void 0,function(){var t,e=this;return l(this,function(){return(t=this).toolSet=p.ToolSet.createToolSet(),t.toolSet.addCallback(t.CtrlAnimation.playResourceAnimation,function(e,r,o){e==d.AnimationEnum.FlyResource&&t.LayerMainAnimation.pushGoods(o)}),t.toolSet.addListener(t.CtrlGameNet.getEventProxy(),"CmdBattleBroMsg",function(){s.FW.LWX.log("\u68c0\u6d4b\u5230\u8fd8\u6709\u6218\u6597\u672a\u5b8c\u6210\uff0c\u9700\u8981\u5f39\u51fa\u653e\u5f03\u5f39\u7a97"),e.ModelMgr.ModelBattle.GetIsBattleRunning()||(t.isShowAbanbon=!0)}),t.toolSet.addListener(s.FW.FWEvent.eventProxy,u.FWEventType.theNextDay,function(){t.everyDataSignDrity=!0}),t.toolSet.addUpdateFrame(t.udpate,t),[2,null]})})},e.prototype.exit=function(){return p.ToolSet.destroyToolSet(this.toolSet),null},e.prototype.udpate=function(){this.everyDataSignDrity&&(this.everyDataSignDrity=!1,this.ModelMgr.ModelEveryDaySignIn.ReqestInfo())},e.__cname="CtrlMain",i([c.injectField("CtrlAnimation")],e.prototype,"CtrlAnimation",void 0),i([c.injectField("CtrlGameNet")],e.prototype,"CtrlGameNet",void 0),i([c.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(f.CtrlBehavior);r.CtrlMain=F,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/container/Container":void 0,"../../../../framework/event/FWEventCenter":void 0,"../../../../framework/utils/Toolset":void 0,"../CtrlBehavior":"CtrlBehavior","../DayWeekMonthGift/LayerDayWeekMonthGift":"LayerDayWeekMonthGift","../EveryDaySignIn/LayerEveryDaySignIn":"LayerEveryDaySignIn","../animation/CtrlAnimation":"CtrlAnimation","../firstRechagre/LayerFirstRecharge":"LayerFirstRecharge","../fund/LayerFund":"LayerFund","../specialGift/LayerSpecialGift":"LayerSpecialGift","./Hero/LayerEquipDecomposition":"LayerEquipDecomposition","./Hero/LayerHeroBag":"LayerHeroBag","./Hero/LayerOneKeySynthesisDisplay":"LayerOneKeySynthesisDisplay","./Hero/Rune/LayerRuneBag":"LayerRuneBag","./Hero/Rune/LayerRuneDetails":"LayerRuneDetails","./Hero/Rune/LayerRuneMain":"LayerRuneMain","./Hero/Rune/LayerRuneReplace":"LayerRuneReplace","./Hero/Rune/LayerRuneSynthesis":"LayerRuneSynthesis","./Hero/Rune/LayerRuneSynthesisDisplay":"LayerRuneSynthesisDisplay","./LayerEquipSynthesis":"LayerEquipSynthesis","./LayerItemDetail":"LayerItemDetail","./LayerMain":"LayerMain","./LayerMainAnimation":"LayerMainAnimation","./LayerMainMenu":"LayerMainMenu","./LayerMainResources":"LayerMainResources","./LayerSynthesisDisplay":"LayerSynthesisDisplay","./Xiulian/LayerBreach":"LayerBreach"}],CtrlMall:[function(t,e,r){"use strict";cc._RF.push(e,"b2aa1X9wNVMZZa5KDzXrk4g","CtrlMall");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.CtrlMall=r.drawDisPlayBgConfig=r.sEquipBgConfig=r.ChapterBoxconfig=r.ChapterBgconfig=void 0;var i=t("../../../model/mall/ModelMall"),a=t("../../CtrlBehavior"),l=t("./LayerMallChestDetails"),s=t("./mallDraw/LayerMallDrawDisplay"),c=t("./mallDraw/LayerMallLuckyDrawDisplay");r.ChapterBgconfig=["\u5546\u5e97_\u7ae0\u8282\u793c\u5305\u7ea2\u8272\u5e95\u68465","\u5546\u5e97_\u7ae0\u8282\u793c\u5305\u9ec4\u8272\u5e95\u68464","\u5546\u5e97_\u7ae0\u8282\u793c\u5305\u84dd\u8272\u5e95\u68462","\u5546\u5e97_\u7ae0\u8282\u793c\u5305\u7eff\u8272\u5e95\u68461","\u5546\u5e97_\u7ae0\u8282\u793c\u5305\u7d2b\u8272\u5e95\u68463"],r.ChapterBoxconfig=["\u5546\u5e97_\u56fe\u6807_\u7ae0\u8282\u5b9d\u7bb1\u56fe,\u5a03\u5a031","\u5546\u5e97_\u56fe\u6807_\u7ae0\u8282\u5b9d\u7bb1\u56fe,\u5a03\u5a032","\u5546\u5e97_\u56fe\u6807_\u7ae0\u8282\u5b9d\u7bb1\u56fe,\u5a03\u5a033"],r.sEquipBgConfig=new Map,r.sEquipBgConfig.set(i.MallChestType.SEquip,"\u5546\u5e97_s\u7ea7\u6218\u5907"),r.sEquipBgConfig.set(i.MallChestType.LimitSEquip,"\u5546\u5e97_\u9650\u65f6\u6218\u5907"),r.drawDisPlayBgConfig=new Map,r.drawDisPlayBgConfig.set(i.MallChestType.SEquip,"\u5546\u5e97_\u56fe\u6807_S\u795e\u5668\u50a8\u5907\u80cc\u666f"),r.drawDisPlayBgConfig.set(i.MallChestType.LimitSEquip,"\u5546\u5e97_\u56fe\u6807_S\u795e\u5668\u50a8\u5907\u80cc\u666f"),r.drawDisPlayBgConfig.set(i.MallChestType.ordinaryLuckDraw,"\u5546\u5e97_\u56fe\u6807_\u5347\u5b98\u53d1\u8d221\u4f4e\u7ea7\u80cc\u666f"),r.drawDisPlayBgConfig.set(i.MallChestType.seniorLuckDraw,"\u5546\u5e97_\u56fe\u6807_\u5347\u5b98\u53d1\u8d222\u9ad8\u7ea7\u80cc\u666f");var u=function(t){function e(){var e=t.call(this)||this;return e._LayerMallChestDetails=e.createUI(l.LayerMallChestDetails),e._LayerMallDrawDisplay=e.createUI(s.LayerMallDrawDisplay),e._LayerMallLuckyDrawDisplay=e.createUI(c.LayerMallLuckyDrawDisplay),e}return n(e,t),e.__cname="CtrlMall",e}(a.CtrlBehavior);r.CtrlMall=u,cc._RF.pop()},{"../../../model/mall/ModelMall":"ModelMall","../../CtrlBehavior":"CtrlBehavior","./LayerMallChestDetails":"LayerMallChestDetails","./mallDraw/LayerMallDrawDisplay":"LayerMallDrawDisplay","./mallDraw/LayerMallLuckyDrawDisplay":"LayerMallLuckyDrawDisplay"}],CtrlMgr:[function(t,e,r){"use strict";cc._RF.push(e,"1e1f8zVW0hEibTVEO56sr7O","CtrlMgr");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.CtrlMgr=void 0;var c=t("../../../framework/base/ScriptObject"),u=t("../../../framework/container/Container"),p=t("../../../framework/FW"),f=t("./Activity/CtrlActivity"),h=t("./alert/CtrlAlert"),y=t("./animation/CtrlAnimation"),d=t("./attr/CtrlAttr"),m=t("./audio/CtrlAudio"),v=t("./battle/CtrlBattle"),_=t("./battle/view/CtrlBattleView"),S=t("./buff/CtrlBuff"),g=t("./clickOnEffect/CtrlClickOnEffect"),b=t("./DataReporting/DataReportingInterface"),C=t("./gameLogin/CtrlGameLogin"),R=t("./gameNet/CtrlGameNet"),M=t("./gm/CtrlGM"),w=t("./goods/CtrlGoods"),O=t("./guide/CtrlGuide"),B=t("./joint/CtrlJoint"),P=t("./login/CtrlLogin"),G=t("./LuckyCat/CtrlLuckyCat"),k=t("./main/Adventure/CtrlAdventure"),x=t("./main/CtrlMain"),T=t("./main/mall/CtrlMall"),j=t("./main/notice/CtrlNotice"),I=t("./main/Xiulian/CtrlXiulian"),D=t("./main/Xiulian/friend/CtrlFriends"),F=t("./Pay/CtrlPay"),L=t("./Player/CtrlPlayer"),E=t("./role/CtrlRole"),A=t("./system/CtrlSystem"),V=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tmCtrl=new Set,e.tlCtrl=[],e.CtrlSystem=e.CreateCtrl(A.CtrlSystem),e.CtrlGameNet=e.CreateCtrl(R.CtrlGameNet),e.CtrlGM=e.CreateCtrl(M.CtrlGM),e.CtrlMain=e.CreateCtrl(x.CtrlMain),e.CtrlLogin=e.CreateCtrl(P.CtrlLogin),e.CtrlGameLogin=e.CreateCtrl(C.CtrlGameLogin),e.CtrlBattle=e.CreateCtrl(v.CtrlBattle),e.CtrlGoods=e.CreateCtrl(w.CtrlGoods),e.CtrlAlert=e.CreateCtrl(h.CtrlAlert),e.CtrlXiulian=e.CreateCtrl(I.CtrlXiulian),e.CtrlAnimation=e.CreateCtrl(y.CtrlAnimation),e.CtrlAudio=e.CreateCtrl(m.CtrlAudio),e.CtrlBattleView=e.CreateCtrl(_.CtrlBattleView),e.CtrlMall=e.CreateCtrl(T.CtrlMall),e.CtrlNotice=e.CreateCtrl(j.CtrlNotice),e.CtrlAttr=e.CreateCtrl(d.CtrlAttr),e.CtrlActivity=e.CreateCtrl(f.CtrlActivity),e.CtrlAdventure=e.CreateCtrl(k.CtrlAdventure),e.CtrlGuide=e.CreateCtrl(O.CtrlGuide),e.CtrlBuff=e.CreateCtrl(S.CtrlBuff),e.CtrlClickOnEffect=e.CreateCtrl(g.CtrlClickOnEffect),e.CtrlPay=e.CreateCtrl(F.CtrlPay),e.CtrlJoint=e.CreateCtrl(B.CtrlJoint),e.CtrlFriends=e.CreateCtrl(D.CtrlFriends),e.CtrlPlayer=e.CreateCtrl(L.CtrlPlayer),e.CtrlRole=e.CreateCtrl(E.CtrlRole),e.CtrlLuckyCat=e.CreateCtrl(G.CtrlLuckyCat),e._isEnter=!1,e._isAfterEnter=!1,e}return n(e,t),e.prototype.CreateCtrl=function(t){var e=u.Container.inst().collectClass(t);return this.tmCtrl.add(e),this.tlCtrl.push(e),e},e.prototype.onDestroy=function(){},e.prototype.OnEnter=function(){return a(this,void 0,void 0,function(){var t,e,r,o,n,i,a,c;return l(this,function(l){switch(l.label){case 0:if(this._isEnter)return[2];this._isEnter=!0,(t=u.Container.inst().getByAlias("DataReporting")).PushBuriedList(b.SingleBuriedPointType.start_init_ctrl),e=[];try{for(r=s(this.tlCtrl),o=r.next();!o.done;o=r.next())n=o.value,p.FW.Log.debug("enter: "+n.className),null!=(i=n.enterWrap())&&e.push(i)}catch(f){a={error:f}}finally{try{o&&!o.done&&(c=r.return)&&c.call(r)}finally{if(a)throw a.error}}return[4,Promise.all(e)];case 1:return l.sent(),t.PushBuriedList(b.SingleBuriedPointType.end_init_ctrl),[2]}})})},e.prototype.OnAfterEnter=function(){return a(this,void 0,void 0,function(){var t,e,r,o,n,i,a;return l(this,function(l){switch(l.label){case 0:if(this._isAfterEnter)return[2];this._isAfterEnter=!0,t=[];try{for(e=s(this.tlCtrl),r=e.next();!r.done;r=e.next())o=r.value,null!=(n=o.afterEnterGame())&&t.push(n)}catch(c){i={error:c}}finally{try{r&&!r.done&&(a=e.return)&&a.call(e)}finally{if(i)throw i.error}}return[4,Promise.all(t)];case 1:return l.sent(),[2]}})})},e.prototype.OnExit=function(){return a(this,void 0,void 0,function(){var t,e;return l(this,function(r){switch(r.label){case 0:if(0==this._isEnter)return[2];for(this._isEnter=!1,this._isAfterEnter=!1,t=[],e=this.tlCtrl.length-1;e>=0;e--)null!=this.tlCtrl[e].exitWrap()&&t.push(t);return[4,Promise.all(t)];case 1:return r.sent(),[2]}})})},e.prototype.JumpLayer=function(t){this.ModelMgr||(this.ModelMgr=u.Container.inst().getByAlias("ModelMgr"));var e=this.ModelMgr.ModelJump.GetJump(t);if(e)return this.CtrlMain.LayerMain.Open(e),!0;p.FW.LWX.error("\u627e\u4e0d\u5230\u5bf9\u5e94\u7684jump\u8868\u6570\u636e\uff0c\u8bf7\u68c0\u67e5\uff1a "+t)},e.prototype.Load=function(t,e){if(null!=t){var r=t.split("."),o=r[0],n=u.Container.inst().getByAlias(o);if(n){var i=n.GetConditionSet();if(!i||i.GetBool()){var a;n.load(e);for(var l=1;l<r.length;l++){var s=r[l];if(!n.getTab2(s))return void p.FW.Log.error("\u627e\u4e0d\u5230\u6807\u7b7e\u9875",s);a=n.switchTab2(s)}a&&a.switchDefaultTab()}}else p.FW.Log.error("\u627e\u4e0d\u5230layer\u754c\u9762",o)}},e.__cname="CtrlMgr",i([u.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(c.ScriptObject);r.CtrlMgr=V,cc._RF.pop()},{"../../../framework/FW":void 0,"../../../framework/base/ScriptObject":void 0,"../../../framework/container/Container":void 0,"./Activity/CtrlActivity":"CtrlActivity","./DataReporting/DataReportingInterface":"DataReportingInterface","./LuckyCat/CtrlLuckyCat":"CtrlLuckyCat","./Pay/CtrlPay":"CtrlPay","./Player/CtrlPlayer":"CtrlPlayer","./alert/CtrlAlert":"CtrlAlert","./animation/CtrlAnimation":"CtrlAnimation","./attr/CtrlAttr":"CtrlAttr","./audio/CtrlAudio":"CtrlAudio","./battle/CtrlBattle":"CtrlBattle","./battle/view/CtrlBattleView":"CtrlBattleView","./buff/CtrlBuff":"CtrlBuff","./clickOnEffect/CtrlClickOnEffect":"CtrlClickOnEffect","./gameLogin/CtrlGameLogin":"CtrlGameLogin","./gameNet/CtrlGameNet":"CtrlGameNet","./gm/CtrlGM":"CtrlGM","./goods/CtrlGoods":"CtrlGoods","./guide/CtrlGuide":"CtrlGuide","./joint/CtrlJoint":"CtrlJoint","./login/CtrlLogin":"CtrlLogin","./main/Adventure/CtrlAdventure":"CtrlAdventure","./main/CtrlMain":"CtrlMain","./main/Xiulian/CtrlXiulian":"CtrlXiulian","./main/Xiulian/friend/CtrlFriends":"CtrlFriends","./main/mall/CtrlMall":"CtrlMall","./main/notice/CtrlNotice":"CtrlNotice","./role/CtrlRole":"CtrlRole","./system/CtrlSystem":"CtrlSystem"}],CtrlNotice:[function(t,e,r){"use strict";cc._RF.push(e,"81b9bJAoT9CQrqU6DfYL2uS","CtrlNotice");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.CtrlNotice=r.NoticeType=void 0;var c,u=t("../../../../../engine/EngineMain"),p=t("../../../../../framework/container/Container"),f=t("../../../../../framework/utils/HttpLoader"),h=t("../../CtrlBehavior"),y=t("./LayerNotice");(function(t){t.notice="notice",t.settings_Feedback="settings_Feedback"})(c=r.NoticeType||(r.NoticeType={}));var d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._LayerNotice=e.createUI(y.LayerNotice),e.isShowNotice=!1,e.noticeData=[],e.isShowSettingFeedBack=!1,e.settingFeedBackData=[],e}return n(e,t),Object.defineProperty(e.prototype,"ShowNotice",{get:function(){return this.isShowNotice},set:function(t){this.isShowNotice=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"NoticeData",{get:function(){return this.noticeData},set:function(t){this.noticeData=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ShowSettingFeedBack",{get:function(){return this.isShowSettingFeedBack},set:function(t){this.isShowSettingFeedBack=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"SettingFeedBackData",{get:function(){return this.settingFeedBackData},set:function(t){this.settingFeedBackData=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"NoticeLastOpenTimeKey",{get:function(){return"noticeLastOpenTime"+u.EngineMain.readLocalStorage("account_num")},enumerable:!1,configurable:!0}),e.prototype.enter=function(){return a(this,void 0,Promise,function(){var t,e;return l(this,function(r){switch(r.label){case 0:return[4,this.RequestNoticeData()];case 1:return r.sent(),this.NoticeData.length>0?(t=u.EngineMain.readLocalStorage(this.NoticeLastOpenTimeKey)||this.TimeUtil.time3String(0,!0),e=this.TimeUtil.time3String(this.TimeUtil.now(),!0),this.isShowNotice=t!=e):this.isShowNotice=!1,this.isShowSettingFeedBack=this.SettingFeedBackData.length>0,[2,null]}})})},e.prototype.RequestNoticeData=function(){return a(this,void 0,void 0,function(){var t,e,r,o,n,i,a,u;return l(this,function(l){switch(l.label){case 0:return t=this.ModelPublicData.getNoticeUrl(),[4,f.HttpLoader.RequestJson(t,!0)];case 1:if(e=l.sent(),this.noticeData=[],this.settingFeedBackData=[],(null==e?void 0:e.json)&&e.json.list.length){r=e.json.list;try{for(o=s(r),n=o.next();!n.done;n=o.next())(i=n.value).type==c.notice?this.noticeData.push(i):i.type==c.settings_Feedback&&this.settingFeedBackData.push(i)}catch(p){a={error:p}}finally{try{n&&!n.done&&(u=o.return)&&u.call(o)}finally{if(a)throw a.error}}}return[2,e]}})})},e.prototype.exit=function(){return null},e.__cname="CtrlNotice",i([p.injectField("ModelPublicData")],e.prototype,"ModelPublicData",void 0),i([p.injectField("TimeUtil")],e.prototype,"TimeUtil",void 0),e}(h.CtrlBehavior);r.CtrlNotice=d,cc._RF.pop()},{"../../../../../engine/EngineMain":void 0,"../../../../../framework/container/Container":void 0,"../../../../../framework/utils/HttpLoader":void 0,"../../CtrlBehavior":"CtrlBehavior","./LayerNotice":"LayerNotice"}],CtrlPay:[function(t,e,r){"use strict";cc._RF.push(e,"bd6d61OKINIhoWExBKGHXtY","CtrlPay");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.CtrlPay=void 0;var s=t("../../../../framework/container/Container"),c=t("../../../../framework/FW"),u=t("../CtrlBehavior"),p=t("../sdk/SDKInterface"),f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.cantPay=!1,e.payCloae=!1,e}return n(e,t),e.prototype.PayforAdVideo=function(){return a(this,void 0,Promise,function(){var t,e,r,o,n;return l(this,function(i){switch(i.label){case 0:return t=!1,e=this.ModelMgr.ModelMonthCard.GetMonthRefByType(1),(r=this.ModelMgr.ModelVO.VOMonthCardBag.Get(e.resId))&&(o=r.GetTime(),n=this.TimeUtil.now(),.001*o-n>=0)?(this.log("\u6708\u5361\u514d\u5e7f\u544a"),[2,!0]):this.SDKMgr.getSDK().HasADVideo()?[4,this.SDKMgr.getSDK().Advertisement(p.AdvertisementType.shipin)]:[3,2];case 1:return t=i.sent(),c.FW.Log.log("PayforAdVideo\u5e7f\u544a\u7ed3\u679c:",t),[3,3];case 2:c.FW.showTip(c.FW.G_W("\u89c6\u9891\u5c1a\u672a\u51c6\u5907\u5c31\u7eea")),i.label=3;case 3:return[2,t]}})})},e.prototype.HasAdVideo=function(){return this.SDKMgr.getSDK().HasADVideo()},e.prototype.setCantPay=function(t){this.cantPay=t},e.prototype.GetCantPay=function(){return this.cantPay},e.prototype.setPayVisible=function(t){this.payCloae=t},e.prototype.getPayVisible=function(){return this.payCloae},e.__cname="CtrlPay",i([s.injectField("SDKMgr")],e.prototype,"SDKMgr",void 0),i([s.injectField("CtrlAlert")],e.prototype,"CtrlAlert",void 0),i([s.injectField("AppCustomData")],e.prototype,"AppCustomData",void 0),i([s.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([s.injectField("TimeUtil")],e.prototype,"TimeUtil",void 0),e}(u.CtrlBehavior);r.CtrlPay=f,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/container/Container":void 0,"../CtrlBehavior":"CtrlBehavior","../sdk/SDKInterface":"SDKInterface"}],CtrlPlayer:[function(t,e,r){"use strict";cc._RF.push(e,"3e105ZcHe5Kc6n0yKwZsLrP","CtrlPlayer");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.CtrlPlayer=void 0;var i=t("../CtrlBehavior"),a=t("./LayerPlayerDetail"),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.LayerPlayerDetail=e.createUI(a.LayerPlayerDetail),e}return n(e,t),e.__cname="CtrlPlayer",e}(i.CtrlBehavior);r.CtrlPlayer=l,cc._RF.pop()},{"../CtrlBehavior":"CtrlBehavior","./LayerPlayerDetail":"LayerPlayerDetail"}],CtrlRole:[function(t,e,r){"use strict";cc._RF.push(e,"de665JDt2ZI7bgdw5+/mOV3","CtrlRole");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.CtrlRole=void 0;var s=t("../../../../framework/container/Container"),c=t("../../../../framework/utils/Toolset"),u=t("../CtrlBehavior"),p=t("../sdk/SDKInterface"),f=t("./LayerInformation"),h=t("./LayerInformationTips"),y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._LayerInformation=e.createUI(f.LayerInformation),e._LayerInformationTips=e.createUI(h.LayerInformationTips),e}return n(e,t),e.prototype.enter=function(){return a(this,void 0,Promise,function(){var t=this;return l(this,function(){return this.toolSet=c.ToolSet.createToolSet(),this.toolSet.addListener(this.ModelMgr.ModelVO.VORoleBag.GetEventProxy(),"OnAdd",function(){t.lastLevel=t.ModelMgr.ModelRole.GetRole().GetLevel()},this),this.toolSet.addListener(this.ModelMgr.ModelVO.VORoleBag.GetEventProxy(),"OnUpdate",this.CheckRoleLevelUp,this),[2]})})},e.prototype.exit=function(){return a(this,void 0,Promise,function(){return l(this,function(){return c.ToolSet.destroyToolSet(this.toolSet),this.toolSet=null,[2,null]})})},e.prototype.CheckRoleLevelUp=function(){var t=this.ModelMgr.ModelRole.GetRole().GetLevel();null!=this.lastLevel&&t==this.lastLevel||(this.lastLevel=t,this.SDKMgr.getSDK().submitDataUserInfo(p.SubmitDataUserInfoType.leveup))},e.__cname="CtrlRole",i([s.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([s.injectField("SDKMgr")],e.prototype,"SDKMgr",void 0),e}(u.CtrlBehavior);r.CtrlRole=y,cc._RF.pop()},{"../../../../framework/container/Container":void 0,"../../../../framework/utils/Toolset":void 0,"../CtrlBehavior":"CtrlBehavior","../sdk/SDKInterface":"SDKInterface","./LayerInformation":"LayerInformation","./LayerInformationTips":"LayerInformationTips"}],CtrlSystem:[function(t,e,r){"use strict";cc._RF.push(e,"e76f28sbUZMnrPK1wjBFRBj","CtrlSystem");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.CtrlSystem=void 0;var l=t("../../../../framework/FW"),s=t("../../../../framework/container/Container"),c=t("../../../../framework/layer/PopLayerMgr"),u=t("../../../../framework/layer/common/UIMgr"),p=t("../CtrlBehavior"),f=t("../main/LayerMain"),h=t("./LayerSystemOpen"),y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.LayerSystemOpen=e.createUI(h.LayerSystemOpen),e}return n(e,t),e.prototype.JumpLayer=function(t){this.ModelMgr&&(this.ModelMgr=s.Container.inst().getByAlias("ModelMgr")),this.ModelMgr.ModelJump.GetJump(t)?u.UIMgr.instance.unLoadAll():l.FW.LWX.error("\u627e\u4e0d\u5230\u5bf9\u5e94\u7684jump\u8868\u6570\u636e\uff0c\u8bf7\u68c0\u67e5\uff1a "+t)},e.prototype.Load=function(t){if(null!=t)if(l.FW.LWX.log("\u6253\u5f00\u754c\u9762\uff0csystemId:"+t),null!=this.ModelMgr.ModelSystem.GetSystem(t)){var e=a(this.ModelMgr.ModelSystem.GetIsSystemOpen(t),2),r=e[0],o=e[1];if(r)return this.OpenPreUI(t);l.FW.showTip(o)}else l.FW.LWX.error("\u627e\u4e0d\u5230\u5bf9\u5e94\u7684\u8868\u6570\u636e\uff0csystemId:"+t)},e.prototype.OpenPreUI=function(t){var e=this.ModelMgr.ModelSystem.GetSystem(t);if(null!=e){if(!e.GetShowPreSystem())return(o=s.Container.inst().getByAlias(e.GetUrl())).load(),o;var r=e.GetPreSystemId(),o=this.OpenPreUI(r)}},e.prototype.PushShowOpenSystemObj=function(t){var e=this;c.PopLayerMgr.inst().AddLayer(this,this.LayerSystemOpen,function(){e.LayerSystemOpen.SetSystemObj(t),e.LayerSystemOpen.load()},function(){if(!u.UIMgr.instance.isUIOpen(f.LayerMain))return!1;if(!e.CtrlMain.LayerMain.tabInitFinish)return!1;var t=e.CtrlMain.LayerMain.getRunningTab();return null!=t&&"TabXiulian"==t.className&&null!=t.getGuideCom()})},e.__cname="CtrlSystem",i([s.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([s.injectField("CtrlMain")],e.prototype,"CtrlMain",void 0),e}(p.CtrlBehavior);r.CtrlSystem=y,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/container/Container":void 0,"../../../../framework/layer/PopLayerMgr":void 0,"../../../../framework/layer/common/UIMgr":void 0,"../CtrlBehavior":"CtrlBehavior","../main/LayerMain":"LayerMain","./LayerSystemOpen":"LayerSystemOpen"}],CtrlXiulian:[function(t,e,r){"use strict";cc._RF.push(e,"4cbfc3pB2pC6q/1LdV5cQiX","CtrlXiulian");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.CtrlXiulian=void 0;var i=t("../../CtrlBehavior"),a=t("../../battle/view/common/LayerUnlockSkill"),l=t("../Xiulian/LayerChapterSelect"),s=t("../Xiulian/LayerMail"),c=t("./LayerBossNodeReconnect"),u=t("./LayerBuySta"),p=t("./LayerChapterReward"),f=t("./LayerHeroUnlock"),h=t("./LayerMailVerbose"),y=t("./LayerMonthCard"),d=t("./LayerXiulianBag"),m=t("./LayerXiulianOnHook"),v=t("./LayerXiulianQuick"),_=t("./Setting/LayerCustomerService"),S=t("./Setting/LayerGiftPackage"),g=t("./Setting/LayerLogoutTips"),b=t("./Setting/LayerSetting"),C=t("./Setting/LayerShare"),R=t("./Task/LayerXiulianTask"),M=function(t){function e(){var e=t.call(this)||this;return e._LayerSelect=e.createUI(l.LayerChapterSelect),e._LayerReward=e.createUI(p.LayerChapterReward),e._LayerMail=e.createUI(s.LayerMail),e._LayerSetting=e.createUI(b.LayerSetting),e._LayerLogoutTips=e.createUI(g.LayerLogoutTips),e._LayerMailVerbose=e.createUI(h.LayerMailVerbose),e._LayerGiftPackage=e.createUI(S.LayerGiftPackage),e._LayerShare=e.createUI(C.LayerShare),e._LayerXiulianBag=e.createUI(d.LayerXiulianBag),e._LayerCustomerService=e.createUI(_.LayerCustomerService),e._LayerXiulianOnHook=e.createUI(m.LayerXiulianOnHook),e._LayerXiulianQuick=e.createUI(v.LayerXiulianQuick),e._LayerXiulianTask=e.createUI(R.LayerXiulianTask),e._LayerBuySta=e.createUI(u.LayerBuySta),e._LayerMonthCard=e.createUI(y.LayerMonthCard),e._LayerHeroUnlock=e.createUI(f.LayerHeroUnlock),e._LayerUnlockSkill=e.createUI(a.LayerUnlockSkill),e._LayerBossNodeReconnect=e.createUI(c.LayerBossNodeReconnect),e}return n(e,t),e.__cname="CtrlXiulian",e}(i.CtrlBehavior);r.CtrlXiulian=M,cc._RF.pop()},{"../../CtrlBehavior":"CtrlBehavior","../../battle/view/common/LayerUnlockSkill":"LayerUnlockSkill","../Xiulian/LayerChapterSelect":"LayerChapterSelect","../Xiulian/LayerMail":"LayerMail","./LayerBossNodeReconnect":"LayerBossNodeReconnect","./LayerBuySta":"LayerBuySta","./LayerChapterReward":"LayerChapterReward","./LayerHeroUnlock":"LayerHeroUnlock","./LayerMailVerbose":"LayerMailVerbose","./LayerMonthCard":"LayerMonthCard","./LayerXiulianBag":"LayerXiulianBag","./LayerXiulianOnHook":"LayerXiulianOnHook","./LayerXiulianQuick":"LayerXiulianQuick","./Setting/LayerCustomerService":"LayerCustomerService","./Setting/LayerGiftPackage":"LayerGiftPackage","./Setting/LayerLogoutTips":"LayerLogoutTips","./Setting/LayerSetting":"LayerSetting","./Setting/LayerShare":"LayerShare","./Task/LayerXiulianTask":"LayerXiulianTask"}],CullingGroup:[function(t,e,r){"use strict";cc._RF.push(e,"1f14cF0bwdJvIA2zM6giP1n","CullingGroup");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.CullingGroup=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e}(t("../../../../../framework/ecs/System").System);r.CullingGroup=i,cc._RF.pop()},{"../../../../../framework/ecs/System":void 0}],CustomListWrap:[function(t,e,r){"use strict";cc._RF.push(e,"f1c27NWUYBI/LWTdnwG3TBV","CustomListWrap");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.CustomListWrap=void 0;var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tlWorldPos=[],e}return n(e,t),Object.defineProperty(e.prototype,"numitems",{get:function(){return this.container._children.length},set:function(t){var e=this.container._children.length;if(t>e)for(var r=e;r<t;r++)null==this.itemProvider?this.addItemFromPool():this.addItemFromPool(this.itemProvider.call(this.caller,r));else this.removeChildrenToPool(t,e);if(null!=this.itemRenderer)for(r=0;r<t;r++)this.itemRendererWrap(r,this.container.getChildAt(r))},enumerable:!1,configurable:!0}),e.prototype.init=function(t,e,r,o){void 0===o&&(o="item"),this.gobj=t,this.num=r,this.itemName=o,this.container=this.gobj.addChild(new fgui.GComponent).asCom,this.glist=e,this.caller=e.getUserData("__gListCaller"),this.itemRenderer=e.getUserData("__itemRenderer"),this.itemProvider=e.getUserData("__itemProvider"),this.onClickItem=e.getUserData("__onClickItem"),this._pool=new fgui.GObjectPool,this._defaultItem=e.defaultItem,this.onClickItem&&this.container.setOn(fgui.Event.CLICK_ITEM,this.onClickItemWrap,this);for(var n=0;n<this.num;n++){var i=this.gobj.tm(this.itemName+n).asGraph,a={x:0,y:0};i&&(a.x=i.x,a.y=i.y),this.tlWorldPos.push(a)}},e.prototype.onDestroy=function(){this.container.removeOn(fgui.Event.CLICK_ITEM),this._pool.clear()},e.prototype.update=function(t){this.glist.setItemData(t),this.numitems=t.length;for(var e=0;e<this.numitems;e++){var r=this.container.getChildAt(e).asLabel,o=this.tlWorldPos[e];r&&o&&(r.setPivot(.5,.5,!0),r.setPosition(o.x,o.y))}},e.prototype.addItemFromPool=function(t){void 0===t&&(t=null);var e=this.container.addChild(this.getFromPool(t));return this.onClickItem&&e.on(fgui.Event.CLICK,this.onClickItemInner,this),e},e.prototype.removeChildToPoolAt=function(t){var e=this.container.removeChildAt(t);this.returnToPool(e)},e.prototype.returnToPool=function(t){t.removeOn(fgui.Event.CLICK),this._pool.returnObject(t)},e.prototype.removeChildrenToPool=function(t,e){null==t&&(t=0),null==e&&(e=-1),(e<0||e>=this.container._children.length)&&(e=this.container._children.length-1);for(var r=t;r<=e;++r)this.removeChildToPoolAt(t)},e.prototype.getFromPool=function(t){void 0===t&&(t=null),t||(t=this._defaultItem);var e=this._pool.getObject(t);return null!=e&&(e.visible=!0),e},e.prototype.onClickItemInner=function(t){var e=fgui.GObject.cast(t.currentTarget);this.container.node.emit(fgui.Event.CLICK_ITEM,e,t)},e.prototype.itemRendererWrap=function(t,e){var r=this.glist.getItemData(t);e.setUserData("__gListIndex",t),this.itemRenderer&&this.itemRenderer.call(this.caller,t,e,r)},e.prototype.onClickItemWrap=function(t){var e=this.caller;if(e&&!e.destroyed){var r=this.glist,o=t.getUserData("__gListIndex"),n=r.getItemData(o),i=r.getUserData("__onClickItem");r.setUserData("__itemClickIndex",o),i.call(e,o,t,n)}},e.__cname="CustomListWrap",e}(t("../../framework/base/ScriptObject").ScriptObject);r.CustomListWrap=i,cc._RF.pop()},{"../../framework/base/ScriptObject":void 0}],DataReportingHelperMgr:[function(t,e,r){"use strict";cc._RF.push(e,"dd95asmoHtCaKbuIYRPDGSr","DataReportingHelperMgr");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.DataReportingHelperMgr=void 0;var i=t("../../../../../framework/base/ScriptObject"),a=t("../../../../../framework/container/Container"),l=t("./BrowserDataReportingHelper"),s=t("./DefaultDataReportingHelper"),c=t("./WXDataReportingHelper"),u=function(t){function e(){var e=t.call(this)||this,r=new Map;return r.set(cc.sys.DESKTOP_BROWSER,l.BrowserDataReportingHelper),r.set(cc.sys.MOBILE_BROWSER,l.BrowserDataReportingHelper),r.set(cc.sys.WECHAT_GAME,c.WXDataReportingHelper),e.tmReportingHelperClass=r,e}return n(e,t),Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e),e._instance},enumerable:!1,configurable:!0}),e.prototype.createDataReportingHelper=function(t){this.reportingHelper=this.createClazz(t)},e.prototype.createClazz=function(t){var e=this.tmReportingHelperClass.get(t)||s.DefaultDataReportingHelper;if(null==e)return null;var r=new e;return a.Container.inst().inject(r),r},e.prototype.GetDataReportingHelper=function(){return this.reportingHelper},e.__cname="DataReportingHelperMgr",e}(i.ScriptObject);r.DataReportingHelperMgr=u,cc._RF.pop()},{"../../../../../framework/base/ScriptObject":void 0,"../../../../../framework/container/Container":void 0,"./BrowserDataReportingHelper":"BrowserDataReportingHelper","./DefaultDataReportingHelper":"DefaultDataReportingHelper","./WXDataReportingHelper":"WXDataReportingHelper"}],DataReportingHelper:[function(t,e,r){"use strict";cc._RF.push(e,"48fd3oaat1GPr+hN/4UiLJP","DataReportingHelper");var o=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.DataReportingHelper=r.UniqueId=void 0;var n=t("../../../../../framework/container/Container"),i=t("../../../model/public/AppCustomData"),a=function(){for(var t=[],e=0;e<10;e++)t.push(e.toString(10));for(e=0;e<26;e++)t.push(String.fromCharCode("a".charCodeAt(0)+e));for(e=0;e<26;e++)t.push(String.fromCharCode("A".charCodeAt(0)+e));return t}();function l(t,e){if(void 0===e&&(e=a),t<0)throw new Error("scaleTransition Error, value < 0");if(0===t)return e[0];for(var r=e.length,o="",n=t;n>0;)o=e[n%r]+o,n=Math.floor(n/r);return o}var s=function(){function t(){}return t.createUniqueId=function(e){void 0===e&&(e="");var r=t.UniqueIdObject[e];if(void 0===r){var o=l(Date.now())+"-"+l(Math.floor(1e10*Math.random()))+"-";r=e?{prefix:e+"-"+o,count:0}:{prefix:o,count:0},t.UniqueIdObject[e]=r}return r.prefix+l(r.count++)},t.UniqueIdObject={},t}();r.UniqueId=s;var c=function(){function t(){this.appCustomData=i.AppCustomData.instance,this._udid=""}return t.__cname="DataReportingHelper",o([n.injectField("ModelMgr")],t.prototype,"ModelMgr",void 0),t}();r.DataReportingHelper=c,cc._RF.pop()},{"../../../../../framework/container/Container":void 0,"../../../model/public/AppCustomData":"AppCustomData"}],DataReportingInterface:[function(t,e,r){"use strict";cc._RF.push(e,"1f73eo0al5NHaJH4ED7rLOl","DataReportingInterface");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.DataReportingInterface=r.SingleBuriedPointType=void 0;var i=t("../../../../framework/base/ScriptObject");(function(t){t.open_game="open_game",t.start_check_res_version="start_check_res_version",t.end_check_res_version="end_check_res_version",t.start_init_local_version="start_init_local_version",t.end_init_local_version="end_init_local_version",t.start_load_local_version="start_load_local_version",t.end_load_local_version="end_load_local_version",t.start_request_server_data="start_request_server_data",t.end_request_server_data="end_request_server_data",t.start_load_game_framework="start_load_game_framework",t.end_load_game_framework="end_load_game_framework",t.start_fw_init="start_fw_init",t.end_fw_init="end_fw_init",t.start_fgui_init="start_fgui_init",t.end_fgui_init="end_fgui_init",t.start_fgui_load_package="start_fgui_load_package",t.end_fgui_load_package="end_fgui_load_package",t.start_load_ui_config="start_load_ui_config",t.end_load_ui_config="end_load_ui_config",t.start_load_ref="start_load_ref",t.end_load_ref="end_load_ref",t.start_game="start_game",t.start_open_login_view="start_open_login_view",t.end_open_login_view="end_open_login_view",t.click_choose_server_list="click_choose_server_list",t.show_server_list="show_server_list",t.select_server_list="select_server_list",t.sdk_login="sdk_login",t.sdk_login_ok="sdk_login_ok",t.sdk_loginInfo_ok="sdk_loginInfo_ok",t.tip_agree_agreement="tip_agree_agreement",t.start_init_model="start_init_model",t.end_init_model="end_init_model",t.start_init_ctrl="start_init_ctrl",t.end_init_ctrl="end_init_ctrl",t.start_load_proto="start_load_proto",t.end_load_proto="end_load_proto",t.start_init_cache="start_init_cache",t.end_init_cache="end_init_cache",t.start_connect_server="start_connect_server",t.end_connect_server="end_connect_server",t.connect_server_fail="connect_server_fail",t.connect_server_success="connect_server_success",t.account_login="account_login",t.account_login_ok="account_login_ok",t.account_login_fail="account_login_fail",t.onpen_create_role="onpen_create_role",t.click_close_regist="click_close_regist",t.create_role="create_role",t.load_role="load_role",t.load_finish="load_finish",t.enter_mainScene="enter_mainScene"})(r.SingleBuriedPointType||(r.SingleBuriedPointType={}));var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.__cname="DataReportingInterface",e}(i.ScriptObject);r.DataReportingInterface=a,cc._RF.pop()},{"../../../../framework/base/ScriptObject":void 0}],DataReporting:[function(t,e,r){"use strict";cc._RF.push(e,"6d12dXLsBBANa0cqLBhmrYj","DataReporting");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.DataReporting=void 0;var l=t("../../../../engine/EngineMain"),s=t("../../../../framework/container/Container"),c=t("../../../../framework/FW"),u=t("../../../../framework/utils/Toolset"),p=t("./DataReportingInterface"),f=t("./helper/DataReportingHelperMgr"),h=function(t){function e(){var e=t.call(this)||this;return e.BuriedPointSet=new Set,e.key="BuriedPointKey1",e.OnEnter_cor(),e}return n(e,t),e.prototype.OnEnter_cor=function(){var t,e,r=this,o=l.EngineMain.readLocalStorage(this.key,"").split(",");try{for(var n=a(o),i=n.next();!i.done;i=n.next()){var s=i.value;""!=s&&this.BuriedPointSet.add(s)}}catch(c){t={error:c}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.tlDataReport=[],this.toolSet=u.ToolSet.createToolSet(),this.toolSet.addTimer(1,function(){r.Buried()})},e.prototype.InitBuriedPointData=function(t){var e=f.DataReportingHelperMgr.instance.GetDataReportingHelper();return{APIVersion:e.GetAPIVersion(),clientVersion:e.GetClientVersion(),creative:e.GetCreative(),phone:e.GetPhone(),ratio:e.GetRatio(),serverId:e.GetServerId(),source:e.GetSource(),system:e.GetSystem(),udId:e.GetUdId(),kingdom:t}},e.prototype.PushBuriedList=function(t){this.tlDataReport.push(t)},e.prototype.Buried=function(){var t,e,r,o;if(!(null==this.tlDataReport||this.tlDataReport.length<=0)&&null!=f.DataReportingHelperMgr.instance.GetDataReportingHelper().GetCreative()){try{for(var n=a(this.tlDataReport),i=n.next();!i.done;i=n.next()){var s=i.value,u=this.ModelMgr.ModelPublicData.getBuriedPointUrl(),h=this.InitBuriedPointData(s);if(s in p.SingleBuriedPointType){if(this.GetIsReport(s))continue;this.BuriedPointSet.add(s);var y=[];try{for(var d=(r=void 0,a(this.BuriedPointSet.values())),m=d.next();!m.done;m=d.next()){var v=m.value;y.push(v)}}catch(_){r={error:_}}finally{try{m&&!m.done&&(o=d.return)&&o.call(d)}finally{if(r)throw r.error}}l.EngineMain.saveLocalStorage(this.key,y.toString()),c.FW.Http.get(u,h,null,!0),c.FW.LWX.log("\u540e\u53f0\u4e8b\u4ef6\u4e0a\u62a5,",s)}else c.FW.Http.get(u,h,null,!0),c.FW.LWX.log("\u540e\u53f0\u4e8b\u4ef6\u4e0a\u62a5,",s)}}catch(S){t={error:S}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.tlDataReport=[]}},e.prototype.GetIsReport=function(t){return this.BuriedPointSet.has(t)},e.__cname="DataReporting",i([s.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([s.injectField("SDKMgr")],e.prototype,"SDKMgr",void 0),e}(p.DataReportingInterface);r.DataReporting=h,cc._RF.pop()},{"../../../../engine/EngineMain":void 0,"../../../../framework/FW":void 0,"../../../../framework/container/Container":void 0,"../../../../framework/utils/Toolset":void 0,"./DataReportingInterface":"DataReportingInterface","./helper/DataReportingHelperMgr":"DataReportingHelperMgr"}],DefaultDataReportingHelper:[function(t,e,r){"use strict";cc._RF.push(e,"c57d4pV11JFjKxX2W2l18RQ","DefaultDataReportingHelper");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.DefaultDataReportingHelper=void 0;var i=t("../../../../../engine/EngineMain"),a=t("./DataReportingHelper"),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetAPIVersion=function(){return""},e.prototype.GetClientVersion=function(){return this.appCustomData.serverVersion},e.prototype.GetCreative=function(){return this.appCustomData.channel},e.prototype.GetExtra=function(){return"1"},e.prototype.GetGameId=function(){return this.appCustomData.gameId},e.prototype.GetPhone=function(){return"1"},e.prototype.GetRatio=function(){return cc.view.getFrameSize().toString()},e.prototype.GetServerId=function(){var t,e=(null===(t=this.ModelMgr.ModelAccount.getServerAddress())||void 0===t?void 0:t.id)||0;return String(e)},e.prototype.GetSource=function(){return cc.sys.os},e.prototype.GetSystem=function(){return"1"},e.prototype.GetUdId=function(){var t=i.EngineMain.readLocalStorage("account_num","null"),e=i.EngineMain.readLocalStorage("UUID"+t,"");return""!=e&&(this._udid=e),""==this._udid&&(this._udid=a.UniqueId.createUniqueId()+"-"+this.GetPhone()+"-"+this.GetSystem()),this._udid},e.__cname="DefaultDataReportingHelper",e}(a.DataReportingHelper);r.DefaultDataReportingHelper=l,cc._RF.pop()},{"../../../../../engine/EngineMain":void 0,"./DataReportingHelper":"DataReportingHelper"}],DrawPayObj:[function(t,e,r){"use strict";cc._RF.push(e,"b7e40PNXDZDCIoeZ/pqHgKD","DrawPayObj");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.LuckDrawPayObj=r.SEquipDrawPayObj=r.DrawPayBase=void 0;var l=t("../../../../framework/FW"),s=t("../../ctrl/main/mall/TabMall"),c=t("./PayObj"),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.RedefinitionType=function(){},e.prototype.GetDrawState=function(t){return t[1]?this.ModelMgr.ModelGoods.GetGoodsNumberByRefId(t[0].resId)>=t[0].number?s.DrawState.prop:s.DrawState.Gem:s.DrawState.prop},e.__cname="DrawPayBase",e}(c.PayObj);r.DrawPayBase=u;var p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.Auth=function(){return i(this,void 0,Promise,function(){var t,e,r;return a(this,function(){return(t=this._payInfo).maxDrawCount-t.drawCount>=t.type?this.GetDrawState(t.cost)==s.DrawState.prop?(this._cmd={mallId:t.mallId,resId:t.resId,type:s.DrawState.prop,count:t.type==s.DrawCount.ten},[2,!0]):(e=this.ModelMgr.ModelRole.getPropertyById(t.cost[1].resId),r=t.cost[1].number,e>=r?(this._cmd={mallId:t.mallId,resId:t.resId,type:s.DrawState.Gem,count:t.type==s.DrawCount.ten},[2,!0]):(this.tipsInfo={type:c.TipsType.buyTips,resId:t.cost[1].resId,currency:r-Number(e)},[2,!1])):(this.tipsInfo={type:c.TipsType.tips,context:l.FW.G_W("\u4eca\u5929\u5c0f\u9b3c\u4eec\u90fd\u7d2f\u4e86\uff0c\u8bf7\u660e\u5929\u518d\u6765\u5427~")},[2,!1])})})},e.prototype.Pay=function(){return i(this,void 0,Promise,function(){var t;return a(this,function(){return t=this._payInfo,this.ModelMgr.ModelMallSEquip.RequestMallSEquipDraw(this._cmd,t.mallchestType),[2,null]})})},e.__cname="SEquipDrawPayObj",e}(u);r.SEquipDrawPayObj=p;var f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.RedefinitionType=function(){},e.prototype.Auth=function(){return i(this,void 0,Promise,function(){var t,e,r,o,n;return a(this,function(){return(t=this._payInfo).maxDrawCount-t.drawCount>=t.type?this.GetDrawState(t.cost)==s.DrawState.prop?(e=this.ModelMgr.ModelGoods.GetGoodsNumberByRefId(t.cost[0].resId),r=t.cost[0].number,e>=r?(this._cmd={mallId:t.mallId,resId:t.resId,type:s.DrawState.prop},[2,!0]):(this.tipsInfo={type:c.TipsType.inexactEnunciation,context:l.FW.G_W("\u54ce\u5440\u5440\uff0c\u9053\u5177\u4e0d\u8db3\u4e86\uff0c\u5feb\u53bb\u51c6\u5907\u51c6\u5907\u5427~")},[2,!1])):(o=this.ModelMgr.ModelRole.getPropertyById(t.cost[1].resId),n=t.cost[1].number,o>=n?(this._cmd={mallId:t.mallId,resId:t.resId,type:s.DrawState.Gem},[2,!0]):(this.tipsInfo={type:c.TipsType.buyTips,resId:t.cost[1].resId,currency:n-Number(o)},[2,!1])):(this.tipsInfo={type:c.TipsType.inexactEnunciation,context:l.FW.G_W("\u4eca\u5929\u5c0f\u9b3c\u4eec\u90fd\u7d2f\u4e86\uff0c\u8bf7\u660e\u5929\u518d\u6765\u5427~")},[2,!1])})})},e.prototype.Pay=function(){return i(this,void 0,Promise,function(){var t;return a(this,function(){return t=this._payInfo,this.ModelMgr.ModelMallLuckDraw.RequestMallLuckDraw(this._cmd,t.mallchestType),[2,null]})})},e.__cname="LuckDrawPayObj",e}(u);r.LuckDrawPayObj=f,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../ctrl/main/mall/TabMall":"TabMall","./PayObj":"PayObj"}],EquipBehavior:[function(t,e,r){"use strict";cc._RF.push(e,"90204y7l8VAhqtIfHYOLwV2","EquipBehavior");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.EquipBehavior=void 0;var i=t("../../alert/PanelPopInfo"),a=t("./GObjGoodsBehavior"),l=new Map;l.set(1,"\u767d"),l.set(2,"\u7eff"),l.set(3,"\u84dd"),l.set(4,"\u7d2b"),l.set(5,"\u91d1"),l.set(6,"\u7ea2");var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetUrl=function(){return"ui://\u5171\u7528\u7ec4\u4ef6/\u7269\u54c1\u6846_\u88c5\u5907"},e.prototype.onReset=function(){},e.prototype.onGetIconLoader=function(){return this.com.tm("icon")},e.prototype.onIconVisible=function(t){this.onGetIconLoader().visible=t},e.prototype.onGetTypeIconLoader=function(){return this.com.tm("icon_type")},e.prototype.onTypeIconVisible=function(t){this.onGetTypeIconLoader().visible=t},e.prototype.onGetIconEffectLoader=function(){return this.com.tm("iconEffect")},e.prototype.onIconEffectVisible=function(t){this.onGetIconEffectLoader().visible=t},e.prototype.onGetUnderEffectLoader=function(){return this.com.tm("underEffect")},e.prototype.onUnderEffectVisible=function(t){this.onGetUnderEffectLoader().visible=t},e.prototype.onTitleUpdate=function(t){this.com.tm("text_name").text=t},e.prototype.onTitleVisible=function(t){this.com.tm("text_name").visible=t},e.prototype.onNumberUpdate=function(t){this.com.tm("text_number").text=t},e.prototype.onNumberVisible=function(t){this.com.tm("text_number").visible=t},e.prototype.onFrameUpdate=function(t){this.com.setSelectedPage("\u54c1\u8d28",l.get(t))},e.prototype.onFrameVisible=function(t){this.com.tm("icon_frame").visible=t},e.prototype.onPhaseVisible=function(t){this.com.setSelectedIndex("\u9636\u7ea7\u663e\u793a",t?1:0)},e.prototype.onPhaseTextUpdate=function(t){this.com.tm("text_phase").text=t},e.prototype.onLevelUpdate=function(t){this.com.tm("text_level").asTextField.setVar("level",t).flushVars()},e.prototype.onLevelVisible=function(t){this.com.setSelectedIndex("\u7b49\u7ea7\u663e\u793a",t?1:0)},e.prototype.onSVisible=function(t){this.com.tm("\u56fe\u6807_s\u7ea7\u6807\u7b7e").visible=t},e.prototype.OnGetRDComponent=function(){return this.com.tm("\u7ea2\u70b9")},e.prototype.onUpdateByGoods=function(t){this.onGetIconLoader().SetUrlByIcon(t.GetIconUrl()),this.onGetTypeIconLoader().SetUrlByIcon(t.GetTypeIconUrl()),this.onTitleUpdate(t.GetName()),this.onNumberUpdate(t.GetNumberStr()),this.onFrameUpdate(t.GetQuality()),this.onPhaseTextUpdate(String(t.GetPhase())),this.onPhaseVisible(t.GetIsShowPhase()),this.onSVisible(t.GetIsSEquip()),this.onLevelUpdate(String(t.GetLevel())),this.onLevelVisible(!1);var e=t.GetIconEffect();null!=e&&this.onGetIconEffectLoader().SetUrlByIcon(e);var r=t.GetUnderEffect();null!=r&&this.onGetUnderEffectLoader().SetUrlByIcon(r),this.onIconEffectVisible(null!=e),this.onUnderEffectVisible(null!=r)},e.prototype.onSelectedUpdate=function(t){this.com.tm("icon_selected").visible=t},e.prototype.onGrayUpdate=function(t){this.com.grayed=t},e.prototype.Clean=function(){this.onGetIconLoader().Clean(),this.onGetTypeIconLoader().Clean(),this.onGetIconEffectLoader().Clean(),this.onGetUnderEffectLoader().Clean(),this.onFrameUpdate(1),this.onNumberUpdate(""),this.onTitleUpdate(""),this.onPhaseTextUpdate(""),this.onLevelUpdate(""),this.onPhaseVisible(!1),this.onSVisible(!1),this.onLevelVisible(!1)},e.prototype.showTips=function(t,e){var r=t.GetRef(),o=e.addPanel(i.PanelPopInfo);o.SetParent(this.com),o.SetTitle(r.name),o.SetContent(r.desc),o.SetTitleVisible(!0),o.SetShowArrow(!0)},e.prototype.SetLevlUpdate=function(t){this.onLevelUpdate(t.toString()),this.onLevelVisible(!0)},e.__cname="EquipBehavior",e}(a.GObjGoodsBehavior);r.EquipBehavior=s,cc._RF.pop()},{"../../alert/PanelPopInfo":"PanelPopInfo","./GObjGoodsBehavior":"GObjGoodsBehavior"}],FguiExtendMgr:[function(t,e,r){"use strict";cc._RF.push(e,"9acffOOe7JN9LHgQAx3vyV1","FguiExtendMgr");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0});var i=t("../../../framework/FW"),a=t("../../../framework/base/ScriptObject"),l=t("../../../framework/fgui/gloader/GLoaderEx"),s=t("../../../framework/fgui/gloader/GLoaderProtocalHttp"),c=t("../../../framework/fgui/gloader/GLoaderProtocalRes"),u=t("../../../framework/fgui/gloader/GLoaderProtocalUI"),p=t("../ctrl/main/Xiulian/Entrance/GObjActivityList"),f=t("../ctrl/main/Xiulian/Entrance/GObjEntrance"),h=t("../ctrl/main/Xiulian/Entrance/GObjMonthCard"),y=t("../ctrl/main/Xiulian/friend/GObjFriendInformation"),d=t("./AppGloaderEx"),m=t("./GObjGoods"),v=t("./GObjMessagePop"),_=t("./GObjPopupFrame"),S=t("./GObjProgressBox"),g=t("./GObjRD"),b=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.initFguiExtend=function(){var t=fgui.UIObjectFactory;l.GLoaderEx.RegistProtocal("https",s.GLoaderProtocalHttp),l.GLoaderEx.RegistProtocal("http",s.GLoaderProtocalHttp),l.GLoaderEx.RegistProtocal("ui",u.GLoaderProtocalUI),l.GLoaderEx.RegistProtocal("resources",c.GLoaderProtocalRes),l.GLoaderEx.SetFairyMgr(i.FW.FairyMgr),u.GLoaderProtocalUI.SetFairyMgr(i.FW.FairyMgr),fgui.UIObjectFactory.setLoaderExtension(d.AppGloaderEx),t.setExtension("ui://\u5171\u7528\u7ec4\u4ef6/\u7269\u54c1\u6846",m.GObjGoods),t.setExtension("ui://\u5171\u7528\u7ec4\u4ef6/\u7ec4\u4ef6_\u516c\u7528_\u6d88\u606f\u6c14\u6ce1",v.GObjMessagePop),t.setExtension("ui://\u5171\u7528\u7ec4\u4ef6/\u7ec4\u4ef6_\u6c14\u6ce1\u5f39\u7a97_\u5e95\u6846",_.GObjPopupFrame),t.setExtension("ui://\u5171\u7528\u7ec4\u4ef6/\u7ec4\u4ef6_\u5171\u7528_\u901a\u7528\u8fdb\u5ea6\u6846",S.GObjProgressBox),t.setExtension("ui://\u5171\u7528\u7ec4\u4ef6/\u7ec4\u4ef6_\u516c\u7528_\u7ea2\u70b9",g.GObjRD),t.setExtension("ui://\u9996\u9875_\u4fee\u70bc_\u597d\u53cb\u7cfb\u7edf/\u7ec4\u4ef6_\u597d\u53cb_\u597d\u53cb\u4fe1\u606f",y.GObjFriendInformation),t.setExtension("ui://\u9996\u9875_\u4fee\u70bc/\u7ec4\u4ef6_\u4fee\u70bc_\u5165\u53e3\u5217\u8868",f.GObjEntrance),t.setExtension("ui://\u9996\u9875_\u4fee\u70bc/\u7ec4\u4ef6_\u4fee\u70bc_\u6d3b\u52a8\u4e2d\u5fc3",p.GObjActivityList),t.setExtension("ui://\u5145\u503c\u529f\u80fd_\u6708\u5361/\u7ec4\u4ef6_\u6708\u5361_\u6708\u5361item",h.GObjMonthCard)},e.instance=new e,e}(a.ScriptObject);r.default=b,cc._RF.pop()},{"../../../framework/FW":void 0,"../../../framework/base/ScriptObject":void 0,"../../../framework/fgui/gloader/GLoaderEx":void 0,"../../../framework/fgui/gloader/GLoaderProtocalHttp":void 0,"../../../framework/fgui/gloader/GLoaderProtocalRes":void 0,"../../../framework/fgui/gloader/GLoaderProtocalUI":void 0,"../ctrl/main/Xiulian/Entrance/GObjActivityList":"GObjActivityList","../ctrl/main/Xiulian/Entrance/GObjEntrance":"GObjEntrance","../ctrl/main/Xiulian/Entrance/GObjMonthCard":"GObjMonthCard","../ctrl/main/Xiulian/friend/GObjFriendInformation":"GObjFriendInformation","./AppGloaderEx":"AppGloaderEx","./GObjGoods":"GObjGoods","./GObjMessagePop":"GObjMessagePop","./GObjPopupFrame":"GObjPopupFrame","./GObjProgressBox":"GObjProgressBox","./GObjRD":"GObjRD"}],FightScript:[function(t,e,r){"use strict";cc._RF.push(e,"368ee+kOmVFBJC1g6biCv2b","FightScript");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},l=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.FightScript=void 0;var s=t("../../../../../framework/coroutine/Cor"),c=t("../GuideSectionMgr"),u=t("./GuideScript"),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isEnterClickUI=!1,e}return n(e,t),e.prototype.OnEnter_cor=function(e){return i(this,void 0,void 0,function(){var r,o,n,i=this;return a(this,function(a){switch(a.label){case 0:return t.prototype.OnEnter_cor.call(this,e),[4,s.Cor.Wait_cor(e,function(){return null!=i.GetCom()})];case 1:return a.sent(),null==(r=this.GetCom())?[2]:(o=function(){i.destroyed||(i.isClickChoose=!0)},n=function(){i.destroyed||(i.isClickUnChoose=!0)},r.tm("\u7ec4\u4ef6_\u70b9\u51fb\u533a\u57df").setClick(o,this),r.tm("\u7ec4\u4ef6_\u70b9\u51fb\u533a\u57df").on(fgui.Event.TOUCH_BEGIN,o,this),r.tm("\u7ec4\u4ef6_\u906e\u6321\u533a\u57df").setClick(n,this),this.toolSet.addDefer(function(){r.tm("\u7ec4\u4ef6_\u70b9\u51fb\u533a\u57df").removeClick(),r.tm("\u7ec4\u4ef6_\u906e\u6321\u533a\u57df").removeClick(),r.setSelectedPage("\u7ec4\u4ef6_\u526f\u672c\u5f15\u5bfc","\u5426")}),[2])}})})},e.prototype.OnRun_cor=function(t){return i(this,void 0,void 0,function(){var e,r=this;return a(this,function(o){switch(o.label){case 0:return this.CtrlMgr.CtrlGuide.LayerGuide.SetOpaque(!0),this.TimeUtil.now(),c.GuideSectionMgr.isCanStopGuide&&(c.GuideSectionMgr.isCanStopGuide=!1),e=this.TimeUtil.now(),[4,s.Cor.Wait_cor(t,function(){return r.GetCanStart()||r.TimeUtil.now()-e>10})];case 1:return o.sent(),this.log("getcanStart:",this.GetCanStart()),0==this.GetCanStart()?[2]:(this.frameCount=cc.director.getTotalFrames(),[4,s.Cor.Wait_cor(t,function(){return r.Update()||r.GetCanFinish()})]);case 2:return o.sent(),this.GetCanFinish(),[2]}})})},e.prototype.onDestroy=function(){var e=this.GetCom();null!=e&&(e.setSelectedPage("\u662f\u5426\u526f\u672c\u5f15\u5bfc","\u5426"),e.setSelectedPage("\u663e\u793a\u52a8\u6548","\u5426")),this.isClickChoose=!1,this.isClickUnChoose=!1,t.prototype.onDestroy.call(this)},e.prototype.Update=function(){var t=this.GetClickGObject();if(!t)return!1;if(null==this.GetCom())return!1;this.OnShowEffectAndSetPosition(t);var e=this.isClickChoose;if(e){this.isEnterClickUI=!0;var r=cc.director.getTotalFrames();if(null==this.frameCount||this.frameCount==r)return!1;var o=t.asButton;null!=o?o.fireClick():t.onClick.call(this)}if(this.isClickUnChoose){this.isClickUnChoose=!1;var n=this.GetCom();n.setSelectedPage("\u663e\u793a\u52a8\u6548","\u5426"),n.setSelectedPage("\u663e\u793a\u52a8\u6548","\u662f")}return this.reSult=e&&u.GuideScriptResult.NORMAL||null,e},e.prototype.GetClickGObject=function(){var t,e=this.GetCom();return null==e?null:null==(t=e.tm("\u7ec4\u4ef6_\u526f\u672c\u5f15\u5bfc.\u70b9\u51fb\u4f4d\u7f6e"))?null:t},e.prototype.OnShowEffectAndSetPosition=function(t){var e=this.GetCom(),r=l(this.GetObjToRootXYAndWH(t),4),o=r[0],n=r[1],i=r[2],a=r[3],s=o+i/2,c=n+a/2;e.tm("\u7ec4\u4ef6_\u70b9\u51fb\u533a\u57df").setPosition(o+i/2,n+a/2),e.tm("\u7ec4\u4ef6_\u70b9\u51fb\u533a\u57df").setSize(i+400,a+400),e.tm("\u53ef\u89c6\u5316").setPosition(o+i/2,n+a/2),e.tm("\u53ef\u89c6\u5316").setSize(i+400,a+400),e.tm("\u5f3a\u5236\u70b9\u51fb\u63d0\u793a").setPosition(s,c),e.setSelectedPage("\u662f\u5426\u526f\u672c\u5f15\u5bfc","\u662f")},e.prototype.GetObjToRootXYAndWH=function(t){var e=0,r=0,o=t.width,n=t.height;t.pivotAsAnchor&&(e=-t.pivotX*t.width,r=-t.pivotY*t.height,o=(1-t.pivotX)*t.width,n=(1-t.pivotY)*t.height);var i=t.localToGlobal(e,r),a=t.localToGlobal(o,n),l=a.x-i.x,s=a.y-i.y;return[i.x,i.y,l,s]},e.prototype.GetCanStart=function(){return null!=this.GetCom()},e.prototype.GetCanFinish=function(){return null==this.GetCom()},e.__cname="FightScript",e}(u.GuideScript);r.FightScript=p,cc._RF.pop()},{"../../../../../framework/coroutine/Cor":void 0,"../GuideSectionMgr":"GuideSectionMgr","./GuideScript":"GuideScript"}],FirstBattleSection:[function(t,e,r){"use strict";cc._RF.push(e,"fd023I2TwRDYZSquTHRRHwb","FirstBattleSection");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.FirstBattleSection=void 0;var l=t("../../../../../framework/container/Container"),s=t("../GuideSection"),c=t("../Util/FightScript"),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnMain_cor=function(t){return i(this,void 0,void 0,function(){var e;return a(this,function(r){switch(r.label){case 0:return this.log("\u5728\u5f15\u5bfc"),e=new c.FightScript,l.Container.inst().inject(e),[4,e.OnEnter_cor(t)];case 1:return r.sent(),[4,e.RunAndDispose_cor(t)];case 2:return r.sent(),this.log("\u7ed3\u675f\u5f15\u5bfc"),[2]}})})},e.__cname="FirstBattleSection",e}(s.GuideSection);r.FirstBattleSection=u,cc._RF.pop()},{"../../../../../framework/container/Container":void 0,"../GuideSection":"GuideSection","../Util/FightScript":"FightScript"}],FirstEnterGame:[function(t,e,r){"use strict";cc._RF.push(e,"3cf9aJ+WrJMsJr05NLT58Wg","FirstEnterGame");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.FirstEnterGameSection=void 0;var s=t("../../../../../framework/container/Container"),c=t("../../../../../framework/coroutine/Cor"),u=t("../../../../generated/netProto/CmdInterface"),p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnMain_cor=function(t){return a(this,void 0,void 0,function(){var e,r=this;return l(this,function(o){switch(o.label){case 0:return this.LayerHeroGet.SetHero(400001),this.LayerHeroGet.load(),[4,c.Cor.Wait_cor(t,function(){return null!=r.LayerHeroGet.ui})];case 1:return o.sent(),this.LayerGuide.SetOpaque(!0),[4,c.Cor.Wait_cor(t,function(){return null==r.LayerHeroGet.ui})];case 2:return o.sent(),this.LayerGuide.SetOpaque(!1),[4,this.ModelMgr.ModelFuben.RequestFuben(101,u.CmdFuBenType.CHAPTER)];case 3:return o.sent()?[4,this.ModelMgr.ModelFuben.RequestFubenEnter()]:[3,5];case 4:e=o.sent(),this.CtrlMgr.CtrlBattle.StartByNet(e),o.label=5;case 5:return[2]}})})},e.__cname="FirstEnterGameSection",i([s.injectField("LayerHeroGet")],e.prototype,"LayerHeroGet",void 0),i([s.injectField("LayerGuide")],e.prototype,"LayerGuide",void 0),i([s.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([s.injectField("CtrlMgr")],e.prototype,"CtrlMgr",void 0),e}(t("../GuideSection").GuideSection);r.FirstEnterGameSection=p,cc._RF.pop()},{"../../../../../framework/container/Container":void 0,"../../../../../framework/coroutine/Cor":void 0,"../../../../generated/netProto/CmdInterface":"CmdInterface","../GuideSection":"GuideSection"}],FirstEnterMallSection:[function(t,e,r){"use strict";cc._RF.push(e,"d3964VgXrlEYoyEHqjiBoWN","FirstEnterMallSection");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.FirstEnterMallSection=void 0;var l=t("../../../../../framework/container/Container"),s=t("../../main/LayerMain"),c=t("../../main/mall/TabMall"),u=t("../GuideSection"),p=t("../Util/ClickScript"),f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnMain_cor=function(t){return i(this,void 0,void 0,function(){var e;return a(this,function(r){switch(r.label){case 0:return e=new p.ClickScript,l.Container.inst().inject(e),[4,e.OnEnter_cor(t)];case 1:return r.sent(),e.layerClazz=s.LayerMain,e.tabClazz=c.TabMall,e.clickUrl=function(t){var e=t.tm("\u5217\u8868_\u5546\u5e97\u7c7b\u578b");if(null!=e){var r=e.getChildAt(0);return r&&r.asCom.tm("\u6309\u94ae_\u53f3\u7bad\u5934")}return null},e.EnableClickOutSizeQuit(),[4,e.RunAndDispose_cor(t)];case 2:return r.sent(),[2]}})})},e.__cname="FirstEnterMallSection",e}(u.GuideSection);r.FirstEnterMallSection=f,cc._RF.pop()},{"../../../../../framework/container/Container":void 0,"../../main/LayerMain":"LayerMain","../../main/mall/TabMall":"TabMall","../GuideSection":"GuideSection","../Util/ClickScript":"ClickScript"}],FirstSelectBattleSkillSection:[function(t,e,r){"use strict";cc._RF.push(e,"813223vB0FJubUq2anyzxrn","FirstSelectBattleSkillSection");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.FirstSelectBattleSkillSection=void 0;var l=t("../../../../../framework/container/Container"),s=t("../GuideSection"),c=t("../Util/FightScript"),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnMain_cor=function(t){return i(this,void 0,void 0,function(){var e;return a(this,function(r){switch(r.label){case 0:return this.log("\u5728\u5f15\u5bfc"),e=new c.FightScript,l.Container.inst().inject(e),[4,e.OnEnter_cor(t)];case 1:return r.sent(),[4,e.RunAndDispose_cor(t)];case 2:return r.sent(),this.log("\u7ed3\u675f\u5f15\u5bfc"),[2]}})})},e.__cname="FirstSelectBattleSkillSection",e}(s.GuideSection);r.FirstSelectBattleSkillSection=u,cc._RF.pop()},{"../../../../../framework/container/Container":void 0,"../GuideSection":"GuideSection","../Util/FightScript":"FightScript"}],FlipPrefabBehavior:[function(t,e,r){"use strict";cc._RF.push(e,"83c90kwNKFIg4oa9nw+X4DT","FlipPrefabBehavior");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.FlipPrefabBehavior=void 0;var a=t("../../../../../../../framework/container/Container"),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.Update=function(t,e){var r=this.ComPos.d,o=this.ComPos.x,n=this.ComPos.y,i=180*r[e]/Math.PI;i<0&&(i+=360);var a=0<=i&&i<=90||270<=i%360;t.SetPropertype("flip",!a),t.SetXY(o[e],n[e])},e.__cname="FlipPrefabBehavior",i([a.injectField("ComPos")],e.prototype,"ComPos",void 0),e}(t("./BasePrefabBehavior").BasePrefabBehavior);r.FlipPrefabBehavior=l,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"./BasePrefabBehavior":"BasePrefabBehavior"}],GObjActivityList:[function(t,e,r){"use strict";cc._RF.push(e,"aa1eeJqpA1BiJYAayB67im2","GObjActivityList");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.GObjActivityList=void 0;var l=t("../../../../../../framework/container/Container"),s=t("../../../../../../framework/fgui/common/ViewExtend"),c=t("../../../../../../framework/utils/Toolset"),u=function(t){function e(){var e=t.call(this)||this;return e.toolSet=c.ToolSet.createToolSet(),e.toolSet.addTimer(.1,e.Update),e.ModelMgr=l.Container.inst().get("ModelMgr"),e}return n(e,t),e.prototype.onDestroy=function(){c.ToolSet.destroyToolSet(this.toolSet),this.toolSet=null},e.prototype.Init=function(t,e){var r,o,n=this;this.belondType=t,this.tlShowEntrance=[],this.uiParent=e;var i=this.ModelMgr.ModelActivity.GetTlAo(function(e){return!(e.GetBelond()!=t||!e.GetCanShow())});try{for(var l=a(i),s=l.next();!s.done;s=l.next()){var c=s.value;this.tlShowEntrance.push({activityId:c.GetId(),icon:c.GetIcon(),order:c.GetOrder()})}}catch(u){r={error:u}}finally{try{s&&!s.done&&(o=l.return)&&o.call(l)}finally{if(r)throw r.error}}this.UpdateList(),this.toolSet.addListener(this.ModelMgr.ModelActivity.eventProxy,"OnAdd",function(e){n.ActivityVisiable(e.GetId())||e.GetBelond()==t&&e.GetCanShow()&&(n.tlShowEntrance.push({activityId:e.GetId(),icon:e.GetIcon(),order:e.GetOrder()}),n.isDirty=!0)}),this.toolSet.addListener(this.ModelMgr.ModelActivity.eventProxy,"OnUpdate",function(e){n.ActivityVisiable(e.GetId())||e.GetBelond()==t&&e.GetCanShow()&&(n.tlShowEntrance.push({activityId:e.GetId(),icon:e.GetIcon(),order:e.GetOrder()}),n.isDirty=!0)}),this.toolSet.addListener(this.ModelMgr.ModelActivity.eventProxy,"OnRemove",function(t){n.ActivityVisiable(t)&&n.RemoveActivityEntrance(t)})},e.prototype.Update=function(){this.isDirty&&null!=this.belondType&&(this.isDirty=!1,this.UpdateList())},e.prototype.UpdateList=function(){var t=this;this.toolSet.RemoveAllScriptListener(),this.tlShowEntrance.sort(function(t,e){var r=t.order,o=e.order;return r!=o&&r<o?1:0});var e=this.tlShowEntrance,r=this.tm("list").asList;r.init(this,function(e,r,o){r.asCom.tm("icon").SetUrlByIcon(o.icon),o.effect&&r.asCom.tm("effect").SetUrlByIcon(o.effect);var n=r.tm("\u7ea2\u70b9");o.rdExer?t.toolSet.AddScriptListener(o.rdExer,function(e){t.uiParent.log("\u6d3b\u52a8\u7ea2\u70b9\u5237\u65b0expr:",o.rdExer),t.uiParent.log("\u6d3b\u52a8\u7ea2\u70b9\u5237\u65b0rdNum:",e),n.OnRDUpdate(e)},t):n.OnRDUpdate(0)},function(e,r,o){o.activityId&&t.CtrlMgr.CtrlActivity.Load(o.activityId)}),r.update(e),r.resizeToFit()},e.prototype.ActivityVisiable=function(t){var e,r;if(null==this.tlShowEntrance)return!1;try{for(var o=a(this.tlShowEntrance),n=o.next();!n.done;n=o.next())if(n.value.activityId==t)return!0}catch(i){e={error:i}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return!1},e.prototype.RemoveActivityEntrance=function(t){for(var e=0;e<this.tlShowEntrance.length;e++){var r=this.tlShowEntrance[e];if(r.activityId&&r.activityId==t){this.tlShowEntrance.splice(e,1),this.isDirty=!0;break}}},e.__cname="GObjActivityList",e.url="ui://\u9996\u9875_\u4fee\u70bc/\u7ec4\u4ef6_\u4fee\u70bc_\u6d3b\u52a8\u4e2d\u5fc3",i([l.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([l.injectField("CtrlMgr")],e.prototype,"CtrlMgr",void 0),e}(s.default);r.GObjActivityList=u,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../../../../../framework/fgui/common/ViewExtend":void 0,"../../../../../../framework/utils/Toolset":void 0}],GObjEntrance:[function(t,e,r){"use strict";cc._RF.push(e,"7fd4fZtRZtKhqHMmKjqlHbv","GObjEntrance");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.GObjEntrance=r.BelondType=void 0;var l=t("../../../../../../framework/container/Container"),s=t("../../../../../../framework/fgui/common/ViewExtend"),c=t("../../../../../../framework/utils/Toolset");(function(t){t[t.other=0]="other",t[t.left=1]="left",t[t.pop=2]="pop",t[t.activity=3]="activity",t[t.right=4]="right",t[t.SingleButton=5]="SingleButton",t[t.bottomButton=6]="bottomButton"})(r.BelondType||(r.BelondType={}));var u=function(t){function e(){var e=t.call(this)||this;e.childMap=new Map;var r=e;return e.toolSet=c.ToolSet.createToolSet(),e.toolSet.addTimer(.1,function(){r.Update()}),e.ModelMgr=l.Container.inst().get("ModelMgr"),e}return n(e,t),e.prototype.onDestroy=function(){c.ToolSet.destroyToolSet(this.toolSet),this.toolSet=null},e.prototype.GetchildByResId=function(t){return this.childMap.get(t)},e.prototype.Init=function(t,e){var r=this;this.belondType=t,this.tlShowEntrance=[],this.uiParent=e,this.Ref=l.Container.inst().getByAlias("Ref"),this.Ref.RefMgropen.preloadRef().then(function(){var e,o,n,i,l=r.Ref.RefMgropen.getTlRef("belond",t),s=r.ModelMgr.ModelSystem;r.uiParent.log("\u521d\u59cb\u5316GObjEntrance\u7cfb\u7edf\u5165\u53e3");try{for(var c=a(l||[]),u=c.next();!u.done;u=c.next()){var p=u.value,f=s.GetSystem(p.refId);f.GetVisibleConditionSet().GetBool()&&r.tlShowEntrance.push({systemId:p.refId,order:p.order,effect:null,icon:f.GetIcon(),url:p.url,rdExer:f.GetRDExpr()})}}catch(_){e={error:_}}finally{try{u&&!u.done&&(o=c.return)&&o.call(c)}finally{if(e)throw e.error}}var h=r.ModelMgr.ModelActivity.GetTlAo(function(e){return!(e.GetBelond()!=t||!e.GetCanShow())});try{for(var y=a(h),d=y.next();!d.done;d=y.next()){var m=d.value,v=r.CtrlMgr.CtrlActivity.GetRDExprByActivityKind(m.GetActivityKind());r.tlShowEntrance.push({activityId:m.GetId(),icon:m.GetIcon(),order:m.GetOrder(),effect:m.GetEffect(),rdExer:v})}}catch(S){n={error:S}}finally{try{d&&!d.done&&(i=y.return)&&i.call(y)}finally{if(n)throw n.error}}r.UpdateList()}),this.toolSet.addListener(this.ModelMgr.ModelSystem.eventProxy,"visiableUpdate",function(e){if(e.GetBelond()==t){if(e.GetVisibleConditionSet().GetBool()){if(r.SystemVisiable(e.GetRefId()))return;r.tlShowEntrance.push({systemId:e.GetRefId(),order:e.GetOrder(),icon:e.GetIcon(),url:e.GetUrl(),rdExer:e.GetRDExpr(),effect:e.GetEffect()})}else{if(!r.SystemVisiable(e.GetRefId()))return;r.RemoveSystemEntrance(e.GetRefId())}r.isDirty=!0}}),this.toolSet.addListener(this.ModelMgr.ModelActivity.eventProxy,"OnAdd",function(e){r.ActivityVisiable(e.GetId())||e.GetBelond()==t&&e.GetCanShow()&&(r.tlShowEntrance.push({activityId:e.GetId(),icon:e.GetIcon(),order:e.GetOrder(),effect:e.GetEffect()}),r.isDirty=!0)}),this.toolSet.addListener(this.ModelMgr.ModelActivity.eventProxy,"OnUpdate",function(e){r.ActivityVisiable(e.GetId())||e.GetBelond()==t&&e.GetCanShow()&&(r.tlShowEntrance.push({activityId:e.GetId(),icon:e.GetIcon(),order:e.GetOrder(),effect:e.GetEffect()}),r.isDirty=!0)}),this.toolSet.addListener(this.ModelMgr.ModelActivity.eventProxy,"OnRemove",function(t){r.ActivityVisiable(t)&&r.RemoveActivityEntrance(t)})},e.prototype.Update=function(){this.isDirty&&null!=this.belondType&&(this.isDirty=!1,this.UpdateList())},e.prototype.UpdateList=function(){var t=this;this.toolSet.RemoveAllScriptListener(),this.tlShowEntrance.sort(function(t,e){var r=t.order,o=e.order;return r!=o&&r<o?1:0});var e=this.tlShowEntrance,r=this.tm("list").asList;this.childMap.clear(),r.init(this,function(e,r,o){var n=r.asCom;t.childMap.set(o.systemId,n),n.tm("icon").SetUrlByIcon(o.icon),o.effect&&n.tm("effect").SetUrlByIcon(o.effect);var i=n.tm("\u7ea2\u70b9");o.rdExer?t.toolSet.AddScriptListener(o.rdExer,function(t){i.OnRDUpdate(t)},t):i.OnRDUpdate(0)},function(e,r,o){o.systemId?t.CtrlMgr.CtrlSystem.Load(o.systemId):o.activityId&&t.CtrlMgr.CtrlActivity.Load(o.activityId)}),r.update(e),r.resizeToFit()},e.prototype.ActivityVisiable=function(t){var e,r;if(null==this.tlShowEntrance)return!1;try{for(var o=a(this.tlShowEntrance),n=o.next();!n.done;n=o.next())if(n.value.activityId==t)return!0}catch(i){e={error:i}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return!1},e.prototype.SystemVisiable=function(t){var e,r;if(null==this.tlShowEntrance)return!1;try{for(var o=a(this.tlShowEntrance),n=o.next();!n.done;n=o.next())if(n.value.systemId==t)return!0}catch(i){e={error:i}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return!1},e.prototype.RemoveActivityEntrance=function(t){for(var e=0;e<this.tlShowEntrance.length;e++){var r=this.tlShowEntrance[e];if(r.activityId&&r.activityId==t){this.tlShowEntrance.splice(e,1),this.isDirty=!0;break}}},e.prototype.RemoveSystemEntrance=function(t){for(var e=0;e<this.tlShowEntrance.length;e++){var r=this.tlShowEntrance[e];if(r.systemId&&r.systemId==t){this.tlShowEntrance.splice(e,1),this.isDirty=!0;break}}},e.__cname="GObjEntrance",e.url="ui://\u9996\u9875_\u4fee\u70bc/\u7ec4\u4ef6_\u4fee\u70bc_\u5165\u53e3\u5217\u8868",i([l.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([l.injectField("Ref")],e.prototype,"Ref",void 0),i([l.injectField("CtrlMgr")],e.prototype,"CtrlMgr",void 0),e}(s.default);r.GObjEntrance=u,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../../../../../framework/fgui/common/ViewExtend":void 0,"../../../../../../framework/utils/Toolset":void 0}],GObjFriendInformation:[function(t,e,r){"use strict";cc._RF.push(e,"79c4blTPMFFfqQEaNtBFU7d","GObjFriendInformation");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.GObjFriendInformation=void 0;var a=t("../../../../../../framework/container/Container"),l=t("../../../../../../framework/fgui/common/ViewExtend"),s=t("../../../../../../framework/FW"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.SetFriendDetail=function(t){this._friendDetail=t},e.prototype.GetFriendDetail=function(){return this._friendDetail},e.prototype.UpdateByFirendInfo=function(t,e){if(void 0===e&&(e=!0),null==t)return null;this.SetFriendDetail(t);var r=this.ModelMgr.ModelHead.GetIconByitemId(t.roleImg),o=this.ModelMgr.ModelHead.GetIconByitemId(t.headFrame);if(this.com.tm("icon_head").SetUrlByIcon(r),this.com.tm("icon_frame").SetUrlByIcon(o),this.com.tm("\u6587\u672c_\u4fee\u70bc\u503c").asTextField.setVar("value",String(t.power)).flushVars(),this.com.tm("\u6587\u672c_\u73a9\u5bb6\u540d\u79f0").text=t.roleName,e){var n=t.online;if(this.com.setSelectedIndex("\u5728\u7ebf\u72b6\u6001",n?0:1),!n){var i=this.TimeUtil.now()-.001*t.lastOfflineTime,a=this.TimeUtil.timeSec2HMSStr15(i);this.com.tm("\u6587\u672c_\u79bb\u7ebf\u65f6\u95f4").asTextField.setVar("time",a).flushVars()}}else this.com.setSelectedIndex("\u5728\u7ebf\u72b6\u6001",2)},e.prototype.ClickRoleDetail=function(){var t=this;t.com.tm("\u6309\u94ae_\u8be6\u60c5").setClick(function(){null!=t._friendDetail?(t.LayerPlayerDetail.SetRoleId(t._friendDetail.roleId),t.LayerPlayerDetail.load()):s.FW.LWX.log("\u70b9\u51fb\u7684\u89d2\u8272\u4fe1\u606f\u4e3a\u7a7a")},t)},e.prototype.dispose=function(){this._friendDetail=null},e.__cname="GObjFriendInformation",i([a.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([a.injectField("TimeUtil")],e.prototype,"TimeUtil",void 0),i([a.injectField("LayerPlayerDetail")],e.prototype,"LayerPlayerDetail",void 0),e}(l.default);r.GObjFriendInformation=c,cc._RF.pop()},{"../../../../../../framework/FW":void 0,"../../../../../../framework/container/Container":void 0,"../../../../../../framework/fgui/common/ViewExtend":void 0}],GObjGoodsBehavior:[function(t,e,r){"use strict";cc._RF.push(e,"8470902/mhKeZaOX01OIzYH","GObjGoodsBehavior");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.GObjGoodsBehavior=void 0;var i=t("../../../../../framework/FW"),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.init=function(){this.com=i.FW.FairyMgr.createCom(this.GetUrl()).asCom,this.onInit(),this.reset()},e.prototype.destroy=function(){this.com.destroy(),this.com=null,t.prototype.destroy.call(this)},e.prototype.enter=function(t){this.gobjGoods=t,this.com.setScale(t.width/this.com.width,t.height/this.com.height),t.addChildAt(this.com,0)},e.prototype.exit=function(){this.reset(),this.com.setScale(1,1),this.com.removeFromParent(),this.gobjGoods=null},e.prototype.reset=function(){this.onReset(),this.onIconVisible(!0),this.onGetIconLoader().Clean(),this.onFrameVisible(!0),this.onFrameUpdate(1),this.onNumberUpdate(""),this.onNumberVisible(!0),this.onTitleUpdate(""),this.onTitleVisible(!1),this.onGrayUpdate(!1),this.onSelectedUpdate(!1)},e.prototype.onInit=function(){},e.prototype.onDestroy=function(){},e.prototype.onIconEffectVisible=function(t){this.onGetIconEffectLoader().visible=t},e.prototype.onUnderEffectVisible=function(t){this.onGetUnderEffectLoader().visible=t},e.__cname="GObjGoodsBehavior",e}(t("../../../../../framework/base/ScriptObject").ScriptObject);r.GObjGoodsBehavior=a,cc._RF.pop()},{"../../../../../framework/FW":void 0,"../../../../../framework/base/ScriptObject":void 0}],GObjGoods:[function(t,e,r){"use strict";cc._RF.push(e,"ce595idxnxH14K9Iie14InT","GObjGoods");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.GObjGoods=void 0;var a=t("../../../framework/container/Container"),l=t("../../../framework/fgui/common/ViewExtend"),s=t("../ctrl/goods/behavior/EquipBehavior"),c=t("../ctrl/goods/behavior/ItemBehavior"),u=t("../ctrl/goods/behavior/RuneBehavior"),p=t("../model/vo/Goods/Goods"),f=function(t){function e(){var e=t.call(this)||this;return e.com=e,e}return n(e,t),e.prototype.destroy=function(){this.OnCleanup(),t.prototype.destroy.call(this)},e.prototype.OnCleanup=function(){this.behavior&&(this.CtrlGoods.GetPool(this.behaviorClazz).returnToPool(this.behavior),this.behavior=null)},e.prototype.GetBehavior=function(){return null==this.behavior&&this.SetBehavior(c.ItemBehavior),this.behavior},e.prototype.SetBehavior=function(t){if(null!=t){if(this.behaviorClazz!=t){this.OnCleanup();var e=this.CtrlGoods.GetPool(t);this.behaviorClazz=t,this.behavior=e.getFromPool(this)}}else this.OnCleanup()},e.prototype.UpdateByGoods=function(t){if(null==t){var e=this.GetBehavior();return null!=e&&e.Clean(),null}switch(t.GetGoodsType()){case p.EGoodsType.atkRune:case p.EGoodsType.defRune:this.SetBehavior(u.RuneBehavior);break;case p.EGoodsType.weapon:case p.EGoodsType.armor:case p.EGoodsType.amulet:case p.EGoodsType.belt:case p.EGoodsType.glove:case p.EGoodsType.shoe:this.SetBehavior(s.EquipBehavior);break;default:this.SetBehavior(c.ItemBehavior)}var r=this.GetBehavior();return null!=r&&r.onUpdateByGoods(t),t},e.prototype.ClickItem=function(t,e,r){var o=this;t?this.com.setClick(function(){var t=o.GetBehavior();t&&t.showTips(e,r)},this):this.com.removeClick()},e.prototype.PlayLight=function(){this.com.tmt("\u626b\u5149").play()},e.__cname="GObjGoods",i([a.injectField("CtrlGoods")],e.prototype,"CtrlGoods",void 0),e}(l.default);r.GObjGoods=f,cc._RF.pop()},{"../../../framework/container/Container":void 0,"../../../framework/fgui/common/ViewExtend":void 0,"../ctrl/goods/behavior/EquipBehavior":"EquipBehavior","../ctrl/goods/behavior/ItemBehavior":"ItemBehavior","../ctrl/goods/behavior/RuneBehavior":"RuneBehavior","../model/vo/Goods/Goods":"Goods"}],GObjMessagePop:[function(t,e,r){"use strict";cc._RF.push(e,"e5eebCMtZlKt7NN9TinxlKb","GObjMessagePop");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.GObjMessagePop=void 0;var i=t("../../../framework/fgui/common/ViewExtend"),a=t("../../../framework/fgui/UIPackageProxy"),l=t("../../../framework/FW"),s=t("../../../framework/utils/Toolset"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.destroy=function(){s.ToolSet.destroyToolSet(this.toolSet),this.toolSet=null,t.prototype.destroy.call(this)},e.prototype.addMessage=function(t){this.messageArray.push(t),this.isShowAni||(this.isShowAni=!0,this.showMessage())},e.prototype.GetIsUpperLimit=function(){return this.messageArray.length>=3},e.prototype.getMessage=function(){return this.messageArray.length>0?this.messageArray.shift():""},e.prototype.Init=function(t,e,r){this.toolSet=s.ToolSet.createToolSet(),this.setPackge(t),this.setItem(e),r&&this.setIcon(r),this.dataPool=[],this.messageArray=[]},e.prototype.setPackge=function(t){this.uiPacageProxy=new a.UIPackageProxy(t)},e.prototype.setItem=function(t){this.itemName=t},e.prototype.setIcon=function(t){this.iconName=t},e.prototype.GetOrCreateObj=function(){for(var t,e=0;e<this.dataPool.length;e++)if(!this.dataPool[e].isBusy){this.dataPool[e].isBusy=!0,t=this.dataPool[e].obj;break}if(!t){t=this.uiPacageProxy.createObject(this.itemName),this.com.addChild(t);var r=this.com.tm("target");t.setPosition(r.x,r.y),this.dataPool.push({obj:t,isBusy:!0})}return t.visible=!0,t},e.prototype.SetObjBusy=function(t){var e=this.dataPool.find(function(e){return e.obj==t});e&&(e.isBusy=!1),t.visible=!1},e.prototype.cleanData=function(t){t.tm("content").text=""},e.prototype.showMessage=function(){var t=this,e=(t.com,t.getMessage());if(""!=e){var r=this.GetOrCreateObj(),o=r.asCom,n=o.getTransition("\u52a8\u6548_\u6d88\u5931");if(n){o.tm("content").text=e,this.iconName&&o.tm("icon").SetUrlByIcon(this.iconName);var i=n.getTransitionTime();t.toolSet.addDelay(i/2,function(){t.showMessage()}),t.toolSet.addDelay(i,function(){t.SetObjBusy(r),t.cleanData(o)}),n.play()}else l.FW.LWX.error("\u52a8\u6548\u540d\u79f0\u4e0d\u89c4\u8303")}else t.isShowAni=!1},e.__cname="GObjMessagePop",e}(i.default);r.GObjMessagePop=c,cc._RF.pop()},{"../../../framework/FW":void 0,"../../../framework/fgui/UIPackageProxy":void 0,"../../../framework/fgui/common/ViewExtend":void 0,"../../../framework/utils/Toolset":void 0}],GObjMonthCard:[function(t,e,r){"use strict";cc._RF.push(e,"dd58aBIxO1GZJqGmfTy35KA","GObjMonthCard");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.GObjMonthCard=void 0;var a=t("../../../../../../framework/FW"),l=t("../../../../../../framework/container/Container"),s=t("../../../../../../framework/fgui/common/ViewExtend"),c=t("../../../../../../framework/utils/StringUtil"),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.Init=function(t,e){this.monthType=t,this.parentProxy=e,this.isBusy=!1,this.InitClick(),this.InitLayer(),this.InitList()},e.prototype.InitClick=function(){var t=this.com,e=this.ModelMgr.ModelMonthCard.GetMonthRefByType(this.monthType),r=this.ModelMgr.ModelPayChannel.GetPayGoodsByFormId(e.fromId),o=r.GetRmb(),n=r.GetUnit();t.tm("\u6309\u94ae_\u8d2d\u4e70.title").text=c.StringUtil.format(a.FW.G_W("{0}{1}[size=24]\u8d2d\u4e70[/size]"),o,n),t.tm("\u6309\u94ae_\u7eed\u8d39").setClick(this.onClickBuy,this),t.tm("\u6309\u94ae_\u8d2d\u4e70").setClick(this.onClickBuy,this),t.tm("\u6309\u94ae_\u9886\u53d6").setClick(this.onClickGetRewards,this),t.tm("\u6309\u94ae_\u9886\u53d6.\u7ea2\u70b9").OnRDUpdate(1)},e.prototype.InitLayer=function(){var t=this,e=t.com,r=t.ModelMgr.ModelMonthCard.GetMonthRefByType(t.monthType),o=t.ModelMgr.ModelGoods.CreateGoodsByCmd(r.everyReward),n=e.tm("\u6bcf\u65e5\u5956\u52b1.com_goods");n.UpdateByGoods(o),n.GetBehavior().onFrameVisible(!1),n.ClickItem(!0,o,t.parentProxy);var i=t.ModelMgr.ModelMall.GetGoodByFromId(r.fromId),a=t.ModelMgr.ModelGoods.CreateGoodsByCmd(i.reward[0]),l=e.tm("\u8d2d\u4e70\u5956\u52b1.com_goods");l.UpdateByGoods(a),l.GetBehavior().onFrameVisible(!1),l.ClickItem(!0,a,t.parentProxy)},e.prototype.InitList=function(){var t=this,e=t.com.tm("\u5217\u8868_\u589e\u76ca").asList;e.init(t,function(e,r,o){var n=r.asCom;n.setSelectedIndex("\u6708\u5361\u7c7b\u578b",t.monthType),n.tm("\u6587\u672c_\u589e\u76ca").text=o.desc});var r=t.ModelMgr.ModelMonthCard.GetMonthRefByType(t.monthType),o=t.ModelMgr.ModelMonthCard.GetBuffArrayByList(r.buffId);e.update(o)},e.prototype.updateLayer=function(){var t=this,e=t.com,r=t.ModelMgr.ModelMonthCard.GetMonthRefByType(t.monthType),o=this.ModelMgr.ModelVO.VOMonthCardBag.Get(r.resId);if(null!=o){var n=o.GetState();e.setSelectedIndex("\u9886\u53d6\u72b6\u6001",n);var i=t.TimeUtil.now(),a=o.GetTime(),l=t.TimeUtil.timeSec2HMSStr6(.001*a-i);e.tm("\u6587\u672c_\u5269\u4f59\u65f6\u95f4").asTextField.setVar("time",l).flushVars()}else e.setSelectedIndex("\u9886\u53d6\u72b6\u6001",0)},e.prototype.onClickBuy=function(){var t=this;if(this.isBusy)a.FW.LWX.log("\u5f53\u524d\u6309\u94ae\u6b63\u5728\u5fd9\uff0c\u8bf7\u7a0d\u540e\u70b9\u51fb");else{this.isBusy=!0;var e=this.ModelMgr.ModelMonthCard.GetMonthRefByType(this.monthType),r=this.ModelMgr.ModelMall.GetGoodByFromId(e.fromId),o=this.ModelMgr.ModelMall.GetPayChannelByKey(r.key);this.SDKMgr.getSDK().PPP(o.id,r.type,r.fromId).then(function(){t.isBusy=!1}).catch(function(){t.isBusy=!1})}},e.prototype.onClickGetRewards=function(){var t=this;if(this.isBusy)a.FW.LWX.log("\u5f53\u524d\u6309\u94ae\u6b63\u5728\u5fd9\uff0c\u8bf7\u7a0d\u540e\u70b9\u51fb");else{this.isBusy=!0;var e=this.ModelMgr.ModelMonthCard.GetMonthRefByType(this.monthType);this.ModelMgr.ModelMonthCard.RequestMonthCardReward(e.resId).then(function(){t.isBusy=!1}).catch(function(){t.isBusy=!1})}},e.__cname="GObjMonthCard",i([l.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([l.injectField("SDKMgr")],e.prototype,"SDKMgr",void 0),i([l.injectField("TimeUtil")],e.prototype,"TimeUtil",void 0),e}(s.default);r.GObjMonthCard=u,cc._RF.pop()},{"../../../../../../framework/FW":void 0,"../../../../../../framework/container/Container":void 0,"../../../../../../framework/fgui/common/ViewExtend":void 0,"../../../../../../framework/utils/StringUtil":void 0}],GObjPopupFrame:[function(t,e,r){"use strict";cc._RF.push(e,"fb32bpFG31Fy6QAF8mUY4DM","GObjPopupFrame");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.GObjPopupFrame=void 0;var i=t("../../../framework/fgui/FairyMgr"),a=t("../../../framework/fgui/common/ViewExtend"),l=new Map;l.set(i.PopInfoDirect.topleft,"arrow_1"),l.set(i.PopInfoDirect.topmid,"arrow_2"),l.set(i.PopInfoDirect.topright,"arrow_3"),l.set(i.PopInfoDirect.righttop,"arrow_4"),l.set(i.PopInfoDirect.rightmid,"arrow_5"),l.set(i.PopInfoDirect.rightbottom,"arrow_6"),l.set(i.PopInfoDirect.bottomright,"arrow_7"),l.set(i.PopInfoDirect.bottommid,"arrow_8"),l.set(i.PopInfoDirect.bottomleft,"arrow_9"),l.set(i.PopInfoDirect.leftbottom,"arrow_10"),l.set(i.PopInfoDirect.leftmid,"arrow_11"),l.set(i.PopInfoDirect.lefttop,"arrow_12");var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getArrowPos=function(){return null==this.tmArrow&&this.initArrowPos(),this.tmArrow},e.prototype.setArrowVisible=function(t){null!=this._lastdirection&&(this.com.tm(l.get(this._lastdirection)).visible=!1),this._lastdirection=t,null!=t&&(this.com.tm(l.get(t)).visible=!0)},e.prototype.initArrowPos=function(){for(var t=this.tmArrow=[],e=1;e<=12;e++){var r=e,o=this.com.tm(l.get(r)),n=new cc.Vec2(o.x,o.y);t.push({key:r,value:n})}},e.__cname="GObjPopupFrame",e}(a.default);r.GObjPopupFrame=s,cc._RF.pop()},{"../../../framework/fgui/FairyMgr":void 0,"../../../framework/fgui/common/ViewExtend":void 0}],GObjProgressBox:[function(t,e,r){"use strict";cc._RF.push(e,"d77b8yGArNENqMaTLcvdWuP","GObjProgressBox");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.GObjProgressBox=void 0;var a=t("../../../framework/FW"),l=t("../../../framework/container/Container"),s=t("../../../framework/fgui/FairyMgr"),c=t("../../../framework/fgui/common/ViewExtend"),u=new Map;u.set(0,"\u6309\u94ae_\u6d3b\u8dc3\u5b9d\u7bb11"),u.set(1,"\u6309\u94ae_\u6d3b\u8dc3\u5b9d\u7bb12"),u.set(2,"\u6309\u94ae_\u6d3b\u8dc3\u5b9d\u7bb13"),u.set(3,"\u6309\u94ae_\u6d3b\u8dc3\u5b9d\u7bb14"),u.set(4,"\u6309\u94ae_\u6d3b\u8dc3\u5b9d\u7bb15"),u.set(5,"\u6309\u94ae_\u6d3b\u8dc3\u5b9d\u7bb16"),u.set(6,"\u6309\u94ae_\u6d3b\u8dc3\u5b9d\u7bb17"),u.set(7,"\u6309\u94ae_\u6d3b\u8dc3\u5b9d\u7bb18");var p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.filer=null,e.progpressBoxData=[],e}return n(e,t),e.prototype.Init=function(t,e){var r=this,o=r.com;r.parentProxy=e,r.InitList(),r.SetBoxNumber(t.length),r.filer&&r.updateBox();for(var n=function(e){var n=u.get(e);o.tm(n).asCom.tm("title").text=t[e].name,o.tm(n).asCom.tm("effect").SetUrlByIcon("\u6309\u94ae\u7279\u6548"),o.tm(n).setClick(function(){t[e].checkListen()?(r.updatePop(t[e].rewardList),r.updatePopPos(o.tm(n))):t[e].getRewardListen()},r)},i=0;i<r.length;i++)n(i);this.progpressBoxData=t},e.prototype.updateReward=function(t){for(var e=0;e<this.progpressBoxData.length;e++)this.progpressBoxData[e].rewardList=t[e]},e.prototype.InitList=function(){var t=this;t.com.tm("\u7ec4\u4ef6_\u6c14\u6ce1.\u5217\u8868_\u5c55\u793a").asList.init(t,function(e,r,o){var n=r.asCom.tm("com_goods"),i=t.ModelMgr.ModelGoods.CreateGoodsByCmd({resId:o.resId,number:String(o.number),quality:o.quality});n.UpdateByGoods(i),n.ClickItem(!0,i,t.parentProxy)})},e.prototype.SetFilter=function(t){this.filer=t,this.updateBox()},e.prototype.SetBoxNumber=function(t){var e=Math.floor(t);e<1?e=1:e>8&&(e=8),this.length=e,this.com.setSelectedIndex("\u5b9d\u7bb1\u6570\u91cf",this.length-1)},e.prototype.updatePop=function(t){var e=this.com.tm("\u7ec4\u4ef6_\u6c14\u6ce1.\u5217\u8868_\u5c55\u793a").asList;e.update(t),e.resizeToFit()},e.prototype.updateBox=function(){var t=this,e=t.com;if(t.filer)for(var r=t.length,o=0;o<r;o++){var n=u.get(o),i=e.tm(n).asCom,l=t.filer(o);i.setSelectedIndex("\u9886\u53d6\u72b6\u6001",l)}else a.FW.LWX.error("\u8fd8\u6ca1\u6709\u6ce8\u518c\u7b5b\u9009\u65b9\u6cd5\uff0c\u65e0\u6cd5\u66f4\u65b0")},e.prototype.updateProgress=function(t,e,r){var o=this.com,n=o.tm("\u8fdb\u5ea6\u6761_\u8fdb\u5ea6").asProgress;n.value=t,e&&(n.max=e);var i=r||t.toString();o.tm("\u6587\u672c_\u8fdb\u5ea6\u6570\u91cf").text=i},e.prototype.updatePopPos=function(t){var e=this.com;e.setSelectedIndex("\u662f\u5426\u663e\u793a",1);var r=e.tm("\u7ec4\u4ef6_\u6c14\u6ce1"),o=e.tm("\u7ec4\u4ef6_\u6c14\u6ce1.com_float"),n=s.PopInfoDirect.bottommid,i=t.localToGlobal(),a=t.width/2,l=t.height/2,c=r.width/2,u=o.height/2,p=i.x+a-c,f=i.y-l-u,h=r.parent.globalToLocal(p,f);r.x=h.x,r.y=h.y,o.setArrowVisible(n)},e.__cname="GObjProgressBox",i([l.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(c.default);r.GObjProgressBox=p,cc._RF.pop()},{"../../../framework/FW":void 0,"../../../framework/container/Container":void 0,"../../../framework/fgui/FairyMgr":void 0,"../../../framework/fgui/common/ViewExtend":void 0}],GObjRD:[function(t,e,r){"use strict";cc._RF.push(e,"f2ed5xjzLRD6b/VW++G6Th0","GObjRD");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.GObjRD=r.RDType=void 0;var i,a=t("../../../framework/fgui/common/ViewExtend");(function(t){t.numberRedDot="\u6570\u5b57\u7ea2\u70b9",t.upgradeRedDot="\u7bad\u5934\u7ea2\u70b9",t.wearRedDot="\u88c5\u5907\u7a7f\u6234\u7ea2\u70b9",t.ordinaryRedDots="\u666e\u901a\u7ea2\u70b9",t.specialRedDot="\u7279\u6b8a\u7ea2\u70b9"})(i=r.RDType||(r.RDType={}));var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetRdType=function(){return this.rdType||i.ordinaryRedDots},e.prototype.RDUpdate=function(t){if(t<=0)this.com.setSelectedPage("\u662f\u5426\u663e\u793a\u7ea2\u70b9","\u4e0d\u663e\u793a");else{var e=this.GetRdType();this.com.setSelectedPage("\u7ea2\u70b9\u7c7b\u578b",e),this.com.setSelectedPage("\u662f\u5426\u663e\u793a\u7ea2\u70b9","\u663e\u793a"),e==i.numberRedDot?this.com.tm("text_RDNumber").text=t.toString():this.com.tm("text_RDNumber").text=t>1&&t.toString()||""}},e.prototype.SetRDType=function(t){this.rdType=t},e.prototype.SetRDIcon=function(t){this.com.tm("RD_Expand").SetUrlByIcon(t)},e.prototype.OnRDUpdate=function(t,e,r){null==t&&(t=0),"boolean"==typeof t&&(t=t?1:0),null!=e&&this.SetRDType(e),null!=r&&this.SetRDIcon(r),this.RDUpdate(t)},e.__cname="GObjRD",e}(a.default);r.GObjRD=l,cc._RF.pop()},{"../../../framework/fgui/common/ViewExtend":void 0}],GPAudio:[function(t,e,r){"use strict";cc._RF.push(e,"2bde2ztnC1Og5laPcFFj21J","GPAudio");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.GPAudio=void 0;var a=t("../../../../../../../framework/FW"),l=t("../../../../../../../framework/container/Container"),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tmInterval=new Map,e.bossIsDie=!1,e.isAdjust=!1,e.tmAdjust=new Map,e.tmMute=new Map,e}return n(e,t),e.prototype.OnEnter=function(){this.musicVolume=this.CtrlAudio.GetMusicVolume()},e.prototype.OnExit=function(){this.CtrlAudio.SetMusicVolume(this.musicVolume)},e.prototype.play=function(t){a.FW.playSound(t)},e.prototype.playInterval=function(t,e){e*=1e3;var r=cc.director.getTotalTime(),o=this.tmInterval.get(t);(null==o||r>=o)&&(this.tmInterval.set(t,r+e),this.play(t))},e.prototype.prop=function(){this.playInterval("\u767e\u604b_\u6218\u6597_\u62fe\u53d6\u9053\u5177",.1)},e.prototype.hit=function(){this.playInterval("\u767e\u604b_\u6218\u6597_\u51fb\u4e2d",.1)},e.prototype.hitCrit=function(){this.playInterval("\u767e\u604b_\u6218\u6597_\u51fb\u4e2d\u66b4\u51fb",.2)},e.prototype.levelup=function(){this.play("\u767e\u604b_\u6218\u6597_\u5347\u7ea7\u754c\u9762")},e.prototype.swosh=function(){this.play("\u767e\u604b_\u6218\u6597_\u51fb\u4e2d_\u91cd")},e.prototype.throwing=function(){this.playInterval("\u767e\u604b_\u6218\u6597_\u51fb\u4e2d_\u8f7b",.2)},e.prototype.lightning=function(){this.play("\u767e\u604b_\u6218\u6597_\u7535\u6d41\u58f0")},e.prototype.airflow=function(){this.play("\u767e\u604b_\u6218\u6597_\u62db\u6570\u6c14\u6d41\u58f0")},e.prototype.sword=function(){this.play("\u767e\u604b_\u6218\u6597_\u62d4\u5200")},e.prototype.boom=function(){this.play("\u767e\u604b_\u6218\u6597_\u7206\u70b8\u77ed\u4fc3")},e.prototype.click=function(){this.play("\u767e\u604b_\u70b9\u51fb")},e.prototype.die=function(){this.play("\u767e\u604b_\u6218\u6597_\u4e3b\u89d2\u6b7b\u4ea1")},e.prototype.abandon=function(){this.play("\u767e\u604b_\u6218\u6597_\u6e38\u620f\u5931\u8d25")},e.prototype.chest=function(){this.play("\u767e\u604b_\u6218\u6597_\u62fe\u53d6\u5b9d\u7bb1")},e.prototype.openDrawing=function(){this.play("\u767e\u604b_\u6218\u6597_\u6253\u5f00\u62bd\u5956")},e.prototype.tipWarn=function(){var t=this;this.tipsId?a.FW.LWX.log("\u6b63\u5728\u64ad\u653e\u9884\u8b66\u97f3\u6548\uff0c\u4e0d\u80fd\u91cd\u590d\u64ad\u653e"):(a.FW.LWX.log("\u64ad\u653e\u9884\u8b66\u97f3\u6548"),this.CtrlAudio.PauseMusic(),this.CtrlAudio.PlaySound("\u767e\u604b_\u97f3\u6548_\u7cbe\u82f1\u9884\u8b66",function(){t.resumeBoss()}).then(function(e){t.tipsId=e}))},e.prototype.battleBoss=function(){var t=this;if(this.bossId)a.FW.LWX.log("\u6b63\u5728\u64ad\u653eboss\u97f3\u6548\uff0c\u4e0d\u80fd\u91cd\u590d\u64ad\u653e");else{a.FW.LWX.log("\u64ad\u653e\u5996\u738b\u97f3\u6548"),this.tipsId&&this.CtrlAudio.Stop(this.tipsId),this.CtrlAudio.PauseMusic();var e=this.CtrlAudio.PlaySound("\u767e\u604b_\u97f3\u6548_BOSS\u9884\u8b66",function(){},!0);this.bossIsDie=!1,e.then(function(e){t.bossIsDie?t.CtrlAudio.Stop(e):t.bossId=e})}},e.prototype.resumeBoss=function(){this.tipsId&&this.CtrlAudio.Stop(this.tipsId),this.bossId&&(this.CtrlAudio.Stop(this.bossId),this.bossId=null),this.bossIsDie=!0,this.CtrlAudio.ResumeMusic()},e.prototype.drawing=function(){var t=this;this.stopDrawing();var e=this.CtrlAudio;e.PlaySound("\u767e\u604b_\u6218\u6597_\u62bd\u5956\u4e2d\u97f3\u4e50",function(){t.stopDrawing()}).then(function(r){null!=t?t._drawing=r:e.Stop(r)}),this.play("\u767e\u604b_\u6218\u6597_\u6253\u5f00\u62bd\u5956")},e.prototype.stopDrawing=function(){null!=this._drawing&&(this.CtrlAudio.Stop(this._drawing),this._drawing=null)},e.prototype.drawone=function(){this.play("\u767e\u604b_\u6218\u6597_\u62bd\u5956_\u8d70\u9a6c\u706f\u683c\u5b50")},e.prototype.adjustBGM=function(t){null!=this.musicVolume&&(this.tmAdjust.set(t,!0),this.updateBgm())},e.prototype.resumeBGM=function(t){null!=this.musicVolume&&(this.tmAdjust.delete(t),this.tmMute.delete(t),this.updateBgm())},e.prototype.muteBGM=function(t){null!=this.musicVolume&&(this.tmMute.set(t,!0),this.updateBgm())},e.prototype.updateBgm=function(){if(this.onOffMgr.OnOffMusic.GetValue()){var t=this.musicVolume;this.tmMute.size>0?t=0:this.tmAdjust.size>0&&(t=.5),this.CtrlAudio.SetMusicVolume(t)}},e.__cname="GPAudio",i([l.injectField("CtrlAudio")],e.prototype,"CtrlAudio",void 0),i([l.injectField("OnOffMgr")],e.prototype,"onOffMgr",void 0),e}(t("../SubGamePlay").SubGamePlay);r.GPAudio=s,cc._RF.pop()},{"../../../../../../../framework/FW":void 0,"../../../../../../../framework/container/Container":void 0,"../SubGamePlay":"SubGamePlay"}],GPChest:[function(t,e,r){"use strict";cc._RF.push(e,"1eee0pNZHFOVpJLT024dLgd","GPChest");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},c=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.GPChest=r.GPChestDrawType=void 0;var u,p=t("../../../../../../../framework/container/Container"),f=t("../../../../../../../framework/event/EventCallback"),h=t("../../../../../../../framework/utils/PromiseWrap"),y=t("../../../../../../../framework/utils/Toolset"),d=t("../../../../../model/goods/ModelGoods"),m=t("../../../BattleUtil"),v=t("../../common/SystemCommon"),_=t("../../event/SystemEvent"),S=t("../SubGamePlay"),g=t("./GPOItem");(function(t){t[t.GOLD=0]="GOLD",t[t.SKILL=1]="SKILL"})(u=r.GPChestDrawType||(r.GPChestDrawType={}));var b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.toolSet=y.ToolSet.createToolSet(),e.changeCallback=new f.EventCallback,e.tlRequest=[],e._gpobjs=[],e._gpobjs_temp=[],e.takeGoldChest=!1,e}return n(e,t),e.prototype.GetChangeCallback=function(){return this.changeCallback},e.prototype.OnInit=function(){},e.prototype.onDestroy=function(){y.ToolSet.destroyToolSet(this.toolSet)},e.prototype.OnEnter=function(){var t=this;this.toolSet.addListener(this.SystemEvent.GetEventPorxy(),_.EBattleEvent.GoldChest,function(e){t.tlRequest.push({type:u.GOLD,resId:e})},this),this.toolSet.addListener(this.SystemEvent.GetEventPorxy(),_.EBattleEvent.SkillChest,function(e){t.tlRequest.push({type:u.SKILL,resId:e})})},e.prototype.OnExit=function(){},e.prototype.OnUpdate=function(){var t=this;this.tlRequest.length>0&&null==this._promise&&(this._promise=this.OnUpdateInner(),this._promise.then(function(){t._promise=null}))},e.prototype.OnUpdateInner=function(){return a(this,void 0,void 0,function(){var t;return l(this,function(e){switch(e.label){case 0:this.SystemEvent.sendPaused(this),e.label=1;case 1:return this.tlRequest.length>0?(t=this.tlRequest.shift()).type!=u.GOLD?[3,3]:(this.RefreshGoldChest(t.resId),[4,this.OnShowChest()]):[3,6];case 2:return e.sent(),[3,5];case 3:return t.type!=u.SKILL?[3,5]:(this.RefreshSkillChest(t.resId),[4,this.OnShowChest()]);case 4:e.sent(),e.label=5;case 5:return[3,1];case 6:return this.SystemEvent.sendResume(this),[2]}})})},e.prototype.OnShowChest=function(){var t=this,e=new h.PromiseWrap;return this.LayerBattleChest.SetData(this.chestData),this.LayerBattleChest.load(),this.changeCallback.execute(),this.LayerBattleChest.setCloseCallBack(function(){t.ApplyReward(),e.resolve()}),e.promise},e.prototype.ApplyReward=function(){var t,e;if(null!=this.chestData){var r=this.chestData.list,o=this.chestData.reward;this.chestData.type==u.GOLD&&this.MarkTakeGoldChest();try{for(var n=s(o),i=n.next();!i.done;i=n.next())r[i.value].Apply(!0)}catch(l){t={error:l}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}if(this.chestData.gold){var a=new g.GPObjItem;this.container.inject(a),a.UpdateNumber(this.chestData.gold),a.UpdateResId(d.ECurrencyType.coin),a.Apply()}this.chestData=null}},e.prototype.RefreshGoldChest=function(t){var e,r;this.chestData={};var o=this.chestData;o.type=u.GOLD,o.list=[],o.reward=[];var n,i,a=this.ModelBattleDrop.GetGoldChest(t),l=a.param[0],c=l.weight,p=[];try{for(var f=s(l.reward),h=f.next();!h.done;h=f.next()){var y=h.value,_=this.ModelBattleDrop.GetReward(y);if(_.GetType()==v.EBProp.GOLD){var S=(n=_.GetValue(),i=void 0,i=new g.GPObjItem,this.container.inject(i),i.UpdateNumber(n),i.UpdateResId(d.ECurrencyType.coin),i);p.push(S)}}}catch(x){e={error:x}}finally{try{h&&!h.done&&(r=f.return)&&r.call(f)}finally{if(e)throw e.error}}for(var b=Math.floor(16*Math.random()),C=Math.floor(a.min+Math.random()*Math.abs(a.max-a.min)),R=Math.floor(16/C),M=p.map(function(t,e){return e}),w=new Map,O=0;O<C;O++){var B=m.BattleUtil.PrepareWeightedRandom(M,c),P=(b+O*R)%16;w.set(P,p[B]),o.reward.push(P)}var G=m.BattleUtil.Knuth(M),k=0;for(O=0;O<16;O++)w.has(O)?o.list[O]=w.get(O):(B=G[k%G.length],o.list[O]=p[B],k++)},e.prototype.RefreshSkillChest=function(t){var e,r,o,n;this.chestData={};var i=this.chestData;i.type=u.SKILL,i.list=[],i.reward=[];var a=this.ModelBattleDrop.GetSkillChest(t),l=a.map(function(t){return t.GetSkillNum()}),p=a.map(function(t){return t.GetWeight()}),f=c(m.BattleUtil.PrepareWeightedRandom2(l,p),2),h=f[0],y=a[f[1]],d=this.GPDraw.Draw_SkillChest(h),v=this.GPDraw.GetCandidate(),_=Math.floor(16*Math.random()),S=this._gpobjs;S.length=0;try{for(var g=s(d),b=g.next();!b.done;b=g.next()){var C=b.value,R=this.GPDraw.GetGPObjByHandler(C);S.push(R)}}catch(V){e={error:V}}finally{try{b&&!b.done&&(r=g.return)&&r.call(g)}finally{if(e)throw e.error}}var M=this._gpobjs_temp;M.length=0;try{for(var w=s(v),O=w.next();!O.done;O=w.next())C=O.value,R=this.GPDraw.GetGPObjByHandler(C),M.push(R)}catch(U){o={error:U}}finally{try{O&&!O.done&&(n=w.return)&&n.call(w)}finally{if(o)throw o.error}}for(var B=S.map(function(t,e){return e}),P=m.BattleUtil.Knuth(B),G=0,k=function(){var t=G,e=M;if(e.length>0){var r=e[t];return++t>=e.length&&(t=0),G=t,r}return null},x=new Map,T=0;T<h;T++){var j=P.shift();R=void 0,R=null==j?k():S[j];var I=(T+_)%16;x.set(I,R),i.reward.push(I)}for(T=0;T<16;T++){var D;D=x.has(T)?x.get(T):k(),i.list.push(D)}if(1!=this.Battle.startConfig.skillChestGoldDisable){var F=y.GetMoneyMin(),L=y.GetMoneyMax(),E=y.GetMoneyStep(),A=m.BattleUtil.PrepareRandomStep(F,L,E);i.gold=A}},e.prototype.MarkTakeGoldChest=function(){this.takeGoldChest=!0,this.GPNetSync.MarkSyncBeat(!0)},e.prototype.GetCanTakeGoldChest=function(){return 0==this.takeGoldChest},e.prototype.GetRuntimeKey=function(){return"__GPChest"},e.prototype.GetRuntimtData=function(){return""+(this.takeGoldChest?1:0)},e.prototype.ResumeRuntmeData=function(t){t&&(this.takeGoldChest="1"==t)},e.__cname="GPChest",e.GRID_COUNT=16,i([p.injectField("SystemEvent")],e.prototype,"SystemEvent",void 0),i([p.injectField("LayerBattleChest")],e.prototype,"LayerBattleChest",void 0),i([p.injectField("ModelBattleDrop")],e.prototype,"ModelBattleDrop",void 0),i([p.injectField("GPHeroSkill")],e.prototype,"GPHeroSkill",void 0),i([p.injectField("GPHeroSupply")],e.prototype,"GPHeroSupply",void 0),i([p.injectField("GPLevelUp")],e.prototype,"GPLevelUp",void 0),i([p.injectField("GPEvolution")],e.prototype,"GPEvolution",void 0),i([p.injectField("GPDraw")],e.prototype,"GPDraw",void 0),i([p.injectField("Battle")],e.prototype,"Battle",void 0),i([p.injectField("SystemSpawn")],e.prototype,"SystemSpawn",void 0),i([p.injectField("GPNetSync")],e.prototype,"GPNetSync",void 0),e}(S.SubGamePlay);r.GPChest=b,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../../../../../../framework/event/EventCallback":void 0,"../../../../../../../framework/utils/PromiseWrap":void 0,"../../../../../../../framework/utils/Toolset":void 0,"../../../../../model/goods/ModelGoods":"ModelGoods","../../../BattleUtil":"BattleUtil","../../common/SystemCommon":"SystemCommon","../../event/SystemEvent":"SystemEvent","../SubGamePlay":"SubGamePlay","./GPOItem":"GPOItem"}],GPDamageStastic:[function(t,e,r){"use strict";cc._RF.push(e,"a17dbp+hVRHCoUfEHPbm5iK","GPDamageStastic");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.GPDamageStastic=r.GPDamageStasticSaveData=r.GPDamageStasticHandler=void 0;var s=t("../../../../../../../framework/container/Container"),c=t("../../../../../../../framework/event/EventCallback"),u=t("../../../../../../../framework/utils/Toolset"),p=t("../SubGamePlay");r.GPDamageStasticHandler=function(){};r.GPDamageStasticSaveData=function(){};var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.changeEvent=new c.EventCallback,e.tmSkill=new Map,e.total=0,e._savedata={},e}return n(e,t),e.prototype.GetChangeEvent=function(){return this.changeEvent},e.prototype.OnInit=function(){this.toolSet=u.ToolSet.createToolSet()},e.prototype.onDestroy=function(){u.ToolSet.destroyToolSet(this.toolSet)},e.prototype.OnEnter=function(){var t,e,r=this;this.EnterToResumeData();try{for(var o=a(this.GPHeroSkill.GetTlSkill()),n=o.next();!n.done;n=o.next()){var i=n.value;this.AddSkillDamage(i.GetResId(),0)}}catch(l){t={error:l}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}this.toolSet.addCallback(this.SystemDamage.GetDamageCallback(),function(t){r.OnHandlerDamage(t)})},e.prototype.OnHandlerDamage=function(t){if(t.GetIsBullet()){var e=this.ComVar.HEROID,r=t.GetSkillId(),o=t.sid;if(this.ComVar.BULLET_SENDER[o]==e){var n=t.GetDamage();this.AddSkillDamage(r,n),this.changeEvent.execute()}}},e.prototype.AddSkillDamage=function(t,e){if(null!=t&&null!=this.ModelBattleSkill.GetSkill(t)){var r=this.tmSkill.get(t);null==r&&((r={}).skillId=t,r.damage=0,this.tmSkill.set(t,r)),r.damage+=e,this.total+=e;var o=0;0!=this.total&&(o=r.damage/this.total),r.rate=o}},e.prototype.GetTotal=function(){return this.total},e.prototype.GetTmSkill=function(){return this.tmSkill},e.prototype.GetRuntimeKey=function(){return"__DamageStatic"},e.prototype.GetRuntimtData=function(){var t,e,r=this._savedata;r.total=this.total,r.static=[];try{for(var o=a(this.tmSkill),n=o.next();!n.done;n=o.next()){var i=l(n.value,2),s=i[0],c=i[1];r.static.push(s),r.static.push(c.damage)}}catch(u){t={error:u}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}return JSON.stringify(r)},e.prototype.ResumeRuntmeData=function(t){if(t){var e=JSON.parse(t);if(e){this._savedata=e;var r=this._savedata;this.total=r.total}}},e.prototype.EnterToResumeData=function(){var t=this._savedata;if(null!=t&&null!=t.static){this.tmSkill.clear();for(var e=0;e<t.static.length;e+=2){var r=t.static[e],o=t.static[e+1]||0;this.AddSkillDamage(r,o)}}},e.__cname="GPDamageStastic",i([s.injectField("SystemDamage")],e.prototype,"SystemDamage",void 0),i([s.injectField("ComVar")],e.prototype,"ComVar",void 0),i([s.injectField("GPHeroSkill")],e.prototype,"GPHeroSkill",void 0),i([s.injectField("ModelBattleSkill")],e.prototype,"ModelBattleSkill",void 0),e}(p.SubGamePlay);r.GPDamageStastic=f,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../../../../../../framework/event/EventCallback":void 0,"../../../../../../../framework/utils/Toolset":void 0,"../SubGamePlay":"SubGamePlay"}],GPDradObject:[function(t,e,r){"use strict";cc._RF.push(e,"6c1acANtjlD258UwL+7Lptn","GPDradObject");var o=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.GPDrawObject=void 0;var n=function(){function t(){this.tmData=new Map,this.tmAllData=new Map}return t.prototype.UpdateData=function(t){var e,r,n=this.OnGetData();this.tmData.clear(),this.tmAllData.clear();try{for(var i=o(n),a=i.next();!a.done;a=i.next()){var l=a.value;this.tmAllData.set(l.id,l),t(l)&&this.tmData.set(l.id,l)}}catch(s){e={error:s}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}},t.prototype.GetTmData=function(){return this.tmData},t.prototype.GetTmAllData=function(){return this.tmAllData},t}();r.GPDrawObject=n,cc._RF.pop()},{}],GPDrawObjectCure:[function(t,e,r){"use strict";cc._RF.push(e,"4882dmBno5Exokf9Iej7/Ip","GPDrawObjectCure");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.GPDrawObjectCure=void 0;var a=t("../../../../../../../../framework/container/Container"),l=t("../../../../../../model/goods/ModelGoods"),s=t("../../../common/SystemCommon"),c=t("../GPOItem"),u=t("./GPDradObject"),p=t("./GPDraw"),f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._result=[],e}return n(e,t),e.prototype.OnGetData=function(){var t=this._result;t.length=0;var e=p.GPDrawHandlerType.Prop,r=p.GPDrawHandler.Create(this);return r.type=e,r.id=s.EBProp.RESTORE,r.value=10,t.push(r),t},e.prototype.GetGPObj=function(t){var e=new c.GPObjItem;return this.container.inject(e),e.UpdateNumber(t.value),e.UpdateResId(l.ECurrencyType.cure),e},e.__cname="GPDrawObjectCure",i([a.injectField("SystemCommon")],e.prototype,"SystemCommon",void 0),e}(u.GPDrawObject);r.GPDrawObjectCure=f,cc._RF.pop()},{"../../../../../../../../framework/container/Container":void 0,"../../../../../../model/goods/ModelGoods":"ModelGoods","../../../common/SystemCommon":"SystemCommon","../GPOItem":"GPOItem","./GPDradObject":"GPDradObject","./GPDraw":"GPDraw"}],GPDrawObjectGold:[function(t,e,r){"use strict";cc._RF.push(e,"59775qLXFVJNqLkpYJ77d1t","GPDrawObjectGold");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.GPDrawObjectGold=void 0;var a=t("../../../../../../../../framework/container/Container"),l=t("../../../../../../model/goods/ModelGoods"),s=t("../../../common/SystemCommon"),c=t("../GPOItem"),u=t("./GPDradObject"),p=t("./GPDraw"),f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._result=[],e}return n(e,t),e.prototype.OnGetData=function(){var t=this._result;t.length=0;var e=p.GPDrawHandlerType.Prop,r=p.GPDrawHandler.Create(this);return r.type=e,r.id=s.EBProp.GOLD,r.value=this.ModelGameConfig.GetGameConfigValueByKey("battleUpgradeGold"),t.push(r),t},e.prototype.GetGPObj=function(t){var e=new c.GPObjItem;return this.container.inject(e),e.UpdateNumber(t.value),e.UpdateResId(l.ECurrencyType.coin),e},e.__cname="GPDrawObjectGold",i([a.injectField("ModelGameConfig")],e.prototype,"ModelGameConfig",void 0),e}(u.GPDrawObject);r.GPDrawObjectGold=f,cc._RF.pop()},{"../../../../../../../../framework/container/Container":void 0,"../../../../../../model/goods/ModelGoods":"ModelGoods","../../../common/SystemCommon":"SystemCommon","../GPOItem":"GPOItem","./GPDradObject":"GPDradObject","./GPDraw":"GPDraw"}],GPDrawObjectSkill:[function(t,e,r){"use strict";cc._RF.push(e,"35b5fzjMbVFyq8FNLf9jDrB","GPDrawObjectSkill");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.GPDrawObjectSkill=void 0;var s=t("../../../../../../../../framework/container/Container"),c=t("../GPOSkill"),u=t("./GPDradObject"),p=t("./GPDraw"),f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tmTemp=new Map,e.tmEvolution=new Map,e._result=[],e._evo=[],e}return n(e,t),e.prototype.UpdateData=function(e){t.prototype.UpdateData.call(this,e),this.UpdateEvo(e)},e.prototype.OnGetData=function(){var t,e,r,o=this._result;o.length=0,p.GPDrawHandlerType.SkillOrSupply;try{for(var n=a(null===(r=this.GPHeroSkill)||void 0===r?void 0:r.GetTmUpgrade()),i=n.next();!i.done;i=n.next())for(var s=l(i.value,2),c=s[0],u=s[1],f=this.ModelBattleSkill.GetSkill(c),h=u;h<=f.GetMaxLevel();){var y=this.GetTempSkill(c);if(null==y||h==y+1){var d=p.GPDrawHandler.CreateSkill(this,c,h);o.push(d);break}h++}}catch(m){t={error:m}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}return o},e.prototype.UpdateEvo=function(t){var e,r;this.tmEvolution.clear();var o=this.OnGetDataEvo();try{for(var n=a(o),i=n.next();!i.done;i=n.next()){var l=i.value;t(l)&&(this.tmData.set(l.id,l),this.tmEvolution.set(l.id,l))}}catch(s){e={error:s}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}},e.prototype.OnGetDataEvo=function(){var t,e,r=this._evo;r.length=0,p.GPDrawHandlerType.SkillOrSupply;try{for(var o=a(this.ModelBattleSkill.GetTmEvolution()),n=o.next();!n.done;n=o.next()){var i=l(n.value,2),s=(i[0],i[1]);if(this.GPEvolution.CheckCanEvolution(s.GetId())){var c=s.GetSkillId(),u=s.GetSkillLevel(),f=p.GPDrawHandler.CreateSkill(this,c,u);r.push(f)}}}catch(h){t={error:h}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}return r},e.prototype.GetTmEvolution=function(){return this.tmEvolution},e.prototype.SetTempSkill=function(t,e){this.tmTemp.set(t,e)},e.prototype.GetTempSkill=function(t){return this.tmTemp.get(t)},e.prototype.ClearTempSkill=function(){this.tmTemp.clear()},e.prototype.GetGPObj=function(t){var e=new c.GPOSkill;return this.container.inject(e),e.UpdateLevel(t.value),e.UpdateResId(t.id),e},e.__cname="GPDrawObjectSkill",i([s.injectField("GPHeroSkill")],e.prototype,"GPHeroSkill",void 0),i([s.injectField("ModelBattleSkill")],e.prototype,"ModelBattleSkill",void 0),i([s.injectField("GPEvolution")],e.prototype,"GPEvolution",void 0),e}(u.GPDrawObject);r.GPDrawObjectSkill=f,cc._RF.pop()},{"../../../../../../../../framework/container/Container":void 0,"../GPOSkill":"GPOSkill","./GPDradObject":"GPDradObject","./GPDraw":"GPDraw"}],GPDrawObjectSupply:[function(t,e,r){"use strict";cc._RF.push(e,"a5a51q6B+NEtbxAPocjZ1EO","GPDrawObjectSupply");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.GPDrawObjectSupply=void 0;var s=t("../../../../../../../../framework/container/Container"),c=t("../GPOSupply"),u=t("./GPDradObject"),p=t("./GPDraw"),f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tmTemp=new Map,e._result=[],e}return n(e,t),e.prototype.OnGetData=function(){var t,e,r=this._result;r.length=0,p.GPDrawHandlerType.SkillOrSupply;try{for(var o=a(this.GPHeroSupply.GetTmUpgrade()),n=o.next();!n.done;n=o.next())for(var i=l(n.value,2),s=i[0],c=i[1],u=this.ModelBattleSkill.GetSupply(s),f=c;f<=u.GetMaxLevel();){var h=this.GetTempSupply(s);if(null==h||f==h+1){var y=p.GPDrawHandler.CreateSupply(this,s,f);r.push(y);break}f++}}catch(d){t={error:d}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}return r},e.prototype.SetTempSupply=function(t,e){this.tmTemp.set(t,e)},e.prototype.GetTempSupply=function(t){return this.tmTemp.get(t)},e.prototype.ClearTempSupply=function(){this.tmTemp.clear()},e.prototype.GetGPObj=function(t){var e=new c.GPOSupply;return this.container.inject(e),e.UpdateLevel(t.value),e.UpdateResId(t.id),e},e.__cname="GPDrawObjectSupply",i([s.injectField("GPHeroSupply")],e.prototype,"GPHeroSupply",void 0),i([s.injectField("ModelBattleSkill")],e.prototype,"ModelBattleSkill",void 0),e}(u.GPDrawObject);r.GPDrawObjectSupply=f,cc._RF.pop()},{"../../../../../../../../framework/container/Container":void 0,"../GPOSupply":"GPOSupply","./GPDradObject":"GPDradObject","./GPDraw":"GPDraw"}],GPDraw:[function(t,e,r){"use strict";cc._RF.push(e,"6affaaikLNPy5vEgKXSlvpJ","GPDraw");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.GPDraw=r.GPDrawHandler=r.GPDrawHandlerType=void 0;var s,c=t("../../../../../../../../framework/container/Container"),u=t("../../../../../../../../framework/FW"),p=t("../../../../BattleUtil"),f=t("../../SubGamePlay"),h=t("./GPDrawObjectCure"),y=t("./GPDrawObjectGold"),d=t("./GPDrawObjectSkill"),m=t("./GPDrawObjectSupply");(function(t){t[t.SkillOrSupply=0]="SkillOrSupply",t[t.Prop=1]="Prop"})(s=r.GPDrawHandlerType||(r.GPDrawHandlerType={}));var v=function(){function t(){this.isskill=!1,this.issupply=!1}return t.Create=function(e){var r=new t;return r.parent=e,r},t.CreateSkill=function(e,r,o){var n=new t;return n.parent=e,n.type=s.SkillOrSupply,n.id=r,n.value=o,n.isskill=!0,n},t.CreateSupply=function(e,r,o){var n=new t;return n.parent=e,n.type=s.SkillOrSupply,n.id=r,n.value=o,n.issupply=!0,n},t.prototype.Hash=function(){return this.type+"_"+this.id+"_"+this.value},t.prototype.Apply=function(){this.parent.GetGPObj(this).Apply()},t}();r.GPDrawHandler=v;var _=function(){function t(){}return t.prototype.Clear=function(){this.hasskill=!1,this.count=0},t}(),S=[];function g(t,e){var r,o,n=S;n.length=0;try{for(var i=a(t),s=i.next();!s.done;s=i.next()){var c=l(s.value,2),u=c[0];c[1],n.push(u)}}catch(p){r={error:p}}finally{try{s&&!s.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return n.sort(e),n}function b(t){var e,r,o=S;o.length=0;try{for(var n=a(t),i=n.next();!i.done;i=n.next()){var s=l(i.value,2),c=(s[0],s[1]);o.push(c)}}catch(u){e={error:u}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}return 0==o.length?null:o[Math.floor(Math.random()*o.length)]}var C=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tmObject=new Map,e._temp_ApplyHandler=new Map,e._tempskill_supply=new Map,e._tempcure_gold=new Map,e._result_get_random_all=[],e._temp_get_random_all=[],e._get_random_all_index=0,e._get_random_all_dirty=!1,e._skillchest=new Set,e._tmHash=new Set,e.context=new _,e._result=[],e._candidate=[],e}return n(e,t),e.prototype.OnInit=function(){this.CreateObject(d.GPDrawObjectSkill),this.CreateObject(m.GPDrawObjectSupply),this.CreateObject(y.GPDrawObjectGold)},e.prototype.onDestroy=function(){this.tmObject.clear()},e.prototype.OnEnter=function(){var t,e;try{for(var r=a(this.tmObject),o=r.next();!o.done;o=r.next()){var n=l(o.value,2),i=(n[0],n[1]);this.container.inject(i)}}catch(s){t={error:s}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},e.prototype.OnExit=function(){},e.prototype.OnUpdate=function(){},e.prototype.CreateObject=function(t){this.assert(0==this.tmObject.has(t),"\u91cd\u590d\u6ce8\u518cGPDraw:"+t.__cname);var e=new t;e.container=this.container,this.tmObject.set(t,e)},e.prototype.GetObject=function(t){return this.tmObject.get(t)},e.prototype.UpdateData=function(t){var e,r;try{for(var o=a(this.tmObject),n=o.next();!n.done;n=o.next()){var i=l(n.value,2);i[0],i[1].UpdateData(t)}}catch(s){e={error:s}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}},e.prototype.ClearTempData=function(){this.GetObject(d.GPDrawObjectSkill).ClearTempSkill(),this.GetObject(m.GPDrawObjectSupply).ClearTempSupply(),this.clear_random_all()},e.prototype.ApplyHandler=function(t){var e,r,o,n,i=this._temp_ApplyHandler;i.clear();try{for(var c=a(t),u=c.next();!u.done;u=c.next()){var p=u.value;if(p.type==s.SkillOrSupply){var f=i.get(p.id);(null==f||f.value<p.value)&&i.set(p.id,p)}else p.Apply();try{for(var h=(o=void 0,a(i)),y=h.next();!y.done;y=h.next()){var d=l(y.value,2);d[0],d[1].Apply()}}catch(m){o={error:m}}finally{try{y&&!y.done&&(n=h.return)&&n.call(h)}finally{if(o)throw o.error}}}}catch(v){e={error:v}}finally{try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(e)throw e.error}}},e.prototype.GetGPObjByHandler=function(t){return t.parent.GetGPObj(t)},e.prototype.get_evolution=function(){var t=this.GetObject(d.GPDrawObjectSkill),e=this.Battle.startConfig.mainSkill,r=t.GetTmEvolution();if(r.size>0){if(r.has(e))return r.get(e);var o=g(r,function(t,e){return t-e})[0];return r.get(o)}return null},e.prototype.get_skill=function(){return b(this.GetObject(d.GPDrawObjectSkill).GetTmData())},e.prototype.get_skill_supply=function(){var t,e,r,o,n=this.GetObject(d.GPDrawObjectSkill),i=this.GetObject(m.GPDrawObjectSupply),s=this._tempskill_supply;s.clear();try{for(var c=a(n.GetTmData()),u=c.next();!u.done;u=c.next()){var p=l(u.value,2),f=p[0],h=p[1];s.set(f,h)}}catch(S){t={error:S}}finally{try{u&&!u.done&&(e=c.return)&&e.call(c)}finally{if(t)throw t.error}}try{for(var y=a(i.GetTmData()),v=y.next();!v.done;v=y.next()){var _=l(v.value,2);f=_[0],h=_[1],s.set(f,h)}}catch(g){r={error:g}}finally{try{v&&!v.done&&(o=y.return)&&o.call(y)}finally{if(r)throw r.error}}return b(s)},e.prototype.get_gold=function(){return b(this.GetObject(y.GPDrawObjectGold).GetTmData())},e.prototype.get_cure=function(){return b(this.GetObject(h.GPDrawObjectCure).GetTmData())},e.prototype.get_cure_gold=function(){var t,e,r,o,n=this.GetObject(h.GPDrawObjectCure),i=this.GetObject(y.GPDrawObjectGold),s=this._tempskill_supply;s.clear();try{for(var c=a(n.GetTmData()),u=c.next();!u.done;u=c.next()){var p=l(u.value,2),f=p[0],d=p[1];s.set(f,d)}}catch(S){t={error:S}}finally{try{u&&!u.done&&(e=c.return)&&e.call(c)}finally{if(t)throw t.error}}try{for(var m=a(i.GetTmData()),v=m.next();!v.done;v=m.next()){var _=l(v.value,2);f=_[0],d=_[1],s.set(f,d)}}catch(g){r={error:g}}finally{try{v&&!v.done&&(o=m.return)&&o.call(m)}finally{if(r)throw r.error}}return b(s)},e.prototype.clear_random_all=function(){this._temp_get_random_all.length=0,this._result_get_random_all.length=0,this._get_random_all_dirty=!0,this._get_random_all_index=0},e.prototype.get_random_all=function(){var t,e,r,o,n,i,c=this._temp_get_random_all,u=this._result_get_random_all,f=this._get_random_all_index;if(this._get_random_all_dirty){this._get_random_all_dirty=!1,c.length=0,u.length=0;var h=!1;if(0==c.length)try{for(var y=a(this.tmObject),d=y.next();!d.done;d=y.next()){var m=l(d.value,2),v=(m[0],m[1]);try{for(var _=(r=void 0,a(v.GetTmAllData())),S=_.next();!S.done;S=_.next()){var g=l(S.value,2),b=(g[0],g[1]);c.push(b),(b.isskill||b.issupply)&&(h=!0)}}catch(O){r={error:O}}finally{try{S&&!S.done&&(o=_.return)&&o.call(_)}finally{if(r)throw r.error}}}}catch(B){t={error:B}}finally{try{d&&!d.done&&(e=y.return)&&e.call(y)}finally{if(t)throw t.error}}try{for(var C=a(c),R=C.next();!R.done;R=C.next())(b=R.value).type==s.Prop&&h||u.push(b)}catch(P){n={error:P}}finally{try{R&&!R.done&&(i=C.return)&&i.call(C)}finally{if(n)throw n.error}}u.length>1&&p.BattleUtil.Knuth(u)}if(u.length>0){var M=f,w=u[M];return++M>=u.length&&(M=0),this._get_random_all_index=M,w}return null},e.prototype.Draw_Levelup=function(t){var e,r,o=this,n=this._skillchest;n.clear(),t=Math.max(0,t),this.GetObject(d.GPDrawObjectSkill),this.GetObject(m.GPDrawObjectSupply),this.GetObject(y.GPDrawObjectGold),this.UpdateData(function(){return!0});var i,l=function(t){var e;return e=e||o.get_evolution(),0==t.hasskill&&(e=e||o.get_skill()),(e=e||o.get_skill_supply())||o.get_cure_gold()},s=this.context;for(s.Clear();s.count<t&&(i=l(s));)i.isskill&&(s.hasskill=!0),n.add(i),s.count++;var c=this._result;c.length=0;try{for(var u=a(n),p=u.next();!p.done;p=u.next()){var f=p.value;c.push(f)}}catch(h){e={error:h}}finally{try{p&&!p.done&&(r=u.return)&&r.call(u)}finally{if(e)throw e.error}}return c},e.prototype.Draw_SkillChest=function(t){var e,r,o=this,n=this._skillchest;n.clear();var i=this._candidate;i.length=0,t=Math.max(0,t);var l=this._tmHash;l.clear();var c=this.GetObject(d.GPDrawObjectSkill),p=this.GetObject(m.GPDrawObjectSupply);this.GetObject(y.GPDrawObjectGold),this.ClearTempData(),this.UpdateData(function(){return!0});var f,h=function(t){return!l.has(t.Hash())},v=function(t){var e;return e=e||o.get_evolution(),0==t.hasskill&&(e=e||o.get_skill()),(e=e||o.get_skill_supply())||o.get_gold()},_=this.context;for(_.Clear();_.count<t&&(f=v(_));){i.push(f),f.isskill&&(_.hasskill=!0);var S=f.Hash();f.type==s.SkillOrSupply&&(l.has(S)?u.FW.ZJJ.error("\u91cd\u590d\u6280\u80fd",f):l.add(S)),f.isskill&&c.SetTempSkill(f.id,f.value),f.issupply&&p.SetTempSupply(f.id,f.value),n.add(f),this.UpdateData(h),_.count++}var g=this._result;g.length=0;try{for(var b=a(n),C=b.next();!C.done;C=b.next()){var R=C.value;g.push(R)}}catch(B){e={error:B}}finally{try{C&&!C.done&&(r=b.return)&&r.call(b)}finally{if(e)throw e.error}}var M=Math.max(8-i.length,0);if(M>0){for(var w=0;w<M;w++);var O=this.get_random_all();O&&i.push(O)}return g},e.prototype.GetCandidate=function(){return this._candidate},e.__cname="GPDraw",i([c.injectField("Battle")],e.prototype,"Battle",void 0),e}(f.SubGamePlay);r.GPDraw=C,cc._RF.pop()},{"../../../../../../../../framework/FW":void 0,"../../../../../../../../framework/container/Container":void 0,"../../../../BattleUtil":"BattleUtil","../../SubGamePlay":"SubGamePlay","./GPDrawObjectCure":"GPDrawObjectCure","./GPDrawObjectGold":"GPDrawObjectGold","./GPDrawObjectSkill":"GPDrawObjectSkill","./GPDrawObjectSupply":"GPDrawObjectSupply"}],GPEvolution:[function(t,e,r){"use strict";cc._RF.push(e,"48478/rFWNIGZQBTvHc6D3f","GPEvolution");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.GPEvolution=void 0;var s=t("../../../../../../../framework/container/Container"),c=t("../SubGamePlay"),u=t("./GPOSkill"),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._tlEvolutiom=[],e}return n(e,t),e.prototype.OnEnter=function(){},e.prototype.GetTlEvolution=function(){var t,e,r=this._tlEvolutiom;r.length=0;var o=this.ModelBattleSkill.GetTmEvolution();try{for(var n=a(o),i=n.next();!i.done;i=n.next()){var s=l(i.value,2),c=(s[0],s[1]);if(this.CheckCanEvolution(c.GetRef().id)){var p=new u.GPOSkill;this.container.inject(p),p.UpdateLevel(6),p.UpdateResId(c.GetSkillId()),r.push(p)}}}catch(f){t={error:f}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}return r},e.prototype.CheckCanEvolution=function(t){var e,r,o=this.ModelBattleSkill.GetEvolution(t).GetNeed(),n=!0;try{for(var i=a(o),l=i.next();!l.done;l=i.next()){var s=l.value,c=this.GetSkillOrSupplyGpo(s.resId);if(null==c){n=!1;break}if(c.GetLevel()<s.level){n=!1;break}}}catch(u){e={error:u}}finally{try{l&&!l.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return n},e.prototype.GetSkillOrSupplyGpo=function(t){return this.ModelBattleSkill.GetIsSkill(t)?this.GPHeroSkill.GetSkill(t):this.ModelBattleSkill.GetIsSupply(t)?this.GPHeroSupply.GetSupply(t):void 0},e.__cname="GPEvolution",i([s.injectField("GPHeroSupply")],e.prototype,"GPHeroSupply",void 0),i([s.injectField("GPHeroSkill")],e.prototype,"GPHeroSkill",void 0),i([s.injectField("ModelBattleSkill")],e.prototype,"ModelBattleSkill",void 0),e}(c.SubGamePlay);r.GPEvolution=p,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../SubGamePlay":"SubGamePlay","./GPOSkill":"GPOSkill"}],GPGameover:[function(t,e,r){"use strict";cc._RF.push(e,"61e66QFiXBI+LJR/UYZsFki","GPGameover");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.GPGameover=void 0;var s=t("../../../../../../../framework/asset/AssetMgr"),c=t("../../../../../../../framework/container/Container"),u=t("../../../../../../../framework/utils/PromiseWrap"),p=t("../../../../../../../framework/utils/Toolset"),f=t("../../../../../model/goods/ModelGoods"),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._reboren=0,e._state=0,e._rebornCoin=0,e._SendGameFinally=!1,e}return n(e,t),e.prototype.OnInit=function(){this.toolSet=p.ToolSet.createToolSet()},e.prototype.onDestroy=function(){p.ToolSet.destroyToolSet(this.toolSet)},e.prototype.OnEnter=function(){var t=this;this.subset=this.ModelVO.VOItemBag.CreateSubset(),this.subset.SetFilter(function(t){return t.GetRefId()==f.ECurrencyType.reborn_coin}),this.toolSet.addListener(this.subset.GetEventProxy(),"OnChanged",function(){t.UpdateRebornCoin()}),this.roleSubset=this.ModelVO.VORoleBag.CreateSubset(),this.roleSubset.SetFilter(function(){return!0})},e.prototype.OnExit=function(){this.SendGameFinally()},e.prototype.OnUpdate=function(t){this.updateState(t)},e.prototype.updateState=function(t){switch(this._state){case 0:this.updateStateAlive();break;case 2:this.updateStateReborn();break;case 10:this.updateStateDie(t);break;case 20:this.updateAbadonReborn();break;case 30:this.updateWin(t);break;case 40:this.updateAbadon()}},e.prototype.switchAlive=function(){this._state=0},e.prototype.updateStateAlive=function(){var t=this.ComVar.HEROID;0==this.ComVar.ALIVE[t]&&this.switchDie()},e.prototype.switchDie=function(){this._state=10,this._time_die=2,this.SystemJoystick.SetControlable(!1);var t=this.ComVar.HEROID,e=this.Battle.getRef(t);this.ComState.SwitchDie(e),this.GPAudio.die()},e.prototype.updateStateDie=function(t){this._time_die-=t,this._time_die<=0&&this.switchWaiting()},e.prototype.switchWaiting=function(){this._state=1,this.SystemEvent.sendPaused(this),this.canReborn()?(this.LayerReborn.SetReborn(this._rebornCoin),this.LayerReborn.SetHasReborn(this.HasRebornCoin()),this.LayerReborn.load()):this.switchAbadonReborn(),this.GPNetSync.MarkSyncBeat(!0)},e.prototype.switchReborn=function(){this._state=2,this.SystemJoystick.SetControlable(!0),this.SystemEvent.sendResume(this),this.ComVar.takeReborn(this.ComVar.HEROID);var t=this.ComVar.HEROID,e=this.Battle.getRef(t);this.ComState.SwitchReborn(e),this.SystemEvent.sendKillMonsterBoom(),this.SystemEvent.sendShake(),this.SystemEvent.sendTrySpawnAfterKill();var r=this.SystemSkill.GetSkillById(10030);null==r||r.clearPlayState();var o=this.ComPos.x[t],n=this.ComPos.y[t];this.SystemViewEffect.AddEffectXY("\u767e\u604b_\u6218\u6597\u573a\u666f\u7279\u6548_\u590d\u6d3b",o,n),this.GPNetSync.MarkSyncBeat(!0)},e.prototype.updateStateReborn=function(){this.switchAlive()},e.prototype.switchAbadonReborn=function(){this._state=20,this.SendGameFinally(),this.GPAudio.abandon()},e.prototype.updateAbadonReborn=function(){this._state=21,this.SystemEvent.sendPaused(this),this.tryShowSettle(2)},e.prototype.switchAbadon=function(){this._state=40,this.SendGameFinally(),this.GPAudio.abandon()},e.prototype.updateAbadon=function(){this._state=41,this.SystemEvent.sendPaused(this),this.tryShowSettle(3)},e.prototype.canReborn=function(){return!(this._reboren>0||0==this.HasRebornCoin()&&0==this.SDKMgr.getSDK().HasADVideo())},e.prototype.switchWin=function(){this._state=30,this._timewin=5,this.SendGameFinally(),this.tryShowSettle(1)},e.prototype.tryShowSettle=function(t){var e=this,r=function(t,r){var o=e.GPNetSync.GetResultData();null==o&&(o=e.GPNetSync.CreateResultData(t)),e.LayerSettle.SetIsWin(t),e.LayerSettle.SetData(r,o),e.LayerSettle.load()};this.Battle.startConfig.syncData?this.GPNetSync.SendCmdBattleResult(t).then(function(e){r(t,e)}).catch(function(){r(t,null)}):r(t,null)},e.prototype.switchDebugWin=function(){this._state=30,this._timewin=5,this.SendGameFinally(),this.tryShowDebugSettle(1)},e.prototype.tryShowDebugSettle=function(t){var e=this,r=function(t,r){var o=e.GPNetSync.GetResultData();null==o&&(o=e.GPNetSync.CreateResultData(t)),e.LayerSettle.SetIsWin(t),e.LayerSettle.SetData(r,o),e.LayerSettle.load()};this.Battle.startConfig.syncData?this.GPNetSync.SendDebugCmdBattleResult(t).then(function(e){r(t,e)}).catch(function(){r(t,null)}):r(t,null)},e.prototype.updateWin=function(t){this._timewin-=t,this._timewin<=0&&this.switchWinExit()},e.prototype.switchWinExit=function(){this._state=31},e.prototype.Reborn=function(t,e){return a(this,void 0,void 0,function(){var r;return l(this,function(o){switch(o.label){case 0:return r=!1,0==this.Battle.startConfig.syncData&&(r=!0),r?[3,2]:[4,this.ModelBattle.SendReborn(t,e)];case 1:r=o.sent(),o.label=2;case 2:return r&&(this._reboren++,this.switchReborn()),[2,r]}})})},e.prototype.RebornAD=function(){return a(this,void 0,void 0,function(){var t;return l(this,function(e){switch(e.label){case 0:return t=!1,0==this.Battle.startConfig.syncData&&(t=!0),t?[3,2]:[4,this.CtrlPay.PayforAdVideo()];case 1:t=e.sent(),e.label=2;case 2:return t&&(this._reboren++,this.switchReborn()),[2,t]}})})},e.prototype.AbandonReborn=function(){return a(this,void 0,void 0,function(){var t;return l(this,function(){return t=new u.PromiseWrap,this.switchAbadonReborn(),t.resolve(),[2,t]})})},e.prototype.Abandon=function(){return a(this,void 0,void 0,function(){var t;return l(this,function(){return t=new u.PromiseWrap,this.switchAbadon(),t.resolve(),[2,t]})})},e.prototype.Win=function(){this.switchWin()},e.prototype.DebugWin=function(){this.switchDebugWin()},e.prototype.SendGameFinally=function(){this._SendGameFinally||(this._SendGameFinally=!0,this.SystemEvent.sendGameFinally(),s.AssetMgr.instance.unloadUnsed())},e.prototype.UpdateRebornCoin=function(){var t=!1,e=0,r=this.subset.GetOneVO();r&&r.GetNumber()>0&&(t=!0,e=r.GetNumber()),this._hasRebornCoin=t,this._rebornCoin=e},e.prototype.HasRebornCoin=function(){var t=this.roleSubset.GetOneVO(),e=Number(t.GetGem());return this._hasRebornCoin||e>=70},e.prototype.GetRuntimeKey=function(){return"__GPGameover"},e.prototype.GetRuntimtData=function(){return""+this._reboren},e.prototype.ResumeRuntmeData=function(t){t&&(this._reboren=parseInt(t))},e.prototype.resetReboren=function(){this._reboren=0},e.prototype.getGameState=function(){return this._state},e.__cname="GPGameover",i([c.injectField("ComVar")],e.prototype,"ComVar",void 0),i([c.injectField("ComPos")],e.prototype,"ComPos",void 0),i([c.injectField("SystemEvent")],e.prototype,"SystemEvent",void 0),i([c.injectField("LayerSettle")],e.prototype,"LayerSettle",void 0),i([c.injectField("LayerReborn")],e.prototype,"LayerReborn",void 0),i([c.injectField("CtrlBattle")],e.prototype,"CtrlBattle",void 0),i([c.injectField("ComState")],e.prototype,"ComState",void 0),i([c.injectField("SystemJoystick")],e.prototype,"SystemJoystick",void 0),i([c.injectField("Battle")],e.prototype,"Battle",void 0),i([c.injectField("GPNetSync")],e.prototype,"GPNetSync",void 0),i([c.injectField("GPAudio")],e.prototype,"GPAudio",void 0),i([c.injectField("SystemViewEffect")],e.prototype,"SystemViewEffect",void 0),i([c.injectField("LayerBatterCamerEffect")],e.prototype,"LayerBatterCamerEffect",void 0),i([c.injectField("ModelVO")],e.prototype,"ModelVO",void 0),i([c.injectField("SDKMgr")],e.prototype,"SDKMgr",void 0),i([c.injectField("CtrlPay")],e.prototype,"CtrlPay",void 0),i([c.injectField("SystemSkill")],e.prototype,"SystemSkill",void 0),i([c.injectField("ModelBattle")],e.prototype,"ModelBattle",void 0),e}(t("../SubGamePlay").SubGamePlay);r.GPGameover=h,cc._RF.pop()},{"../../../../../../../framework/asset/AssetMgr":void 0,"../../../../../../../framework/container/Container":void 0,"../../../../../../../framework/utils/PromiseWrap":void 0,"../../../../../../../framework/utils/Toolset":void 0,"../../../../../model/goods/ModelGoods":"ModelGoods","../SubGamePlay":"SubGamePlay"}],GPGuide:[function(t,e,r){"use strict";cc._RF.push(e,"bb08cyMYsxGmpUUd8lI15Hp","GPGuide");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.GPGuide=void 0;var s=t("../../../../../../../framework/FW"),c=t("../../../../../../../framework/container/Container"),u=t("../../../../../../../framework/utils/Toolset"),p=t("../../../../../model/guide/ModelGuide"),f=t("../../event/SystemEvent"),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnInit=function(){this.toolSet=u.ToolSet.createToolSet()},e.prototype.OnEnter=function(){var t=this;this.toolSet.addListener(this.SystemEvent.GetEventPorxy(),f.EBattleEvent.EnterSelector,function(){t.checkCanStartSelectGuide()}),this.RunCor()},e.prototype.RunCor=function(){var t=this;if(!this._RunCor){var e=this.RunCorInner();this._RunCor=e,e.then(function(){t._RunCor=null}).catch(function(){t._RunCor=null})}},e.prototype.RunCorInner=function(){return a(this,void 0,void 0,function(){return l(this,function(t){switch(t.label){case 0:return[4,s.FW.Task.delay(1e3)];case 1:return t.sent(),[4,this.checkFirstStartFight()];case 2:return t.sent(),[2]}})})},e.prototype.checkFirstStartFight=function(){return a(this,void 0,void 0,function(){return l(this,function(t){switch(t.label){case 0:return this.SystemEvent.sendPaused(this),this.ModelGuide.CheckClientIsCanTriggerMission(p.GuideKey.FirstEnterFight)&&this.LayerFightGuide.load(),[4,this.CtrlGuide.CheckAndStartClientTriggerSection(p.GuideKey.FirstEnterFight)];case 1:return t.sent(),this.SystemEvent.sendResume(this),[4,s.FW.Task.delay(6e3)];case 2:return t.sent(),this.LayerFightGuide.unload(),[2]}})})},e.prototype.checkCanStartSelectGuide=function(){return a(this,void 0,void 0,function(){return l(this,function(){return[2]})})},e.__cname="GPGuide",i([c.injectField("SystemEvent")],e.prototype,"SystemEvent",void 0),i([c.injectField("CtrlGuide")],e.prototype,"CtrlGuide",void 0),i([c.injectField("ModelGuide")],e.prototype,"ModelGuide",void 0),i([c.injectField("LayerFightGuide")],e.prototype,"LayerFightGuide",void 0),e}(t("../SubGamePlay").SubGamePlay);r.GPGuide=h,cc._RF.pop()},{"../../../../../../../framework/FW":void 0,"../../../../../../../framework/container/Container":void 0,"../../../../../../../framework/utils/Toolset":void 0,"../../../../../model/guide/ModelGuide":"ModelGuide","../../event/SystemEvent":"SystemEvent","../SubGamePlay":"SubGamePlay"}],GPHeroSkill:[function(t,e,r){"use strict";cc._RF.push(e,"17f760BIs5Kt7P8XwFT0LDn","GPHeroSkill");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.GPHeroSkill=void 0;var s=t("../../../../../../../framework/container/Container"),c=t("../../../../../../../framework/FW"),u=t("../SubGamePlay"),p=t("./GPOSkill"),f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tlList=[],e.tm2Index=new Map,e.indexs=[],e.tlDeleteList=new Set,e.learnSkill=new Map,e._tlCandidate=[],e}return n(e,t),Object.defineProperty(e.prototype,"skillLimit",{get:function(){return this.Battle.startConfig.skillLimit-this.ComVar.HERO_SKILL_LIMIT},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"startConfig",{get:function(){return this.Battle.startConfig},enumerable:!1,configurable:!0}),e.prototype.OnEnter=function(){for(var t=0;t<this.skillLimit;t++){var e=new p.GPOSkill;this.container.inject(e),this.tlList.push(e),this.indexs.push(t)}},e.prototype.GetTlSkill=function(){return this.tlList},e.prototype.GetSkill=function(t){var e=this.tm2Index.get(t);return null==e?null:this.tlList[e]},e.prototype.GetSkillMaxLevel=function(t){var e=this.tm2Index.get(t);if(null==e)return!1;var r=this.tlList[e];return r.GetLevel()>=r.GetMaxLevel()},e.prototype.UpgradeSkill=function(t,e){var r=this.tm2Index.get(t);if(null==r){if(null==(r=this.indexs.shift()))return!1;this.tm2Index.set(t,r)}var o=this.tlList[r];return null==e&&(e=o.IsEmpty()?0:o.GetLevel(),e++),0==this.ModelBattleSkill.IsSkillValid(t,e)&&(e=this.ModelBattleSkill.GetSkillMinLevel(t)),this.ModelBattleSkill.IsSkillValid(t,e)?(o.UpdateLevel(e),o.UpdateResId(t),!0):(c.FW.ZJJ.error("\u6280\u80fd\u65e0\u6cd5\u5347\u7ea7  resId:"+t+" level:"+e),!1)},e.prototype.DeleteSkill=function(t){this.tlDeleteList.add(t);var e=this.tm2Index.get(t);null!=e&&(this.tlList[e].Clear(),this.tm2Index.delete(t),this.indexs.push(e),this.indexs.sort())},e.prototype.GetLimit=function(){return this.skillLimit},e.prototype.GetTmUpgrade=function(){var t,e,r=new Map;try{for(var o=a(this.tm2Index),n=o.next();!n.done;n=o.next()){var i=l(n.value,2),s=i[0],c=i[1],u=this.tlList[c].GetLevel()+1;this.tlDeleteList.has(s)||this.ModelBattleSkill.IsSkillValid(s,u)&&r.set(s,u)}}catch(p){t={error:p}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}return r},e.prototype.HasSkill=function(t){return this.tm2Index.has(t)},e.prototype.GetTLCandidate=function(){var t,e,r=this._tlCandidate;r.length=0;var o=this.tm2Index,n=this.tm2Index.size,i=this.startConfig.skillLimit;try{for(var l=a(this.startConfig.skills),s=l.next();!s.done;s=l.next()){var c=s.value;this.tlDeleteList.has(c)||this.GetSkillMaxLevel(c)||n>=i&&!o.has(c)||r.push(c)}}catch(u){t={error:u}}finally{try{s&&!s.done&&(e=l.return)&&e.call(l)}finally{if(t)throw t.error}}return r},e.__cname="GPHeroSkill",i([s.injectField("Battle")],e.prototype,"Battle",void 0),i([s.injectField("Ref")],e.prototype,"Ref",void 0),i([s.injectField("ModelBattleSkill")],e.prototype,"ModelBattleSkill",void 0),i([s.injectField("ComVar")],e.prototype,"ComVar",void 0),e}(u.SubGamePlay);r.GPHeroSkill=f,cc._RF.pop()},{"../../../../../../../framework/FW":void 0,"../../../../../../../framework/container/Container":void 0,"../SubGamePlay":"SubGamePlay","./GPOSkill":"GPOSkill"}],GPHeroSupply:[function(t,e,r){"use strict";cc._RF.push(e,"6f88aFzW3NPCKEpctJqjSCl","GPHeroSupply");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.GPHeroSupply=void 0;var s=t("../../../../../../../framework/container/Container"),c=t("../../../../../../../framework/FW"),u=t("../SubGamePlay"),p=t("./GPOSupply"),f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tlList=[],e.tm2Index=new Map,e.indexs=[],e._tlCandidate=[],e}return n(e,t),Object.defineProperty(e.prototype,"skillLimit",{get:function(){return this.Battle.startConfig.skillLimit-this.ComVar.HERO_SKILL_LIMIT},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"startConfig",{get:function(){return this.Battle.startConfig},enumerable:!1,configurable:!0}),e.prototype.OnEnter=function(){for(var t=0;t<this.skillLimit;t++){var e=new p.GPOSupply;this.container.inject(e),this.tlList.push(e),this.indexs.push(t)}},e.prototype.GetTlSupply=function(){return this.tlList},e.prototype.GetSupply=function(t){var e=this.tm2Index.get(t);return null==e?null:this.tlList[e]},e.prototype.GetSupplyMaxLevel=function(t){var e=this.tm2Index.get(t);if(null==e)return!1;var r=this.tlList[e];return r.GetLevel()==r.GetMaxLevel()},e.prototype.HasSupply=function(t){return this.tm2Index.has(t)},e.prototype.UpgradeSupply=function(t,e){var r=this.tm2Index.get(t);if(null==r){if(null==(r=this.indexs.shift()))return!1;this.tm2Index.set(t,r)}var o=this.tlList[r];return null==e&&(e=o.IsEmpty()?0:o.GetLevel(),e++),this.ModelBattleSkill.IsSupplyValid(t,e)?(o.UpdateLevel(e),o.UpdateResId(t),!0):(c.FW.ZJJ.error("\u6280\u80fd\u65e0\u6cd5\u8865\u7ed9  resId:"+t+" level:"+e),!1)},e.prototype.GetLimit=function(){return this.skillLimit},e.prototype.GetTmUpgrade=function(){var t,e,r=new Map;try{for(var o=a(this.tm2Index),n=o.next();!n.done;n=o.next()){var i=l(n.value,2),s=i[0],c=i[1],u=this.tlList[c].GetLevel()+1;this.ModelBattleSkill.IsSupplyValid(s,u)&&r.set(s,u)}}catch(p){t={error:p}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}return r},e.prototype.GetTLCandidate=function(){var t,e,r=this._tlCandidate;r.length=0;var o=this.tm2Index,n=this.tm2Index.size,i=this.startConfig.skillLimit;try{for(var l=a(this.startConfig.supply),s=l.next();!s.done;s=l.next()){var c=s.value;this.GetSupplyMaxLevel(c)||n>=i&&!o.has(c)||r.push(c)}}catch(u){t={error:u}}finally{try{s&&!s.done&&(e=l.return)&&e.call(l)}finally{if(t)throw t.error}}return r},e.__cname="GPHeroSupply",i([s.injectField("Battle")],e.prototype,"Battle",void 0),i([s.injectField("ModelBattleSkill")],e.prototype,"ModelBattleSkill",void 0),i([s.injectField("ComVar")],e.prototype,"ComVar",void 0),e}(u.SubGamePlay);r.GPHeroSupply=f,cc._RF.pop()},{"../../../../../../../framework/FW":void 0,"../../../../../../../framework/container/Container":void 0,"../SubGamePlay":"SubGamePlay","./GPOSupply":"GPOSupply"}],GPLevelUp:[function(t,e,r){"use strict";cc._RF.push(e,"266669ef7hMNYuD+4HcpXOO","GPLevelUp");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.GPLevelUp=void 0;var s=t("../../../../../../../framework/container/Container"),c=t("../../../../../../../framework/event/EventCallback"),u=t("../../../../../../../framework/FW"),p=t("../../../../../../../framework/utils/Toolset"),f=t("../../../../../model/goods/ModelGoods"),h=t("../../../BattleUtil"),y=t("../../event/SystemEvent"),d=t("../SubGamePlay"),m=t("./GPOCure_pre"),v=t("./GPOItem"),_=t("./GPOSkill"),S=t("./GPOSkillModify"),g=t("./GPOSupply"),b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.changeCallback=new c.EventCallback,e.tlSelect=[],e.defaultGold=0,e.defaultHp=0,e._random_skill=[],e._weight_skill=[],e._random_supply=[],e._weight_supply=[],e.upgradeCount=0,e}return n(e,t),e.prototype.GetChangeCallback=function(){return this.changeCallback},Object.defineProperty(e.prototype,"startConfig",{get:function(){return this.Battle.startConfig},enumerable:!1,configurable:!0}),e.prototype.OnInit=function(){this.toolSet=p.ToolSet.createToolSet()},e.prototype.onDestroy=function(){p.ToolSet.destroyToolSet(this.toolSet)},e.prototype.OnEnter=function(){var t=this;this.toolSet.addListener(this.SystemEvent.GetEventPorxy(),y.EBattleEvent.LevelUp,function(){t.OnShowSelector(function(){t.ComVar.takeLevelUp()})}),this.toolSet.addListener(this.SystemEvent.GetEventPorxy(),y.EBattleEvent.EnterSelector,function(){t.OnShowSelector()}),this.toolSet.addListener(this.SystemEvent.GetEventPorxy(),y.EBattleEvent.SkillReplace,function(){t.OnShowSkillReplace()}),this.defaultGold=this.ModelGameConfig.GetGameConfigValueByKey("battleUpgradeGold");var e=this.ModelGameConfig.GetGameConfigValueByKey("battleUpgradeHp");this.defaultHp=e/1e4},e.prototype.OnExit=function(){},e.prototype.OnUpdate=function(){},e.prototype.OnShowSkillReplace=function(){this.LayerSkillReplace.load(),this.changeCallback.execute()},e.prototype.OnShowSelector=function(t){this.GPGameover.getGameState()>=30||(this.RefreshSelectorInner(),this.LayerSelectUpgrade.load(),this.LayerSelectUpgrade.setCloseCallBack(t),this.changeCallback.execute())},e.prototype.GetHasRefresh=function(){return this.startConfig.refreshSkill>0},e.prototype.RefreshSelector=function(){this.GetHasRefresh()&&(this.startConfig.takeRefreshSkill(),this.RefreshSelectorInner(),this.changeCallback.execute())},e.prototype.RefreshSelectorInner=function(){var t=this,e=[],r=this.startConfig,o=0,n=r.skillSelectNum,i=this.ModelBattleSkill,s=this.IsFirstUpgrade(),c=this.GPHeroSkill.GetTmUpgrade(),p=(this.GPHeroSupply.GetTmUpgrade(),this.GetTmCandidate()),y=this.GPEvolution.GetTlEvolution(),d=!1,_=[],S=function(t){var e,r;_.length=0;try{for(var o=a(t),n=o.next();!n.done;n=o.next()){var i=l(n.value,2),s=i[0];i[1],_.push(s)}}catch(u){e={error:u}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}var c=Math.floor(Math.random()*_.length);return _[c]},g=function(t){var r=p.get(t);e.push(r),p.delete(r.GetResId()),o++,i.GetIsSkill(t)&&(d=!0)},b=function(){var r=new v.GPObjItem;t.container.inject(r),r.UpdateNumber(t.defaultGold),r.UpdateResId(f.ECurrencyType.coin),e.push(r),o++};this.Battle.startConfig.levelUpGuaranteeHp&&(b=function(){var r=new m.GPOCure_pre;t.container.inject(r),r.UpdateNumber(t.defaultHp),r.UpdateResId(f.ECurrencyType.cure),e.push(r),o++});var C=!1,R=function(){if(C)return!1;if(C=!0,0==c.size)return!1;var t=S(c);return g(t),!0},M=function(){return 0!=y.length},w=function(){if(0==M())return!1;var t=y.shift();return e.push(t),o++,!0},O=this._random_skill,B=this._weight_skill,P=this._random_supply,G=this._weight_supply,k={none:1,learned:1},x={none:1,learned:1},T=this.ModelGameConfig.GetGameConfigValueByKey("battleSelectSkillLearnWeight");k.learned=T[0],k.none=T[1],T=this.ModelGameConfig.GetGameConfigValueByKey("battleSelectSkillLearnWeight"),x.learned=T[0],x.none=T[1];for(var j=function(){var e,r;O.length=0,B.length=0;try{for(var o=a(t.GPHeroSkill.GetTLCandidate()),n=o.next();!n.done;n=o.next()){var i=n.value;if(0!=p.has(i)){O.push(i);var l;l=t.GPHeroSkill.HasSkill(i)?k.learned:k.none,B.push(l)}}}catch(s){e={error:s}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}},I=function(){var e,r;P.length=0,G.length=0;try{for(var o=a(t.GPHeroSupply.GetTLCandidate()),n=o.next();!n.done;n=o.next()){var i=n.value;if(0!=p.has(i)){P.push(i);var l;l=t.GPHeroSupply.HasSupply(i)?x.learned:x.none,G.push(l)}}}catch(s){e={error:s}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}},D=function(){if(p.size>0==0)return!1;var t;if(j(),I(),null==t&&0==O.length){var e=P,r=G;t=h.BattleUtil.PrepareWeightedRandom(e,r)}if(null==t&&0==P.length&&(e=O,r=B,t=h.BattleUtil.PrepareWeightedRandom(e,r)),null==t&&U()&&(e=O,r=B,t=h.BattleUtil.PrepareWeightedRandom(e,r)),null==t)switch(L()){case 0:e=O,r=B,t=h.BattleUtil.PrepareWeightedRandom(e,r);break;case 1:e=P,r=G,t=h.BattleUtil.PrepareWeightedRandom(e,r)}return null!=t&&(g(t),!0)},F=function(){var e=t.ModelGameConfig.GetGameConfigValueByKey("battleSelectEvolutionWeight"),r=l(h.BattleUtil.PrepareWeightedRandom2(e,e),2);return r[0],0==r[1]},L=function(){var e=t.ModelGameConfig.GetGameConfigValueByKey("battleSelectTypeWeight"),r=l(h.BattleUtil.PrepareWeightedRandom2(e,e),2);return r[0],r[1]},E=this.ModelGameConfig.GetGameConfigValueByKey("battleSelectOnlySkill")||0,A=this.ModelGameConfig.GetGameConfigValueByKey("battleSelectIncludSkill")||0,V=this.GetUpgradecount(),U=function(){return V<E||V<A&&0==d},W=999;o<n;){if(W--<0){u.FW.ZJJ.error("\u904d\u5386\u8d85\u65f6\uff01");break}s&&R()||M()&&F()&&w()||D()||b()}return this.tlSelect=e,e},e.prototype.GetTmCandidate=function(){var t,e,r,o,n,i,s,c,u=this.GPHeroSkill.GetTmUpgrade(),p=this.GPHeroSupply.GetTmUpgrade(),f=new Map;try{for(var h=a(u),y=h.next();!y.done;y=h.next()){var d=l(y.value,2),m=d[0],v=d[1],S=new _.GPOSkill;this.container.inject(S),S.UpdateLevel(v),S.UpdateResId(m),f.set(m,S)}}catch(P){t={error:P}}finally{try{y&&!y.done&&(e=h.return)&&e.call(h)}finally{if(t)throw t.error}}try{for(var b=a(this.GPHeroSkill.GetTLCandidate()),C=b.next();!C.done;C=b.next())m=C.value,f.has(m)||(v=this.ModelBattleSkill.GetSkillMinLevel(m),S=new _.GPOSkill,this.container.inject(S),S.UpdateLevel(v),S.UpdateResId(m),f.set(m,S))}catch(G){r={error:G}}finally{try{C&&!C.done&&(o=b.return)&&o.call(b)}finally{if(r)throw r.error}}try{for(var R=a(p),M=R.next();!M.done;M=R.next()){var w=l(M.value,2);m=w[0],v=w[1],S=new g.GPOSupply,this.container.inject(S),S.UpdateLevel(v),S.UpdateResId(m),f.set(m,S)}}catch(k){n={error:k}}finally{try{M&&!M.done&&(i=R.return)&&i.call(R)}finally{if(n)throw n.error}}try{for(var O=a(this.GPHeroSupply.GetTLCandidate()),B=O.next();!B.done;B=O.next())m=B.value,f.has(m)||(v=1,S=new g.GPOSupply,this.container.inject(S),S.UpdateLevel(v),S.UpdateResId(m),f.set(m,S))}catch(x){s={error:x}}finally{try{B&&!B.done&&(c=O.return)&&c.call(O)}finally{if(s)throw s.error}}return f},e.prototype.Select=function(t){this.MarkUpgrade();var e=this.tlSelect[t];e.Apply(),this.SystemEvent.GetEventPorxy().execute(y.EBattleEvent.SelectUpgrade,e)},e.prototype.GetTlSelect=function(){return this.tlSelect},e.prototype.activeSkill=function(t,e,r){var o=new S.GPOSkillModify;this.container.inject(o),o.UpdateLevel(e),o.UpdateResId(t),o.modifyApply(r),this.SystemEvent.GetEventPorxy().execute(y.EBattleEvent.SelectUpgrade,o)},e.prototype.MarkUpgrade=function(){this.upgradeCount++},e.prototype.IsFirstUpgrade=function(){return 0==this.upgradeCount},e.prototype.GetUpgradecount=function(){return this.upgradeCount},e.prototype.GetRuntimeKey=function(){return"__GPLevelUp"},e.prototype.GetRuntimtData=function(){return""+this.upgradeCount},e.prototype.ResumeRuntmeData=function(t){t&&(this.upgradeCount=parseInt(t))},e.__cname="GPLevelUp",i([s.injectField("Battle")],e.prototype,"Battle",void 0),i([s.injectField("SystemEvent")],e.prototype,"SystemEvent",void 0),i([s.injectField("LayerSelectUpgrade")],e.prototype,"LayerSelectUpgrade",void 0),i([s.injectField("ModelBattleSkill")],e.prototype,"ModelBattleSkill",void 0),i([s.injectField("ModelGameConfig")],e.prototype,"ModelGameConfig",void 0),i([s.injectField("ComVar")],e.prototype,"ComVar",void 0),i([s.injectField("ComSkill")],e.prototype,"ComSkill",void 0),i([s.injectField("GPHeroSkill")],e.prototype,"GPHeroSkill",void 0),i([s.injectField("GPHeroSupply")],e.prototype,"GPHeroSupply",void 0),i([s.injectField("GPEvolution")],e.prototype,"GPEvolution",void 0),i([s.injectField("LayerSkillReplace")],e.prototype,"LayerSkillReplace",void 0),i([s.injectField("GPGameover")],e.prototype,"GPGameover",void 0),e}(d.SubGamePlay);r.GPLevelUp=b,cc._RF.pop()},{"../../../../../../../framework/FW":void 0,"../../../../../../../framework/container/Container":void 0,"../../../../../../../framework/event/EventCallback":void 0,"../../../../../../../framework/utils/Toolset":void 0,"../../../../../model/goods/ModelGoods":"ModelGoods","../../../BattleUtil":"BattleUtil","../../event/SystemEvent":"SystemEvent","../SubGamePlay":"SubGamePlay","./GPOCure_pre":"GPOCure_pre","./GPOItem":"GPOItem","./GPOSkill":"GPOSkill","./GPOSkillModify":"GPOSkillModify","./GPOSupply":"GPOSupply"}],GPNetDisconnet:[function(t,e,r){"use strict";cc._RF.push(e,"bd64beiTt5JFZUXNV89o3ID","GPNetDisconnet");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.GPNetDisconnet=void 0;var a=t("../../../../../../../framework/container/Container"),l=t("../../../../../../../framework/utils/Toolset"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnEnter=function(){this.toolSet=l.ToolSet.createToolSet(),this.toolSet.addListener(this.Net.getEventProxy(),"connectFail",this.OnDisconnect,this)},e.prototype.OnExit=function(){l.ToolSet.destroyToolSet(this.toolSet)},e.prototype.OnDisconnect=function(){this.SystemEvent.sendPaused(this)},e.__cname="GPNetDisconnet",i([a.injectField("Net")],e.prototype,"Net",void 0),i([a.injectField("SystemEvent")],e.prototype,"SystemEvent",void 0),e}(t("../SubGamePlay").SubGamePlay);r.GPNetDisconnet=s,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../../../../../../framework/utils/Toolset":void 0,"../SubGamePlay":"SubGamePlay"}],GPNetSync:[function(t,e,r){"use strict";cc._RF.push(e,"2003eBeHpRK9IhPQyEnBVOI","GPNetSync");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.NetSyncData=r.GPNetSync=void 0;var l=t("../../../../../../../framework/container/Container"),s=t("../../../../../../../framework/FW"),c=t("../../../../../../../framework/utils/PromiseWrap"),u=t("../../../../../../generated/requestMsg/RequestBattleMsg"),p=t("../../../model/ModelBattleDrop"),f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._tmLastSyncTime=0,e._tmArgs=new Map,e}return n(e,t),Object.defineProperty(e.prototype,"startConfig",{get:function(){return this.Battle.startConfig},enumerable:!1,configurable:!0}),e.prototype.OnEnter=function(){var t=this.startConfig.resumeData;if(t){var e=t.cmdBattleBeat;e&&this.ResumeArgs(e.args)}},e.prototype.OnExit=function(){},e.prototype.OnUpdate=function(){if(this._syncbeat){var t=this._syncbeat_force;this.SendCmdBattleBeat(t,this._syncBossPoint),this._syncbeat=!1,this._syncbeat_force=!1,this._syncBossPoint=!1}},e.prototype.MarkSyncBeat=function(t,e){void 0===t&&(t=!1),void 0===e&&(e=!1),this._syncbeat=!0,t&&(this._syncbeat_force=!0),this._syncBossPoint=e},e.prototype._checkSyncTime=function(){var t=this.SystemSpawn.GetPoint();return t>=this._tmLastSyncTime&&(this._tmLastSyncTime=t+30,!0)},e.prototype.SendCmdBattleBeat=function(t,e){if(void 0===t&&(t=!1),void 0===e&&(e=!1),(0!=t||0!=this._checkSyncTime())&&0!=this.startConfig.syncData){var r={cmdBattleBeat:{}};r.cmdBattleBeat.args=this.GetArgsSync(),r.cmdBattleBeat.roles=[this.GetBattleRole()],r.cmdBattleBeat.extend=this.Battle.GetRuntimeData(),r.bossSavePoint=e,s.FW.ZJJ.log("RequestBattleBeat",r);var o=new u.RequestBattleBeat(r);return this.CtrlGameNet.send(o)}},e.prototype.SendCmdBattleResult=function(t){if(0!=this.startConfig.syncData){var e=this.CreateResultData(t);this._data=e,s.FW.ZJJ.log("RequestBattleResult",e);var r=new c.PromiseWrap,o=new u.RequestBattleResult(e,this,function(t){r.resolve(t)},function(){r.reject()});return this.CtrlGameNet.send(o),r.promise}},e.prototype.SendDebugCmdBattleResult=function(t){var e,r;if(0!=this.startConfig.syncData){var o=this.CreateResultData(t),n=function(t,e,r){var o,n;try{for(var i=a(t),l=i.next();!l.done;l=i.next()){var s=l.value;if(s.key==e){s.value=Math.max(r,s.value);break}}}catch(c){o={error:c}}finally{try{l&&!l.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}},i=this.startConfig.fubenId,l=this.ModelBattleDrop.GetAllEquipDrawingByFuben(i);try{for(var f=a(l),h=f.next();!h.done;h=f.next()){var y=h.value;null!=y&&(y.type!=p.BattleEquipDrawingType.kill?y.type!=p.BattleEquipDrawingType.killBoss||n(o.beat.args,"killBoss",y.need):n(o.beat.args,"kill",y.need))}}catch(_){e={error:_}}finally{try{h&&!h.done&&(r=f.return)&&r.call(f)}finally{if(e)throw e.error}}var d=this.SystemSpawn.SubMonster.GetPointLimit();n(o.beat.args,"point",d),this._data=o,s.FW.ZJJ.log("RequestBattleResult",o);var m=new c.PromiseWrap,v=new u.RequestBattleResult(o,this,function(t){m.resolve(t)},function(){m.reject()});return this.CtrlGameNet.send(v),m.promise}},e.prototype.CreateResultData=function(t){var e={beat:null,result:t};return e.beat={},e.beat.args=this.GetArgsResult(),e.beat.roles=[this.GetBattleRole()],e.beat.extend=this.Battle.GetRuntimeData(),e},e.prototype.GetResultData=function(t){return void 0===t&&(t=!1),this._data},e.prototype.ResumeData=function(){var t=this.startConfig.resumeData;if(t){var e=t.cmdBattleBeat;e&&this.ResumeCmdBattleBeat(e)}},e.prototype.GetCmdBattleBeat=function(){},e.prototype.ResumeCmdBattleBeat=function(t){var e,r;if(null!=t){if(t.args){var o={};try{for(var n=a(t.args),i=n.next();!i.done;i=n.next()){var l=i.value;o[l.key]=l.value}}catch(s){e={error:s}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}this.ComVar.KILL_BOSS=o.killBoss,this.ComVar.KILL=o.kill,this.ComVar.GOLD=o.gold,this.ComVar.HEROHP=this.startConfig.bossNodeChest?0:o.heroHp||0,this.SystemSpawn.SetStartTime(o.point)}t.roles&&this.ResumeBattleRole(t.roles)}},e.prototype.GetBattleRole=function(){return{roleId:this.startConfig.hero,level:this.ComVar.LEVEL,exp:this.ComVar.EXP,skill:this.GetSkill(),supply:this.GetSupply(),extend:null}},e.prototype.ResumeBattleRole=function(t){var e,r,o,n,i,l;try{for(var s=a(t),c=s.next();!c.done;c=s.next()){var u=c.value;this.ComVar.LEVEL=u.level,this.ComVar.EXP=u.exp,this.ComVar.updateExpMax();try{for(var p=(o=void 0,a(u.skill)),f=p.next();!f.done;f=p.next()){var h=f.value;this.GPSkillData.SetSkillOrSupply(h.resId,h.level)}}catch(m){o={error:m}}finally{try{f&&!f.done&&(n=p.return)&&n.call(p)}finally{if(o)throw o.error}}try{for(var y=(i=void 0,a(u.supply)),d=y.next();!d.done;d=y.next())h=d.value,this.GPSkillData.SetSkillOrSupply(h.resId,h.level)}catch(v){i={error:v}}finally{try{d&&!d.done&&(l=y.return)&&l.call(y)}finally{if(i)throw i.error}}}}catch(_){e={error:_}}finally{try{c&&!c.done&&(r=s.return)&&r.call(s)}finally{if(e)throw e.error}}},e.prototype.GetSkill=function(){var t,e,r=[];try{for(var o=a(this.GPHeroSkill.GetTlSkill()),n=o.next();!n.done;n=o.next()){var i=n.value;if(!i.IsEmpty()){var l={resId:i.GetResId(),level:i.GetLevel()};r.push(l)}}}catch(s){t={error:s}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}return r},e.prototype.GetSupply=function(){var t,e,r=[];try{for(var o=a(this.GPHeroSupply.GetTlSupply()),n=o.next();!n.done;n=o.next()){var i=n.value;if(!i.IsEmpty()){var l={resId:i.GetResId(),level:i.GetLevel()};r.push(l)}}}catch(s){t={error:s}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}return r},e.prototype.GetArgsSync=function(){var t=[],e=this.SystemSpawn.SubMonster.GetLastPoint(),r=this.SystemSpawn.SubMonster.GetPointLimit();return t.push({key:"kill",value:this.ComVar.KILL}),t.push({key:"killBoss",value:this.ComVar.KILL_BOSS}),t.push({key:"gold",value:this.ComVar.GOLD}),t.push({key:"point",value:e}),t.push({key:"pointLimit",value:r}),t.push({key:"heroHp",value:this.ComVar.HP[this.ComVar.HEROID]||0}),t},e.prototype.GetArgsResult=function(){var t=[],e=this.SystemSpawn.SubMonster.GetPointLimit();return t.push({key:"kill",value:this.ComVar.KILL}),t.push({key:"killBoss",value:this.ComVar.KILL_BOSS}),t.push({key:"gold",value:this.ComVar.GOLD}),s.FW.LWX.log("point:",this.SystemSpawn.GetPoint()),t.push({key:"point",value:this.SystemSpawn.GetPoint()}),t.push({key:"pointLimit",value:e}),t},e.prototype.ResumeArgs=function(t){var e,r;if(null!=t){var o,n=this._tmArgs;n.clear();try{for(var i=a(t),l=i.next();!l.done;l=i.next()){var s=l.value;n.set(s.key,s.value)}}catch(c){e={error:c}}finally{try{l&&!l.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}(o=n.get("kill"))&&(this.ComVar.KILL=o),(o=n.get("gold"))&&(this.ComVar.GOLD=o),(o=n.get("killBoss"))&&(this.ComVar.KILL_BOSS=o),(o=n.get("point"))&&this.SystemSpawn.SetStartTime(o)}},e.prototype.ResumeRole=function(){var t=this.startConfig.resumeData;return!(!t||!t.cmdBattleBeat)},e.__cname="GPNetSync",i([l.injectField("CtrlGameNet")],e.prototype,"CtrlGameNet",void 0),i([l.injectField("ComVar")],e.prototype,"ComVar",void 0),i([l.injectField("SystemSpawn")],e.prototype,"SystemSpawn",void 0),i([l.injectField("Battle")],e.prototype,"Battle",void 0),i([l.injectField("GPHeroSkill")],e.prototype,"GPHeroSkill",void 0),i([l.injectField("GPHeroSupply")],e.prototype,"GPHeroSupply",void 0),i([l.injectField("GPSkillData")],e.prototype,"GPSkillData",void 0),i([l.injectField("ModelBattleDrop")],e.prototype,"ModelBattleDrop",void 0),e}(t("../SubGamePlay").SubGamePlay);r.GPNetSync=f;var h=function(){function t(){this._tmData=new Map}return t.prototype.SetByCmd=function(t){var e,r;if(this.cmd=t,this._tmData.clear(),t.args)try{for(var o=a(t.args),n=o.next();!n.done;n=o.next()){var i=n.value;this._tmData.set(i.key,i.value)}}catch(l){e={error:l}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}},t.prototype.GetKill=function(){return this._tmData.get("kill")||0},t.prototype.GetGold=function(){return this._tmData.get("gold")||0},t.prototype.GetKillBoss=function(){return this._tmData.get("killBoss")||0},t.prototype.GetPoint=function(){return this._tmData.get("point")||0},t.prototype.GetIsNew=function(){return this._tmData.get("isNew")||0},t.prototype.GetBestPoint=function(){return this._tmData.get("bestPoint")||0},t}();r.NetSyncData=h,cc._RF.pop()},{"../../../../../../../framework/FW":void 0,"../../../../../../../framework/container/Container":void 0,"../../../../../../../framework/utils/PromiseWrap":void 0,"../../../../../../generated/requestMsg/RequestBattleMsg":"RequestBattleMsg","../../../model/ModelBattleDrop":"ModelBattleDrop","../SubGamePlay":"SubGamePlay"}],GPOCure_pre:[function(t,e,r){"use strict";cc._RF.push(e,"8a584bbzkFKeKM07MuUnBMC","GPOCure_pre");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.GPOCure_pre=void 0;var a=t("../../../../../../../framework/container/Container"),l=t("../../../../../../../framework/FW"),s=t("../../../../../../../framework/utils/StringUtil"),c=t("../../../../../model/goods/ModelGoods"),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetName=function(){return l.FW.G_W(this.ref.name)},e.prototype.GetIcon=function(){return this.ref.icon},e.prototype.GetDesc=function(){var t=Math.round(1e4*this._num)/100;return s.StringUtil.format("{1}:\u56de\u590d{0}%\u6700\u5927\u751f\u547d\u503c",t,l.FW.G_W(this.ref.name))},e.prototype.LoadRef=function(t){return this.Ref.RefMgritem.getRef("resId",t)},e.prototype.OnUpdateResId=function(){},e.prototype.Apply=function(){if(this.resId==c.ECurrencyType.cure){var t=this.ComVar.HEROID,e=this._num,r=this.ComVar.HP_Max[t]*e;this.ComVar.takeRestore(t,r)}else l.FW.ZJJ.log("\u672a\u914d\u7f6e\u9053\u5177:"+this.resId)},e.prototype.OnClear=function(){this._num=null,t.prototype.OnClear.call(this)},e.prototype.UpdateNumber=function(t){this._num=t},e.__cname="GPOCure_pre",i([a.injectField("Ref")],e.prototype,"Ref",void 0),i([a.injectField("ComVar")],e.prototype,"ComVar",void 0),e}(t("./ConstSubGameplay").GPObj);r.GPOCure_pre=u,cc._RF.pop()},{"../../../../../../../framework/FW":void 0,"../../../../../../../framework/container/Container":void 0,"../../../../../../../framework/utils/StringUtil":void 0,"../../../../../model/goods/ModelGoods":"ModelGoods","./ConstSubGameplay":"ConstSubGameplay"}],GPOItem:[function(t,e,r){"use strict";cc._RF.push(e,"3d5d1UB1/FFprFHrKUf/gtC","GPOItem");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.GPObjItem=void 0;var a=t("../../../../../../../framework/container/Container"),l=t("../../../../../../../framework/FW"),s=t("../../../../../../../framework/utils/StringUtil"),c=t("../../../../../model/goods/ModelGoods"),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetName=function(){return l.FW.G_W(this.ref.name)},e.prototype.GetIcon=function(){return this.ref.icon},e.prototype.GetDesc=function(){return s.StringUtil.format("{0}*{1}",this._num,l.FW.G_W(this.ref.name))},e.prototype.LoadRef=function(t){return this.Ref.RefMgritem.getRef("resId",t)},e.prototype.OnUpdateResId=function(){},e.prototype.Apply=function(t){if(void 0===t&&(t=!1),this.resId==c.ECurrencyType.coin)this.ComVar.takeGold(this._num,t);else if(this.resId==c.ECurrencyType.cure){var e=this.ComVar.HEROID;this.ComVar.takeRestore(e,this._num)}else l.FW.ZJJ.log("\u672a\u914d\u7f6e\u9053\u5177:"+this.resId)},e.prototype.OnClear=function(){this._num=null,t.prototype.OnClear.call(this)},e.prototype.UpdateNumber=function(t){this._num=t},i([a.injectField("Ref")],e.prototype,"Ref",void 0),i([a.injectField("ComVar")],e.prototype,"ComVar",void 0),e}(t("./ConstSubGameplay").GPObj);r.GPObjItem=u,cc._RF.pop()},{"../../../../../../../framework/FW":void 0,"../../../../../../../framework/container/Container":void 0,"../../../../../../../framework/utils/StringUtil":void 0,"../../../../../model/goods/ModelGoods":"ModelGoods","./ConstSubGameplay":"ConstSubGameplay"}],GPOSkillModify:[function(t,e,r){"use strict";cc._RF.push(e,"a0599k8vvNLcJAv+kD60FNW","GPOSkillModify");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.GPOSkillModify=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.Apply=function(){var t=this.ComVar.HEROID;this.ComSkill.SetHeroSkill(t,this.resId,this.level),this.GPHeroSkill.UpgradeSkill(this.resId,this.level),this.level>=1&&this.UpdateWedgit()},e.prototype.modifyApply=function(t){var e=this.ComVar.HEROID;this.GPHeroSkill.DeleteSkill(t),this.ComSkill.RemoveSkillByTypeId(e,t),this.Apply()},e.__cname="GPLevelUpSkill",e}(t("./GPOSkill").GPOSkill);r.GPOSkillModify=i,cc._RF.pop()},{"./GPOSkill":"GPOSkill"}],GPOSkill:[function(t,e,r){"use strict";cc._RF.push(e,"9c15e1T7+hIWLNwIy3oOAUK","GPOSkill");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.GPOSkill=void 0;var l=t("../../../../../../../framework/container/Container"),s=t("../../../../../../../framework/FW"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.IsShowLevel=function(){return!0},e.prototype.Clear=function(){this.isBroken=null,this.ClearWedgit(),t.prototype.Clear.call(this)},e.prototype.GetIsBroken=function(){return this.isBroken},e.prototype.LoadRef=function(t){var e=this.GetLevel(),r=this.ModelBattleSkill.FindSkillLevel(t,e);return this.refSkill=this.ModelBattleSkill.GetSkill(t).GetRef(),r},e.prototype.OnUpdateResId=function(t){this.resId=t,this.isBroken=6==this.level},e.prototype.GetDesc=function(){return s.FW.G_W(this.ref.GetRef().desc)},e.prototype.GetName=function(){return s.FW.G_W(this.refSkill.name)},e.prototype.GetIcon=function(){return this.refSkill.icon},e.prototype.Apply=function(){var t,e,r=this.ComVar.HEROID,o=this.ModelBattleSkill.GetEvolutionBySkill(this.resId);if(o){var n=o.GetNeed();if(n&&n.length>0)try{for(var i=a(n),l=i.next();!l.done;l=i.next()){var c=l.value;this.ModelBattleSkill.GetIsSkill(c.resId)&&(this.GPHeroSkill.DeleteSkill(c.resId),this.ComSkill.RemoveSkillByTypeId(r,c.resId),c.resId==this.Battle.startConfig.mainSkill&&(this.Battle.startConfig.mainSkill=this.resId,s.FW.ZJJ.log("\u4e3b\u6280\u80fd\u5df2\u4fee\u6539\u4e3a:",this.resId)))}}catch(u){t={error:u}}finally{try{l&&!l.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}}this.ComSkill.SetHeroSkill(r,this.resId,this.level),this.GPHeroSkill.UpgradeSkill(this.resId,this.level),this.level>=1&&this.UpdateWedgit()},e.prototype.UpdateWedgit=function(){var t=this.ComVar.HEROID,e=this.ModelBattleSkill.GetSkill(this.resId).GetModel();e&&(this.lastModel=e,this.ComPrefab.AddWedgit(t,e))},e.prototype.ClearWedgit=function(){var t=this.ComVar.HEROID,e=this.lastModel;e&&this.ComPrefab.RemoveWedgit(t,e)},e.__cname="GPLevelUpSkill",i([l.injectField("ModelBattleSkill")],e.prototype,"ModelBattleSkill",void 0),i([l.injectField("GPHeroSkill")],e.prototype,"GPHeroSkill",void 0),i([l.injectField("GPSkillData")],e.prototype,"GPSkillData",void 0),i([l.injectField("ComSkill")],e.prototype,"ComSkill",void 0),i([l.injectField("ComVar")],e.prototype,"ComVar",void 0),i([l.injectField("ComPrefab")],e.prototype,"ComPrefab",void 0),i([l.injectField("Battle")],e.prototype,"Battle",void 0),e}(t("./ConstSubGameplay").GPObjUpgradeable);r.GPOSkill=c,cc._RF.pop()},{"../../../../../../../framework/FW":void 0,"../../../../../../../framework/container/Container":void 0,"./ConstSubGameplay":"ConstSubGameplay"}],GPOSpecialEffect:[function(t,e,r){"use strict";cc._RF.push(e,"923448IOItIJb6S1SRs9/D4","GPOSpecialEffect");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.GPOSpecialEffect=void 0;var a=t("../../../../../../../framework/container/Container"),l=t("../../../../../../../framework/FW"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetName=function(){return this._name},e.prototype.GetIcon=function(){return this.ref.icon},e.prototype.GetDesc=function(){return this._desc},e.prototype.LoadRef=function(t){return this.Ref.RefMgrheroPassiveSkill.getRef("id",t)},e.prototype.OnUpdateResId=function(){this.OnUpdateSkillgroup()},e.prototype.Apply=function(){},e.prototype.OnClear=function(){this._desc=null,this._name=null},e.prototype.OnUpdateSkillgroup=function(){var t=this.Ref.RefMgrskillGroup.getRef("refId",this.ref.skillGroup);this._desc=l.FW.G_W(t.desc),this._name=l.FW.G_W(t.name)},e.prototype.SetUnlock=function(t){this._unlock=t},e.prototype.GetUnlock=function(){return this._unlock},i([a.injectField("Ref")],e.prototype,"Ref",void 0),e}(t("./ConstSubGameplay").GPObj);r.GPOSpecialEffect=s,cc._RF.pop()},{"../../../../../../../framework/FW":void 0,"../../../../../../../framework/container/Container":void 0,"./ConstSubGameplay":"ConstSubGameplay"}],GPOSupply:[function(t,e,r){"use strict";cc._RF.push(e,"1aab3HvGi5MLoa3PAPjQXnI","GPOSupply");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.GPOSupply=void 0;var l=t("../../../../../../../framework/container/Container"),s=t("../../../../../../../framework/FW"),c=t("../../var/ComVar"),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tlCompare=[],e}return n(e,t),e.prototype.IsShowLevel=function(){return!0},e.prototype.LoadRef=function(t){var e=this.level,r=this.ModelBattleSkill.FindSupplyLevel(t,e);return this.refSupply=this.ModelBattleSkill.GetSupply(t),r},e.prototype.OnUpdateResId=function(){this.OnUpdateDesc(),this.OnUpdateCompare()},e.prototype.OnUpdateDesc=function(){var t="",e=this.GetBuffId();null!=e&&(t=this.Ref.RefMgrskillGroup.getRef("refId",e).desc,t=s.FW.G_W(t)),this.desc=t},e.prototype.GetDesc=function(){return this.desc},e.prototype.GetName=function(){return s.FW.G_W(this.refSupply.GetName())},e.prototype.GetIcon=function(){return this.refSupply.GetIcon()},e.prototype.OnUpdateCompare=function(){this.Battle.startConfig;var t,e,r=this.tlCompare;r.length=0;try{for(var o=a(this.ModelBattleSkill.FindSupplyCompare(this.resId)),n=o.next();!n.done;n=o.next()){var i=n.value;if(0==this.IsSkillOrSupplyInUse(i))break;r.push(i)}}catch(l){t={error:l}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}},Object.defineProperty(e.prototype,"skills",{get:function(){return this._skills||(this._skills=new Set(this.Battle.startConfig.skills))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"supplys",{get:function(){return this._supplys||(this._supplys=new Set(this.Battle.startConfig.supply))},enumerable:!1,configurable:!0}),e.prototype.IsSkillOrSupplyInUse=function(t){return this.ModelBattleSkill.GetIsSkill(t)?this.skills.has(t):!!this.ModelBattleSkill.GetIsSupply(t)&&this.supplys.has(t)},e.prototype.isSkillOrSupplyUpgrade=function(t){return this.ModelBattleSkill.GetIsSkill(t)?this.GPHeroSkill.HasSkill(t):!!this.ModelBattleSkill.GetIsSupply(t)&&this.GPHeroSupply.HasSupply(t)},e.prototype.GetCompare=function(){return this.tlCompare},e.prototype.GetBuffId=function(){var t=this.GetLevel();return this.ref?this.ref.GetBuff()[t-1]:null},e.prototype.Apply=function(){var t=this;this.GPHeroSupply.UpgradeSupply(this.resId,this.level);var e=this.GetBuffId();this.SetSkillGroup(e);var r=this.Battle.GetCom(c.ComVar),o=this.GPHeroSupply.GetTlSupply(),n=0;o.forEach(function(t){t.isEmpty||n++});var i=r.SUPPLY_ADD[n]||0;0!=i&&this.Ref.RefMgrskillGroup.getRef("refId",e).skillGroup.forEach(function(e){var o=t.Ref.RefMgrbuff.getRef("refId",e).effect[0],n=t.Ref.RefMgrroleAttribute.getRef("refId",o),a=r.GetAttr(r.HEROID,n.key);null==a||a.setExtraAdd(i)})},e.prototype.SetSkillGroup=function(t){this.GPHeroSkill.learnSkill[this.resId]&&this.SystemBuff.RemoveSkillGroupId(this.GPHeroSkill.learnSkill[this.resId]),this.GPHeroSkill.learnSkill[this.resId]=t,this.SystemBuff.AddSkillGroupId(t)},e.__cname="GPLevelUpSupply",i([l.injectField("ModelBattleSkill")],e.prototype,"ModelBattleSkill",void 0),i([l.injectField("Ref")],e.prototype,"Ref",void 0),i([l.injectField("Battle")],e.prototype,"Battle",void 0),i([l.injectField("GPHeroSupply")],e.prototype,"GPHeroSupply",void 0),i([l.injectField("GPHeroSkill")],e.prototype,"GPHeroSkill",void 0),i([l.injectField("SystemBuff")],e.prototype,"SystemBuff",void 0),e}(t("./ConstSubGameplay").GPObjUpgradeable);r.GPOSupply=u,cc._RF.pop()},{"../../../../../../../framework/FW":void 0,"../../../../../../../framework/container/Container":void 0,"../../var/ComVar":"ComVar","./ConstSubGameplay":"ConstSubGameplay"}],GPPlaySound:[function(t,e,r){"use strict";cc._RF.push(e,"c1c0bB38UtBxLfA3IAQH/5y","GPPlaySound");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.GPPlaySound=void 0;var a=t("../../../../../../../framework/container/Container"),l=t("../../../../../../../framework/FW"),s=t("../../../../../../../framework/utils/Toolset"),c=t("../../../../../../utils/MathUtil"),u=t("../../event/SystemEvent"),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isPlaySound=!1,e.isPause=!1,e.isPlayLevel=!1,e}return n(e,t),e.prototype.OnInit=function(){},e.prototype.OnEnter=function(){var t=this.Battle.startConfig.hero,e=this.ModelMgr.ModelHero.GetHeroRef(t);this.audioRef=this.ModelMgr.ModelHero.GetHeroAudioRef(e.audio),this.stayCount=0,this.stayPro=this.audioRef.stayPro,this.stayInterval=this.audioRef.stayInterval,this.levelCount=0,this.levelPro=this.audioRef.levelPro,this.levelInterval=this.audioRef.levelInterval,this.max=100,this.min=0,this.InitEvent()},e.prototype.OnUpdate=function(t){var e=this;e.isPlayLevel&&(e.levelCount+=t,e.levelCount>=e.levelInterval&&(e.isPlayLevel=!1,e.levelCount=0)),e.isPause||(e.stayCount+=t,e.stayCount>=e.stayInterval&&(e.stayCount=0,e.playStaySound()))},e.prototype.InitEvent=function(){var t=this,e=t.SystemEvent;t.toolSet=s.ToolSet.createToolSet(),t.toolSet.addListener(e.GetEventPorxy(),u.EBattleEvent.LevelUp,function(){if(!t.isPlayLevel&&c.MathUtil.GetRand(t.min,t.max,2)<=t.max*t.levelPro){t.isPlayLevel=!0;var e=c.MathUtil.GetRand(0,t.audioRef.levelUpAudio.length),r=t.audioRef.levelUpAudio[e];t.playSound(r)}}),t.toolSet.addListener(e.GetEventPorxy(),u.EBattleEvent.Paused,function(){t.isPause=!0}),t.toolSet.addListener(e.GetEventPorxy(),u.EBattleEvent.Resume,function(){t.isPause=!1})},e.prototype.playStaySound=function(){var t=this;if(c.MathUtil.GetRand(t.min,t.max,2)<=t.max*t.stayPro){var e=t.audioRef.stayAudio,r=e.length,o=this.cacheIndex;if(r>2){for(;t.cacheIndex==o;)o=c.MathUtil.GetRand(0,r,2);t.cacheIndex=o}else null==o&&(o=c.MathUtil.GetRand(0,r,2),t.cacheIndex=o);t.playSound(e[o])}},e.prototype.stopSound=function(){this.audioId&&(this.CtrlAudio.Stop(this.audioId),this.audioId=null)},e.prototype.playSound=function(t){if(null!=t){var e=this;e.isPlaySound||e.CtrlAudio.PlaySound(t,function(){l.FW.LWX.log("\u8bed\u97f3\u64ad\u653e\u5b8c\u6bd5"),e.isPlaySound=!1}).then(function(t){e.isPlaySound=!0,e.audioId=t})}},e.__cname="GPPlaySound",i([a.injectField("Battle")],e.prototype,"Battle",void 0),i([a.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([a.injectField("CtrlAudio")],e.prototype,"CtrlAudio",void 0),i([a.injectField("SystemEvent")],e.prototype,"SystemEvent",void 0),e}(t("../SubGamePlay").SubGamePlay);r.GPPlaySound=p,cc._RF.pop()},{"../../../../../../../framework/FW":void 0,"../../../../../../../framework/container/Container":void 0,"../../../../../../../framework/utils/Toolset":void 0,"../../../../../../utils/MathUtil":"MathUtil","../../event/SystemEvent":"SystemEvent","../SubGamePlay":"SubGamePlay"}],GPSkillData:[function(t,e,r){"use strict";cc._RF.push(e,"601eeKJ+ytNGZyUn7QYNAHy","GPSkillData");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.GPSkillData=r.GPSkillDataBulletParamHandler=r.GPSkillDataSkillParamHandler=r.GPSkillDataSkillAttrHandler=r.ModifyBulletHandler=r.ModifyBulletReason=void 0;var s,c=t("../../../../../../../framework/container/Container"),u=t("../../../../../../../framework/event/EventCallback"),p=t("../../../../../../../framework/FW"),f=t("../../../../attr/AttrWrap"),h=t("../SubGamePlay");(function(t){t[t.Default=0]="Default",t[t.Weapon=1]="Weapon",t[t.Fuben=2]="Fuben",t[t.Count=3]="Count"})(s=r.ModifyBulletReason||(r.ModifyBulletReason={}));r.ModifyBulletHandler=function(){};var y=function(){function t(){this.tmAttrKV=new Map,this.tmKeyRef=new Map,this.tmAttr4Id=new Map,this.tmAttr4Key=new Map}return t.prototype._GetAttrKVBy=function(t){var e=this.tmAttrKV.get(t);return null==e&&(e=new Map,this.tmAttrKV.set(t,e)),e},t.prototype._SetAttrKVBy=function(t,e,r){this._GetAttrKVBy(t).set(e,r)},t.prototype.Add=function(t,e,r,o){var n=this._GetAttrKVBy(t);n.has(e)&&p.FW.ZJJ.log("\u6280\u80fd\u5c5e\u6027\u91cd\u590d\u8d4b\u503c\uff01"+e+" "+r+" value:"+o,t),n.set(e,o),this.AddRefKey(r),this.SetAttr(e,r,o)},t.prototype.Delete=function(t,e,r,o){var n=this._GetAttrKVBy(t);n.delete(e),0==n.size&&this.tmAttrKV.delete(t),this.RemoveRefKey(r),this.SetAttr(e,r,-o)},t.prototype.SetAttr=function(t,e,r){var o=(this.tmAttr4Id.get(t)||0)+r;this.tmAttr4Id.set(t,o),this.tmAttr4Key.set(e,o)},t.prototype.GetByResId=function(t){return this.tmAttr4Id.get(t)},t.prototype.GetByKey=function(t){return this.tmAttr4Key.get(t)},t.prototype.AddRefKey=function(t){var e=this.tmKeyRef.get(t)||0;this.tmKeyRef.set(t,e+1)},t.prototype.RemoveRefKey=function(t){var e=this.tmKeyRef.get(t)||0;this.tmKeyRef.set(t,Math.max(0,e-1))},t.prototype.HasKey=function(t){var e=this.tmKeyRef.get(t);return e&&e>0},t}();r.GPSkillDataSkillAttrHandler=y;var d=function(){function t(){this.tmParam=new Map,this.tlCaller=[]}return t.prototype.Add=function(t,e){this.Delete(t),this.tmParam.set(t,e),this.tlCaller.push(t)},t.prototype.Get=function(t){return this.tmParam.get(t)},t.prototype.GetLast=function(t){void 0===t&&(t=null);var e=t;if(this.tlCaller.length>0){var r=this.tlCaller[this.tlCaller.length-1];e=this.Get(r)}return e},t.prototype.Delete=function(t){var e=this.tmParam.get(t);if(null!=e){var r=this.tlCaller.indexOf(t);this.tlCaller.splice(r,1),this.tmParam.delete(t)}return e},t}();r.GPSkillDataSkillParamHandler=d;var m=function(){function t(){this.tmParam=new Map,this.tlCaller=[]}return t.prototype.Add=function(t,e){this.Delete(t),this.tmParam.set(t,e),this.tlCaller.push(t)},t.prototype.Get=function(t){return this.tmParam.get(t)},t.prototype.GetLast=function(t){void 0===t&&(t=null);var e=t;if(this.tlCaller.length>0){var r=this.tlCaller[this.tlCaller.length-1];e=this.Get(r)}return e},t.prototype.Delete=function(t){var e=this.tmParam.get(t);if(null!=e){var r=this.tlCaller.indexOf(t);this.tlCaller.splice(r,1),this.tmParam.delete(t)}return e},t}();r.GPSkillDataBulletParamHandler=m;var v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.SkillReadyCallback=new u.EventCallback,e.skillReday=!1,e.tmSkillOrSupply=new Map,e.handlers=[],e.tmBulletHandler=new Map,e.tmSkillAttr=new Map,e._attr=new f.AttrWrap,e.tmParam=new Map,e}return n(e,t),e.prototype.SetMainSkill=function(t){this.mainSkill=t},e.prototype.GetMainSkill=function(){return this.mainSkill},e.prototype.SetSkillOrSupply=function(t,e){this.tmSkillOrSupply.set(t,e)},e.prototype.GetTmSkillOrSupply=function(){return this.tmSkillOrSupply},e.prototype.GetSkillHandler=function(t,e){var r;return(r=(r=this.handlers)[t]||(r[t]=[]))[e]||(r[e]=[])},e.prototype.SetSkillBullet=function(t,e,r,o){this.GetSkillHandler(t,e)[r]={reason:t,resId:e,bullets:o}},e.prototype.DeleteSkillBullet=function(t,e,r){null!=this.handlers[t]&&null!=this.handlers[t][e]&&null!=this.handlers[t][e][r]&&(this.handlers[t][e][r]=null)},e.prototype.GetSkillBullet=function(t,e){for(var r,o=s.Count-1;o>=0;o--){var n=o;if(null!=this.handlers[n]&&null!=this.handlers[n][t]&&null!=this.handlers[n][t][e]){r=this.handlers[n][t][e].bullets;break}}return r},e.prototype.GetBulletParamHandler=function(t){var e=this.tmBulletHandler.get(t);return null==e&&((e=new m).bulletId=t,this.tmBulletHandler.set(t,e)),e},e.prototype.SetBulletParam=function(t,e,r){this.GetBulletParamHandler(t).Add(r,e)},e.prototype.DeleteBulletParam=function(t,e){0!=this.tmBulletHandler.has(t)&&this.GetBulletParamHandler(t).Delete(e)},e.prototype.GetBulletParam=function(t){return this.GetBulletParamHandler(t).GetLast()},e.prototype.GetSkillAttrHandler=function(t){var e=this.tmSkillAttr.get(t);return null==e&&((e=new y).skillId=t,this.tmSkillAttr.set(t,e)),e},e.prototype.SetSkillAttr=function(t,e,r,o){var n=this.GetSkillAttrHandler(t),i=this.ModelAttr.GetRefRoleAttribute(r);n.Add(e,r,i.GetKey(),o)},e.prototype.DeleteSkillAttr=function(t,e,r,o){if(0!=this.tmSkillAttr.has(t)){var n=this.GetSkillAttrHandler(t),i=this.ModelAttr.GetRefRoleAttribute(r);n.Delete(e,r,i.GetKey(),o)}},e.prototype.HasSkillAttr=function(t,e){return!!this.tmSkillAttr.has(t)&&this.tmSkillAttr.get(t).HasKey(e)},e.prototype.GetSkillAttr=function(t,e,r){var o,n,i,s;void 0===r&&(r=0);var c=this._attr;if(c.Clear(),c.base=r,this.tmSkillAttr.has(t)){var u=this.tmSkillAttr.get(t);try{for(var p=a(u.tmAttrKV),f=p.next();!f.done;f=p.next()){var h=l(f.value,2),y=(h[0],h[1]);try{for(var d=(i=void 0,a(y)),m=d.next();!m.done;m=d.next()){var v=l(m.value,2),_=v[0],S=v[1],g=this.ModelAttr.GetRefRoleAttribute(_);if(g.GetKey()==e){var b=g.ParseValue(S);g.GetIsAddition()?c.addition+=b:g.GetIsRate()&&(c.rate+=b)}}}catch(C){i={error:C}}finally{try{m&&!m.done&&(s=d.return)&&s.call(d)}finally{if(i)throw i.error}}}}catch(R){o={error:R}}finally{try{f&&!f.done&&(n=p.return)&&n.call(p)}finally{if(o)throw o.error}}}return c},e.prototype.GetSkillAttrValue=function(t,e,r){void 0===r&&(r=0);var o=r,n=this.GetSkillAttr(t,e);return n&&(o=n.GetValue()),o},e.prototype.GetParamHandler=function(t){var e=this.tmParam.get(t);return null==e&&(e=new d,this.tmParam.set(t,e)),e},e.prototype.SetSkillParam=function(t,e,r){var o=this.GetParamHandler(t);return o.Add(r,e),o},e.prototype.DeleteSkillParam=function(t,e){return this.GetParamHandler(t).Delete(e)},e.prototype.GetSkillParam=function(t){return this.GetParamHandler(t).GetLast()},e.prototype.HasSkillParam=function(t){var e=!1;return this.tmParam.has(t)&&(e=this.GetParamHandler(t).tmParam.size>0),e},e.prototype.OnInit=function(){for(var t=0;t<s.Count;t++)this.handlers.push([])},e.prototype.OnEnter=function(){var t,e;null!=this.mainSkill&&0==this.tmSkillOrSupply.has(this.mainSkill)&&(this.GPHeroSkill.UpgradeSkill(this.mainSkill),this.GPHeroSkill.GetSkill(this.mainSkill).Apply());try{for(var r=a(this.tmSkillOrSupply),o=r.next();!o.done;o=r.next()){var n=l(o.value,2),i=n[0],s=n[1];this.ModelBattleSkill.GetIsSkill(i)?(this.GPHeroSkill.UpgradeSkill(i,s),this.GPHeroSkill.GetSkill(i).Apply()):this.ModelBattleSkill.GetIsSupply(i)&&(this.GPHeroSupply.UpgradeSupply(i,s),this.GPHeroSupply.GetSupply(i).Apply())}}catch(c){t={error:c}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}this.SkillReadyCallback.execute(),this.skillReday=!0},e.__cname="GPSkillData",i([c.injectField("GPHeroSkill")],e.prototype,"GPHeroSkill",void 0),i([c.injectField("GPHeroSupply")],e.prototype,"GPHeroSupply",void 0),i([c.injectField("ModelAttr")],e.prototype,"ModelAttr",void 0),i([c.injectField("ModelBattleSkill")],e.prototype,"ModelBattleSkill",void 0),e}(h.SubGamePlay);r.GPSkillData=v,cc._RF.pop()},{"../../../../../../../framework/FW":void 0,"../../../../../../../framework/container/Container":void 0,"../../../../../../../framework/event/EventCallback":void 0,"../../../../attr/AttrWrap":"AttrWrap","../SubGamePlay":"SubGamePlay"}],GPSpecialEffect:[function(t,e,r){"use strict";cc._RF.push(e,"854a8NTSo9AwZNPPSY8gBwp","GPSpecialEffect");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.GPSpecialEffect=void 0;var l=t("../../../../../../../framework/container/Container"),s=t("../SubGamePlay"),c=t("./GPOSpecialEffect"),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tlPassiveSkill=[],e}return n(e,t),Object.defineProperty(e.prototype,"startConfig",{get:function(){return this.Battle.startConfig},enumerable:!1,configurable:!0}),e.prototype.OnEnter=function(){this.InitList()},e.prototype.OnExit=function(){},e.prototype.InitList=function(){var t,e,r=this.startConfig.hero,o=this.tlPassiveSkill;try{for(var n=a(this.ModelHero.GetTlPassiveSkill(r)),i=n.next();!i.done;i=n.next()){var l=i.value,s=new c.GPOSpecialEffect;this.container.inject(s),s.SetUnlock(!0),s.UpdateResId(l.id),o.push(s)}}catch(u){t={error:u}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}},e.prototype.GetList=function(){return this.tlPassiveSkill},e.prototype.GetIcon=function(){var t=this.startConfig.hero,e=this.ModelHero.GetHeroRef(t);return e&&e.iconBattle},e.__cname="GPSpecialEffect",i([l.injectField("Battle")],e.prototype,"Battle",void 0),i([l.injectField("ModelHero")],e.prototype,"ModelHero",void 0),e}(s.SubGamePlay);r.GPSpecialEffect=u,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../SubGamePlay":"SubGamePlay","./GPOSpecialEffect":"GPOSpecialEffect"}],GPStartDrop:[function(t,e,r){"use strict";cc._RF.push(e,"ceab7DVhhhGoZv3E0KD262Y","GPStartDrop");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.GPStartDrop=void 0;var c=t("../../../../../../../framework/container/Container"),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isReconnect=!1,e}return n(e,t),e.prototype.HandlerStartDrop=function(){return a(this,void 0,void 0,function(){return l(this,function(){return this.isReconnect?this.handlerReconnect():this.handlerStart(),[2,null]})})},e.prototype.handlerStart=function(){var t,e;this.MarkReconnect();var r=this.ModelBattleDrop.GetStartDropConfig(),o=r.GetStartDrop();try{for(var n=s(o),i=n.next();!i.done;i=n.next()){var a=i.value;this.SystemEvent.sendStartDrop(a.resId,a.num,r.GerRadius())}}catch(l){t={error:l}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}},e.prototype.handlerReconnect=function(){var t,e,r=this.ModelBattleDrop.GetStartDropConfig(),o=r.GetReconnectDrop();try{for(var n=s(o),i=n.next();!i.done;i=n.next()){var a=i.value;this.SystemEvent.sendStartDrop(a.resId,a.num,r.GerRadius())}}catch(l){t={error:l}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}},e.prototype.MarkReconnect=function(){this.isReconnect=!0},e.prototype.GetRuntimeKey=function(){return"__GPStartDrop"},e.prototype.GetRuntimtData=function(){return""+(this.isReconnect?1:0)},e.prototype.ResumeRuntmeData=function(t){if(null!=t){var e=parseInt(t);this.isReconnect=1==e}},e.__cname="GPStartDrop",i([c.injectField("SystemEvent")],e.prototype,"SystemEvent",void 0),i([c.injectField("ModelBattleDrop")],e.prototype,"ModelBattleDrop",void 0),e}(t("../SubGamePlay").SubGamePlay);r.GPStartDrop=u,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../SubGamePlay":"SubGamePlay"}],GPStart:[function(t,e,r){"use strict";cc._RF.push(e,"5ee3chDOHpMBLbKnQPk3iqE","GPStart");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.GPStart=void 0;var c=t("../../../../../../../framework/container/Container"),u=t("../../../../../../../framework/FW"),p=t("../../../../../../../framework/utils/PromiseWrap"),f=t("../../../../../../../framework/utils/Toolset"),h=t("../../event/SystemEvent"),y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.toolSet=f.ToolSet.createToolSet(),e}return n(e,t),Object.defineProperty(e.prototype,"mainSkill",{get:function(){return this.Battle.startConfig.mainSkill},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"enterSelector",{get:function(){return this.Battle.startConfig.enterSelector},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hero",{get:function(){return this.Battle.startConfig.hero},enumerable:!1,configurable:!0}),e.prototype.onDestroy=function(){f.ToolSet.destroyToolSet(this.toolSet)},e.prototype.OnBeforeStart=function(){return a(this,void 0,Promise,function(){var t,e,r,o,n,i,a,s;return l(this,function(){return t=c.Container.inst().getByAlias("ModelHero"),e=c.Container.inst().getByAlias("ModelPrefab"),r=this.getRoleId(),o=t.GetHeroRef(r),n=o.modelBattle,i=e.PreLoadAsset(n),a=!1,s=function(){a=!0},i.then(function(){return s()}).catch(function(t){s(),t&&u.FW.ZJJ.error(t)}),[2,u.FW.Task.waitUntil(function(){return 1==a})]})})},e.prototype.OnEnter=function(){this.OnEnterInner()},e.prototype.OnEnterInner=function(){return a(this,void 0,void 0,function(){return l(this,function(t){switch(t.label){case 0:return this.porcessHero(),0!=this.Battle.startConfig.noEvent?[3,4]:[4,this.processStartSelector()];case 1:return t.sent(),[4,this.processGoldChest()];case 2:return t.sent(),[4,this.GPStartDrop.HandlerStartDrop()];case 3:t.sent(),this.processStartSkillReplace(),t.label=4;case 4:return this.Battle.startConfig.bossNodeChest&&(this.Battle.startConfig.bossNodeChest=!1,this.processBossNodeChest()),[2]}})})},e.prototype.getRoleId=function(){var t,e,r=this.Battle.startConfig;if(r.resumeData){var o=r.resumeData.cmdBattleBeat;if(o)try{for(var n=s(o.roles),i=n.next();!i.done;i=n.next())return i.value.roleId}catch(a){t={error:a}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}}return r.hero},e.prototype.porcessHero=function(){this.SystemRole.CreateHero(this.getRoleId()),this.Battle.applyModify(),0==this.GPNetSync.ResumeRole()&&this.GPSkillData.SetMainSkill(this.mainSkill)},e.prototype.processStartSelector=function(){return a(this,void 0,void 0,function(){var t,e,r=this;return l(this,function(){return t=new p.PromiseWrap,this.enterSelector?(this.SystemEvent.sendEnterSelector(),e=this.toolSet.addListener(this.SystemEvent.GetEventPorxy(),h.EBattleEvent.SelectUpgrade,function(){r.markStartSelector(),r.toolSet.removeListener(e),t.resolve()})):t.resolve(),[2,t.promise]})})},e.prototype.processStartSkillReplace=function(){var t;(null===(t=this.Battle.startConfig.resumeData)||void 0===t?void 0:t.bossSavePoint)&&this.SystemEvent.sendSkillReplace()},e.prototype.markStartSelector=function(){this.Battle.startConfig.takeEnterSelector()},e.prototype.processGoldChest=function(){for(var t=new p.PromiseWrap;0!=this.GPChest.GetCanTakeGoldChest();){var e=this.Battle.startConfig.enterGold;if(null==e||this.Battle.startConfig.bossNodeChest)break;this.SystemEvent.sendFirstGoldChest(e);break}return t.resolve(),t.promise},e.prototype.processBossNodeChest=function(){this.SystemEvent.sendBossNodeChest()},e.__cname="GPStart",i([c.injectField("Battle")],e.prototype,"Battle",void 0),i([c.injectField("SystemRole")],e.prototype,"SystemRole",void 0),i([c.injectField("ComVar")],e.prototype,"ComVar",void 0),i([c.injectField("GPLevelUp")],e.prototype,"GPLevelUp",void 0),i([c.injectField("GPHeroSkill")],e.prototype,"GPHeroSkill",void 0),i([c.injectField("SystemEvent")],e.prototype,"SystemEvent",void 0),i([c.injectField("GPNetSync")],e.prototype,"GPNetSync",void 0),i([c.injectField("GPSkillData")],e.prototype,"GPSkillData",void 0),i([c.injectField("LayerUnlockSkill")],e.prototype,"LayerUnlockSkill",void 0),i([c.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([c.injectField("GPStartDrop")],e.prototype,"GPStartDrop",void 0),i([c.injectField("GPGuide")],e.prototype,"GPGuide",void 0),i([c.injectField("GPChest")],e.prototype,"GPChest",void 0),i([c.injectField("SystemView")],e.prototype,"SystemView",void 0),e}(t("../SubGamePlay").SubGamePlay);r.GPStart=y,cc._RF.pop()},{"../../../../../../../framework/FW":void 0,"../../../../../../../framework/container/Container":void 0,"../../../../../../../framework/utils/PromiseWrap":void 0,"../../../../../../../framework/utils/Toolset":void 0,"../../event/SystemEvent":"SystemEvent","../SubGamePlay":"SubGamePlay"}],GameBehavior:[function(t,e,r){"use strict";cc._RF.push(e,"eb6a7cTbB9KjI4M9Jy3CX86","GameBehavior");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.GameBehavior=void 0;var l=function(t){function e(){return t.call(this)||this}return n(e,t),e.prototype.enterWrap=function(){return i(this,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return[4,this.enter()];case 1:return t.sent(),[2]}})})},e.prototype.exitWrap=function(){return i(this,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return[4,this.exit()];case 1:return t.sent(),[2]}})})},e.prototype.startup=function(){},e.prototype.enter=function(){return i(this,void 0,void 0,function(){return a(this,function(){return[2]})})},e.prototype.exit=function(){return i(this,void 0,void 0,function(){return a(this,function(){return[2]})})},e.prototype.afterEnterGame=function(){return i(this,void 0,void 0,function(){return a(this,function(){return[2]})})},e.__cname="GameBehavior",e}(t("../../framework/base/ScriptObject").ScriptObject);r.GameBehavior=l,cc._RF.pop()},{"../../framework/base/ScriptObject":void 0}],GameLayerMain:[function(t,e,r){"use strict";cc._RF.push(e,"c08043l7dlEIaQRgjfk92Ha","GameLayerMain");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.GameLayerMainUI=r.GameLayerMainProxy=void 0;var l=t("../../../framework/layer/AppLayer"),s=t("../../../framework/layer/AppLayerProxy"),c=t("../../../framework/layer/common/UIOrder"),u=t("./GameUIUtil"),p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getSortOrder=function(){return c.LayerOrder.Main},e.__cname="GameLayerMainProxy",e}(s.AppLayerProxy);r.GameLayerMainProxy=p;var f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetHasBackground=function(){return!1},e.prototype.initWrap=function(e){return i(this,void 0,Promise,function(){return a(this,function(r){switch(r.label){case 0:return[4,t.prototype.initWrap.call(this,e)];case 1:return r.sent(),this.initUIFullCoverFlag(),[2]}})})},e.prototype.initUIFullCoverFlag=function(){null!=u.default.getUIFullCoverCom(this.com)&&(this.isFullFlag=!0)},e.__cname="GameHUDUI",e}(l.AppLayer);r.GameLayerMainUI=f,cc._RF.pop()},{"../../../framework/layer/AppLayer":void 0,"../../../framework/layer/AppLayerProxy":void 0,"../../../framework/layer/common/UIOrder":void 0,"./GameUIUtil":"GameUIUtil"}],GameLayer:[function(t,e,r){"use strict";cc._RF.push(e,"434dfXCw5pKiJXkEkUsLTdv","GameLayer");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},l=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.GameLayerUI=r.GameLayerProxy=void 0;var s=t("../../../framework/FW"),c=t("../../../framework/layer/AppLayer"),u=t("../../../framework/layer/AppLayerProxy"),p=t("../../../framework/layer/common/UIMgr"),f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.__cname="GameLayerProxy",e}(u.AppLayerProxy);r.GameLayerProxy=f;var h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.release=function(){},e.prototype.enter=function(){},e.prototype.exit=function(){},e.prototype.update=function(){},e.prototype.LoadLayer_async=function(t){return i(this,void 0,void 0,function(){var e,r,o,n,i,c,u,f,h;return a(this,function(a){switch(a.label){case 0:e=[],r=function(t){t.load();var r=s.FW.Task.waitUntil(function(){return p.UIMgr.instance.isUIOpen(t.className)});e.push(r)};try{for(o=l(t),n=o.next();!n.done;n=o.next())i=n.value,r(i)}catch(y){f={error:y}}finally{try{n&&!n.done&&(h=o.return)&&h.call(o)}finally{if(f)throw f.error}}return c=!1,u=function(){c=!0},Promise.all(e).then(function(){return u()}).catch(function(t){u(),t&&s.FW.ZJJ.error(t)}),[4,s.FW.Task.waitUntil(function(){return c})];case 1:return a.sent(),[2]}})})},e.__cname="GameLayerUI",e}(c.AppLayer);r.GameLayerUI=h,cc._RF.pop()},{"../../../framework/FW":void 0,"../../../framework/layer/AppLayer":void 0,"../../../framework/layer/AppLayerProxy":void 0,"../../../framework/layer/common/UIMgr":void 0}],GamePanel:[function(t,e,r){"use strict";cc._RF.push(e,"281327w9AVFwKtIURDYnvl9","GamePanel");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.GamePanelUI=r.GamePanelProxy=void 0;var l=t("../../../framework/layer/AppPanel"),s=t("../../../framework/layer/AppPanelProxy"),c=t("./GameUIUtil"),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.__cname="GamePanelProxy",e}(s.AppPanelProxy);r.GamePanelProxy=u;var p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.initWrap=function(e){return i(this,void 0,void 0,function(){return a(this,function(r){switch(r.label){case 0:return[4,t.prototype.initWrap.call(this,e)];case 1:return r.sent(),this.initUIFullCoverFlag(),this.setCloseClick(),this.setBackClick(),this.setFloatPanel(),this.autoFitLiuHai(this.com),[2]}})})},e.prototype.release=function(){},e.prototype.enter=function(){},e.prototype.exit=function(){},e.prototype.update=function(){},e.prototype.initUIFullCoverFlag=function(){null!=c.default.getUIFullCoverCom(this.com)&&(this.isFullFlag=!0)},e.prototype.setCloseClick=function(t){var e=c.default.getUICloseCom(this.com);null!=e&&(null==t&&(t=this.onClose),e.visible&&e.setClick(t,this))},e.prototype.onClose=function(){this.unload()},e.prototype.setBackClick=function(t){var e=c.default.getUIBackCom(this.com);null!=e&&(null==t&&(t=this.unload),e.visible&&e.setClick(t,this))},e.prototype.setFloatPanel=function(){null!=c.default.getFloatCom(this.com)&&this.enableFloat()},e.__cname="GamePanelUI",e}(l.AppPanel);r.GamePanelUI=p,cc._RF.pop()},{"../../../framework/layer/AppPanel":void 0,"../../../framework/layer/AppPanelProxy":void 0,"./GameUIUtil":"GameUIUtil"}],GameScene:[function(t,e,r){"use strict";cc._RF.push(e,"e737frta0tIcow23e5MqXJ5","GameScene");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},l=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.GameScene=r.GameSceneProxy=void 0;var s=t("../../../framework/layer/AppSceneProxy"),c=t("../../../framework/layer/AppScene"),u=t("../../../framework/FW"),p=t("../../../framework/layer/common/UIMgr"),f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getIsRedsident=function(){return!0},e.__cname="GameSceneProxy",e}(s.AppSceneProxy);r.GameSceneProxy=f;var h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.release=function(){},e.prototype.enter=function(){},e.prototype.exit=function(){},e.prototype.update=function(){},e.prototype.LoadLayer_async=function(t){return i(this,void 0,void 0,function(){var e,r,o,n,i,s,c,f,h;return a(this,function(a){switch(a.label){case 0:e=[],r=function(t){t.load();var r=u.FW.Task.waitUntil(function(){return p.UIMgr.instance.isUIOpen(t.className)});e.push(r)};try{for(o=l(t),n=o.next();!n.done;n=o.next())i=n.value,r(i)}catch(y){f={error:y}}finally{try{n&&!n.done&&(h=o.return)&&h.call(o)}finally{if(f)throw f.error}}return s=!1,c=function(){s=!0},Promise.all(e).then(function(){return c()}).catch(function(t){c(),t&&u.FW.ZJJ.error(t)}),[4,u.FW.Task.waitUntil(function(){return s})];case 1:return a.sent(),[2]}})})},e.__cname="GameScene",e}(c.AppScene);r.GameScene=h,cc._RF.pop()},{"../../../framework/FW":void 0,"../../../framework/layer/AppScene":void 0,"../../../framework/layer/AppSceneProxy":void 0,"../../../framework/layer/common/UIMgr":void 0}],GameStateLogin:[function(t,e,r){"use strict";cc._RF.push(e,"806a3DJKIFFLKNnm5i/qRDN","GameStateLogin");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.GameStateLogin=void 0;var s=t("../../../../engine/EngineMain"),c=t("../../../../framework/container/Container"),u=t("../../../../framework/FW"),p=t("../../../../framework/layer/common/UIMgr"),f=t("../../ctrl/DataReporting/DataReportingInterface"),h=t("../../ctrl/login/LayerLogin"),y=t("../../ctrl/login/LayerLoginLoading"),d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.init=function(){},e.prototype.disconnect=function(){},e.prototype.reconnectSuc=function(){},e.prototype.connectFail=function(){},e.prototype.enter=function(){return a(this,void 0,void 0,function(){var t,e,r,o,n,i,a;return l(this,function(l){switch(l.label){case 0:return c.Container.inst().getByAlias("CtrlClickOnEffect").OnEnter(),t=this.onOffMgr.OnOffMusic.GetValue(),e=this.onOffMgr.OnOffSound.GetValue(),this.ctrlAudio.SetMusicVolume(t?1:0),this.ctrlAudio.SetSoundVolume(e?1:0),t&&this.ctrlAudio.PlayMusic("\u767e\u604b_\u6e38\u620f_\u767b\u5f55\u97f3\u4e50"),this.ctrlGM.tryShowGM(),(r=c.Container.inst().getByAlias("DataReporting")).PushBuriedList(f.SingleBuriedPointType.start_open_login_view),o=[],s.EngineMain.isMiniGameWeiXin?(o.push(u.FW.FairyMgr.loadByPkgNameAsync("\u767b\u5f55_\u516c\u7528\u5305",!0)),[3,3]):[3,1];case 1:return this.LayerLogin.SetIsLogin(!1),this.LayerLogin.load(),[4,u.FW.Task.waitUntil(function(){return p.UIMgr.instance.isUIOpen(h.LayerLogin)})];case 2:l.sent(),r.PushBuriedList(f.SingleBuriedPointType.end_open_login_view),this.RemoveLoginPic(),l.label=3;case 3:r.PushBuriedList(f.SingleBuriedPointType.sdk_login),n=!1,l.label=4;case 4:if(0!=n)return[3,15];l.label=5;case 5:return l.trys.push([5,7,,8]),[4,this.sDKMgr.getSDK().loginOrRegist()];case 6:return null==(i=l.sent())?n=!1:(s.EngineMain.saveLocalStorage("account_num",i.code),this.ModelAccount.setUserInfo(i),n=!0,r.PushBuriedList(f.SingleBuriedPointType.sdk_login_ok)),[3,8];case 7:return a=l.sent(),n=!1,a&&u.FW.Log.error(a.toString()),[3,8];case 8:return n?(this.LayerLogin.SetIsLogin(!0),s.EngineMain.isMiniGameWeiXin?[4,Promise.all(o)]:[3,11]):[3,12];case 9:return l.sent(),this.LayerLoginLoading.load(),[4,u.FW.Task.waitUntil(function(){return p.UIMgr.instance.isUIOpen(y.LayerLoginLoading)})];case 10:l.sent(),this.LayerLoginLoading.setVisible(!1),this.RemoveLoginPic(),this.gameStateMgr.switchToRunning(),l.label=11;case 11:return[3,15];case 12:return[4,u.FW.Task.delay(500)];case 13:l.sent(),l.label=14;case 14:return[3,4];case 15:return[2]}})})},e.prototype.RemoveLoginPic=function(){var t,e=cc.director.getScene().getChildByName("Canvas");(t=e.getChildByName("\u542f\u52a8"))&&(t.removeFromParent(),t.destroy()),(t=e.getChildByName("\u6e38\u620f\u5065\u5eb7\u5fe0\u544a"))&&(t.removeFromParent(),t.destroy())},e.__cname="GameStateLogin",i([c.injectField("LayerLogin")],e.prototype,"LayerLogin",void 0),i([c.injectField("Net")],e.prototype,"net",void 0),i([c.injectField("SDKMgr")],e.prototype,"sDKMgr",void 0),i([c.injectField("CtrlGM")],e.prototype,"ctrlGM",void 0),i([c.injectField("OnOffMgr")],e.prototype,"onOffMgr",void 0),i([c.injectField("CtrlAudio")],e.prototype,"ctrlAudio",void 0),i([c.injectField("ModelAccount")],e.prototype,"ModelAccount",void 0),i([c.injectField("GameStateMgr")],e.prototype,"gameStateMgr",void 0),i([c.injectField("LayerLoginLoading")],e.prototype,"LayerLoginLoading",void 0),e}(t("../GameState").GameState);r.GameStateLogin=d,cc._RF.pop()},{"../../../../engine/EngineMain":void 0,"../../../../framework/FW":void 0,"../../../../framework/container/Container":void 0,"../../../../framework/layer/common/UIMgr":void 0,"../../ctrl/DataReporting/DataReportingInterface":"DataReportingInterface","../../ctrl/login/LayerLogin":"LayerLogin","../../ctrl/login/LayerLoginLoading":"LayerLoginLoading","../GameState":"GameState"}],GameStateMgr:[function(t,e,r){"use strict";cc._RF.push(e,"914f3SRhchOLKnX+yLFqMCt","GameStateMgr");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.GameStateMgr=void 0;var i=t("../../../framework/container/Container"),a=t("../../../framework/fsm/AsyncFSM"),l=t("./state/GameStateLogin"),s=t("./state/GameStateRunning"),c=t("./state/GameStateStart"),u=function(t){function e(){var e=t.call(this)||this;return e.enterGameStateTimes=0,i.Container.inst().collectObj(e.addState(c.GameStateStart)),i.Container.inst().collectObj(e.addState(l.GameStateLogin)),i.Container.inst().collectObj(e.addState(s.GameStateRunning)),e}return n(e,t),Object.defineProperty(e,"instance",{get:function(){return this._instance||(this._instance=new e)},enumerable:!1,configurable:!0}),e.prototype.startup=function(){this.switchTo(c.GameStateStart)},e.prototype.switchToLogin=function(){this.switchTo(l.GameStateLogin)},e.prototype.switchToRunning=function(){this.switchTo(s.GameStateRunning)},e.__cname="GameStateMgr",e}(a.AsyncFSM);r.GameStateMgr=u,cc._RF.pop()},{"../../../framework/container/Container":void 0,"../../../framework/fsm/AsyncFSM":void 0,"./state/GameStateLogin":"GameStateLogin","./state/GameStateRunning":"GameStateRunning","./state/GameStateStart":"GameStateStart"}],GameStateRunning:[function(t,e,r){"use strict";cc._RF.push(e,"81f3a5BW0dGEog3LoZEIXGk","GameStateRunning");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.GameStateRunning=void 0;var s=t("../../../../engine/EngineMain"),c=t("../../../../framework/container/Container"),u=t("../../../../framework/FW"),p=t("../../../../framework/layer/common/UIMgr"),f=t("../../../../framework/utils/StringUtil"),h=t("../../../../framework/utils/Toolset"),y=t("../../../../libutil/BigNum"),d=t("../../ctrl/DataReporting/DataReportingInterface"),m=t("../../ctrl/login/LayerLoginLoading"),v=t("../../ctrl/sdk/SDKInterface"),_=t("../../model/public/AppCustomData"),S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._showdisconnect=!1,e}return n(e,t),e.prototype.disconnect=function(){},e.prototype.reconnectSuc=function(){},e.prototype.connectFail=function(){},e.prototype.enter=function(){return a(this,void 0,void 0,function(){var t,r,o,n,i,a,S,g,b,C,R,M,w,O,B,P,G,k,x,T,j,I,D,F,L,E=this;return l(this,function(l){switch(l.label){case 0:return t=c.Container.inst().get("DataReporting"),this.LayerLoginLoading.SetTitle(u.FW.G_W("\u6b63\u5728\u8fde\u63a5\u670d\u52a1\u5668...")),this.LayerLoginLoading.SetType(m.LoadingType.Login),this.LayerLoginLoading.SetProgress(40),this.LayerLoginLoading.setVisible(!0),this.LayerLoginLoading.load(),[4,u.FW.Task.waitUntil(function(){return p.UIMgr.instance.isUIOpen(m.LayerLoginLoading)})];case 1:return l.sent(),r=function(){E.LayerLoginLoading.ResetProgress(),E.LayerLoginLoading.SetProgress(0),E.LayerLoginLoading.setVisible(!1),E.LayerLoginLoading.SetState(m.LoadingState.Loading)},o=[],B=this.TimeUtil.LocalNow(),o.push(this.Ref.initAsync()),o.push(this.Ref.RefMgricon.preloadRef()),o.push(this.Ref.RefMgrlevel.preloadRef()),o.push(this.Ref.RefMgrequip.preloadRef()),o.push(this.Ref.RefMgrrune.preloadRef()),o.push(this.Ref.RefMgractivity.preloadRef()),o.push(this.Ref.RefMgrpayChannel.preloadRef()),P=this.TimeUtil.LocalNow(),u.FW.Log.log("\u6d4b\u8bd51\uff1a"+(P-B)),n=[],B=this.TimeUtil.LocalNow(),n.push(u.FW.FairyMgr.loadByPkgNameAsync("\u5171\u7528\u7ec4\u4ef6",!0)),n.push(u.FW.FairyMgr.loadByPkgNameAsync("\u516c\u75280",!0)),P=this.TimeUtil.LocalNow(),u.FW.Log.log("\u6d4b\u8bd52\uff1a"+(P-B)),i=[],B=this.TimeUtil.LocalNow(),i.push(this.net.protoMgr.protoCoder.init()),P=this.TimeUtil.LocalNow(),u.FW.Log.log("\u6d4b\u8bd53\uff1a"+(P-B)),a=[],B=this.TimeUtil.LocalNow(),a.push(this.cacheMgr.init()),P=this.TimeUtil.LocalNow(),u.FW.Log.log("\u6d4b\u8bd54\uff1a"+(P-B)),S=this.ModelMgr.ModelAccount.getUserInfo(),g=_.AppCustomData.instance.channelCode,b=S.code,C=S.token,R=S.time,M=this.SDKMgr.getSDK().getServerAddress(g,b,C,R),w=null,M.then(function(e){e?(E.ModelMgr.ModelAccount.setActionlogin(e),w=!0,t.PushBuriedList(d.SingleBuriedPointType.sdk_loginInfo_ok)):w=!1}).catch(function(t){t&&u.FW.Log.error(t.message),w=!1}),[4,u.FW.Task.waitUntil(function(){return null!=w})];case 2:return l.sent(),0==w?(u.FW.Log.log("\u83b7\u53d6\u670d\u52a1\u5668\u4fe1\u606f\u5931\u8d25\uff0c\u8fd4\u56de\u767b\u5f55\u754c\u9762"),this.gameStateMgr.switchToLogin(),r(),[2]):(this.LayerLoginLoading.SetProgress(50),t.PushBuriedList(d.SingleBuriedPointType.start_connect_server),B=this.TimeUtil.LocalNow(),[4,this.net.connectServer()]);case 3:return O=l.sent(),P=this.TimeUtil.LocalNow(),u.FW.Log.log("connect\u52a0\u8f7d\u65f6\u957f\uff1a"+(P-B)),t.PushBuriedList(d.SingleBuriedPointType.end_connect_server),O?(t.PushBuriedList(d.SingleBuriedPointType.connect_server_success),this.LayerLoginLoading.SetProgress(60),this.LayerLoginLoading.SetTitle(u.FW.G_W("\u6b63\u5728\u52a0\u8f7d\u914d\u7f6e...")),t.PushBuriedList(d.SingleBuriedPointType.start_load_ref),B=this.TimeUtil.LocalNow(),[4,Promise.all(o)]):(t.PushBuriedList(d.SingleBuriedPointType.connect_server_fail),u.FW.Log.log("\u8fde\u63a5\u5931\u8d25\uff0c\u8fd4\u56de\u767b\u5f55\u754c\u9762"),this.gameStateMgr.switchToLogin(),r(),[2]);case 4:return l.sent(),P=this.TimeUtil.LocalNow(),y.BigNum.tlRefShort=this.Ref.RefMgrbigNum.getRefAll(),u.FW.Log.log("ref\u52a0\u8f7d\u65f6\u957f\uff1a"+(P-B)),t.PushBuriedList(d.SingleBuriedPointType.end_load_ref),this.LayerLoginLoading.SetTitle(u.FW.G_W("\u6b63\u5728\u6253\u626b\u6218\u573a...")),t.PushBuriedList(d.SingleBuriedPointType.start_load_proto),B=this.TimeUtil.LocalNow(),[4,Promise.all(i)];case 5:return l.sent(),P=this.TimeUtil.LocalNow(),u.FW.Log.log("net\u52a0\u8f7d\u65f6\u957f\uff1a"+(P-B)),t.PushBuriedList(d.SingleBuriedPointType.end_load_proto),this.LayerLoginLoading.SetTitle(u.FW.G_W("\u6b63\u5728\u8f7d\u5165\u7f13\u5b58...")),t.PushBuriedList(d.SingleBuriedPointType.start_init_cache),B=this.TimeUtil.LocalNow(),[4,Promise.all(a)];case 6:return l.sent(),P=this.TimeUtil.LocalNow(),u.FW.Log.log("cache\u52a0\u8f7d\u65f6\u957f\uff1a"+(P-B)),t.PushBuriedList(d.SingleBuriedPointType.end_init_cache),this.CtrlJoint.InitData(),this.LayerLoginLoading.SetProgress(99),this.LayerLoginLoading.SetTitle(u.FW.G_W("\u6b63\u5728\u52a0\u8f7d\u8d44\u6e90...")),B=this.TimeUtil.LocalNow(),[4,this.ModelMgr.OnEnter()];case 7:return l.sent(),P=this.TimeUtil.LocalNow(),u.FW.Log.log("model\u52a0\u8f7d\u65f6\u957f\uff1a"+(P-B)),B=this.TimeUtil.LocalNow(),[4,this.CtrlMgr.OnEnter()];case 8:return l.sent(),P=this.TimeUtil.LocalNow(),u.FW.Log.log("Ctrl\u52a0\u8f7d\u65f6\u957f\uff1a"+(P-B)),this.LayerLoginLoading.SetProgress(100),this.LayerLoginLoading.SetTitle(u.FW.G_W("\u6b63\u5728\u8fdb\u5165\u4e3b\u57ce...")),t.PushBuriedList(d.SingleBuriedPointType.account_login),G=this.TimeUtil.LocalNow(),[4,this.ctrlGameLogin.playerLogin()];case 9:return k=l.sent(),x=this.TimeUtil.LocalNow(),u.FW.Log.log("socket\u52a0\u8f7d\u65f6\u957f\uff1a"+(x-G)),k?(t.PushBuriedList(d.SingleBuriedPointType.account_login_ok),this.CtrlMgr.CtrlGameNet.setLogin(!0),this.LayerLoginLoading.SetState(m.LoadingState.Finish),[4,this.ModelMgr.OnAfterEnter()]):(t.PushBuriedList(d.SingleBuriedPointType.account_login_fail),this.gameStateMgr.switchToLogin(),r(),[2]);case 10:return l.sent(),[4,this.CtrlMgr.OnAfterEnter()];case 11:return l.sent(),[4,Promise.all(n)];case 12:return l.sent(),this.CtrlMgr.CtrlGuide.Start_cor(),e.isReady=!0,t.PushBuriedList(d.SingleBuriedPointType.load_finish),this.LayerMain.load(),T=!1,this.LayerMain.SetOnFinally(function(){T=!0}),t.PushBuriedList(d.SingleBuriedPointType.enter_mainScene),[4,u.FW.Task.waitUntil(function(){return T},this)];case 13:return l.sent(),j=!1,I=this.ModelMgr.ModelVO.VORoleBag.GetOne(),D=I.GetRoleId(),F=f.StringUtil.format("firstEnter_{0}",D),-1==s.EngineMain.readLocalStorage(F,-1)&&(s.EngineMain.saveLocalStorage(F,1),j=!0),L=c.Container.inst().getByAlias("SDKDataReporting"),j&&L.BuriedPoint(v.SubmitDataUserInfoType.createRole),L.BuriedPoint(v.SubmitDataUserInfoType.enterGame),[4,u.FW.Task.delayFrame(1)];case 14:return l.sent(),this.toolSet=h.ToolSet.createToolSet(),this.toolSet.addListener(this.net.getEventProxy(),"connectFail",this.OnConnectFail,this),this.toolSet.addDefer(function(){E._showdisconnect=!1}),this.toolSet.addListener(this.net.getEventProxy(),"disconnect",this.OnDisconnect,this),this.toolSet.addListener(this.net.getEventProxy(),"reconnectSuccess",this.OnReconnectSuccess,this),r(),e.isInit=!0,[2]}})})},e.prototype.exit=function(){return a(this,void 0,Promise,function(){return l(this,function(t){switch(t.label){case 0:return h.ToolSet.destroyToolSet(this.toolSet),this.toolSet=null,this.CtrlMgr.CtrlGuide.Stop_cor(),e.isInit=!1,this.CtrlMgr.CtrlGameNet.setLogin(!1),[4,this.ModelMgr.OnExit()];case 1:return t.sent(),[4,this.CtrlMgr.OnExit()];case 2:return t.sent(),[4,this.net.closeSocket()];case 3:return t.sent(),[2]}})})},e.prototype.OnConnectFail=function(){var t=this;this.CtrlMgr.CtrlGameNet.setLogin(!1),this._showdisconnect||(this.LayerDisconnect.SetMsg(u.FW.G_W("\u68c0\u6d4b\u5230\u7f51\u7edc\u5df2\u65ad\u5f00\uff0c\u8bf7\u91cd\u8bd5")),this._showdisconnect=!0,this.LayerDisconnect.load(),this.LayerDisconnect.setCloseCallBack(function(){t._showdisconnect=!1}),u.FW.removeLoading())},e.prototype.OnDisconnect=function(){this.CtrlMgr.CtrlGameNet.getLogin()&&(this.log("\u89e6\u53d1\u91cd\u8fde\uff0c\u5207\u6362gamenet\u767b\u5f55\u72b6\u6001"),u.FW.showLoading(),this.CtrlMgr.CtrlGameNet.setLogin(!1))},e.prototype.OnReconnectSuccess=function(){return a(this,void 0,void 0,function(){var t,e,r,o=this;return l(this,function(n){switch(n.label){case 0:return t=this.TimeUtil.LocalNow(),[4,this.ctrlGameLogin.playerLogin(null,!0)];case 1:if(e=n.sent(),r=this.TimeUtil.LocalNow(),this.log("\u91cd\u8fde\u767b\u5f55\u65f6\u957f\uff1a"+(r-t)),e)this.CtrlMgr.CtrlGameNet.setLogin(!0);else{if(this._showdisconnect)return[2];this._showdisconnect=!0,this.LayerDisconnect.SetMsg(u.FW.G_W("\u68c0\u6d4b\u5230\u7f51\u7edc\u5df2\u65ad\u5f00\uff0c\u8bf7\u91cd\u8bd5")),this.LayerDisconnect.load(),this.LayerDisconnect.setCloseCallBack(function(){o._showdisconnect=!1})}return u.FW.removeLoading(),[2]}})})},e.__cname="GameStateRunning",e.isReady=!1,e.isInit=!1,i([c.injectField("Ref")],e.prototype,"Ref",void 0),i([c.injectField("Net")],e.prototype,"net",void 0),i([c.injectField("SDKMgr")],e.prototype,"SDKMgr",void 0),i([c.injectField("CacheMgr")],e.prototype,"cacheMgr",void 0),i([c.injectField("GameStateMgr")],e.prototype,"gameStateMgr",void 0),i([c.injectField("CtrlGameLogin")],e.prototype,"ctrlGameLogin",void 0),i([c.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([c.injectField("LayerMain")],e.prototype,"LayerMain",void 0),i([c.injectField("LayerLogin")],e.prototype,"LayerLogin",void 0),i([c.injectField("LayerLoginLoading")],e.prototype,"LayerLoginLoading",void 0),i([c.injectField("CtrlMgr")],e.prototype,"CtrlMgr",void 0),i([c.injectField("OnOffMgr")],e.prototype,"OnOffMgr",void 0),i([c.injectField("TimeUtil")],e.prototype,"TimeUtil",void 0),i([c.injectField("LayerDisconnect")],e.prototype,"LayerDisconnect",void 0),i([c.injectField("CtrlJoint")],e.prototype,"CtrlJoint",void 0),e}(t("../GameState").GameState);r.GameStateRunning=S,cc._RF.pop()},{"../../../../engine/EngineMain":void 0,"../../../../framework/FW":void 0,"../../../../framework/container/Container":void 0,"../../../../framework/layer/common/UIMgr":void 0,"../../../../framework/utils/StringUtil":void 0,"../../../../framework/utils/Toolset":void 0,"../../../../libutil/BigNum":void 0,"../../ctrl/DataReporting/DataReportingInterface":"DataReportingInterface","../../ctrl/login/LayerLoginLoading":"LayerLoginLoading","../../ctrl/sdk/SDKInterface":"SDKInterface","../../model/public/AppCustomData":"AppCustomData","../GameState":"GameState"}],GameStateStart:[function(t,e,r){"use strict";cc._RF.push(e,"3ef714u029APL0TQxuIUe3I","GameStateStart");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.GameStateStart=void 0;var l=t("../GameState"),s=t("../GameStateMgr"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.disconnect=function(){},e.prototype.reconnectSuc=function(){},e.prototype.connectFail=function(){},e.prototype.enter=function(){return i(this,void 0,void 0,function(){return a(this,function(){return s.GameStateMgr.instance.switchToLogin(),[2]})})},e.__cname="GameStateStart",e}(l.GameState);r.GameStateStart=c,cc._RF.pop()},{"../GameState":"GameState","../GameStateMgr":"GameStateMgr"}],GameState:[function(t,e,r){"use strict";cc._RF.push(e,"893d310dbNIn7IHlhOzyJ4i","GameState");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.GameState=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.__cname="GameState",e}(t("../../../framework/fsm/AsyncFSMState").AsyncFSMState);r.GameState=i,cc._RF.pop()},{"../../../framework/fsm/AsyncFSMState":void 0}],GameTab:[function(t,e,r){"use strict";cc._RF.push(e,"693a999d+pKfrWoVbvsV54A","GameTab");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.GameTabUI=r.GameTabProxy=void 0;var i=t("../../../framework/layer/tab/AppTab"),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.__cname="GameTabProxy",e}(t("../../../framework/layer/tab/AppTabProxy").AppTabProxy);r.GameTabProxy=a;var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.release=function(){},e.prototype.enter=function(){},e.prototype.exit=function(){},e.prototype.update=function(){},e.__cname="GameTabUI",e}(i.AppTab);r.GameTabUI=l,cc._RF.pop()},{"../../../framework/layer/tab/AppTab":void 0,"../../../framework/layer/tab/AppTabProxy":void 0}],GameUIUtil:[function(t,e,r){"use strict";cc._RF.push(e,"cf0b51k4zBFsa5ziiJFXOM+","GameUIUtil");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.getUIComByName=function(t,e){for(var r,o=t;;){if(null!=(r=o.tm(e)))return r;var n=o.tm("com_pub_layer");if(null==(o=n))return null}},e.getUIFullCoverCom=function(t){if(t)return e.getUIComByName(t,"\u7ec4\u4ef6_\u901a\u7528_\u5168\u5c4f\u754c\u9762\u6807\u8bc6")},e.getUITitleCom=function(t){if(t)return e.getUIComByName(t,"title")},e.getUICloseCom=function(t){if(t){var r=e.getUIComByName(t,"btn_close");return r&&(r.soundCustom="close"),r}},e.getUIBackCom=function(t){if(t)return e.getUIComByName(t,"btn_back")},e.getFloatCom=function(t){if(t)return e.getUIComByName(t,"com_float")},e.__cname="GameUIUtil",e}(t("../../../framework/base/ScriptObject").ScriptObject);r.default=i,cc._RF.pop()},{"../../../framework/base/ScriptObject":void 0}],Global:[function(t,e,r){"use strict";cc._RF.push(e,"8226crQFFFEG5FJ11sgcwtI","Global"),Object.defineProperty(r,"__esModule",{value:!0});var o=t("./bridge/AppBridge");cc.AppBridge=o.AppBridge,cc.CallJSBridge=function(t,e,r,n){console.log("CallJSBridge",t,e,r,n),o.AppBridge.CallJSBridge(t,e,r,n)},cc._RF.pop()},{"./bridge/AppBridge":"AppBridge"}],Goods:[function(t,e,r){"use strict";cc._RF.push(e,"10e21OQBIpBbZ/9mevZdVNf","Goods");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.GoodsBag=r.Goods=r.ShowBagType=r.EGoodsType=void 0;var a=t("../../../../../framework/container/Container"),l=t("../VO"),s=t("../VOBag");(function(t){t[t.normal=1]="normal",t[t.equipMaterial=4]="equipMaterial",t[t.chest=6]="chest",t[t.timeProduce=7]="timeProduce",t[t.huobiziyuan=9]="huobiziyuan",t[t.equipDrawing=10]="equipDrawing",t[t.weapon=11]="weapon",t[t.armor=12]="armor",t[t.amulet=13]="amulet",t[t.belt=14]="belt",t[t.glove=15]="glove",t[t.shoe=16]="shoe",t[t.atkRune=17]="atkRune",t[t.defRune=18]="defRune",t[t.frame=18]="frame",t[t.avatar=19]="avatar"})(r.EGoodsType||(r.EGoodsType={})),function(t){t[t.equipBag=0]="equipBag",t[t.itemBag_prop=1]="itemBag_prop",t[t.itemBag_consumables=2]="itemBag_consumables",t[t.itemBag_EquipDrawing=3]="itemBag_EquipDrawing",t[t.itemBag_EquipMaterials=4]="itemBag_EquipMaterials",t[t.runeBag=5]="runeBag"}(r.ShowBagType||(r.ShowBagType={}));var c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnGetNumber=function(){return 0},e.prototype.GetNumber=function(){if(!isNaN(this.number))return this.number;var t=this.OnGetNumber();return isNaN(t)?0:t},e.prototype.GetNumberStr=function(){return""+this.GetNumber()},e.prototype.SetNumber=function(t){this.number="string"==typeof t?Number(t):t},e.prototype.SetQuality=function(t){this.quality=t},e.prototype.GetDesc=function(){return this.ref.desc},e.__cname="Goods",e}(l.VO);r.Goods=c;var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.CreateByRefId=function(t,e){var r=new(this.GetVOClass());return this.container.inject(r),r.InitByRef(e.getRef("resId",t)),r},e.__cname="GoodsBag",i([a.injectField("Ref")],e.prototype,"Ref",void 0),e}(s.VOBag);r.GoodsBag=u,cc._RF.pop()},{"../../../../../framework/container/Container":void 0,"../VO":"VO","../VOBag":"VOBag"}],GuideBehaviorBase:[function(t,e,r){"use strict";cc._RF.push(e,"55695b9aBRPzb8KtS1kE7L0","GuideBehaviorBase");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.GuideBehaviorBase=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e}(t("../../../../framework/base/ScriptObject").ScriptObject);r.GuideBehaviorBase=i,cc._RF.pop()},{"../../../../framework/base/ScriptObject":void 0}],GuideScript:[function(t,e,r){"use strict";cc._RF.push(e,"34591Eqlf5ERL3jPCLtfx3f","GuideScript");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.GuideScript=r.GuideScriptResult=void 0;var s=t("../../../../../framework/base/ScriptObject"),c=t("../../../../../framework/container/Container"),u=t("../../../../../framework/coroutine/Cor"),p=t("../../../../../framework/utils/Toolset");(function(t){t[t.NORMAL=1]="NORMAL",t[t.QUIT=2]="QUIT"})(r.GuideScriptResult||(r.GuideScriptResult={}));var f=function(t){function e(e){var r=t.call(this)||this;return r.toolSet=p.ToolSet.createToolSet(),r.mgr=e,r}return n(e,t),e.prototype.onDestroy=function(){this.CtrlMgr.CtrlGuide.LayerGuide.SetOpaque(!0);var t=this.GetCom();t.tm("\u7ec4\u4ef6_\u70b9\u51fb\u533a\u57df").setPosition(-2,-2),t.tm("\u7ec4\u4ef6_\u70b9\u51fb\u533a\u57df").setSize(0,0),t.tm("\u53ef\u89c6\u5316").setPosition(-2,-2),t.tm("\u53ef\u89c6\u5316").setSize(0,0),this.toolSet&&(p.ToolSet.destroyToolSet(this.toolSet),this.toolSet=null)},e.prototype.OnEnter_cor=function(){return a(this,void 0,void 0,function(){return l(this,function(){return null==this.mgr&&(this.mgr=this.CtrlMgr.CtrlGuide.GetMgr()),[2]})})},e.prototype.OnRun_cor=function(){return a(this,void 0,void 0,function(){return l(this,function(){return[2]})})},e.prototype.GetMgr=function(){return this.mgr},e.prototype.GetCom=function(){return this.GetMgr().GetCom()},e.prototype.RunAndDispose_cor=function(t){return a(this,void 0,void 0,function(){var e;return l(this,function(r){switch(r.label){case 0:return[4,u.Cor.WaitFrame_cor(t,1)];case 1:r.sent(),r.label=2;case 2:return r.trys.push([2,4,5,6]),[4,this.OnRun_cor(t)];case 3:return r.sent(),[3,6];case 4:throw e=r.sent(),this.destroy(),e;case 5:return this.destroy(),[7];case 6:return[4,u.Cor.WaitFrame_cor(t,1)];case 7:return r.sent(),[2]}})})},e.__cname="GuideScript",i([c.injectField("CtrlMgr")],e.prototype,"CtrlMgr",void 0),i([c.injectField("TimeUtil")],e.prototype,"TimeUtil",void 0),e}(s.ScriptObject);r.GuideScript=f,cc._RF.pop()},{"../../../../../framework/base/ScriptObject":void 0,"../../../../../framework/container/Container":void 0,"../../../../../framework/coroutine/Cor":void 0,"../../../../../framework/utils/Toolset":void 0}],GuideSectionMgr:[function(t,e,r){"use strict";cc._RF.push(e,"f1d69tdIrxBEINZJbkVpEQt","GuideSectionMgr");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},c=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.GuideSectionMgr=void 0;var u=t("../../../../framework/base/ScriptObject"),p=t("../../../../framework/container/Container"),f=t("../../../../framework/coroutine/Cor"),h=t("../../../../framework/utils/PromiseWrap"),y=t("../../../../framework/utils/Toolset"),d=t("../../model/guide/ModelGuide"),m=t("./GuideSection"),v=t("./section/FirstBattleSection"),_=t("./section/FirstEnterGame"),S=t("./section/FirstEnterMallSection"),g=t("./section/FirstSelectBattleSkillSection"),b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tmSection=new Map,e.tmChangedSection=new Map,e.runningSection=null,e.tmClientPromise=new Map,e}return n(e,t),e.prototype.CreateSection=function(t,e){var r=new e(this);return p.Container.inst().inject(r),r.Init(this),r.SetGuideKey(t),this.tmSection.set(t,r),r},e.prototype.Enter=function(){var t,e,r,o;this.cor=new f.Cor,this.toolSet=y.ToolSet.createToolSet(),this.CreateSection(d.GuideKey.FirstEnterGame,_.FirstEnterGameSection),this.CreateSection(d.GuideKey.FirstEnterFight,v.FirstBattleSection),this.CreateSection(d.GuideKey.FirstSelectBattleSkill,g.FirstSelectBattleSkillSection),this.CreateSection(d.GuideKey.FirstEnterMall,S.FirstEnterMallSection);try{for(var n=s(this.tmSection),i=n.next();!i.done;i=n.next()){var a=c(i.value,2),l=a[0],u=a[1];this.EnterSection(l,u)}}catch(R){t={error:R}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}try{for(var h=s(this.tmSection),m=h.next();!m.done;m=h.next()){var b=c(m.value,2),C=(b[0],b[1]);p.Container.inst().inject(C)}}catch(M){r={error:M}}finally{try{m&&!m.done&&(o=h.return)&&o.call(h)}finally{if(r)throw r.error}}},e.prototype.Exit=function(){var t,e;if(this.tmChangedSection.clear(),this.tmClientPromise.clear(),this.tmSection){try{for(var r=s(this.tmSection),o=r.next();!o.done;o=r.next())c(o.value,2)[1].destroy()}catch(n){t={error:n}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}this.tmSection.clear()}null!=this.toolSet&&(y.ToolSet.destroyToolSet(this.toolSet),this.toolSet=null),this.cor.Stop(),this.cor=null,this.runningSection=null},e.prototype.EnterSection=function(t,e){var r=this,o=e.AddTriggerCallback(function(e){r.runningSection&&0!=t&&r.runningSection.GetGuideKey()==t||r.runningSection&&0==t&&t<r.runningSection.GetGuideKey()||r.runningSection&&t<=-1&&t<r.runningSection.GetGuideKey()||(r.tmChangedSection.set(t,e),e&&t>0&&r.log("\u89e6\u53d1\u5f15\u5bfc SectionId = ",t,", resut = ",e))});this.toolSet.addDefer(function(){e.RemoveTriggerCallback(o)}),e.UpdateBySecond!=m.GuideSection.prototype.UpdateBySecond&&this.toolSet.addTimer(.3,function(){e.UpdateBySecond()},this)},e.prototype.OnUpdate=function(){var t,e,r=this.tmChangedSection,o=null;try{for(var n=s(r),i=n.next();!i.done;i=n.next()){var a=c(i.value,2),l=a[0];if(a[1]){var u=this.tmSection.get(l);null!=u&&(u.IsCanRunning()?(!o||o.GetGuideKey()<=u.GetGuideKey())&&(o=u):r.delete(l))}else r.delete(l)}}catch(p){t={error:p}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}o&&(null!=this.runningSection?o.GetGuideKey()==this.runningSection.GetGuideKey()&&0==o.GetGuideKey()?(this.StopRunningSection(),r.delete(o.GetGuideKey()),this.StartSection(o.GetGuideKey())):this.runningSection.GetGuideKey()<o.GetGuideKey()&&(this.log("\u505c\u6b62\u5f53\u524d\u5f15\u5bfc",", \u542f\u52a8\u65b0\u5f15\u5bfc= ",o.GetGuideKey()),this.StopRunningSection(),r.set(o.GetGuideKey(),null),this.StartSection(o.GetGuideKey())):(r.delete(o.GetGuideKey()),this.StartSection(o.GetGuideKey()))),this.cor.Update()},e.prototype.StartSection=function(t){var e=this;this.runningSection=this.tmSection.get(t);var r=this.cor;r.Resume(function(){return a(e,void 0,void 0,function(){var t=this;return l(this,function(e){switch(e.label){case 0:return[4,f.Cor.WaitUntil_cor(r,function(){return null!=t.GetCom()})];case 1:return e.sent(),this.LayerGuide.SetOpaque(!0),this.LayerGuide.SetIsViseible(!0),[4,this.runningSection.Start_cor(r)];case 2:return e.sent(),[4,this.runningSection.Main_cor(r)];case 3:return e.sent(),[2]}})})}).then(function(){e.log("\u8dd1\u8fdb\u6765\u4e86"),e.LayerGuide.SetOpaque(!1),e.LayerGuide.SetIsViseible(!1);var t=e.runningSection.GetGuideKey();e.runningSection.Finish(),e.runningSection=null;var r=e.tmClientPromise.get(t);r&&(r.resolve(!0),e.tmClientPromise.delete(t))})},e.prototype.StopRunningSection=function(){this.cor.Stop()},e.prototype.RestartRunningSection=function(){var t=this.runningSection.GetGuideKey();this.StopRunningSection(),this.StartSection(t)},e.prototype.SetIsCanStopGuide=function(t){e.isCanStopGuide=t},e.prototype.GetCom=function(){if(this.LayerGuide.isLoad)return this.LayerGuide.getGuideCom()},e.prototype.GetIsRuning=function(){return!(!this.runningSection||this.runningSection.GetGuideKey()<=0)},e.prototype.StartClientTriggerSection=function(t){var e=this.tmClientPromise.get(t);return null==e&&(e=new h.PromiseWrap(null),this.tmClientPromise.set(t,e)),this.tmChangedSection.set(t,!0),e},e.__cname="GuideSectionMgr",e.isCanStopGuide=!1,i([p.injectField("LayerGuide")],e.prototype,"LayerGuide",void 0),e}(u.ScriptObject);r.GuideSectionMgr=b,cc._RF.pop()},{"../../../../framework/base/ScriptObject":void 0,"../../../../framework/container/Container":void 0,"../../../../framework/coroutine/Cor":void 0,"../../../../framework/utils/PromiseWrap":void 0,"../../../../framework/utils/Toolset":void 0,"../../model/guide/ModelGuide":"ModelGuide","./GuideSection":"GuideSection","./section/FirstBattleSection":"FirstBattleSection","./section/FirstEnterGame":"FirstEnterGame","./section/FirstEnterMallSection":"FirstEnterMallSection","./section/FirstSelectBattleSkillSection":"FirstSelectBattleSkillSection"}],GuideSection:[function(t,e,r){"use strict";cc._RF.push(e,"7db6aP1OD5NV5oVEo2gFjEd","GuideSection");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.GuideSection=void 0;var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.Init=function(t){this.mgr=t,this.finish=!1},e.prototype.IsCanRunning=function(){return!0},e.prototype.AddTriggerCallback=function(){return null},e.prototype.RemoveTriggerCallback=function(){},e.prototype.OnFinish=function(){},e.prototype.OnStart_cor=function(){},e.prototype.UpdateBySecond=function(){},e.prototype.GetGuideKey=function(){return this.guideKey},e.prototype.SetGuideKey=function(t){this.guideKey=t},e.prototype.Start_cor=function(){this.OnStart_cor()},e.prototype.Main_cor=function(t){return i(this,void 0,void 0,function(){var e;return a(this,function(r){switch(r.label){case 0:this.GetGuideKey()>0&&this.mgr.SetIsCanStopGuide(!0),r.label=1;case 1:return r.trys.push([1,3,4,5]),[4,this.OnMain_cor(t)];case 2:return r.sent(),[3,5];case 3:throw e=r.sent(),this.mgr.SetIsCanStopGuide(!1),e;case 4:return this.mgr.SetIsCanStopGuide(!1),[7];case 5:return[2]}})})},e.prototype.Finish=function(){this.OnFinish()},e}(t("../../../../framework/base/ScriptObject").ScriptObject);r.GuideSection=l,cc._RF.pop()},{"../../../../framework/base/ScriptObject":void 0}],HandlerCollider:[function(t,e,r){"use strict";cc._RF.push(e,"6760fQl5VRJxKCE5ldXyfw6","HandlerCollider");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.HandlerCollider=void 0;var a=t("../../../../../../framework/container/Container"),l=t("../../view/brocast/BrocastDamage"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.process=function(){var t=this.sid,e=this.tid,r=this.systemVar.ComVar.ATK,o=this.systemVar.ComVar.HP;o[t]=Math.max(0,o[t]-r[e]),o[e]=Math.max(0,o[e]-r[t]);var n=this.systemBrocast.Send(l.BrocastDamage);n.sender=t,n.target=e,n.isCrit=!1,n.damageType=0,n.damageValue=r[t]},e.__cname="HandlerCollider",i([a.injectField("SystemVar")],e.prototype,"systemVar",void 0),i([a.injectField("SystemBrocast")],e.prototype,"systemBrocast",void 0),e}(t("./Handler").Handler);r.HandlerCollider=s,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../view/brocast/BrocastDamage":"BrocastDamage","./Handler":"Handler"}],Handler:[function(t,e,r){"use strict";cc._RF.push(e,"8a111EEg8NHgJq5/CXrsLC6","Handler");var o=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.Handler=void 0;var n=t("../../../../../../framework/container/Container"),i=function(){function t(){}return o([n.injectField("Battle")],t.prototype,"Battle",void 0),t}();r.Handler=i,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0}],HeroReticleComPanel:[function(t,e,r){"use strict";cc._RF.push(e,"e5f67f26BxN9YCfnXQ3tR/N","HeroReticleComPanel");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.HeroReticleComPanel=r.ComUIPath=void 0;var a=t("../../../../../../../framework/container/Container"),l=t("../../../../../../../framework/coord/Coord"),s=t("../../../../../../../framework/fgui/FairyMgr"),c=t("./SubComPanel");r.ComUIPath="ui://\u6218\u6597/\u7ec4\u4ef6_\u6218\u6597_\u65b9\u5411\u7bad\u5934";var u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._point=new cc.Vec2,e._point2=new cc.Vec2,e._point3=new cc.Vec2,e}return n(e,t),e.prototype.OnGetClazz=function(){return e},e.prototype.Enter=function(){var t=s.FairyMgr.instance.createCom2(r.ComUIPath);this.com.addChild(t),this.obj=t,this.com_arrow=t.tm("\u7ec4\u4ef6_\u7bad\u5934")},e.prototype.Exit=function(){},e.prototype.Update=function(){this.updatePos(),this.updateDirection()},e.prototype.updateDirection=function(){var t=this.ComVar.HEROID;if(0!=this.ComVar.ALIVE[t][t]){var e=this.ComPos.d,r=(this.obj,180*e[t]/Math.PI);r=360-r,this.com_arrow.rotation=r}},e.prototype.updatePos=function(){var t=this.obj;if(0!=t.visible){var e=this.ComVar.HEROID,r=this.ComPos.x[e],o=this.ComPos.y[e],n=this._point,i=this._point2;n.x=r,n.y=o;var a=cc.view.getVisibleSize();n.y-=0,l.Coord.WorldToUI(n,i),i.x=Math.max(0,i.x),i.x=Math.min(a.width-t.width,i.x),i.y=Math.max(0,i.y),i.y=Math.min(a.height-t.height,i.y),t.parent.globalToLocal(i.x,i.y,i);var s=cc.winSize.height/cc.winSize.width>2?665:575,c=cc.winSize.height/2,u=i.y-c;u=u*c/s,t.x=i.x,t.y=u+c}},e.__cname="HeroReticleComPanel",i([a.injectField("ComVar")],e.prototype,"ComVar",void 0),i([a.injectField("ComPos")],e.prototype,"ComPos",void 0),e}(c.SubComPanel);r.HeroReticleComPanel=u,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../../../../../../framework/coord/Coord":void 0,"../../../../../../../framework/fgui/FairyMgr":void 0,"./SubComPanel":"SubComPanel"}],HeroSkillBat:[function(t,e,r){"use strict";cc._RF.push(e,"7e363S2cAVGkrUHKZ0SmmS3","HeroSkillBat");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.HeroSkillBat=void 0;var l,s=t("../../../../../../../framework/container/Container"),c=t("../../role/RoleBuilder"),u=t("../BaseSkill"),p=t("./BaseHeroSkill");(function(t){t[t.None=0]="None",t[t.Start=1]="Start",t[t.Running=2]="Running"})(l||(l={}));var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state=[],e.time=[],e.count=[],e}return n(e,t),e.prototype.OnGetAttr=function(){return["arg","bve","aiv"]},e.prototype.OnChangeParams=function(t){this.SwitchRunning(t)},e.prototype.OnAddContext=function(t){this.SwitchNone(t),this.time[t]=0,this.count[t]=0},e.prototype.OnRemoveContext=function(t){this.state[t]=null,this.time[t]=null,this.count[t]=null},e.prototype.OnUpdate=function(t){var e,r,o=this.state;try{for(var n=a(this.tlContextId),i=n.next();!i.done;i=n.next()){var s=i.value;switch(o[s]){case l.Start:this.UpdateStart(s,t);break;case l.Running:this.UpdateRunning(s,t)}}}catch(c){e={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}},e.prototype.SwitchNone=function(t){this.state[t]=l.None},e.prototype.SwitchStart=function(t){this.state[t]=l.Start,this.time[t]=0,this.SetMainSkillCD(t,0,this.time[t],this.GetCD(t)),this.triggerSkill(t)},e.prototype.UpdateStart=function(t,e){this.time[t]+=e,this.SetMainSkillCD(t,0,this.time[t],this.GetCD(t)),this.time[t]>=this.GetCD(t)&&(this.time[t]=0,this.SwitchRunning(t))},e.prototype.SwitchRunning=function(t){this.SetMainSkillCD(t,0,1,1),this.state[t]=l.Running,this.time[t]=this.GetInterval(t),this.count[t]=0},e.prototype.UpdateRunning=function(t,e){var r=this.time[t];r+=e,this.time[t]=r;for(var o=this.GetInterval(t);this.time[t]>=o;)if(this.OnTrigger(t),this.time[t]-=o+e,this.count[t]++,this.count[t]>=this.GetNum(t))return void this.SwitchStart(t)},e.prototype.OnTrigger=function(t){var e=this.tlContext[t].eid;this.GPAudio.throwing(),this.ComPos.x,this.ComPos.y;var r=this.Battle.getRef(e),o=(this.ComPos.d,new c.RBContext);o.sender=r;var n=this.GetBullet(t,0),i=this.count[t]==this.GetNum(t)-1,a=this.GetBulletLength();i&&a>1&&(n=this.GetBullet(t,a-1));var l=new(this.GetBulletBuilder(n));l.Setup(o),l.SetProperty("resId",n),l.SetProperty("has_bve",this.GetHasBVE(t)),l.SetProperty("has_let",this.GetHasLET(t)),l.SetProperty("builder",l),l.SetProperty("skill_attr_modify",this.resId),this.SystemRole.ApplyBuilder(l),this.Battle.applyModify()},e.prototype.GetState=function(t){var e=t.cid;switch(this.state[e]){case l.None:case l.Start:return u.SkillState.Idle;case l.Running:return u.SkillState.Running}},e.__cname="HeroSkillBat",i([s.injectField("SystemRole")],e.prototype,"SystemRole",void 0),i([s.injectField("SystemMove")],e.prototype,"SystemMove",void 0),i([s.injectField("ComVar")],e.prototype,"ComVar",void 0),i([s.injectField("ComPos")],e.prototype,"ComPos",void 0),i([s.injectField("Battle")],e.prototype,"Battle",void 0),i([s.injectField("GPAudio")],e.prototype,"GPAudio",void 0),i([s.injectField("ModelBattleSkill")],e.prototype,"ModelBattleSkill",void 0),e}(p.BaseHeroSkill);r.HeroSkillBat=f,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../role/RoleBuilder":"RoleBuilder","../BaseSkill":"BaseSkill","./BaseHeroSkill":"BaseHeroSkill"}],HeroSkillBoomerangeSuper:[function(t,e,r){"use strict";cc._RF.push(e,"bb3638xO99DALZ6jkpeAnW6","HeroSkillBoomerangeSuper");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.HeroSkillBoomerangeSuper=void 0;var l,s=t("../../../../../../../framework/container/Container"),c=t("../../role/RoleBuilder"),u=t("../BaseSkill"),p=t("./BaseHeroSkill");(function(t){t[t.None=0]="None",t[t.Start=1]="Start",t[t.Running=2]="Running"})(l||(l={}));var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state=[],e.time=[],e.count=[],e}return n(e,t),e.prototype.OnGetAttr=function(){return["arg","bve","let","aiv","bsp"]},e.prototype.OnChangeParams=function(t){this.SwitchRunning(t)},e.prototype.OnAddContext=function(t){this.SwitchNone(t),this.time[t]=0,this.count[t]=0},e.prototype.OnRemoveContext=function(t){this.state[t]=null,this.time[t]=null,this.count[t]=null},e.prototype.OnUpdate=function(t){var e,r,o=this.state;try{for(var n=a(this.tlContextId),i=n.next();!i.done;i=n.next()){var s=i.value;switch(o[s]){case l.Start:this.UpdateStart(s,t);break;case l.Running:this.UpdateRunning(s,t)}}}catch(c){e={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}},e.prototype.SwitchNone=function(t){this.state[t]=l.None},e.prototype.SwitchStart=function(t){this.state[t]=l.Start,this.time[t]=0,this.SetMainSkillCD(t,0,this.time[t],this.GetCD(t)),this.triggerSkill(t)},e.prototype.UpdateStart=function(t,e){this.time[t]+=e,this.SetMainSkillCD(t,0,this.time[t],this.GetCD(t)),this.time[t]>=this.GetCD(t)&&(this.time[t]=0,this.SwitchRunning(t))},e.prototype.SwitchRunning=function(t){this.SetMainSkillCD(t,0,1,1),this.state[t]=l.Running,this.time[t]=this.GetInterval(t),this.count[t]=0},e.prototype.UpdateRunning=function(t){this.OnTrigger(t),this.SwitchStart(t)},e.prototype.OnTrigger=function(t){var e=this,r=this.tlContext[t].eid;this.GPAudio.throwing();for(var o=this.ComPos.x[this.ComVar.HEROID],n=this.ComPos.y[this.ComVar.HEROID],i=function(){var i=e.Battle.getRef(r),a=e.GetNum(t);if(0!=a){e.checkNeedDestroyBullet();for(var l=2*Math.PI/a,s=0;s<a;s++){var u=s*l,p=new c.RBContext;p.sender=i,p.rad=u;var f=new(e.GetBulletBuilder(e.GetBullet(t,0)));f.Setup(p),f.SetProperty("resId",e.GetBullet(t,0)),f.SetProperty("has_bve",e.GetHasBVE(t)),f.SetProperty("has_let",e.GetHasLET(t)),f.SetProperty("builder",f),f.SetProperty("skill_attr_modify",e.resId),f.SetProperty("pos",[o,n]),e.SystemRole.ApplyBuilder(f)}e.Battle.applyModify()}},a=this.ComVar.CalHeroAttr("s7016",1),l=0;l<a;l++)setTimeout(i,1e3*l)},e.prototype.GetState=function(t){var e=t.cid;switch(this.state[e]){case l.None:case l.Start:return u.SkillState.Idle;case l.Running:return u.SkillState.Running}},e.__cname="HeroSkillBoomerangeSuper",i([s.injectField("SystemRole")],e.prototype,"SystemRole",void 0),i([s.injectField("SystemMove")],e.prototype,"SystemMove",void 0),i([s.injectField("ComVar")],e.prototype,"ComVar",void 0),i([s.injectField("ComPos")],e.prototype,"ComPos",void 0),i([s.injectField("Battle")],e.prototype,"Battle",void 0),i([s.injectField("GPAudio")],e.prototype,"GPAudio",void 0),e}(p.BaseHeroSkill);r.HeroSkillBoomerangeSuper=f,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../role/RoleBuilder":"RoleBuilder","../BaseSkill":"BaseSkill","./BaseHeroSkill":"BaseHeroSkill"}],HeroSkillBoomerange:[function(t,e,r){"use strict";cc._RF.push(e,"b9d64NAeTlGtpG6cJ+lN9Fo","HeroSkillBoomerange");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.HeroSkillBoomerange=void 0;var l,s=t("../../../../../../../framework/container/Container"),c=t("../../role/RoleBuilder"),u=t("../BaseSkill"),p=t("./BaseHeroSkill");(function(t){t[t.None=0]="None",t[t.Start=1]="Start",t[t.Running=2]="Running"})(l||(l={}));var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state=[],e.time=[],e.count=[],e}return n(e,t),e.prototype.OnGetAttr=function(){return["arg","bve","let","aiv"]},e.prototype.OnChangeParams=function(t){this.SwitchRunning(t)},e.prototype.OnAddContext=function(t){this.SwitchNone(t),this.time[t]=0,this.count[t]=0},e.prototype.OnRemoveContext=function(t){this.state[t]=null,this.time[t]=null,this.count[t]=null},e.prototype.OnUpdate=function(t){var e,r,o=this.state;try{for(var n=a(this.tlContextId),i=n.next();!i.done;i=n.next()){var s=i.value;switch(o[s]){case l.Start:this.UpdateStart(s,t);break;case l.Running:this.UpdateRunning(s,t)}}}catch(c){e={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}},e.prototype.SwitchNone=function(t){this.state[t]=l.None},e.prototype.SwitchStart=function(t){this.state[t]=l.Start,this.time[t]=0,this.SetMainSkillCD(t,0,this.time[t],this.GetCD(t)),this.triggerSkill(t)},e.prototype.UpdateStart=function(t,e){this.time[t]+=e,this.SetMainSkillCD(t,0,this.time[t],this.GetCD(t)),this.time[t]>=this.GetCD(t)&&(this.time[t]=0,this.SwitchRunning(t))},e.prototype.SwitchRunning=function(t){this.SetMainSkillCD(t,0,1,1),this.state[t]=l.Running,this.time[t]=this.GetInterval(t),this.count[t]=0},e.prototype.UpdateRunning=function(t,e){if(this.time[t]+=e,this.tlContext[t].eid,this.time[t]>=this.GetInterval(t)){this.time[t]=0,this.count[t]++;var r=this.findNear(t);r&&this.OnTrigger(t,r)}this.count[t]>=this.GetNum(t)&&this.SwitchStart(t)},e.prototype.OnTrigger=function(t,e){var r=this.tlContext[t].eid;this.GPAudio.throwing();var o=this.ComPos.x,n=this.ComPos.y,i=this.Battle.getRef(r),a=Math.atan2(n[e]-n[r],o[e]-o[r]),l=this.GetBullet(t,0),s=this.checkNeedDestroyBullet(),u=new c.RBContext;u.sender=i,u.rad=a;var p=new(this.GetBulletBuilder(l));p.Setup(u),p.SetProperty("resId",l),p.SetProperty("has_bve",this.GetHasBVE(t)),p.SetProperty("has_let",this.GetHasLET(t)),p.SetProperty("builder",p),p.SetProperty("skill_attr_modify",this.resId),this.SystemRole.ApplyBuilder(p,s),this.Battle.applyModify()},e.prototype.GetState=function(t){var e=t.cid;switch(this.state[e]){case l.None:case l.Start:return u.SkillState.Idle;case l.Running:return u.SkillState.Running}},e.prototype.resetSkillState=function(){var t,e;try{for(var r=a(this.tlContextId),o=r.next();!o.done;o=r.next()){var n=o.value;this.SwitchRunning(n)}}catch(i){t={error:i}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},e.__cname="HeroSkillBoomerange",i([s.injectField("SystemRole")],e.prototype,"SystemRole",void 0),i([s.injectField("SystemMove")],e.prototype,"SystemMove",void 0),i([s.injectField("ComVar")],e.prototype,"ComVar",void 0),i([s.injectField("ComPos")],e.prototype,"ComPos",void 0),i([s.injectField("Battle")],e.prototype,"Battle",void 0),i([s.injectField("GPAudio")],e.prototype,"GPAudio",void 0),e}(p.BaseHeroSkill);r.HeroSkillBoomerange=f,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../role/RoleBuilder":"RoleBuilder","../BaseSkill":"BaseSkill","./BaseHeroSkill":"BaseHeroSkill"}],HeroSkillBow:[function(t,e,r){"use strict";cc._RF.push(e,"48ecdKJTipCCY/b57ASBAjU","HeroSkillBow");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.HeroSkillBow=void 0;var l,s=t("../../../../../../../framework/container/Container"),c=t("../../../../../../../framework/utils/Toolset"),u=t("../../role/RoleBuilder"),p=t("../BaseSkill"),f=t("./BaseHeroSkill");(function(t){t[t.None=0]="None",t[t.Start=1]="Start",t[t.Running=2]="Running"})(l||(l={}));var h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state=[],e.time=[],e.count=[],e.reload=[],e}return n(e,t),e.prototype.SetIsRed=function(t){this._isRed=t,this.OnAttrChange()},e.prototype.GetIsRed=function(){return this._isRed},e.prototype.recoverBullet=function(){var t,e;try{for(var r=a(this.tlContextId),o=r.next();!o.done;o=r.next()){var n=o.value;this.count[n]--}}catch(i){t={error:i}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},e.prototype.OnGetAttr=function(){return this._isRed?["aiv","bve"]:["aiv"]},e.prototype.OnChangeParams=function(t){this.SwitchRunning(t)},e.prototype.OnGetScriptParam=function(){return{kill2Reload:1==this.GetTlScriptParam()[0]}},e.prototype.OnEnter=function(){var t=this;this.toolSet=c.ToolSet.createToolSet();var e=this.ComVar.BULLET_SENDER,r=this.ComVar.ALIVE;this.toolSet.addCallback(this.SystemDamage.GetDamageCallback(),function(o){var n,i;if(null!=t._scriptParam&&0!=t._scriptParam.kill2Reload&&t.resId==o.GetSkillId())try{for(var l=a(t.tlContextId),s=l.next();!s.done;s=l.next()){var c=s.value;e[o.sid]==c&&1!=r[o.tid]&&t.AddReload(c)}}catch(u){n={error:u}}finally{try{s&&!s.done&&(i=l.return)&&i.call(l)}finally{if(n)throw n.error}}})},e.prototype.OnExit=function(){c.ToolSet.destroyToolSet(this.toolSet)},e.prototype.OnAddContext=function(t){this.SwitchNone(t),this.time[t]=0,this.count[t]=0,this.reload[t]=0},e.prototype.OnRemoveContext=function(t){this.state[t]=null,this.time[t]=null,this.count[t]=null,this.reload[t]=null},e.prototype.OnUpdate=function(t){var e,r,o=this.state;try{for(var n=a(this.tlContextId),i=n.next();!i.done;i=n.next()){var s=i.value;switch(o[s]){case l.Start:this.UpdateStart(s,t);break;case l.Running:this.UpdateRunning(s,t)}}}catch(c){e={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}},e.prototype.SwitchNone=function(t){this.state[t]=l.None},e.prototype.SwitchStart=function(t){this.state[t]=l.Start,this.time[t]=0,this.reload[t]=0,this.count[t]=0,this.SetMainSkillCD(t,0,this.time[t],this.GetCD(t)),this.triggerSkill(t)},e.prototype.UpdateStart=function(t,e){this.time[t]+=e,this.SetMainSkillCD(t,0,this.time[t],this.GetCD(t)),this.time[t]>=this.GetCD(t)&&(this.time[t]=0,this.SwitchRunning(t))},e.prototype.SwitchRunning=function(t){this.SetMainSkillCD(t,this.GetCDType(),this.GetMagazineMax(t),this.GetMagazineMax(t)),this.state[t]=l.Running,this.time[t]=this.GetInterval(t),this.count[t]=0},e.prototype.UpdateRunning=function(t,e){this.time[t]+=e;for(var r=this.GetInterval(t);this.reload[t]>0&&(this.reload[t]--,this.count[t]=Math.max(0,this.count[t]-1),this.SetMainSkillCD(t,this.GetCDType(),this.GetMagazine(t),this.GetMagazineMax(t))),this.time[t]>=r;)if(this.OnTrigger(t),this.time[t]-=r,this.count[t]++,this.SetMainSkillCD(t,this.GetCDType(),this.GetMagazine(t),this.GetMagazineMax(t)),this.count[t]>=this.GetNum(t))return void this.SwitchStart(t)},e.prototype.OnTrigger=function(t){var e=this.tlContext[t].eid;this.GPAudio.throwing();var r=this.ComPos.x,o=this.ComPos.y,n=this.Battle.getRef(e),i=this.ComPos.d[e],a=new u.RBContext;a.sender=n,a.rad=i;for(var l=1,s=this.GetBulletLength(),c=s+2,p=Math.PI,f=p/c,h=0;h<s;h++){var y=i+f*l-.5*p,d=r[e]+20*Math.cos(y),m=o[e]+20*Math.sin(y);l++,a.x=d,a.y=m;var v=this.GetBullet(t,0),_=new(this.GetBulletBuilder(v));_.Setup(a),_.SetProperty("resId",v),_.SetProperty("has_bve",this.GetHasBVE(t)),_.SetProperty("has_let",this.GetHasLET(t)),_.SetProperty("builder",_),_.SetProperty("skill_attr_modify",this.resId),this.SystemRole.ApplyBuilder(_)}this.Battle.applyModify()},e.prototype.GetCDType=function(){return this.GetBulletLength()>1?2:1},e.prototype.GetMagazine=function(t){return this.GetMagazineMax(t)-this.count[t]},e.prototype.GetMagazineMax=function(t){return this.GetNum(t)},e.prototype.AddReload=function(t){this.reload[t]++},e.prototype.GetState=function(t){var e=t.cid;switch(this.state[e]){case l.None:case l.Start:return p.SkillState.Idle;case l.Running:return p.SkillState.Running}},e.__cname="HeroSkillBow",i([s.injectField("SystemRole")],e.prototype,"SystemRole",void 0),i([s.injectField("SystemMove")],e.prototype,"SystemMove",void 0),i([s.injectField("SystemDamage")],e.prototype,"SystemDamage",void 0),i([s.injectField("ComVar")],e.prototype,"ComVar",void 0),i([s.injectField("ComPos")],e.prototype,"ComPos",void 0),i([s.injectField("Battle")],e.prototype,"Battle",void 0),i([s.injectField("GPAudio")],e.prototype,"GPAudio",void 0),i([s.injectField("ModelBattleSkill")],e.prototype,"ModelBattleSkill",void 0),e}(f.BaseHeroSkill);r.HeroSkillBow=h,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../../../../../../framework/utils/Toolset":void 0,"../../role/RoleBuilder":"RoleBuilder","../BaseSkill":"BaseSkill","./BaseHeroSkill":"BaseHeroSkill"}],HeroSkillBrickSuper:[function(t,e,r){"use strict";cc._RF.push(e,"24167sxH2dCEbryFvIIihno","HeroSkillBrickSuper");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.HeroSkillBrickSuper=void 0;var l,s=t("../../../../../../../framework/container/Container"),c=t("../../role/RoleBuilder"),u=t("../BaseSkill"),p=t("./BaseHeroSkill");(function(t){t[t.Start=0]="Start",t[t.Running=1]="Running"})(l||(l={}));var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state=[],e.time=[],e}return n(e,t),e.prototype.OnInit=function(){},e.prototype.OnRelease=function(){},e.prototype.OnGetAttr=function(){return["arg","bve","aiv"]},e.prototype.OnChangeParams=function(t){this.SwitchRunning(t)},e.prototype.OnAddContext=function(t){this.state[t]=null,this.time[t]=0},e.prototype.OnRemoveContext=function(t){this.state[t]=null,this.time[t]=null},e.prototype.OnUpdate=function(t){var e,r;try{for(var o=a(this.tlContextId),n=o.next();!n.done;n=o.next()){var i=n.value;switch(this.state[i]){case l.Start:this.UpdateStart(i,t);break;case l.Running:this.UpdateRunning(i,t)}}}catch(s){e={error:s}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}},e.prototype.SwitchStart=function(t){this.state[t]=l.Start,this.time[t]=0,this.SetMainSkillCD(t,0,this.time[t],this.GetCD(t)),this.triggerSkill(t)},e.prototype.UpdateStart=function(t,e){this.time[t]+=e,this.SetMainSkillCD(t,0,this.time[t],this.GetCD(t)),this.time[t]>=this.GetCD(t)&&(this.time[t]=0,this.SwitchRunning(t))},e.prototype.SwitchRunning=function(t){this.SetMainSkillCD(t,0,1,1),this.state[t]=l.Running,this.time[t]=0},e.prototype.UpdateRunning=function(t){this.OnTrigger(t),this.SwitchStart(t)},e.prototype.OnTrigger=function(t){this.GPAudio.sword();var e=this.tlContext[t].eid,r=this.Battle.getRef(e),o=this.GetNum(t);this.checkNeedDestroyBullet();for(var n=0;n<o;n++){var i=2*Math.PI/o*n,a=new c.RBContext;a.sender=r,a.rad=i,a.radius=100;var l=new(this.GetBulletBuilder(this.GetBullet(t,0)));l.Setup(a),l.SetProperty("resId",this.GetBullet(t,0)),l.SetProperty("has_bve",this.GetHasBVE(t)),l.SetProperty("has_let",this.GetHasLET(t)),l.SetProperty("builder",l),l.SetProperty("skill_attr_modify",this.resId),this.SystemRole.ApplyBuilder(l)}this.Battle.applyModify()},e.prototype.GetState=function(t){var e=t.cid;switch(this.state[e]){case l.Start:return u.SkillState.Idle;case l.Running:return u.SkillState.Running}},e.__cname="HeroSkillBrickSuper",i([s.injectField("SystemRole")],e.prototype,"SystemRole",void 0),i([s.injectField("Battle")],e.prototype,"Battle",void 0),i([s.injectField("GPAudio")],e.prototype,"GPAudio",void 0),i([s.injectField("ModelBattleSkill")],e.prototype,"ModelBattleSkill",void 0),e}(p.BaseHeroSkill);r.HeroSkillBrickSuper=f,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../role/RoleBuilder":"RoleBuilder","../BaseSkill":"BaseSkill","./BaseHeroSkill":"BaseHeroSkill"}],HeroSkillBrick:[function(t,e,r){"use strict";cc._RF.push(e,"cf95a9clsRMoa3xBQhPreLE","HeroSkillBrick");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.HeroSkillBrick=void 0;var l,s=t("../../../../../../../framework/container/Container"),c=t("../../role/RoleBuilder"),u=t("../BaseSkill"),p=t("./BaseHeroSkill");(function(t){t[t.None=0]="None",t[t.Start=1]="Start",t[t.Running=2]="Running"})(l||(l={}));var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state=[],e.time=[],e.count=[],e}return n(e,t),e.prototype.OnGetAttr=function(){return["arg","bve","let","aiv","bsp"]},e.prototype.OnChangeParams=function(t){this.SwitchRunning(t)},e.prototype.OnAddContext=function(t){this.SwitchNone(t),this.time[t]=0,this.count[t]=0},e.prototype.OnRemoveContext=function(t){this.state[t]=null,this.time[t]=null,this.count[t]=null},e.prototype.OnUpdate=function(t){var e,r,o=this.state;try{for(var n=a(this.tlContextId),i=n.next();!i.done;i=n.next()){var s=i.value;switch(o[s]){case l.Start:this.UpdateStart(s,t);break;case l.Running:this.UpdateRunning(s,t)}}}catch(c){e={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}},e.prototype.SwitchNone=function(t){this.state[t]=l.None},e.prototype.SwitchStart=function(t){this.state[t]=l.Start,this.time[t]=0,this.SetMainSkillCD(t,0,this.time[t],this.GetCD(t)),this.triggerSkill(t)},e.prototype.UpdateStart=function(t,e){this.time[t]+=e,this.SetMainSkillCD(t,0,this.time[t],this.GetCD(t)),this.time[t]>=this.GetCD(t)&&(this.time[t]=0,this.SwitchRunning(t))},e.prototype.SwitchRunning=function(t){this.SetMainSkillCD(t,0,1,1),this.state[t]=l.Running,this.time[t]=this.GetInterval(t),this.count[t]=0},e.prototype.UpdateRunning=function(t,e){this.time[t]+=e,this.time[t]>=this.GetInterval(t)&&(this.time[t]=0,this.count[t]++,this.OnTrigger(t)),this.count[t]>=this.GetNum(t)&&this.SwitchStart(t)},e.prototype.OnTrigger=function(t){this.GPAudio.swosh();var e=this.tlContext[t].eid,r=this.Battle.getRef(e),o=new c.RBContext;o.sender=r;var n=this.checkNeedDestroyBullet(),i=new(this.GetBulletBuilder(this.GetBullet(t,0)));i.Setup(o),i.SetProperty("resId",this.GetBullet(t,0)),i.SetProperty("has_bve",this.GetHasBVE(t)),i.SetProperty("has_let",this.GetHasLET(t)),i.SetProperty("builder",i),i.SetProperty("skill_attr_modify",this.resId),this.SystemRole.ApplyBuilder(i,n),this.Battle.applyModify()},e.prototype.GetState=function(t){var e=t.cid;switch(this.state[e]){case l.None:case l.Start:return u.SkillState.Idle;case l.Running:return u.SkillState.Running}},e.__cname="HeroSkillBrick",i([s.injectField("Battle")],e.prototype,"Battle",void 0),i([s.injectField("SystemRole")],e.prototype,"SystemRole",void 0),i([s.injectField("GPAudio")],e.prototype,"GPAudio",void 0),i([s.injectField("ModelBattleSkill")],e.prototype,"ModelBattleSkill",void 0),e}(p.BaseHeroSkill);r.HeroSkillBrick=f,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../role/RoleBuilder":"RoleBuilder","../BaseSkill":"BaseSkill","./BaseHeroSkill":"BaseHeroSkill"}],HeroSkillDartSuper:[function(t,e,r){"use strict";cc._RF.push(e,"6df8cNBS5FHObVch6qigt/j","HeroSkillDartSuper");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.HeroSkillDartSuper=void 0;var l,s=t("../../../../../../../framework/container/Container"),c=t("../../role/RoleBuilder"),u=t("../BaseSkill"),p=t("./BaseHeroSkill");(function(t){t[t.None=0]="None",t[t.Start=1]="Start",t[t.Running=2]="Running"})(l||(l={}));var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state=[],e.time=[],e.count=[],e}return n(e,t),e.prototype.OnGetAttr=function(){return[]},e.prototype.OnChangeParams=function(t){this.SwitchRunning(t)},e.prototype.OnAddContext=function(t){this.SwitchNone(t),this.time[t]=0,this.count[t]=0},e.prototype.OnRemoveContext=function(t){this.state[t]=null,this.time[t]=null,this.count[t]=null},e.prototype.OnUpdate=function(t){var e,r,o=this.state;try{for(var n=a(this.tlContextId),i=n.next();!i.done;i=n.next()){var s=i.value;switch(o[s]){case l.Start:this.UpdateStart(s,t);break;case l.Running:this.UpdateRunning(s,t)}}}catch(c){e={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}},e.prototype.SwitchNone=function(t){this.state[t]=l.None},e.prototype.SwitchStart=function(t){this.state[t]=l.Start,this.time[t]=0,this.SetMainSkillCD(t,0,this.time[t],this.GetCD(t)),this.triggerSkill(t)},e.prototype.UpdateStart=function(t,e){this.time[t]+=e,this.SetMainSkillCD(t,0,this.time[t],this.GetCD(t)),this.time[t]>=this.GetCD(t)&&(this.time[t]=0,this.SwitchRunning(t))},e.prototype.SwitchRunning=function(t){this.SetMainSkillCD(t,0,1,1),this.state[t]=l.Running,this.time[t]=this.GetInterval(t),this.count[t]=0},e.prototype.UpdateRunning=function(t,e){if(this.time[t]+=e,this.time[t]>=this.GetInterval(t)){this.time[t]=0,this.count[t]++;var r=this.findNear(t);r&&this.OnTrigger(t,r)}this.count[t]>=this.GetNum(t)&&this.SwitchStart(t)},e.prototype.OnTrigger=function(t){this.GPAudio.throwing();var e=this.tlContext[t].eid,r=this.GetBullet(t,0),o=new c.RBContext,n=new(this.GetBulletBuilder(this.GetBullet(t,0)));n.Setup(o),n.SetProperty("resId",r),n.SetProperty("has_bve",this.GetHasBVE(t)),n.SetProperty("has_let",this.GetHasLET(t)),n.SetProperty("builder",n),n.SetProperty("skill_attr_modify",this.resId),this.SkillHandlerDart.Shoot_red(e,e,r,n)},e.prototype.GetState=function(t){var e=t.cid;switch(this.state[e]){case l.None:case l.Start:return u.SkillState.Idle;case l.Running:return u.SkillState.Running}},e.__cname="HeroSkillDartSuper",i([s.injectField("SystemRole")],e.prototype,"SystemRole",void 0),i([s.injectField("SystemMove")],e.prototype,"SystemMove",void 0),i([s.injectField("ComVar")],e.prototype,"ComVar",void 0),i([s.injectField("ComPos")],e.prototype,"ComPos",void 0),i([s.injectField("Battle")],e.prototype,"Battle",void 0),i([s.injectField("GPAudio")],e.prototype,"GPAudio",void 0),i([s.injectField("SkillHandlerDart")],e.prototype,"SkillHandlerDart",void 0),e}(p.BaseHeroSkill);r.HeroSkillDartSuper=f,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../role/RoleBuilder":"RoleBuilder","../BaseSkill":"BaseSkill","./BaseHeroSkill":"BaseHeroSkill"}],HeroSkillDart:[function(t,e,r){"use strict";cc._RF.push(e,"236c8k9UotC+rJPq6qVuEPn","HeroSkillDart");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.HeroSkillDart=void 0;var l,s=t("../../../../../../../framework/container/Container"),c=t("../../role/RoleBuilder"),u=t("../BaseSkill"),p=t("./BaseHeroSkill");(function(t){t[t.None=0]="None",t[t.Start=1]="Start",t[t.Running=2]="Running"})(l||(l={}));var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state=[],e.time=[],e.count=[],e}return n(e,t),e.prototype.OnGetAttr=function(){return["aiv"]},e.prototype.OnChangeParams=function(t){this.SwitchRunning(t)},e.prototype.OnAddContext=function(t){this.SwitchNone(t),this.time[t]=0,this.count[t]=0},e.prototype.OnRemoveContext=function(t){this.state[t]=null,this.time[t]=null,this.count[t]=null},e.prototype.OnUpdate=function(t){var e,r,o=this.state;try{for(var n=a(this.tlContextId),i=n.next();!i.done;i=n.next()){var s=i.value;switch(o[s]){case l.Start:this.UpdateStart(s,t);break;case l.Running:this.UpdateRunning(s,t)}}}catch(c){e={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}},e.prototype.SwitchNone=function(t){this.state[t]=l.None},e.prototype.SwitchStart=function(t){this.state[t]=l.Start,this.time[t]=0,this.SetMainSkillCD(t,0,this.time[t],this.GetCD(t)),this.triggerSkill(t)},e.prototype.UpdateStart=function(t,e){this.time[t]+=e,this.SetMainSkillCD(t,0,this.time[t],this.GetCD(t)),this.time[t]>=this.GetCD(t)&&(this.time[t]=0,this.SwitchRunning(t))},e.prototype.SwitchRunning=function(t){this.SetMainSkillCD(t,0,1,1),this.state[t]=l.Running,this.time[t]=this.GetInterval(t),this.count[t]=0},e.prototype.UpdateRunning=function(t,e){if(this.time[t]+=e,this.time[t]>=this.GetInterval(t)){this.time[t]=0,this.count[t]++;var r=this.findNear(t);r&&this.OnTrigger(t,r)}this.count[t]>=this.GetNum(t)&&this.SwitchStart(t)},e.prototype.OnTrigger=function(t,e){this.ComPos.x,this.ComPos.y;var r=this.tlContext[t].eid,o=(this.Battle.getRef(r),this.GetBullet(t,0)),n=new c.RBContext,i=new(this.GetBulletBuilder(o));i.Setup(n),i.SetProperty("resId",o),i.SetProperty("has_bve",this.GetHasBVE(t)),i.SetProperty("has_let",this.GetHasLET(t)),i.SetProperty("builder",i),i.SetProperty("skill_attr_modify",this.resId),this.SkillHandlerDart.Shoot(r,r,o,i,e)},e.prototype.GetState=function(t){var e=t.cid;switch(this.state[e]){case l.None:case l.Start:return u.SkillState.Idle;case l.Running:return u.SkillState.Running}},e.__cname="HeroSkillDart",i([s.injectField("SystemRole")],e.prototype,"SystemRole",void 0),i([s.injectField("SystemMove")],e.prototype,"SystemMove",void 0),i([s.injectField("ComVar")],e.prototype,"ComVar",void 0),i([s.injectField("ComPos")],e.prototype,"ComPos",void 0),i([s.injectField("Battle")],e.prototype,"Battle",void 0),i([s.injectField("GPAudio")],e.prototype,"GPAudio",void 0),i([s.injectField("SkillHandlerDart")],e.prototype,"SkillHandlerDart",void 0),e}(p.BaseHeroSkill);r.HeroSkillDart=f,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../role/RoleBuilder":"RoleBuilder","../BaseSkill":"BaseSkill","./BaseHeroSkill":"BaseHeroSkill"}],HeroSkillDrillSuper:[function(t,e,r){"use strict";cc._RF.push(e,"411085/pftNl6hdCyEktfl0","HeroSkillDrillSuper");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.HeroSkillDrillSuper=void 0;var l,s=t("../../../../../../../framework/container/Container"),c=t("../../role/RoleBuilder"),u=t("../BaseSkill"),p=t("./BaseHeroSkill");(function(t){t[t.None=0]="None",t[t.Start=1]="Start",t[t.Running=2]="Running"})(l||(l={}));var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state=[],e.time=[],e.count=[],e.isShoot=[],e}return n(e,t),e.prototype.OnGetAttr=function(){return["bsp"]},e.prototype.OnChangeParams=function(t){this.SwitchRunning(t)},e.prototype.OnAddContext=function(t){this.SwitchNone(t),this.time[t]=0,this.count[t]=0},e.prototype.OnRemoveContext=function(t){this.state[t]=null,this.time[t]=null,this.count[t]=null},e.prototype.OnUpdate=function(t){var e,r,o=this.state;try{for(var n=a(this.tlContextId),i=n.next();!i.done;i=n.next()){var s=i.value;switch(o[s]){case l.Start:this.UpdateStart(s,t);break;case l.Running:this.UpdateRunning(s,t)}}}catch(c){e={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}},e.prototype.SwitchNone=function(t){this.state[t]=l.None},e.prototype.SwitchStart=function(t){this.state[t]=l.Start,this.time[t]=0,this.triggerSkill(t)},e.prototype.UpdateStart=function(t,e){if(this.GetIsSingleMode()){if(this.isShoot[t])return;this.SwitchRunning(t)}this.time[t]+=e,this.SetMainSkillCD(t,0,this.time[t],this.GetCD(t)),this.time[t]>=this.GetCD(t)&&(this.time[t]=0,this.SwitchRunning(t))},e.prototype.SwitchRunning=function(t){this.isShoot[t]=!0,this.SetMainSkillCD(t,0,1,1),this.state[t]=l.Running,this.time[t]=this.GetInterval(t),this.count[t]=0},e.prototype.UpdateRunning=function(t,e){this.time[t]+=e,this.time[t]>=this.GetInterval(t)&&(this.time[t]=0,this.count[t]++,this.OnTrigger(t)),this.count[t]>=this.GetNum(t)&&this.SwitchStart(t)},e.prototype.GetNum=function(e){var r=t.prototype.GetNum.call(this,e),o=this.ComVar.CalHeroAttr("s7126",0);return 0!=o&&(r=o),r},e.prototype.OnTrigger=function(t){var e=this.tlContext[t].eid,r=this.Battle.getRef(e);this.checkNeedDestroyBullet();var o=[.25,.75,1.25,1.75],n=o[Math.floor(Math.random()*o.length)]*Math.PI,i=new c.RBContext;i.sender=r,i.rad=n;var a=new(this.GetBulletBuilder(this.GetBullet(t,0)));a.Setup(i),a.SetProperty("resId",this.GetBullet(t,0)),a.SetProperty("has_bve",this.GetHasBVE(t)),a.SetProperty("has_let",this.GetHasLET(t)),a.SetProperty("builder",a),a.SetProperty("skill_attr_modify",this.resId),this.SystemRole.ApplyBuilder(a),this.Battle.applyModify()},e.prototype.GetState=function(t){var e=t.cid;switch(this.state[e]){case l.None:case l.Start:return u.SkillState.Idle;case l.Running:return u.SkillState.Running}},e.__cname="HeroSkillDrillSuper",i([s.injectField("SystemRole")],e.prototype,"SystemRole",void 0),i([s.injectField("Battle")],e.prototype,"Battle",void 0),i([s.injectField("ModelBattleSkill")],e.prototype,"ModelBattleSkill",void 0),e}(p.BaseHeroSkill);r.HeroSkillDrillSuper=f,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../role/RoleBuilder":"RoleBuilder","../BaseSkill":"BaseSkill","./BaseHeroSkill":"BaseHeroSkill"}],HeroSkillDrill:[function(t,e,r){"use strict";cc._RF.push(e,"a1126Cvz6ZBGaRPcIIHUaRg","HeroSkillDrill");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.HeroSkillDrill=void 0;var l,s=t("../../../../../../../framework/container/Container"),c=t("../../role/RoleBuilder"),u=t("../BaseSkill"),p=t("./BaseHeroSkill");(function(t){t[t.None=0]="None",t[t.Start=1]="Start",t[t.Running=2]="Running"})(l||(l={}));var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state=[],e.time=[],e.count=[],e.isShoot=[],e}return n(e,t),e.prototype.OnGetAttr=function(){return["let","aiv","bsp"]},e.prototype.OnChangeParams=function(t){this.SwitchRunning(t)},e.prototype.OnAddContext=function(t){this.SwitchNone(t),this.time[t]=0,this.count[t]=0},e.prototype.OnRemoveContext=function(t){this.state[t]=null,this.time[t]=null,this.count[t]=null},e.prototype.OnUpdate=function(t){var e,r,o=this.state;try{for(var n=a(this.tlContextId),i=n.next();!i.done;i=n.next()){var s=i.value;switch(o[s]){case l.Start:this.UpdateStart(s,t);break;case l.Running:this.UpdateRunning(s,t)}}}catch(c){e={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}},e.prototype.SwitchNone=function(t){this.state[t]=l.None},e.prototype.SwitchStart=function(t){this.state[t]=l.Start,this.time[t]=0,this.triggerSkill(t)},e.prototype.UpdateStart=function(t,e){if(this.GetIsSingleMode()){if(this.isShoot[t])return;this.isShoot[t]=!0,this.SwitchRunning(t)}this.time[t]+=e,this.SetMainSkillCD(t,0,this.time[t],this.GetCD(t)),this.time[t]>=this.GetCD(t)&&(this.time[t]=0,this.SwitchRunning(t))},e.prototype.SwitchRunning=function(t){this.SetMainSkillCD(t,0,1,1),this.state[t]=l.Running,this.time[t]=this.GetInterval(t),this.count[t]=0},e.prototype.UpdateRunning=function(t,e){this.time[t]+=e,this.time[t]>=this.GetInterval(t)&&this.count[t]<this.GetNum(t)&&(this.time[t]=0,this.count[t]++,this.OnTrigger(t))},e.prototype.OnTrigger=function(t){var e=this.tlContext[t].eid,r=this.Battle.getRef(e),o=this.checkNeedDestroyBullet(),n=[.25,.75,1.25,1.75],i=(n[Math.floor(Math.random()*n.length)]+.1*Math.random()-.05)*Math.PI,a=new c.RBContext;a.sender=r,a.rad=i;var l=new(this.GetBulletBuilder(this.GetBullet(t,0)));l.Setup(a),l.SetProperty("resId",this.GetBullet(t,0)),l.SetProperty("has_bve",this.GetHasBVE(t)),l.SetProperty("has_let",this.GetHasLET(t)),l.SetProperty("builder",l),l.SetProperty("skill_attr_modify",this.resId),this.SystemRole.ApplyBuilder(l,o),this.Battle.applyModify()},e.prototype.GetState=function(t){var e=t.cid;switch(this.state[e]){case l.None:case l.Start:return u.SkillState.Idle;case l.Running:return u.SkillState.Running}},e.__cname="HeroSkillDrill",i([s.injectField("SystemRole")],e.prototype,"SystemRole",void 0),i([s.injectField("Battle")],e.prototype,"Battle",void 0),i([s.injectField("ModelBattleSkill")],e.prototype,"ModelBattleSkill",void 0),e}(p.BaseHeroSkill);r.HeroSkillDrill=f,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../role/RoleBuilder":"RoleBuilder","../BaseSkill":"BaseSkill","./BaseHeroSkill":"BaseHeroSkill"}],HeroSkillDurianSuper:[function(t,e,r){"use strict";cc._RF.push(e,"9e6f2M6xUFM35+CbG+0Cnic","HeroSkillDurianSuper");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.HeroSkillDurianSuper=void 0;var l,s=t("../../../../../../../framework/container/Container"),c=t("../../role/RoleBuilder"),u=t("../BaseSkill"),p=t("./BaseHeroSkill");(function(t){t[t.None=0]="None",t[t.BeforeStart=1]="BeforeStart",t[t.Start=2]="Start",t[t.Running=3]="Running"})(l||(l={}));var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state=[],e.time=[],e.rad_base=[],e.count=[],e.isShoot=[],e.lastid=[],e}return n(e,t),e.prototype.OnGetAttr=function(){return["arg","bve","bsp"]},e.prototype.OnChangeParams=function(t){this.isShoot[t]=!1,this.SwitchBeforeStart(t)},e.prototype.OnGetScriptParam=function(){var t=this.GetTlScriptParam();return{cd:(t[0]||0)/1e3,interval:(t[1]||0)/1e3,num:t[2]}},e.prototype.OnAddContext=function(t){this.SwitchNone(t),this.time[t]=0,this.count[t]=0,this.isShoot[t]=null,this.lastid[t]=null},e.prototype.OnRemoveContext=function(t){this.removeOldBullet(t),this.state[t]=null,this.time[t]=null,this.count[t]=null,this.isShoot[t]=null,this.lastid[t]=null},e.prototype.OnUpdate=function(t){var e,r,o=this.state;try{for(var n=a(this.tlContextId),i=n.next();!i.done;i=n.next()){var s=i.value;switch(o[s]){case l.BeforeStart:this.UpdateBeforeStart(s,t);break;case l.Start:this.UpdateStart(s,t);break;case l.Running:this.UpdateRunning(s,t)}}}catch(c){e={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}},e.prototype.SwitchNone=function(t){this.state[t]=l.None},e.prototype.SwitchBeforeStart=function(t){this.state[t]=l.BeforeStart},e.prototype.UpdateBeforeStart=function(t){if(this.GetIsSingleMode()){if(this.isShoot[t])return;this.isShoot[t]=!0,this.OnTriggerDurian(t),this.SwitchStart(t)}},e.prototype.SwitchStart=function(t){this.state[t]=l.Start,this.time[t]=0,this.triggerSkill(t),this.SetMainSkillCD(t,0,this.time[t],this.GetCD(t))},e.prototype.UpdateStart=function(t,e){this.time[t]+=e,this.SetMainSkillCD(t,0,this.time[t],this.GetCD(t));var r=this._scriptParam.cd;if(r=this.CalCD(t,r),this.time[t]>=r){this.time[t]=0;var o=Math.random()*Math.PI*2;this.rad_base[t]=o,this.SwitchRunning(t)}},e.prototype.SwitchRunning=function(t){this.SetMainSkillCD(t,0,1,1);var e=this._scriptParam.interval;e=this.CalAttr_aiv(t,e),this.state[t]=l.Running,this.time[t]=e,this.count[t]=0},e.prototype.UpdateRunning=function(t,e){this.time[t]+=e;var r=this._scriptParam.interval;r=this.CalAttr_aiv(t,r);var o=this._scriptParam.num;this.time[t]>=r&&(this.OnTriggerBullet(t),this.time[t]=0,this.count[t]++),this.count[t]>=o&&this.SwitchStart(t)},e.prototype.removeOldBullet=function(t){var e=this.lastid[t];null!=e&&(this.SystemRole.DestroyRole(e),this.lastid[t]=null)},e.prototype.OnTriggerDurian=function(t){this.removeOldBullet(t),this.GPAudio.airflow();var e=this.tlContext[t].eid,r=this.Battle.getRef(e);this.checkNeedDestroyBullet();var o=[.25,.75,1.25,1.75],n=o[Math.floor(Math.random()*o.length)]*Math.PI,i=new c.RBContext;i.sender=r,i.rad=n;var a=new(this.GetBulletBuilder(this.GetBullet(t,0)));a.Setup(i),a.SetProperty("resId",this.GetBullet(t,0)),a.SetProperty("has_bve",this.GetHasBVE(t)),a.SetProperty("has_let",this.GetHasLET(t)),a.SetProperty("builder",a),a.SetProperty("skill_attr_modify",this.resId);var l=this.SystemRole.ApplyBuilder(a);this.lastid[t]=l,this.Battle.applyModify()},e.prototype.OnTriggerBullet=function(t){var e=this.lastid[t];if(null!=e){this.GPAudio.throwing();var r=this.Battle.getRef(e),o=this.GetBullet(t,1),n=this.rad_base[t],i=this.count[t]/this._scriptParam.num*Math.PI*2;i+=n;var a=new c.RBContext;a.sender=r,a.rad=i;var l=new(this.GetBulletBuilder(o));l.Setup(a),l.SetProperty("resId",o),l.SetProperty("has_bve",this.GetHasBVE(t)),l.SetProperty("has_let",this.GetHasLET(t)),l.SetProperty("builder",l),l.SetProperty("skill_attr_modify",this.resId),this.SystemRole.ApplyBuilder(l),this.Battle.applyModify()}},e.prototype.GetState=function(t){var e=t.cid;switch(this.state[e]){case l.None:case l.Start:return u.SkillState.Idle;case l.BeforeStart:case l.Running:return u.SkillState.Running}},e.__cname="HeroSkillDurianSuper",i([s.injectField("SystemRole")],e.prototype,"SystemRole",void 0),i([s.injectField("Battle")],e.prototype,"Battle",void 0),i([s.injectField("GPAudio")],e.prototype,"GPAudio",void 0),i([s.injectField("ModelBattleSkill")],e.prototype,"ModelBattleSkill",void 0),e}(p.BaseHeroSkill);r.HeroSkillDurianSuper=f,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../role/RoleBuilder":"RoleBuilder","../BaseSkill":"BaseSkill","./BaseHeroSkill":"BaseHeroSkill"}],HeroSkillDurian:[function(t,e,r){"use strict";cc._RF.push(e,"3b962VHfMhBHL2i96w3HPCd","HeroSkillDurian");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.HeroSkillDurian=void 0;var l,s=t("../../../../../../../framework/container/Container"),c=t("../../role/RoleBuilder"),u=t("../BaseSkill"),p=t("./BaseHeroSkill");(function(t){t[t.None=0]="None",t[t.Start=1]="Start",t[t.Running=2]="Running"})(l||(l={}));var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state=[],e.time=[],e.count=[],e.isShoot=[],e.lastid=[],e}return n(e,t),e.prototype.OnGetAttr=function(){return["arg","bve","bsp"]},e.prototype.OnChangeParams=function(t){this.isShoot[t]=!1,this.SwitchStart(t)},e.prototype.OnAddContext=function(t){this.SwitchNone(t),this.time[t]=0,this.count[t]=0,this.isShoot[t]=null,this.lastid[t]=null},e.prototype.OnRemoveContext=function(t){this.removeOldBullet(t),this.state[t]=null,this.time[t]=null,this.count[t]=null,this.isShoot[t]=null,this.lastid[t]=null},e.prototype.OnUpdate=function(t){var e,r,o=this.state;try{for(var n=a(this.tlContextId),i=n.next();!i.done;i=n.next()){var s=i.value;switch(o[s]){case l.Start:this.UpdateStart(s,t);break;case l.Running:this.UpdateRunning(s,t)}}}catch(c){e={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}},e.prototype.SwitchNone=function(t){this.state[t]=l.None},e.prototype.SwitchStart=function(t){this.state[t]=l.Start,this.time[t]=0,this.triggerSkill(t)},e.prototype.UpdateStart=function(t,e){if(this.GetIsSingleMode()){if(this.isShoot[t])return;this.isShoot[t]=!0,this.SwitchRunning(t)}this.time[t]+=e,this.SetMainSkillCD(t,0,this.time[t],this.GetCD(t));var r=this.GetCD(t);this.time[t]>=r&&(this.time[t]=0,this.SwitchRunning(t))},e.prototype.SwitchRunning=function(t){this.state[t]=l.Running,this.time[t]=this.GetInterval(t),this.count[t]=0},e.prototype.UpdateRunning=function(t,e){if(this.SetMainSkillCD(t,0,1,1),this.time[t]+=e,this.time[t]>=this.GetInterval(t)){this.time[t]=0,this.count[t]++;var r=this.findNear(t);r&&this.OnTrigger(t,r)}this.count[t]>=this.GetNum(t)&&this.SwitchStart(t)},e.prototype.removeOldBullet=function(t){var e=this.lastid[t];null!=e&&(this.SystemRole.DestroyRole(e),this.lastid[t]=null)},e.prototype.OnTrigger=function(t,e){this.removeOldBullet(t),this.GPAudio.airflow();var r=this.tlContext[t].eid,o=this.Battle.getRef(r),n=this.Battle.getRef(e),i=[.25,.75,1.25,1.75],a=i[Math.floor(Math.random()*i.length)]*Math.PI,l=new c.RBContext;l.sender=o,l.target=n,l.rad=a;var s=this.checkNeedDestroyBullet(),u=new(this.GetBulletBuilder(this.GetBullet(t,0)));u.Setup(l),u.SetProperty("resId",this.GetBullet(t,0)),u.SetProperty("has_bve",this.GetHasBVE(t)),u.SetProperty("has_let",this.GetHasLET(t)),u.SetProperty("builder",u),u.SetProperty("skill_attr_modify",this.resId);var p=this.SystemRole.ApplyBuilder(u,s);this.lastid[t]=p,this.Battle.applyModify()},e.prototype.GetState=function(t){var e=t.cid;switch(this.state[e]){case l.None:case l.Start:return u.SkillState.Idle;case l.Running:return u.SkillState.Running}},e.__cname="HeroSkillDurian",i([s.injectField("SystemRole")],e.prototype,"SystemRole",void 0),i([s.injectField("Battle")],e.prototype,"Battle",void 0),i([s.injectField("GPAudio")],e.prototype,"GPAudio",void 0),i([s.injectField("ModelBattleSkill")],e.prototype,"ModelBattleSkill",void 0),e}(p.BaseHeroSkill);r.HeroSkillDurian=f,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../role/RoleBuilder":"RoleBuilder","../BaseSkill":"BaseSkill","./BaseHeroSkill":"BaseHeroSkill"}],HeroSkillFieldSuper:[function(t,e,r){"use strict";cc._RF.push(e,"5168cY13fdKbrcNZCIX9G4g","HeroSkillFieldSuper");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.HeroSkillFieldSuper=void 0;var a=t("../../../../../../../framework/container/Container"),l=t("../../role/RoleBuilder"),s=t("../BaseSkill"),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tmBullet=new Map,e}return n(e,t),e.prototype.OnUpdate=function(){},e.prototype.OnGetAttr=function(){return["arg","bve"]},e.prototype.OnChangeParams=function(t){this.UpdateBullet(t)},e.prototype.OnAddContext=function(){},e.prototype.OnRemoveContext=function(t){this.RemoveBullet(t)},e.prototype.UpdateBullet=function(t){this.tmBullet.get(t)&&this.RemoveBullet(t),this.AddBullet(t)},e.prototype.AddBullet=function(t){if(!this.tmBullet.has(t)){this.SetMainSkillCD(t,0,1,1);var e=this.tlContext[t].eid,r=this.Battle.getRef(e),o=new l.RBContext;o.sender=r;var n=new(this.GetBulletBuilder(this.GetBullet(t,0)));n.Setup(o),n.SetProperty("resId",this.GetBullet(t,0)),n.SetProperty("has_bve",this.GetHasBVE(t)),n.SetProperty("has_let",this.GetHasLET(t)),n.SetProperty("builder",n),n.SetProperty("skill_attr_modify",this.resId);var i=this.SystemRole.ApplyBuilder(n);this.Battle.applyModify(),this.tmBullet.set(t,i),this.triggerSkill(t)}},e.prototype.RemoveBullet=function(t){if(this.tmBullet.has(t)){var e=this.tmBullet.get(t);this.SystemRole.DestroyRole(e),this.tmBullet.delete(t)}},e.prototype.GetState=function(){return s.SkillState.Running},e.__cname="HeroSkillFieldSuper",i([a.injectField("SystemRole")],e.prototype,"SystemRole",void 0),i([a.injectField("Battle")],e.prototype,"Battle",void 0),i([a.injectField("ModelBattleSkill")],e.prototype,"ModelBattleSkill",void 0),e}(t("./BaseHeroSkill").BaseHeroSkill);r.HeroSkillFieldSuper=c,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../role/RoleBuilder":"RoleBuilder","../BaseSkill":"BaseSkill","./BaseHeroSkill":"BaseHeroSkill"}],HeroSkillField:[function(t,e,r){"use strict";cc._RF.push(e,"deca2zbHd5OuosWFfbwHhOx","HeroSkillField");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.HeroSkillField=void 0;var a=t("../../../../../../../framework/container/Container"),l=t("../../role/RoleBuilder"),s=t("../BaseSkill"),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tmBullet=new Map,e}return n(e,t),e.prototype.OnUpdate=function(){},e.prototype.OnGetAttr=function(){return["arg","bve"]},e.prototype.OnChangeParams=function(t){this.UpdateBullet(t)},e.prototype.OnAddContext=function(){},e.prototype.OnRemoveContext=function(t){this.RemoveBullet(t)},e.prototype.UpdateBullet=function(t){this.tmBullet.get(t)&&this.RemoveBullet(t),this.AddBullet(t)},e.prototype.AddBullet=function(t){if(!this.tmBullet.has(t)){this.SetMainSkillCD(t,0,1,1);var e=this.tlContext[t].eid,r=this.Battle.getRef(e),o=new l.RBContext;o.sender=r;var n=new(this.GetBulletBuilder(this.GetBullet(t,0)));n.Setup(o),n.SetProperty("resId",this.GetBullet(t,0)),n.SetProperty("has_bve",this.GetHasBVE(t)),n.SetProperty("has_let",this.GetHasLET(t)),n.SetProperty("builder",n),n.SetProperty("skill_attr_modify",this.resId);var i=this.SystemRole.ApplyBuilder(n);this.Battle.applyModify(),this.tmBullet.set(t,i),this.triggerSkill(t)}},e.prototype.RemoveBullet=function(t){if(this.tmBullet.has(t)){var e=this.tmBullet.get(t);this.SystemRole.DestroyRole(e),this.tmBullet.delete(t)}},e.prototype.GetState=function(){return s.SkillState.Running},e.__cname="HeroSkillField",i([a.injectField("SystemRole")],e.prototype,"SystemRole",void 0),i([a.injectField("Battle")],e.prototype,"Battle",void 0),i([a.injectField("ModelBattleSkill")],e.prototype,"ModelBattleSkill",void 0),e}(t("./BaseHeroSkill").BaseHeroSkill);r.HeroSkillField=c,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../role/RoleBuilder":"RoleBuilder","../BaseSkill":"BaseSkill","./BaseHeroSkill":"BaseHeroSkill"}],HeroSkillFootball:[function(t,e,r){"use strict";cc._RF.push(e,"69963vIYZZOL63KctHute5D","HeroSkillFootball");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.HeroSkillFootball=void 0;var l,s=t("../../../../../../../framework/container/Container"),c=t("../../role/RoleBuilder"),u=t("../BaseSkill"),p=t("./BaseHeroSkill");(function(t){t[t.None=0]="None",t[t.Start=1]="Start",t[t.Running=2]="Running"})(l||(l={}));var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state=[],e.time=[],e.count=[],e}return n(e,t),e.prototype.OnGetAttr=function(){return["arg","bve","let","aiv"]},e.prototype.OnChangeParams=function(t){this.SwitchRunning(t)},e.prototype.OnAddContext=function(t){this.SwitchNone(t),this.time[t]=0,this.count[t]=0},e.prototype.OnRemoveContext=function(t){this.state[t]=null,this.time[t]=null,this.count[t]=null},e.prototype.OnUpdate=function(t){var e,r,o=this.state;try{for(var n=a(this.tlContextId),i=n.next();!i.done;i=n.next()){var s=i.value;switch(o[s]){case l.Start:this.UpdateStart(s,t);break;case l.Running:this.UpdateRunning(s,t)}}}catch(c){e={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}},e.prototype.SwitchNone=function(t){this.state[t]=l.None},e.prototype.SwitchStart=function(t){this.state[t]=l.Start,this.time[t]=0,this.SetMainSkillCD(t,0,this.time[t],this.GetCD(t)),this.triggerSkill(t)},e.prototype.UpdateStart=function(t,e){this.time[t]+=e,this.SetMainSkillCD(t,0,this.time[t],this.GetCD(t)),this.time[t]>=this.GetCD(t)&&(this.time[t]=0,this.SwitchRunning(t))},e.prototype.SwitchRunning=function(t){this.SetMainSkillCD(t,0,1,1),this.state[t]=l.Running,this.time[t]=this.GetInterval(t),this.count[t]=0},e.prototype.UpdateRunning=function(t,e){if(this.time[t]+=e,this.time[t]>=this.GetInterval(t)){this.time[t]=0,this.count[t]++;var r=this.findNear(t);r&&this.OnTrigger(t,r)}this.count[t]>=this.GetNum(t)&&this.SwitchStart(t)},e.prototype.OnTrigger=function(t,e){this.GPAudio.sword();var r=this.tlContext[t].eid,o=this.Battle.getRef(r),n=this.ComPos.x,i=this.ComPos.y,a=n[e]-n[r],l=i[e]-i[r],s=Math.atan2(l,a),u=new c.RBContext;u.rad=s,u.sender=o;var p=new(this.GetBulletBuilder(this.GetBullet(t,0)));p.Setup(u),p.SetProperty("resId",this.GetBullet(t,0)),p.SetProperty("has_bve",this.GetHasBVE(t)),p.SetProperty("has_let",this.GetHasLET(t)),p.SetProperty("builder",p),p.SetProperty("skill_attr_modify",this.resId),this.SystemRole.ApplyBuilder(p),this.ComVar.CalHeroAttr("s7134",1),this.Battle.applyModify()},e.prototype.GetState=function(t){var e=t.cid;switch(this.state[e]){case l.None:case l.Start:return u.SkillState.Idle;case l.Running:return u.SkillState.Running}},e.__cname="HeroSkillFootball",i([s.injectField("Battle")],e.prototype,"Battle",void 0),i([s.injectField("SystemRole")],e.prototype,"SystemRole",void 0),i([s.injectField("GPAudio")],e.prototype,"GPAudio",void 0),i([s.injectField("ModelBattleSkill")],e.prototype,"ModelBattleSkill",void 0),e}(p.BaseHeroSkill);r.HeroSkillFootball=f,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../role/RoleBuilder":"RoleBuilder","../BaseSkill":"BaseSkill","./BaseHeroSkill":"BaseHeroSkill"}],HeroSkillGuarderSuper:[function(t,e,r){"use strict";cc._RF.push(e,"198afCYIClH/YqzS5Ike3XV","HeroSkillGuarderSuper");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.HeroSkillGuarderSuper=void 0;var l,s=t("../../../../../../../framework/container/Container"),c=t("../../role/RoleBuilder"),u=t("../BaseSkill"),p=t("./BaseHeroSkill");(function(t){t[t.None=0]="None",t[t.Start=1]="Start",t[t.Running=2]="Running"})(l||(l={}));var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state=[],e.time=[],e.count=[],e.isShoot=[],e.bullets=[],e}return n(e,t),e.prototype.OnGetAttr=function(){return["arg","bve","let","bsp"]},e.prototype.OnChangeParams=function(t){this.SwitchRunning(t)},e.prototype.OnGetScriptParam=function(){return{radius:this.GetTlScriptParam()[0]}},e.prototype.OnAddContext=function(t){this.SwitchNone(t),this.time[t]=0,this.count[t]=0},e.prototype.OnRemoveContext=function(t){this.clearSelfBullet(t),this.state[t]=null,this.time[t]=null,this.count[t]=null,this.isShoot[t]=null},e.prototype.clearPlayState=function(){var t,e,r=this,o=function(t){n.clearSelfBullet(t),setTimeout(function(){r.time[t]=null,r.count[t]=null,r.isShoot[t]=null},100)},n=this;try{for(var i=a(this.tlContextId),l=i.next();!l.done;l=i.next())o(l.value)}catch(s){t={error:s}}finally{try{l&&!l.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}},e.prototype.OnUpdate=function(t){var e,r,o=this.state;try{for(var n=a(this.tlContextId),i=n.next();!i.done;i=n.next()){var s=i.value;switch(o[s]){case l.Start:this.UpdateStart(s,t);break;case l.Running:this.UpdateRunning(s,t)}}}catch(c){e={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}},e.prototype.SwitchNone=function(t){this.state[t]=l.None},e.prototype.SwitchStart=function(t){this.state[t]=l.Start,this.time[t]=0,this.triggerSkill(t)},e.prototype.UpdateStart=function(t,e){this.GetIsSingleMode()&&this.SwitchRunning(t),this.time[t]+=e,this.SetMainSkillCD(t,0,this.time[t],this.GetCD(t)),this.time[t]>=this.GetCD(t)&&(this.time[t]=0,this.SwitchRunning(t))},e.prototype.SwitchRunning=function(t){if(this.GetIsSingleMode()){if(this.isShoot[t])return;this.isShoot[t]=!0}this.SetMainSkillCD(t,0,1,1),this.state[t]=l.Running,this.time[t]=this.GetInterval(t),this.count[t]=0},e.prototype.UpdateRunning=function(t,e){this.time[t]+=e,this.OnTrigger(t),this.SwitchStart(t)},e.prototype.clearSelfBullet=function(t){var e,r,o=this.bullets[t]||(this.bullets[t]=[]);try{for(var n=a(o),i=n.next();!i.done;i=n.next()){var l=i.value;this.SystemRole.DestroyRole(l)}}catch(s){e={error:s}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}o.length=0},e.prototype.OnTrigger=function(t){this.GPAudio.sword();var e=this.tlContext[t].eid,r=this.Battle.getRef(e),o=this.GetNum(t),n=this.bullets[t]||(this.bullets[t]=[]);this.checkNeedDestroyBullet(),this.clearSelfBullet(t);var i=this._scriptParam.radius;i=this.CalAttr_arg(t,i);for(var a=0;a<o;a++){var l=2*Math.PI/o*a,s=new c.RBContext;s.sender=r,s.rad=l,s.radius=i;var u=new(this.GetBulletBuilder(this.GetBullet(t,0)));u.Setup(s),u.SetProperty("resId",this.GetBullet(t,0)),u.SetProperty("has_bve",this.GetHasBVE(t)),u.SetProperty("has_let",this.GetHasLET(t)),u.SetProperty("builder",u),u.SetProperty("skill_attr_modify",this.resId);var p=this.SystemRole.ApplyBuilder(u);n.push(p)}this.Battle.applyModify()},e.prototype.GetState=function(t){var e=t.cid;switch(this.state[e]){case l.None:case l.Start:return u.SkillState.Idle;case l.Running:return u.SkillState.Running}},e.__cname="HeroSkillGuarderSuper",i([s.injectField("SystemRole")],e.prototype,"SystemRole",void 0),i([s.injectField("SystemMove")],e.prototype,"SystemMove",void 0),i([s.injectField("ComVar")],e.prototype,"ComVar",void 0),i([s.injectField("ComPos")],e.prototype,"ComPos",void 0),i([s.injectField("Battle")],e.prototype,"Battle",void 0),i([s.injectField("GPAudio")],e.prototype,"GPAudio",void 0),e}(p.BaseHeroSkill);r.HeroSkillGuarderSuper=f,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../role/RoleBuilder":"RoleBuilder","../BaseSkill":"BaseSkill","./BaseHeroSkill":"BaseHeroSkill"}],HeroSkillGuarder:[function(t,e,r){"use strict";cc._RF.push(e,"9aeffO/WKtPGa1FRJKTHbSv","HeroSkillGuarder");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.HeroSkillGuarder=void 0;var l,s=t("../../../../../../../framework/container/Container"),c=t("../../role/RoleBuilder"),u=t("../BaseSkill"),p=t("./BaseHeroSkill");(function(t){t[t.Start=0]="Start",t[t.Running=1]="Running"})(l||(l={}));var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state=[],e.time=[],e.tlBullets=[],e}return n(e,t),e.prototype.OnInit=function(){},e.prototype.OnRelease=function(){},e.prototype.OnGetAttr=function(){return["arg","bve","let","aiv","bsp"]},e.prototype.OnChangeParams=function(t){this.SwitchRunning(t)},e.prototype.OnGetScriptParam=function(){return{radius:this.GetTlScriptParam()[0]}},e.prototype.OnAddContext=function(t){this.state[t]=null,this.time[t]=0,this.tlBullets[t]=[]},e.prototype.OnRemoveContext=function(t){this.state[t]=null,this.time[t]=null},e.prototype.OnUpdate=function(t){var e,r;try{for(var o=a(this.tlContextId),n=o.next();!n.done;n=o.next()){var i=n.value;switch(this.state[i]){case l.Start:this.UpdateStart(i,t);break;case l.Running:this.UpdateRunning(i,t)}}}catch(s){e={error:s}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}},e.prototype.SwitchStart=function(t){this.state[t]=l.Start,this.time[t]=0,this.SetMainSkillCD(t,0,this.time[t],this.GetCD(t)),this.triggerSkill(t)},e.prototype.UpdateStart=function(t,e){this.time[t]+=e,this.SetMainSkillCD(t,0,this.time[t],this.GetCD(t)),this.time[t]>=this.GetCD(t)&&(this.time[t]=0,this.SwitchRunning(t))},e.prototype.SwitchRunning=function(t){this.SetMainSkillCD(t,0,1,1),this.state[t]=l.Running},e.prototype.UpdateRunning=function(t){this.OnTrigger(t),this.SwitchStart(t)},e.prototype.OnTrigger=function(t){this.GPAudio.sword();for(var e=this.tlContext[t].eid,r=this.Battle.getRef(e),o=this.GetNum(t),n=this.checkNeedDestroyBullet(),i=(this.Battle,this.GetBullet(t,0)),a=(this.ModelBattleSkill.GetBullet(i),0);a<o;a++){var l=2*Math.PI/o*a,s=this._scriptParam.radius;s=this.CalAttr_arg(t,s);var u=new c.RBContext;u.sender=r,u.rad=l,u.radius=s;var p=new(this.GetBulletBuilder(i));p.Setup(u),p.SetProperty("resId",i),p.SetProperty("has_bve",this.GetHasBVE(t)),p.SetProperty("has_let",this.GetHasLET(t)),p.SetProperty("builder",p),p.SetProperty("skill_attr_modify",this.resId),this.SystemRole.ApplyBuilder(p,n)}this.Battle.applyModify()},e.prototype.GetState=function(t){var e=t.cid;switch(this.state[e]){case l.Start:return u.SkillState.Idle;case l.Running:return u.SkillState.Running}},e.__cname="HeroSkillGuarder",i([s.injectField("SystemRole")],e.prototype,"SystemRole",void 0),i([s.injectField("Battle")],e.prototype,"Battle",void 0),i([s.injectField("GPAudio")],e.prototype,"GPAudio",void 0),i([s.injectField("ModelBattleSkill")],e.prototype,"ModelBattleSkill",void 0),e}(p.BaseHeroSkill);r.HeroSkillGuarder=f,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../role/RoleBuilder":"RoleBuilder","../BaseSkill":"BaseSkill","./BaseHeroSkill":"BaseHeroSkill"}],HeroSkillKanataS:[function(t,e,r){"use strict";cc._RF.push(e,"ac799hoTNdD4oZg7N+yRPRI","HeroSkillKanataS");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.HeroSkillKanataS=void 0;var l,s=t("../../../../../../../framework/container/Container"),c=t("../../role/RoleBuilder"),u=t("../BaseSkill"),p=t("./BaseHeroSkill");(function(t){t[t.None=0]="None",t[t.Start=1]="Start",t[t.Running=2]="Running"})(l||(l={}));var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state=[],e.time=[],e.count=[],e}return n(e,t),e.prototype.OnGetAttr=function(){return["arg","bve","let","aiv"]},e.prototype.OnChangeParams=function(t){this.SwitchRunning(t)},e.prototype.OnGetScriptParam=function(){return{angular:this.GetTlScriptParam()[0]||0}},e.prototype.OnAddContext=function(t){this.SwitchNone(t),this.time[t]=0,this.count[t]=0},e.prototype.OnRemoveContext=function(t){this.state[t]=null,this.time[t]=null,this.count[t]=null},e.prototype.OnUpdate=function(t){var e,r,o=this.state;try{for(var n=a(this.tlContextId),i=n.next();!i.done;i=n.next()){var s=i.value;switch(o[s]){case l.Start:this.UpdateStart(s,t);break;case l.Running:this.UpdateRunning(s,t)}}}catch(c){e={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}},e.prototype.SwitchNone=function(t){this.state[t]=l.None},e.prototype.SwitchStart=function(t){this.state[t]=l.Start,this.time[t]=0,this.SetMainSkillCD(t,0,this.time[t],this.GetCD(t)),this.triggerSkill(t)},e.prototype.UpdateStart=function(t,e){this.time[t]+=e,this.SetMainSkillCD(t,0,this.time[t],this.GetCD(t)),this.time[t]>=this.GetCD(t)&&(this.time[t]=0,this.SwitchRunning(t))},e.prototype.SwitchRunning=function(t){this.SetMainSkillCD(t,0,1,1),this.state[t]=l.Running,this.time[t]=this.GetInterval(t),this.count[t]=0},e.prototype.UpdateRunning=function(t,e){this.time[t]+=e;for(var r=this.GetInterval(t);this.time[t]>=r;){var o=this.GetBullet(t,this.count[t]);if(this.OnTrigger(t,o),this.time[t]-=r,this.count[t]++,this.count[t]>=this.GetBulletLength())return void this.SwitchStart(t)}},e.prototype.OnTrigger=function(t,e){this.GPAudio.throwing(),this.ComPos.x,this.ComPos.y;var r=this.tlContext[t].eid,o=this.Battle.getRef(r),n=this.ComPos.d,i=this._scriptParam,a=n[r],l=new c.RBContext;l.sender=o;for(var s=1,u=this.GetNum(t),p=u+2,f=i.angular/180*Math.PI,h=f/p,y=0;y<u;y++){var d=a+h*s-.5*f;s++,l.rad=d;var m=new(this.GetBulletBuilder(e));m.Setup(l),m.SetProperty("resId",e),m.SetProperty("has_bve",this.GetHasBVE(t)),m.SetProperty("has_let",this.GetHasLET(t)),m.SetProperty("builder",m),m.SetProperty("skill_attr_modify",this.resId),this.SystemRole.ApplyBuilder(m)}this.Battle.applyModify()},e.prototype.GetState=function(t){var e=t.cid;switch(this.state[e]){case l.None:case l.Start:return u.SkillState.Idle;case l.Running:return u.SkillState.Running}},e.__cname="HeroSkillKanataS",i([s.injectField("SystemRole")],e.prototype,"SystemRole",void 0),i([s.injectField("SystemMove")],e.prototype,"SystemMove",void 0),i([s.injectField("ComVar")],e.prototype,"ComVar",void 0),i([s.injectField("ComPos")],e.prototype,"ComPos",void 0),i([s.injectField("Battle")],e.prototype,"Battle",void 0),i([s.injectField("GPAudio")],e.prototype,"GPAudio",void 0),i([s.injectField("ModelBattleSkill")],e.prototype,"ModelBattleSkill",void 0),e}(p.BaseHeroSkill);r.HeroSkillKanataS=f,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../role/RoleBuilder":"RoleBuilder","../BaseSkill":"BaseSkill","./BaseHeroSkill":"BaseHeroSkill"}],HeroSkillKanata:[function(t,e,r){"use strict";cc._RF.push(e,"2e2da4LCltHTJnNs3igV4tc","HeroSkillKanata");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.HeroSkillKanata=void 0;var l,s=t("../../../../../../../framework/container/Container"),c=t("../../role/RoleBuilder"),u=t("../BaseSkill"),p=t("./BaseHeroSkill");(function(t){t[t.None=0]="None",t[t.Start=1]="Start",t[t.Running=2]="Running"})(l||(l={}));var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state=[],e.time=[],e.count=[],e}return n(e,t),e.prototype.OnGetAttr=function(){return["arg","bve","let","aiv"]},e.prototype.OnChangeParams=function(t){this.SwitchRunning(t)},e.prototype.OnGetScriptParam=function(){return{bullet:this.GetTlScriptParam()[0]||null}},e.prototype.OnAddContext=function(t){this.SwitchNone(t),this.time[t]=0,this.count[t]=0},e.prototype.OnRemoveContext=function(t){this.state[t]=null,this.time[t]=null,this.count[t]=null},e.prototype.OnUpdate=function(t){var e,r,o=this.state;try{for(var n=a(this.tlContextId),i=n.next();!i.done;i=n.next()){var s=i.value;switch(o[s]){case l.Start:this.UpdateStart(s,t);break;case l.Running:this.UpdateRunning(s,t)}}}catch(c){e={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}},e.prototype.SwitchNone=function(t){this.state[t]=l.None},e.prototype.SwitchStart=function(t){this.state[t]=l.Start,this.time[t]=0,this.SetMainSkillCD(t,0,this.time[t],this.GetCD(t)),this.triggerSkill(t)},e.prototype.UpdateStart=function(t,e){this.time[t]+=e,this.SetMainSkillCD(t,0,this.time[t],this.GetCD(t)),this.time[t]>=this.GetCD(t)&&(this.time[t]=0,this.SwitchRunning(t))},e.prototype.SwitchRunning=function(t){this.SetMainSkillCD(t,0,1,1),this.state[t]=l.Running,this.time[t]=this.GetInterval(t),this.count[t]=0},e.prototype.UpdateRunning=function(t,e){this.time[t]+=e;for(var r=this.GetInterval(t);this.time[t]>=r;)if(this.OnTrigger(t),this.time[t]-=r,this.count[t]++,this.count[t]>=this.GetNum(t))return void this.SwitchStart(t)},e.prototype.OnTrigger=function(t){this.GPAudio.throwing(),this.ComPos.x,this.ComPos.y;var e=this.tlContext[t].eid,r=this.Battle.getRef(e),o=this.ComPos.d[e],n=new c.RBContext;n.sender=r,this.count[t]%2==0||(o+=Math.PI),n.rad=o;var i=new(this.GetBulletBuilder(this.GetBullet(t,0)));i.Setup(n),i.SetProperty("resId",this.GetBullet(t,0)),i.SetProperty("has_bve",this.GetHasBVE(t)),i.SetProperty("has_let",this.GetHasLET(t)),i.SetProperty("builder",i),i.SetProperty("skill_attr_modify",this.resId),this.SystemRole.ApplyBuilder(i);var a=this._scriptParam;if(a.bullet){var l=a.bullet,s=new(this.GetBulletBuilder(l));s.Setup(n),s.SetProperty("resId",l),s.SetProperty("has_bve",this.GetHasBVE(t)),s.SetProperty("has_let",this.GetHasLET(t)),s.SetProperty("builder",s),s.SetProperty("skill_attr_modify",this.resId),this.SystemRole.ApplyBuilder(s)}this.Battle.applyModify()},e.prototype.GetState=function(t){var e=t.cid;switch(this.state[e]){case l.None:case l.Start:return u.SkillState.Idle;case l.Running:return u.SkillState.Running}},e.__cname="HeroSkillKanata",i([s.injectField("SystemRole")],e.prototype,"SystemRole",void 0),i([s.injectField("SystemMove")],e.prototype,"SystemMove",void 0),i([s.injectField("ComVar")],e.prototype,"ComVar",void 0),i([s.injectField("ComPos")],e.prototype,"ComPos",void 0),i([s.injectField("Battle")],e.prototype,"Battle",void 0),i([s.injectField("GPAudio")],e.prototype,"GPAudio",void 0),i([s.injectField("ModelBattleSkill")],e.prototype,"ModelBattleSkill",void 0),e}(p.BaseHeroSkill);r.HeroSkillKanata=f,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../role/RoleBuilder":"RoleBuilder","../BaseSkill":"BaseSkill","./BaseHeroSkill":"BaseHeroSkill"}],HeroSkillLightning:[function(t,e,r){"use strict";cc._RF.push(e,"e3aa4oeq7JIHIrq3/zyrexm","HeroSkillLightning");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.HeroSkillLightning=void 0;var l,s=t("../../../../../../../framework/container/Container"),c=t("../../role/RoleBuilder"),u=t("../BaseSkill"),p=t("./BaseHeroSkill");(function(t){t[t.None=0]="None",t[t.Start=1]="Start",t[t.Running=2]="Running"})(l||(l={}));var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state=[],e.time=[],e.count=[],e}return n(e,t),e.prototype.OnGetAttr=function(){return["arg","bve","aiv"]},e.prototype.OnChangeParams=function(t){this.SwitchRunning(t)},e.prototype.OnAddContext=function(t){this.SwitchNone(t),this.time[t]=0,this.count[t]=0},e.prototype.OnRemoveContext=function(t){this.state[t]=null,this.time[t]=null,this.count[t]=null},e.prototype.OnUpdate=function(t){var e,r,o=this.state;try{for(var n=a(this.tlContextId),i=n.next();!i.done;i=n.next()){var s=i.value;switch(o[s]){case l.Start:this.UpdateStart(s,t);break;case l.Running:this.UpdateRunning(s,t)}}}catch(c){e={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}},e.prototype.SwitchNone=function(t){this.state[t]=l.None},e.prototype.SwitchStart=function(t){this.state[t]=l.Start,this.time[t]=0,this.SetMainSkillCD(t,0,this.time[t],this.GetCD(t)),this.triggerSkill(t)},e.prototype.UpdateStart=function(t,e){this.time[t]+=e,this.SetMainSkillCD(t,0,this.time[t],this.GetCD(t)),this.time[t]>=this.GetCD(t)&&(this.time[t]=0,this.SwitchRunning(t))},e.prototype.SwitchRunning=function(t){this.SetMainSkillCD(t,0,1,1),this.state[t]=l.Running,this.time[t]=this.GetInterval(t),this.count[t]=0},e.prototype.UpdateRunning=function(t,e){if(this.time[t]+=e,this.time[t]>=this.GetInterval(t)){this.time[t]=0,this.count[t]++;var r=this.findRandom();r&&this.OnTrigger(t,r)}this.count[t]>=this.GetNum(t)&&this.SwitchStart(t)},e.prototype.GetNum=function(e){var r=t.prototype.GetNum.call(this,e);return this.ComVar.CalHeroAttr("s7154",r)},e.prototype.OnTrigger=function(t,e){this.GPAudio.lightning(),this.ComPos.x,this.ComPos.y;var r=this.tlContext[t].eid,o=this.Battle.getRef(r),n=this.Battle.getRef(e),i=new c.RBContext;i.sender=o,i.target=n;var a=new(this.GetBulletBuilder(this.GetBullet(t,0)));a.Setup(i),a.SetProperty("resId",this.GetBullet(t,0)),a.SetProperty("has_bve",this.GetHasBVE(t)),a.SetProperty("has_let",this.GetHasLET(t)),a.SetProperty("builder",a),a.SetProperty("skill_attr_modify",this.resId),this.SystemRole.ApplyBuilder(a),this.Battle.applyModify()},e.prototype.GetState=function(t){var e=t.cid;switch(this.state[e]){case l.None:case l.Start:return u.SkillState.Idle;case l.Running:return u.SkillState.Running}},e.__cname="HeroSkillLightning",i([s.injectField("SystemRole")],e.prototype,"SystemRole",void 0),i([s.injectField("SystemMove")],e.prototype,"SystemMove",void 0),i([s.injectField("ComVar")],e.prototype,"ComVar",void 0),i([s.injectField("ComPos")],e.prototype,"ComPos",void 0),i([s.injectField("Battle")],e.prototype,"Battle",void 0),i([s.injectField("GPAudio")],e.prototype,"GPAudio",void 0),e}(p.BaseHeroSkill);r.HeroSkillLightning=f,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../role/RoleBuilder":"RoleBuilder","../BaseSkill":"BaseSkill","./BaseHeroSkill":"BaseHeroSkill"}],HeroSkillLunhui:[function(t,e,r){"use strict";cc._RF.push(e,"b41fcoN6z5HyabOAyPA5mW6","HeroSkillLunhui");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.HeroSkillLunhui=void 0;var l,s=t("../../../../../../../framework/container/Container"),c=t("../../role/RoleBuilder"),u=t("../BaseSkill"),p=t("./BaseHeroSkill");(function(t){t[t.None=0]="None",t[t.Start=1]="Start",t[t.Running=2]="Running"})(l||(l={}));var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state=[],e.time=[],e.count=[],e}return n(e,t),e.prototype.OnGetAttr=function(){return["arg","bve","aiv","bsp"]},e.prototype.OnChangeParams=function(t){this.SwitchRunning(t)},e.prototype.OnGetScriptParam=function(){return{shootDegree:this.GetTlScriptParam()[0]||0}},e.prototype.OnAddContext=function(t){this.SwitchNone(t),this.time[t]=0,this.count[t]=0},e.prototype.OnRemoveContext=function(t){this.state[t]=null,this.time[t]=null,this.count[t]=null},e.prototype.OnUpdate=function(t){var e,r,o=this.state;try{for(var n=a(this.tlContextId),i=n.next();!i.done;i=n.next()){var s=i.value;switch(o[s]){case l.Start:this.UpdateStart(s,t);break;case l.Running:this.UpdateRunning(s,t)}}}catch(c){e={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}},e.prototype.SwitchNone=function(t){this.state[t]=l.None},e.prototype.SwitchStart=function(t){this.state[t]=l.Start,this.time[t]=0,this.SetMainSkillCD(t,0,this.time[t],this.GetCD(t)),this.triggerSkill(t)},e.prototype.UpdateStart=function(t,e){this.time[t]+=e,this.SetMainSkillCD(t,0,this.time[t],this.GetCD(t)),this.time[t]>=this.GetCD(t)&&(this.time[t]=0,this.SwitchRunning(t))},e.prototype.SwitchRunning=function(t){this.SetMainSkillCD(t,0,1,1),this.state[t]=l.Running,this.time[t]=this.GetInterval(t),this.count[t]=0},e.prototype.UpdateRunning=function(t,e){this.time[t]+=e,this.time[t]>=this.GetInterval(t)&&(this.OnTrigger(t),this.time[t]=0,this.count[t]++),this.count[t]>=this.GetNum(t)&&this.SwitchStart(t)},e.prototype.OnTrigger=function(t){this.GPAudio.throwing();var e=this.tlContext[t].eid,r=this.Battle.getRef(e),o=this.ComPos.d,n=this.count[t],i=this.GetNum(t),a=this._scriptParam.shootDegree/180*Math.PI,l=a/i,s=n*l+.5*l;s-=a/2,s+=o[e];var u=new c.RBContext;u.sender=r,u.rad=s;var p=new(this.GetBulletBuilder(this.GetBullet(t,0)));p.Setup(u),p.SetProperty("resId",this.GetBullet(t,0)),p.SetProperty("has_bve",this.GetHasBVE(t)),p.SetProperty("has_let",this.GetHasLET(t)),p.SetProperty("builder",p),p.SetProperty("skill_attr_modify",this.resId),this.SystemRole.ApplyBuilder(p),this.Battle.applyModify()},e.prototype.GetState=function(t){var e=t.cid;switch(this.state[e]){case l.None:case l.Start:return u.SkillState.Idle;case l.Running:return u.SkillState.Running}},e.__cname="HeroSkillLunhui",i([s.injectField("SystemRole")],e.prototype,"SystemRole",void 0),i([s.injectField("SystemMove")],e.prototype,"SystemMove",void 0),i([s.injectField("ComVar")],e.prototype,"ComVar",void 0),i([s.injectField("ComPos")],e.prototype,"ComPos",void 0),i([s.injectField("Battle")],e.prototype,"Battle",void 0),i([s.injectField("GPAudio")],e.prototype,"GPAudio",void 0),i([s.injectField("ModelBattleSkill")],e.prototype,"ModelBattleSkill",void 0),e}(p.BaseHeroSkill);r.HeroSkillLunhui=f,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../role/RoleBuilder":"RoleBuilder","../BaseSkill":"BaseSkill","./BaseHeroSkill":"BaseHeroSkill"}],HeroSkillMissile:[function(t,e,r){"use strict";cc._RF.push(e,"7ac52rUG+hGSJrDsccD8JgA","HeroSkillMissile");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.HeroSkillMissile=void 0;var l,s=t("../../../../../../../framework/container/Container"),c=t("../../role/RoleBuilder"),u=t("../BaseSkill"),p=t("./BaseHeroSkill");(function(t){t[t.None=0]="None",t[t.Start=1]="Start",t[t.Running=2]="Running"})(l||(l={}));var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state=[],e.time=[],e.count=[],e}return n(e,t),e.prototype.OnGetAttr=function(){return["arg","bve","aiv","bsp"]},e.prototype.OnChangeParams=function(t){this.SwitchRunning(t)},e.prototype.OnAddContext=function(t){this.SwitchNone(t),this.time[t]=0,this.count[t]=0},e.prototype.OnRemoveContext=function(t){this.state[t]=null,this.time[t]=null,this.count[t]=null},e.prototype.OnUpdate=function(t){var e,r,o=this.state;try{for(var n=a(this.tlContextId),i=n.next();!i.done;i=n.next()){var s=i.value;switch(o[s]){case l.Start:this.UpdateStart(s,t);break;case l.Running:this.UpdateRunning(s,t)}}}catch(c){e={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}},e.prototype.SwitchNone=function(t){this.state[t]=l.None},e.prototype.SwitchStart=function(t){this.state[t]=l.Start,this.time[t]=0,this.SetMainSkillCD(t,0,this.time[t],this.GetCD(t)),this.triggerSkill(t)},e.prototype.UpdateStart=function(t,e){this.time[t]+=e,this.SetMainSkillCD(t,0,this.time[t],this.GetCD(t)),this.time[t]>=this.GetCD(t)&&(this.time[t]=0,this.SwitchRunning(t))},e.prototype.SwitchRunning=function(t){this.SetMainSkillCD(t,0,1,1),this.state[t]=l.Running,this.time[t]=this.GetInterval(t),this.count[t]=0},e.prototype.UpdateRunning=function(t,e){if(this.time[t]+=e,this.time[t]>=this.GetInterval(t)){this.time[t]=0,this.count[t]++;var r=this.findNear(t);r&&this.OnTrigger(t,r)}this.count[t]>=this.GetNum(t)&&this.SwitchStart(t)},e.prototype.GetCD=function(e){var r=t.prototype.GetCD.call(this,e);return this.ComVar.CalHeroAttr("s7054",r)},e.prototype.GetNum=function(e){var r=t.prototype.GetNum.call(this,e);if(10019==this._ref.GetRef().skillId){var o=this.ComVar.CalHeroAttr("s7056",0);if(o>=0)return o}return r},e.prototype.OnTrigger=function(t,e){this.GPAudio.airflow();var r=this.tlContext[t].eid,o=this.Battle.getRef(r),n=this.Battle.getRef(e),i=new c.RBContext;i.sender=o,i.target=n;var a=new(this.GetBulletBuilder(this.GetBullet(t,0)));a.Setup(i),a.SetProperty("resId",this.GetBullet(t,0)),a.SetProperty("has_bve",this.GetHasBVE(t)),a.SetProperty("has_let",this.GetHasLET(t)),a.SetProperty("builder",a),a.SetProperty("skill_attr_modify",this.resId),this.SystemRole.ApplyBuilder(a),this.Battle.applyModify()},e.prototype.GetState=function(t){var e=t.cid;switch(this.state[e]){case l.None:case l.Start:return u.SkillState.Idle;case l.Running:return u.SkillState.Running}},e.__cname="HeroSkillMissile",i([s.injectField("Battle")],e.prototype,"Battle",void 0),i([s.injectField("SystemRole")],e.prototype,"SystemRole",void 0),i([s.injectField("GPAudio")],e.prototype,"GPAudio",void 0),i([s.injectField("ModelBattleSkill")],e.prototype,"ModelBattleSkill",void 0),e}(p.BaseHeroSkill);r.HeroSkillMissile=f,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../role/RoleBuilder":"RoleBuilder","../BaseSkill":"BaseSkill","./BaseHeroSkill":"BaseHeroSkill"}],HeroSkillMolotov:[function(t,e,r){"use strict";cc._RF.push(e,"c5a6cpG/WREO6XahuO2nDfJ","HeroSkillMolotov");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.HeroSkillMolotov=void 0;var l,s=t("../../../../../../../framework/container/Container"),c=t("../../role/RoleBuilder"),u=t("../BaseSkill"),p=t("./BaseHeroSkill");(function(t){t[t.None=0]="None",t[t.Start=1]="Start",t[t.Running=2]="Running"})(l||(l={}));var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state=[],e.time=[],e.count=[],e}return n(e,t),e.prototype.OnGetAttr=function(){return["arg","bve","let","aiv"]},e.prototype.OnChangeParams=function(t){this.SwitchRunning(t)},e.prototype.OnAddContext=function(t){this.SwitchNone(t),this.time[t]=0,this.count[t]=0},e.prototype.OnRemoveContext=function(t){this.state[t]=null,this.time[t]=null,this.count[t]=null},e.prototype.OnUpdate=function(t){var e,r,o=this.state;try{for(var n=a(this.tlContextId),i=n.next();!i.done;i=n.next()){var s=i.value;switch(o[s]){case l.Start:this.UpdateStart(s,t);break;case l.Running:this.UpdateRunning(s,t)}}}catch(c){e={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}},e.prototype.SwitchNone=function(t){this.state[t]=l.None},e.prototype.SwitchStart=function(t){this.state[t]=l.Start,this.time[t]=0,this.SetMainSkillCD(t,0,this.time[t],this.GetCD(t)),this.triggerSkill(t)},e.prototype.UpdateStart=function(t,e){this.time[t]+=e,this.SetMainSkillCD(t,0,this.time[t],this.GetCD(t)),this.time[t]>=this.GetCD(t)&&(this.time[t]=0,this.SwitchRunning(t))},e.prototype.SwitchRunning=function(t){this.SetMainSkillCD(t,0,1,1),this.state[t]=l.Running,this.time[t]=this.GetInterval(t),this.count[t]=0},e.prototype.UpdateRunning=function(t,e){this.time[t]+=e,this.time[t]>=this.GetInterval(t)&&(this.OnTrigger(t),this.time[t]=0,this.count[t]++),this.count[t]>=this.GetNum(t)&&this.SwitchStart(t)},e.prototype.OnTrigger=function(t){this.GPAudio.throwing();var e=this.tlContext[t].eid,r=this.Battle.getRef(e),o=(this.ComPos.d,this.count[t]),n=this.GetNum(t),i=o*(2*Math.PI/n),a=new c.RBContext;a.sender=r,a.rad=i;var l=new(this.GetBulletBuilder(this.GetBullet(t,0)));l.Setup(a),l.SetProperty("resId",this.GetBullet(t,0)),l.SetProperty("has_bve",this.GetHasBVE(t)),l.SetProperty("has_let",this.GetHasLET(t)),l.SetProperty("builder",l),l.SetProperty("skill_attr_modify",this.resId),this.SystemRole.ApplyBuilder(l),this.Battle.applyModify()},e.prototype.GetState=function(t){var e=t.cid;switch(this.state[e]){case l.None:case l.Start:return u.SkillState.Idle;case l.Running:return u.SkillState.Running}},e.__cname="HeroSkillMolotov",i([s.injectField("SystemRole")],e.prototype,"SystemRole",void 0),i([s.injectField("SystemMove")],e.prototype,"SystemMove",void 0),i([s.injectField("ComVar")],e.prototype,"ComVar",void 0),i([s.injectField("ComPos")],e.prototype,"ComPos",void 0),i([s.injectField("Battle")],e.prototype,"Battle",void 0),i([s.injectField("GPAudio")],e.prototype,"GPAudio",void 0),i([s.injectField("ModelBattleSkill")],e.prototype,"ModelBattleSkill",void 0),e}(p.BaseHeroSkill);r.HeroSkillMolotov=f,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../role/RoleBuilder":"RoleBuilder","../BaseSkill":"BaseSkill","./BaseHeroSkill":"BaseHeroSkill"}],HeroSkillRobotBulletSuper:[function(t,e,r){"use strict";cc._RF.push(e,"72567UNYV9FgampUtUfedpQ","HeroSkillRobotBulletSuper");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.HeroSkillRobotBulletSuper=void 0;var l,s=t("../../../../../../../framework/container/Container"),c=t("../../role/RoleBuilder"),u=t("../BaseSkill"),p=t("./BaseHeroSkill");(function(t){t[t.None=0]="None",t[t.Start=1]="Start",t[t.Running=2]="Running"})(l||(l={}));var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state=[],e.time=[],e.count=[],e._angular=[],e}return n(e,t),e.prototype.OnGetAttr=function(){return["arg","bve"]},e.prototype.OnChangeParams=function(t){this.SwitchRunning(t)},e.prototype.OnGetScriptParam=function(){var t=this.GetTlScriptParam();return{radius:t[0]||100,angularSpeed:t[1]||0,radiusSparse:t[2]||0}},e.prototype.OnAddContext=function(t){this.SwitchNone(t),this.time[t]=0,this.count[t]=0},e.prototype.OnRemoveContext=function(t){this.state[t]=null,this.time[t]=null,this.count[t]=null},e.prototype.OnUpdate=function(t){var e,r,o=this.state;try{for(var n=a(this.tlContextId),i=n.next();!i.done;i=n.next()){var s=i.value;switch(o[s]){case l.Start:this.UpdateStart(s,t);break;case l.Running:this.UpdateRunning(s,t)}}}catch(c){e={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}},e.prototype.SwitchNone=function(t){this.state[t]=l.None},e.prototype.SwitchStart=function(t){this.state[t]=l.Start,this.time[t]=0,this.SetMainSkillCD(t,0,this.time[t],this.GetCD(t)),this.triggerSkill(t)},e.prototype.UpdateStart=function(t,e){this.time[t]+=e,this.SetMainSkillCD(t,0,this.time[t],this.GetCD(t)),this.time[t]>=this.GetCD(t)&&(this.time[t]=0,this.SwitchRunning(t))},e.prototype.SwitchRunning=function(t){this.SetMainSkillCD(t,0,1,1),this.state[t]=l.Running,this.time[t]=this.GetInterval(t),this.count[t]=0,this._angular[t]=0},e.prototype.UpdateRunning=function(t,e){var r=this._scriptParam;this.time[t]+=e,this._angular[t]+=e*r.angularSpeed,this.time[t]>=this.GetInterval(t)&&(this.OnTrigger(t,!0,this.GetBullet(t,0)),this.OnTrigger(t,!1,this.GetBullet(t,1)),this.time[t]=0,this.count[t]+=1),this.count[t]>=this.GetNum(t)&&this.SwitchStart(t)},e.prototype.OnTrigger=function(t,e,r){this.GPAudio.throwing();var o=this.tlContext[t].eid,n=this.Battle.getRef(o),i=this._scriptParam,a=this.ComPos.x,l=this.ComPos.y,s=this._angular[t];e&&(s=360-s),s+=90;var u=this.CalAttr_arg(t,i.radius),p=s/180*Math.PI,f=Math.cos(p)*u+a[o],h=Math.sin(p)*u+l[o],y=2*Math.random()*Math.PI,d=Math.random()*i.radiusSparse,m=Math.random()-.5,v=30/180*Math.PI,_=60/180*Math.PI,S=p+(_*=Math.sign(m))+(v*=m),g=new c.RBContext;g.sender=n,g.x=f+Math.cos(y)*d,g.y=h+Math.sin(y)*d,g.rad=S;var b=new(this.GetBulletBuilder(r));b.Setup(g),b.SetProperty("resId",r),b.SetProperty("has_bve",this.GetHasBVE(t)),b.SetProperty("has_let",this.GetHasLET(t)),b.SetProperty("builder",b),b.SetProperty("skill_attr_modify",this.resId),this.SystemRole.ApplyBuilder(b),this.Battle.applyModify()},e.prototype.GetState=function(t){var e=t.cid;switch(this.state[e]){case l.None:case l.Start:return u.SkillState.Idle;case l.Running:return u.SkillState.Running}},e.__cname="HeroSkillRobotBulletSuper",i([s.injectField("SystemRole")],e.prototype,"SystemRole",void 0),i([s.injectField("SystemMove")],e.prototype,"SystemMove",void 0),i([s.injectField("ComVar")],e.prototype,"ComVar",void 0),i([s.injectField("ComPos")],e.prototype,"ComPos",void 0),i([s.injectField("Battle")],e.prototype,"Battle",void 0),i([s.injectField("GPAudio")],e.prototype,"GPAudio",void 0),i([s.injectField("ModelBattleSkill")],e.prototype,"ModelBattleSkill",void 0),e}(p.BaseHeroSkill);r.HeroSkillRobotBulletSuper=f,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../role/RoleBuilder":"RoleBuilder","../BaseSkill":"BaseSkill","./BaseHeroSkill":"BaseHeroSkill"}],HeroSkillRobotBullet:[function(t,e,r){"use strict";cc._RF.push(e,"22c96UTne5JFI2IFdiS5lth","HeroSkillRobotBullet");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.HeroSkillRobotBullet=void 0;var l,s=t("../../../../../../../framework/container/Container"),c=t("../../role/RoleBuilder"),u=t("../BaseSkill"),p=t("./BaseHeroSkill");(function(t){t[t.None=0]="None",t[t.Start=1]="Start",t[t.Running=2]="Running"})(l||(l={}));var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state=[],e.time=[],e.count=[],e._angular=[],e}return n(e,t),e.prototype.OnGetAttr=function(){return["arg","bve","aiv"]},e.prototype.OnChangeParams=function(t){this.SwitchRunning(t)},e.prototype.OnGetScriptParam=function(){var t=this.GetTlScriptParam();return{radius:t[0]||100,startDregee:t[1]||0,angularSpeed:t[2]||0,radiusSparse:t[3]||0}},e.prototype.OnAddContext=function(t){this.SwitchNone(t),this.time[t]=0,this.count[t]=0},e.prototype.OnRemoveContext=function(t){this.state[t]=null,this.time[t]=null,this.count[t]=null},e.prototype.OnUpdate=function(t){var e,r,o=this.state;try{for(var n=a(this.tlContextId),i=n.next();!i.done;i=n.next()){var s=i.value;switch(o[s]){case l.Start:this.UpdateStart(s,t);break;case l.Running:this.UpdateRunning(s,t)}}}catch(c){e={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}},e.prototype.SwitchNone=function(t){this.state[t]=l.None},e.prototype.SwitchStart=function(t){this.state[t]=l.Start,this.time[t]=0,this.SetMainSkillCD(t,0,this.time[t],this.GetCD(t)),this.triggerSkill(t)},e.prototype.UpdateStart=function(t,e){this.time[t]+=e,this.SetMainSkillCD(t,0,this.time[t],this.GetCD(t)),this.time[t]>=this.GetCD(t)&&(this.time[t]=0,this.SwitchRunning(t))},e.prototype.SwitchRunning=function(t){this.SetMainSkillCD(t,0,1,1);var e=this._scriptParam;this.state[t]=l.Running,this.time[t]=this.GetInterval(t),this.count[t]=0,this._angular[t]=e.startDregee},e.prototype.UpdateRunning=function(e,r){var o=this._scriptParam;this.time[e]+=r,this._angular[e]+=r*(o.angularSpeed*t.prototype.GetNum.call(this,e)/this.GetNum(e)),this.time[e]>=this.GetInterval(e)&&(this.OnTrigger(e),this.time[e]=0,this.count[e]++),this.count[e]>=this.GetNum(e)&&this.SwitchStart(e)},e.prototype.GetNum=function(e){var r=t.prototype.GetNum.call(this,e),o=this.ComVar.CalHeroAttr("s7115",0);return 0!=o&&(r+=o),r},e.prototype.OnTrigger=function(t){this.GPAudio.throwing();var e=this.tlContext[t].eid,r=this.Battle.getRef(e),o=this._scriptParam,n=this.ComPos.x,i=this.ComPos.y,a=this.ComVar.HEROID,l=this.CalAttr_arg(t,o.radius),s=this._angular[t]/180*Math.PI,u=Math.cos(s)*l+n[a],p=Math.sin(s)*l+i[a],f=2*Math.random()*Math.PI,h=Math.random()*o.radiusSparse,y=Math.random()-.5,d=30/180*Math.PI,m=60/180*Math.PI,v=s+(m*=Math.sign(y))+(d*=y),_=new c.RBContext;_.sender=r,_.x=u+Math.cos(f)*h,_.y=p+Math.sin(f)*h,_.rad=v;var S=new(this.GetBulletBuilder(this.GetBullet(t,0)));S.Setup(_),S.SetProperty("resId",this.GetBullet(t,0)),S.SetProperty("has_bve",this.GetHasBVE(t)),S.SetProperty("has_let",this.GetHasLET(t)),S.SetProperty("builder",S),S.SetProperty("skill_attr_modify",this.resId),this.SystemRole.ApplyBuilder(S),this.Battle.applyModify()},e.prototype.GetState=function(t){var e=t.cid;switch(this.state[e]){case l.None:case l.Start:return u.SkillState.Idle;case l.Running:return u.SkillState.Running}},e.__cname="HeroSkillRobotBullet",i([s.injectField("SystemRole")],e.prototype,"SystemRole",void 0),i([s.injectField("SystemMove")],e.prototype,"SystemMove",void 0),i([s.injectField("ComVar")],e.prototype,"ComVar",void 0),i([s.injectField("ComPos")],e.prototype,"ComPos",void 0),i([s.injectField("Battle")],e.prototype,"Battle",void 0),i([s.injectField("GPAudio")],e.prototype,"GPAudio",void 0),i([s.injectField("ModelBattleSkill")],e.prototype,"ModelBattleSkill",void 0),e}(p.BaseHeroSkill);r.HeroSkillRobotBullet=f,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../role/RoleBuilder":"RoleBuilder","../BaseSkill":"BaseSkill","./BaseHeroSkill":"BaseHeroSkill"}],HeroSkillShotgunSuper:[function(t,e,r){"use strict";cc._RF.push(e,"b5ac2wtjZ9AE57wRXFtb5sE","HeroSkillShotgunSuper");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.HeroSkillShotgunSuper=void 0;var l,s=t("../../../../../../../framework/container/Container"),c=t("../../role/RoleBuilder"),u=t("../BaseSkill"),p=t("./BaseHeroSkill");(function(t){t[t.None=0]="None",t[t.Start=1]="Start",t[t.Running=2]="Running"})(l||(l={}));var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state=[],e.time=[],e.count=[],e}return n(e,t),e.prototype.OnGetAttr=function(){return[]},e.prototype.OnChangeParams=function(t){this.SwitchRunning(t)},e.prototype.OnAddContext=function(t){this.SwitchNone(t),this.time[t]=0,this.count[t]=0},e.prototype.OnRemoveContext=function(t){this.state[t]=null,this.time[t]=null,this.count[t]=null},e.prototype.OnUpdate=function(t){var e,r,o=this.state;try{for(var n=a(this.tlContextId),i=n.next();!i.done;i=n.next()){var s=i.value;switch(o[s]){case l.Start:this.UpdateStart(s,t);break;case l.Running:this.UpdateRunning(s,t)}}}catch(c){e={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}},e.prototype.SwitchNone=function(t){this.state[t]=l.None},e.prototype.SwitchStart=function(t){this.state[t]=l.Start,this.time[t]=0,this.SetMainSkillCD(t,0,this.time[t],this.GetCD(t)),this.triggerSkill(t)},e.prototype.UpdateStart=function(t,e){this.time[t]+=e,this.SetMainSkillCD(t,0,this.time[t],this.GetCD(t)),this.time[t]>=this.GetCD(t)&&(this.time[t]=0,this.SwitchRunning(t))},e.prototype.SwitchRunning=function(t){this.SetMainSkillCD(t,0,1,1),this.state[t]=l.Running,this.time[t]=this.GetInterval(t),this.count[t]=0},e.prototype.UpdateRunning=function(t,e){this.time[t]+=e,this.time[t]>=this.GetInterval(t)&&(this.time[t]=0,this.count[t]++,this.OnTrigger(t)),this.count[t]>=this.GetNum(t)&&this.SwitchStart(t)},e.prototype.OnTrigger=function(t){this.GPAudio.throwing(),this.ComPos.x,this.ComPos.y;var e=this.ComPos.d,r=this.tlContext[t].eid,o=this.Battle.getRef(r),n=e[r],i=new c.RBContext;i.sender=o,i.rad=n;var a=new(this.GetBulletBuilder(this.GetBullet(t,0)));a.Setup(i),a.SetProperty("resId",this.GetBullet(t,0)),a.SetProperty("has_bve",this.GetHasBVE(t)),a.SetProperty("has_let",this.GetHasLET(t)),a.SetProperty("builder",a),a.SetProperty("skill_attr_modify",this.resId),this.SystemRole.ApplyBuilder(a),this.Battle.applyModify()},e.prototype.GetState=function(t){var e=t.cid;switch(this.state[e]){case l.None:case l.Start:return u.SkillState.Idle;case l.Running:return u.SkillState.Running}},e.__cname="HeroSkillShotgunSuper",i([s.injectField("SystemRole")],e.prototype,"SystemRole",void 0),i([s.injectField("SystemMove")],e.prototype,"SystemMove",void 0),i([s.injectField("ComVar")],e.prototype,"ComVar",void 0),i([s.injectField("ComPos")],e.prototype,"ComPos",void 0),i([s.injectField("Battle")],e.prototype,"Battle",void 0),i([s.injectField("GPAudio")],e.prototype,"GPAudio",void 0),e}(p.BaseHeroSkill);r.HeroSkillShotgunSuper=f,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../role/RoleBuilder":"RoleBuilder","../BaseSkill":"BaseSkill","./BaseHeroSkill":"BaseHeroSkill"}],HeroSkillShotgun:[function(t,e,r){"use strict";cc._RF.push(e,"41605an+t9LH7bnpVTCD65j","HeroSkillShotgun");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.HeroSkillShotgun=void 0;var l,s=t("../../../../../../../framework/container/Container"),c=t("../../role/RoleBuilder"),u=t("../BaseSkill"),p=t("./BaseHeroSkill");(function(t){t[t.None=0]="None",t[t.Start=1]="Start",t[t.Running=2]="Running"})(l||(l={}));var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state=[],e.time=[],e.count=[],e}return n(e,t),e.prototype.OnGetAttr=function(){return["aiv"]},e.prototype.OnChangeParams=function(t){this.SwitchRunning(t)},e.prototype.OnGetScriptParam=function(){return{shootDegree:this.GetTlScriptParam()[0]||0}},e.prototype.OnAddContext=function(t){this.SwitchNone(t),this.time[t]=0,this.count[t]=0},e.prototype.OnRemoveContext=function(t){this.state[t]=null,this.time[t]=null,this.count[t]=null},e.prototype.OnUpdate=function(t){var e,r,o=this.state;try{for(var n=a(this.tlContextId),i=n.next();!i.done;i=n.next()){var s=i.value;switch(o[s]){case l.Start:this.UpdateStart(s,t);break;case l.Running:this.UpdateRunning(s,t)}}}catch(c){e={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}},e.prototype.SwitchNone=function(t){this.state[t]=l.None},e.prototype.SwitchStart=function(t){this.state[t]=l.Start,this.time[t]=0,this.SetMainSkillCD(t,0,this.time[t],this.GetCD(t)),this.triggerSkill(t)},e.prototype.UpdateStart=function(t,e){this.time[t]+=e,this.SetMainSkillCD(t,0,this.time[t],this.GetCD(t)),this.time[t]>=this.GetCD(t)&&(this.time[t]=0,this.SwitchRunning(t))},e.prototype.SwitchRunning=function(t){this.SetMainSkillCD(t,0,1,1),this.state[t]=l.Running,this.time[t]=this.GetInterval(t),this.count[t]=0},e.prototype.UpdateRunning=function(t,e){this.time[t]+=e;for(var r=this.GetInterval(t);this.time[t]>=r;)if(this.OnTrigger(t),this.time[t]-=r,this.count[t]++,this.count[t]>=this.GetNum(t))return void this.SwitchStart(t)},e.prototype.OnTrigger=function(t){this.GPAudio.throwing();var e=this.tlContext[t].eid,r=this.Battle.getRef(e),o=this.ComPos.d,n=this.count[t],i=this.GetNum(t),a=this._scriptParam.shootDegree/180*Math.PI,l=a/i,s=n*l+.5*l;s-=a/2,s+=o[e];var u=new c.RBContext;u.sender=r,u.rad=s;var p=new(this.GetBulletBuilder(this.GetBullet(t,0)));p.Setup(u),p.SetProperty("resId",this.GetBullet(t,0)),p.SetProperty("has_bve",this.GetHasBVE(t)),p.SetProperty("has_let",this.GetHasLET(t)),p.SetProperty("builder",p),p.SetProperty("skill_attr_modify",this.resId),this.SystemRole.ApplyBuilder(p),this.Battle.applyModify()},e.prototype.GetState=function(t){var e=t.cid;switch(this.state[e]){case l.None:case l.Start:return u.SkillState.Idle;case l.Running:return u.SkillState.Running}},e.__cname="HeroSkillShotgun",i([s.injectField("SystemRole")],e.prototype,"SystemRole",void 0),i([s.injectField("SystemMove")],e.prototype,"SystemMove",void 0),i([s.injectField("ComVar")],e.prototype,"ComVar",void 0),i([s.injectField("ComPos")],e.prototype,"ComPos",void 0),i([s.injectField("Battle")],e.prototype,"Battle",void 0),i([s.injectField("GPAudio")],e.prototype,"GPAudio",void 0),i([s.injectField("ModelBattleSkill")],e.prototype,"ModelBattleSkill",void 0),e}(p.BaseHeroSkill);r.HeroSkillShotgun=f,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../role/RoleBuilder":"RoleBuilder","../BaseSkill":"BaseSkill","./BaseHeroSkill":"BaseHeroSkill"}],HeroSkillSwordField:[function(t,e,r){"use strict";cc._RF.push(e,"e00e7z3LRZNv44TKdC9QHLR","HeroSkillSwordField");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.HeroSkillSwordField=void 0;var l,s=t("../../../../../../../framework/container/Container"),c=t("../../role/RoleBuilder"),u=t("../BaseSkill"),p=t("./BaseHeroSkill");(function(t){t[t.None=0]="None",t[t.Start=1]="Start",t[t.Running=2]="Running"})(l||(l={}));var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state=[],e.time=[],e.count=[],e}return n(e,t),e.prototype.OnGetAttr=function(){return["arg","bve","aiv","bsp"]},e.prototype.OnChangeParams=function(t){this.SwitchRunning(t)},e.prototype.OnAddContext=function(t){this.SwitchNone(t),this.time[t]=0,this.count[t]=0},e.prototype.OnRemoveContext=function(t){this.state[t]=null,this.time[t]=null,this.count[t]=null},e.prototype.OnUpdate=function(t){var e,r,o=this.state;try{for(var n=a(this.tlContextId),i=n.next();!i.done;i=n.next()){var s=i.value;switch(o[s]){case l.Start:this.UpdateStart(s,t);break;case l.Running:this.UpdateRunning(s,t)}}}catch(c){e={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}},e.prototype.SwitchNone=function(t){this.state[t]=l.None},e.prototype.SwitchStart=function(t){this.state[t]=l.Start,this.time[t]=0,this.SetMainSkillCD(t,0,this.time[t],this.GetCD(t)),this.triggerSkill(t)},e.prototype.UpdateStart=function(t,e){this.time[t]+=e,this.SetMainSkillCD(t,0,this.time[t],this.GetCD(t)),this.time[t]>=this.GetCD(t)&&(this.time[t]=0,this.SwitchRunning(t))},e.prototype.SwitchRunning=function(t){this.SetMainSkillCD(t,0,1,1),this.state[t]=l.Running,this.time[t]=this.GetInterval(t),this.count[t]=0},e.prototype.UpdateRunning=function(t,e){if(this.time[t]+=e,this.time[t]>=this.GetInterval(t)){this.time[t]=0,this.count[t]++;var r=this.findNear(t);r&&this.OnTrigger(t,r)}this.count[t]>=this.GetNum(t)&&this.SwitchStart(t)},e.prototype.OnTrigger=function(t){this.GPAudio.sword();var e=this.tlContext[t].eid,r=this.Battle.getRef(e),o=this.ComPos.d[e],n=new c.RBContext;n.sender=r,n.rad=o;var i=new(this.GetBulletBuilder(this.GetBullet(t,0)));i.Setup(n),i.SetProperty("resId",this.GetBullet(t,0)),i.SetProperty("has_bve",this.GetHasBVE(t)),i.SetProperty("has_let",this.GetHasLET(t)),i.SetProperty("builder",i),i.SetProperty("skill_attr_modify",this.resId),this.SystemRole.ApplyBuilder(i),this.Battle.applyModify()},e.prototype.GetState=function(t){var e=t.cid;switch(this.state[e]){case l.None:case l.Start:return u.SkillState.Idle;case l.Running:return u.SkillState.Running}},e.__cname="HeroSkillSwordField",i([s.injectField("SystemRole")],e.prototype,"SystemRole",void 0),i([s.injectField("SystemMove")],e.prototype,"SystemMove",void 0),i([s.injectField("ComVar")],e.prototype,"ComVar",void 0),i([s.injectField("ComPos")],e.prototype,"ComPos",void 0),i([s.injectField("ComVelocity")],e.prototype,"ComVelocity",void 0),i([s.injectField("Battle")],e.prototype,"Battle",void 0),i([s.injectField("GPAudio")],e.prototype,"GPAudio",void 0),i([s.injectField("ModelBattleSkill")],e.prototype,"ModelBattleSkill",void 0),e}(p.BaseHeroSkill);r.HeroSkillSwordField=f,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../role/RoleBuilder":"RoleBuilder","../BaseSkill":"BaseSkill","./BaseHeroSkill":"BaseHeroSkill"}],HeroUIComPanel:[function(t,e,r){"use strict";cc._RF.push(e,"491280GZuBD6Yq0A7Dhlexw","HeroUIComPanel");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.HeroUIComPanel=r.HeroPanelUI=void 0;var a=t("../../../../../../../framework/container/Container"),l=t("../../../../../../../framework/coord/Coord"),s=t("../../../../../../../framework/fgui/FairyMgr"),c=t("./SubComPanel");r.HeroPanelUI="ui://\u6218\u6597/\u7ec4\u4ef6_\u6218\u6597_\u4e3b\u89d2\u8840\u6761";var u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._point=new cc.Vec2,e._point2=new cc.Vec2,e._point3=new cc.Vec2,e}return n(e,t),e.prototype.OnGetClazz=function(){return e},e.prototype.Init=function(e,r){t.prototype.Init.call(this,e,r)},e.prototype.Release=function(){},e.prototype.Enter=function(){var t=s.FairyMgr.instance.createCom2(r.HeroPanelUI);this.com.addChildAt(t,0),this.heroUI=t,this.barHp=this.heroUI.tm("\u7ec4\u4ef6_\u8840\u6761"),this.barHp2=this.heroUI.tm("\u7ec4\u4ef6_\u8840\u6761\u540e"),this.textHp=this.heroUI.tm("\u6587\u672c_\u8840\u91cf"),this.heroUI.visible=!1,this.heroUI.setPivot(.5,0,!0),this.EnterCD()},e.prototype.Exit=function(){this.ExitCd()},e.prototype.Update=function(){this.GetDirty()&&(this.ClearDirty(),this.updateHeroUI(),this.updateShowHp()),this.UpdateCd(),this.updatePos()},e.prototype.updateHeroUI=function(){var t=this.ComVar.HEROID,e=this.ComVar.ALIVE[t],r=this.heroUI;e||(r.visible=!1),r.visible=!0;var o=this.ComVar.HP[t],n=this.ComVar.HP_Max[t],i=this.barHp.asProgress;i.max=n,i.value=o;var a=this.barHp2.asProgress;a.max!=n&&(a.max=n),a.tweenValue(o,.3);var l=Math.floor(o).toString();this.textHp.text=l},e.prototype.updatePos=function(){var t=this.heroUI;if(0!=t.visible){var e=this.ComVar.HEROID,r=this.ComPos.x[e],o=this.ComPos.y[e],n=this._point,i=this._point2;n.x=r,n.y=o;var a=cc.view.getVisibleSize();n.y-=30,l.Coord.WorldToUI(n,i),i.x=Math.max(0,i.x),i.x=Math.min(a.width-t.width,i.x),i.y=Math.max(0,i.y),i.y=Math.min(a.height-t.height,i.y),t.parent.globalToLocal(i.x,i.y,i);var s=cc.winSize.height/cc.winSize.width>2?665:575,c=cc.winSize.height/2,u=i.y-c;u=u*c/s,t.x=i.x,t.y=u+c}},e.prototype.updateShowHp=function(){var t=this.proxy.GetShowHp()?1:0;t!=this.heroUI.getSelectedIndex("\u663e\u793a\u8840\u91cf")&&this.heroUI.setSelectedIndex("\u663e\u793a\u8840\u91cf",t)},e.prototype.EnterCD=function(){var t=this.heroUI;this.barCD=t.tm("\u7ec4\u4ef6_\u51b7\u5374\u6761"),this.barBullet1=t.tm("\u7ec4\u4ef6_\u5f39\u53231"),this.barBullet2=t.tm("\u7ec4\u4ef6_\u5f39\u53232")},e.prototype.ExitCd=function(){},e.prototype.UpdateCd=function(){var t=this.ComVar.MAIN_SKILL_CD,e=this.ComVar.MAIN_SKILL_CD_MAX,r=this.ComVar.MAIN_SKILL_CD_TYPE,o=this.cd_val!=t||this.cd_max!=e||this.cd_type!=r,n=this.ComVar.HEROID;if(o&&this.ComVar.ALIVE[n]){this.cd_val=t,this.cd_max=e;var i=this.cd_type!=r;switch(this.cd_type=r,this.cd_type){case-1:i&&(this.heroUI.setSelectedPage("\u663e\u793a\u51b7\u5374","\u5426"),this.heroUI.setSelectedPage("\u663e\u793a\u5f39\u5323","\u5426"));break;case 2:i&&(this.heroUI.setSelectedPage("\u663e\u793a\u51b7\u5374","\u5426"),this.heroUI.setSelectedPage("\u663e\u793a\u5f39\u5323","\u4e24\u884c")),this.UpdateBulletBar(this.barBullet1,this.cd_val,this.cd_max),this.UpdateBulletBar(this.barBullet2,this.cd_val,this.cd_max);break;case 1:i&&(this.heroUI.setSelectedPage("\u663e\u793a\u51b7\u5374","\u5426"),this.heroUI.setSelectedPage("\u663e\u793a\u5f39\u5323","\u4e00\u884c")),this.UpdateBulletBar(this.barBullet1,this.cd_val,this.cd_max);break;case 0:default:i&&(this.heroUI.setSelectedPage("\u663e\u793a\u51b7\u5374","\u662f"),this.heroUI.setSelectedPage("\u663e\u793a\u5f39\u5323","\u5426")),this.UpdateCDBar(this.barCD,this.cd_val,this.cd_max)}}},e.prototype.UpdateCDBar=function(t,e,r){var o=t.asProgress,n=o.value;o.value=e,o.max=r,n<=.6*r&&e>.6*r&&r>.5&&this.ComState.SwitchConjure(this.ComVar.HEROID,!1)},e.prototype.UpdateBulletBar=function(t,e,r){var o=t.asProgress;if(o.max!=r){var n=t.tm("bar.list").asList;n.numItems=r,n.resizeToFit(),t.tm("bar").setSize(n.width,n.height),o.setSize(n.width,n.height)}o.max=r,o.value=e,e==r&&this.ComState.SwitchConjure(this.ComVar.HEROID,!1)},e.__cname="HeroUIComPanel",i([a.injectField("ComVar")],e.prototype,"ComVar",void 0),i([a.injectField("ComPos")],e.prototype,"ComPos",void 0),i([a.injectField("SystemRole")],e.prototype,"SystemRole",void 0),i([a.injectField("ComState")],e.prototype,"ComState",void 0),e}(c.SubComPanel);r.HeroUIComPanel=u,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../../../../../../framework/coord/Coord":void 0,"../../../../../../../framework/fgui/FairyMgr":void 0,"./SubComPanel":"SubComPanel"}],IPublicData:[function(t,e,r){"use strict";cc._RF.push(e,"370bfCzOzlHEJotk2qJY9JG","IPublicData"),Object.defineProperty(r,"__esModule",{value:!0}),cc._RF.pop()},{}],ItemBehavior:[function(t,e,r){"use strict";cc._RF.push(e,"76e69xZeiNDcaRwfWbltNYv","ItemBehavior");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.ItemBehavior=void 0;var i=t("../../../../../libutil/BigNum"),a=t("../../alert/PanelPopInfo"),l=t("./GObjGoodsBehavior"),s=new Map;s.set(1,"\u767d"),s.set(2,"\u7eff"),s.set(3,"\u84dd"),s.set(4,"\u7d2b"),s.set(5,"\u91d1"),s.set(6,"\u7ea2");var c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetUrl=function(){return"ui://\u5171\u7528\u7ec4\u4ef6/\u7269\u54c1\u6846_\u9053\u5177"},e.prototype.onReset=function(){},e.prototype.onGetIconLoader=function(){return this.com.tm("icon")},e.prototype.onGetIconEffectLoader=function(){return this.com.tm("iconEffect")},e.prototype.onGetUnderEffectLoader=function(){return this.com.tm("underEffect")},e.prototype.onIconVisible=function(t){this.onGetIconLoader().visible=t},e.prototype.onIconEffectVisible=function(t){this.onGetIconEffectLoader().visible=t},e.prototype.onUnderEffectVisible=function(t){this.onGetUnderEffectLoader().visible=t},e.prototype.onTitleUpdate=function(t){this.com.tm("text_name").text=t},e.prototype.onTitleVisible=function(t){this.com.tm("text_name").visible=t},e.prototype.onNumberUpdate=function(t){this.com.tm("text_number").text=t?i.BigNum.shortNum(t):t},e.prototype.onNumberVisible=function(t){this.com.tm("text_number").visible=t},e.prototype.onFrameUpdate=function(t){this.com.setSelectedPage("\u54c1\u8d28",s.get(t))},e.prototype.onFrameVisible=function(t){this.com.tm("icon_frame").visible=t},e.prototype.OnGetRDComponent=function(){return this.com.tm("\u7ea2\u70b9")},e.prototype.onUpdateByGoods=function(t){this.onGetIconLoader().SetUrlByIcon(t.GetIconUrl());var e=t.GetIconEffect();null!=e&&this.onGetIconEffectLoader().SetUrlByIcon(e);var r=t.GetUnderEffect();null!=r&&this.onGetUnderEffectLoader().SetUrlByIcon(r),this.onTitleUpdate(t.GetName()),this.onNumberUpdate(t.GetNumberStr()),this.onFrameUpdate(t.GetQuality());var o=t.GetIconEffect();null!=o&&this.onGetIconEffectLoader().SetUrlByIcon(o);var n=t.GetUnderEffect();null!=n&&this.onGetUnderEffectLoader().SetUrlByIcon(n),this.onIconEffectVisible(null!=o),this.onUnderEffectVisible(null!=n)},e.prototype.onSelectedUpdate=function(t){this.com.tm("icon_selected").visible=t},e.prototype.onGrayUpdate=function(t){this.com.grayed=t},e.prototype.Clean=function(){this.onGetIconLoader().Clean(),this.onGetIconEffectLoader().Clean(),this.onGetUnderEffectLoader().Clean(),this.onFrameUpdate(1),this.onNumberUpdate(""),this.onTitleUpdate("")},e.prototype.showTips=function(t,e){var r=t.GetRef(),o=e.addPanel(a.PanelPopInfo);o.SetParent(this.com),o.SetTitle(r.name),o.SetContent(r.desc),o.SetTitleVisible(!0),o.SetShowArrow(!0)},e.__cname="ItemBehavior",e}(l.GObjGoodsBehavior);r.ItemBehavior=c,cc._RF.pop()},{"../../../../../libutil/BigNum":void 0,"../../alert/PanelPopInfo":"PanelPopInfo","./GObjGoodsBehavior":"GObjGoodsBehavior"}],JoystickModule:[function(t,e,r){"use strict";cc._RF.push(e,"1b4b4AluFxGh4rPhEBfD2xW","JoystickModule");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0});var i=function(t){function e(e,r){var o=t.call(this)||this;return o._enableEvent=!0,o._button=e.getChild("joystick").asButton,o._button.changeStateOnClick=!1,o._thumb=o._button.getChild("thumb"),o._touchArea=e.getChild("joystick_touch"),o._center=e.getChild("joystick_center"),o._eventProxy=r,o._InitX=o._center.x+o._center.width/2,o._InitY=o._center.y+o._center.height/2,o._touchId=-1,o.radius=125,o._curPos=new cc.Vec2,o._touchArea.on(fgui.Event.TOUCH_BEGIN,o.onTouchDown,o),o._touchArea.on(fgui.Event.TOUCH_MOVE,o.onTouchMove,o),o._touchArea.on(fgui.Event.TOUCH_END,o.onTouchEnd,o),o}return n(e,t),e.prototype.trigger=function(t){this.onTouchDown(t)},e.prototype.onTouchDown=function(t){if(-1==this._touchId){this._touchId=t.touchId,null!=this._tweener&&(this._tweener.kill(),this._tweener=null),fgui.GRoot.inst,fgui.GRoot.inst.globalToLocal(t.pos.x,t.pos.y,this._curPos);var e=this._curPos.x,r=this._curPos.y;this._button.selected=!0;var o=this._touchArea.x,n=this._touchArea.y,i=this._touchArea.width;this._touchArea.height,e<o?e=o:e>o+i&&(e=o+i),r>fgui.GRoot.inst.height?r=fgui.GRoot.inst.height:r<n&&(r=n),this._lastStageX=e,this._lastStageY=r,this._startStageX=e,this._startStageY=r,this._center.visible=!0,this._center.x=e-this._center.width/2,this._center.y=r-this._center.height/2,this._button.x=e-this._button.width/2,this._button.y=r-this._button.height/2;var a=e-this._InitX,l=r-this._InitY,s=180*Math.atan2(l,a)/Math.PI;this._thumb.rotation=s+90,t.captureTouch()}},e.prototype.onTouchMove=function(t){if(-1!=this._touchId&&t.touchId==this._touchId){var r=t.pos.x,o=t.pos.y,n=r-this._lastStageX,i=o-this._lastStageY;this._lastStageX=r,this._lastStageY=o;var a=this._button.x+n,l=this._button.y+i,s=a+this._button.width/2-this._startStageX,c=l+this._button.height/2-this._startStageY,u=Math.atan2(c,s),p=180*u/Math.PI;this._thumb.rotation=p+90;var f=this.radius*Math.cos(u),h=this.radius*Math.sin(u);Math.abs(s)>Math.abs(f)&&(s=f),Math.abs(c)>Math.abs(h)&&(c=h),(a=this._startStageX+s)<0&&(a=0),(l=this._startStageY+c)>fgui.GRoot.inst.height&&(l=fgui.GRoot.inst.height),this._button.x=a-this._button.width/2,this._button.y=l-this._button.height/2,this._enableEvent&&this._eventProxy.execute(e.JoystickMoving,p)}},e.prototype.onTouchEnd=function(t){-1!=this._touchId&&t.touchId==this._touchId&&(this._touchId=-1,this._thumb.rotation=this._thumb.rotation+180,this._center.visible=!1,this._tweener=fgui.GTween.to2(this._button.x,this._button.y,this._InitX-this._button.width/2,this._InitY-this._button.height/2,.3).setTarget(this._button,this._button.setPosition).setEase(fgui.EaseType.CircOut).onComplete(this.onTweenComplete,this),this._enableEvent&&this._eventProxy.execute(e.JoystickUp))},e.prototype.onTweenComplete=function(){this._tweener=null,this._button.selected=!1,this._thumb.rotation=0,this._center.visible=!0,this._center.x=this._InitX-this._center.width/2,this._center.y=this._InitY-this._center.height/2},e.prototype.setEnableEvent=function(t){this._enableEvent=t},e.JoystickMoving="JoystickMoving",e.JoystickUp="JoystickUp",e}(cc.EventTarget);r.default=i,cc._RF.pop()},{}],LayerAccount:[function(t,e,r){"use strict";cc._RF.push(e,"66984ZT1cFFTYM/aFKWoT16","LayerAccount");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerAccountUI=r.LayerAccount=void 0;var a=t("../../../../framework/container/Container"),l=t("../../../../framework/FW"),s=t("../../ui/GameLayer"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return u},e.prototype.getUrl=function(){return"ui://\u767b\u5f55\u8d26\u53f7/\u7ec4\u4ef6_\u767b\u5f55_\u8d26\u53f7\u4fe1\u606f"},e.prototype.setData=function(t,e){this._account=t,this._password=e},e.prototype.getAccount=function(){return this._account||""},e.prototype.getPassword=function(){return this._password||""},e.prototype.setRegister=function(t){this._setRegister=t},e.prototype.getRegister=function(){return this._setRegister},e.prototype.setLogin=function(t){this._setLogin=t},e.prototype.getLogin=function(){return this._setLogin},e.prototype.SetRegisterResult=function(t){var e;this._registerResult=t,e=t.result?l.FW.G_W("\u7075\u754c\u901a\u884c\u8bc1\u5df2\u51c6\u5907\u5c31\u7eea~!"):t.content,this.ui.ShowTips(e)},e.__cname="LayerAccount",e}(s.GameLayerProxy);r.LayerAccount=c;var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetHasCloseAnimation=function(){return!0},e.prototype.GetHasShowAnimation=function(){return!0},e.prototype.setAccountData=function(t,e){this.com.tm("label_account").text=t,this.com.tm("label_password").text=e},e.prototype.init=function(){var t=this;this.com.toCenterParent(this.container);var e=this.com.tm("label_account"),r=this.com.tm("label_password");this.com.tm("btn_register").setClick(function(){t.proxy.getRegister()(e.text,r.text)},this),this.com.tm("btn_login").setClick(function(){t.proxy.getLogin()(e.text,r.text)},this),this.com.tm("floatNode.btn_close").setClick(function(){t.unload()},this),this.com.tm("floatNode.btn_close").visible=!1},e.prototype.ShowTips=function(t){t&&(this.LayerShowTip.SetData({context:String(t)}),this.LayerShowTip.load())},e.prototype.release=function(){},e.prototype.enter=function(){var t=this.proxy.getAccount(),e=this.proxy.getPassword();t&&e&&this.setAccountData(t,e)},e.__cname="LayerAccountUI",i([a.injectField("LayerShowTip")],e.prototype,"LayerShowTip",void 0),e}(s.GameLayerUI);r.LayerAccountUI=u,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/container/Container":void 0,"../../ui/GameLayer":"GameLayer"}],LayerAddFriend:[function(t,e,r){"use strict";cc._RF.push(e,"4d822B1a3ZCJpthAfUdvYlz","LayerAddFriend");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerAddFriendUI=r.LayerAddFriend=void 0;var a=t("../../../../../../framework/container/Container"),l=t("../../../../../../framework/FW"),s=t("../../../../../../framework/layer/common/UIOrder"),c=t("../../../../model/friend/ModelFriends"),u=t("../../../../ui/GameLayer"),p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return f},e.prototype.getUrl=function(){return"ui://\u9996\u9875_\u4fee\u70bc_\u597d\u53cb\u7cfb\u7edf/\u9996\u9875_\u4fee\u70bc_\u6dfb\u52a0\u597d\u53cb"},e.prototype.getSortOrder=function(){return s.LayerOrder.TowLevel},e.__cname="LayerAddFriend",e}(u.GameLayerProxy);r.LayerAddFriend=p;var f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getHasBackground=function(){return!0},e.prototype.init=function(){var t=this,e=t.com;this.com.toFullCenterParent(this.container),e.tm("panel_bg.\u6309\u94ae_\u5173\u95ed").setClick(function(){t.unload()},t),e.tm("\u6309\u94ae_\u5173\u95ed").onClick(function(){t.unload()},t),this.InitClick(),this.InitList(),this.InitListen(),this.UpdateLayer()},e.prototype.enter=function(){this.ModelMgr.ModelFriends.GetCanApplyArray().length<=0&&this.ModelMgr.ModelFriends.RequestFriendRefreshSuggest()},e.prototype.InitClick=function(){var t=this,e=t.com;e.tm("\u6309\u94ae_\u641c\u7d22").setClick(function(){var r=e.tm("\u8f93\u5165\u6587\u672c_\u641c\u7d22").text,o=Number(r);null==o||0==o||Number.isNaN(o)?l.FW.showTip("\u8bf7\u8f93\u5165\u6b63\u786e\u7684Id"):t.ModelMgr.ModelFriends.RequestSearchFriend(o)},t),e.tm("\u6309\u94ae_\u5237\u65b0").setClick(function(){t.ModelMgr.ModelFriends.RequestFriendRefreshSuggest(!0)},t)},e.prototype.InitList=function(){var t=this,e=this,r=e.com.tm("\u5217\u8868_\u597d\u53cb\u5185\u5bb9").asList;r.initVirtualList(e,function(o,n,i){var a=n.asCom;a.setSelectedPage("\u7c7b\u578b","\u7533\u8bf7\u5217\u8868"),a.tm("\u6309\u94ae_\u6dfb\u52a0\u597d\u53cb").setClick(function(){e.ModelMgr.ModelFriends.RequestFriendsApply(i.roleId).then(function(t){t&&(i.apply=!0,r.refreshVirtualList())})},e),t.ModelMgr.ModelFriends.GetFriend(i.roleId)?a.setSelectedPage("\u7533\u8bf7\u72b6\u6001","\u5df2\u6dfb\u52a0"):a.setSelectedPage("\u7533\u8bf7\u72b6\u6001",i.apply?"\u5df2\u7533\u8bf7":"\u672a\u7533\u8bf7");var l=a.tm("\u7ec4\u4ef6_\u4fe1\u606f");l.UpdateByFirendInfo(i,!1),l.ClickRoleDetail()})},e.prototype.InitListen=function(){var t=this;t.toolSet.addListener(t.ModelMgr.ModelFriends.GetEventProxy(),c.FriendsEventType.canApplyArrayUpdate,function(){t.UpdateLayer()},t)},e.prototype.UpdateLayer=function(){var t=this,e=t.com.tm("\u5217\u8868_\u597d\u53cb\u5185\u5bb9").asList,r=t.ModelMgr.ModelFriends.GetCanApplyArray();r&&r.length>0&&e.update(r);var o=t.ModelMgr.ModelVO.VOFirendBag.GetBagAsArray();t.com.tm("\u6587\u672c_\u597d\u53cb\u6570\u91cf").asTextField.setVar("min",o.length.toString()).setVar("max",t.ModelMgr.ModelFriends.GetMaxFriendNumber().toString()).flushVars()},e.__cname="LayerAddFriendUI",i([a.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(u.GameLayerUI);r.LayerAddFriendUI=f,cc._RF.pop()},{"../../../../../../framework/FW":void 0,"../../../../../../framework/container/Container":void 0,"../../../../../../framework/layer/common/UIOrder":void 0,"../../../../model/friend/ModelFriends":"ModelFriends","../../../../ui/GameLayer":"GameLayer"}],LayerAdventureBuff:[function(t,e,r){"use strict";cc._RF.push(e,"bb375RzsYRLBb0XrV5Z1Q9v","LayerAdventureBuff");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerAdventureBuffUI=r.LayerAdventureBuff=void 0;var a=t("../../../../../framework/container/Container"),l=t("../../../../../framework/layer/common/UIOrder"),s=t("../../../ui/GameLayer"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return u},e.prototype.getUrl=function(){return"ui://\u9996\u9875_\u5947\u9047/\u7ec4\u4ef6_\u9996\u9875_\u5947\u9047_buff\u5c55\u793a"},e.prototype.getSortOrder=function(){return l.LayerOrder.OneLevel},e.__cname="LayerAdventureBuff",e}(s.GameLayerProxy);r.LayerAdventureBuff=c;var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getHasBackground=function(){return!0},e.prototype.init=function(){var t=this;this.com.toFullCenterParent(this.container),this.isFinish=!1,this.com.tm("buff").asCom.getTransition("\u52a8\u6548_\u5c55\u793a").play(function(){t.isFinish||(t.isFinish=!0)}),this.com.setClick(function(){t.isFinish&&t.unload()},this)},e.prototype.release=function(){this.ModelMgr.ModelVO.VOFubenBag.DestroySubset(this.fubenSubSet),this.fubenSubSet=null},e.__cname="LayerAdventureBuffUI",i([a.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(s.GameLayerUI);r.LayerAdventureBuffUI=u,cc._RF.pop()},{"../../../../../framework/container/Container":void 0,"../../../../../framework/layer/common/UIOrder":void 0,"../../../ui/GameLayer":"GameLayer"}],LayerAgeTip:[function(t,e,r){"use strict";cc._RF.push(e,"39999xSMOhGWK8XeMYFXZFA","LayerAgeTip");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.LayerAgeTipUI=r.LayerAgeTip=void 0;var i=t("../../../../framework/layer/common/UIOrder"),a=t("../../ui/GameLayer"),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return s},e.prototype.getUrl=function(){return"ui://\u767b\u5f55/\u7ec4\u4ef6_\u767b\u5f55_\u9002\u9f84\u5f39\u7a97"},e.prototype.getSortOrder=function(){return i.LayerOrder.LoadingView},e.prototype.GetIsResidentLayer=function(){return!0},e.prototype.GetIsGameLayer=function(){return!0},e.__cname="LayerAgeTip",e}(a.GameLayerProxy);r.LayerAgeTip=l;var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getHasBackground=function(){return!0},e.prototype.init=function(){this.com.toFullCenterParent(this.container),this.initClick()},e.prototype.initClick=function(){var t=this;t.com.tm("\u6309\u94ae_\u5173\u95ed").setClick(function(){t.unload()},t)},e.__cname="LayerAgeTipUI",e}(a.GameLayerUI);r.LayerAgeTipUI=s,cc._RF.pop()},{"../../../../framework/layer/common/UIOrder":void 0,"../../ui/GameLayer":"GameLayer"}],LayerBatterCamerEffect:[function(t,e,r){"use strict";cc._RF.push(e,"d7ef18j3GJNzb5Agkeot9D2","LayerBatterCamerEffect");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerBatterCamerEffectUI=r.LayerBatterCamerEffect=void 0;var c=t("../../../../../../framework/container/Container"),u=t("../../../../../../framework/fgui/FairyMgr"),p=t("../../../../../../framework/fork/Fork"),f=t("../../../../../../framework/FW"),h=t("../../../../../../framework/layer/common/UIOrder"),y=t("../../../../ui/GameLayer"),d=t("../../logic/event/SystemEvent"),m=t("./BattleLayerOrder"),v=["\u7279\u6548_\u6218\u6597_\u5996\u738b\u73b0\u4e16","\u7279\u6548_\u6218\u6597_\u5f3a\u654c\u6765\u88ad"],_=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}var r;return n(e,t),r=e,e.prototype.getUIClass=function(){return S},e.prototype.getUrl=function(){return"ui://\u6218\u6597/\u7ec4\u4ef6_\u6218\u6597_\u955c\u5934\u7279\u6548"},e.prototype.getSortOrder=function(){return h.LayerOrder.Main},e.prototype.getSortOrder2=function(){return m.BattleLayerOrder.CameraEffect},e.prototype.preloadRes=function(){return a(this,void 0,Promise,function(){var t,e,r,o,n,i,a;return l(this,function(l){switch(l.label){case 0:t=[];try{for(e=s(v),r=e.next();!r.done;r=e.next())o=r.value,(n=u.FairyMgr.instance.addUIPackageProxyAsync(o)).then(function(t){t.addRef()}),t.push(n)}catch(c){i={error:c}}finally{try{r&&!r.done&&(a=e.return)&&a.call(e)}finally{if(i)throw i.error}}return[4,Promise.all(t)];case 1:return l.sent(),f.FW.ZJJ.log("\u6218\u6597\u955c\u5934\u7279\u6548\uff0c\u52a0\u8f7d\u5b8c\u6210"),[2]}})})},e.prototype.unloadRes=function(){return a(this,void 0,Promise,function(){var t,e,r,o,n,i;return l(this,function(){try{for(t=s(v),e=t.next();!e.done;e=t.next())r=e.value,(o=u.FairyMgr.instance.getUIPackageProxy(r))&&o.removeRef()}catch(a){n={error:a}}finally{try{e&&!e.done&&(i=t.return)&&i.call(t)}finally{if(n)throw n.error}}return[2]})})},e.__cname="LayerBatterCamerEffect",i([p.forkClass(r,null)],e)}(y.GameLayerProxy);r.LayerBatterCamerEffect=_;var S=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}var r;return n(e,t),r=e,e.prototype.getHasBackground=function(){return!1},e.prototype.init=function(){this.com.toFullCenterParent(this.container)},e.prototype.enter=function(){var t=this,e=this.com.tmt("\u7ea2\u8fb9"),r=0;this.toolSet.addCallback(this.ComVar.GetHeroBeHitCallback(),function(){var t=cc.director.getTotalTime();t>r&&(r=t+e.getTransitionTime(),e.play())}),this.toolSet.addListener(this.SystemEvent.GetEventPorxy(),d.EBattleEvent.Shake,function(){t.WhiteEffect()}),(o=this.com.tm("\u7279\u6548_\u6218\u6597_\u5996\u738b\u73b0\u4e16")).visible=!1,o.touchable=!1;var o,n=d.EBattleEvent.TipsBoss;this.toolSet.addListener(this.SystemEvent.GetEventPorxy(),n,function(){t.ShowBoss()}),(o=this.com.tm("\u7279\u6548_\u6218\u6597_\u5f3a\u654c\u6765\u88ad")).visible=!1,o.touchable=!1,n=d.EBattleEvent.TipsMonster,this.toolSet.addListener(this.SystemEvent.GetEventPorxy(),n,function(){t.ShowElite()}),this.AfterEnterSG()},e.prototype.AfterEnterSG=function(){},e.prototype.WhiteEffect=function(){this.com.tmt("\u767d\u8fb9").play()},e.prototype.ShowBoss=function(){var t=this.com.tm("\u7279\u6548_\u6218\u6597_\u5996\u738b\u73b0\u4e16");this.HandlerTipsEffect(t,"\u7279\u6548_\u6218\u6597_\u5996\u738b\u73b0\u4e16","t0"),this.GPAudio.battleBoss()},e.prototype.ShowElite=function(){var t=this.com.tm("\u7279\u6548_\u6218\u6597_\u5f3a\u654c\u6765\u88ad");this.HandlerTipsEffect(t,"\u7279\u6548_\u6218\u6597_\u5f3a\u654c\u6765\u88ad","t0"),this.GPAudio.tipWarn()},e.prototype.HandlerTipsEffect=function(t,e){t.visible=!1,t.touchable=!1;var r=t;this.ModelIcon.GetPath(e)&&(r.SetUrlByIcon(e),t.visible=!0,this.toolSet.addDelay(3e3,function(){t.visible=!1}))},e.__cname="LayerBatterCamerEffectUI",i([c.injectField("ComVar")],e.prototype,"ComVar",void 0),i([c.injectField("SystemEvent")],e.prototype,"SystemEvent",void 0),i([c.injectField("ModelIcon")],e.prototype,"ModelIcon",void 0),i([c.injectField("GPAudio")],e.prototype,"GPAudio",void 0),i([c.injectField("SystemSpawn")],e.prototype,"SystemSpawn",void 0),i([p.forkClass(r,null)],e)}(y.GameLayerUI);r.LayerBatterCamerEffectUI=S,cc._RF.pop()},{"../../../../../../framework/FW":void 0,"../../../../../../framework/container/Container":void 0,"../../../../../../framework/fgui/FairyMgr":void 0,"../../../../../../framework/fork/Fork":void 0,"../../../../../../framework/layer/common/UIOrder":void 0,"../../../../ui/GameLayer":"GameLayer","../../logic/event/SystemEvent":"SystemEvent","./BattleLayerOrder":"BattleLayerOrder"}],LayerBatterCommand:[function(t,e,r){"use strict";cc._RF.push(e,"e5c11ch/0xMybdVKscb/UjA","LayerBatterCommand");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerBatterCommandUI=r.LayerBatterCommand=void 0;var a=t("../../../../../framework/container/Container"),l=t("../../../../../framework/layer/common/UIOrder"),s=t("../../../ui/GameLayer"),c=t("./SubDebugCommand"),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._select=0,e}return n(e,t),e.prototype.getUIClass=function(){return p},e.prototype.getUrl=function(){return"ui://\u6218\u6597\u542f\u52a8\u53c2\u6570/\u7ec4\u4ef6_\u6218\u6597_\u6218\u6597\u5185\u6307\u4ee4"},e.prototype.getSortOrder=function(){return l.LayerOrder.OneLevel},e.prototype.SetSelect=function(t){this._select=t},e.prototype.GetSelect=function(){return this._select},e.__cname="LayerBatterCommand",e}(s.GameLayerProxy);r.LayerBatterCommand=u;var p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.cmd="",e}return n(e,t),Object.defineProperty(e.prototype,"SubSystemCommand",{get:function(){return this.SystemDebug.GetSubSystem(c.SubDebugCommand)},enumerable:!1,configurable:!0}),e.prototype.getHasBackground=function(){return!0},e.prototype.init=function(){var t=this;this.com.toCenterParent(this.container),this.com.tm("panel_bg.btn_close").setClick(function(){t.unload()},this);var e=this.com.tm("\u6587\u672c_\u6307\u4ee4").asTextInput;e.off(fgui.Event.EDITING_END),e.on(fgui.Event.EDITING_END,function(){t.cmd=e.text,t.com.requestFocus()},this),e.requestFocus(),this.com.tm("\u6309\u94ae_\u786e\u5b9a").setClick(function(){t.TryRun()},this),this._onkeydown=function(e){e.keyCode==cc.macro.KEY.enter&&t.TryRun()},cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this._onkeydown,this),this.InitData(),this.InitList()},e.prototype.release=function(){cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN,this._onkeydown,this)},e.prototype.enter=function(){},e.prototype.exit=function(){},e.prototype.update=function(){},e.prototype.InitData=function(){this.tlCmd=this.SubSystemCommand.GetTlCmd()},e.prototype.InitList=function(){var t=this,e=this.com.tm("list").asList;e.init(this,function(e,r){var o=t.tlCmd[e],n=r;n.text=o.desc,n.setClick(function(){t.proxy.SetSelect(e),t.OnRefreshView()},t)}),e.update(this.tlCmd),this.OnRefreshView()},e.prototype.OnRefreshView=function(){var t=this.com.tm("\u6587\u672c_\u6307\u4ee4"),e=this.proxy.GetSelect(),r=this.tlCmd[e];this.cmd=r.cmd,t.text=this.cmd},e.prototype.TryRun=function(){this.unload(),this.SubSystemCommand.RumCommand(this.cmd)},e.__cname="LayerBatterCommandUI",i([a.injectField("SystemDebug")],e.prototype,"SystemDebug",void 0),e}(s.GameLayerUI);r.LayerBatterCommandUI=p,cc._RF.pop()},{"../../../../../framework/container/Container":void 0,"../../../../../framework/layer/common/UIOrder":void 0,"../../../ui/GameLayer":"GameLayer","./SubDebugCommand":"SubDebugCommand"}],LayerBattleChest:[function(t,e,r){"use strict";cc._RF.push(e,"9379ccs2R1COaM2rYZIurfG","LayerBattleChest");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerBattleChestUI=r.LayerBattleChest=void 0;var l,s=t("../../../../../../framework/container/Container"),c=t("../../../../../../framework/FW"),u=t("../../../../../../framework/layer/common/UIOrder"),p=t("../../../../../../framework/tween/TweenEase"),f=t("../../../../model/goods/ModelGoods"),h=t("../../../../ui/GameLayer"),y=t("../../../alert/CtrlAlert"),d=t("../../../utils/PorcessTimeline"),m=t("../../logic/gameplay/sub/GPChest"),v=t("./BattleLayerOrder");(function(t){t[t.idle=0]="idle",t[t.Run=1]="Run",t[t.RunFinish=2]="RunFinish",t[t.Reward=3]="Reward",t[t.RewardFinish=4]="RewardFinish"})(l||(l={}));var _=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return S},e.prototype.getUrl=function(){return"ui://\u6218\u6597/\u7ec4\u4ef6_\u6218\u6597_\u571f\u5730\u5e99"},e.prototype.getSortOrder=function(){return u.LayerOrder.Main},e.prototype.getSortOrder2=function(){return v.BattleLayerOrder.TwoLevel+50},e.prototype.SetData=function(t){this._data=t,c.FW.Log.log("LayerBattleChest set data",t)},e.prototype.GetData=function(){return this._data},e.__cname="LayerBattleChest",e}(h.GameLayerProxy);r.LayerBattleChest=_;var S=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getHasBackground=function(){return!0},e.prototype.init=function(){switch(this.com.toFullCenterParent(this.container),this.com.setClick(this.nextState,this),this.proxy.GetData().type){case m.GPChestDrawType.GOLD:this.com.setSelectedPage("\u7c7b\u578b","\u8d22\u795e\u5e99"),this.tran=this.com.tmt("\u8d22\u795e\u5e99\u62bd\u5956");break;case m.GPChestDrawType.SKILL:this.com.setSelectedPage("\u7c7b\u578b","\u571f\u5730\u5e99"),this.tran=this.com.tmt("\u571f\u5730\u5e99\u62bd\u5956")}this.initGold(),this.initList(),this.initReward(),this.initTimeline(),this.InitParticle(),this.GPAudio.muteBGM(this),this.GPAudio.openDrawing(),this.switchIdle()},e.prototype.release=function(){this.releaseTimeline(),this.GPAudio.resumeBGM(this),this.GPAudio.stopDrawing()},e.prototype.enter=function(){},e.prototype.exit=function(){},e.prototype.update=function(t){switch(this.state){case l.Run:this.updateRun(t);break;case l.Reward:this.updateReward(t)}},e.prototype.switchIdle=function(){this.state=l.idle},e.prototype.switchRun=function(){this.state==l.idle&&(this.state=l.Run,this.timeline.start(),this.timeline3&&this.timeline3.start(),this.GPAudio.drawing())},e.prototype.updateRun=function(t){this.timeline.update(t),this.timeline3&&this.timeline3.update(t)},e.prototype.switchRunFinish=function(){this.state==l.Run&&(this.state=l.RunFinish,this.showGold(),this.switchReward(),this.applyReward())},e.prototype.switchReward=function(){this.state==l.RunFinish&&(this.state=l.Reward,this.timeline2.start())},e.prototype.updateReward=function(t){this.timeline2.update(t)},e.prototype.switchRewardFinish=function(){this.state==l.Reward&&(this.state=l.RewardFinish,this.timeline2.stop(),this.showReward())},e.prototype.nextState=function(){this.state!=l.idle?this.state!=l.Run?this.state!=l.RunFinish&&(this.state!=l.Reward?this.state==l.RewardFinish&&this.unload():this.switchRewardFinish()):this.switchRunFinish():this.switchRun()},e.prototype.initTimeline=function(){this.initDrawTimeline(),this.initRewardTimeline(),this.initGoldTimeline()},e.prototype.releaseTimeline=function(){this.releaseDrawTimeline(),this.releaseRewardTimeline(),this.releaseGoldTimeline()},e.prototype.initDrawTimeline=function(){var t=this,e=new d.PorcessTimeline;this.timeline=e,this.proxy.GetData().list;for(var r=this.proxy.GetData().reward,o=this.proxy.GetData().type,n=m.GPChest.GRID_COUNT,i=r[0],l=r.map(function(t){var e=t-i;return e<0?n+e:e}),s=cc.game.getFrameRate(),u=cc.director.getDeltaTime(),f=[],h=0;h<n;h++){var y="item"+h;f.push(this.com.tm(y))}var v,_=null,S=0,g=function(e){var r,o;try{for(var i=a(l),s=i.next();!s.done;s=i.next()){var u=(e+s.value)%n;try{f[u].tmt("\u95ea\u70c1").play()}catch(p){c.FW.ZJJ.error(p)}}}catch(h){r={error:h}}finally{try{s&&!s.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}t.GPAudio.drawone()},b=function(t){S+=t*+u;var e=Math.floor(S)%n;_!=e&&g(_=e)},C=function(t,e){var r=_+(n+i-_%n),o=p.TweenEase.Linear(t,_,r-_,e),a=Math.floor(o)%n;v!=a&&g(v=a)},R=function(){var e,r;t.GPAudio.chest();try{for(var o=a(l),s=o.next();!s.done;s=o.next()){var c=s.value;f[(i+c)%n].setSelectedPage("\u9009\u4e2d","\u662f")}}catch(u){e={error:u}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}},M=function(){t.com.setSelectedPage("\u5f00\u59cb\u62bd\u5956","\u662f"),t.tran.play();var e=t.com.tm("\u91d1\u5e01\u7279\u6548");o==m.GPChestDrawType.GOLD?(e.visible=!0,e.tmt("\u8d22\u795e\u5e99\u62bd\u5956").play()):e.visible=!1};e.addEvent(0,"start",function(){M()}),e.addKeyframe(0,4*s,function(t,e){var r=p.TweenEase.Quart.easeIn(t,6,8,e);b(r)}),e.addKeyframe(4*s,1*s,function(t,e){var r=p.TweenEase.Quart.easeIn(t,8,6,e);b(r)}),e.addKeyframe(5*s,1*s,function(t,e){C(t,e)}),e.addKeyframe(6*s,1*s,function(){}),e.addEvent(6*s,"ani_end",function(){R()}),e.addEvent(7*s,"end",function(){t.switchRunFinish()})},e.prototype.releaseDrawTimeline=function(){this.timeline.destroy()},e.prototype.initRewardTimeline=function(){var t=this;this.timeline2=new d.PorcessTimeline;var e=this.timeline2,r=cc.game.getFrameRate(),o=(cc.director.getDeltaTime(),this.proxy.GetData().reward.length),n=this.com.tm("\u7ec4\u4ef6_\u5956\u52b1.list").asList,i=null,a=function(e){e=Math.min(e,o-1),i!=e&&(i=e,n.getChildAt(i).tmt("\u8fdb\u5165\u52a8\u753b").play(),t.GPAudio.prop())};e.addEvent(0,"start",function(){t.com.setSelectedPage("\u5c55\u793a\u5956\u52b1","\u662f")}),e.addKeyframe(0,1*r,function(t,e){var r=Math.floor(p.TweenEase.Linear(t,0,o,e));a(r)}),e.addEvent(1*r,"end",function(){t.switchRewardFinish()})},e.prototype.releaseRewardTimeline=function(){this.timeline2.destroy()},e.prototype.initGoldTimeline=function(){var t=this.proxy.GetData().gold;if(null!=t){this.timeline3=new d.PorcessTimeline;var e=this.timeline3,r=cc.game.getFrameRate(),o=(cc.director.getDeltaTime(),this.com.tm("\u6807\u7b7e_\u91d1\u5e01.title").asTextField),n=t,i=function(t){o.text=""+t};e.addEvent(0,"start",function(){i(0)}),e.addKeyframe(0,11*r,function(t,e){var r=Math.floor(p.TweenEase.Linear(t,0,n-0,e));i(r)}),e.addEvent(11*r,"end",function(){i(n)})}},e.prototype.releaseGoldTimeline=function(){this.timeline3&&this.timeline3.destroy()},e.prototype.initGold=function(){var t=this.com.tm("\u6807\u7b7e_\u91d1\u5e01"),e=this.proxy.GetData().gold;t.visible=null!=e;var r=this.ModelGoods.GetRefByCurrency(f.ECurrencyType.coin);t.tm("icon").SetUrlByIcon(r.icon),t.tm("title").text="0"},e.prototype.showGold=function(){var t=this.com.tm("\u6807\u7b7e_\u91d1\u5e01"),e=this.proxy.GetData().gold;null!=e&&(t.tm("title").text=""+e)},e.prototype.initList=function(){for(var t=this.proxy.GetData().list,e=0;e<t.length;e++){var r="item"+e,o=this.com.tm(r);this.SetComItem(o,t[e])}},e.prototype.SetComItem=function(t,e){t.tm("icon").SetUrlByIcon(e.GetIcon())},e.prototype.InitParticle=function(){this.com.tm("\u88c5\u8f7d\u5668_\u91d1\u8272\u7c92\u5b50").SetUrlByModel(y.particlesMap.get("\u91d1\u8272\u7c92\u5b50"))},e.prototype.initReward=function(){var t=this.proxy.GetData().list,e=this.proxy.GetData().reward,r=this.com.tm("\u7ec4\u4ef6_\u5956\u52b1.list");r.init(this,function(r,o){var n=o.tm("com_item"),i=e[r],a=t[i];if(n.tm("icon").SetUrlByIcon(a.GetIcon()),n.tm("\u6587\u672c_\u6807\u9898").text=c.FW.G_W(a.GetName()),n.tm("\u6587\u672c_\u63cf\u8ff0").text=c.FW.G_W(a.GetDesc()),a.IsShowLevel()){var l=a,s=n.tm("\u7ec4\u4ef6_\u6280\u80fd\u7b49\u7ea7").asProgress;s.visible=!0,s.max=l.GetMaxLevel(),s.value=l.GetLevel(),s.tmc("\u89c9\u9192").setSelectedIndex(6==l.GetLevel()?1:0)}else n.tm("\u7ec4\u4ef6_\u6280\u80fd\u7b49\u7ea7").visible=!1}),r.update(e)},e.prototype.showReward=function(){for(var t=this.com.tm("\u7ec4\u4ef6_\u5956\u52b1.list"),e=0;e<t.numChildren;e++){var r=t.getChildAt(e);r.tmt("\u8fdb\u5165\u52a8\u753b").stop(),r.tmt("\u4e2d\u65ad\u8fd8\u539f").play()}},e.prototype.applyReward=function(){},e.__cname="LayerBattleChestUI",i([s.injectField("GPAudio")],e.prototype,"GPAudio",void 0),i([s.injectField("SystemEvent")],e.prototype,"SystemEvent",void 0),i([s.injectField("ModelGoods")],e.prototype,"ModelGoods",void 0),e}(h.GameLayerUI);r.LayerBattleChestUI=S,cc._RF.pop()},{"../../../../../../framework/FW":void 0,"../../../../../../framework/container/Container":void 0,"../../../../../../framework/layer/common/UIOrder":void 0,"../../../../../../framework/tween/TweenEase":void 0,"../../../../model/goods/ModelGoods":"ModelGoods","../../../../ui/GameLayer":"GameLayer","../../../alert/CtrlAlert":"CtrlAlert","../../../utils/PorcessTimeline":"PorcessTimeline","../../logic/gameplay/sub/GPChest":"GPChest","./BattleLayerOrder":"BattleLayerOrder"}],LayerBattleDamageText:[function(t,e,r){"use strict";cc._RF.push(e,"45c37g5BgpLFoUatpG0RuRE","LayerBattleDamageText");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerBattleDamageTextUI=r.LayerBattleDamageText=void 0;var l,s=t("../../../../../../framework/base/ScriptObject"),c=t("../../../../../../framework/container/Container"),u=t("../../../../../../framework/coord/Coord"),p=t("../../../../../../framework/fgui/FairyMgr"),f=t("../../../../../../framework/layer/common/UIOrder"),h=t("../../../../../../framework/pool/Pool"),y=t("../../../../../../libutil/BigNum"),d=t("../../../../ui/GameLayer"),m=t("./BattleLayerOrder");(function(t){t[t.Normal=0]="Normal",t[t.Crit=1]="Crit",t[t.Player=2]="Player",t[t.Cure=3]="Cure",t[t.Count=4]="Count"})(l||(l={}));var v=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnGetFromPool=function(){this.time=0,this.dmg.damageTag.Crit;var t=y.BigNum.shortNum(this.dmg.GetDamage());this.gobj.tm("title").text=t,this.gobj.visible=!0,this.gobj.tmt("\u52a8\u753b").play()},e.prototype.OnReturnToPool=function(){this.gobj.visible=!1},e.prototype.UpdateXY=function(t,e){this.gobj.x=t,this.gobj.y=e},e.prototype.GetDuration=function(){return this.gobj.tmt("\u52a8\u753b").getTransitionTime()},e.prototype.SetPool=function(t){this._pool=t},e.prototype.GetPool=function(){return this._pool},e.__cname="DamageObj",e}(s.ScriptObject),_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.eid=[],e.dmg=[],e}return n(e,t),e.prototype.getUIClass=function(){return S},e.prototype.getUrl=function(){return"ui://\u6218\u6597/\u7ec4\u4ef6_\u6218\u6597\u5c42_\u6587\u672c"},e.prototype.getSortOrder=function(){return f.LayerOrder.Scene},e.prototype.getSortOrder2=function(){return m.BattleLayerOrder.Scene},e.prototype.PushToTask=function(t,e){this.eid.push(t),this.dmg.push(e),this._dirty=!0},e.prototype.SetDirty=function(t){this._dirty=t},e.prototype.GetDirty=function(){return this._dirty},e.__cname="LayerBattleDamageText",e}(d.GameLayerProxy);r.LayerBattleDamageText=_;var S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tmPool=new Map,e.tlGObj=[],e.tlRunning=[],e._point=new cc.Vec2,e}return n(e,t),e.prototype.getHasBackground=function(){return!1},e.prototype.init=function(){this.com.toFullCenterParent(this.container);for(var t=l.Normal;t<l.Count;t++)switch(t){case l.Normal:this.CreatePool(l.Normal,"ui://\u6218\u6597/\u7ec4\u4ef6_\u6218\u6597_\u6587\u672c\u666e\u901a");break;case l.Crit:this.CreatePool(l.Crit,"ui://\u6218\u6597/\u7ec4\u4ef6_\u6218\u6597_\u6587\u672c\u66b4\u51fb");break;case l.Player:this.CreatePool(l.Player,"ui://\u6218\u6597/\u7ec4\u4ef6_\u6218\u6597_\u6587\u672c\u73a9\u5bb6");break;case l.Cure:this.CreatePool(l.Cure,"ui://\u6218\u6597/\u7ec4\u4ef6_\u6218\u6597_\u6587\u672c\u6062\u590d");break;case l.Count:}},e.prototype.release=function(){},e.prototype.enter=function(){},e.prototype.exit=function(){},e.prototype.update=function(t){this.updateInner(t/1e3)},e.prototype.updateInner=function(t){this.proxy.GetDirty()&&(this.proxy.SetDirty(!1),this.Run()),this.UpdateRunning(t)},e.prototype.CreatePool=function(t,e){var r=this,o=new h.Pool(function(){var t=new v;return t.gobj=r.CreteObj(e),t},function(t){t.destroy()},function(t,e,r){t.eid=e,t.dmg=r,t.OnGetFromPool(),t.SetPool(o)},function(t){return t.OnReturnToPool(),t.SetPool(null),!0});this.tmPool.set(t,o)},e.prototype.GetPoolBy=function(t,e){for(var r;;){if(e.damageTag.Cure){r=l.Cure;break}if(t==this.ComVar.HEROID){r=l.Player;break}if(e.damageTag.Crit){r=l.Crit;break}r=l.Normal;break}return this.tmPool.get(r)},e.prototype.CreteObj=function(t){var e=p.FairyMgr.instance.createCom(t);return this.tlGObj.push(e),this.com.addChild(e),e},e.prototype.PushToRunning=function(t,e,r,o){var n=this.GetPoolBy(t,e).getFromPool(t,e);n.UpdateXY(r,o);var i=n.GetDuration()/1e3;this.SetDuration(i),this.tlRunning.push(n),e.damageTag.Seckill?this.SystemViewEffect.AddEffectXY("\u767e\u604b_\u88c5\u5907\u6280\u80fd_\u79d2\u6740",this.ComPos.x[t],this.ComPos.y[t]):e.damageTag.TenDamage?this.SystemViewEffect.AddEffectXY("\u767e\u604b_\u6218\u6597\u573a\u666f\u7279\u6548_\u65a9\u9996\u4e00\u51fb",this.ComPos.x[t],this.ComPos.y[t]):e.damageTag.Thump&&this.SystemViewEffect.AddEffectXY("\u767e\u604b_\u88c5\u5907\u6280\u80fd_\u91cd\u51fb",this.ComPos.x[t],this.ComPos.y[t])},e.prototype.Run=function(){for(var t=this.ComPos.x,e=this.ComPos.y,r=this.proxy.eid,o=this.proxy.dmg,n=this._point,i=0;i<r.length;i++)n.x=t[r[i]],n.y=e[r[i]],u.Coord.WorldToUI(n,n),this.PushToRunning(r[i],o[i],n.x,n.y);r.length=0,o.length=0},e.prototype.UpdateRunning=function(t){var e,r,o=this.tlRunning;if(!(o.length<=0)){try{for(var n=a(this.tlRunning),i=n.next();!i.done;i=n.next())(s=i.value).time+=t}catch(c){e={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}for(var l=9999;!(l--<=0)&&o[0].time>=this.GetDuration();){var s;if((s=o.shift()).GetPool().returnToPool(s),0==o.length)break}}},e.prototype.SetDuration=function(t){this._duraction=t},e.prototype.GetDuration=function(){return this._duraction||.7},e.__cname="LayerBattleDamageTextUI",i([c.injectField("ComPos")],e.prototype,"ComPos",void 0),i([c.injectField("ComVar")],e.prototype,"ComVar",void 0),i([c.injectField("SystemViewEffect")],e.prototype,"SystemViewEffect",void 0),e}(d.GameLayerUI);r.LayerBattleDamageTextUI=S,cc._RF.pop()},{"../../../../../../framework/base/ScriptObject":void 0,"../../../../../../framework/container/Container":void 0,"../../../../../../framework/coord/Coord":void 0,"../../../../../../framework/fgui/FairyMgr":void 0,"../../../../../../framework/layer/common/UIOrder":void 0,"../../../../../../framework/pool/Pool":void 0,"../../../../../../libutil/BigNum":void 0,"../../../../ui/GameLayer":"GameLayer","./BattleLayerOrder":"BattleLayerOrder"}],LayerBattleDebug:[function(t,e,r){"use strict";cc._RF.push(e,"93c918ptndGBbvorA1v9vDc","LayerBattleDebug");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerBattleDebugUI=r.LayerBattleDebug=void 0;var s=t("../../../../framework/base/ScriptObject"),c=t("../../../../framework/container/Container"),u=t("../../../../framework/FW"),p=t("../../../../framework/layer/common/UIOrder"),f=t("../../ui/GameLayer"),h=t("./ConstBattle"),y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return d},e.prototype.getUrl=function(){return"ui://\u6218\u6597\u542f\u52a8\u53c2\u6570/\u7ec4\u4ef6_\u6218\u6597_\u542f\u52a8\u53c2\u6570"},e.prototype.getSortOrder=function(){return p.LayerOrder.Guide},e.prototype.SetConfig=function(t){this._config=t},e.prototype.GetConfig=function(){return this._config},e.__cname="LayerBattleDebug",e}(f.GameLayerProxy);r.LayerBattleDebug=y;var d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getHasBackground=function(){return!0},e.prototype.init=function(){this.com.toFullCenterParent(this.container),this.com.tm("btn_ok").setClick(this.submit,this),this.com.tm("panel.btn_close").visible=!1,this.com.tm("panel.btn_close").setClick(this.unload,this);var t=this.com.tm("list").asList;this.form=new b(t)},e.prototype.release=function(){this.form.destroy()},e.prototype.enter=function(){for(var t,e,r,o,n,i,l,s,c,u,p,f,y=this.proxy.GetConfig(),d=y.hero,m=(M=this.Ref.RefMgrhero.getRefAll()).map(function(t){return{title:t.name,value:t.id}}),b=0,C=0;C<m.length;C++)if(m[C].value==d){b=C;break}for((R=this.form.AddElement(S)).SetTitle("\u89d2\u8272"),R.SetParam("hero",m),R.SetOnParam(function(t){return t.value=parseInt(t.value),t}),R.select=b,d=y.multeSpeed,(R=this.form.AddElement(g)).SetTitle("\u500d\u901f"),R.SetParam("multeSpeed",String(d)),R.SetOnParam(function(t){return t.value=parseInt(t.value),t.value=Math.min(h.BATTLE_MAX_TIME_MULIT,t.value),t}),d=y.whosyourdaddy,(m=[]).push({title:"\u662f",value:!0}),m.push({title:"\u5426",value:!1}),b=d?0:1,(R=this.form.AddElement(v)).SetTitle("whosyourdaddy"),R.SetParam("whosyourdaddy",m),R.select=b,d=y.roleLevelMonster,(R=this.form.AddElement(g)).SetTitle("\u91d1\u5e01\u526f\u672c\u602a\u7269\u5f3a\u5ea6"),R.SetParam("roleLevelMonster",String(d)),R.SetOnParam(function(t){return t.value=parseInt(t.value),t}),d=y.roleLevelGold,(R=this.form.AddElement(g)).SetTitle("\u91d1\u5e01\u526f\u672c\u91d1\u5e01\u589e\u76ca"),R.SetParam("roleLevelGold",String(d)),R.SetOnParam(function(t){return t.value=parseInt(t.value),t}),d=y.waveId,m=(M=this.Ref.RefMgrbattleWaveRef.getRefAll()).map(function(t){return{title:t.name,value:t.id}}),b=0,C=0;C<m.length;C++)if(m[C].value==d){b=C;break}for((R=this.form.AddElement(S)).SetTitle("\u5237\u602a\u914d\u7f6e"),R.SetParam("waveId",m),R.SetOnParam(function(t){return t.value=parseInt(t.value),t}),R.select=b,d=y.fubenId,m=(M=this.Ref.RefMgrfuBenRef.getRefAll()).map(function(t){return{title:t.resId.toString(),value:t.resId}}),b=0,C=0;C<m.length;C++)if(m[C].value==d){b=C;break}for((R=this.form.AddElement(S)).SetTitle("\u526f\u672c\u914d\u7f6e"),R.SetParam("fubenId",m),R.SetOnParam(function(t){return t.value=parseInt(t.value),t}),R.select=b,d=y.starttime,(R=this.form.AddElement(g)).SetTitle("\u521d\u59cb\u65f6\u95f4\u79d2"),R.SetParam("starttime",String(d)),R.SetOnParam(function(t){return t.value=parseInt(t.value),t}),d=y.map,m=(M=this.Ref.RefMgrmapRef.getRefAll()).map(function(t){return{title:t.name,value:t.id}}),b=0,C=0;C<m.length;C++)if(m[C].value==d){b=C;break}for((R=this.form.AddElement(S)).SetTitle("\u5730\u56fe"),R.SetParam("map",m),R.SetOnParam(function(t){return t.value=parseInt(t.value),t}),R.select=b,d=y.mainSkill,m=(M=this.Ref.RefMgrbattleSkillRef.getRefAll()).map(function(t){return{title:t.name,value:t.resId}}),b=0,C=0;C<m.length;C++)if(m[C].value==d){b=C;break}(R=this.form.AddElement(S)).SetTitle("\u4e3b\u6280\u80fd(\u540e\u7eed\u6362\u6210\u88c5\u5907)"),R.SetParam("mainSkill",m),R.SetOnParam(function(t){return t.value=parseInt(t.value),t}),R.select=b,d=y.skillLimit,(R=this.form.AddElement(g)).SetTitle("\u6280\u80fd\u3001\u8865\u7ed9\u69fd\u6570\u91cf"),R.SetParam("skillLimit",String(d)),R.SetOnParam(function(t){return t.value=parseInt(t.value),t}),d=y.skillSelectNum,(R=this.form.AddElement(g)).SetTitle("\u9009\u62e9\u6280\u80fd\u5019\u9009\u6570\u91cf"),R.SetParam("skillSelectNum",String(d)),R.SetOnParam(function(t){return t.value=parseInt(t.value),t}),d=y.refreshSkill,(R=this.form.AddElement(g)).SetTitle("\u5237\u65b0\u6280\u80fd\u6b21\u6570"),R.SetParam("refreshSkill",String(d)),R.SetOnParam(function(t){return t.value=parseInt(t.value),t}),d=y.enterSelector,(m=[]).push({title:"\u662f",value:!0}),m.push({title:"\u5426",value:!1}),b=d?0:1,(R=this.form.AddElement(v)).SetTitle("\u8fdb\u5165\u6218\u6597\u7acb\u5373\u9009\u6280\u80fd"),R.SetParam("enterSelector",m),R.select=b,d=y.enterGold,(R=this.form.AddElement(g)).SetTitle("\u8fdb\u5165\u6218\u6597\u8d22\u795e\u5e99"),R.SetParam("enterGold",d),R.SetOnParam(function(t){return null==t.value||""==t.value?t.value=null:t.value=parseInt(t.value),t}),d=y.buffs||[],(R=this.form.AddElement(g)).SetTitle("\u6218\u573abuff"),R.SetParam("buffs",d.join()),R.SetOnParam(function(t){return t.value=t.value.split(",").map(function(t){return parseInt(t)}),t}),d=y.skills;var R,M=this.Ref.RefMgrbattleSkillRef.getRefAll(),w=(m=[],b=[],new Set);if(d&&d.length>0)try{for(var O=a(d),B=O.next();!B.done;B=O.next()){var P=B.value;w.add(P)}}catch(U){t={error:U}}finally{try{B&&!B.done&&(e=O.return)&&e.call(O)}finally{if(t)throw t.error}}else w.add(1e4),w.add(10014),w.add(10029),w.add(10018),w.add(10027),w.add(10016),w.add(10020),w.add(10033),w.add(10025);try{for(var G=a(M),k=G.next();!k.done;k=G.next()){var x=k.value,T=m.length;w.has(x.resId)&&(m.push({title:x.name,value:x.resId}),b.push(T))}}catch(W){r={error:W}}finally{try{k&&!k.done&&(o=G.return)&&o.call(G)}finally{if(r)throw r.error}}(R=this.form.AddElement(_)).SetTitle("\u6280\u80fd\u6c60"),R.SetParam("skills",m),R.select.clear();try{for(var j=a(b),I=j.next();!I.done;I=j.next())T=I.value,R.select.add(T)}catch(H){n={error:H}}finally{try{I&&!I.done&&(i=j.return)&&i.call(j)}finally{if(n)throw n.error}}if(d=y.supply,M=this.Ref.RefMgrbattleSupplyRef.getRefAll(),m=[],b=[],w=new Set,d&&d.length>0)try{for(var D=a(d),F=D.next();!F.done;F=D.next())P=F.value,w.add(P)}catch(N){l={error:N}}finally{try{F&&!F.done&&(s=D.return)&&s.call(D)}finally{if(l)throw l.error}}else w.add(1003);try{for(var L=a(M),E=L.next();!E.done;E=L.next())x=E.value,T=m.length,m.push({title:x.name,value:x.resId}),w.has(x.resId)&&b.push(T)}catch(q){c={error:q}}finally{try{E&&!E.done&&(u=L.return)&&u.call(L)}finally{if(c)throw c.error}}(R=this.form.AddElement(_)).SetTitle("\u8865\u7ed9\u6c60"),R.SetParam("supply",m),R.select.clear();try{for(var A=a(b),V=A.next();!V.done;V=A.next())T=V.value,R.select.add(T)}catch(K){p={error:K}}finally{try{V&&!V.done&&(f=A.return)&&f.call(A)}finally{if(p)throw p.error}}d=y.debug,(m=[]).push({title:"\u662f",value:!0}),m.push({title:"\u5426",value:!1}),b=d?0:1,(R=this.form.AddElement(v)).SetTitle("\u8c03\u8bd5\u6a21\u5f0f"),R.SetParam("debug",m),R.select=b,d=y.syncData,(m=[]).push({title:"\u662f",value:!0}),m.push({title:"\u5426",value:!1}),b=d?0:1,(R=this.form.AddElement(v)).SetTitle("\u540c\u6b65\u6570\u636e"),R.SetParam("syncData",m),R.select=b,d=y.debugCamera,(m=[]).push({title:"\u662f",value:!0}),m.push({title:"\u5426",value:!1}),b=d?0:1,(R=this.form.AddElement(v)).SetTitle("\u8c03\u8bd5\u955c\u5934"),R.SetParam("debugCamera",m),R.select=b,this.form.ApplyModify()},e.prototype.exit=function(){},e.prototype.update=function(){},e.prototype.submit=function(){var t,e,r=this.form.GetData(),o=this.proxy.GetConfig();try{for(var n=a(r),i=n.next();!i.done;i=n.next()){var s=l(i.value,2),c=s[0],u=s[1];o[c]=u}}catch(p){t={error:p}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.proxy.SetConfig(o),this.unload()},e.__cname="LayerBattleDebugUI",i([c.injectField("Ref")],e.prototype,"Ref",void 0),e}(f.GameLayerUI);r.LayerBattleDebugUI=d;var m=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.SetTitle=function(t){this._title=t},e.prototype.SetOnParam=function(t){this._onParam=t},e.prototype.InitView=function(){this.OnInitView()},e.prototype.UpdateView=function(){this.com.tm("title").text=this._title,this.OnUpdateView()},e.prototype.GetParam=function(){var t=this.OnGetParam();return this._onParam&&(t=this._onParam(t)),t},e.prototype.OnInitView=function(){},e}(s.ScriptObject),v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.select=0,e}return n(e,t),e.prototype.GetUIPath=function(){return"ui://\u6218\u6597\u542f\u52a8\u53c2\u6570/\u7ec4\u4ef6_\u5355\u9009"},e.prototype.SetParam=function(t,e){this.param=e,this.key=t},e.prototype.OnGetParam=function(){return null==this.select?null:{key:this.key,value:this.param[this.select].value}},e.prototype.OnInitView=function(){var t=this;this.com.tm("list").asList.init(this,function(t,e,r){e.tm("title").text=r.title},function(e){t.select=e})},e.prototype.OnUpdateView=function(){var t=this.com.tm("list").asList;t.update(this.param),t.resizeToFit(),t.addSelection(this.select)},e.__cname="FormRadio",e}(m),_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.select=new Set,e}return n(e,t),e.prototype.GetUIPath=function(){return"ui://\u6218\u6597\u542f\u52a8\u53c2\u6570/\u7ec4\u4ef6_\u591a\u9009"},e.prototype.SetParam=function(t,e){this.param=e,this.key=t},e.prototype.OnGetParam=function(){var t,e;if(null==this.select)return null;var r=this.key,o=[];try{for(var n=a(this.select),i=n.next();!i.done;i=n.next()){var l=i.value;o.push(this.param[l].value)}}catch(s){t={error:s}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}return{key:r,value:o}},e.prototype.OnInitView=function(){var t=this;this.com.tm("list").asList.init(this,function(t,e,r){e.tm("title").text=r.title},function(e,r){r.asButton.selected?t.select.add(e):t.select.delete(e)})},e.prototype.OnUpdateView=function(){var t,e,r=this.com.tm("list").asList;r.update(this.param),r.resizeToFit();try{for(var o=a(this.select),n=o.next();!n.done;n=o.next()){var i=n.value;r.getChildAt(i).asButton.selected=!0}}catch(l){t={error:l}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}},e.__cname="FormCheckBox",e}(m),S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.select=0,e}return n(e,t),e.prototype.GetUIPath=function(){return"ui://\u6218\u6597\u542f\u52a8\u53c2\u6570/\u7ec4\u4ef6_\u4e0b\u62c9\u6846\u7ec4"},e.prototype.SetParam=function(t,e){this.param=e,this.key=t},e.prototype.OnGetParam=function(){if(null==this.select)return null;var t=this.select;return{key:this.key,value:this.param[t].value}},e.prototype.OnInitView=function(){},e.prototype.OnUpdateView=function(){var t=this,e=this.com.tm("text_value").asComboBox;e.items=this.param.map(function(t){return t.title}),e.values=this.param.map(function(t){return""+t.value}),e.selectedIndex=this.select,e.value=""+this.param[this.select].value,e.off(fgui.Event.STATUS_CHANGED),e.on(fgui.Event.STATUS_CHANGED,function(){t.select=e.selectedIndex})},e.__cname="FormSelect",e}(m),g=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetUIPath=function(){return"ui://\u6218\u6597\u542f\u52a8\u53c2\u6570/\u7ec4\u4ef6_\u8f93\u5165\u6846"},e.prototype.SetParam=function(t,e){this.key=t,this.param=null==e?"":String(e)},e.prototype.OnGetParam=function(){var t=this.param;return{key:this.key,value:t}},e.prototype.OnInitView=function(){},e.prototype.OnUpdateView=function(){var t=this,e=this.com.tm("text_value").asTextInput;e.text=this.param,e.off(fgui.Event.EDITING_END),e.on(fgui.Event.EDITING_END,function(){t.param=e.text})},e.__cname="FormInput",e}(m),b=function(t){function e(e){var r=t.call(this)||this;return r.formdata=new Map,r.elements=[],r.glist=e,e.init(r,function(t,e,r){r.com=e,r.InitView(),r.UpdateView()},function(){},function(t,e){return e.GetUIPath()}),e.setVirtual(),r}return n(e,t),e.prototype.onDestroy=function(){var e,r;try{for(var o=a(this.elements),n=o.next();!n.done;n=o.next())n.value.destroy()}catch(i){e={error:i}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}t.prototype.onDestroy.call(this)},e.prototype.AddElement=function(t){var e=new t;return this.elements.push(e),e},e.prototype.ApplyModify=function(){var t=this.glist;t.update(this.elements),t.scrollToView(0)},e.prototype.GetData=function(){var t,e;this.formdata.clear();try{for(var r=a(this.elements),o=r.next();!o.done;o=r.next()){var n=o.value.GetParam();this.formdata.set(n.key,n.value)}}catch(i){t={error:i}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}return u.FW.ZJJ.log("\u542f\u52a8\u53c2\u6570:",this.formdata),this.formdata},e.__cname="Form",e}(s.ScriptObject);cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/base/ScriptObject":void 0,"../../../../framework/container/Container":void 0,"../../../../framework/layer/common/UIOrder":void 0,"../../ui/GameLayer":"GameLayer","./ConstBattle":"ConstBattle"}],LayerBattleExitTips:[function(t,e,r){"use strict";cc._RF.push(e,"ba89cwczIRMbZyPTdxAqxMJ","LayerBattleExitTips");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.LayerBattleExitTipsUI=r.LayerBattleExitTips=void 0;var i=t("../../../../../../framework/layer/common/UIOrder"),a=t("../../../../ui/GameLayer"),l=t("./BattleLayerOrder"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return c},e.prototype.getUrl=function(){return"ui://\u6218\u6597/\u7ec4\u4ef6_\u6218\u6597_\u8fd4\u56de\u4e3b\u9875\u63d0\u9192"},e.prototype.getSortOrder=function(){return i.LayerOrder.Main},e.prototype.getSortOrder2=function(){return l.BattleLayerOrder.Tips},e.prototype.SetClickLeft=function(t){this.clickLeft=t},e.prototype.GetClickLeft=function(){return this.clickLeft},e.prototype.SetClickRight=function(t){this.clickRight=t},e.prototype.GetClickRight=function(){return this.clickRight},e.__cname="LayerBattleExitTips",e}(a.GameLayerProxy);r.LayerBattleExitTips=s;var c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getHasBackground=function(){return!0},e.prototype.init=function(){var t=this;this.com.toCenterParent(this.container),this.com.tm("\u6309\u94ae_\u7ee7\u7eed\u6e38\u620f").setClick(function(){t.proxy.GetClickLeft()()},this),this.com.tm("\u6309\u94ae_\u9000\u51fa\u6e38\u620f").setClick(function(){t.proxy.GetClickRight()()},this)},e.prototype.release=function(){},e.prototype.enter=function(){},e.prototype.exit=function(){},e.prototype.update=function(){},e.__cname="LayerBattleExitTipsUI",e}(a.GameLayerUI);r.LayerBattleExitTipsUI=c,cc._RF.pop()},{"../../../../../../framework/layer/common/UIOrder":void 0,"../../../../ui/GameLayer":"GameLayer","./BattleLayerOrder":"BattleLayerOrder"}],LayerBattlePause:[function(t,e,r){"use strict";cc._RF.push(e,"cef30Y3hUxHvolS3sKyON+p","LayerBattlePause");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerBattlePauseUI=r.LayerBattlePause=void 0;var a=t("../../../../../../framework/container/Container"),l=t("../../../../../../framework/layer/common/UIOrder"),s=t("../../../../ui/GameLayer"),c=t("../../../alert/PanelPopInfo"),u=t("./BattleLayerOrder"),p=new Map;p.set(0,"\u7ec4\u4ef6_\u82f1\u96c4\u4fe1\u606f.\u7ec4\u4ef6_\u7279\u62800"),p.set(1,"\u7ec4\u4ef6_\u82f1\u96c4\u4fe1\u606f.\u7ec4\u4ef6_\u7279\u62801"),p.set(2,"\u7ec4\u4ef6_\u82f1\u96c4\u4fe1\u606f.\u7ec4\u4ef6_\u7279\u62802");var f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return h},e.prototype.getUrl=function(){return"ui://\u6218\u6597/\u7ec4\u4ef6_\u6218\u6597_\u8bbe\u7f6e"},e.prototype.getSortOrder=function(){return l.LayerOrder.Main},e.prototype.getSortOrder2=function(){return u.BattleLayerOrder.TwoLevel+51},e.__cname="LayerBattlePause",e}(s.GameLayerProxy);r.LayerBattlePause=f;var h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getHasBackground=function(){return!0},e.prototype.init=function(){var t=this;this.com.toCenterParent(this.container),this.enableBlackClick(),this.com.tm("\u6309\u94ae_\u8fd4\u56de\u4e3b\u9875").setClick(function(){var e=t.CtrlBattleView.LayerBattleExitTips;e.SetClickLeft(function(){e.unload()}),e.SetClickRight(function(){e.unload(),t.GPGameover.Abandon()}),e.load()},this),this.com.tm("\u6309\u94ae_\u4f24\u5bb3\u7edf\u8ba1").setClick(function(){t.LayerDamageStastic.load()},this);var e=this.com.tm("\u6309\u94ae_\u58f0\u97f3").asButton.tmc("\u9759\u97f3");e.setSelectedIndex(0!=this.CtrlAudio.GetMusicVolume()?0:1),this.com.tm("\u6309\u94ae_\u58f0\u97f3").setClick(function(){var r=e.selectedIndex;e.setSelectedIndex(0==r?1:0),t.CtrlAudio.SetMusicVolume(r?1:0),t.OnOffMgr.OnOffMusic.SetValue(!!r),t.OnOffMgr.OnOffMusic.Save()},this),this.updateView(),this.GPAudio.adjustBGM(this)},e.prototype.release=function(){this.GPAudio.resumeBGM(this)},e.prototype.enter=function(){this.SystemEvent.sendPaused(this)},e.prototype.exit=function(){this.SystemEvent.sendResume(this)},e.prototype.update=function(){},e.prototype.updateView=function(){var t=this,e=this.GPSpecialEffect.GetIcon();this.com.tm("\u7ec4\u4ef6_\u82f1\u96c4\u4fe1\u606f.\u88c5\u8f7d\u5668_\u82f1\u96c4").SetUrlByIcon(e);for(var r=this.GPSpecialEffect.GetList(),o=function(e){var o=p.get(e),i=n.com.tm(o),a=r[e];i.tm("title").text=a.GetName(),i.setClick(function(){var e=t.proxy.addPanel(c.PanelPopInfo);e.SetParent(i),e.SetTitle(a.GetName()),e.SetContent(a.GetDesc()),e.SetTitleVisible(!0),e.SetShowArrow(!0)},n)},n=this,i=0;i<3;i++)o(i);var a=this.GPHeroSkill.GetTlSkill(),l=this.GPHeroSkill.GetLimit();(s=this.com.tm("\u5217\u8868_\u6b66\u5668\u6280\u80fd").asList).init(this,function(t,e,r){var o=e;if(t>=l)o.setSelectedPage("\u5c01\u5370","\u662f");else if(o.setSelectedPage("\u5c01\u5370","\u5426"),r.IsEmpty())o.setSelectedPage("\u663e\u793a\u5185\u5bb9","\u5426");else if(o.setSelectedPage("\u663e\u793a\u5185\u5bb9","\u662f"),o.tm("icon").SetUrlByIcon(r.GetIcon()),o.tm("title").text=r.GetName(),o.setSelectedPage("\u7a81\u7834",r.GetIsBroken()?"\u662f":"\u5426"),!r.GetIsBroken()){var n=o.tm("\u8fdb\u5ea6\u6761_\u6280\u80fd\u7b49\u7ea7").asProgress;n.max=r.GetMaxLevel(),n.value=r.GetLevel()}}),s.update(a);var s,u=this.GPHeroSupply.GetTlSupply(),f=this.GPHeroSupply.GetLimit();(s=this.com.tm("\u5217\u8868_\u5fc3\u6cd5").asList).init(this,function(t,e,r){var o=e;if(t>=f)o.setSelectedPage("\u5c01\u5370","\u662f");else if(o.setSelectedPage("\u5c01\u5370","\u5426"),r.IsEmpty())o.setSelectedPage("\u663e\u793a\u5185\u5bb9","\u5426");else{o.setSelectedPage("\u663e\u793a\u5185\u5bb9","\u662f"),o.tm("icon").SetUrlByIcon(r.GetIcon()),o.tm("title").text=r.GetName(),o.setSelectedPage("\u7a81\u7834","\u5426");var n=o.tm("\u8fdb\u5ea6\u6761_\u6280\u80fd\u7b49\u7ea7").asProgress;n.max=r.GetMaxLevel(),n.value=r.GetLevel()}}),s.update(u)},e.__cname="LayerBattlePauseUI",i([a.injectField("CtrlBattle")],e.prototype,"CtrlBattle",void 0),i([a.injectField("CtrlBattleView")],e.prototype,"CtrlBattleView",void 0),i([a.injectField("SystemEvent")],e.prototype,"SystemEvent",void 0),i([a.injectField("GPSpecialEffect")],e.prototype,"GPSpecialEffect",void 0),i([a.injectField("GPLevelUp")],e.prototype,"GPLevelUp",void 0),i([a.injectField("GPHeroSkill")],e.prototype,"GPHeroSkill",void 0),i([a.injectField("GPHeroSupply")],e.prototype,"GPHeroSupply",void 0),i([a.injectField("GPGameover")],e.prototype,"GPGameover",void 0),i([a.injectField("GPAudio")],e.prototype,"GPAudio",void 0),i([a.injectField("GPNetSync")],e.prototype,"GPNetSync",void 0),i([a.injectField("ModelHero")],e.prototype,"ModelHero",void 0),i([a.injectField("CtrlAudio")],e.prototype,"CtrlAudio",void 0),i([a.injectField("OnOffMgr")],e.prototype,"OnOffMgr",void 0),i([a.injectField("LayerDamageStastic")],e.prototype,"LayerDamageStastic",void 0),e}(s.GameLayerUI);r.LayerBattlePauseUI=h,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../../../../../framework/layer/common/UIOrder":void 0,"../../../../ui/GameLayer":"GameLayer","../../../alert/PanelPopInfo":"PanelPopInfo","./BattleLayerOrder":"BattleLayerOrder"}],LayerBattle:[function(t,e,r){"use strict";cc._RF.push(e,"f4d894PToRDxZyAu5qsjBD+","LayerBattle");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerBattleUI=r.LayerBattle=void 0;var s=t("../../../../framework/container/Container"),c=t("../../../../framework/FW"),u=t("../../../../framework/layer/common/UIMgr"),p=t("../../ui/GameScene"),f=t("./BattleStartConfig"),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._starting=!1,e}return n(e,t),e.prototype.getUIClass=function(){return y},e.prototype.getUrl=function(){return"ui://\u6218\u6597/\u7ec4\u4ef6_\u6218\u6597_\u4e3b\u754c\u9762"},e.prototype.SetConfig=function(t){this._config=t},e.prototype.GetConfig=function(){return this._config},e.prototype.Start=function(t){return a(this,void 0,void 0,function(){var e=this;return l(this,function(r){switch(r.label){case 0:return this._starting?[2]:(this._starting=!0,this.SetConfig(t),this.load(),[4,c.FW.Task.waitUntil(function(){return 0!=u.UIMgr.instance.isUIOpen(e.className)&&!e._starting})]);case 1:return r.sent(),[2]}})})},e.prototype.___MarkStarted=function(){this._starting=!1},e.__cname="LayerBattle",e}(p.GameSceneProxy);r.LayerBattle=h;var y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getHasBackground=function(){return!1},e.prototype.initAsync=function(){return a(this,void 0,Promise,function(){return l(this,function(t){switch(t.label){case 0:return[4,c.FW.FairyMgr.loadByPkgNameAsync("\u56fe\u6807_\u6280\u80fd")];case 1:return t.sent(),[2]}})})},e.prototype.init=function(){this.com.toFullCenterParent(this.container);var t=this.proxy.GetConfig()||f.BattleDebugConfig;this.battle=this.CtrlBattle.CreateBattle(t)},e.prototype.release=function(){this.proxy.SetConfig(null),this.CtrlBattle.DestroyBattle(),this.battle=null},e.prototype.enterAsync=function(){return a(this,void 0,Promise,function(){var t,e;return l(this,function(){return t=this.proxy.GetConfig()||f.BattleDebugConfig,e=this.ModelMgr.ModelFuben.GetFubenRefByResId(t.fubenId),this.CtrlAudio.PlayMusic(e.battleBGM),[2]})})},e.prototype.enter=function(){this.StartInner()},e.prototype.exit=function(){this.CtrlAudio.StopMusic()},e.prototype.update=function(t){this.battle.update(t)},e.prototype.StartInner=function(){return a(this,void 0,void 0,function(){var t,e,r;return l(this,function(o){switch(o.label){case 0:return t=!1,this.battle.start(),this.battle.GetPromise().promise.then(function(){t=!0,c.FW.ZJJ.log("\u8fdb\u5165\u6218\u573a")}),[4,c.FW.Task.waitUntil(function(){return t})];case 1:return o.sent(),e=[this.CtrlBattleView.LayerJoystick,this.CtrlBattleView.LayerTopMenu,this.CtrlBattleView.LayerRolePanel,this.CtrlBattleView.LayerBatterCamerEffect,this.CtrlBattleView.LayerBattleDamageText],r=!1,this.LoadLayer_async(e).then(function(){r=!0}).catch(function(t){r=!0,t&&c.FW.ZJJ.error(t)}),[4,c.FW.Task.waitUntil(function(){return r})];case 2:return o.sent(),this.proxy.___MarkStarted(),[2]}})})},e.__cname="LayerBattleUI",i([s.injectField("CtrlBattleView")],e.prototype,"CtrlBattleView",void 0),i([s.injectField("CtrlAudio")],e.prototype,"CtrlAudio",void 0),i([s.injectField("CtrlBattle")],e.prototype,"CtrlBattle",void 0),i([s.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(p.GameScene);r.LayerBattleUI=y,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/container/Container":void 0,"../../../../framework/layer/common/UIMgr":void 0,"../../ui/GameScene":"GameScene","./BattleStartConfig":"BattleStartConfig"}],LayerBossNodeReconnect:[function(t,e,r){"use strict";cc._RF.push(e,"9f67c5g48VGraD9JnLBY0Wd","LayerBossNodeReconnect");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerBossNodeReconnectUI=r.LayerBossNodeReconnect=void 0;var a=t("../../../../../framework/container/Container"),l=t("../../../../../framework/layer/common/UIOrder"),s=t("../../../model/goods/ModelGoods"),c=t("../../../ui/GameLayer"),u=t("../../battle/view/common/BattleLayerOrder"),p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return f},e.prototype.getUrl=function(){return"ui://\u6218\u6597/\u7ec4\u4ef6_\u6218\u6597_\u6218\u6597\u91cd\u8fde\u63d0\u793a"},e.prototype.getSortOrder=function(){return l.LayerOrder.Main},e.prototype.getSortOrder2=function(){return u.BattleLayerOrder.ThreeLevel},e.__cname="LayerBossNodeReconnect",e}(c.GameLayerProxy);r.LayerBossNodeReconnect=p;var f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.init=function(t){var e=this,r=e.com;r.toCenterParent(this.container),e._data=t.ret,e._leftCb=t.leftCb,e._rightCb=t.rightCb,r.tm("\u6309\u94ae_\u5173\u95ed").visible=!1,r.tm("\u6309\u94ae_\u5173\u95ed").setClick(e.unload,e),r.tm("\u6309\u94ae_\u7ee7\u7eed").setClick(function(){e._rightCb&&e._rightCb(),e.unload()},e),r.tm("\u6309\u94ae_\u91cd\u5f00").setClick(function(){e._leftCb&&e._leftCb(),e.unload()},e),e.updateView()},e.prototype.release=function(){var t=this;t._data=null,t._leftCb=null,t._rightCb=null},e.prototype.enter=function(){},e.prototype.exit=function(){},e.prototype.update=function(){},e.prototype.updateView=function(){var t=this,e=this.Ref.RefMgrchapterRef.getRef("resId",t._data.resId),r=this.Ref.RefMgrfuBenRef.getRef("resId",e.fuben),o=this.Ref.RefMgrbattleWaveRef.getRef("id",r.waveId),n=this.Ref.RefMgrbattleWavePlanRef.getRef("id",o.wavePlanId),i=t.com.tm("list").asList;i.initVirtualList(t,t.renderListItem),i.update(n.waveId);var a=t.ModelGoods.GetGoodsNumberByRefId(s.ECurrencyType.reborn_coin);t.com.tm("\u6587\u672c_\u6570\u91cf").asTextField.setVar("count",a+"").flushVars()},e.prototype.renderListItem=function(t,e){var r,o,n=(null===(o=((null===(r=this._data.cmdBattleBeat)||void 0===r?void 0:r.args)||[]).find(function(t){return"killBoss"==t.key}))||void 0===o?void 0:o.value)||0;e.tmc("\u51fb\u6740").setSelectedIndex(n>t?1:0)},e.__cname="LayerBossNodeReconnectUI",i([a.injectField("GPGameover")],e.prototype,"GPGameover",void 0),i([a.injectField("Ref")],e.prototype,"Ref",void 0),i([a.injectField("ModelGoods")],e.prototype,"ModelGoods",void 0),e}(c.GameLayerUI);r.LayerBossNodeReconnectUI=f,cc._RF.pop()},{"../../../../../framework/container/Container":void 0,"../../../../../framework/layer/common/UIOrder":void 0,"../../../model/goods/ModelGoods":"ModelGoods","../../../ui/GameLayer":"GameLayer","../../battle/view/common/BattleLayerOrder":"BattleLayerOrder"}],LayerBreach:[function(t,e,r){"use strict";cc._RF.push(e,"cd6b97MRblAeL02aFVLB9Ag","LayerBreach");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerBreachUI=r.LayerBreach=void 0;var a=t("../../../../../framework/container/Container"),l=t("../../../../../framework/layer/common/UIOrder"),s=t("../../../../../libutil/BigNum"),c=t("../../../fguiExtend/GObjRD"),u=t("../../../model/goods/ModelGoods"),p=t("../../../ui/GameLayer"),f=t("../Hero/PanelPopBreach"),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return y},e.prototype.getUrl=function(){return"ui://\u82f1\u96c4_\u7a81\u7834/\u7ec4\u4ef6_\u82f1\u96c4\u7a81\u7834_\u4e3b\u754c\u9762"},e.prototype.getSortOrder=function(){return l.LayerOrder.TowLevel},e.__cname="LayerBreach",e}(p.GameLayerProxy);r.LayerBreach=h;var y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.showAni=!1,e.scrollChildIndex=0,e.isFirstOpen=!0,e.maxShowIndex=0,e.dirty=!1,e}return n(e,t),e.prototype.getHasBackground=function(){return!0},e.prototype.GetHasCloseAnimation=function(){return!0},e.prototype.GetHasShowAnimation=function(){return!0},e.prototype.init=function(){var t=this,e=t.com;t.com.toFullCenterParent(this.container),e.tm("panel_bg.\u6309\u94ae_\u5173\u95ed").setClick(function(){t.unload()},t);var r=t.ModelMgr.ModelGoods.GetRefByCurrency(u.ECurrencyType.coin),o=t.ModelMgr.ModelGoods.GetRefByCurrency(u.ECurrencyType.gene);e.tm("\u88c5\u8f7d\u5668_\u91d1\u5e01").SetUrlByIcon(r.icon),e.tm("\u88c5\u8f7d\u5668_\u57fa\u56e0").SetUrlByIcon(o.icon),t.InitList(),t.toolSet.addListener(t.ModelMgr.ModelVO.VORoleBag.GetEventProxy(),"OnChanged",function(){t.dirty=!0}),t.itemSubset=t.ModelMgr.ModelVO.VOItemBag.CreateSubset(),t.itemSubset.SetFilter(function(t){return t.GetRefId()==u.ECurrencyType.gene}),t.toolSet.addListener(t.itemSubset.GetEventProxy(),"OnChanged",function(){t.dirty=!0})},e.prototype.update=function(){this.dirty&&(this.dirty=!1,this.updateView())},e.prototype.InitList=function(){var t=this,e=this,r=e.com,o=r.tm("\u5217\u8868_\u7a81\u7834").asList,n=this.ModelMgr.ModelBreach.GetBreachAttributeRefBySkillId(1);o.initVirtualList(e,function(i,a,l){var p=a.asCom;o.setChildIndex(a,i);var h=e.ModelMgr.ModelRole.GetRole();if(null!=h){var y=h.GetLevel(),d=h.Getpassive(),m=h.GetSpecial(),v=p.tm("\u7ec4\u4ef6_\u5de6\u8fb9"),_=p.tm("\u7ec4\u4ef6_\u53f3\u8fb9");e.ModelMgr.ModelBreach.GetBreachAttributeRef(l.resId+1)?(v.setSelectedPage("\u5bfc\u7ebf","\u662f"),_.setSelectedPage("\u5bfc\u7ebf","\u662f")):(v.setSelectedPage("\u5bfc\u7ebf","\u5426"),_.setSelectedPage("\u5bfc\u7ebf","\u5426")),v.setSelectedPage("\u662f\u5426\u6fc0\u6d3b",d>=l.resId?"\u662f":"\u5426"),v.setSelectedPage("\u7c7b\u578b","\u5c5e\u6027"),v.tm("\u6309\u94ae_\u5c5e\u6027.icon").SetUrlByIcon(l.icon);var S=e.ModelMgr.ModelBreach.GetBreachAttributeRef(l.resId-1);S&&S.level!=l.level?(p.setSelectedPage("\u663e\u793a\u7b49\u7ea7","\u662f"),p.tm("\u6587\u672c_\u7b49\u7ea7").text=l.level.toString(),y>=l.level?p.tm("\u56fe\u7247_\u7b49\u7ea7\u80cc\u666f").grayed=!1:p.tm("\u56fe\u7247_\u7b49\u7ea7\u80cc\u666f").grayed=!0,p.setSelectedPage("\u7b49\u7ea7\u4e0a\u9650",y==l.level?"\u662f":"\u5426")):(p.setSelectedPage("\u663e\u793a\u7b49\u7ea7","\u5426"),p.setSelectedPage("\u7b49\u7ea7\u4e0a\u9650","\u5426"));var g=v.tm("\u7ea2\u70b9");if(y>=l.level&&l.resId-1==d){var b=s.BigNum.isGreaterThanOrEqualTo(h.GetCoin(),l.deplete)?1:0;g.OnRDUpdate(b,c.RDType.upgradeRedDot)}else g.OnRDUpdate(0,c.RDType.upgradeRedDot);var C=v.tm("\u6309\u94ae_\u5c5e\u6027");C.setClick(function(){var o=e.proxy.addPanel(f.PanelPopBreach);if(o.SetTitle(l.name),o.SetContent(l.desc),o.SetTip(l.tips),o.SetParent(C.asCom),l.resId-d==1){var n=s.BigNum.isGreaterThanOrEqualTo(h.GetCoin(),l.deplete),a=n?"\u6b63\u5e38":"\u4e0d\u8db3",c=e.ModelMgr.ModelGoods.CreateGoods(u.ECurrencyType.coin);o.SetBtn({icon:c.GetIconUrl(),title:"X"+s.BigNum.shortNum(l.deplete),type:a,click:function(){if(n){t.ModelMgr.ModelBreach.RequestBreach(l.resId,1);var o=r.tm("\u5217\u8868_\u7a81\u7834").asList,a=i>2?i-2:0;o.scrollToView(a,!0,!0)}else e.LayerTipBuy.SetData({resId:u.ECurrencyType.coin,currency:Number(s.BigNum.minus(l.deplete,h.GetCoin()))}),e.LayerTipBuy.load()}}),y>=l.level?(o.SetBtnState(!0),o.SetType("\u5c55\u793a")):(o.SetBtnState(!1),o.SetType("\u4e0d\u5c55\u793a"))}},a);var R=t.ModelMgr.ModelBreach.GetBreachAttributeRefBySkillId(m),M=t.ModelMgr.ModelBreach.GetBreachAttributeRefBySkillId(m+1),w=0,O=0;R&&(w=R.resId),M&&(O=M.resId),_.setSelectedPage("\u662f\u5426\u6fc0\u6d3b",O>l.resId?"\u662f":"\u5426");var B=Math.max(w,d);p.setSelectedPage("\u7a81\u7834\u9636\u6bb5",0!=B&&B==l.resId?"\u662f":"\u5426");var P=null;null!=l.skillId&&(P=e.ModelMgr.ModelBreach.GetBreachSkillRef(l.skillId));var G=n.resId<=l.resId;null!=P||G?p.setSelectedPage("\u663e\u793a\u4e2a\u6570","2"):p.setSelectedPage("\u663e\u793a\u4e2a\u6570","1");var k=_.tm("\u7ea2\u70b9");if(G&&(_.setSelectedPage("\u7c7b\u578b","\u65e0"),k.OnRDUpdate(0,c.RDType.upgradeRedDot)),P){_.setSelectedPage("\u7c7b\u578b","\u6280\u80fd"),_.tm("\u6309\u94ae_\u6280\u80fd.icon").SetUrlByIcon(P.icon);var x=t.ModelMgr.ModelGoods.GetGoodsNumberByRefId(u.ECurrencyType.gene);y>=P.level&&P.resId-1==m?(b=s.BigNum.isGreaterThanOrEqualTo(x,P.deplete)?1:0,k.OnRDUpdate(b,c.RDType.upgradeRedDot)):k.OnRDUpdate(0,c.RDType.upgradeRedDot);var T=_.tm("\u6309\u94ae_\u6280\u80fd");T.setClick(function(){var o=e.proxy.addPanel(f.PanelPopBreach);if(o.SetTitle(P.name),o.SetContent(P.desc),o.SetTip(P.tips),o.SetParent(T.asCom),P.resId-m==1){var n=t.ModelMgr.ModelGoods.GetGoodsNumberByRefId(u.ECurrencyType.gene),a=s.BigNum.isGreaterThanOrEqualTo(n,P.deplete),c=a?"\u6b63\u5e38":"\u4e0d\u8db3",p=e.ModelMgr.ModelGoods.CreateGoods(u.ECurrencyType.gene);o.SetBtn({icon:p.GetIconUrl(),title:"X"+s.BigNum.shortNum(P.deplete),type:c,click:function(){if(a){t.ModelMgr.ModelBreach.RequestBreach(P.resId,2);var o=r.tm("\u5217\u8868_\u7a81\u7834").asList,l=i>2?i-2:0;o.scrollToView(l,!0,!0)}else e.LayerTipBuy.SetData({resId:u.ECurrencyType.gene,currency:P.deplete-n}),e.LayerTipBuy.load()}}),y>=l.level?(o.SetBtnState(!0),o.SetType("\u5c55\u793a")):(o.SetBtnState(!1),o.SetType("\u4e0d\u5c55\u793a"))}},a)}}});var i=e.ModelMgr.ModelBreach.GetAllBreachAttributeRef();i.sort(function(t,e){return e.resId-t.resId});var a=this.GetMaxIndex(i);null==a&&(a=i.length-1),o.update(i),o.scrollToView(a)},e.prototype.updateView=function(){this.updateRes(),this.updateList()},e.prototype.updateRes=function(){var t=this.com,e=this.ModelMgr.ModelRole.GetRole().GetCoin(),r=this.ModelMgr.ModelGoods.GetGoodsNumberByRefId(u.ECurrencyType.gene);t.tm("\u6587\u672c_\u91d1\u5e01\u6570\u91cf").text=s.BigNum.shortNum(e),t.tm("\u6587\u672c_\u57fa\u56e0\u6570\u91cf").text=s.BigNum.shortNum(r)},e.prototype.updateList=function(){this.com.tm("\u5217\u8868_\u7a81\u7834").asList.refreshVirtualList()},e.prototype.GetMaxIndex=function(t){var e=this.ModelMgr.ModelRole.GetRole(),r=e.Getpassive(),o=e.GetSpecial();if(0!=r||0!=o){for(var n,i,a=t.length-1;a>=0;a--){var l=t[a];l.resId==r&&(n=a);var s=this.ModelMgr.ModelBreach.GetBreachSkillRef(l.skillId);s&&s.resId==o&&(i=a)}return n||i}this.scrollChildIndex=t.length-1},e.prototype.GetListItem=function(t,e){var r=this.com.tm("\u5217\u8868_\u7a81\u7834").asList,o=this.ModelMgr.ModelBreach.GetAllBreachAttributeRef().length-1-t;r.scrollToView(o);var n=r.itemIndexToChildIndex(o);return r.getChildAt(n).asCom.tm(e)},e.__cname="LayerBreachUI",i([a.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([a.injectField("LayerTipBuy")],e.prototype,"LayerTipBuy",void 0),i([a.injectField("CtrlMgr")],e.prototype,"CtrlMgr",void 0),e}(p.GameLayerUI);r.LayerBreachUI=y,cc._RF.pop()},{"../../../../../framework/container/Container":void 0,"../../../../../framework/layer/common/UIOrder":void 0,"../../../../../libutil/BigNum":void 0,"../../../fguiExtend/GObjRD":"GObjRD","../../../model/goods/ModelGoods":"ModelGoods","../../../ui/GameLayer":"GameLayer","../Hero/PanelPopBreach":"PanelPopBreach"}],LayerBuyGoods:[function(t,e,r){"use strict";cc._RF.push(e,"6f47eULuONLEL5aUy99M3w5","LayerBuyGoods");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerBuyGoodsUI=r.LayerBuyGoods=void 0;var a=t("../../../../framework/FW"),l=t("../../../../framework/container/Container"),s=t("../../../../framework/layer/common/UIOrder"),c=t("../../../../libutil/BigNum"),u=t("../../model/vo/Goods/VOEquip"),p=t("../../model/vo/Goods/VOItem"),f=t("../../model/vo/Goods/VORune"),h=t("../../ui/GameLayer"),y=t("../main/Hero/Rune/LayerRuneDetails"),d=t("../main/LayerItemDetail"),m=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return v},e.prototype.getUrl=function(){return"ui://\u5171\u7528\u7ec4\u4ef6/\u7ec4\u4ef6_\u5171\u7528\u7ec4\u4ef6_\u8d2d\u4e70\u5f39\u7a97"},e.prototype.getSortOrder=function(){return s.LayerOrder.TipsUI},e.prototype.SetGood=function(t){this._Good=t},e.prototype.GetGood=function(){return this._Good},e.prototype.SetBuyInfo=function(t){this._buyInfo=t},e.prototype.GetBuyInfo=function(){return this._buyInfo},e.prototype.SetPayObj=function(t){this._payObj=t},e.prototype.GetPayObj=function(){return this._payObj},e.prototype.SetTitle=function(t){this._title=t},e.prototype.GetTitle=function(){return this._title},e.__cname="LayerBuyGoods",e}(h.GameLayerProxy);r.LayerBuyGoods=m;var v=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getHasBackground=function(){return!0},e.prototype.GetHasCloseAnimation=function(){return!0},e.prototype.GetHasShowAnimation=function(){return!0},e.prototype.init=function(){this.com.toCenterParent(this.container),this.InitClick(),this.InitLayer()},e.prototype.InitClick=function(){var t=this,e=t.com,r=t.proxy;e.tm("panel_bg.\u6309\u94ae_\u5173\u95ed").setClick(function(){t.unload()},t),e.tm("\u6309\u94ae_\u8d2d\u4e70").setClick(function(){var e=r.GetPayObj();t.ModelMgr.ModelPay.Pay(e),t.unload()},t)},e.prototype.InitLayer=function(){var t=this,e=t.com,r=t.proxy,o=r.GetGood(),n=r.GetTitle()||o.GetName(),i=e.tm("item");if(i.UpdateByGoods(o),i.GetBehavior().onNumberVisible(!1),o instanceof p.VOItem)i.ClickItem(!0,o,t.proxy);else if(o instanceof u.VOEquip){var l=o;t.LayerItemDetail.load(),t.LayerItemDetail.SetEquip(l),t.LayerItemDetail.SetOpenPosition(d.OpenPosition.synthesis)}else if(o instanceof f.VORune){var s=o;t.LayerRuneDetails.SetData({rune:s}),t.LayerRuneDetails.SetViewType(y.RuneDetailsViewType.noShowButon),t.LayerRuneDetails.load()}else a.FW.LWX.error("\u7c7b\u578b\u9519\u8bef\uff0c\u8bf7\u68c0\u67e5\u662f\u5426\u65b0\u589e\u7c7b\u578b");e.tm("\u6587\u672c_\u6570\u91cf").asTextField.setVar("value",c.BigNum.shortNum(o.GetNumber(),1)).flushVars(),e.tm("panel_bg.title").text=n;var h=r.GetBuyInfo();o=t.ModelMgr.ModelGoods.CreateGoodsByCmd({resId:h.payResId,number:String(h.payNumber)}),e.tm("\u6309\u94ae_\u8d2d\u4e70.icon").SetUrlByIcon(o.GetIconUrl()),e.tm("\u6309\u94ae_\u8d2d\u4e70.title").text="X"+c.BigNum.shortNum(h.payNumber)},e.__cname="LayerBuyGoodsUI",i([l.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([l.injectField("LayerItemDetail")],e.prototype,"LayerItemDetail",void 0),i([l.injectField("LayerRuneDetails")],e.prototype,"LayerRuneDetails",void 0),e}(h.GameLayerUI);r.LayerBuyGoodsUI=v,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/container/Container":void 0,"../../../../framework/layer/common/UIOrder":void 0,"../../../../libutil/BigNum":void 0,"../../model/vo/Goods/VOEquip":"VOEquip","../../model/vo/Goods/VOItem":"VOItem","../../model/vo/Goods/VORune":"VORune","../../ui/GameLayer":"GameLayer","../main/Hero/Rune/LayerRuneDetails":"LayerRuneDetails","../main/LayerItemDetail":"LayerItemDetail"}],LayerBuySta:[function(t,e,r){"use strict";cc._RF.push(e,"87762ILX7hHlYLHfEbZuoeP","LayerBuySta");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerBuyStaUI=r.LayerBuySta=r.BuyStaType=void 0;var s,c=t("../../../../../framework/container/Container"),u=t("../../../../../framework/layer/common/UIOrder"),p=t("../../../model/pay/BuyPayObj"),f=t("../../../ui/GameLayer");(function(t){t[t.Free=1]="Free",t[t.Ad=2]="Ad",t[t.Gem=3]="Gem"})(s=r.BuyStaType||(r.BuyStaType={}));var h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return y},e.prototype.getUrl=function(){return"ui://\u9996\u9875_\u4fee\u70bc_\u8d2d\u4e70\u4f53\u529b/\u9996\u9875_\u4fee\u70bc_\u4f53\u529b\u8d2d\u4e70"},e.prototype.getSortOrder=function(){return u.LayerOrder.TowLevel},e.__cname="LayerBuySta",e}(f.GameLayerProxy);r.LayerBuySta=h;var y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getHasBackground=function(){return!0},e.prototype.GetHasCloseAnimation=function(){return!0},e.prototype.GetHasShowAnimation=function(){return!0},e.prototype.init=function(){var t=this;this.com.toCenterParent(this.container),this.com.tm("bg.\u6309\u94ae_\u5173\u95ed").setClick(function(){t.unload()},this),this.InitGlist(),this.toolSet.addListener(this.ModelMgr.ModelSta.GetEventProxy(),"OnBuyStaUpdate",function(){t.com.tm("\u5217\u8868_\u4f53\u529b\u8d2d\u4e70").asList.refreshVirtualList()},this)},e.prototype.enterAsync=function(){return a(this,void 0,void 0,function(){return l(this,function(t){switch(t.label){case 0:return[4,this.ModelMgr.ModelSta.RequestBuyStaInfo()];case 1:return t.sent(),[2]}})})},e.prototype.enter=function(){var t=this.ModelMgr.ModelSta.GetAllRef();this.com.tm("\u5217\u8868_\u4f53\u529b\u8d2d\u4e70").asList.update(t)},e.prototype.InitGlist=function(){var t=this,e=this;e.com.tm("\u5217\u8868_\u4f53\u529b\u8d2d\u4e70").asList.init(e,function(r,o,n){var i=t.ModelMgr.ModelSta.GetDataById(n.id),u=n.rewards[0].number,f=n.rewards[0].resId,h=n.buyTimes,y=i&&i.state||0,d=Math.max(h-y,0),m=t.ModelMgr.ModelGoods.CreateGoods(f).GetName();if(o.setSelectedIndex("\u662f\u5426\u514d\u8d39",n.payType!=s.Gem?1:0),o.tm("\u6309\u94ae_\u8d2d\u4e70").asCom.setSelectedIndex("\u652f\u4ed8\u7c7b\u578b",n.payType-1),n.payType==s.Gem){var v=n.numbers,_=Math.min(v.length-1,y);t.log("tlNumbers:",v);var S=t.ModelMgr.ModelGoods.CreateGoodsByCmd({resId:n.resId,number:v[_]});o.tm("\u6309\u94ae_\u8d2d\u4e70.\u6309\u94ae_\u8d27\u5e01\u8d2d\u4e70.icon").SetUrlByIcon(S.GetIconUrl()),o.tm("\u6309\u94ae_\u8d2d\u4e70.\u6309\u94ae_\u8d27\u5e01\u8d2d\u4e70.title").text="X"+S.GetNumber()}o.tm("\u6309\u94ae_\u8d2d\u4e70").grayed=d<=0,t.setFairyBtnEvent(o.tm("\u6309\u94ae_\u8d2d\u4e70"),function(){return a(t,void 0,void 0,function(){var t,r;return l(this,function(o){switch(o.label){case 0:return t={ref:n,buyStaData:i},r=new p.BuyStaPayObj(t),c.Container.inst().inject(r),[4,this.ModelMgr.ModelPay.Pay(r)];case 1:return o.sent()&&e.unload(),[2]}})})}),o.tm("\u6587\u672c_\u4f53\u529b\u6570\u91cf").asTextField.setVar("value",u).setVar("name",m).flushVars(),o.tm("\u6587\u672c_\u5269\u4f59\u6b21\u6570").asTextField.setVar("number",d.toString()).flushVars()})},e.__cname="LayerBuyStaUI",i([c.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([c.injectField("Ref")],e.prototype,"Ref",void 0),e}(f.GameLayerUI);r.LayerBuyStaUI=y,cc._RF.pop()},{"../../../../../framework/container/Container":void 0,"../../../../../framework/layer/common/UIOrder":void 0,"../../../model/pay/BuyPayObj":"BuyPayObj","../../../ui/GameLayer":"GameLayer"}],LayerChapterReward:[function(t,e,r){"use strict";cc._RF.push(e,"77a21/cU4dIXqT+W6GLSIPO","LayerChapterReward");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerChapterRewardUI=r.LayerChapterReward=void 0;var a=t("../../../../../framework/FW"),l=t("../../../../../framework/container/Container"),s=t("../../../../../framework/layer/common/UIOrder"),c=t("../../../model/System/ModelSystem"),u=t("../../../ui/GameLayer"),p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return f},e.prototype.getUrl=function(){return"ui://\u9996\u9875_\u4fee\u70bc/\u7ec4\u4ef6_\u4fee\u70bc_\u5173\u5361\u5956\u52b1"},e.prototype.getSortOrder=function(){return s.LayerOrder.TowLevel},e.prototype.getSystemId=function(){return c.SystemId.ChapterReward},e.prototype.SetChooseChapterResId=function(t){this._resId=t},e.prototype.GetChoose=function(){return this._resId},e.__cname="LayerChapterReward",e}(u.GameLayerProxy);r.LayerChapterReward=p;var f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getHasBackground=function(){return!0},e.prototype.GetHasCloseAnimation=function(){return!0},e.prototype.GetHasShowAnimation=function(){return!0},e.prototype.init=function(){var t=this;this.com.toFullCenterParent(this.container),this.com.tm("panel_bg.\u6309\u94ae_\u5173\u95ed").setClick(function(){t.unload()},this),this.InitData(),this.InitList(),this.toolSet.addListener(this.ModelMgr.ModelVO.VOChapterBag.GetEventProxy(),"OnChanged",this.updateView,this)},e.prototype.enter=function(){this.updateView()},e.prototype.InitData=function(){this.chooseChapterResId=this.proxy.GetChoose(),null==this.chooseChapterResId&&(this.chooseChapterResId=this.ModelMgr.ModelChapter.GetSelectResId()),null==this.chooseChapterResId&&(a.FW.showTip(a.FW.G_W("\u672a\u77e5\u9519\u8bef\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5")),this.unload())},e.prototype.InitList=function(){var t=this,e=this.com.tm("\u5217\u8868_\u96be\u5ea6\u5956\u52b1").asList,r=function(e,r,o){l.Container.inst().inject(r);var n=t.ModelMgr.ModelGoods.CreateGoodsByCmd(o);r.UpdateByGoods(n),r.ClickItem(!0,n,t.proxy)};e.initVirtualList(this,function(e,o,n){var i=t,a=o.tm("\u5217\u8868_\u5956\u52b1").asList,l=i.chooseChapterResId,s=i.ModelMgr.ModelChapter.GetRefChapter(l);o.setSelectedIndex("\u96be\u5ea6",s.difficulty-1),o.tm("\u6587\u672c_\u63d0\u793a").text=n.tip,o.asCom.tm("\u6309\u94ae_\u9886\u53d6").setClick(function(){i.ModelMgr.ModelChapter.RequestChapterReward(n.resId)},o);var c=i.ModelMgr.ModelChapter.GetTlRewardByRewardId(n.reward);a.init(i,r),a.update(c);var u=i.ModelMgr.ModelVO.VOChapterBag.Get(l);if(null!=u){var p=u.GetRewardState(n.resId);o.setSelectedIndex("\u72b6\u6001",p)}else o.setSelectedPage("\u72b6\u6001","\u672a\u5b8c\u6210")})},e.prototype.updateView=function(){var t=this,e=t.com,r=e.tm("\u5217\u8868_\u96be\u5ea6\u5956\u52b1").asList,o=t.chooseChapterResId,n=t.ModelMgr.ModelChapter.GetRefChapter(o);e.tm("\u88c5\u8f7d\u5668_\u7ae0\u8282\u540d\u79f0").SetUrlByIcon(n.title),e.setSelectedIndex("\u96be\u5ea6",n.difficulty-1);var i=t.ModelMgr.ModelChapter.GetTlRefChapterBox(o);r.update(i)},e.__cname="LayerChapterRewardUI",i([l.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(u.GameLayerUI);r.LayerChapterRewardUI=f,cc._RF.pop()},{"../../../../../framework/FW":void 0,"../../../../../framework/container/Container":void 0,"../../../../../framework/layer/common/UIOrder":void 0,"../../../model/System/ModelSystem":"ModelSystem","../../../ui/GameLayer":"GameLayer"}],LayerChapterSelect:[function(t,e,r){"use strict";cc._RF.push(e,"671e3ak8EJEIphkd2RbFxqI","LayerChapterSelect");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerChapterSelectUI=r.LayerChapterSelect=void 0;var a=t("../../../../../framework/container/Container"),l=t("../../../../../framework/layer/common/UIOrder"),s=t("../../../ui/GameLayer"),c=t("../../alert/CtrlAlert"),u=t("./TabXiulian"),p=["\u7eff\u8272\u7c92\u5b50","\u9ec4\u8272\u7c92\u5b50","\u7ea2\u8272\u7c92\u5b50"],f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.listener=null,e}return n(e,t),e.prototype.getUIClass=function(){return h},e.prototype.getUrl=function(){return"ui://\u9996\u9875_\u4fee\u70bc/\u7ec4\u4ef6_\u4fee\u70bc_\u5173\u5361\u9009\u62e9"},e.prototype.getSortOrder=function(){return l.LayerOrder.TowLevel},e.prototype.SetChooseChapterResId=function(t){this.chooseChapterResId=t},e.prototype.GetChooce=function(){return this.chooseChapterResId},e.prototype.exit=function(){this.chooseChapterResId=null},e.__cname="LayerChapterSelect",e}(s.GameLayerProxy);r.LayerChapterSelect=f;var h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getHasBackground=function(){return!1},e.prototype.init=function(){this.com.toFullCenterParent(this.container);var t=this.proxy.GetChooce();null==t&&(t=this.ModelMgr.ModelChapter.GetSelectResId());var e=this.ModelMgr.ModelChapter.GetRefChapter(t);this.key=e.key,this.diffculty=e.difficulty,this.InitClick(),this.InitList(),this.toolSet.addListener(this.ModelMgr.ModelVO.VOChapterBag.GetEventProxy(),"OnChanged",this.UpdateView,this)},e.prototype.release=function(){},e.prototype.enter=function(){this.UpdateView()},e.prototype.InitClick=function(){var t=this;t.com.tm("\u6309\u94ae_\u786e\u5b9a").setClick(function(){var e=t.ModelMgr.ModelChapter.GetResId(t.key,t.diffculty);t.ModelMgr.ModelChapter.SetSelectResId(e),t.unload()},t),t.com.tm("\u6309\u94ae_\u8fd4\u56de").setClick(function(){t.unload()},t),t.com.tm("\u6309\u94ae_\u53f3\u7bad\u5934").setClick(function(){t.clickArrow(1)},t),t.com.tm("\u6309\u94ae_\u5de6\u7bad\u5934").setClick(function(){t.clickArrow(-1)},t);for(var e=function(e){var r=t.com.tm("\u7ec4\u4ef6_\u96be\u5ea6"+e).asCom;r.tm("\u6309\u94ae_\u96be\u5ea6").setClick(function(){t.SetDiffculty(e)},t),r.tm("\u6309\u94ae_\u5b9d\u7bb1").setClick(function(){var r=t.ModelMgr.ModelChapter.GetResId(t.key,e);t.LayerChapterReward.SetChooseChapterResId(r),t.LayerChapterReward.load()},t)},r=1;r<=3;r++)e(r)},e.prototype.SetDiffculty=function(t){var e=this;e.diffculty=t,e.com.tm("\u88c5\u8f7d\u5668_\u7c92\u5b50\u7279\u6548").SetUrlByModel(c.particlesMap.get(p[t-1])),e.UpdateView()},e.prototype.clickArrow=function(t){var e=this,r=e.key+t;null!=e.ModelMgr.ModelChapter.GetResId(r,e.diffculty)&&(e.key=r,this.com.tm("\u7ec4\u4ef6_\u5173\u5361\u5217\u8868.\u5217\u8868_\u5173\u5361").asList.scrollToView(this.key-1,!0),e.SetDiffculty(1))},e.prototype.InitList=function(){var t=this;t.com.tm("\u5217\u8868_\u96be\u5ea6Buff").asList.init(t,function(t,e,r){e.tm("\u6587\u672c_\u6807\u9898").text=r.title,e.tm("\u6587\u672c_\u63cf\u8ff0").text=r.desc,e.tm("icon").SetUrlByIcon(r.buffIcon)});var e=t.com.tm("\u7ec4\u4ef6_\u5173\u5361\u5217\u8868.\u5217\u8868_\u5173\u5361").asList;t.com.tm("\u7ec4\u4ef6_\u5173\u5361\u5217\u8868.\u5217\u8868_\u5173\u5361").asList.initVirtualList(t,function(e,r,o){r.tm("icon").SetUrlByIcon(o.chapterIcon),r.tm("\u88c5\u8f7d\u5668_\u9634\u5f71").SetUrlByIcon(o.chapterIcon);var n=t.ModelMgr.ModelChapter.GetIsUnlock(o.resId);r.setSelectedPage("\u662f\u5426\u89e3\u9501",n?"\u662f":"\u5426"),n||r.tm("\u88c5\u8f7d\u5668_\u9501").SetUrlByIcon("\u7279\u6548_\u767e\u604b_\u7ae0\u8282\u5c01\u5370")}),t.com.tm("\u7ec4\u4ef6_\u5173\u5361\u5217\u8868.\u5217\u8868_\u5173\u5361").asList.update(t.ModelMgr.ModelChapter.GetTlRefAllByDifficulty()),t.com.tm("\u7ec4\u4ef6_\u5173\u5361\u5217\u8868.\u5217\u8868_\u5173\u5361").asList.scrollToView(t.key-1),e.on(fgui.Event.SCROLL_END,function(){var r=e.getFirstChildInView();t.key=r+1,t.diffculty=1,t.UpdateView()},t)},e.prototype.UpdateView=function(){var t=this,e=t.com,r=t.ModelMgr.ModelChapter.GetResId(t.key,t.diffculty),o=t.ModelMgr.ModelChapter.GetRefChapter(r),n=u.hartArray[t.diffculty-1];e.tm("\u88c5\u8f7d\u5668_\u96be\u5ea6\u80cc\u666f").SetUrlByIcon(n);var i=t.ModelMgr.ModelChapter.GetIsUnlock(r);t.com.setSelectedPage("\u5df2\u89e3\u9501",i?"\u662f":"\u5426"),e.tm("\u88c5\u8f7d\u5668_\u6807\u9898").SetUrlByIcon(o.title),e.tm("\u6587\u672c_\u7ae0\u8282\u63cf\u8ff0").text=o.desc;for(var a=1;a<=3;a++){var l=e.tm("\u7ec4\u4ef6_\u96be\u5ea6"+a),s=a,c=t.ModelMgr.ModelChapter.GetResId(t.key,s),p=t.ModelMgr.ModelChapter.GetIsUnlock(c);this.log("resId:",c),this.log("isUnlock:",p),l.tmc("\u96be\u5ea6").setSelectedIndex(a-1),l.setSelectedPage("\u5df2\u89e3\u9501",p?"\u662f":"\u5426"),l.setSelectedPage("\u9009\u4e2d",p&&s==t.diffculty?"\u662f":"\u5426");var f=t.ModelMgr.ModelChapter.CheckAllGetBoxReward(c);l.setSelectedPage("\u5956\u52b1\u5168\u83b7\u5f97",f?"\u662f":"\u5426");var h=t.ModelMgr.ModelChapter.HasRewardReceive(c);t.log("has:",h),l.tm("\u6309\u94ae_\u5b9d\u7bb1.\u7ea2\u70b9").OnRDUpdate(h)}t.updateChapterList(),t.UpdateBuffList()},e.prototype.updateChapterList=function(){},e.prototype.UpdateBuffList=function(){var t=this,e=t.com.tm("\u5217\u8868_\u96be\u5ea6Buff").asList,r=t.ModelMgr.ModelChapter.GetResId(t.key,t.diffculty),o=this.ModelMgr.ModelChapter.GetTlBuff(r);o.length>0?(e.visible=!0,e.update(o)):e.visible=!1},e.__cname="LayerChapterSelectUI",i([a.injectField("LayerChapterReward")],e.prototype,"LayerChapterReward",void 0),i([a.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(s.GameLayerUI);r.LayerChapterSelectUI=h,cc._RF.pop()},{"../../../../../framework/container/Container":void 0,"../../../../../framework/layer/common/UIOrder":void 0,"../../../ui/GameLayer":"GameLayer","../../alert/CtrlAlert":"CtrlAlert","./TabXiulian":"TabXiulian"}],LayerClickOnEffect:[function(t,e,r){"use strict";cc._RF.push(e,"0e364Yomq5NNLjN+mE7KWpE","LayerClickOnEffect");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.LayerClickOnEffectUI=r.LayerClickOnEffect=void 0;var i=t("../../../../framework/FW"),a=t("../../../../framework/layer/common/UIOrder"),l=t("../../ui/GameLayer"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return c},e.prototype.getUrl=function(){return"ui://\u5171\u7528_\u70b9\u51fb\u7279\u6548/\u7ec4\u4ef6_\u70b9\u51fb\u7279\u6548"},e.prototype.getSortOrder=function(){return a.LayerOrder.TipsUI},e.prototype.getSortOrder2=function(){return 9999999},e.prototype.getIsRedsident=function(){return!0},e.prototype.GetIsGameLayer=function(){return!0},e.prototype.SetPostition=function(t){this._postition=t},e.prototype.GetPostition=function(){return this._postition},e.__cname="LayerClickOnEffect",e}(l.GameLayerProxy);r.LayerClickOnEffect=s;var c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getHasBackground=function(){return!1},e.prototype.init=function(){this.com.toFullCenterParent(this.container),i.FW.LWX.log("\u52a0\u8f7d\u70b9\u51fb\u7279\u6548")},e.prototype.SetEffectPos=function(){var t=this.com,e=this.proxy.GetPostition(),r=this.com.globalToLocal(e.x,e.y);if(r){var o=t.tm("\u7ec4\u4ef6_\u70b9\u51fb");o.setPosition(r.x,r.y),o.asCom.tmt("\u52a8\u6548_\u70b9\u51fb\u7279\u6548").play()}},e.__cname="LayerClickOnEffectUI",e}(l.GameLayerUI);r.LayerClickOnEffectUI=c,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/layer/common/UIOrder":void 0,"../../ui/GameLayer":"GameLayer"}],LayerContacts:[function(t,e,r){"use strict";cc._RF.push(e,"14957sWbpdF6J6PKNPcS+Bh","LayerContacts");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerContactsUI=r.LayerContacts=void 0;var s=t("../../../../../../framework/container/Container"),c=t("../../../../../../framework/layer/common/UIOrder"),u=t("../../../../model/System/ModelSystem"),p=t("../../../../ui/GameLayer"),f=t("./TabFriends"),h=t("./TabFriendsApply"),y=t("./TabFriendsBlack"),d=t("./TabFriendsReceive"),m=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return v},e.prototype.getUrl=function(){return"ui://\u9996\u9875_\u4fee\u70bc_\u597d\u53cb\u7cfb\u7edf/\u9996\u9875_\u4fee\u70bc_\u597d\u53cb\u7cfb\u7edf_\u4e3b\u754c\u9762"},e.prototype.getSortOrder=function(){return c.LayerOrder.TowLevel},e.prototype.getSystemId=function(){return u.SystemId.Contacts},e.__cname="LayerContacts",e}(p.GameLayerProxy);r.LayerContacts=m;var v=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getHasBackground=function(){return!0},e.prototype.init=function(){var t=this;this.com.toFullCenterParent(this.container),this.com.tm("panel_bg.\u6309\u94ae_\u5173\u95ed").setClick(function(){t.unload()},this)},e.prototype.enter=function(){this.proxy.switchDefaultTab()},e.prototype.InitTabProxy=function(){this.proxy.addTab(f.TabFriends),this.proxy.addTab(d.TabFriendsReceive),this.proxy.addTab(h.TabFriendsApply),this.proxy.addTab(y.TabFriendsBlack)},e.prototype.SetupTabBehaviorAsync=function(){return a(this,void 0,void 0,function(){var e,r,o,n,i=this;return l(this,function(){return e=this.com.tm("\u6309\u94ae_\u597d\u53cb"),this.SetTabBtnBehavior(this.proxy.getTab(f.TabFriends),{btn:e,onVisibleChanged:function(t,e){t.visible=e},onCallBack:function(){i.com.setSelectedPage("\u9875\u7b7e","\u597d\u53cb")},onRdChanged:function(t){e.asCom.tm("\u7ea2\u70b9").OnRDUpdate(t)}}),r=this.com.tm("\u6309\u94ae_\u4f53\u529b\u9886\u53d6"),this.SetTabBtnBehavior(this.proxy.getTab(d.TabFriendsReceive),{btn:r,onVisibleChanged:function(t,e){t.visible=e},onCallBack:function(){i.com.setSelectedPage("\u9875\u7b7e","\u4f53\u529b\u9886\u53d6")},onRdChanged:function(t){r.asCom.tm("\u7ea2\u70b9").OnRDUpdate(t)}}),o=this.com.tm("\u6309\u94ae_\u7533\u8bf7\u5217\u8868"),this.SetTabBtnBehavior(this.proxy.getTab(h.TabFriendsApply),{btn:o,onVisibleChanged:function(t,e){t.visible=e},onCallBack:function(){i.com.setSelectedPage("\u9875\u7b7e","\u7533\u8bf7\u5217\u8868")},onRdChanged:function(t){o.asCom.tm("\u7ea2\u70b9").OnRDUpdate(t)}}),n=this.com.tm("\u6309\u94ae_\u9ed1\u540d\u5355"),this.SetTabBtnBehavior(this.proxy.getTab(y.TabFriendsBlack),{btn:n,onVisibleChanged:function(t,e){t.visible=e},onCallBack:function(){i.com.setSelectedPage("\u9875\u7b7e","\u9ed1\u540d\u5355")},onRdChanged:function(t){n.asCom.tm("\u7ea2\u70b9").OnRDUpdate(t)}}),t.prototype.SetupTabBehaviorAsync.call(this),[2]})})},e.__cname="LayerContactsUI",i([s.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(p.GameLayerUI);r.LayerContactsUI=v,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../../../../../framework/layer/common/UIOrder":void 0,"../../../../model/System/ModelSystem":"ModelSystem","../../../../ui/GameLayer":"GameLayer","./TabFriends":"TabFriends","./TabFriendsApply":"TabFriendsApply","./TabFriendsBlack":"TabFriendsBlack","./TabFriendsReceive":"TabFriendsReceive"}],LayerCustomerService:[function(t,e,r){"use strict";cc._RF.push(e,"a51a0rqs6hApIGXVBRZDMZx","LayerCustomerService");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerCustomerServiceUI=r.LayerCustomerService=void 0;var a=t("../../../../../../framework/container/Container"),l=t("../../../../../../framework/FW"),s=t("../../../../../../framework/layer/common/UIOrder"),c=t("../../../../ui/GameLayer"),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return p},e.prototype.getUrl=function(){return"ui://\u8054\u7cfb\u5ba2\u670d/\u7ec4\u4ef6_\u8054\u7cfb\u5ba2\u670d_\u4e3b\u754c\u9762"},e.prototype.getSortOrder=function(){return s.LayerOrder.TowLevel},e.__cname="LayerCustomerService",e}(c.GameLayerProxy);r.LayerCustomerService=u;var p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getHasBackground=function(){return!0},e.prototype.init=function(){this.com.toFullCenterParent(this.container)},e.prototype.release=function(){},e.prototype.enter=function(){this.InitClick(),this.InitLayer()},e.prototype.InitClick=function(){var t=this,e=this,r=e.com;r.tm("\u6309\u94ae_\u5173\u95ed").setClick(function(){l.FW.LWX.log("\u70b9\u51fb\u6309\u94ae_\u5173\u95ed"),e.unload()},e),r.tm("\u6309\u94ae_\u8054\u7cfb\u6211\u4eec").setClick(function(){l.FW.LWX.log("\u70b9\u51fb\u8054\u7cfb\u6211\u4eec"),t.SDKMgr.getSDK().OpenSdkCustomerService()},e)},e.prototype.InitLayer=function(){var t=this.com,e=this.CtrlNotice.SettingFeedBackData[0],r=e.wbName||"",o=e.gzhName||"";t.tm("\u7ec4\u4ef6_\u5185\u5bb9.title").text="    "+e.content.replace(/\\n/g,"\n    "),t.tm("\u6587\u672c_\u95ee\u5019\u8bed").text=e.greeting,t.tm("\u6587\u672c_\u5b98\u65b9\u516c\u4f17\u53f7").asTextField.setVar("name",o).flushVars(),t.tm("\u6587\u672c_\u5b98\u65b9\u516c\u4f17\u53f7").visible=e.isShowGzh,t.tm("\u6587\u672c_\u5b98\u65b9\u5fae\u535a").asTextField.setVar("name",r).flushVars(),t.tm("\u6587\u672c_\u5b98\u65b9\u5fae\u535a").visible=e.isShowWb},e.prototype.exit=function(){},e.prototype.update=function(){},e.__cname="LayerCustomerServiceUI",i([a.injectField("CtrlNotice")],e.prototype,"CtrlNotice",void 0),i([a.injectField("SDKMgr")],e.prototype,"SDKMgr",void 0),e}(c.GameLayerUI);r.LayerCustomerServiceUI=p,cc._RF.pop()},{"../../../../../../framework/FW":void 0,"../../../../../../framework/container/Container":void 0,"../../../../../../framework/layer/common/UIOrder":void 0,"../../../../ui/GameLayer":"GameLayer"}],LayerDamageStastic:[function(t,e,r){"use strict";cc._RF.push(e,"17970OyTjBFHI3Idg/0t85Y","LayerDamageStastic");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerDamageStasticUI=r.LayerDamageStastic=void 0;var s=t("../../../../../../framework/container/Container"),c=t("../../../../../../framework/FW"),u=t("../../../../../../framework/layer/common/UIOrder"),p=t("../../../../../../libutil/BigNum"),f=t("../../../../ui/GameLayer"),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return y},e.prototype.getUrl=function(){return"ui://\u6218\u6597/\u7ec4\u4ef6_\u6218\u6597_\u4f24\u5bb3\u7edf\u8ba1"},e.prototype.getSortOrder=function(){return u.LayerOrder.OneLevel},e.__cname="LayerDamageStastic",e}(f.GameLayerProxy);r.LayerDamageStastic=h;var y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dirty=!1,e.tlData=[],e}return n(e,t),e.prototype.getHasBackground=function(){return!0},e.prototype.getFloatNode=function(){return this.com.tm("panel_bg")},e.prototype.init=function(){var t=this;this.com.toFullCenterParent(this.container),this.toolSet.addCallback(this.GPDamageStastic.GetChangeEvent(),function(){t.dirty=!0}),this.com.tm("panel_bg.\u6309\u94ae_\u5173\u95ed").setClick(function(){t.unload()},this),this.com.tm("list").asList.init(this,function(e,r,o){var n=t.ModelBattleSkill.GetSkill(o.skillId);r.tm("\u6587\u672c_\u6280\u80fd").text=c.FW.G_W(n.GetName()),r.tm("\u56fe\u6807_\u6280\u80fd").SetUrlByIcon(n.GetIcon()),r.tm("\u6587\u672c_\u4f24\u5bb3").text=p.BigNum.shortNum(o.damage);var i=r.tm("\u8fdb\u5ea6\u6761_\u4f24\u5bb3\u5360\u6bd4").asProgress;i.max=1,i.value=o.rate}),this.UpdateView()},e.prototype.update=function(){this.dirty&&(this.dirty=!1,this.UpdateView())},e.prototype.UpdateData=function(){var t,e;this.tlData.length=0;try{for(var r=a(this.GPDamageStastic.GetTmSkill()),o=r.next();!o.done;o=r.next()){var n=l(o.value,2),i=(n[0],n[1]);this.tlData.push(i)}}catch(s){t={error:s}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}this.tlData.sort(function(t,e){return e.damage-t.damage})},e.prototype.UpdateView=function(){this.UpdateData(),this.com.tm("list").asList.update(this.tlData)},e.__cname="LayerDamageStasticUI",i([s.injectField("GPDamageStastic")],e.prototype,"GPDamageStastic",void 0),i([s.injectField("ModelBattleSkill")],e.prototype,"ModelBattleSkill",void 0),e}(f.GameLayerUI);r.LayerDamageStasticUI=y,cc._RF.pop()},{"../../../../../../framework/FW":void 0,"../../../../../../framework/container/Container":void 0,"../../../../../../framework/layer/common/UIOrder":void 0,"../../../../../../libutil/BigNum":void 0,"../../../../ui/GameLayer":"GameLayer"}],LayerDayWeekMonthGift:[function(t,e,r){"use strict";cc._RF.push(e,"dd2bfAQjmZDZ7Z6odGWT/g1","LayerDayWeekMonthGift");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},c=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerDayWeekMonthGiftUI=r.LayerDayWeekMonthGift=void 0;var u=t("../../../../framework/FW"),p=t("../../../../framework/container/Container"),f=t("../../../../framework/layer/common/UIOrder"),h=t("../../../../framework/utils/StringUtil"),y=t("../../model/System/ModelSystem"),d=t("../../model/dayWeekMonthGift/ModelDayWeekMonthGift"),m=t("../../model/vo/Goods/Goods"),v=t("../../ui/GameLayer"),_=t("../alert/PanelPopInfo"),S=new Map;S.set(d.DayWeekMonthGiftType.day,"btnDay"),S.set(d.DayWeekMonthGiftType.week,"btnWeek"),S.set(d.DayWeekMonthGiftType.month,"btnMonth");var g=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return b},e.prototype.getUrl=function(){return"ui://\u65e5\u5468\u6708\u793c\u5305/\u7ec4\u4ef6_\u65e5\u5468\u6708\u793c\u5305_\u4e3b\u754c\u9762"},e.prototype.getSortOrder=function(){return f.LayerOrder.OneLevel},e.prototype.getSystemId=function(){return y.SystemId.DayWeekMonthGift},e.__cname="LayerDayWeekMonthGift",e}(v.GameLayerProxy);r.LayerDayWeekMonthGift=g;var b=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getHasBackground=function(){return!0},e.prototype.init=function(){var t=this;this.com.toFullCenterParent(this.container),this.com.tm("btn_close").setClick(function(){t.unload()},this),this.toolSet.addTimer(1,function(){t.UpdateTime()}),this.toolSet.addListener(this.modelMgr.ModelMall.GetEventProxy(),"BuySuccess",function(){t.modelMgr.ModelDayWeekMonthGift.ReqestInfo()}),this.toolSet.addListener(this.modelMgr.ModelDayWeekMonthGift.GetEventProxy(),"OnUpdate",function(e){t.InitData(e),t.UpdateView()});var e=this;e.audioInterval=15,e.audioCount=0;var r=this.modelMgr.ModelGameConfig.GetGameConfigValueByKey("dayweekmonthAudio");e.CtrlAudio.PlaySound(r[0],function(){e.audioId=null}).then(function(t){e.audioId=t});var o=this,n=o.com;n.tm("btnDay").setClick(function(){var t=o.tlDayGift.length<=0?1:0;n.setSelectedIndex("\u6709\u65e0\u5185\u5bb9",t)},o),n.tm("btnWeek").setClick(function(){var t=o.tlWeekGift.length<=0?1:0;n.setSelectedIndex("\u6709\u65e0\u5185\u5bb9",t)},o),n.tm("btnMonth").setClick(function(){var t=o.tlMonthGift.length<=0?1:0;n.setSelectedIndex("\u6709\u65e0\u5185\u5bb9",t)},o),this.UpdateTime()},e.prototype.release=function(){this.audioId&&this.CtrlAudio.Stop(this.audioId)},e.prototype.enterAsync=function(){return a(this,void 0,Promise,function(){var t,e,r,o,n,i=this;return l(this,function(a){switch(a.label){case 0:return(t=[]).push(this.Ref.RefMgrdayWeekMonthGift.preloadRef()),Promise.all(t).then(function(){i.modelMgr.ModelDayWeekMonthGift.ReqestInfo()}),e=this,[4,this.modelMgr.ModelMonthCard.GetMonthState()];case 1:return e.monthCardInfo=a.sent(),this.chapterSubset=this.modelMgr.ModelVO.VOChapterBag.CreateSubset(),this.chapterSubset.SetFilter(function(){return!0}),r=this.chapterSubset.GetVOBySift(function(t,e){return t.GetResId()<e.GetResId()}),o=null==r?void 0:r.GetResId(),n=this.modelMgr.ModelChapter.GetRefChapter(o),this.coinBase=60*(null==n?void 0:n.coinPatrol)||0,this.coinAdd=this.modelMgr.ModelHangling.GetAddition(this.coinBase,this.monthCardInfo.normal,this.monthCardInfo.premium),[2]}})})},e.prototype.exit=function(){return null},e.prototype.update=function(t){var e=this;if(e.audioCount+=t/1e3,e.audioCount>=e.audioInterval){e.audioCount=0,e.audioId&&e.CtrlAudio.Stop(e.audioId);var r=e.modelMgr.ModelGameConfig.GetGameConfigValueByKey("dayweekmonthAudio");e.CtrlAudio.PlaySound(r[1],function(){e.audioId=null}).then(function(t){e.audioId=t})}},e.prototype.InitData=function(t){for(var e,r=t.cmdDayWeekMonthGift.tlRechargeCount,o=0;o<r.length-2;o++)if(r[o].buyState<2){e=o;break}null==e&&(e=r.length-2),this.rechargeDay=t.cmdDayWeekMonthGift.rechargeDay,this.tlRechargeCount=[],this.tlRechargeCount.push(r[e]),this.tlRechargeCount.push(r[e+1]),this.tlRechargeCount.push(r[e+2]),this.tlDayGift=t.cmdDayWeekMonthGift.tlDayGift,this.tlWeekGift=t.cmdDayWeekMonthGift.tlWeekGift,this.tlMonthGift=t.cmdDayWeekMonthGift.tlMonthGift},e.prototype.UpdateView=function(){var t=this.com.tm("countGift1"),e=this.com.tm("countGift2"),r=this.com.tm("countGift3");this.InitRecharge(t,this.com.tm("text_count1"),this.tlRechargeCount[0]),this.InitRecharge(e,this.com.tm("text_count2"),this.tlRechargeCount[1]),this.InitRecharge(r,this.com.tm("text_count3"),this.tlRechargeCount[2]),this.UpdateBtnRD();for(var o=this.com.tm("\u7ec4\u4ef6_\u8fdb\u5ea6\u6761").asProgress,n=0,i=this.rechargeDay,a=0;a<3;a++){var l=this.tlRechargeCount[a];if(!(i>=l.resId)){if(a-1>=0){var s=this.tlRechargeCount[a-1];n+=(i-s.resId)/(l.resId-s.resId);break}n+=i/l.resId;break}n+=1}u.FW.LWX.log("value:",n),o.value=n,o.max=3,this.UpdateList()},e.prototype.UpdateBtnRD=function(){var t,e;try{for(var r=s(S),o=r.next();!o.done;o=r.next()){var n=c(o.value,2),i=n[0],a=n[1],l=this.com.tm(a).asCom.tm("\u7ea2\u70b9"),u=this.modelMgr.ModelDayWeekMonthGift.GetIsHasFreeGiftByType(i);l.OnRDUpdate(u)}}catch(p){t={error:p}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},e.prototype.InitRecharge=function(t,e,r){var o=this,n=this.modelMgr.ModelGoods.CreateGoodsByCmd(r.rewards[0]);t.UpdateByGoods(n);var i=t.GetBehavior().OnGetRDComponent(),a=1==r.buyState;i.OnRDUpdate(a),1==r.buyState?t.setClick(function(){o.modelMgr.ModelDayWeekMonthGift.RequestDayWeekMonthGiftGetReward(r.resId)},this):t.ClickItem(!0,n,this.proxy),e.text=r.resId.toString()},e.prototype.UpdateTime=function(){var t=this.timeUtil.timeSec2HMSStr12(0),e=this.timeUtil.timeSec2HMSStr12(1),r=this.timeUtil.timeSec2HMSStr12(2);this.com.tm("text_time1").text=t,this.com.tm("text_time2").text=e,this.com.tm("text_time3").text=r},e.prototype.UpdateList=function(){var t=this,e=this.com.tm("listDay"),r=this.com.tm("listWeek"),o=this.com.tm("listMonth"),n=function(e,r,o){for(var n=r,i=["item1","item2","item3"],s=function(e){if(o.rewards[e]){var r=n.tm(i[e]),a=t.modelMgr.ModelGoods.CreateGoodsByCmd(o.rewards[e]);r.UpdateByGoods(a),a.GetGoodsType()==m.EGoodsType.timeProduce?r.setClick(function(){var e=t.modelMgr.ModelBox.GetCoinBoxTimes(a.GetRefId()),o=t.coinAdd*e,n=t.coinBase*e,i=t.monthCardInfo.normal||t.monthCardInfo.premium,l=h.StringUtil.format("{0} {1} [color=#34ff19]{2}[/color]",a.GetDesc(),n,i?"+ "+o:""),s=t.proxy.addPanel(_.PanelPopInfo);s.SetTitle(a.GetName()),s.SetContent(l),s.SetParent(r.asCom),s.SetTitleVisible(!0)},t):r.ClickItem(!0,a,t.proxy)}},c=0;c<o.rewards.length;c++)s(c);var p=t.Ref.RefMgrdayWeekMonthGift.getRef("refId",o.giftId);n.setSelectedPage("\u5df2\u8d2d\u4e70",1==o.buyCount?"\u662f":"\u5426"),n.setSelectedIndex("\u54c1\u8d28",p.quality);var f=1==p.isFree,y=n.tm("\u7ea2\u70b9"),d=f&&0==o.buyCount;if(y.OnRDUpdate(d),f)n.setSelectedPage("\u662f\u5426\u514d\u8d39","\u662f"),t.setFairyBtnEvent(n.tm("btn_buy"),function(){return a(t,void 0,void 0,function(){return l(this,function(t){switch(t.label){case 0:return[4,this.CtrlPay.PayforAdVideo()];case 1:return t.sent()&&this.modelMgr.ModelDayWeekMonthGift.RequestDayWeekMonthGiftFreeBuy(p.refId),[2]}})})});else{n.setSelectedPage("\u662f\u5426\u514d\u8d39","\u5426"),u.FW.LWX.log(o.fromId);var v=t.Ref.RefMgrgoods.getRef("fromId",o.fromId),S=t.Ref.RefMgrpayChannel.getRef("key",v.key);n.tm("btn_buy.title").setVar("pay",S.rmb.toString()).flushVars(),n.tm("btn_buy").setClick(function(){t.SDKMgr.getSDK().PPP(S.id,v.type,v.fromId)},t)}};e.init(this,n),r.init(this,n),o.init(this,n),e.update(this.tlDayGift),r.update(this.tlWeekGift),o.update(this.tlMonthGift)},e.__cname="LayerDayWeekMonthGiftUI",i([p.injectField("Net")],e.prototype,"Net",void 0),i([p.injectField("TimeUtil")],e.prototype,"timeUtil",void 0),i([p.injectField("ModelMgr")],e.prototype,"modelMgr",void 0),i([p.injectField("Ref")],e.prototype,"Ref",void 0),i([p.injectField("SDKMgr")],e.prototype,"SDKMgr",void 0),i([p.injectField("CtrlAudio")],e.prototype,"CtrlAudio",void 0),i([p.injectField("CtrlPay")],e.prototype,"CtrlPay",void 0),e}(v.GameLayerUI);r.LayerDayWeekMonthGiftUI=b,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/container/Container":void 0,"../../../../framework/layer/common/UIOrder":void 0,"../../../../framework/utils/StringUtil":void 0,"../../model/System/ModelSystem":"ModelSystem","../../model/dayWeekMonthGift/ModelDayWeekMonthGift":"ModelDayWeekMonthGift","../../model/vo/Goods/Goods":"Goods","../../ui/GameLayer":"GameLayer","../alert/PanelPopInfo":"PanelPopInfo"}],LayerDisconnect:[function(t,e,r){"use strict";cc._RF.push(e,"20b9bS8yVxOBYMUzIqO1657","LayerDisconnect");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerDisconnectUI=r.LayerDisconnect=void 0;var s=t("../../../../framework/container/Container"),c=t("../../../../framework/FW"),u=t("../../../../framework/layer/common/UIOrder"),p=t("../../gamestate/GameStateMgr"),f=t("../../ui/GameLayer"),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return y},e.prototype.getUrl=function(){return"ui://\u5bf9\u8bdd\u5f39\u7a97/\u7ec4\u4ef6_\u5171\u7528_\u65ad\u7ebf\u63d0\u793a\u7a97"},e.prototype.getSortOrder=function(){return u.LayerOrder.TipsUI},e.prototype.SetMsg=function(t){this._Msg=t},e.prototype.GetMsg=function(){return this._Msg},e.__cname="LayerDisconnect",e}(f.GameLayerProxy);r.LayerDisconnect=h;var y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getHasBackground=function(){return!0},e.prototype.init=function(){var t=this;this.com.toFullCenterParent(this.container),this.UpdateMsg(),this.setFairyBtnEvent(this.com.tm("\u6309\u94ae_\u786e\u5b9a"),function(){return a(t,void 0,void 0,function(){return l(this,function(){return this.unload(),[2]})})})},e.prototype.release=function(){},e.prototype.enter=function(){},e.prototype.exit=function(){p.GameStateMgr.instance.switchToLogin()},e.prototype.update=function(){},e.prototype.UpdateMsg=function(){var t=this.proxy.GetMsg();t&&(this.proxy.SetMsg(null),this.com.tm("content").asTextField.text=c.FW.G_W(t))},e.__cname="LayerDisconnectUI",i([s.injectField("GameStateMgr")],e.prototype,"GameStateMgr",void 0),e}(f.GameLayerUI);r.LayerDisconnectUI=y,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/container/Container":void 0,"../../../../framework/layer/common/UIOrder":void 0,"../../gamestate/GameStateMgr":"GameStateMgr","../../ui/GameLayer":"GameLayer"}],LayerEquipDecomposition:[function(t,e,r){"use strict";cc._RF.push(e,"618ces7tjFBTKnfu/JMeUDH","LayerEquipDecomposition");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerEquipDecompositionUI=r.LayerEquipDecomposition=void 0;var a,l=t("../../../../../framework/container/Container"),s=t("../../../../../framework/layer/common/UIOrder"),c=t("../../../model/vo/Goods/VOEquip"),u=t("../../../ui/GameLayer");(function(t){t[t.DownLevel=0]="DownLevel",t[t.DownQuality=1]="DownQuality"})(a||(a={}));var p=[{key:"\u6309\u94ae_\u964d\u7ea7",type:a.DownLevel},{key:"\u6309\u94ae_\u964d\u54c1",type:a.DownQuality}],f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return h},e.prototype.getUrl=function(){return"ui://\u82f1\u96c4/\u7ec4\u4ef6_\u82f1\u96c4_\u88c5\u5907\u964d\u7ea7\u964d\u54c1"},e.prototype.getSortOrder=function(){return s.LayerOrder.TowLevel},e.prototype.SetInitialType=function(t){this.initialType=t},e.prototype.GetInitialType=function(){return this.initialType},e.prototype.SetEquip=function(t){this.equip=t},e.prototype.GetEquip=function(){return this.equip},e.__cname="LayerEquipDecomposition",e}(u.GameLayerProxy);r.LayerEquipDecomposition=f;var h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.downLevelData=[],e.downQualityData=[],e}return n(e,t),e.prototype.getHasBackground=function(){return!0},e.prototype.GetHasCloseAnimation=function(){return!0},e.prototype.GetHasShowAnimation=function(){return!0},e.prototype.init=function(){this.com.toFullCenterParent(this.container),this.nowType=this.proxy.GetInitialType();var t=this.com.tm("\u7ec4\u4ef6_\u88c5\u5907.item");t.UpdateByGoods(this.proxy.GetEquip()),t.GetBehavior().onNumberVisible(!1),this.InitList(),this.InitData(),this.InitClick()},e.prototype.InitList=function(){var t=this;this.com.tm("\u5217\u8868_\u5206\u89e3\u6750\u6599").init(this,function(e,r,o){var n=r.tm("com_goods"),i=o.resId.itemId;i||(i=o.resId);var a=t.ModelGoods.CreateGoodsByCmd({resId:i,number:String(o.num)});o.quality&&a instanceof c.VOEquip&&a.SetQuality(o.quality),o.phase&&a instanceof c.VOEquip&&a.SetPhase(o.phase),n.UpdateByGoods(a),n.GetBehavior().onNumberVisible(!(a instanceof c.VOEquip))})},e.prototype.InitData=function(){var t=this,e=t.proxy.GetEquip();t.downLevelData=e.GetDownLevelData(),t.downQualityData=e.GetDownQualityData(),t.updateLayer()},e.prototype.GetNowDownState=function(){var t=this.proxy.GetEquip();return this.nowType==a.DownLevel?t.GetDownLevelState():t.GetDownQualityState()},e.prototype.InitClick=function(){var t=this,e=this,r=e.com;r.tm("panel_bg.\u6309\u94ae_\u5173\u95ed").setClick(function(){e.unload()},e),r.tm("\u6309\u94ae_\u964d\u7ea7\u964d\u54c1").setClick(function(){t.nowType==a.DownLevel?t.ModelEquip.RequestEquipDownLevel(t.proxy.GetEquip().GetId()):t.ModelEquip.RequestEquipDownPhase(t.proxy.GetEquip().GetId()),e.unload()},e);for(var o=function(t){r.tm(p[t].key).setClick(function(){e.nowType=p[t].type,e.updateLayer()},e)},n=0;n<p.length;n++)o(n)},e.prototype.updateLayer=function(){var t=this,e=t.com,r=e.tm("\u5217\u8868_\u5206\u89e3\u6750\u6599");e.setSelectedIndex("\u9875\u7b7e\u72b6\u6001",t.nowType),e.setSelectedIndex("\u80fd\u5426\u964d\u7ea7\u964d\u54c1",this.GetNowDownState()?0:1),t.nowType==a.DownLevel&&this.GetNowDownState()?r.update(t.downLevelData):t.nowType==a.DownQuality&&this.GetNowDownState()&&r.update(t.downQualityData)},e.prototype.release=function(){this.ModelEquip=null,this.ModelGoods=null,this.downLevelData=null,this.downQualityData=null},e.__cname="LayerEquipDecompositionUI",i([l.injectField("ModelEquip")],e.prototype,"ModelEquip",void 0),i([l.injectField("ModelGoods")],e.prototype,"ModelGoods",void 0),e}(u.GameLayerUI);r.LayerEquipDecompositionUI=h,cc._RF.pop()},{"../../../../../framework/container/Container":void 0,"../../../../../framework/layer/common/UIOrder":void 0,"../../../model/vo/Goods/VOEquip":"VOEquip","../../../ui/GameLayer":"GameLayer"}],LayerEquipSynthesis:[function(t,e,r){"use strict";cc._RF.push(e,"cd898LfZN5G3Z6htH02nyMA","LayerEquipSynthesis");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},c=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerEquipSynthesisUI=r.LayerEquipSynthesis=void 0;var u,p=t("../../../../framework/FW"),f=t("../../../../framework/container/Container"),h=t("../../../../framework/layer/common/UIOrder"),y=t("../../model/Hero/ModelEquipSynthesis"),d=t("../../model/System/ModelSystem"),m=t("../../model/vo/Goods/Goods"),v=t("../../model/vo/Goods/VOEquip"),_=t("../../model/vo/Goods/VOItem"),S=t("../../ui/GameLayer"),g=t("./LayerItemDetail"),b=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return C},e.prototype.getUrl=function(){return"ui://\u82f1\u96c4/\u7ec4\u4ef6_\u82f1\u96c4_\u88c5\u5907\u5408\u6210"},e.prototype.getSortOrder=function(){return h.LayerOrder.OneLevel},e.prototype.getSystemId=function(){return d.SystemId.EquipSynthesis},e.__cname="LayerEquipSynthesis",i([f.injectField("CtrlMain")],e.prototype,"CtrlMain",void 0),i([f.injectField("CtrlAlert")],e.prototype,"CtrlAlert",void 0),e}(S.GameLayerProxy);r.LayerEquipSynthesis=b,function(t){t[t.all=0]="all",t[t.weapon=1]="weapon",t[t.armor=2]="armor",t[t.amulet=3]="amulet",t[t.belt=4]="belt",t[t.glove=5]="glove",t[t.shoe=6]="shoe"}(u||(u={}));var C=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tmNeedNumSelf=new Map,e.tmNeedNum=new Map,e}return n(e,t),e.prototype.init=function(){this.com.toFullCenterParent(this.container),this.InitBtn(),this.Initlist(),this.InitListener()},e.prototype.release=function(){},e.prototype.enter=function(){this.updateListData(),this.canClick=!0},e.prototype.update=function(){this.dirty&&(this.dirty=!1,this.RefreshList())},e.prototype.InitBtn=function(){var t=this,e=this,r=e.com,o=this.com.tm("\u7ec4\u4ef6_\u4e0b\u62c9\u6846").asComboBox;this.selectType=o.selectedIndex,o.initByAddChild,o.setSelectedIndex("\u7c7b\u578b",this.selectType),o.off(fgui.Event.STATUS_CHANGED),o.on(fgui.Event.STATUS_CHANGED,function(){t.selectType=o.selectedIndex,o.setSelectedIndex("\u7c7b\u578b",t.selectType),t.updateListData()},this),e.AddBtnBehavior(e.com.tm("\u6309\u94ae_\u4e00\u952e\u5408\u6210"),{systemId:d.SystemId.EquipSynthesis,OnRdChanged:function(t){e.com.tm("\u6309\u94ae_\u4e00\u952e\u5408\u6210.\u7ea2\u70b9").OnRDUpdate(t)}}),this.setFairyBtnEvent(r.tm("\u5408\u6210_\u88c5\u5907"),function(){return a(t,void 0,void 0,function(){return l(this,function(){return this.OnclicSynthesisSlot(),[2]})})}),this.setFairyBtnEvent(r.tm("\u9700\u5408\u6210\u88c5\u5907"),function(){return a(t,void 0,void 0,function(){return l(this,function(){return this.OnclicSelectSlot(),[2]})})}),this.setFairyEvent(r.tm("\u6750\u65991"),fgui.Event.CLICK,function(){return a(t,void 0,void 0,function(){return l(this,function(){return this.OnclickMaterial(1),[2]})})}),this.setFairyEvent(r.tm("\u6750\u65992"),fgui.Event.CLICK,function(){return a(t,void 0,void 0,function(){return l(this,function(){return this.OnclickMaterial(2),[2]})})}),this.setFairyBtnEvent(r.tm("\u6309\u94ae_\u8fd4\u56de"),function(){return a(t,void 0,void 0,function(){return l(this,function(){return this.unload(),[2]})})}),this.setFairyBtnEvent(r.tm("\u6309\u94ae_\u5408\u6210"),function(){return a(t,void 0,void 0,function(){return l(this,function(){return this.canClick?(this.OnclickSynthesisBtn(),[2]):(p.FW.showTip(p.FW.G_W("\u52aa\u529b\u5408\u6210\u4e2d\uff0c\u8bf7\u7a0d\u7b49")),[2])})})}),this.setFairyBtnEvent(r.tm("\u6309\u94ae_\u4e00\u952e\u5408\u6210"),function(){return a(t,void 0,void 0,function(){return l(this,function(t){switch(t.label){case 0:return this.canClick?[4,this.RequestOneKeySynthesis()]:(p.FW.showTip(p.FW.G_W("\u52aa\u529b\u5408\u6210\u4e2d\uff0c\u8bf7\u7a0d\u7b49")),[2]);case 1:return t.sent(),this.updateListData(),[2]}})})})},e.prototype.Initlist=function(){var t=this,e=this.com,r=e.tm("\u5408\u6210\u5217\u8868");r.initVirtualList(this,function(e,r,o){var n,i,a=r,l=a.tm("item");if(o){l.visible=!0,l.UpdateByGoods(o),l.GetBehavior().onNumberVisible(!1);var u=t.selectEquip;if(a.setSelectedPage("\u5408\u6210\u72b6\u6001","\u5426"),a.setSelectedPage("\u4e0a\u9501","\u5426"),a.setSelectedPage("\u5df2\u5907\u72b6\u6001","\u5426"),a.setSelectedPage("\u662f\u5426\u7f6e\u7070","\u5426"),o instanceof v.VOEquip&&(o.GetIsPutOn()&&a.setSelectedPage("\u5df2\u5907\u72b6\u6001","\u662f"),l.GetBehavior().onLevelVisible(!0)),null!=u){l.GetBehavior().onGrayUpdate(!1),(d=l.GetBehavior().OnGetRDComponent()).OnRDUpdate(0),t.CanUseBySyntheticMaterial(o)||u.GetId()==o.GetId()?a.touchable=!0:(l.GetBehavior().onGrayUpdate(!0),a.touchable=!1,a.setSelectedPage("\u662f\u5426\u7f6e\u7070","\u662f"));var p=o.GetId();if(p==t.selectEquip.GetId())a.setSelectedPage("\u5408\u6210\u72b6\u6001","\u662f");else try{for(var f=s(t.tmPutMaterial),h=f.next();!h.done;h=f.next()){var y=c(h.value,2);if(y[0],p==y[1].GetId()){a.setSelectedPage("\u5408\u6210\u72b6\u6001","\u662f");break}}}catch(S){n={error:S}}finally{try{h&&!h.done&&(i=f.return)&&i.call(f)}finally{if(n)throw n.error}}}else{l.GetBehavior().onGrayUpdate(!1);var d=l.GetBehavior().OnGetRDComponent(),m=t.CheckCanSynthesis(o);d.OnRDUpdate(m),o instanceof _.VOItem?(a.setSelectedPage("\u4e0a\u9501","\u662f"),l.GetBehavior().onGrayUpdate(!0),a.touchable=!1):a.touchable=!0}}else l.UpdateByGoods(null),l.visible=!1},function(e,r,o){o&&(t.selectEquip?t.OnclickItemOnSynthesis(o):t.OnclickItemOnNoSynthesis(o))}),r.setVirtual(),e.tm("\u5217\u8868_\u63d0\u5347").init(this,function(t,e,r){var o=e;o.setSelectedIndex("\u52a0\u6210\u7c7b\u578b",r.type),r.type==y.SynthesisAdditionType.attribute?(o.tm("\u63cf\u8ff0").text=r.desc,o.tm("\u5f53\u524d\u5c5e\u6027").text=r.nowValue.toString(),o.tm("\u52a0\u6210").text=r.additionValue.toString()):o.tm("\u6280\u80fd\u63cf\u8ff0").text=r.skilldesc})},e.prototype.InitListener=function(){var t=this,e=this.ModelMgr.ModelVO.VOEquipBag.CreateSubset();this.equipSubSet=e,e=this.ModelMgr.ModelVO.VOItemBag.CreateSubset(),this.itemSubSet=e,this.toolSet.addListener(this.equipSubSet.GetEventProxy(),"OnChanged",this.updateListData,this),this.toolSet.addListener(this.itemSubSet.GetEventProxy(),"OnChanged",this.updateListData,this),this.toolSet.addDefer(function(){t.itemSubSet&&(t.ModelMgr.ModelVO.VOItemBag.DestroySubset(t.itemSubSet),t.itemSubSet=null),t.equipSubSet&&(t.ModelMgr.ModelVO.VOEquipBag.DestroySubset(t.equipSubSet),t.equipSubSet=null)})},e.prototype.updateListData=function(){var t,e,r,o,n,i,a=this;this.log("ss"),this.listData=[],this.tmPutMaterial?(this.tmPutMaterial.clear(),this.com.setSelectedPage("\u662f\u5426\u53ef\u4ee5\u5408\u6210","\u5426")):this.tmPutMaterial=new Map;var l=this.selectType;if(this.selectEquip&&(l=this.selectEquip.GetGoodsType()-m.EGoodsType.weapon+1),null==this.tmEquip?this.tmEquip=new Map:this.tmEquip.clear(),null==this.tmSelfEquip?this.tmSelfEquip=new Map:this.tmSelfEquip.clear(),null==this.tmMaterials?this.tmMaterials=new Map:this.tmMaterials.clear(),null==this.lastSelectType||this.lastSelectType!=l){this.lastSelectType=l,this.equipSubSet.SetFilter(function(t){var e=a.ModelMgr.ModelEquipSynthesis.GetRefSynthesisByEquip(t);if(null==e)return!1;if(6==e.mainQuality||6==t.GetQuality())return!1;switch(l){case u.all:return!0;case u.weapon:return t.GetGoodsType()==m.EGoodsType.weapon;case u.armor:return t.GetGoodsType()==m.EGoodsType.armor;case u.amulet:return t.GetGoodsType()==m.EGoodsType.amulet;case u.belt:return t.GetGoodsType()==m.EGoodsType.belt;case u.glove:return t.GetGoodsType()==m.EGoodsType.glove;case u.shoe:return t.GetGoodsType()==m.EGoodsType.shoe}return!1});var c=this.ModelMgr.ModelGoodsBag.GetTlGoodsTypeByTlShowBag([m.ShowBagType.itemBag_EquipMaterials]);this.itemSubSet.SetFilter(function(t){if(c.has(t.GetGoodsType()))switch(l){case u.all:return!0;default:var e=a.ModelMgr.ModelEquipSynthesis.GetRefGeneralMaterialsByRefId(t.GetRefId());if(null!=e&&e.type-m.EGoodsType.weapon+1==l)return!0}return!1})}n=this.equipSubSet.GetTlVO(),this.log("listEquip:",n.length);try{for(var p=s(n),f=p.next();!f.done;f=p.next()){var h=f.value;if(g=this.ModelMgr.ModelEquipSynthesis.GetIndexByEquip(h)){var y=this.tmEquip.get(g)||0;this.tmEquip.set(g,y+1)}var d=this.ModelMgr.ModelEquipSynthesis.GetSelfIndexByEquip(h);d&&(y=this.tmSelfEquip.get(d)||0,this.tmSelfEquip.set(g,y+1)),this.listData.push(h)}}catch(w){t={error:w}}finally{try{f&&!f.done&&(e=p.return)&&e.call(p)}finally{if(t)throw t.error}}i=this.itemSubSet.GetTlVO();try{for(var _=s(i),S=_.next();!S.done;S=_.next()){var g,b=S.value;(g=this.ModelMgr.ModelEquipSynthesis.GetIndexByMaterialsRefId(b.GetRefId()))&&(y=this.tmMaterials.get(g)||0,this.tmMaterials.set(g,y+b.GetNumber()));for(var C=b.GetNumber(),R=0;R<C;R++){var M=this.ModelMgr.ModelGoods.CreateGoods(b.GetRefId());M.InitByCmd(b.GetCmd()),M.SetId(M.GetRefId()+"_"+R),this.listData.push(M)}}}catch(O){r={error:O}}finally{try{S&&!S.done&&(o=_.return)&&o.call(_)}finally{if(r)throw r.error}}this.selectEquip?this.listData.sort(function(t,e){var r=a.CanUseBySyntheticMaterial(t)?1:0,o=a.CanUseBySyntheticMaterial(e)?1:0;if(r!=o)return o-r;if(1==r&&1==o){if((r=t instanceof v.VOEquip?1:0)!=(o=e instanceof v.VOEquip?1:0))return r-o}else if((r=t instanceof v.VOEquip?1:0)!=(o=e instanceof v.VOEquip?1:0))return o-r;return(r=t.GetQuality())!=(o=e.GetQuality())?o-r:t instanceof v.VOEquip&&e instanceof v.VOEquip&&(r=t.GetPhase())!=(o=e.GetPhase())?o-r:(r=t.GetGoodsType())!=(o=e.GetGoodsType())?r-o:(r=t.GetId())!=(o=e.GetId())?r-o:-1}):(this.tmCanSynthesis?this.tmCanSynthesis.clear():this.tmCanSynthesis=new Map,this.listData.sort(function(t,e){var r=t instanceof v.VOEquip?1:0,o=e instanceof v.VOEquip?1:0;return r!=o?o-r:(r=a.CheckCanSynthesis(t)?1:0)!=(o=a.CheckCanSynthesis(e)?1:0)?o-r:(r=t.GetQuality())!=(o=e.GetQuality())?o-r:t instanceof v.VOEquip&&e instanceof v.VOEquip&&(r=t.GetPhase())!=(o=e.GetPhase())?o-r:(r=t.GetGoodsType())!=(o=e.GetGoodsType())?r-o:(r=t.GetId())!=(o=e.GetId())?r-o:-1})),this.com.tm("\u5408\u6210\u5217\u8868").update(this.listData),this.UpdateSynthesicInfo()},e.prototype.RefreshList=function(){this.isEnter&&this.com.tm("\u5408\u6210\u5217\u8868").refreshVirtualList()},e.prototype.CheckCanSynthesis=function(t){var e,r,o,n,i,a;if(t instanceof v.VOEquip==0)return!1;var l=t,u=this.tmCanSynthesis.get(l.GetId());if(null!=u)return u;var p=this.ModelMgr.ModelEquipSynthesis.GetRefSynthesisByEquip(l);if(p){this.tmNeedNum.clear(),this.tmNeedNumSelf.clear();var f=this.ModelMgr.ModelEquipSynthesis.GetSelfIndexByEquip(l),h=this.ModelMgr.ModelEquipSynthesis.GetIndexByEquip(l);this.tmNeedNumSelf.set(f,1),this.tmNeedNum.set(h,1);try{for(var y=s(p.tlMaterial),d=y.next();!d.done;d=y.next()){var m=d.value;if(1==m.type){var _=this.ModelMgr.ModelEquipSynthesis.GetIndex(l.GetRefId(),m.quality,m.phase),S=this.tmNeedNumSelf.get(_)||0;S+=1,this.tmNeedNumSelf.set(_,S)}else 2==m.type&&(_=this.ModelMgr.ModelEquipSynthesis.GetIndex(l.GetGoodsType(),m.quality,m.phase),S=this.tmNeedNum.get(_)||0,S+=1,this.tmNeedNum.set(_,S))}}catch(x){e={error:x}}finally{try{d&&!d.done&&(r=y.return)&&r.call(y)}finally{if(e)throw e.error}}var g=!0;try{for(var b=s(this.tmNeedNum),C=b.next();!C.done;C=b.next()){var R=c(C.value,2),M=R[0],w=(S=R[1],this.tmEquip.get(M)||0),O=this.tmMaterials.get(M)||0;if(this.log("11needNum:",S),this.log("11haveNum1 + haveNum2:",w+O),S>w+O){g=!1;break}}}catch(T){o={error:T}}finally{try{C&&!C.done&&(n=b.return)&&n.call(b)}finally{if(o)throw o.error}}try{for(var B=s(this.tmNeedNumSelf),P=B.next();!P.done;P=B.next()){var G=c(P.value,2),k=(M=G[0],S=G[1],this.tmSelfEquip.get(M)||0);if(this.log("22needNum:",S),this.log("22haveNum:",k),S>k){g=!1;break}}}catch(j){i={error:j}}finally{try{P&&!P.done&&(a=B.return)&&a.call(B)}finally{if(i)throw i.error}}return this.tmCanSynthesis.set(l.GetId(),g),g}return this.tmCanSynthesis.set(l.GetId(),!1),!1},e.prototype.CanUseBySyntheticMaterial=function(t,e){var r,o;e||(e=this.selectEquip);var n=this.ModelMgr.ModelEquipSynthesis.GetRefSynthesisByEquip(e);if(!n)return!1;try{for(var i=s(n.tlMaterial),a=i.next();!a.done;a=i.next()){var l=a.value;if(1==l.type){if(t instanceof v.VOEquip==0)return!1;var c=this.ModelMgr.ModelEquipSynthesis.GetIndex(e.GetRefId(),l.quality,l.phase),u=t;if(this.ModelMgr.ModelEquipSynthesis.GetIndex(u.GetRefId(),u.GetQuality(),u.GetPhase())==c)return!0}else if(2==l.type)if(c=this.ModelMgr.ModelEquipSynthesis.GetIndex(e.GetGoodsType(),l.quality,l.phase),t instanceof v.VOEquip==0){if(c==this.ModelMgr.ModelEquipSynthesis.GetIndexByMaterialsRefId(t.GetRefId()))return!0}else if(u=t,this.ModelMgr.ModelEquipSynthesis.GetIndex(u.GetGoodsType(),u.GetQuality(),u.GetPhase())==c)return!0}}catch(p){r={error:p}}finally{try{a&&!a.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return!1},e.prototype.GetMaterial=function(t){if(null!=this.selectEquip){var e;if(1==t.type)(e=this.ModelMgr.ModelGoods.CreateGoods(this.selectEquip.GetRefId())).InitByCmd(this.selectEquip.GetCmd()),e.SetQuality(t.quality),e.SetPhase(t.phase||0);else{var r=this.ModelMgr.ModelEquipSynthesis.GetRefGeneralMaterials(this.selectEquip.GetGoodsType(),t.quality).itemId;e=this.ModelMgr.ModelGoods.CreateGoods(r)}return e}},e.prototype.UpdateSynthesicInfo=function(){var t=this,e=t.com;if(e.setSelectedPage("\u5408\u6210\u72b6\u6001",this.selectEquip?"\u5408\u6210\u4e2d":"\u672a\u5408\u6210"),this.UpdateTargetEquip(),this.selectEquip){var r=this.ModelMgr.ModelEquipSynthesis.GetRefSynthesisByEquip(this.selectEquip);if(!r)return;e.setSelectedPage("\u6750\u6599\u957f\u5ea6",r.tlMaterial.length.toString()),e.tm("\u9700\u5408\u6210\u88c5\u5907").tm("item").UpdateByGoods(this.selectEquip),e.tm("\u5408\u6210_\u88c5\u5907").tm("item").UpdateByGoods(this.targetEquip);var o=r.tlMaterial.length.toString(),n=r.tlMaterial[0],i=1==n.type&&n.phase||0,a=this.ModelMgr.ModelGoods.GetQualityName(n.quality,i),l=this.GetMaterial(n).GetName(),s=t.com.tm("\u5bcc\u6587\u672c_\u9700\u6c42\u6750\u6599").asTextField;s.setVar("len",o),s.setVar("name",a+l),s.flushVars(),t.com.tm("\u6587\u672c_\u88c5\u5907\u540d\u79f0").text=this.targetEquip.GetName();var c=e.tm("\u5217\u8868_\u63d0\u5347"),u=this.ModelMgr.ModelEquipSynthesis.GetAdditionData(this.selectEquip,this.targetEquip);c.update(u)}else e.tm("\u9700\u5408\u6210\u88c5\u5907").tm("item").UpdateByGoods(null);this.UpdateMaterialSlot()},e.prototype.UpdateTargetEquip=function(){if(null!=this.selectEquip){var t=this.ModelMgr.ModelGoods.CreateGoods(this.selectEquip.GetRefId());t.InitByCmd(this.selectEquip.GetCmd());var e=this.ModelMgr.ModelEquip.GetNextStage(this.selectEquip.GetGoodsType(),this.selectEquip.GetQuality(),this.selectEquip.GetPhase());e&&(t.SetQuality(e.quality),t.SetPhase(e.phase),this.targetEquip=t)}else this.targetEquip=null},e.prototype.UpdateMaterialSlot=function(){if(null!=this.selectEquip){var t=this.ModelMgr.ModelEquipSynthesis.GetRefSynthesisByEquip(this.selectEquip);if(null!=t){this.com.setSelectedPage("\u6750\u6599\u957f\u5ea6",t.tlMaterial.length.toString());for(var e=1;e<=t.tlMaterial.length;e++){var r=this.com.tm("\u6750\u6599"+e),o=this.tmPutMaterial.get(e);r.setSelectedPage("\u865a\u5316",null==o?"\u662f":"\u5426");var n=r.tm("item"),i=this.com.tm("\u6750\u6599"+e+"_\u63cf\u8ff0").asTextField;if(o){n.UpdateByGoods(o);var a=o instanceof v.VOEquip?o.GetPhase():0,l=this.ModelMgr.ModelGoods.GetQualityName(o.GetQuality(),a)+o.GetName();i.text=l}else{var s=this.GetMaterial(t.tlMaterial[e-1]);n.UpdateByGoods(s),l=this.ModelMgr.ModelGoods.GetQualityName(s.GetQuality(),0)+s.GetName(),i.text=l}n.GetBehavior().onNumberVisible(!1)}this.tmPutMaterial.size==t.tlMaterial.length?this.com.setSelectedPage("\u662f\u5426\u53ef\u4ee5\u5408\u6210","\u662f"):this.com.setSelectedPage("\u662f\u5426\u53ef\u4ee5\u5408\u6210","\u5426")}}},e.prototype.OnclickSynthesisBtn=function(){var t,e,r=this,o=[];o.push(this.selectEquip.GetId());var n=!1;try{for(var i=s(this.tmPutMaterial),a=i.next();!a.done;a=i.next()){var l=c(a.value,2),u=(l[0],l[1]);u instanceof v.VOEquip?(this.ModelMgr.ModelEquip.GetIsSEquip(u.GetRefId())&&(n=!0),o.push(u.GetId())):o.push(u.GetRefId())}}catch(y){t={error:y}}finally{try{a&&!a.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}var f=this.ModelMgr.ModelEquip.GetNextStage(this.selectEquip.GetGoodsType(),this.selectEquip.GetQuality(),this.selectEquip.GetPhase());if(n)this.LayerShowTip.SetData({context:p.FW.G_W("\u672c\u6b21\u5408\u6210\u4e2d\u6709S\u7ea7\u88c5\u5907\uff0c\u786e\u5b9a\u8981\u62ff\u6765\u5408\u6210\u5417\uff1f"),sumitFuncion:function(){var t={resId:r.targetEquip.GetId(),quality:f.quality,phase:f.phase,nid:o};r.RequestSynthesis(t)}}),this.LayerShowTip.load();else{var h={resId:this.targetEquip.GetId(),quality:f.quality,phase:f.phase,nid:o};this.RequestSynthesis(h)}},e.prototype.OnclickItemOnNoSynthesis=function(t){t instanceof v.VOEquip&&(this.selectEquip=t,this.updateListData())},e.prototype.OnclickItemOnSynthesis=function(t){var e,r;if(this.canClick){var o=t.GetId();if(o==this.selectEquip.GetId())return this.selectEquip=null,void this.updateListData();try{for(var n=s(this.tmPutMaterial),i=n.next();!i.done;i=n.next()){var a=c(i.value,2),l=a[0];if(a[1].GetId()==o)return this.tmPutMaterial.delete(l),this.UpdateMaterialSlot(),void this.RefreshList()}}catch(h){e={error:h}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}if(this.CanUseBySyntheticMaterial(t)){for(var u=this.ModelMgr.ModelEquipSynthesis.GetRefSynthesisByEquip(this.selectEquip),f=1;f<=u.tlMaterial.length;f++)if(null==this.tmPutMaterial.get(f))return this.tmPutMaterial.set(f,t),this.UpdateMaterialSlot(),void this.RefreshList();p.FW.showTip(p.FW.G_W("\u6ca1\u6709\u4f4d\u7f6e\u53ef\u4ee5\u653e\u5165\u4e86~"))}}else p.FW.showTip(p.FW.G_W("\u52aa\u529b\u5408\u6210\u4e2d\uff0c\u8bf7\u7a0d\u7b49"))},e.prototype.OnclicSelectSlot=function(){this.selectEquip=null,this.updateListData()},e.prototype.OnclicSynthesisSlot=function(){this.targetEquip&&(this.LayerItemDetail.load(),this.LayerItemDetail.SetEquip(this.targetEquip),this.LayerItemDetail.SetOpenPosition(g.OpenPosition.synthesis))},e.prototype.OnclickMaterial=function(t){this.tmMaterials.get(t)&&(this.tmMaterials.set(t,null),this.UpdateMaterialSlot(),this.RefreshList())},e.prototype.RequestSynthesis=function(t){return a(this,void 0,void 0,function(){var e,r,o,n=this;return l(this,function(i){switch(i.label){case 0:return this.canClick=!1,this.selectEquip.SetQuality(this.selectEquip.GetQuality()),this.selectEquip.SetPhase(this.selectEquip.GetPhase()),[4,this.ModelMgr.ModelEquipSynthesis.RequestEquipSynthesis(t)];case 1:return i.sent(),e=this.selectEquip.GetQuality(),r=this.selectEquip.GetPhase(),o=this.ModelMgr.ModelEquipSynthesis.GetRefSynthesisByQuilaty(e,r),this.com.tm("\u7279\u6548").visible=!0,this.com.tm("\u7279\u6548").asCom.setSelectedPage("\u6750\u6599\u957f\u5ea6",o.tlMaterial.length.toString()),this.com.tm("\u7279\u6548").asCom.tmt("\u7279\u6548_\u88c5\u5907\u5408\u6210").play(function(){var t=n.ModelMgr.ModelEquipSynthesis.GetAdditionData(n.selectEquip,n.targetEquip);n.LayerSynthesisDisplay.load(),n.LayerSynthesisDisplay.SetGoods(n.targetEquip),n.LayerSynthesisDisplay.SetListData(t),n.selectEquip.SetPhase(-1),n.selectEquip.SetQuality(n.targetEquip.GetQuality()),n.selectEquip=null,n.updateListData(),n.ModelMgr.ModelHero.eventCallBack.execute(),n.canClick=!0}),[2]}})})},e.prototype.RequestOneKeySynthesis=function(){var t,e,r=this,o=this.equipSubSet.GetTlVO(),n=!1;try{for(var i=s(o),a=i.next();!a.done;a=i.next()){var l=a.value;if(l.GetQuality()<4&&this.checkSynthesis(l)){n=!0;break}}}catch(c){t={error:c}}finally{try{a&&!a.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}n?(this.canClick=!1,this.ModelMgr.ModelEquipSynthesis.RequestEquipSynthesisOneKey().then(function(){r.canClick=!0}).catch(function(){r.canClick=!0})):(this.LayerShowTip.SetData({context:p.FW.G_W("\u4f60\u8fd8\u6ca1\u6709\u7d2b\u8272\u54c1\u8d28\u4ee5\u4e0b\u7684\u88c5\u5907\u7528\u4f5c\u5408\u6210!")}),this.LayerShowTip.load())},e.prototype.checkSynthesis=function(t){var e,r,o,n,i=this.ModelMgr.ModelEquipSynthesis.GetRefSynthesisByEquip(t).tlMaterial,a=0;try{for(var l=s(this.equipSubSet.GetTlVO()),c=l.next();!c.done;c=l.next()){var u=c.value;!this.CanUseBySyntheticMaterial(u,t)&&t.GetId()==u.GetId()||u.GetIsPutOn()||(a+=1)}}catch(y){e={error:y}}finally{try{c&&!c.done&&(r=l.return)&&r.call(l)}finally{if(e)throw e.error}}try{for(var p=s(this.itemSubSet.GetTlVO()),f=p.next();!f.done;f=p.next()){var h=f.value;this.CanUseBySyntheticMaterial(h,t)&&(a+=h.GetNumber())}}catch(d){o={error:d}}finally{try{f&&!f.done&&(n=p.return)&&n.call(p)}finally{if(o)throw o.error}}return this.log("aanum:",a),a>=i.length},e.__cname="LayerEquipSynthesisUI",i([f.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([f.injectField("LayerShowTip")],e.prototype,"LayerShowTip",void 0),i([f.injectField("LayerSynthesisDisplay")],e.prototype,"LayerSynthesisDisplay",void 0),i([f.injectField("LayerItemDetail")],e.prototype,"LayerItemDetail",void 0),e}(S.GameLayerUI);r.LayerEquipSynthesisUI=C,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/container/Container":void 0,"../../../../framework/layer/common/UIOrder":void 0,"../../model/Hero/ModelEquipSynthesis":"ModelEquipSynthesis","../../model/System/ModelSystem":"ModelSystem","../../model/vo/Goods/Goods":"Goods","../../model/vo/Goods/VOEquip":"VOEquip","../../model/vo/Goods/VOItem":"VOItem","../../ui/GameLayer":"GameLayer","./LayerItemDetail":"LayerItemDetail"}],LayerEveryDaySignIn:[function(t,e,r){"use strict";cc._RF.push(e,"6b120BqyZ9Bza6/xeyf4a9H","LayerEveryDaySignIn");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerEveryDaySignInUI=r.LayerEveryDaySignIn=void 0;var s=t("../../../../framework/FW"),c=t("../../../../framework/container/Container"),u=t("../../../../framework/layer/common/UIOrder"),p=t("../../model/System/ModelSystem"),f=t("../../ui/GameLayer"),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return y},e.prototype.getUrl=function(){return"ui://\u6bcf\u65e5\u7b7e\u5230/\u7ec4\u4ef6_\u6bcf\u65e5\u7b7e\u5230_\u4e3b\u754c\u9762"},e.prototype.getSortOrder=function(){return u.LayerOrder.TowLevel},e.prototype.getSystemId=function(){return p.SystemId.EveryDaySignIn},e.__cname="LayerEveryDaySignIn",e}(f.GameLayerProxy);r.LayerEveryDaySignIn=h;var y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getHasBackground=function(){return!0},e.prototype.GetHasCloseAnimation=function(){return!0},e.prototype.GetHasShowAnimation=function(){return!0},e.prototype.getIsFull=function(){return!1},e.prototype.getFloatNode=function(){return this.com.tm("panel_bg")},e.prototype.init=function(){var t=this;this.com.toFullCenterParent(this.container),this.toolSet.addListener(this.modelMgr.ModelEveryDaySignIn.GetEventProxy(),"OnUpdate",function(){t.UpdateData()},this),this.toolSet.addListener(this.modelMgr.ModelEveryDaySignIn.GetEventProxy(),"UnLoad",function(){t.proxy.isLoad&&t.unload()},this),this.toolSet.addTimer(1,function(){t.UpdateTime()}),this.UpdateTime(),this.com.tm("panel_bg.\u6309\u94ae_\u5173\u95ed").setClick(function(){t.unload()},this),this.com.tm("\u6309\u94ae_\u7b7e\u5230").setClick(function(){t.modelMgr.ModelEveryDaySignIn.ReqestSignIn()},this)},e.prototype.enterAsync=function(){return a(this,void 0,Promise,function(){return l(this,function(t){switch(t.label){case 0:return[4,this.modelMgr.ModelEveryDaySignIn.ReqestInfo()];case 1:return t.sent(),[2]}})})},e.prototype.enter=function(){this.UpdateData()},e.prototype.UpdateData=function(){var t=this.modelMgr.ModelEveryDaySignIn.GetEverySignIn();null!=t&&null!=t.days?(this.day=t.days,this.tlEveryDaySignInReward=t.tlEveryDaySignInReward||[],this.UpdateView()):this.unload()},e.prototype.UpdateView=function(){var t=this,e=this.day,r=this.tlEveryDaySignInReward;this.com.tm("text_day").setVar("value",e.toString()).flushVars();for(var o=10-(r[r.length-1].day-e),n=function(e){var o=i.com.tm("\u7ec4\u4ef6_\u5b9d\u7bb1"+(e+1)).asCom;if(o){var n=r[e];o.tm("title").text=n.day.toString(),o.setSelectedIndex("\u72b6\u6001",n.state),o.setClick(function(){1==n.state?t.modelMgr.ModelEveryDaySignIn.RequestEveryDayGetRewards(n.day):(t.LayerRewardDetail.SetGObjTarget(o),t.LayerRewardDetail.SetHostCom(t.container),t.LayerRewardDetail.SetTlCmdGoods(n.tlCmdGoods),t.LayerRewardDetail.load())},i)}},i=this,a=0;a<r.length;a++)n(a);var l=this.com.tm("\u8fdb\u5ea6\u6761").asProgress;l.min=0,l.max=10,l.value=o;var c=e%7,u=this.modelMgr.ModelVO.VORoleBag.GetOne().GetSignTime(),p=!1,f=this.modelMgr.ModelTime.getNowTempDate().getTime();f&&u&&u>f&&(p=!0),s.FW.LWX.log("ZERO:",f),s.FW.LWX.log("signTime:",u),this.com.setSelectedPage("\u5df2\u7b7e\u5230",p?"\u662f":"\u5426"),0==c&&p&&(c=7);var h,y=function(e,r,o){var n=r.tm("item"),i=t.ModelMgr.ModelGoods.CreateGoods(o.resId);i.SetNumber(o.number),n.UpdateByGoods(i),n.ClickItem(!0,i,t.proxy),1==h&&r.tm("effect").SetUrlByIcon("\u7279\u6548_\u767e\u604b_\u7b7e\u5230\u5956\u52b1"),r.tm("effect").visible=1==h,n.GetBehavior().onGrayUpdate(2==h)};for(a=1;a<8;a++){var d=this.com.tm("\u7ec4\u4ef6_\u7b7e\u5230"+a).asCom;d.setSelectedIndex("\u72b6\u6001",a<=c?1:0),h=a<=c?2:p||a!=c+1?0:1,d.setSelectedIndex("\u9886\u53d6\u72b6\u6001",h);var m=this.modelMgr.ModelEveryDaySignIn.GetRef(a).reward,v=d.tm("list");v.init(this,y),v.update(m)}},e.prototype.UpdateTime=function(){var t=this.timeUtil.timeSec2HMSStr12(0);this.com.tm("text_time").setVar("time",t).flushVars()},e.__cname="LayerEveryDaySignInUI",i([c.injectField("TimeUtil")],e.prototype,"timeUtil",void 0),i([c.injectField("ModelMgr")],e.prototype,"modelMgr",void 0),i([c.injectField("LayerRewardDetail")],e.prototype,"LayerRewardDetail",void 0),i([c.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(f.GameLayerUI);r.LayerEveryDaySignInUI=y,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/container/Container":void 0,"../../../../framework/layer/common/UIOrder":void 0,"../../model/System/ModelSystem":"ModelSystem","../../ui/GameLayer":"GameLayer"}],LayerFightGuide:[function(t,e,r){"use strict";cc._RF.push(e,"2e722esmM5OFZFjWs4tRuIk","LayerFightGuide");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.LayerFightGuideUI=r.LayerFightGuide=void 0;var i=t("../../../../../../framework/event/EventProxy"),a=t("../../../../../../framework/layer/common/UIOrder"),l=t("../../../../ui/GameLayer"),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.eventproxy=new i.EventProxy,e}return n(e,t),e.prototype.getUrl=function(){return"ui://\u6218\u6597/\u7ec4\u4ef6_\u6218\u6597\u5c42_\u5f15\u5bfc"},e.prototype.getUIClass=function(){return c},e.prototype.GetEventproxy=function(){return this.eventproxy},e.prototype.getSortOrder=function(){return a.LayerOrder.Main},e.__cname="LayerFightGuide",e}(l.GameLayerProxy);r.LayerFightGuide=s;var c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getHasBackground=function(){return!1},e.prototype.enter=function(){this.com.setSelectedPage("\u64ad\u653e\u52a8\u753b","\u5426"),this.com.setSelectedPage("\u64ad\u653e\u52a8\u753b","\u662f")},e.prototype.init=function(){this.com.toFullCenterParent(this.container)},e.__cname="LayerFightGuideUI",e}(l.GameLayerUI);r.LayerFightGuideUI=c,cc._RF.pop()},{"../../../../../../framework/event/EventProxy":void 0,"../../../../../../framework/layer/common/UIOrder":void 0,"../../../../ui/GameLayer":"GameLayer"}],LayerFirstRecharge:[function(t,e,r){"use strict";cc._RF.push(e,"82bcc9jk0hFGZjjOnO1q9m6","LayerFirstRecharge");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerFirstRechargeUI=r.LayerFirstRecharge=void 0;var s=t("../../../../framework/FW"),c=t("../../../../framework/container/Container"),u=t("../../../../framework/layer/PopLayerMgr"),p=t("../../../../framework/layer/common/UIOrder"),f=t("../../../generated/requestMsg/RequestFirstRechargeMsg"),h=t("../../model/System/ModelSystem"),y=t("../../model/vo/Goods/VOEquip"),d=t("../../model/vo/Goods/VOItem"),m=t("../../model/vo/Goods/VORune"),v=t("../../ui/GameLayer"),_=t("../alert/CtrlAlert"),S=t("../main/Hero/Rune/LayerRuneDetails"),g=t("../main/LayerItemDetail"),b=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return C},e.prototype.getUrl=function(){return"ui://\u5145\u503c\u529f\u80fd_\u9996\u5145/\u7ec4\u4ef6_\u9996\u5145_\u4e3b\u754c\u9762"},e.prototype.getSortOrder=function(){return p.LayerOrder.OneLevel},e.prototype.getSystemId=function(){return h.SystemId.FirstRecharge},e.__cname="LayerFirstRecharge",e}(v.GameLayerProxy);r.LayerFirstRecharge=b;var C=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.refInfo=null,e}return n(e,t),e.prototype.getHasBackground=function(){return!0},e.prototype.init=function(){var t=this;this.com.toFullCenterParent(this.container),this.toolSet.addListener(this.modelMgr.ModelVO.VORoleBag.GetEventProxy(),"OnChanged",function(){t.UpdateLayer()})},e.prototype.enter=function(){var t=this;this.InitGList(),this.InitClick(),this.InitParticle();var e=[];e.push(this.Ref.RefMgrfirstRecharge.preloadRef()),Promise.all(e).then(function(){t.refInfo=t.Ref.RefMgrfirstRecharge.getRefAll()[0],t.RequestFirstRechargeOpen(),t.UpdateLayer()})},e.prototype.RequestFirstRechargeOpen=function(){this.CtrlGameNet.send(new f.RequestFirstRechargeOpen({},this,function(){}))},e.prototype.InitClick=function(){var t=this,e=this,r=e.com;r.tm("\u6309\u94ae_\u5173\u95ed").setClick(function(){t.unload()},this),e.setFairyBtnEvent(r.tm("\u6309\u94ae_\u8df3\u8f6c"),function(){return a(t,void 0,void 0,function(){var t,r,o=this;return l(this,function(n){switch(n.label){case 0:return 0!=(t=e.modelMgr.ModelRole.GetRole().GetFirstRecharge())?[3,1]:(this.unload(),this.ctrlMgr.JumpLayer(7),[3,4]);case 1:return 1!=t?[3,3]:(r={resId:e.refInfo.resId},[4,this.CtrlGameNet.send(new f.RequestFirstRechargeReward(r,this,function(t){var r=e.modelMgr.ModelRole.GetRole().GetFirstRecharge();u.PopLayerMgr.inst().AddLayer(o,o.CtrlAlert.LayerHeroGet,function(){o.CtrlAlert.LayerHeroGet.SetHero(400004),o.CtrlAlert.LayerHeroGet.load()}),o.ctrlMgr.CtrlAlert.ShowGetReward(t.tlCmdGoods,!0),2!=r?e.UpdateLayer():o.unload()}))]);case 2:return n.sent(),[3,4];case 3:2==t&&e.CtrlAlert.LayerMessage.addMessage(s.FW.G_W("\u5956\u52b1\u5df2\u9886\u53d6~")),n.label=4;case 4:return[2]}})})})},e.prototype.InitParticle=function(){this.com.tm("\u88c5\u8f7d\u5668_\u56db\u5468\u706b\u7130").SetUrlByModel(_.particlesMap.get("\u56db\u5468\u6269\u6563\u706b\u7130\u7c92\u5b50"))},e.prototype.InitGList=function(){var t=this,e=this;e.com.tm("\u5217\u8868_\u9996\u5145\u5956\u52b1").asList.init(e,function(t,r,o){var n=r.tm("item"),i=e.modelMgr.ModelGoods.CreateGoodsByCmd(o);n.UpdateByGoods(i)},function(r,o,n){var i=e.modelMgr.ModelGoods.CreateGoodsByCmd(n);if(i instanceof y.VOEquip){var a=i;e.ctrlMain.LayerItemDetail.load(),e.ctrlMain.LayerItemDetail.SetEquip(a),e.ctrlMain.LayerItemDetail.SetOpenPosition(g.OpenPosition.synthesis)}else if(i instanceof m.VORune){var l=i;e.ctrlMain.LayerRuneDetails.SetData({rune:l}),e.ctrlMain.LayerRuneDetails.SetViewType(S.RuneDetailsViewType.noShowButon),e.ctrlMain.LayerRuneDetails.load()}else i instanceof d.VOItem?o.tm("item").GetBehavior().showTips(i,t.proxy):s.FW.LWX.log("\u8bf7\u68c0\u67e5\u662f\u5426\u662f\u65b0\u7684\u9053\u5177\u7c7b\u578b")})},e.prototype.UpdateLayer=function(){var t=this,e=t.com,r=t.modelMgr.ModelRole.GetRole().GetFirstRecharge();e.setSelectedIndex("\u9996\u5145\u72b6\u6001",r),e.tm("\u6587\u672c_\u9996\u5145\u63cf\u8ff0").text=t.refInfo.desc;var o=t.refInfo.rewards;if(e.tm("\u5217\u8868_\u9996\u5145\u5956\u52b1").asList.update(o),"-1"!=t.refInfo.icon){var n=t.refInfo.icon.split("|");e.tm("\u88c5\u8f7d\u5668_\u82f1\u96c4").SetUrlByIcon(n[0]),e.tm("\u88c5\u8f7d\u5668_\u82f1\u96c4\u540d\u79f0").SetUrlByIcon(n[1])}},e.__cname="LayerFirstRechargeUI",i([c.injectField("Ref")],e.prototype,"Ref",void 0),i([c.injectField("ModelMgr")],e.prototype,"modelMgr",void 0),i([c.injectField("CtrlGameNet")],e.prototype,"CtrlGameNet",void 0),i([c.injectField("CtrlMain")],e.prototype,"ctrlMain",void 0),i([c.injectField("CtrlMgr")],e.prototype,"ctrlMgr",void 0),i([c.injectField("CtrlAlert")],e.prototype,"CtrlAlert",void 0),e}(v.GameLayerUI);r.LayerFirstRechargeUI=C,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/container/Container":void 0,"../../../../framework/layer/PopLayerMgr":void 0,"../../../../framework/layer/common/UIOrder":void 0,"../../../generated/requestMsg/RequestFirstRechargeMsg":"RequestFirstRechargeMsg","../../model/System/ModelSystem":"ModelSystem","../../model/vo/Goods/VOEquip":"VOEquip","../../model/vo/Goods/VOItem":"VOItem","../../model/vo/Goods/VORune":"VORune","../../ui/GameLayer":"GameLayer","../alert/CtrlAlert":"CtrlAlert","../main/Hero/Rune/LayerRuneDetails":"LayerRuneDetails","../main/LayerItemDetail":"LayerItemDetail"}],LayerFund:[function(t,e,r){"use strict";cc._RF.push(e,"db9d2L6y9hGh6E7Jczh5czJ","LayerFund");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},c=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerFundUI=r.LayerFund=void 0;var u=t("../../../../framework/FW"),p=t("../../../../framework/container/Container"),f=t("../../../../framework/layer/common/UIOrder"),h=t("../../../../framework/utils/StringUtil"),y=t("../../model/System/ModelSystem"),d=t("../../model/fund/ModelFund"),m=t("../../model/pay/BuyPayObj"),v=t("../../ui/GameLayer"),_=new Map;_.set(d.FundType.GrowUp,"\u6309\u94ae_\u6210\u957f\u57fa\u91d1"),_.set(d.FundType.Elite,"\u6309\u94ae_\u7cbe\u82f1\u57fa\u91d1"),_.set(d.FundType.Expert,"\u6309\u94ae_\u4e13\u5bb6\u57fa\u91d1");var S=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return g},e.prototype.getUrl=function(){return"ui://\u5145\u503c\u529f\u80fd_\u57fa\u91d1/\u7ec4\u4ef6_\u57fa\u91d1_\u4e3b\u754c\u9762"},e.prototype.getSortOrder=function(){return f.LayerOrder.OneLevel},e.prototype.getSystemId=function(){return y.SystemId.Fund},e.__cname="LayerFund",e}(v.GameLayerProxy);r.LayerFund=S;var g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.fundType=d.FundType.GrowUp,e.isFirstOpen=!0,e.isBusy=!1,e}return n(e,t),e.prototype.getHasBackground=function(){return!0},e.prototype.init=function(){var t=this;this.com.toFullCenterParent(this.container),this.InitClick(),this.InitGlist(),this.toolSet.addListener(this.modelMgr.ModelFund.GetEventProxy(),"OnUpdateFund",function(){t.UpdateView()})},e.prototype.enterAsync=function(){return a(this,void 0,Promise,function(){return l(this,function(t){switch(t.label){case 0:return[4,this.modelMgr.ModelFund.RequestFundGetInfo()];case 1:return t.sent(),[2]}})})},e.prototype.enter=function(){this.UpdateView()},e.prototype.InitGlist=function(){var t=this,e=this;e.com.tm("\u5217\u8868_\u5956\u52b1").asList.init(e,function(r,o,n){var i=o,s="[roleLevel:"+n.roleLlvel+"]",c=u.FW.ExprMgr.GetResult(s);i.grayed=!c,i.tm("\u6587\u672c_\u7b49\u7ea7").text=String(n.roleLlvel),i.setSelectedIndex("\u662f\u5426\u9690\u85cf\u8fdb\u5ea6\u6761",0==r?1:0);for(var p=["\u7ec4\u4ef6_\u5956\u52b11","\u7ec4\u4ef6_\u5956\u52b12","\u7ec4\u4ef6_\u5956\u52b13"],f=function(r){if(n.rewards[r]){var o=n.rewards[r].ref,s=e.modelMgr.ModelFund.GetRewardStateByResId(o.resId),f=i.tm(p[r]),y=f.tm("item"),d=t.modelMgr.ModelGoods.CreateGoodsByCmd(o.reward[0]);y.UpdateByGoods(d),f.setSelectedIndex("\u5956\u52b1\u72b6\u6001",s),y.GetBehavior().onGrayUpdate(!c||2==s),e.setFairyGobjEvent(y,function(){return a(t,void 0,void 0,function(){var t;return l(this,function(r){switch(r.label){case 0:return 0!=s?[3,1]:c?(t=e.modelMgr.ModelFund.GetFundNameByType(o.type),e.CtrlAlert.LayerMessage.addMessage(h.StringUtil.format(u.FW.G_W("\u8bf7\u5148\u8d2d\u4e70{0}~"),t)),[3,4]):(e.CtrlAlert.LayerMessage.addMessage(u.FW.G_W("\u5192\u9669\u7b49\u7ea7\u4e0d\u8db3~")),[2]);case 1:return 1!=s?[3,3]:[4,e.modelMgr.ModelFund.RequestFundGetReward({resId:o.resId})];case 2:return r.sent(),[3,4];case 3:2==s&&e.CtrlAlert.LayerMessage.addMessage(u.FW.G_W("\u5956\u52b1\u5df2\u9886\u53d6~")),r.label=4;case 4:return[2]}})})})}},y=0;y<n.rewards.length;y++)f(y)})},e.prototype.InitClick=function(){var t,e,r=this,o=r.com,n=function(t){if(r.isBusy)u.FW.LWX.log("\u5f53\u524d\u6309\u94ae\u6b63\u5728\u5fd9\uff0c\u8bf7\u7a0d\u540e\u70b9\u51fb");else{var e={formId:t,isBusy:r.isBusy};r.isBusy=!0;var o=new m.DirectPurchase(e);p.Container.inst().inject(o),r.modelMgr.ModelPay.Pay(o).then(function(){r.isBusy=!1},function(t){u.FW.LWX.error("\u57fa\u91d1\u8d2d\u4e70\u5931\u8d25+",t),r.isBusy=!1})}};o.tm("\u6309\u94ae_\u8fd4\u56de").setClick(function(){r.unload()},r),o.tm("\u6309\u94ae_\u8d2d\u4e70_\u4e2d\u7ea7\u57fa\u91d1").setClick(function(){var t=r.modelMgr.ModelFund.GetFormId(r.fundType,2);null!=t?n(t):u.FW.LWX.log("\u57fa\u91d1\u5145\u503cid\u4e0d\u5728,type,level"+r.fundType,",2")},r),o.tm("\u6309\u94ae_\u8d2d\u4e70_\u9ad8\u7ea7\u57fa\u91d1").setClick(function(){var t=r.modelMgr.ModelFund.GetFormId(r.fundType,3);null!=t?n(t):u.FW.LWX.log("\u57fa\u91d1\u5145\u503cid\u4e0d\u5728,type,level"+r.fundType,",3")},r);var i=function(t,e){o.tm(e).setClick(function(){r.fundType!=t&&(r.fundType=t,r.UpdateView())},r)};try{for(var a=s(_),l=a.next();!l.done;l=a.next()){var f=c(l.value,2);i(f[0],f[1])}}catch(h){t={error:h}}finally{try{l&&!l.done&&(e=a.return)&&e.call(a)}finally{if(t)throw t.error}}},e.prototype.UpdateView=function(){var t=this,e=t.com;t.isFirstOpen&&(t.isFirstOpen=!1,t.fundType=t.modelMgr.ModelFund.GetOpenTab(),e.setSelectedIndex("\u57fa\u91d1\u7c7b\u578b",t.fundType-1));var r=t.modelMgr.ModelFund.GetRewardDataByType(t.fundType);r.sort(function(t,e){return t.roleLlvel-e.roleLlvel}),e.tm("\u5217\u8868_\u5956\u52b1").asList.update(r),this.UpdateTab(),this.UpdateHead()},e.prototype.UpdateTab=function(){var t,e,r=this.com;try{for(var o=s(_),n=o.next();!n.done;n=o.next()){var i=c(n.value,2),a=i[0],l=i[1],u=this.modelMgr.ModelFund.GetTabStateByFundType(a);r.tm(l).visible=u==d.TabState.open}}catch(p){t={error:p}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}},e.prototype.UpdateHead=function(){var t=this,e=t.com,r=t.modelMgr.ModelFund.GetFundPlanInfoByType(t.fundType);r&&(e.tm("\u6587\u672c_\u63cf\u8ff0").text=r.tips,this.UpdateBuyBtn())},e.prototype.UpdateBuyBtn=function(){var t=this,e=t.com,r=function(e,r){var o=t.modelMgr.ModelFund.GetFormId(t.fundType,e);if(null!=o){var n=t.modelMgr.ModelPayChannel.GetPayGoodsByFormId(o),i=n.GetRmb(),a=n.GetUnit();r.asCom.tm("title").text=h.StringUtil.format(u.FW.G_W("{0}{1}\n\u8d2d\u4e70"),i,a)}else u.FW.LWX.log("\u57fa\u91d1\u5145\u503cid\u4e0d\u5728,type,level"+t.fundType,","+e)},o=t.modelMgr.ModelFund.GetBuyState(t.fundType,2),n=t.modelMgr.ModelFund.GetBuyState(t.fundType,3);e.setSelectedIndex("\u4e2d\u7ea7\u662f\u5426\u6fc0\u6d3b",o?1:0),e.setSelectedIndex("\u9ad8\u7ea7\u662f\u5426\u6fc0\u6d3b",n?1:0);var i=e.tm("\u6309\u94ae_\u8d2d\u4e70_\u4e2d\u7ea7\u57fa\u91d1"),a=e.tm("\u6309\u94ae_\u8d2d\u4e70_\u9ad8\u7ea7\u57fa\u91d1");r(2,i),r(3,a)},e.prototype.exit=function(){},e.prototype.update=function(){},e.__cname="LayerFundUI",i([p.injectField("ModelMgr")],e.prototype,"modelMgr",void 0),i([p.injectField("CtrlMain")],e.prototype,"ctrlMain",void 0),i([p.injectField("CtrlAlert")],e.prototype,"CtrlAlert",void 0),e}(v.GameLayerUI);r.LayerFundUI=g,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/container/Container":void 0,"../../../../framework/layer/common/UIOrder":void 0,"../../../../framework/utils/StringUtil":void 0,"../../model/System/ModelSystem":"ModelSystem","../../model/fund/ModelFund":"ModelFund","../../model/pay/BuyPayObj":"BuyPayObj","../../ui/GameLayer":"GameLayer"}],LayerGMEntrance:[function(t,e,r){"use strict";cc._RF.push(e,"27c26f7LLZBAYY/B/yn2bTE","LayerGMEntrance");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerGMEntranceUI=r.LayerGMEntrance=void 0;var a=t("../../../../framework/container/Container"),l=t("../../../../framework/layer/common/UIOrder"),s=t("../../ui/GameLayer"),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._GMHide=!1,e}return n(e,t),e.prototype.getUIClass=function(){return u},e.prototype.getUrl=function(){return"ui://GM/\u7ec4\u4ef6_GM_\u5165\u53e3"},e.prototype.getSortOrder=function(){return l.LayerOrder.TipsUI},e.prototype.GetIsGameLayer=function(){return!0},e.prototype.GetIsResidentLayer=function(){return!0},e.prototype.getSystemId=function(){return 1},e.prototype.SetGMHide=function(t){this._GMHide=t,this.setVisible(!t)},e.prototype.GetGMHide=function(){return this._GMHide},e.__cname="LayerGMEntrance",e}(s.GameLayerProxy);r.LayerGMEntrance=c;var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.isFullEffectShow=function(){return!1},e.prototype.getIsFull=function(){return!1},e.prototype.getHasBackground=function(){return!1},e.prototype.init=function(){var t=this;this.com.toFullCenterParent(this.container),this.com.tm("\u6309\u94ae_GM").setClick(function(){t.layerGMMain.load()},this)},e.__cname="LayerGMEntranceUI",i([a.injectField("LayerGMMain")],e.prototype,"layerGMMain",void 0),e}(s.GameLayerUI);r.LayerGMEntranceUI=u,cc._RF.pop()},{"../../../../framework/container/Container":void 0,"../../../../framework/layer/common/UIOrder":void 0,"../../ui/GameLayer":"GameLayer"}],LayerGMMain:[function(t,e,r){"use strict";cc._RF.push(e,"473eaqRQAJK/7Y/TL+eAIEh","LayerGMMain");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerGMMainUI=r.LayerGMMain=void 0;var l=t("../../../../framework/container/Container"),s=t("../../../../framework/FW"),c=t("../../../../framework/layer/common/UIOrder"),u=t("../../ui/GameLayer"),p=t("./TabGMCacheList"),f=t("./TabGMClient"),h=t("./TabGMCommand"),y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return d},e.prototype.getUrl=function(){return"ui://GM/\u7ec4\u4ef6_GM_\u4e3b\u754c\u9762"},e.prototype.getSortOrder=function(){return c.LayerOrder.TipsUI},e.__cname="LayerGMMain",e}(u.GameLayerProxy);r.LayerGMMain=y;var d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._close2hide=null,e.pause=!1,e}return n(e,t),e.prototype.getHasBackground=function(){return!0},e.prototype.init=function(){var t=this,e=this,r=this.com,o=e.proxy;r.toFullCenterParent(this.container),r.tm("com_pub_layer.btn_close").setClick(function(){e.unload()},e),r.tm("\u6309\u94ae_\u6307\u4ee4").setClick(function(){o.switchTab(h.TabGMCommand)},e),r.tm("\u6309\u94ae_\u7f13\u5b58\u6c60\u5217\u8868").setClick(function(){o.switchTab(p.TabGMCacheList)},e),r.tm("\u6309\u94ae_\u5ba2\u6237\u7aef").setClick(function(){o.switchTab(f.TabGMClient)},e);var n=r.tm("\u6807\u7b7e_\u9690\u85cf.btn").asButton;n.selected=this.LayerGMEntrance.GetGMHide(),n.on(fgui.Event.STATUS_CHANGED,function(){s.FW.ZJJ.log("\u9690\u85cf\uff1a",n.selected),t._close2hide=n.selected},this),e.initTab()},e.prototype.release=function(){null!=this._close2hide&&this.LayerGMEntrance.SetGMHide(this._close2hide)},e.prototype.enter=function(){this.CtrlBattle.GetIsBattleRunning()&&(this.pause=!0,this.CtrlBattle.PauseRunningBattle())},e.prototype.exit=function(){this.pause&&this.CtrlBattle.ResumeRunningBattle()},e.prototype.update=function(){},e.prototype.initTab=function(t){var r,o,n=this,i=n.proxy,l=n.com,s=e._tlTabData;try{for(var c=a(s),u=c.next();!u.done;u=c.next()){var p=u.value;i.addTab(p.clz)}}catch(y){r={error:y}}finally{try{u&&!u.done&&(o=c.return)&&o.call(c)}finally{if(r)throw r.error}}if(t){var f=t,h=n.getTabDataByName(f);h?(i.switchTab(h.clz),l.setSelectedPage("\u9875\u7b7e",h.ctrlName)):n.switchTodefaultTab()}else n.switchTodefaultTab()},e.prototype.getTabDataByName=function(t){var r,o,n=e._tlTabData;try{for(var i=a(n),l=i.next();!l.done;l=i.next()){var s=l.value;if(s.cName===t)return s}}catch(c){r={error:c}}finally{try{l&&!l.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}},e.prototype.switchTodefaultTab=function(){var t=this.com,r=this.proxy,o=e._tlTabData[0];o?(r.switchTab(o.clz),t.setSelectedPage("\u9875\u7b7e",o.ctrlName)):r.switchDefaultTab()},e.__cname="LayerGMMainUI",e._tlTabData=[{clz:h.TabGMCommand,cName:"TabGMCommand",ctrlName:"\u6307\u4ee4"},{clz:p.TabGMCacheList,cName:"TabGMCacheList",ctrlName:"\u7f13\u5b58\u6c60\u5217\u8868"},{clz:f.TabGMClient,cName:"TabGMClient",ctrlName:"\u5ba2\u6237\u7aef"}],i([l.injectField("CtrlBattle")],e.prototype,"CtrlBattle",void 0),i([l.injectField("LayerGMEntrance")],e.prototype,"LayerGMEntrance",void 0),e}(u.GameLayerUI);r.LayerGMMainUI=d,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/container/Container":void 0,"../../../../framework/layer/common/UIOrder":void 0,"../../ui/GameLayer":"GameLayer","./TabGMCacheList":"TabGMCacheList","./TabGMClient":"TabGMClient","./TabGMCommand":"TabGMCommand"}],LayerGiftPackage:[function(t,e,r){"use strict";cc._RF.push(e,"50feeX7dQJHvoU9hbJlhDmW","LayerGiftPackage");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerGiftPackageUI=r.LayerGiftPackage=void 0;var a=t("../../../../../../framework/container/Container"),l=t("../../../../../../framework/FW"),s=t("../../../../../../framework/layer/common/UIOrder"),c=t("../../../../../generated/requestMsg/RequestCodeMsg"),u=t("../../../../ui/GameLayer"),p={0:l.FW.G_W("\u5151\u6362\u6210\u529f"),1:l.FW.G_W("\u5df2\u7ecf\u5151\u6362\u8fc7"),2:l.FW.G_W("\u5151\u6362\u7801\u65e0\u6548"),3:l.FW.G_W("\u5151\u6362\u7801\u5df2\u8fc7\u671f"),default:l.FW.G_W("\u5151\u6362\u5931\u8d25")},f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return h},e.prototype.getUrl=function(){return"ui://\u7cfb\u7edf\u8bbe\u7f6e/\u7ec4\u4ef6_\u7cfb\u7edf\u8bbe\u7f6e_\u793c\u5305\u7801"},e.prototype.getSortOrder=function(){return s.LayerOrder.TowLevel},e.__cname="LayerGiftPackage",e}(u.GameLayerProxy);r.LayerGiftPackage=f;var h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getHasBackground=function(){return!0},e.prototype.GetHasCloseAnimation=function(){return!0},e.prototype.GetHasShowAnimation=function(){return!0},e.prototype.init=function(){this.com.toFullCenterParent(this.container),this.InitClick()},e.prototype.InitClick=function(){var t=this,e=this,r=e.com;r.tm("\u6309\u94ae_\u786e\u5b9a").setClick(function(){var o=r.tm("\u6587\u672c_\u8f93\u5165\u793c\u5305\u7801").text;if(""==o)return e.CtrlAlert.LayerMessage.addMessage(l.FW.G_W("\u793c\u5305\u7801\u65e0\u6548")),void e.unload();t.RequestCodeExchange(o)},e),r.tm("\u6309\u94ae_\u53d6\u6d88").setClick(function(){e.unload()},e),r.tm("panel_bg.\u6309\u94ae_\u5173\u95ed").setClick(function(){e.unload()},e)},e.prototype.RequestCodeExchange=function(t){var e=this,r={code:t};e.Net.send(new c.RequestCodeExchange(r,e,function(t){if(t){var r=p[t.res]||p.default;e.CtrlAlert.LayerMessage.addMessage(r),e.unload()}},function(){e.unload()}))},e.__cname="LayerGiftPackageUI",i([a.injectField("CtrlMain")],e.prototype,"CtrlMain",void 0),i([a.injectField("Net")],e.prototype,"Net",void 0),i([a.injectField("CtrlAlert")],e.prototype,"CtrlAlert",void 0),e}(u.GameLayerUI);r.LayerGiftPackageUI=h,cc._RF.pop()},{"../../../../../../framework/FW":void 0,"../../../../../../framework/container/Container":void 0,"../../../../../../framework/layer/common/UIOrder":void 0,"../../../../../generated/requestMsg/RequestCodeMsg":"RequestCodeMsg","../../../../ui/GameLayer":"GameLayer"}],LayerGuide:[function(t,e,r){"use strict";cc._RF.push(e,"5c2edIlpdhFwqQOCRfWNq4C","LayerGuide");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.LayerGuideUI=r.LayerGuide=void 0;var i=t("../../../../framework/event/EventProxy"),a=t("../../../../framework/layer/common/UIOrder"),l=t("../../ui/GameLayer"),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.eventProxy=new i.EventProxy,e.opaqueState=!1,e}return n(e,t),e.prototype.getUrl=function(){return"ui://\u65b0\u624b\u5f15\u5bfc/\u7ec4\u4ef6_\u65b0\u624b\u5f15\u5bfc_\u4e3b\u754c\u9762"},e.prototype.getUIClass=function(){return c},e.prototype.getSortOrder=function(){return a.LayerOrder.Guide},e.prototype.getIsRedsident=function(){return!0},e.prototype.GetIsGameLayer=function(){return!0},e.prototype.SetOpaque=function(t){this.opaqueState=t,this.eventProxy.execute("UpdateOpaqueState")},e.prototype.SetIsViseible=function(t){this.eventProxy.execute("UpdateViseibleState",t)},e.prototype.GetOpaqueState=function(){return this.opaqueState},e.prototype.GetEventProxy=function(){return this.eventProxy},e.prototype.exit=function(){},e.__cname="LayerGuide",e}(l.GameLayerProxy);r.LayerGuide=s;var c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getHasBackground=function(){return!1},e.prototype.init=function(){var t=this;this.com.toFullCenterParent(this.container),this.SetOpaque(!1),this.SetIsVisible(!1),this.SetIsShowClickEnable(this.CtrlMgr.CtrlGuide.GetIsShowClickEnable()),this.toolSet.addListener(this.proxy.GetEventProxy(),"UpdateOpaqueState",function(){t.SetOpaque()}),this.toolSet.addListener(this.proxy.GetEventProxy(),"UpdateViseibleState",function(e){t.SetIsVisible(e)})},e.prototype.SetOpaque=function(t){var e=this.proxy.GetOpaqueState();null!=t&&(e=t);var r=this.com;r.tm("\u7ec4\u4ef6_\u906e\u6321\u533a\u57df").touchable!=e&&(r.tm("\u7ec4\u4ef6_\u906e\u6321\u533a\u57df").touchable=e)},e.prototype.SetIsVisible=function(t){var e=this.com;e.visible!=t&&(this.log("\u9690\u85cf\u5f15\u5bfc\u754c\u9762\uff1a",t),e.visible=t)},e.prototype.SetIsShowClickEnable=function(t){null!=this.com&&this.com.setSelectedIndex("\u53ef\u89c6\u5316",t?1:0)},e.__cname="LayerGuideUI",e}(l.GameLayerUI);r.LayerGuideUI=c,cc._RF.pop()},{"../../../../framework/event/EventProxy":void 0,"../../../../framework/layer/common/UIOrder":void 0,"../../ui/GameLayer":"GameLayer"}],LayerHeroBag:[function(t,e,r){"use strict";cc._RF.push(e,"f30efrP3iZGo7cbjwS63Zdw","LayerHeroBag");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerHeroBagUI=r.LayerHeroBag=void 0;var s=t("../../../../../framework/FW"),c=t("../../../../../framework/container/Container"),u=t("../../../../../framework/layer/common/UIOrder"),p=t("../../../../../framework/utils/StringUtil"),f=t("../../../../utils/MathUtil"),h=t("../../../model/System/ModelSystem"),y=t("../../../ui/GameLayer"),d=t("../../alert/PanelPopInfo"),m=new Map;m.set(1,"\u6587\u672c_\u5965\u4e49\u540d\u79f0"),m.set(2,"\u6587\u672c_\u88ab\u52a8\u540d\u79f0"),m.set(3,"\u6587\u672c_\u7279\u8d28\u540d\u79f0");var v=new Map;v.set(1,"\u6587\u672c_\u5965\u4e49\u63cf\u8ff0"),v.set(2,"\u6587\u672c_\u88ab\u52a8\u63cf\u8ff0"),v.set(3,"\u6587\u672c_\u7279\u8d28\u63cf\u8ff0");var _=new Map;_.set(1,"\u88c5\u8f7d\u5668_\u5965\u4e49"),_.set(2,"\u88c5\u8f7d\u5668_\u88ab\u52a8"),_.set(3,"\u88c5\u8f7d\u5668_\u7279\u8d28");var S=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return g},e.prototype.getUrl=function(){return"ui://\u82f1\u96c4_\u80cc\u5305/\u7ec4\u4ef6_\u82f1\u96c4\u80cc\u5305_\u4e3b\u754c\u9762"},e.prototype.getSortOrder=function(){return u.LayerOrder.OneLevel},e.prototype.getSystemId=function(){return h.SystemId.HeroBag},e.__cname="LayerHeroBag",e}(y.GameLayerProxy);r.LayerHeroBag=S;var g=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getHasBackground=function(){return!0},e.prototype.init=function(){var t=this;this.com.toFullCenterParent(this.container);var e="true"==this.ModelMgr.ModelGameConfig.GetGameConfigValueByKey("showHeroSpecial");this.com.tm("\u7ec4_\u7279\u6b8a\u6280\u80fd").visible=e,this.selectHeroId=this.ModelMgr.ModelRole.GetRole().GetHeroId(),this.InitClick(),this.InitList(),this.toolSet.addListener(this.ModelMgr.ModelVO.VORoleBag.GetEventProxy(),"OnChanged",function(){t.RefreshVirtualList(),t.UpdateView()})},e.prototype.enter=function(){this.ModelMgr.ModelHero.RequestHeroOpen(),this.UpdateView()},e.prototype.InitClick=function(){var t=this,e=this.com;e.tm("\u6309\u94ae_\u8fd4\u56de").setClick(function(){t.unload()},this),e.tm("\u6309\u94ae_\u6362\u88c5").setClick(function(){t.LayerShowTip.SetData({context:s.FW.G_W("\u529f\u80fd\u70ed\u70c8\u5f00\u53d1\u4e2d\uff0c\u656c\u8bf7\u671f\u5f85\uff01")}),t.LayerShowTip.load()},this),e.tm("\u6309\u94ae_\u9009\u62e9").setClick(function(){t.selectHeroId!=t.ModelMgr.ModelRole.GetRole().GetHeroId()&&t.ModelMgr.ModelHero.RequestChangHero(t.selectHeroId)},this),e.tm("\u6309\u94ae_\u5347\u7ea7").setClick(function(){var e=t.ModelMgr.ModelVO.VOHeroBag.Get(t.selectHeroId);if(null!=e)return e.GetIsMaxLevel()?(t.LayerShowTip.SetData({context:s.FW.G_W("\u54c7~\uff0c\u4f60\u5df2\u7ecf\u5230\u8fbe\u6700\u9ad8\u7684\u7b49\u7ea7\u4e86~\u592a\u5389\u5bb3\u4e86~")}),void t.LayerShowTip.load()):void 0},this),e.tm("\u6309\u94ae_\u804c\u4e1a").setClick(function(){var r=t.ModelMgr.ModelHero.GetHeroRef(t.selectHeroId),o=t.proxy.addPanel(d.PanelPopInfo);o.SetContent(r.desc),o.SetTitleVisible(!1),o.SetParent(e.tm("\u6309\u94ae_\u804c\u4e1a").asCom)},this)},e.prototype.InitList=function(){var t=this,e=this.com.tm("\u5217\u8868_\u82f1\u96c4").asList;e.initVirtualList(this,function(e,r,o){var n=r.asCom,i=t.ModelMgr.ModelVO.VOHeroBag.Get(o.id);if(n.setSelectedPage("\u89e3\u9501",i?"\u662f":"\u5426"),i){var a=n.tm("\u6587\u672c_\u7b49\u7ea7").asTextField;a.setVar("level",i.GetLevel().toString()),a.flushVars();var l=i.CheckCanLevelUp();n.tm("\u7ea2\u70b9").OnRDUpdate(l),n.setSelectedPage("\u4e0a\u9635",i.GetIsPutOn()?"\u662f":"\u5426")}else n.tm("\u6587\u672c_\u89e3\u9501\u63d0\u793a").text=o.unlockTip,n.setSelectedPage("\u4e0a\u9635","\u5426");n.tm("\u6587\u672c_\u540d\u79f0").text=o.name,n.tm("\u88c5\u8f7d\u5668_\u82f1\u96c4").SetUrlByIcon(o.iconCard),n.tm("\u88c5\u8f7d\u5668_\u79cd\u7c7b").SetUrlByIcon(o.equipIcon),n.setSelectedPage("\u9009\u4e2d",t.selectHeroId==o.id?"\u662f":"\u5426")},function(r,o,n){t.selectHeroId!=n.id&&(t.ModelMgr.ModelVO.VOHeroBag.Get(n.id)?(t.selectHeroId=n.id,t.UpdateView(),e.refreshVirtualList()):t.CtrlMgr.CtrlAlert.ShowTips(s.FW.G_W("\u8be5\u82f1\u96c4\u672a\u89e3\u9501")))}),this.updateList()},e.prototype.UpdateView=function(){var t,e,r,o,n,i=this,s=this.com,c=this.ModelMgr.ModelVO.VOHeroBag.Get(this.selectHeroId);if(c){s.setSelectedPage("\u662f\u5426\u89e3\u9501","\u662f"),r=c.GetRef(),o=c.GetHeroRef(),n=c.GetHeroAudioRef();var u=c.GetRuntimeTmAttr();if(s.tm("\u7ec4\u4ef6_\u5c5e\u6027_\u653b\u51fb.\u6587\u672c_\u57fa\u7840\u503c").text=""+u.get("atk").toString(),s.tm("\u7ec4\u4ef6_\u5c5e\u6027_\u751f\u547d.\u6587\u672c_\u57fa\u7840\u503c").text=""+u.get("hp").toString(),c.GetIsMaxLevel())s.tm("\u7ec4\u4ef6_\u5c5e\u6027_\u653b\u51fb.\u6587\u672c_\u63d0\u5347").text="",s.tm("\u7ec4\u4ef6_\u5c5e\u6027_\u751f\u547d.\u6587\u672c_\u63d0\u5347").text="";else{var h=this.ModelMgr.ModelHero.GetHeroLevelRef(c.GetLevel()+1);s.tm("\u7ec4\u4ef6_\u5c5e\u6027_\u653b\u51fb.\u6587\u672c_\u63d0\u5347").text=""+h.atk,s.tm("\u7ec4\u4ef6_\u5c5e\u6027_\u751f\u547d.\u6587\u672c_\u63d0\u5347").text=""+h.hp}}else s.setSelectedPage("\u662f\u5426\u89e3\u9501","\u5426"),r=this.ModelMgr.ModelHero.GetRef(this.selectHeroId),o=this.ModelMgr.ModelHero.GetHeroRef(this.selectHeroId),n=this.ModelMgr.ModelHero.GetHeroAudioRef(this.selectHeroId),s.tm("\u7ec4\u4ef6_\u5c5e\u6027_\u653b\u51fb.\u6587\u672c_\u57fa\u7840\u503c").text="0",s.tm("\u7ec4\u4ef6_\u5c5e\u6027_\u751f\u547d.\u6587\u672c_\u57fa\u7840\u503c").text="0",s.tm("\u7ec4\u4ef6_\u5c5e\u6027_\u653b\u51fb.\u6587\u672c_\u63d0\u5347").text="",s.tm("\u7ec4\u4ef6_\u5c5e\u6027_\u751f\u547d.\u6587\u672c_\u63d0\u5347").text="";s.tm("\u6587\u672c_\u82f1\u96c4\u540d\u79f0").text=r.name,s.tm("\u88c5\u8f7d\u5668_\u82f1\u96c4").SetUrlByModel(o.bodyModel),s.tm("\u6309\u94ae_\u804c\u4e1a.icon").SetUrlByIcon(o.equipIcon),s.tm("\u88c5\u8f7d\u5668_\u82f1\u96c4").GetPromise().then(function(){var t=i.ModelMgr.ModelGameConfig.GetGameConfigValueByKey("showHeroScale");s.tm("\u88c5\u8f7d\u5668_\u82f1\u96c4").GetNode().setScale(t,t)});var y=c&&c.GetLevel()||0;s.tm("\u7ec4\u4ef6_\u5c5e\u6027_\u7b49\u7ea7.\u6587\u672c_\u57fa\u7840\u503c").text=p.StringUtil.format("{0}/{1}",y,80);var d=this.ModelMgr.ModelHero.GetTmPassiveSkill(this.selectHeroId);try{for(var S=a(d),g=S.next();!g.done;g=S.next()){var b=l(g.value,2),C=b[0],R=b[1],M=m.get(C),w=v.get(C),O=_.get(C);s.tm(M).text=R.name,s.tm(w).text=R.desc,s.tm(O).SetUrlByIcon(R.icon)}}catch(P){t={error:P}}finally{try{g&&!g.done&&(e=S.return)&&e.call(S)}finally{if(t)throw t.error}}if(n&&n.getAudio){var B=f.MathUtil.GetRand(0,n.getAudio.length,2);this.CtrlMgr.CtrlAudio.PlaySound(n.getAudio[B])}},e.prototype.updateList=function(){var t=this.com.tm("\u5217\u8868_\u82f1\u96c4").asList,e=this.ModelMgr.ModelHero.GetHeroList();e.sort(function(t,e){return t.sort-e.sort}),t.update(e)},e.prototype.RefreshVirtualList=function(){this.isEnter&&this.com.tm("\u5217\u8868_\u82f1\u96c4").asList.refreshVirtualList()},e.__cname="LayerHeroBagUI",i([c.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([c.injectField("LayerShowTip")],e.prototype,"LayerShowTip",void 0),i([c.injectField("CtrlMgr")],e.prototype,"CtrlMgr",void 0),e}(y.GameLayerUI);r.LayerHeroBagUI=g,cc._RF.pop()},{"../../../../../framework/FW":void 0,"../../../../../framework/container/Container":void 0,"../../../../../framework/layer/common/UIOrder":void 0,"../../../../../framework/utils/StringUtil":void 0,"../../../../utils/MathUtil":"MathUtil","../../../model/System/ModelSystem":"ModelSystem","../../../ui/GameLayer":"GameLayer","../../alert/PanelPopInfo":"PanelPopInfo"}],LayerHeroGet:[function(t,e,r){"use strict";cc._RF.push(e,"e580a1h9XNH7Imhd942L0PB","LayerHeroGet");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerHeroGetUI=r.LayerHeroGet=void 0;var a=t("../../../../../framework/FW"),l=t("../../../../../framework/container/Container"),s=t("../../../../../framework/layer/common/UIOrder"),c=t("../../../../utils/MathUtil"),u=t("../../../ui/GameLayer"),p=t("../CtrlAlert"),f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return h},e.prototype.getUrl=function(){return"ui://\u901a\u7528_\u63d0\u793a\u5f39\u7a97/\u7ec4\u4ef6_\u5f39\u7a97_\u82f1\u96c4\u83b7\u53d6"},e.prototype.getSortOrder=function(){return s.LayerOrder.Guide},e.prototype.SetHero=function(t){this._HeroId=t},e.prototype.GetHero=function(){return this._HeroId},e.__cname="LayerHeroGet",e}(u.GameLayerProxy);r.LayerHeroGet=f;var h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getHasBackground=function(){return!0},e.prototype.initAsync=function(){a.FW.showLoading()},e.prototype.init=function(){var t=this;this.com.toFullCenterParent(this.container),this.com.setClick(function(){t.unload()},this)},e.prototype.release=function(){this.CtrlAudio.Stop(this.audioId)},e.prototype.enter=function(){this.updateView(),a.FW.removeLoading()},e.prototype.exit=function(){},e.prototype.updateView=function(){var t=this,e=t.com,r=t.proxy.GetHero();a.FW.LWX.log("heroId:",r);var o=t.ModelMgr.ModelHero.GetHeroRef(r),n=t.ModelMgr.ModelHero.GetHeroShowGetRef(o.showGet),i=t.ModelMgr.ModelHero.GetHeroAudioRef(o.audio);if(e.tm("\u88c5\u8f7d\u5668_\u82f1\u96c4\u5f62\u8c61").SetUrlByIcon(n.heroImage),e.tm("\u88c5\u8f7d\u5668_\u82f1\u96c4\u63cf\u8ff0").SetUrlByIcon(n.heroDesc),e.tm("\u88c5\u8f7d\u5668_\u82f1\u96c4\u6a21\u578b").SetUrlByModel(n.heroModel),e.tm("\u88c5\u8f7d\u5668_\u82f1\u96c4\u6807\u5fd7").SetUrlByIcon(n.equipSign),e.tm("\u6587\u672c_\u4e13\u7cbe\u6b66\u5668").asTextField.setVar("type",n.equipType).flushVars(),e.tm("\u88c5\u8f7d\u5668_\u7c92\u5b50\u7279\u6548").SetUrlByModel(p.particlesMap.get("\u7eff\u8272\u7c92\u5b50")),i.getAudio){var l=c.MathUtil.GetRand(0,i.getAudio.length,2);t.CtrlAudio.PlaySound(i.getAudio[l]).then(function(e){t.audioId=e})}},e.__cname="LayerHeroGetUI",i([l.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([l.injectField("CtrlAudio")],e.prototype,"CtrlAudio",void 0),e}(u.GameLayerUI);r.LayerHeroGetUI=h,cc._RF.pop()},{"../../../../../framework/FW":void 0,"../../../../../framework/container/Container":void 0,"../../../../../framework/layer/common/UIOrder":void 0,"../../../../utils/MathUtil":"MathUtil","../../../ui/GameLayer":"GameLayer","../CtrlAlert":"CtrlAlert"}],LayerHeroLevelUp:[function(t,e){"use strict";cc._RF.push(e,"f67fd/rYT5Fwq2h4cMOEbmi","LayerHeroLevelUp"),cc._RF.pop()},{}],LayerHeroUnlock:[function(t,e,r){"use strict";cc._RF.push(e,"aa574Dw1o5LdpsW9b1/z+qt","LayerHeroUnlock");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerHeroUnlockUI=r.LayerHeroUnlock=void 0;var c=t("../../../../../framework/FW"),u=t("../../../../../framework/container/Container"),p=t("../../../../../framework/layer/common/UIOrder"),f=t("../../../model/System/ModelSystem"),h=t("../../../ui/GameLayer"),y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return d},e.prototype.getUrl=function(){return"ui://\u9996\u9875_\u4fee\u70bc_\u82f1\u96c4\u89e3\u9501/\u7ec4\u4ef6_\u82f1\u96c4\u89e3\u9501"},e.prototype.getSortOrder=function(){return p.LayerOrder.TowLevel},e.prototype.getSystemId=function(){return f.SystemId.HeroUnlock},e.__cname="LayerHeroUnlock",e}(h.GameLayerProxy);r.LayerHeroUnlock=y;var d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getHasBackground=function(){return!0},e.prototype.init=function(){this.com.toFullCenterParent(this.container),this.InitClick(),this.InitList()},e.prototype.release=function(){},e.prototype.enterAsync=function(){return a(this,void 0,Promise,function(){var t;return l(this,function(e){switch(e.label){case 0:return[4,this.ModelMgr.ModelHero.RequestHeroUnlock()];case 1:return(t=e.sent())?(this.updateData(t),[2]):(this.CtrlMgr.CtrlAlert.LayerMessage.addMessage(c.FW.G_W("\u83b7\u53d6\u82f1\u96c4\u6570\u636e\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5")),this.unload(),[2])}})})},e.prototype.InitClick=function(){var t=this;t.com.tm("\u6309\u94ae_\u5173\u95ed").setClick(function(){t.unload()},t)},e.prototype.InitList=function(){var t=this,e=this;e.com.tm("\u5217\u8868_\u82f1\u96c4").asList.init(e,function(r,o,n){var i=o.asCom;if(null!=n){i.tm("icon").SetUrlByIcon(n.ref.heorIcon);var s=i.tm("\u7269\u54c1\u6846.com_good"),u=e.ModelMgr.ModelGoods.CreateGoods(n.ref.heroId);s.UpdateByGoods(u),s.GetBehavior().onNumberVisible(!1);var p=2==n.vo.rewardState;i.setSelectedIndex("\u6309\u94ae\u72b6\u6001",n.vo.rewardState),s.GetBehavior().onIconEffectVisible(!p),i.grayed=p,0==n.vo.rewardState&&(i.tm("\u6309\u94ae_\u9886\u53d6.title").text=n.ref.tip),e.setFairyBtnEvent(i.tm("\u6309\u94ae_\u9886\u53d6"),function(){return a(t,void 0,void 0,function(){var t;return l(this,function(r){switch(r.label){case 0:switch(n.vo.rewardState){case 0:return[3,1];case 1:return[3,2];case 2:return[3,5]}return[3,6];case 1:return 400004==n.ref.heroId?(e.CtrlMgr.CtrlMain.LayerFirstRecharge.load(),e.unload(),[2]):(n.ref.jumpId?(e.CtrlMgr.JumpLayer(n.ref.jumpId),e.unload()):e.CtrlMgr.CtrlAlert.LayerMessage.addMessage(n.ref.jumpTip),[3,7]);case 2:return 400004==n.ref.heroId?(e.CtrlMgr.CtrlMain.LayerFirstRecharge.load(),e.unload(),[2]):[4,e.ModelMgr.ModelHero.RequestGetRewardHero(n.ref.resId)];case 3:return r.sent(),[4,e.ModelMgr.ModelHero.RequestHeroUnlock()];case 4:return t=r.sent(),e.updateData(t),[3,7];case 5:return e.CtrlMgr.CtrlAlert.LayerMessage.addMessage(c.FW.G_W("\u8be5\u82f1\u96c4\u4ee5\u83b7\u53d6")),[3,7];case 6:return[3,7];case 7:return[2]}})})})}else i.setSelectedIndex("\u656c\u8bf7\u671f\u5f85",1)})},e.prototype.updateData=function(t){var e,r,o=this,n=o.ModelMgr.ModelHero.GetHeroUnlockList();o.heroData=[];var i=function(e){var r=t.find(function(t){return t.resId==e.resId});o.heroData.push({ref:e,vo:r})};try{for(var a=s(n),l=a.next();!l.done;l=a.next())i(l.value)}catch(c){e={error:c}}finally{try{l&&!l.done&&(r=a.return)&&r.call(a)}finally{if(e)throw e.error}}o.heroData.push(null),o.heroData.sort(function(t,e){if(null==t&&2==e.vo.rewardState)return-1;if(null==e&&2==t.vo.rewardState)return-1;if(null==t||null==e)return 0;var r=t.vo.rewardState,o=e.vo.rewardState;return 2==r||2==o?r-o:o-r}),o.updateList()},e.prototype.updateList=function(){var t=this.com.tm("\u5217\u8868_\u82f1\u96c4").asList,e=this.heroData;t.update(e)},e.__cname="LayerHeroUnlockUI",i([u.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([u.injectField("CtrlMgr")],e.prototype,"CtrlMgr",void 0),e}(h.GameLayerUI);r.LayerHeroUnlockUI=d,cc._RF.pop()},{"../../../../../framework/FW":void 0,"../../../../../framework/container/Container":void 0,"../../../../../framework/layer/common/UIOrder":void 0,"../../../model/System/ModelSystem":"ModelSystem","../../../ui/GameLayer":"GameLayer"}],LayerInformationTips:[function(t,e,r){"use strict";cc._RF.push(e,"1c4f9gQZkZC37ifBq1rhwlm","LayerInformationTips");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerInformationTipsUI=r.LayerInformationTips=void 0;var l=t("../../../../framework/FW"),s=t("../../../../framework/layer/common/UIOrder"),c=t("../../ui/GameLayer"),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return p},e.prototype.getUrl=function(){return"ui://\u9996\u9875\u4fee\u70bc_\u73a9\u5bb6\u4fe1\u606f/\u7ec4\u4ef6_\u6539\u540d\u63d0\u793a\u7a97"},e.prototype.getSortOrder=function(){return s.LayerOrder.TowLevel},e.__cname="LayerInformationTips",e}(c.GameLayerProxy);r.LayerInformationTips=u;var p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getHasBackground=function(){return!0},e.prototype.GetHasCloseAnimation=function(){return!0},e.prototype.GetHasShowAnimation=function(){return!0},e.prototype.init=function(){var t=this;this.com.toFullCenterParent(this.container),this.com.tm("panel_bg.\u6309\u94ae_\u5173\u95ed").setClick(function(){t.unload()},this),this.setFairyBtnEvent(this.com.tm("\u6309\u94ae_\u786e\u8ba4"),function(){return i(t,void 0,void 0,function(){var t;return a(this,function(e){switch(e.label){case 0:return""==(t=this.com.tm("\u6587\u672c_\u8f93\u5165\u59d3\u540d").text)||t==this.ModelMgr.ModelRole.GetRole().GetName()?(l.FW.showTip(l.FW.G_W("\u8bf7\u586b\u5199\u65b0\u7684\u540d\u5b57")),[2]):[4,this.ModelMgr.ModelRole.RequestChangeName(t)];case 1:return e.sent()&&(l.FW.showTip(l.FW.G_W("\u4fee\u6539\u6210\u529f")),this.unload()),[2]}})})}),this.setFairyBtnEvent(this.com.tm("\u6309\u94ae_\u514d\u8d39"),function(){return i(t,void 0,void 0,function(){var t;return a(this,function(e){switch(e.label){case 0:return""==(t=this.com.tm("\u6587\u672c_\u8f93\u5165\u59d3\u540d").text)||t==this.ModelMgr.ModelRole.GetRole().GetName()?(l.FW.showTip(l.FW.G_W("\u8bf7\u586b\u5199\u65b0\u7684\u540d\u5b57")),[2]):[4,this.ModelMgr.ModelRole.RequestChangeName(t)];case 1:return e.sent()&&(l.FW.showTip(l.FW.G_W("\u4fee\u6539\u6210\u529f")),this.unload()),[2]}})})}),this.toolSet.addListener(this.ModelMgr.ModelVO.VORoleBag.GetEventProxy(),"OnChanged",function(){t.UpdateView()},this)},e.prototype.enter=function(){this.UpdateView()},e.prototype.UpdateView=function(){var t=this.ModelMgr.ModelRole.GetRole();this.com.setSelectedPage("\u662f\u5426\u514d\u8d39",t.GetRenameNum()<=0?"\u662f":"\u5426");var e=this.ModelMgr.ModelRole.GetRenameGoods();this.com.tm("\u6309\u94ae_\u786e\u8ba4.icon").SetUrlByIcon(e.GetIconUrl()),this.com.tm("\u6309\u94ae_\u786e\u8ba4.title").asTextField.text="x"+e.GetNumber()},e.__cname="LayerInformationTipsUI",e}(c.GameLayerUI);r.LayerInformationTipsUI=p,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/layer/common/UIOrder":void 0,"../../ui/GameLayer":"GameLayer"}],LayerInformation:[function(t,e,r){"use strict";cc._RF.push(e,"71dedNO265NUqHvUltvlpbo","LayerInformation");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerInformationUI=r.LayerInformation=void 0;var l,s=t("../../../../framework/FW"),c=t("../../../../framework/container/Container"),u=t("../../../../framework/layer/common/UIOrder"),p=t("../../model/System/ModelSystem"),f=t("../../model/public/AppCustomData"),h=t("../../ui/GameLayer");(function(t){t[t.avatar=0]="avatar",t[t.frame=1]="frame"})(l||(l={}));var y=new Set;y.add(l.avatar),y.add(l.frame);var d=new Map;d.set(l.avatar,"\u6309\u94ae_\u5934\u50cf"),d.set(l.frame,"\u6309\u94ae_\u5934\u50cf\u6846");var m=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return v},e.prototype.getUrl=function(){return"ui://\u9996\u9875\u4fee\u70bc_\u73a9\u5bb6\u4fe1\u606f/\u9996\u9875_\u4fee\u70bc_\u73a9\u5bb6\u4fe1\u606f"},e.prototype.getSortOrder=function(){return u.LayerOrder.TowLevel},e.prototype.getSystemId=function(){return p.SystemId.Information},e.__cname="LayerInformation",e}(h.GameLayerProxy);r.LayerInformation=m;var v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.nowType=l.avatar,e.cacheList=[],e}return n(e,t),e.prototype.getHasBackground=function(){return!0},e.prototype.GetHasCloseAnimation=function(){return!0},e.prototype.GetHasShowAnimation=function(){return!0},e.prototype.init=function(){this.com.toCenterParent(this.container),this.InitData(),this.InitClick(),this.InitList(),this.updateHead(),this.updateList()},e.prototype.release=function(){this.ModelVO.VOItemBag.ClearHead()},e.prototype.InitData=function(){var t=this;t.roleSubset=t.ModelVO.VORoleBag.CreateSubset(),t.roleSubset.SetFilter(function(){return!0}),t.itemSubset=t.ModelVO.VOItemBag.CreateSubset(),t.itemSubset.SetFilter(function(){return!0}),t.toolSet.addListener(t.roleSubset.GetEventProxy(),"OnChanged",function(){t.updateHead()}),t.toolSet.addListener(t.itemSubset.GetEventProxy(),"OnChanged",function(){t.itemVo=t.itemSubset.GetTlVO(),t.updateList()}),t.toolSet.addDefer(function(){t.ModelVO.VORoleBag.DestroySubset(t.roleSubset),t.roleSubset=null,t.ModelVO.VOItemBag.DestroySubset(t.itemSubset),t.itemSubset=null}),t.itemVo=t.itemSubset.GetTlVO();var e=t.roleSubset.GetOneVO();t.cacheAvatar=e.GetImg(),t.cacheFrame=e.GetFram()},e.prototype.InitClick=function(){var t,e,r=this,o=this,n=o.com;n.tm("panel_bg.\u6309\u94ae_\u5173\u95ed").setClick(function(){o.unload()},o),n.tm("\u6309\u94ae_\u9009\u62e9").setClick(function(){o.nowType==l.avatar?o.ModelMgr.ModelHead.RequestChangeImg(o.cacheAvatar):o.nowType==l.frame?o.ModelMgr.ModelHead.RequestChangeFram(o.cacheFrame):s.FW.LWX.error("\u7c7b\u578b\u9519\u8bef\uff0c\u8bf7\u68c0\u67e5nowType\uff1a"+o.nowType)},o),f.AppCustomData.instance.audit?n.tm("\u6309\u94ae_\u6539\u540d").visible=!1:(n.tm("\u6309\u94ae_\u6539\u540d").visible=!0,n.tm("\u6309\u94ae_\u6539\u540d").setClick(function(){r.CtrlMgr.CtrlRole._LayerInformationTips.load()},o));var i=function(t){var e=d.get(t);n.tm(e).setClick(function(){o.nowType!=t&&(o.nowType=t,o.updateList())},o)};try{for(var c=a(y),u=c.next();!u.done;u=c.next())i(u.value)}catch(p){t={error:p}}finally{try{u&&!u.done&&(e=c.return)&&e.call(c)}finally{if(t)throw t.error}}},e.prototype.InitList=function(){var t=this,e=t.com,r=e.tm("\u5217\u8868_\u5934\u50cf").asList,o=function(e){var r,o;try{for(var n=a(t.itemVo),i=n.next();!i.done;i=n.next())if(i.value.GetRefId()==e)return!0}catch(l){r={error:l}}finally{try{i&&!i.done&&(o=n.return)&&o.call(n)}finally{if(r)throw r.error}}return!1};r.init(t,function(r,n,i){var a,c,u=n.asCom,p=t.roleSubset.GetOneVO(),f=i.itemId;if(t.cacheList.push(u),f==p.GetImg()||f==p.GetFram()?(u.setSelectedIndex("\u662f\u5426\u9009\u4e2d",1),e.setSelectedIndex("\u54c1\u8d28",i.quality),e.tm("\u6587\u672c_\u63d0\u793a").text=i.desc):u.setSelectedIndex("\u662f\u5426\u9009\u4e2d",0),i.type==l.avatar)a=f,c=p.GetFram();else{if(i.type!=l.frame)return void s.FW.LWX.error("\u7c7b\u578b\u51fa\u9519,\u8bf7\u68c0\u67e5head\u8868\uff0cresId\uff1a"+i.resId);a=p.GetImg(),c=f}var h=t.ModelMgr.ModelHead.GetIconByitemId(a),y=t.ModelMgr.ModelHead.GetIconByitemId(c);u.tm("icon").SetUrlByIcon(h),u.tm("effect").SetUrlByIcon(y);var d=!0,m=!0;t.nowType==l.avatar?d=!1:m=!1,u.tm("icon").visible=m,u.tm("effect").visible=d;var v=!0;o(f)&&(v=!1),u.grayed=v},function(r,n,i){n.asCom;var a=i.itemId;e.setSelectedIndex("\u54c1\u8d28",i.quality),e.tm("\u6587\u672c_\u63d0\u793a").text=i.desc,i.type==l.avatar?t.cacheAvatar=a:i.type==l.frame?t.cacheFrame=a:s.FW.LWX.error("\u7c7b\u578b\u9519\u8bef\uff0c\u8bf7\u68c0\u67e5head\u8868");var c=!1;o(a)&&(c=!0),e.tm("\u6309\u94ae_\u9009\u62e9").visible=c;for(var u=0;u<t.cacheList.length;u++)u==r?t.cacheList[u].setSelectedIndex("\u662f\u5426\u9009\u4e2d",1):t.cacheList[u].setSelectedIndex("\u662f\u5426\u9009\u4e2d",0)})},e.prototype.updateHead=function(){var t=this,e=t.com,r=t.ModelMgr.ModelRole.GetRole();e.tm("\u5934\u50cf.icon").SetUrlByIcon(r.GetIcon()),e.tm("\u5934\u50cf.effect").SetUrlByIcon(r.GetFramIcon()),t.com.tm("\u6587\u672c_\u59d3\u540d").text=r.GetName();var o=r.GetRoleId().toString();t.com.tm("\u6587\u672c_\u8d26\u53f7Id").asTextField.setVar("id",o).flushVars()},e.prototype.updateList=function(){var t=this,e=t.com.tm("\u5217\u8868_\u5934\u50cf").asList;t.cacheList.length=0;var r=t.ModelMgr.ModelHead.GetHeadByType(t.nowType);e.update(r)},e.__cname="LayerInformationUI",i([c.injectField("ModelVO")],e.prototype,"ModelVO",void 0),i([c.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([c.injectField("LayerInformationTips")],e.prototype,"LayerInformationTips",void 0),i([c.injectField("CtrlPay")],e.prototype,"CtrlPay",void 0),e}(h.GameLayerUI);r.LayerInformationUI=v,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/container/Container":void 0,"../../../../framework/layer/common/UIOrder":void 0,"../../model/System/ModelSystem":"ModelSystem","../../model/public/AppCustomData":"AppCustomData","../../ui/GameLayer":"GameLayer"}],LayerItemDetail:[function(t,e,r){"use strict";cc._RF.push(e,"372b1U6/oJJN78rpiey/AD3","LayerItemDetail");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerItemDetailUI=r.LayerItemDetail=r.OpenPosition=void 0;var l,s,c=t("../../../../framework/FW"),u=t("../../../../framework/container/Container"),p=t("../../../../framework/layer/common/UIOrder"),f=t("../../../../framework/utils/StringUtil"),h=t("../../../../libutil/BigNum"),y=t("../../model/goods/ModelEquip"),d=t("../../model/goods/ModelGoods"),m=t("../../ui/GameLayer");(function(t){t[t.Bag=0]="Bag",t[t.equipSlot=1]="equipSlot",t[t.synthesis=2]="synthesis",t[t.MallBuy=3]="MallBuy",t[t.MallBoxPreview=4]="MallBoxPreview"})(l=r.OpenPosition||(r.OpenPosition={})),function(t){t.RED="#D32729",t.WHITE="#FFFAEA"}(s||(s={}));var v=new Map;v.set(2,"\u7eff"),v.set(3,"\u84dd"),v.set(4,"\u7d2b"),v.set(5,"\u91d1"),v.set(6,"\u7ea2");var _=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._isShow=!0,e}return n(e,t),e.prototype.getUIClass=function(){return S},e.prototype.getUrl=function(){return"ui://\u82f1\u96c4/\u7ec4\u4ef6_\u82f1\u96c4_\u88c5\u5907\u8be6\u60c5\u754c\u9762"},e.prototype.getSortOrder=function(){return p.LayerOrder.TowLevel},e.prototype.SetEquip=function(t){this.goods=t},e.prototype.GetEquip=function(){return this.goods},e.prototype.SetOpenPosition=function(t){this.openPosition=t},e.prototype.GetOpenPosition=function(){return this.openPosition},e.prototype.SetOnclickBtn1=function(t){this.onclickBtn1=t},e.prototype.GetOnclickBtn1=function(){return this.onclickBtn1},e.prototype.SetisShow=function(t){this._isShow=t},e.prototype.GetisShow=function(){return this._isShow},e.prototype.SetPreViewList=function(t){this._preViewList=t},e.prototype.GetPreViewList=function(){return this._preViewList},e.prototype.SetBuyInfo=function(t){this._buyInfo=t},e.prototype.GetBuyInfo=function(){return this._buyInfo},e.prototype.SetPayObj=function(t){this._payObj=t},e.prototype.GetPayObj=function(){return this._payObj},e.prototype.SetEquipLevel=function(t){this._equipLevel=t},e.prototype.GetEquipLevel=function(){return this._equipLevel},e.prototype.exit=function(){this._isShow=!0,this._buyInfo=null,this._payObj=null,this._preViewList=null,this._equipLevel=null},e.__cname="LayerItemDetail",e}(m.GameLayerProxy);r.LayerItemDetail=_;var S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.updateFuncMap=new Map([[l.Bag,e.UpdateOnBagAndSlot.bind(e)],[l.equipSlot,e.UpdateOnBagAndSlot.bind(e)],[l.synthesis,e.UpdateOnSynthesis.bind(e)],[l.MallBuy,e.UpdateOnMallBuy.bind(e)],[l.MallBoxPreview,e.updateOnMallBoxPreview.bind(e)]]),e}return n(e,t),e.prototype.GetHasCloseAnimation=function(){return!0},e.prototype.GetHasShowAnimation=function(){return!0},e.prototype.init=function(){this.isOpen=!0,this.com.toCenterParent(this.container),this.LayerInfo()},e.prototype.LayerInfo=function(){this.InitVOBag(),this.initOnclick(),this.InitList(),this.InitLayer()},e.prototype.InitVOBag=function(){var t=this,e=this;this.roleVoSubset=this.ModelMgr.ModelVO.VORoleBag.CreateSubset(),this.roleVoSubset.SetFilter(function(){return!0}),this.toolSet.addDefer(function(){t.ModelMgr.ModelVO.VORoleBag.DestroySubset(t.roleVoSubset),t.roleVoSubset=null,t.ModelMgr.ModelVO.VOEquipBag.DestroySubset(t.equipVoSubset),t.equipVoSubset=null}),this.equipVoSubset=this.ModelMgr.ModelVO.VOEquipBag.CreateSubset(),this.equipVoSubset.SetFilterVO(this.proxy.GetEquip()),this.toolSet.addListener(this.equipVoSubset.GetEventProxy(),"OnChanged",function(){e.isOpen&&(e.proxy.GetOpenPosition()!=l.synthesis&&e.proxy.SetEquip(t.equipVoSubset.GetOneVO()),e.proxy.GetisShow()&&e.updateFuncMap.get(e.proxy.GetOpenPosition())())}),this.toolSet.addListener(this.ModelMgr.ModelEquip.GetEventProxy(),"OnEquipLevel",function(){e.com.tm("com_item.\u7279\u6548_\u95ea\u5149").visible=!0;var t=e.com.tm("com_item.\u7279\u6548_\u95ea\u5149").asCom.tmt("\u7279\u6548_\u95ea\u5149");t.playing,t.stop(!0),t.play()})},e.prototype.InitList=function(){var t=this,e=this.com;e.tm("\u5217\u8868_\u54c1\u8d28\u6280\u80fd").init(this,function(e,r,o){var n=r,i=t.proxy.GetEquip().GetQuality()>=o.quality;n.tm("title").text=i?o.desc:o.unLockDesc,n.setSelectedPage("\u54c1\u8d28",v.get(o.quality)),n.setSelectedIndex("\u662f\u5426\u89e3\u9501",i?0:1)}),e.tm("\u5217\u8868_\u9884\u89c8").asList.init(this,function(t,e,r){e.tm("icon").SetUrlByIcon(r.GetIconUrl())},function(e,r,o){t.proxy.SetEquip(o),t.UpdateEquipBaseInfo()})},e.prototype.InitLayer=function(){var t=this,e=t.com;this.updateFuncMap.get(t.proxy.GetOpenPosition())(),this.UpdateEquipBaseInfo();var r=t.proxy.GetisShow();e.tm("com_item.\u7279\u6548_\u95ea\u5149").visible=!1,e.tm("\u6587\u672c_\u7b49\u7ea7").visible=r,e.tm("\u6587\u672c_\u6b66\u5668\u7c7b\u578b").asTextField.setVar("equipTypeDesc",this.proxy.GetEquip().GetEquiTypeDesc()).flushVars()},e.prototype.UpdateEquipBaseInfo=function(){var t,e,r=this,o=r.com,n=r.proxy.GetEquip(),i=o.tm("com_item").asCom.tm("com_goods");i.UpdateByGoods(n),i.GetBehavior().onNumberVisible(!1),o.tm("\u6587\u672c_\u88c5\u5907\u540d\u79f0").text=n.GetName(),o.tm("\u6587\u672c_\u88c5\u5907\u63cf\u8ff0").text=n.GetDesc(),o.tm("\u6587\u672c_\u54c1\u8d28").text=this.ModelMgr.ModelGoods.GetQualityName(n.GetQuality(),n.GetPhase()),o.setSelectedIndex("\u6253\u5f00\u4f4d\u7f6e",r.proxy.GetOpenPosition()),o.setSelectedIndex("\u54c1\u8d28",n.GetQuality()-1);var l,s=o.tm("\u5217\u8868_\u54c1\u8d28\u6280\u80fd"),c=n.GetQuiltySkill(),u=[];try{for(var p=a(c),f=p.next();!f.done;f=p.next()){var h=f.value;"[]"!=h.desc&&u.push(h)}}catch(v){t={error:v}}finally{try{f&&!f.done&&(e=p.return)&&e.call(p)}finally{if(t)throw t.error}}s.update(u);var d=r.proxy.GetEquipLevel();l=d?d.toString():n.GetLevel().toString();var m=n.GetMaxLevel().toString();o.tm("\u6587\u672c_\u7b49\u7ea7").asTextField.setVar("nowLevel",l).setVar("maxLevel",m).flushVars(),o.setSelectedIndex("\u52a0\u6210\u7c7b\u578b",n.GetAdditionType()==y.AdditionType.attack?0:1),o.tm("\u7ec4\u4ef6_\u88c5\u5907\u52a0\u6210.\u6587\u672c_\u57fa\u7840\u503c").text="+"+n.GetAdditionValue(),o.setSelectedIndex("\u662f\u5426\u8fbe\u5230\u6700\u5927\u7b49\u7ea7",parseInt(l)>=parseInt(m)?0:1)},e.prototype.UpdateOnBagAndSlot=function(){var t=this,e=t.com,r=t.proxy.GetEquip(),o=this.ModelMgr.ModelGoods.CreateGoods(r.GetUpDownDrawId()),n=this.ModelMgr.ModelGoods.GetRefByCurrency(d.ECurrencyType.coin);e.tm("\u88c5\u8f7d\u5668_\u91d1\u5e01").SetUrlByIcon(n.icon),e.tm("\u88c5\u8f7d\u5668_\u56fe\u7eb8").SetUrlByIcon(o.GetIconUrl());var i=Number(this.roleVoSubset.GetOneVO().GetAttributeBy(d.ECurrencyType.coin)),a=r.GetUpgradeCoinNumber(),l=this.ModelMgr.ModelGoods.GetGoodsNumberByRefId(r.GetUpDownDrawId()),c=r.GetUpgradeDrawNumber();t.upState=i>=a&&l>=c,t.downLevelState=r.GetDownLevelState(),t.downQualityState=r.GetDownQualityState();var u="[color={0}]{1}[/color]/{2}",p=function(t,e){return t>=e?s.WHITE:s.RED},y=h.BigNum.shortNum(i),m=h.BigNum.shortNum(a),v=h.BigNum.shortNum(l),_=h.BigNum.shortNum(c),S=f.StringUtil.format(u,p(i,a),y,m),g=f.StringUtil.format(u,p(l,c),v,_);e.setSelectedIndex("\u964d\u7ea7\u663e\u793a",t.downLevelState||t.downQualityState?0:1),e.tm("\u6587\u672c_\u5347\u7ea7\u56fe\u7eb8").text=g,e.tm("\u6587\u672c_\u5347\u7ea7\u91d1\u5e01").text=S,this.UpdateEquipBaseInfo()},e.prototype.UpdateOnSynthesis=function(){},e.prototype.UpdateOnMallBuy=function(){var t=this,e=t.com,r=t.proxy.GetBuyInfo(),o=t.ModelMgr.ModelGoods.CreateGoodsByCmd({resId:r.payResId,number:String(r.payNumber)});e.tm("\u6309\u94ae_\u8d2d\u4e70.icon").SetUrlByIcon(o.GetIconUrl()),e.tm("\u6309\u94ae_\u8d2d\u4e70.title").text="X"+h.BigNum.shortNum(r.payNumber),e.setSelectedPage("\u80fd\u5426\u8d2d\u4e70",r.isCanBuy?"\u80fd":"\u5426")},e.prototype.updateOnMallBoxPreview=function(){var t=this.com,e=this.proxy.GetPreViewList(),r=t.tm("\u5217\u8868_\u9884\u89c8").asList;r.update(e),this.OnclickPreViewListByIndex(0),r.visible=e.length>1},e.prototype.OnclickPreViewListByIndex=function(t){var e=this.com.tm("\u5217\u8868_\u9884\u89c8").asList;e.selectedIndex=t,e.onClickItemWrap(e.getChildAt(t))},e.prototype.initOnclick=function(){var t=this,e=this,r=e.com;e.proxy,r.tm("panel_bg.\u6309\u94ae_\u5173\u95ed").setClick(function(){t.unload()},this),r.tm("\u6309\u94ae_\u7a7f\u6234\u5378\u4e0b").setClick(function(){t.proxy.GetOnclickBtn1()(),t.unload()},this),r.tm("\u6309\u94ae_\u5347\u7ea7").setClick(function(){t.upState?t.ModelMgr.ModelEquip.RequestEquipUpLevel(t.proxy.GetEquip().GetId()):e.CtrlAlert.LayerMessage.addMessage(c.FW.G_W("\u5347\u7ea7\u6240\u9700\u8981\u7684\u6750\u6599\u4e0d\u8db3\uff0c\u5feb\u53bb\u51c6\u5907\u51c6\u5907\u5427~"))},this),r.tm("\u6309\u94ae_\u4e00\u952e\u5347\u7ea7").setClick(function(){c.FW.ZJR.log("\u70b9\u51fb\u4e00\u952e\u5347\u7ea7\u6309\u94ae"),t.upState?t.ModelMgr.ModelEquip.RequestEquipUpLevelOneKey(t.proxy.GetEquip().GetId()):e.CtrlAlert.LayerMessage.addMessage(c.FW.G_W("\u5347\u7ea7\u6240\u9700\u8981\u7684\u6750\u6599\u4e0d\u8db3\uff0c\u5feb\u53bb\u51c6\u5907\u51c6\u5907\u5427~"))},this),r.tm("\u6309\u94ae_\u88c5\u5907\u5206\u89e3").setClick(function(){t.CtrlMain.LayerEquipDecomposition.SetEquip(t.proxy.GetEquip()),t.CtrlMain.LayerEquipDecomposition.SetInitialType(t.proxy.GetEquip().GetDownLevelState()?0:1),t.CtrlMain.LayerEquipDecomposition.load(),e.unload()},this),r.tm("\u6309\u94ae_\u8d2d\u4e70").setClick(function(){var t=e.proxy.GetPayObj();e.ModelMgr.ModelPay.Pay(t),e.unload()},e)},e.__cname="LayerItemDetailUI",i([u.injectField("CtrlMain")],e.prototype,"CtrlMain",void 0),i([u.injectField("CtrlAlert")],e.prototype,"CtrlAlert",void 0),i([u.injectField("ModelEquip")],e.prototype,"ModelEquip",void 0),i([u.injectField("LayerShowTip")],e.prototype,"LayerShowTip",void 0),i([u.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(m.GameLayerUI);r.LayerItemDetailUI=S,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/container/Container":void 0,"../../../../framework/layer/common/UIOrder":void 0,"../../../../framework/utils/StringUtil":void 0,"../../../../libutil/BigNum":void 0,"../../model/goods/ModelEquip":"ModelEquip","../../model/goods/ModelGoods":"ModelGoods","../../ui/GameLayer":"GameLayer"}],LayerJoystick:[function(t,e,r){"use strict";cc._RF.push(e,"42846sB49RGuo0G4ComdfLL","LayerJoystick");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerJoystickUI=r.LayerJoystick=void 0;var a=t("../../../../../../framework/container/Container"),l=t("../../../../../../framework/event/EventProxy"),s=t("../../../../../../framework/layer/common/UIOrder"),c=t("../../../../ui/GameLayer"),u=t("../joystick/JoystickModule"),p=t("./BattleLayerOrder"),f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.eventproxy=new l.EventProxy,e}return n(e,t),e.prototype.getUrl=function(){return"ui://\u6218\u6597/\u7ec4\u4ef6_\u6218\u6597\u5c42_\u6447\u6746"},e.prototype.getUIClass=function(){return h},e.prototype.SetCtrlable=function(t){this.ctrlable=t,this.GetUIReady()&&this.ui.updateCtrlable()},e.prototype.GetCtrlable=function(){return this.ctrlable},e.prototype.SetUIReady=function(t){this._UIReady=t},e.prototype.GetUIReady=function(){return this._UIReady},e.prototype.GetEventproxy=function(){return this.eventproxy},e.prototype.getSortOrder=function(){return s.LayerOrder.Main},e.prototype.getSortOrder2=function(){return p.BattleLayerOrder.Joystick},e.__cname="LayerJoystick",e}(c.GameLayerProxy);r.LayerJoystick=f;var h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getJoystick=function(){return this.joystick},e.prototype.getHasBackground=function(){return!1},e.prototype.init=function(){this.proxy.SetUIReady(!0),this.com.toFullCenterParent(this.container),this.joystick=new u.default(this.com.tm("\u7ec4\u4ef6_\u6447\u6746"),this.proxy.GetEventproxy());var t=this.com.tm("\u7ec4\u4ef6_\u6447\u6746");t.tm("joystick_center").alpha=.5,t.tm("joystick").alpha=.5,t.setSelectedPage("\u663e\u793a\u62d6\u66f3\u533a\u57df",this.Battle.startConfig.debug?"\u662f":"\u5426"),this.updateVisible(),this.updateCtrlable()},e.prototype.release=function(){this.proxy.SetUIReady(!1),this.joystick.removeAll(this),this.joystick=null},e.prototype.enter=function(){},e.prototype.exit=function(){},e.prototype.update=function(){},e.prototype.updateCtrlable=function(){var t=this._proxy.GetCtrlable();this.com.setSelectedPage("\u5141\u8bb8\u63a7\u5236",t?"\u662f":"\u5426"),this.joystick.setEnableEvent(t)},e.prototype.updateVisible=function(){var t=this.OnOffMgr.OnOffJoystick.GetValue();this.com.setSelectedPage("\u9690\u85cf\u6447\u6746",t?"\u5426":"\u662f")},e.__cname="LayerJoystickUI",i([a.injectField("Battle")],e.prototype,"Battle",void 0),i([a.injectField("OnOffMgr")],e.prototype,"OnOffMgr",void 0),e}(c.GameLayerUI);r.LayerJoystickUI=h,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../../../../../framework/event/EventProxy":void 0,"../../../../../../framework/layer/common/UIOrder":void 0,"../../../../ui/GameLayer":"GameLayer","../joystick/JoystickModule":"JoystickModule","./BattleLayerOrder":"BattleLayerOrder"}],LayerLoginLoading:[function(t,e,r){"use strict";cc._RF.push(e,"8ef245co8tCeprzGHstjJQd","LayerLoginLoading");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerLoginLoadingUI=r.LayerLoginLoading=r.LoadingState=r.LoadingType=void 0;var s,c,u=t("../../../../framework/container/Container"),p=t("../../../../framework/layer/common/UIOrder"),f=t("../../model/public/AppCustomData"),h=t("../../ui/GameLayer");(function(t){t[t.Login=0]="Login",t[t.Fight=1]="Fight"})(s=r.LoadingType||(r.LoadingType={})),function(t){t[t.Loading=0]="Loading",t[t.Finish=1]="Finish"}(c=r.LoadingState||(r.LoadingState={}));var y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.speed_progress=0,e}return n(e,t),e.prototype.getUIClass=function(){return d},e.prototype.getUrl=function(){return"ui://\u767b\u5f55_\u8fdb\u5ea6\u6761/\u7ec4\u4ef6_\u767b\u5f55_\u8fdb\u5ea6\u6761"},e.prototype.getSortOrder=function(){return p.LayerOrder.LoadingView},e.prototype.SetProgress=function(t){this.speed_progress=t,this.SetRunning(!0)},e.prototype.GetSpeedProgress=function(){return this.speed_progress},e.prototype.SetTitle=function(t){this.Title=t},e.prototype.GetTitle=function(){return this.Title},e.prototype.SetRunning=function(t){this.running=t},e.prototype.GetRunning=function(){return this.running},e.prototype.SetType=function(t){this.loadType=t},e.prototype.GetType=function(){return this.loadType},e.prototype.SetState=function(t){this.loadState=t},e.prototype.GetState=function(){return this.loadState},e.prototype.ResetProgress=function(){this.ui&&this.ui.ResetProgress()},e.prototype.GetIsResidentLayer=function(){return!0},e.prototype.GetIsGameLayer=function(){return!0},e.__cname="LayerLoginLoading",e}(h.GameLayerProxy);r.LayerLoginLoading=y;var d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.progress=0,e}return n(e,t),e.prototype.getHasBackground=function(){return!1},e.prototype.init=function(){var t=this;this.com.toFullCenterParent(this.container);var e=f.AppCustomData.instance.plateInfo.split("\\n").join("\n");this.com.tm("\u6587\u672c_\u7248\u53f7\u4fe1\u606f").text=e,this.com.tm("\u6309\u94ae_\u9002\u9f84").setClick(function(){t.CtrlMgr.CtrlLogin.LayerAgeTip.load()},this),this.updateView()},e.prototype.update=function(t){this.proxy.GetRunning()&&(this.updateProg(t),this.updateView())},e.prototype.updateView=function(){switch(this.com.tm("\u8fdb\u5ea6\u6761_\u6e38\u620f\u52a0\u8f7d").asProgress.value=this.progress,this.com.tm("\u6587\u672c_\u6e38\u620f\u52a0\u8f7d").asTextField.setVar("progress",this.progress.toFixed(2)).flushVars(),this.com.tm("\u6587\u672c_\u52a0\u8f7d\u63d0\u793a").text=this.proxy.GetTitle(),this.proxy.GetType()){case s.Login:this.com.setSelectedPage("\u7c7b\u578b","\u767b\u5f55");break;case s.Fight:this.com.setSelectedPage("\u7c7b\u578b","\u52a0\u8f7d");break;default:this.com.setSelectedPage("\u7c7b\u578b","\u52a0\u8f7d")}switch(this.proxy.GetState()){case c.Loading:this.com.setSelectedPage("\u72b6\u6001","\u52a0\u8f7d\u4e2d");break;case c.Finish:this.com.setSelectedPage("\u72b6\u6001","\u5df2\u5b8c\u6210");break;default:this.com.setSelectedPage("\u72b6\u6001","\u52a0\u8f7d\u4e2d")}},e.prototype.updateProg=function(t){return a(this,void 0,void 0,function(){var e,r;return l(this,function(){return e=this.proxy.GetSpeedProgress(),r=Math.max(e,0),this.progress<r?this.progress=this.lerp(this.progress,r,t/1e3):this.proxy.SetRunning(!1),[2]})})},e.prototype.lerp=function(t,e,r){return t+(e-t)*r},e.prototype.ResetProgress=function(){this.progress=0},e.__cname="LayerLoginLoadingUI",i([u.injectField("CtrlMgr")],e.prototype,"CtrlMgr",void 0),e}(h.GameLayerUI);r.LayerLoginLoadingUI=d,cc._RF.pop()},{"../../../../framework/container/Container":void 0,"../../../../framework/layer/common/UIOrder":void 0,"../../model/public/AppCustomData":"AppCustomData","../../ui/GameLayer":"GameLayer"}],LayerLogin:[function(t,e,r){"use strict";cc._RF.push(e,"ddea9MB2qNFt6DDxOssHpGE","LayerLogin");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerLoginUI=r.LayerLogin=void 0;var s=t("../../../../engine/EngineMain"),c=t("../../../../framework/container/Container"),u=t("../../../../framework/Func"),p=t("../../../../framework/FW"),f=t("../../../../framework/layer/common/UIOrder"),h=t("../../../../framework/utils/StringUtil"),y=t("../../gamestate/GameStateMgr"),d=t("../../ui/GameScene"),m=t("../DataReporting/DataReportingInterface"),v=t("../sdk/SDKMgr"),_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._IsLogin=!1,e}return n(e,t),e.prototype.getUIClass=function(){return S},e.prototype.getUrl=function(){return"ui://\u767b\u5f55/\u7ec4\u4ef6_\u767b\u5f55_\u4e3b\u754c\u9762"},e.prototype.SetIsLogin=function(t){this._IsLogin=t},e.prototype.GetIsLogin=function(){return this._IsLogin},e.prototype.getSortOrder=function(){return f.LayerOrder.Scene},e.__cname="LayerLogin",e}(d.GameSceneProxy);r.LayerLogin=_;var S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.speed_background=-1,e.speed_cloud=-2,e.hasUserAgreement=!0,e.isSelect=!1,e}return n(e,t),e.prototype.initAsync=function(){return a(this,void 0,Promise,function(){return l(this,function(t){switch(t.label){case 0:return[4,p.FW.FairyMgr.loadByPkgNameAsync("\u767b\u5f55_\u516c\u7528\u5305",!0)];case 1:return t.sent(),[2]}})})},e.prototype.init=function(){var t=this;this.hasUserAgreement=this.SDKMgr.getSDK().HasUserAgreement(),this.com.toFullCenterParent(this.container),this.UpdatePorcessActive(),this.InitAge(),this.com.tm("\u6309\u94ae_\u5f00\u59cb\u6e38\u620f").setClick(function(){if(0!=t.proxy.GetIsLogin()){var e=c.Container.inst().getByAlias("DataReporting");if(t.hasUserAgreement&&!t.isSelect)return e.PushBuriedList(m.SingleBuriedPointType.tip_agree_agreement),t.LayerShowTip.SetData({context:"\u8bf7\u540c\u610f\u7528\u6237\u534f\u8bae\uff0c\u548c\u9690\u79c1\u653f\u7b56\u3002\u53ea\u6709\u6253\u52fe\u540e\u624d\u80fd\u6b63\u5e38\u8fdb\u5165\u6e38\u620f\u3002"}),void t.LayerShowTip.load();e.PushBuriedList(m.SingleBuriedPointType.start_game),y.GameStateMgr.instance.switchToRunning()}},this),this.setFairyBtnEvent(this.com.tm("\u6309\u94ae_\u516c\u544a"),function(){return a(t,void 0,void 0,function(){return l(this,function(t){switch(t.label){case 0:return[4,this.CtrlNotice.RequestNoticeData()];case 1:return t.sent().json.list.length?this.CtrlNotice._LayerNotice.load():(this.LayerShowTip.SetData({context:p.FW.G_W("\u5730\u5e9c\u53d1\u6765\u7684\u516c\u544a\u4e22\u5931\u4e86~")}),this.LayerShowTip.load()),[2]}})})})},e.prototype.exit=function(){var t=s.EngineMain.readLocalStorage("account_num"),e=h.StringUtil.format("age_{0}",t);s.EngineMain.saveLocalStorage(e,this.isSelect)},e.prototype.update=function(){this.ImageMove(this.com.tm("\u56fe\u7247_\u4e91\u96fe"),this.com.tm("\u56fe\u7247_\u4e91\u96fe_\u526f"),this.speed_cloud,!1),this.ImageMove(this.com.tm("\u56fe\u7247_\u4e0b\u534a_\u4e91\u96fe"),this.com.tm("\u56fe\u7247_\u4e0b\u534a_\u4e91\u96fe_\u526f"),this.speed_cloud,!1),this.UpdatePorcessActive()},e.prototype.InitAge=function(){var t=this,e=t.com;e.tm("\u534f\u8bae\u76f8\u5173").visible=t.hasUserAgreement;var r=t.AppCustomData.plateInfo.split("\\n").join("\n");this.log(r),e.tm("\u6587\u672c_\u7248\u53f7\u4fe1\u606f").text=r,e.tm("\u6309\u94ae_\u9002\u9f84").setClick(function(){t.CtrlLogin.LayerAgeTip.load()},t);var o=s.EngineMain.readLocalStorage("account_num"),n=h.StringUtil.format("age_{0}",o),i=s.EngineMain.readLocalStorage(n,"false");t.isSelect="false"!=i,e.tm("\u6309\u94ae_\u52fe\u9009").asButton.selected=t.isSelect,e.tm("\u6309\u94ae_\u52fe\u9009").setClick(function(){t.isSelect=!t.isSelect},t),e.tm("\u6587\u672c_\u7528\u6237\u534f\u8bae").setClick(function(){u.Func.copy(v.SDKMgr.instance.getSDK().userAgreement())},t),e.tm("\u6587\u672c_\u9690\u79c1\u534f\u8bae").setClick(function(){u.Func.copy(v.SDKMgr.instance.getSDK().privacyAgreement())},t)},e.prototype.UpdatePorcessActive=function(){var t=this.proxy.GetIsLogin();this._lastState!=t&&(this._lastState=t,this.com.setSelectedPage("\u72b6\u6001",t?"\u767b\u5f55\u6e38\u620f":"\u52a0\u8f7d\u4e2d"))},e.prototype.ImageMove=function(t,e,r,o){void 0===o&&(o=!1);var n=t.y,i=t.x,a=e.x;t.setPosition(i+r,n),e.setPosition(a+r,n);var l=function(e,r){var i=t.width;e.x<=-i&&(e.setPosition(i+r.x-1,n),o&&(e.node.zIndex=0,r.node.zIndex=-1))};l(t,e),l(e,t)},e.__cname="LayerLoginUI",i([c.injectField("CtrlLogin")],e.prototype,"CtrlLogin",void 0),i([c.injectField("CtrlNotice")],e.prototype,"CtrlNotice",void 0),i([c.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([c.injectField("SDKMgr")],e.prototype,"SDKMgr",void 0),i([c.injectField("LayerShowTip")],e.prototype,"LayerShowTip",void 0),i([c.injectField("AppCustomData")],e.prototype,"AppCustomData",void 0),e}(d.GameScene);r.LayerLoginUI=S,cc._RF.pop()},{"../../../../engine/EngineMain":void 0,"../../../../framework/FW":void 0,"../../../../framework/Func":void 0,"../../../../framework/container/Container":void 0,"../../../../framework/layer/common/UIOrder":void 0,"../../../../framework/utils/StringUtil":void 0,"../../gamestate/GameStateMgr":"GameStateMgr","../../ui/GameScene":"GameScene","../DataReporting/DataReportingInterface":"DataReportingInterface","../sdk/SDKMgr":"SDKMgr"}],LayerLogoutTips:[function(t,e,r){"use strict";cc._RF.push(e,"e6b67qcEo1Jb5+CBoXOEd9z","LayerLogoutTips");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerLogoutTipsUI=r.LayerLogoutTips=void 0;var s=t("../../../../../../framework/container/Container"),c=t("../../../../../../framework/FW"),u=t("../../../../../../framework/layer/common/UIOrder"),p=t("../../../../ui/GameLayer"),f=t("../../../sdk/SDKInterface"),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return y},e.prototype.getUrl=function(){return"ui://\u7cfb\u7edf\u8bbe\u7f6e/\u7ec4\u4ef6_\u7cfb\u7edf\u8bbe\u7f6e_\u9000\u51fa\u6e38\u620f\u63d0\u793a"},e.prototype.getSortOrder=function(){return u.LayerOrder.TipsUI},e.__cname="LayerLogoutTips",e}(p.GameLayerProxy);r.LayerLogoutTips=h;var y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getHasBackground=function(){return!0},e.prototype.GetHasCloseAnimation=function(){return!0},e.prototype.GetHasShowAnimation=function(){return!0},e.prototype.init=function(){this.com.toFullCenterParent(this.container),this.InitClick()},e.prototype.InitClick=function(){var t=this,e=this,r=e.com;this.setFairyBtnEvent(r.tm("\u6309\u94ae_\u786e\u5b9a"),function(){return a(t,void 0,void 0,function(){return l(this,function(t){switch(t.label){case 0:return s.Container.inst().getByAlias("SDKDataReporting").BuriedPoint(f.SubmitDataUserInfoType.exitGame),[4,this.SDKMgr.getSDK().logOut()];case 1:return t.sent(),this.GameStateMgr.switchToLogin(),[2]}})})}),r.tm("\u6309\u94ae_\u53d6\u6d88").setClick(function(){e.unload()},e),r.tm("panel_bg.\u6309\u94ae_\u5173\u95ed").setClick(function(){c.FW.LWX.log("\u70b9\u51fb\u53d6\u6d88"),e.unload()},e)},e.__cname="LayerLogoutTipsUI",i([s.injectField("GameStateMgr")],e.prototype,"GameStateMgr",void 0),i([s.injectField("SDKMgr")],e.prototype,"SDKMgr",void 0),e}(p.GameLayerUI);r.LayerLogoutTipsUI=y,cc._RF.pop()},{"../../../../../../framework/FW":void 0,"../../../../../../framework/container/Container":void 0,"../../../../../../framework/layer/common/UIOrder":void 0,"../../../../ui/GameLayer":"GameLayer","../../../sdk/SDKInterface":"SDKInterface"}],LayerLuckyCat:[function(t,e,r){"use strict";cc._RF.push(e,"908e8lj3mtFib7kefEwFrah","LayerLuckyCat");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerLuckyCatUI=r.LayerLuckyCat=void 0;var s=t("../../../../framework/container/Container"),c=t("../../../../framework/FW"),u=t("../../../../framework/layer/common/UIOrder"),p=t("../../../../framework/utils/StringUtil"),f=t("../../model/System/ModelSystem"),h=t("../../ui/GameLayer"),y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return d},e.prototype.getUrl=function(){return"ui://\u9996\u9875_\u4fee\u70bc_\u62db\u8d22\u732b/\u7ec4\u4ef6_\u4fee\u70bc_\u62db\u8d22\u9876\u5471\u5471\u5145\u503c"},e.prototype.getSortOrder=function(){return u.LayerOrder.OneLevel},e.prototype.getSystemId=function(){return f.SystemId.LuckyCat},e.__cname="LayerLuckyCat",e}(h.GameLayerProxy);r.LayerLuckyCat=y;var d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getHasBackground=function(){return!0},e.prototype.init=function(){var t=this;this.com.toFullCenterParent(this.container),this.InitClick(),this.toolSet.addListener(this.ModelMgr.ModelVO.VOLuckyCatBag.GetEventProxy(),"OnChange",function(){t.UpdateView()},this)},e.prototype.enter=function(){this.UpdateView()},e.prototype.InitClick=function(){var t=this,e=this,r=e.com;r.tm("panel_bg.\u6309\u94ae_\u5173\u95ed").setClick(function(){e.unload()},e),this.setFairyBtnEvent(r.tm("\u6309\u94ae_\u8d2d\u4e70"),function(){return a(t,void 0,void 0,function(){var t,r,o,n,i;return l(this,function(a){switch(a.label){case 0:return null==(t=this.ModelMgr.ModelVO.VOLuckyCatBag.GetOne())?(this.unload(),[2]):(r=t.GetRef(),o=r.last,t.GetProcess()<o?(c.FW.showTip(c.FW.G_W("\u80fd\u91cf\u6761\u6512\u6ee1\u540e\u624d\u80fd\u8d2d\u4e70\u54e6~")),[2]):(n=e.ModelMgr.ModelMall.GetGoodByFromId(r.fromId),i=e.ModelMgr.ModelMall.GetPayChannelByKey(n.key),c.FW.showLoading(),[4,this.SDKMgr.getSDK().PPP(i.id,n.type,n.fromId)]));case 1:return a.sent(),c.FW.removeLoading(),[2]}})})})},e.prototype.UpdateView=function(){var t=this,e=t.com,r=this.ModelMgr.ModelVO.VOLuckyCatBag.GetOne();if(null!=r){var o=r.GetRef(),n=t.ModelMgr.ModelMall.GetGoodByFromId(o.fromId),i=t.ModelMgr.ModelMall.GetPayChannelByKey(n.key);e.tm("\u88c5\u8f7d\u5668_\u798f\u86cb").SetUrlByIcon(o.fuIcon),e.tm("effect").SetUrlByIcon(o.effect),e.tm("\u88c5\u8f7d\u5668_\u57fa\u7840\u5956\u52b1").SetUrlByIcon(o.baseIcon),e.tm("\u88c5\u8f7d\u5668_\u6700\u7ec8\u5956\u52b1").SetUrlByIcon(o.lastIcon),e.tm("\u8fdb\u5ea6\u6761_\u798f\u86cb\u8fdb\u5ea6.title.icon").SetUrlByIcon(o.progressIcon);var a=o.base,l=o.last,s=o.magnification[o.resId],u=r.GetProcess();e.tm("panel_bg.title").text=o.title,e.tm("\u6587\u672c_\u57fa\u7840\u5956\u52b1").text=a.toString(),e.tm("\u6587\u672c_\u6700\u7ec8\u5956\u52b1").text=l.toString(),e.tm("\u6587\u672c_\u500d\u7387").asTextField.setVar("bei",s.toString()).flushVars();var f=e.tm("\u8fdb\u5ea6\u6761_\u798f\u86cb\u8fdb\u5ea6").asProgress;f.max=l,f.min=a,f.value=u;var h=e.tm("\u6309\u94ae_\u8d2d\u4e70").asCom;h.tm("title").text=p.StringUtil.format(c.FW.G_W("{0}\u5143"),i.rmb),h.grayed=u<l}else this.unload()},e.__cname="LayerLuckyCatUI",i([s.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([s.injectField("SDKMgr")],e.prototype,"SDKMgr",void 0),e}(h.GameLayerUI);r.LayerLuckyCatUI=d,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/container/Container":void 0,"../../../../framework/layer/common/UIOrder":void 0,"../../../../framework/utils/StringUtil":void 0,"../../model/System/ModelSystem":"ModelSystem","../../ui/GameLayer":"GameLayer"}],LayerMailVerbose:[function(t,e,r){"use strict";cc._RF.push(e,"81eb5/hBwNF65gCp83wvoIY","LayerMailVerbose");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerMailVerboseUI=r.LayerMailVerbose=void 0;var c=t("../../../../../framework/FW"),u=t("../../../../../framework/container/Container"),p=t("../../../../../framework/layer/common/UIOrder"),f=t("../../../ui/GameLayer"),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return y},e.prototype.getUrl=function(){return"ui://\u9996\u9875\u4fee\u70bc_\u90ae\u4ef6\u7cfb\u7edf/\u9996\u9875_\u4fee\u70bc_\u90ae\u4ef6\u8be6\u60c5"},e.prototype.getSortOrder=function(){return p.LayerOrder.TowLevel},e.__cname="LayerMailVerbose",e}(f.GameLayerProxy);r.LayerMailVerbose=h;var y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getHasBackground=function(){return!0},e.prototype.init=function(t){this.com.toFullCenterParent(this.container),t&&"number"==typeof t&&(this.id=t),this.InitClick(),this.InitList()},e.prototype.enterAsync=function(){return a(this,void 0,Promise,function(){var t;return l(this,function(e){switch(e.label){case 0:return this.id?[4,this.ModelMgr.ModelMail.RequestMail(this.id)]:(c.FW.LWX.error("\u6ca1\u6709\u521d\u59cb\u5316ID\uff0c \u65e0\u6cd5\u83b7\u53d6\u90ae\u4ef6\u8be6\u7ec6\u6570\u636e!!!"),[2]);case 1:return t=e.sent(),this.mailData=t,[2]}})})},e.prototype.enter=function(){this.UpdateView()},e.prototype.exit=function(){this.mailData=null},e.prototype.InitClick=function(){var t=this,e=this.com;e.tm("panel_bg.\u6309\u94ae_\u5173\u95ed").setClick(function(){t.unload()},this),this.setFairyBtnEvent(e.tm("\u6309\u94ae_\u9886\u53d6"),function(){return a(t,void 0,void 0,function(){var t,e;return l(this,function(r){switch(r.label){case 0:return t=this.mailData&&this.mailData.drawState,this.log(this.mailData),0!=t?[3,2]:this.id?(c.FW.showLoading(),[4,this.ModelMgr.ModelMail.RequestMailDraw(this.id)]):[2];case 1:return e=r.sent(),c.FW.removeLoading(),e&&(this.mailData.drawState=1,this.UpdateView()),[3,3];case 2:this.UpdateView(),r.label=3;case 3:return[2]}})})}),this.setFairyBtnEvent(e.tm("\u6309\u94ae_\u5220\u9664"),function(){return a(t,void 0,void 0,function(){var t;return l(this,function(e){switch(e.label){case 0:return c.FW.showLoading(),[4,this.ModelMgr.ModelMail.RequestMailDelete(this.id)];case 1:return t=e.sent(),c.FW.removeLoading(),this.log(t),t&&this.unload(),[2]}})})})},e.prototype.InitList=function(){var t=this;this.com.tm("\u5217\u8868_\u5956\u52b1\u5217\u8868").asList.init(this,function(e,r,o){var n=r.asCom.tm("com_goods");n.UpdateByGoods(o),n.ClickItem(!0,o,t.proxy)})},e.prototype.UpdateView=function(){var t,e,r,o,n=this.mailData;if(null!=n){var i=this.com,a=i.tm("\u5217\u8868_\u5956\u52b1\u5217\u8868").asList,l=n&&n.cmdGoodsList;if(l[0].tlCmdGoods.length>0){this.com.setSelectedPage("\u5956\u52b1\u9886\u53d6","\u6709");var c=[];try{for(var u=s(l),p=u.next();!p.done;p=u.next()){var f=p.value;if(f)try{for(var h=(r=void 0,s(f.tlCmdGoods)),y=h.next();!y.done;y=h.next()){var d=y.value,m=this.ModelMgr.ModelGoods.CreateGoodsByCmd(d);c.push(m)}}catch(v){r={error:v}}finally{try{y&&!y.done&&(o=h.return)&&o.call(h)}finally{if(r)throw r.error}}}}catch(_){t={error:_}}finally{try{p&&!p.done&&(e=u.return)&&e.call(u)}finally{if(t)throw t.error}}a.update(c)}else this.com.setSelectedPage("\u5956\u52b1\u9886\u53d6","\u65e0");i.tm("panel_bg.title").text=n.title,i.tm("\u6587\u672c_\u5185\u5bb9").text=n.content,i.setSelectedPage("\u662f\u5426\u9886\u53d6",0==n.drawState?"\u5426":"\u662f")}else this.unload()},e.__cname="LayerMailVerboseUI",i([u.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(f.GameLayerUI);r.LayerMailVerboseUI=y,cc._RF.pop()},{"../../../../../framework/FW":void 0,"../../../../../framework/container/Container":void 0,"../../../../../framework/layer/common/UIOrder":void 0,"../../../ui/GameLayer":"GameLayer"}],LayerMail:[function(t,e,r){"use strict";cc._RF.push(e,"6d0a8AIPlBEvayOqYnXHBhm","LayerMail");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerMailUI=r.LayerMail=void 0;var s=t("../../../../../framework/container/Container"),c=t("../../../../../framework/FW"),u=t("../../../../../framework/layer/common/UIOrder"),p=t("../../../model/System/ModelSystem"),f=t("../../../ui/GameLayer"),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return y},e.prototype.getUrl=function(){return"ui://\u9996\u9875\u4fee\u70bc_\u90ae\u4ef6\u7cfb\u7edf/\u7ec4\u4ef6_\u4fee\u70bc_\u90ae\u4ef6\u7cfb\u7edf"},e.prototype.getSortOrder=function(){return u.LayerOrder.TowLevel},e.prototype.getSystemId=function(){return p.SystemId.Mail},e.__cname="LayerMail",e}(f.GameLayerProxy);r.LayerMail=h;var y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getHasBackground=function(){return!0},e.prototype.GetHasCloseAnimation=function(){return!0},e.prototype.GetHasShowAnimation=function(){return!0},e.prototype.init=function(){this.com.toFullCenterParent(this.container),this.toolSet.addListener(this.ModelMgr.ModelMail.GetEventProxy(),"OnMailListChanged",this.OnUpdateMailList,this),this.InitLayer(),this.InitClick()},e.prototype.enter=function(){c.FW.LWX.log("\u521d\u59cb\u5316\u90ae\u4ef6\u6570\u636e")},e.prototype.enterAsync=function(){return a(this,void 0,Promise,function(){return l(this,function(t){switch(t.label){case 0:return this.com.setSelectedIndex("\u90ae\u4ef6\u4fe1\u606f",0),c.FW.showLoading(),[4,this.ModelMgr.ModelMail.UpdateMailList()];case 1:return t.sent(),c.FW.removeLoading(),[2]}})})},e.prototype.InitLayer=function(){var t=this;t.com.tm("\u5217\u8868_\u90ae\u4ef6\u4fe1\u606f").init(this,function(e,r,o){var n=r;n.tm("\u6587\u672c_\u6807\u9898").text=o.title,n.tm("\u6587\u672c_\u65f6\u95f4").text=t.TimeUtil.time2String2(o.time,!0);var i=o.readState,a=o.drawState;n.setSelectedPage("\u662f\u5426\u5df2\u8bfb",1==i?"\u662f":"\u5426"),n.setSelectedPage("\u662f\u5426\u5df2\u9886\u53d6",1==a?"\u662f":"\u5426")},function(e,r,o){t.LayerMailVerbose.load(o.id)})},e.prototype.InitClick=function(){var t=this;t.com.tm("panel_bg.\u6309\u94ae_\u5173\u95ed").setClick(function(){t.unload()},t)},e.prototype.OnUpdateMailList=function(){var t=this.UpdateData();t.length>0?this.com.setSelectedIndex("\u90ae\u4ef6\u4fe1\u606f",1):this.com.setSelectedIndex("\u90ae\u4ef6\u4fe1\u606f",0),this.UpdateView(t)},e.prototype.UpdateData=function(){return this.ModelMgr.ModelMail.GetMailList()},e.prototype.UpdateView=function(t){return a(this,void 0,void 0,function(){var e;return l(this,function(){return(e=this.com).tm("\u5217\u8868_\u90ae\u4ef6\u4fe1\u606f").asList.update(t),e.tm("\u6587\u672c_\u90ae\u4ef6\u6570\u91cf").asTextField.setVar("min",t.length.toString()).setVar("max",this.ModelMgr.ModelMail.GetmaxMail().toString()).flushVars(),c.FW.LWX.log("\u6e32\u67d3\u90ae\u4ef6\u5217\u8868"),[2]})})},e.__cname="LayerMailUI",i([s.injectField("TimeUtil")],e.prototype,"TimeUtil",void 0),i([s.injectField("LayerMailVerbose")],e.prototype,"LayerMailVerbose",void 0),i([s.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(f.GameLayerUI);r.LayerMailUI=y,cc._RF.pop()},{"../../../../../framework/FW":void 0,"../../../../../framework/container/Container":void 0,"../../../../../framework/layer/common/UIOrder":void 0,"../../../model/System/ModelSystem":"ModelSystem","../../../ui/GameLayer":"GameLayer"}],LayerMainAnimation:[function(t,e,r){"use strict";cc._RF.push(e,"06473x0vm9HaaLhGK0QL/fW","LayerMainAnimation");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a},l=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerMainAnimationUI=r.LayerMainAnimation=void 0;var s=t("../../../../framework/container/Container"),c=t("../../../../framework/fgui/FairyMgr"),u=t("../../../../framework/layer/common/UIOrder"),p=t("../../../../framework/pool/Pool"),f=t("../../../../framework/tween/TweenEase"),h=t("../../model/goods/ModelGoods"),y=t("../../ui/GameLayer"),d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.goods=[],e}return n(e,t),e.prototype.getUIClass=function(){return m},e.prototype.getUrl=function(){return"ui://\u9996\u9875/\u7ec4\u4ef6_\u7279\u6548\u5c42"},e.prototype.getSortOrder=function(){return u.LayerOrder.TipsUI},e.prototype.pushGoods=function(t){this.goods.push(t),0==this.isLoad&&this.load()},e.prototype.getGoods=function(){return this.goods},e.__cname="LayerMainAnimation",e}(y.GameLayerProxy);r.LayerMainAnimation=d;var m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.effects=new Set,e.animData=new Map,e.during=0,e.rmList=[],e}return n(e,t),e.prototype.getHasBackground=function(){return!1},e.prototype.init=function(){this.com.toFullCenterParent(this.container),this.initEffect()},e.prototype.release=function(){this.releaseEffect()},e.prototype.update=function(t){for(var e,r,o,n,i=this.proxy.getGoods(),s=fgui.GRoot.inst.width,c=fgui.GRoot.inst.height;i.length>0;){var u=i.shift(),p=this.pool.getFromPool(u);this.effects.add(p);var h=p.tmt("\u52a8\u753b").getTransitionTime();this.during=h;var y=s/2,d=c/2,m=a(this.getPos(u.GetRefId()),2),v=m[0],_=m[1],S=0,g=0,b=1,C=h;this.animData.set(p,[S,g,b,C,y,d,v,_])}var R=this.animData,M=this.rmList;try{for(var w=l(this.effects),O=w.next();!O.done;O=w.next()){p=O.value;var B=R.get(p),P=a(B,8);if(S=P[0],g=P[1],b=P[2],C=P[3],y=P[4],d=P[5],v=P[6],_=P[7],S+=t,B[0]=S,S>C)this.rmList.push(p);else{var G=f.TweenEase.Quad.easeIn(S,g,b,C);p.x=cc.misc.lerp(y,v,G),p.y=cc.misc.lerp(d,_,G)}}}catch(T){e={error:T}}finally{try{O&&!O.done&&(r=w.return)&&r.call(w)}finally{if(e)throw e.error}}try{for(var k=l(M),x=k.next();!x.done;x=k.next())p=x.value,this.effects.delete(p),this.animData.delete(p),this.pool.returnToPool(p)}catch(j){o={error:j}}finally{try{x&&!x.done&&(n=k.return)&&n.call(k)}finally{if(o)throw o.error}}M.length=0,this.during-=t,this.during<0&&this.unload()},e.prototype.initEffect=function(){var t=this.com.tm("\u7279\u6548\u5c42").asCom;this.pool=new p.Pool(function(){var e=c.FairyMgr.instance.createCom2("ui://\u9996\u9875/\u7ec4\u4ef6_\u7279\u6548_\u91d1\u5e01\u52a8\u6548");return t.addChildAt(e,0),e},function(t){t.destroy()},function(t,e){t.visible=!0;for(var r=0;r<t.numChildren;r++)t.getChildAt(r).SetUrlByIcon(e.GetIconUrl());t.tmt("\u52a8\u753b").play()},function(t){return t.visible=!1,!0})},e.prototype.releaseEffect=function(){this.pool.returnAllToPool(),this.pool.destroy()},e.prototype.getPos=function(t){var e;switch(t){case h.ECurrencyType.sta:case h.ECurrencyType.gene:e=this.com.tm("\u76ee\u6807_\u4f53\u529b\u548c\u57fa\u56e0");break;case h.ECurrencyType.xp:e=this.com.tm("\u76ee\u6807_\u7ecf\u9a8c");break;case h.ECurrencyType.gem:e=this.com.tm("\u76ee\u6807_\u5b9d\u77f3");break;case h.ECurrencyType.coin:case h.ECurrencyType.energy:e=this.com.tm("\u76ee\u6807_\u91d1\u5e01");break;case h.ECurrencyType.reborn_coin:case h.ECurrencyType.silver_key:case h.ECurrencyType.gold_key:case h.ECurrencyType.diamond_key:e=this.com.tm("\u76ee\u6807_\u80cc\u5305");break;default:e=this.com.tm("\u76ee\u6807_\u73a9\u5bb6\u5934\u50cf")}return[e.x,e.y]},e.__cname="LayerMainAnimationUI",i([s.injectField("ModelGoods")],e.prototype,"ModelGoods",void 0),e}(y.GameLayerUI);r.LayerMainAnimationUI=m,cc._RF.pop()},{"../../../../framework/container/Container":void 0,"../../../../framework/fgui/FairyMgr":void 0,"../../../../framework/layer/common/UIOrder":void 0,"../../../../framework/pool/Pool":void 0,"../../../../framework/tween/TweenEase":void 0,"../../model/goods/ModelGoods":"ModelGoods","../../ui/GameLayer":"GameLayer"}],LayerMainMenu:[function(t,e,r){"use strict";cc._RF.push(e,"e3a8dCXZsVDUraMa/ZgNeCt","LayerMainMenu");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerMainMenuUI=r.LayerMainMenu=void 0;var a=t("../../../../framework/container/Container"),l=t("../../../../framework/fgui/FairyMgr"),s=t("../../../../framework/layer/common/UIOrder"),c=t("../../ui/GameLayer"),u=t("./Adventure/TabAdventure"),p=t("./TabHero"),f=t("./Xiulian/TabXiulian"),h=t("./mall/TabMall"),y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return d},e.prototype.getUrl=function(){return"ui://\u9996\u9875/\u7ec4\u4ef6_\u9996\u9875_\u83dc\u5355\u5c42"},e.prototype.getSortOrder=function(){return s.LayerOrder.Main},e.__cname="LayerMainMenu",e}(c.GameLayerProxy);r.LayerMainMenu=y;var d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.init=function(){this.com.toFullCenterParent(this.container);var t=this.com;l.FairyMgr.instance.fitByGrootScaleX(t.tm("\u7ec4\u4ef6_\u9996\u9875_\u5e95\u83dc\u5355").asCom.getChildAt(0))},e.prototype.getHasBackground=function(){return!1},e.prototype.SetupTabBehavior2=function(t,e){var r=this.com.tm("\u7ec4\u4ef6_\u9996\u9875_\u5e95\u83dc\u5355"),o=r.tm("\u6309\u94ae_\u4fee\u70bc");if(e.SetTabBtnBehavior(t.getTab(f.TabXiulian),{btn:o,onVisibleChanged:function(t,e,r){t.setSelectedPage("\u662f\u5426\u89e3\u9501",r?"\u662f":"\u5426")},onCallBack:function(){r.setSelectedPage("\u9875\u9762","\u4fee\u70bc")},onRdChanged:function(t){console.log("\u65e5\u5e38num:",t),o.asCom.tm("\u7ea2\u70b9").OnRDUpdate(t)}}),this.CtrlMgr.CtrlPay.GetCantPay())r.tm("\u6309\u94ae_\u5546\u5e97").visible=!1;else if(this.CtrlMgr.CtrlPay.getPayVisible){var n=r.tm("\u6309\u94ae_\u5546\u5e97");e.SetTabBtnBehavior(t.getTab(h.TabMall),{btn:n,onVisibleChanged:function(t,e,r){t.setSelectedPage("\u662f\u5426\u89e3\u9501",r?"\u662f":"\u5426")},onCallBack:function(){r.setSelectedPage("\u9875\u9762","\u5546\u5e97")},onRdChanged:function(t){n.asCom.tm("\u7ea2\u70b9").OnRDUpdate(t)}})}var i=r.tm("\u6309\u94ae_\u82f1\u96c4");e.SetTabBtnBehavior(t.getTab(p.TabHero),{btn:i,onVisibleChanged:function(t,e,r){t.setSelectedPage("\u662f\u5426\u89e3\u9501",r?"\u662f":"\u5426")},onCallBack:function(){r.setSelectedPage("\u9875\u9762","\u82f1\u96c4")},onRdChanged:function(t){i.asCom.tm("\u7ea2\u70b9").OnRDUpdate(t)}});var a=r.tm("\u6309\u94ae_\u6d88\u707e");e.SetTabBtnBehavior(t.getTab(u.TabAdventure),{btn:a,onVisibleChanged:function(t,e,r){t.setSelectedPage("\u662f\u5426\u89e3\u9501",r?"\u662f":"\u5426")},onCallBack:function(){r.setSelectedPage("\u9875\u9762","\u6d88\u707e")},onRdChanged:function(t){a.asCom.tm("\u7ea2\u70b9").OnRDUpdate(t)}}),r.tm("\u6309\u94ae_\u4ed9\u7f18").visible=!1},e.__cname="LayerMainMenuUI",i([a.injectField("LayerMain")],e.prototype,"LayerMain",void 0),e}(c.GameLayerUI);r.LayerMainMenuUI=d,cc._RF.pop()},{"../../../../framework/container/Container":void 0,"../../../../framework/fgui/FairyMgr":void 0,"../../../../framework/layer/common/UIOrder":void 0,"../../ui/GameLayer":"GameLayer","./Adventure/TabAdventure":"TabAdventure","./TabHero":"TabHero","./Xiulian/TabXiulian":"TabXiulian","./mall/TabMall":"TabMall"}],LayerMainResources:[function(t,e,r){"use strict";cc._RF.push(e,"1edeatAv9hC4LygnYe7ZCE6","LayerMainResources");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerMainResourcesUI=r.LayerMainResources=void 0;var l=t("../../../../framework/container/Container"),s=t("../../../../framework/layer/common/UIOrder"),c=t("../../../../framework/utils/StringUtil"),u=t("../../../../libutil/BigNum"),p=t("../../model/System/ModelSystem"),f=t("../../model/goods/ModelGoods"),h=t("../../ui/GameLayer"),y=new Set;y.add(f.ECurrencyType.sta),y.add(f.ECurrencyType.gem),y.add(f.ECurrencyType.coin);var d=new Map;d.set(f.ECurrencyType.sta,"\u7ec4\u4ef6_\u8d44\u6e90\u4fe1\u606f0"),d.set(f.ECurrencyType.gem,"\u7ec4\u4ef6_\u8d44\u6e90\u4fe1\u606f1"),d.set(f.ECurrencyType.coin,"\u7ec4\u4ef6_\u8d44\u6e90\u4fe1\u606f2");var m=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return v},e.prototype.getUrl=function(){return"ui://\u9996\u9875/\u7ec4\u4ef6_\u8d44\u6e90\u680f"},e.prototype.getSortOrder=function(){return s.LayerOrder.ResourceUI},e.__cname="LayerMainResources",e}(h.GameLayerProxy);r.LayerMainResources=m;var v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isupdate=!0,e.dirty=!1,e}return n(e,t),e.prototype.getHasBackground=function(){return!1},e.prototype.init=function(){var t=this;this.com.toFullCenterParent(this.container),this.toolSet.addListener(this.ModelMgr.ModelVO.VORoleBag.GetEventProxy(),"OnChanged",function(){t.updateRoleInfo(),t.markDirty()}),this.toolSet.addCallback(this.CtrlAnimation.onChangeResourceCallBack,function(e){y.has(e)&&t.getResouceCom(e).asCom.tmt("\u8d44\u6e90\u8df3\u52a8").play()}),this.AddBtnBehavior(this.com.tm("\u7ec4\u4ef6_\u73a9\u5bb6\u4fe1\u606f.fram"),{systemId:p.SystemId.Information,OnRdChanged:function(e){t.com.tm("\u7ec4\u4ef6_\u73a9\u5bb6\u4fe1\u606f.\u7ea2\u70b9").OnRDUpdate(e)}}),this.refreshInterval=this.ModelMgr.ModelGameConfig.GetGameConfigValueByKey("endCD"),this.toolSet.addUpdateFrame(this.updateTime,this),this.toolSet.addListener(this.ModelMgr.ModelSta.GetEventProxy(),"OnStaNextTimeReFreshUpdate",function(){t.SetNextRefreshTime(),t.markDirty(),t.isupdate=!0}),this.toolSet.addListener(this.ModelMgr.ModelSta.GetEventProxy(),"OnReFreshUpdateState",function(){t.isupdate=!0}),this.SetNextRefreshTime()},e.prototype.enter=function(){this.updateRoleInfo(),this.initResources(),this.updateResouces(),this.InitClick()},e.prototype.exit=function(){},e.prototype.markDirty=function(){this.dirty=!0},e.prototype.update=function(){this.dirty&&(this.dirty=!1,this.updateResouces())},e.prototype.updateRoleInfo=function(){var t=this.ModelMgr.ModelVO.VORoleBag.GetOne(),e=this.com;if(null!=t){e.tm("\u7ec4\u4ef6_\u73a9\u5bb6\u4fe1\u606f.icon").SetUrlByIcon(t.GetIcon()),e.tm("\u7ec4\u4ef6_\u73a9\u5bb6\u4fe1\u606f.fram").SetUrlByIcon(t.GetFramIcon()),e.tm("\u7ec4\u4ef6_\u73a9\u5bb6\u4fe1\u606f.\u6587\u672c_\u73a9\u5bb6\u540d\u79f0").text=t.GetName(),e.tm("\u7ec4\u4ef6_\u73a9\u5bb6\u4fe1\u606f.\u6587\u672c_\u73a9\u5bb6\u7b49\u7ea7").text=""+t.GetLevel();var r=e.tm("\u7ec4\u4ef6_\u73a9\u5bb6\u4fe1\u606f.\u8fdb\u5ea6\u6761_\u73a9\u5bb6\u7ecf\u9a8c").asProgress;t.IsMaxLevel()?(r.max=1,r.value=1):(r.max=t.GetExpMax(),r.value=t.GetExp())}},e.prototype.getResouceCom=function(t){return y.has(t)?this.com.tm(d.get(t)):null},e.prototype.InitClick=function(){var t=this;this.com.tm(d.get(f.ECurrencyType.sta)).setClick(function(){t.CtrlPay.GetCantPay()||t.LayerBuySta.load()},this),this.com.tm(d.get(f.ECurrencyType.coin)).setClick(function(){t.CtrlPay.GetCantPay()||t.CtrlMgr.JumpLayer(6)},this),this.com.tm(d.get(f.ECurrencyType.gem)).setClick(function(){t.CtrlPay.GetCantPay()||t.CtrlMgr.JumpLayer(5)},this)},e.prototype.initResources=function(){var t,e,r=this.ModelGoods,o=this.com;try{for(var n=a(y),i=n.next();!i.done;i=n.next()){var l=i.value,s=d.get(l),c=o.tm(s),u=r.GetRefByCurrency(l);c.tm("icon").SetUrlByIcon(u.smallIcon),c.tm("\u56fe\u7247_\u589e\u52a0").visible=!this.CtrlPay.GetCantPay()}}catch(p){t={error:p}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}},e.prototype.updateResouces=function(){var t,e,r=this.ModelMgr.ModelVO.VORoleBag.GetOne();if(null!=r)try{for(var o=a(y),n=o.next();!n.done;n=o.next()){var i=n.value,l=this.getResouceCom(i);if(null==l)throw new Error("\u6ca1\u6709\u5339\u914d\u7684\u8d44\u6e90\u7c7b\u578b:"+i);if(i!=f.ECurrencyType.sta){var s=u.BigNum.shortNum(r.GetAttributeBy(i),1);if(null==s)throw new Error("\u6ca1\u6709\u5339\u914d\u7684\u8d44\u6e90\u6570\u503c:"+i);l.tm("\u6587\u672c_\u6570\u503c").text=""+s}else{var p=c.StringUtil.format("{0}/{1}",Math.max(this.ModelMgr.ModelSta.GetEnd(),0),r.GetEndMax());l.tm("\u6587\u672c_\u6570\u503c").text=p}}}catch(h){t={error:h}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}},e.prototype.GetNextRefreshTime=function(){return this.nextRefreshTime||this.TimeUtil.now()+this.refreshInterval},e.prototype.SetNextRefreshTime=function(){this.nextRefreshTime=this.ModelMgr.ModelSta.GetnextFreshTime()||this.TimeUtil.now()+this.refreshInterval},e.prototype.updateTime=function(){var t=this.ModelMgr.ModelSta.GetEndMax(),e=this.ModelMgr.ModelSta.GetEnd()>=t,r=this.getResouceCom(f.ECurrencyType.sta);if(r.tm("\u6587\u672c_\u5012\u8ba1\u65f6").visible=!e,!e){var o=this.GetNextRefreshTime(),n=o-this.TimeUtil.now(),i=this.TimeUtil.timeSec2MSStr(n);r.tm("\u6587\u672c_\u5012\u8ba1\u65f6").asTextField.setVar("time",i).flushVars(),n<=0&&this.isupdate&&(this.isupdate=!1,this.ModelMgr.ModelSta.RequestRoleEndUpdate({time:o}),this.SetNextRefreshTime())}},e.__cname="LayerMainResourcesUI",i([l.injectField("CtrlAnimation")],e.prototype,"CtrlAnimation",void 0),i([l.injectField("ModelGoods")],e.prototype,"ModelGoods",void 0),i([l.injectField("LayerInformation")],e.prototype,"LayerInformation",void 0),i([l.injectField("LayerBuySta")],e.prototype,"LayerBuySta",void 0),i([l.injectField("CtrlMgr")],e.prototype,"CtrlMgr",void 0),i([l.injectField("TimeUtil")],e.prototype,"TimeUtil",void 0),i([l.injectField("Net")],e.prototype,"Net",void 0),i([l.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([l.injectField("CtrlPay")],e.prototype,"CtrlPay",void 0),e}(h.GameLayerUI);r.LayerMainResourcesUI=v,cc._RF.pop()},{"../../../../framework/container/Container":void 0,"../../../../framework/layer/common/UIOrder":void 0,"../../../../framework/utils/StringUtil":void 0,"../../../../libutil/BigNum":void 0,"../../model/System/ModelSystem":"ModelSystem","../../model/goods/ModelGoods":"ModelGoods","../../ui/GameLayer":"GameLayer"}],LayerMainStaConsumeAnimation:[function(t,e,r){"use strict";cc._RF.push(e,"58b7aeV6Q9CZLvkzRTZ69vl","LayerMainStaConsumeAnimation");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerMainStaConsumeAnimationUI=r.LayerMainStaConsumeAnimation=void 0;var a=t("../../../../../framework/container/Container"),l=t("../../../../../framework/FW"),s=t("../../../../../framework/layer/common/UIOrder"),c=t("../../../model/goods/ModelGoods"),u=t("../../../ui/GameLayer"),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._playbackCompleted=!1,e}return n(e,t),e.prototype.getUIClass=function(){return f},e.prototype.getUrl=function(){return"ui://\u9996\u9875/\u7ec4\u4ef6_\u4f53\u529b\u6d88\u8017"},e.prototype.getSortOrder=function(){return s.LayerOrder.TipsUI},e.prototype.SetStaConsumeNum=function(t){this._staConsumeNum=t},e.prototype.GetStaConsumeNum=function(){return this._staConsumeNum},e.prototype.SetHostCom=function(t){this.HostCom=t},e.prototype.GetHostCom=function(){return this.HostCom},e.prototype.SetGObjTarget=function(t){this.gobjTarget=t},e.prototype.GetGObjTarget=function(){return this.gobjTarget},e.prototype.OnExit=function(){this.HostCom=null,this._staConsumeNum=null,this.gobjTarget=null},e.prototype.SetPlaybackCompleted=function(t){this._playbackCompleted=t},e.prototype.GetPlaybackCompleted=function(){return this._playbackCompleted},e.prototype.Play=function(){this._playbackCompleted&&this.ui.UpdateLayer()},e.__cname="LayerMainStaConsumeAnimation",e}(u.GameLayerProxy);r.LayerMainStaConsumeAnimation=p;var f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getHasBackground=function(){return!1},e.prototype.init=function(){this.com.toFullCenterParent(this.container);var t=this.ModelMgr.ModelGoods.GetRefByCurrency(c.ECurrencyType.sta);this.com.tm("\u7ec4\u4ef6_\u4f53\u529b\u6d88\u8017.icon").SetUrlByIcon(t.smallIcon)},e.prototype.UpdateLayer=function(){var t=this.proxy;t.SetPlaybackCompleted(!1);var e=this.proxy.GetStaConsumeNum(),r=this.com.tm("\u7ec4\u4ef6_\u4f53\u529b\u6d88\u8017").asCom;r.visible=!1,r.tm("\u6587\u672c_\u6d88\u8017\u4f53\u529b\u6570\u91cf").asTextField.setVar("value",String(e)).flushVars();var o=t.GetGObjTarget(),n=o.parent.localToGlobal(o.x+o.width/2,o.y),i=this.com.globalToLocal(n.x,n.y);r.setPosition(i.x,i.y),l.FW.LWX.log("local",i),r.visible=!0,r.tmt("t0").play(function(){t.SetPlaybackCompleted(!0)})},e.__cname="LayerMainStaConsumeAnimationUI",i([a.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(u.GameLayerUI);r.LayerMainStaConsumeAnimationUI=f,cc._RF.pop()},{"../../../../../framework/FW":void 0,"../../../../../framework/container/Container":void 0,"../../../../../framework/layer/common/UIOrder":void 0,"../../../model/goods/ModelGoods":"ModelGoods","../../../ui/GameLayer":"GameLayer"}],LayerMain:[function(t,e,r){"use strict";cc._RF.push(e,"55a77+/29ZE74q/Q2+Jg4ju","LayerMain");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerMainUI=r.LayerMain=void 0;var s=t("../../../../framework/container/Container"),c=t("../../../../framework/coroutine/Cor"),u=t("../../../../framework/fork/Fork"),p=t("../../../../framework/FW"),f=t("../../../../framework/layer/common/UIOrder"),h=t("../../ui/GameScene"),y=t("./Adventure/TabAdventure"),d=t("./mall/TabMall"),m=t("./TabHero"),v=t("./Xiulian/TabXiulian"),_=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}var r;return n(e,t),r=e,e.prototype.getUIClass=function(){return S},e.prototype.getUrl=function(){return"ui://\u9996\u9875/\u7ec4\u4ef6_\u9996\u9875_\u4e3b\u754c\u9762"},e.prototype.getSortOrder=function(){return f.LayerOrder.Main},e.prototype.SetOnFinally=function(t){this.onFinally=t},e.prototype.GetOnFinally=function(){return this.onFinally},e.prototype.Open=function(t){if(!t.condition||p.FW.ExprMgr.GetResult(t.condition)){var e=this.ui.JumpTab(t.tabName);p.FW.Task.waitUntil(function(){return 1==e.ui.enterFinsh}).then(function(){if("TabMall"!=t.tabName){if(e.SetPageData(t.tabName),t.className){var r=t.className,o=s.Container.inst().getByAlias(r);null==o||o.load()}}else e.SetPageData(t.tabName)})}else this.ui.CtrlAlert.LayerMessage.addMessage(t.tips)},e.prototype.xxx=function(){console.log("fff: origin")},e.__cname="LayerMain",i([u.forkClass(r,null)],e)}(h.GameSceneProxy);r.LayerMain=_;var S=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.initAsync=function(){return a(this,void 0,Promise,function(){return l(this,function(t){switch(t.label){case 0:return[4,p.FW.FairyMgr.loadByPkgNameAsync("\u9996\u9875")];case 1:return t.sent(),[4,p.FW.FairyMgr.loadByPkgNameAsyncRef("\u9996\u9875_\u516c\u7528\u5305",this)];case 2:return t.sent(),[2]}})})},e.prototype.init=function(){var t=this;this.proxy.xxx(),this.com.toFullCenterParent(this.container),this.CtrlAudio.PlayMusic("\u767e\u604b_\u6e38\u620f_\u80cc\u666f\u97f3\u4e50"),this.cor=new c.Cor,this.toolSet.addDefer(function(){t.cor.destroy(),t.cor=null})},e.prototype.InitTabProxy=function(){this.proxy.addTab(v.TabXiulian),this.proxy.addTab(d.TabMall),this.proxy.addTab(m.TabHero),this.proxy.addTab(y.TabAdventure)},e.prototype.SetupTabBehaviorAsync=function(){return a(this,void 0,void 0,function(){return l(this,function(e){switch(e.label){case 0:return[4,this.LoadLayer_async([this.CtrlMain.LayerMainMenu])];case 1:return e.sent(),this.CtrlMain.LayerMainMenu.ui.SetupTabBehavior2(this.proxy,this),t.prototype.SetupTabBehaviorAsync.call(this),[2]}})})},e.prototype.enter=function(){var t=this;this.cor.Resume(function(e){return a(t,void 0,void 0,function(){var t,r,o=this;return l(this,function(n){switch(n.label){case 0:return 0==(t=this.CtrlAlert).LayerWaiting.isLoad&&(t.LayerWaiting.load(),t.LayerWaiting.setVisible(!1)),[4,c.Cor.WaitUntil_cor(e,function(){return t.LayerWaiting.isLoad})];case 1:return n.sent(),this.triggerFinally(),r=[this.CtrlMain.LayerMainResources,this.CtrlAlert.LayerMainStaConsumeAnimation],this.LoadLayer_async(r).then(function(){o.EnterTab()}).catch(function(t){t&&p.FW.Log.error(t),o.EnterTab()}),[2]}})})})},e.prototype.exit=function(){this.triggerFinally()},e.prototype.update=function(){this.cor&&this.cor.Update()},e.prototype.EnterTab=function(){this.proxy.switchDefaultTab()},e.prototype.triggerFinally=function(){var t=this.proxy.GetOnFinally();this.proxy.SetOnFinally(null),t&&t()},e.prototype.JumpTab=function(t){var e=this.proxy.getRunningTab();if(e.tabName==t)return e;var r=this.proxy.getTab2(t);return r?this.proxy.switchTab2(r.className):this.proxy.switchDefaultTab(),this.proxy.getTab2(t)},e.__cname="LayerMainUI",i([s.injectField("CtrlMgr")],e.prototype,"CtrlMgr",void 0),i([s.injectField("CtrlMain")],e.prototype,"CtrlMain",void 0),i([s.injectField("CtrlAudio")],e.prototype,"CtrlAudio",void 0),i([s.injectField("CtrlAlert")],e.prototype,"CtrlAlert",void 0),e}(h.GameScene);r.LayerMainUI=S,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/container/Container":void 0,"../../../../framework/coroutine/Cor":void 0,"../../../../framework/fork/Fork":void 0,"../../../../framework/layer/common/UIOrder":void 0,"../../ui/GameScene":"GameScene","./Adventure/TabAdventure":"TabAdventure","./TabHero":"TabHero","./Xiulian/TabXiulian":"TabXiulian","./mall/TabMall":"TabMall"}],LayerMallChestDetails:[function(t,e,r){"use strict";cc._RF.push(e,"7968cP+ZghGCaqBDXDpt8lw","LayerMallChestDetails");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerMallChestDetailsUI=r.LayerMallChestDetails=void 0;var a=t("../../../../../framework/container/Container"),l=t("../../../../../framework/layer/common/UIOrder"),s=t("../../../ui/GameLayer"),c=t("../LayerItemDetail"),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return p},e.prototype.getUrl=function(){return"ui://\u9996\u9875_\u5546\u57ce/\u7ec4\u4ef6_\u5546\u57ce_\u5b9d\u7bb1\u6982\u7387\u8be6\u60c5"},e.prototype.getSortOrder=function(){return l.LayerOrder.TowLevel},e.prototype.SetTitle=function(t){this._title=t},e.prototype.GetTitle=function(){return this._title},e.prototype.SetData=function(t){this._data=t},e.prototype.GetData=function(){return this._data},e.prototype.SetTotalWeight=function(t){this._totalWeight=t},e.prototype.GetTotalWeight=function(){return this._totalWeight},e.__cname="LayerMallChestDetails",e}(s.GameLayerProxy);r.LayerMallChestDetails=u;var p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getHasBackground=function(){return!0},e.prototype.GetHasCloseAnimation=function(){return!0},e.prototype.GetHasShowAnimation=function(){return!0},e.prototype.init=function(){this.com.toCenterParent(this.container),this.InitClick(),this.InitGList(),this.InitLayer()},e.prototype.InitGList=function(){var t=this,e=this,r=e.com.tm("\u5217\u8868_\u5b9d\u7bb1\u8be6\u60c5").asList;r.initVirtualList(e,function(r,o,n){var i=o,a=i.tm("\u5217\u8868_\u9053\u5177\u5c55\u793a").asList;a.init(e,function(t,e,r){var o=e.tm("item");o.UpdateByGoods(r),o.GetBehavior().onNumberVisible(!1)},function(e,r,o){try{t.LayerItemDetail.load(),t.LayerItemDetail.SetEquip(o),t.LayerItemDetail.SetOpenPosition(c.OpenPosition.synthesis)}catch(n){console.error(n)}}),a.update(n.equips),a.resizeToFit();var l=t.ModelGoods.GetQualityName(n.quality);i.tm("\u5bcc\u6587\u672c_\u54c1\u8d28\u540d\u5b57").text=l;var s="0";e.proxy.GetTotalWeight()>0&&(s=(n.weight/e.proxy.GetTotalWeight()*100).toFixed(2)),i.tm("\u6587\u672c_\u6982\u7387").asTextField.setVar("value",s).flushVars(),i.setSelectedIndex("\u54c1\u8d28",n.quality-1),i.setSelectedIndex("\u662f\u5426\u662fs\u7ea7",n.isS?1:0)}),r.setVirtual()},e.prototype.InitClick=function(){var t=this;t.com.tm("bg.\u6309\u94ae_\u5173\u95ed").setClick(function(){t.unload()},t)},e.prototype.InitLayer=function(){var t=this.com;t.tm("bg.title").text=this.proxy.GetTitle(),t.tm("\u5217\u8868_\u5b9d\u7bb1\u8be6\u60c5").asList.update(this.proxy.GetData())},e.__cname="LayerMallChestDetailsUI",i([a.injectField("ModelGoods")],e.prototype,"ModelGoods",void 0),i([a.injectField("LayerItemDetail")],e.prototype,"LayerItemDetail",void 0),e}(s.GameLayerUI);r.LayerMallChestDetailsUI=p,cc._RF.pop()},{"../../../../../framework/container/Container":void 0,"../../../../../framework/layer/common/UIOrder":void 0,"../../../ui/GameLayer":"GameLayer","../LayerItemDetail":"LayerItemDetail"}],LayerMallDrawDisplay:[function(t,e,r){"use strict";cc._RF.push(e,"c36741FljxOKYT2W1bCZU05","LayerMallDrawDisplay");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerMallDrawDisplayUI=r.LayerMallDrawDisplay=r.DrawType=void 0;var a=t("../../../../../../framework/FW"),l=t("../../../../../../framework/container/Container"),s=t("../../../../../../framework/layer/common/UIOrder"),c=t("../../../../model/mall/ModelMall"),u=t("../../../../model/vo/Goods/VOEquip"),p=t("../../../../model/vo/Goods/VORune"),f=t("../../../../ui/GameLayer"),h=t("../CtrlMall"),y=t("../TabMall");(function(t){t[t.single=0]="single",t[t.ten=1]="ten"})(r.DrawType||(r.DrawType={}));var d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return m},e.prototype.getUrl=function(){return"ui://\u9996\u9875_\u5546\u57ce/\u7ec4\u4ef6_\u5546\u57ce_\u62bd\u5956\u5c55\u793a"},e.prototype.getSortOrder=function(){return s.LayerOrder.ThreeLevel},e.prototype.SetType=function(t){this._type=t},e.prototype.GetType=function(){return this._type},e.prototype.SetData=function(t){this._data=t},e.prototype.GetData=function(){return this._data},e.prototype.SetGoodsList=function(t){this._goodsList=t},e.prototype.GetGoodsList=function(){return this._goodsList},e.prototype.SetDrawInfo=function(t){this._drawInfo=t},e.prototype.GetDrawInfo=function(){return this._drawInfo},e.__cname="LayerMallDrawDisplay",e}(f.GameLayerProxy);r.LayerMallDrawDisplay=d;var m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.recordCount=0,e}return n(e,t),e.prototype.getHasBackground=function(){return!0},e.prototype.init=function(){this.com.toFullCenterParent(this.container),this.InitClick(),this.InitData(),this.InitGlist(),this.UpdateLayer()},e.prototype.OnUpdate=function(){var t=this.com;this.UpdateData(),t.setSelectedPage("\u62bd\u5956\u6309\u94ae\u663e\u793a","\u5426"),t.setSelectedIndex("\u5c55\u793a",0),this.UpdateLayer()},e.prototype.UpdateData=function(){var t=this;t.com,t.InitData(),t.recordCount=0},e.prototype.InitGlist=function(){var t=this;this.com.tm("\u5217\u8868_\u5341\u62bd\u5c55\u793a").asList.init(this,function(e,r,o){var n=r,i=n.tm("item");o=o,i.UpdateByGoods(o),i.GetBehavior().onNumberVisible(!1);var a="";n.tm("\u5bcc\u6587\u672c_\u54c1\u8d28\u540d\u79f0").text=t.ModelMgr.ModelGoods.GetQualityName(o.GetQuality()),o instanceof u.VOEquip?a=o.GetNameStr():o instanceof p.VORune&&(a=o.GetNameStr()),n.tm("\u5bcc\u6587\u672c_\u9053\u5177\u540d\u79f0").text=a})},e.prototype.UpdateLayer=function(){var t=this,e=t.com;t.drawInfo.drawIcon&&this.com.tm("\u88c5\u8f7d\u5668_\u52a8\u6548").SetUrlByIcon(t.drawInfo.drawIcon),e.setSelectedPage("\u62bd\u5956\u6309\u94ae\u663e\u793a","\u5426"),e.setSelectedIndex("\u5b9d\u7bb1\u7c7b\u578b",t.drawInfo.refInfo.type-1),e.setSelectedIndex("\u5c55\u793a",0),e.setSelectedIndex("\u8df3\u8fc7\u662f\u5426\u663e\u793a",t.type==y.DrawCount.single?0:1),e.tm("bg").SetUrlByIcon(h.drawDisPlayBgConfig.get(t.drawInfo.refInfo.type)),t.PlayAnimation(),e.tm("\u5217\u8868_\u5341\u62bd\u5c55\u793a").asList.update(t.goodsList)},e.prototype.InitData=function(){var t=this;t.drawInfo=t.proxy.GetDrawInfo(),t.goodsList=t.proxy.GetGoodsList(),t.type=t.drawInfo.drawType},e.prototype.PlayAnimation=function(){var t=this,e=this,r=e.com,o=e.goodsList[e.recordCount],n=r.tm("\u7ec4\u4ef6_\u5355\u62bditem");n.UpdateByGoods(o),n.GetBehavior().onNumberVisible(!1);var i="";r.tm("\u5bcc\u6587\u672c_\u54c1\u8d28\u540d\u79f0").text=this.ModelMgr.ModelGoods.GetQualityName(o.GetQuality()),o instanceof u.VOEquip?i=o.GetNameStr():o instanceof p.VORune&&(i=o.GetNameStr()),r.tm("\u5bcc\u6587\u672c_\u9053\u5177\u540d\u79f0").text=i,e.recordCount++,this.com.tmt("\u5546\u57ce_\u62bd\u5956_\u9053\u5177\u4e0a\u5347").play(function(){if(a.FW.LWX.log("\u5355\u6b21\u52a8\u753b\u64ad\u653e\u5b8c\u6210"),e.recordCount<e.goodsList.length)r.setSelectedPage("\u62bd\u5956\u6309\u94ae\u663e\u793a","\u5426");else{var o=e.drawInfo.refInfo,n=e.type==y.DrawCount.single?o.costItem[0]:o.tenCostItem[0],i=e.type==y.DrawCount.single?o.costGem[0]:o.tenCostGem[0],l=t.IsCanDraw([n,i]);r.setSelectedIndex("\u62bd\u5956\u6309\u94ae\u663e\u793a",l?1:0),r.setSelectedIndex("\u5c55\u793a",e.type==y.DrawCount.single?0:1),r.setSelectedPage("\u8df3\u8fc7\u662f\u5426\u663e\u793a","\u5426"),t.SetbuttonInfo()}})},e.prototype.SetbuttonInfo=function(){var t=this,e=t.com,r=t.drawInfo.refInfo,o=r.number-t.drawInfo.drawCount,n=t.type==y.DrawCount.single?r.costItem[0]:r.tenCostItem[0],i=t.type==y.DrawCount.single?r.costGem[0]:r.tenCostGem[0],a=t.GetDrawState([n,i]);if(e.tm("\u6309\u94ae_\u62bd\u5956").asCom.setSelectedIndex("\u8d2d\u4e70\u72b6\u6001",a==y.DrawState.prop?0:1),a==y.DrawState.prop){var l=t.ModelMgr.ModelGoods.CreateGoods(n.resId),s=t.ModelMgr.ModelGoods.GetGoodsNumberByRefId(n.resId);e.tm("\u6309\u94ae_\u62bd\u5956.icon_\u9053\u5177\u56fe\u6807").SetUrlByIcon(l.GetIconUrl()),e.tm("\u6309\u94ae_\u62bd\u5956.\u6587\u672c_\u9053\u5177\u6570\u91cf").text=s+"/"+n.number}else{var c=t.ModelMgr.ModelGoods.CreateGoods(i.resId);e.tm("\u6309\u94ae_\u62bd\u5956.icon_money").SetUrlByIcon(c.GetIconUrl()),e.tm("\u6309\u94ae_\u62bd\u5956.\u6587\u672c_\u8d27\u5e01\u6570\u91cf").text=String(i.number),e.tm("\u6309\u94ae_\u62bd\u5956").asCom.setSelectedIndex("\u62bd\u5956\u6b21\u6570",t.type==y.DrawCount.single?0:1)}e.tm("\u6587\u672c_\u5269\u4f59\u62bd\u5956\u6b21\u6570").asTextField.setVar("remaining",o.toString()).setVar("value",r.number.toString()).flushVars()},e.prototype.GetDrawState=function(t){return this.com,t[1]?this.ModelMgr.ModelGoods.GetGoodsNumberByRefId(t[0].resId)>=t[0].number?y.DrawState.prop:y.DrawState.Gem:y.DrawState.prop},e.prototype.InitClick=function(){var t=this,e=this,r=e.com;r.setClick(function(){a.FW.LWX.log("\u70b9\u51fb\u7ec4\u4ef6"),e.recordCount<e.goodsList.length?e.PlayAnimation():e.unload()},e),r.tm("\u6309\u94ae_\u8df3\u8fc7").setClick(function(o){a.FW.LWX.log("\u70b9\u51fb\u8df3\u8fc7"),o.stopPropagation(),t.recordCount=e.goodsList.length;var n=e.drawInfo.refInfo,i=e.type==y.DrawCount.single?n.costItem[0]:n.tenCostItem[0],l=e.type==y.DrawCount.single?n.costGem[0]:n.tenCostGem[0],s=t.IsCanDraw([i,l]);r.setSelectedPage("\u62bd\u5956\u6309\u94ae\u663e\u793a",s?"\u662f":"\u5426"),r.setSelectedIndex("\u5c55\u793a",e.type==y.DrawCount.single?0:1),r.setSelectedPage("\u8df3\u8fc7\u662f\u5426\u663e\u793a","\u5426"),t.SetbuttonInfo()},e),r.tm("\u6309\u94ae_\u62bd\u5956").setClick(function(r){a.FW.LWX.log("\u70b9\u51fb\u62bd\u5956"),r.stopPropagation();var o=e.drawInfo.refInfo,n=e.type==y.DrawCount.single?o.costItem[0]:o.tenCostItem[0],i=e.type==y.DrawCount.single?o.costGem[0]:o.tenCostGem[0],l=e.GetDrawState([n,i]),s={mallId:e.drawInfo.mallId,resId:e.drawInfo.refInfo.id,type:l,count:e.type==y.DrawCount.ten};e.drawInfo.mallId==c.MallModule.SEquip||e.drawInfo.mallId==c.MallModule.LimitLuckDraw?e.ModelMgr.ModelMallSEquip.RequestMallSEquipDraw(s,e.drawInfo.refInfo.type):e.drawInfo.mallId==c.MallModule.LuckDraw&&t.ModelMgr.ModelMallLuckDraw.RequestMallLuckDraw(s,e.drawInfo.refInfo.type)},e)},e.prototype.IsCanDraw=function(t){var e=this,r=t[0],o=t[1];if(e.drawInfo.refInfo.number-e.drawInfo.drawCount<e.type)return!1;if(!t[1])return e.ModelMgr.ModelGoods.GetGoodsNumberByRefId(r.resId)>=t[0].number;var n=e.ModelMgr.ModelGoods.GetGoodsNumberByRefId(r.resId),i=t[0].number,a=e.ModelMgr.ModelRole.getPropertyById(o.resId),l=o.number;return n>=i||a>=l},e.__cname="LayerMallDrawDisplayUI",i([l.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(f.GameLayerUI);r.LayerMallDrawDisplayUI=m,cc._RF.pop()},{"../../../../../../framework/FW":void 0,"../../../../../../framework/container/Container":void 0,"../../../../../../framework/layer/common/UIOrder":void 0,"../../../../model/mall/ModelMall":"ModelMall","../../../../model/vo/Goods/VOEquip":"VOEquip","../../../../model/vo/Goods/VORune":"VORune","../../../../ui/GameLayer":"GameLayer","../CtrlMall":"CtrlMall","../TabMall":"TabMall"}],LayerMallLuckyDrawDisplay:[function(t,e,r){"use strict";cc._RF.push(e,"5ad74Wct6hEzbloYm/p6qNt","LayerMallLuckyDrawDisplay");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerMallLuckyDrawDisplayUI=r.LayerMallLuckyDrawDisplay=void 0;var a=t("../../../../../../framework/FW"),l=t("../../../../../../framework/container/Container"),s=t("../../../../../../framework/layer/common/UIOrder"),c=t("../../../../model/vo/Goods/VOEquip"),u=t("../../../../model/vo/Goods/VORune"),p=t("../../../../ui/GameLayer"),f=t("../CtrlMall"),h=t("../TabMall"),y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return d},e.prototype.getUrl=function(){return"ui://\u9996\u9875_\u5546\u57ce/\u7ec4\u4ef6_\u5546\u57ce_\u5347\u5b98\u53d1\u8d22\u62bd\u5956\u5c55\u793a"},e.prototype.getSortOrder=function(){return s.LayerOrder.ThreeLevel},e.prototype.SetType=function(t){this._type=t},e.prototype.GetType=function(){return this._type},e.prototype.SetData=function(t){this._data=t},e.prototype.GetData=function(){return this._data},e.prototype.SetGoodsList=function(t){this._goodsList=t},e.prototype.GetGoodsList=function(){return this._goodsList},e.prototype.SetDrawInfo=function(t){this._drawInfo=t},e.prototype.GetDrawInfo=function(){return this._drawInfo},e.__cname="LayerMallLuckyDrawDisplay",e}(p.GameLayerProxy);r.LayerMallLuckyDrawDisplay=y;var d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.recordCount=0,e}return n(e,t),e.prototype.getHasBackground=function(){return!0},e.prototype.init=function(){this.com.toFullCenterParent(this.container),this.InitClick(),this.InitData(),this.UpdateLayer()},e.prototype.OnUpdate=function(){var t=this.com;this.UpdateData(),t.setSelectedPage("\u62bd\u5956\u6309\u94ae\u663e\u793a","\u5426"),this.UpdateLayer()},e.prototype.UpdateData=function(){this.InitData(),this.recordCount=0},e.prototype.UpdateLayer=function(){var t=this,e=t.com;e.setSelectedPage("\u62bd\u5956\u6309\u94ae\u663e\u793a","\u5426"),e.setSelectedIndex("\u5b9d\u7bb1\u7c7b\u578b",t.drawInfo.refInfo.type-1),e.tm("bg").SetUrlByIcon(f.drawDisPlayBgConfig.get(t.drawInfo.refInfo.type)),t.PlayAnimation()},e.prototype.InitData=function(){var t=this;t.drawInfo=t.proxy.GetDrawInfo(),t.goodsList=t.proxy.GetGoodsList(),t.type=t.drawInfo.drawType},e.prototype.PlayAnimation=function(){var t=this,e=this,r=e.com,o=e.goodsList[e.recordCount],n=r.tm("\u7ec4\u4ef6_\u5355\u62bd\u7ed3\u679c");n.UpdateByGoods(o),n.GetBehavior().onNumberVisible(!1);var i="";r.tm("\u5bcc\u6587\u672c_\u54c1\u8d28\u540d\u79f0").text=this.ModelMgr.ModelGoods.GetQualityName(o.GetQuality()),o instanceof c.VOEquip?i=o.GetNameStr():o instanceof u.VORune&&(i=o.GetNameStr()),r.tm("\u5bcc\u6587\u672c_\u9053\u5177\u540d\u79f0").text=i,e.recordCount++,this.com.tm("\u88c5\u8f7d\u5668_\u5347\u5b98\u53d1\u8d22\u52a8\u6548").component.tmt("t0").play(),this.com.tmt("\u5546\u57ce_\u62bd\u5956_\u9053\u5177\u4e0a\u5347").play(function(){a.FW.LWX.log("\u5355\u6b21\u52a8\u753b\u64ad\u653e\u5b8c\u6210"),r.tm("\u88c5\u8f7d\u5668_\u5347\u5b98\u53d1\u8d22\u95ea\u5149").visible=!0,r.tm("\u88c5\u8f7d\u5668_\u5347\u5b98\u53d1\u8d22\u95ea\u5149").component.tmt("t0").play();var o=e.drawInfo.refInfo,n=e.type==h.DrawCount.single?o.costItem[0]:o.tenCostItem[0],i=e.type==h.DrawCount.single?o.costGem[0]:o.tenCostGem[0],l=t.IsCanDraw([n,i]);r.setSelectedIndex("\u62bd\u5956\u6309\u94ae\u663e\u793a",l?1:0),t.SetbuttonInfo()})},e.prototype.SetbuttonInfo=function(){var t=this,e=t.com,r=t.drawInfo.refInfo,o=r.number-t.drawInfo.drawCount,n=t.type==h.DrawCount.single?r.costItem[0]:r.tenCostItem[0],i=t.type==h.DrawCount.single?r.costGem[0]:r.tenCostGem[0],a=t.GetDrawState([n,i]);if(e.tm("\u6309\u94ae_\u62bd\u5956").asCom.setSelectedIndex("\u8d2d\u4e70\u72b6\u6001",a==h.DrawState.prop?0:1),a==h.DrawState.prop){var l=t.ModelMgr.ModelGoods.CreateGoods(n.resId),s=t.ModelMgr.ModelGoods.GetGoodsNumberByRefId(n.resId);e.tm("\u6309\u94ae_\u62bd\u5956.icon_\u9053\u5177\u56fe\u6807").SetUrlByIcon(l.GetIconUrl()),e.tm("\u6309\u94ae_\u62bd\u5956.\u6587\u672c_\u9053\u5177\u6570\u91cf").text=s+"/"+n.number}else{var c=t.ModelMgr.ModelGoods.CreateGoods(i.resId);e.tm("\u6309\u94ae_\u62bd\u5956.icon_money").SetUrlByIcon(c.GetIconUrl()),e.tm("\u6309\u94ae_\u62bd\u5956.\u6587\u672c_\u8d27\u5e01\u6570\u91cf").text=String(i.number),e.tm("\u6309\u94ae_\u62bd\u5956").asCom.setSelectedIndex("\u62bd\u5956\u6b21\u6570",t.type==h.DrawCount.single?0:1)}e.tm("\u6587\u672c_\u5269\u4f59\u62bd\u5956\u6b21\u6570").asTextField.setVar("remaining",o.toString()).setVar("value",r.number.toString()).flushVars()},e.prototype.GetDrawState=function(t){return this.com,t[1]?this.ModelMgr.ModelGoods.GetGoodsNumberByRefId(t[0].resId)>=t[0].number?h.DrawState.prop:h.DrawState.Gem:h.DrawState.prop},e.prototype.InitClick=function(){var t=this,e=this,r=e.com;r.setClick(function(){e.unload()},e),r.tm("\u6309\u94ae_\u62bd\u5956").setClick(function(r){a.FW.LWX.log("\u70b9\u51fb\u62bd\u5956"),r.stopPropagation();var o=e.drawInfo.refInfo,n=e.type==h.DrawCount.single?o.costItem[0]:o.tenCostItem[0],i=e.type==h.DrawCount.single?o.costGem[0]:o.tenCostGem[0],l=e.GetDrawState([n,i]),s={mallId:e.drawInfo.mallId,resId:e.drawInfo.refInfo.id,type:l,count:e.type==h.DrawCount.ten};t.ModelMgr.ModelMallLuckDraw.RequestMallLuckDraw(s,e.drawInfo.refInfo.type)},e)},e.prototype.IsCanDraw=function(t){var e=this,r=t[0],o=t[1];if(e.drawInfo.refInfo.number-e.drawInfo.drawCount<e.type)return!1;if(!t[1])return e.ModelMgr.ModelGoods.GetGoodsNumberByRefId(r.resId)>=t[0].number;var n=e.ModelMgr.ModelGoods.GetGoodsNumberByRefId(r.resId),i=t[0].number,a=e.ModelMgr.ModelRole.getPropertyById(o.resId),l=o.number;return n>=i||a>=l},e.__cname="LayerMallLuckyDrawDisplayUI",i([l.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(p.GameLayerUI);r.LayerMallLuckyDrawDisplayUI=d,cc._RF.pop()},{"../../../../../../framework/FW":void 0,"../../../../../../framework/container/Container":void 0,"../../../../../../framework/layer/common/UIOrder":void 0,"../../../../model/vo/Goods/VOEquip":"VOEquip","../../../../model/vo/Goods/VORune":"VORune","../../../../ui/GameLayer":"GameLayer","../CtrlMall":"CtrlMall","../TabMall":"TabMall"}],LayerMessage:[function(t,e,r){"use strict";cc._RF.push(e,"49576oZMVtLVbjsSyt6i2xX","LayerMessage");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerMessageUI=r.LayerMessage=void 0;var a=t("../../../../framework/layer/common/UIOrder"),l=t("../../ui/GameLayer"),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._tlMessage=[],e._dirty=!1,e}return n(e,t),e.prototype.getUIClass=function(){return c},e.prototype.getUrl=function(){return"ui://\u516c\u7528_\u98d8\u5b57/\u7ec4\u4ef6_\u9996\u9875_\u98d8\u5b57"},e.prototype.getSortOrder=function(){return a.LayerOrder.TipsUI},e.prototype.GetIsGameLayer=function(){return!0},e.prototype.getSystemId=function(){return 1},e.prototype.GetIsResidentLayer=function(){return!0},e.prototype.addMessage=function(t){this.addMessageInner(t)},e.prototype.addMessageInner=function(t){this._tlMessage.push(t),this.__SetDirty(!0),this.isLoad&&this.ui||(this.load(),this.setVisible(!0))},e.prototype.__GetCacheMessage=function(){return this._tlMessage},e.prototype.__ClearCacheMessage=function(){this._tlMessage.length=0},e.prototype.__SetDirty=function(t){this._dirty=t},e.prototype.__GetDirty=function(){return this._dirty},e.__cname="LayerMessage",e}(l.GameLayerProxy);r.LayerMessage=s;var c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getHasBackground=function(){return!1},e.prototype.init=function(){this.com.toFullCenterParent(this.container),this.target_pop=this.com.tm("pop_target"),this.target_pop.Init("\u516c\u7528_\u98d8\u5b57","\u7ec4\u4ef6_\u9996\u9875_\u98d8\u5b57Item")},e.prototype.release=function(){this.target_pop.destroy()},e.prototype.enter=function(){},e.prototype.exit=function(){},e.prototype.update=function(){var t,e;if(this.proxy.__GetDirty()){this.proxy.__SetDirty(!1);var r=this.proxy.__GetCacheMessage();try{for(var o=i(r),n=o.next();!n.done;n=o.next()){var a=n.value;this.addMessage(a)}}catch(l){t={error:l}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}this.proxy.__ClearCacheMessage()}},e.prototype.addMessage=function(t){this.target_pop.GetIsUpperLimit()||this.target_pop.addMessage(t)},e.__cname="LayerMessageUI",e}(l.GameLayerUI);r.LayerMessageUI=c,cc._RF.pop()},{"../../../../framework/layer/common/UIOrder":void 0,"../../ui/GameLayer":"GameLayer"}],LayerMonthCard:[function(t,e,r){"use strict";cc._RF.push(e,"403aew7sKtPwozargksrm3t","LayerMonthCard");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerMonthCardUI=r.LayerMonthCard=void 0;var a=t("../../../../../framework/container/Container"),l=t("../../../../../framework/layer/common/UIOrder"),s=t("../../../model/System/ModelSystem"),c=t("../../../ui/GameLayer"),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return p},e.prototype.getUrl=function(){return"ui://\u5145\u503c\u529f\u80fd_\u6708\u5361/\u7ec4\u4ef6_\u6708\u5361_\u4e3b\u754c\u9762"},e.prototype.getSortOrder=function(){return l.LayerOrder.OneLevel},e.prototype.getSystemId=function(){return s.SystemId.MonthCard},e.__cname="LayerMonthCard",e}(c.GameLayerProxy);r.LayerMonthCard=u;var p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getHasBackground=function(){return!0},e.prototype.init=function(){var t=this;this.com.toFullCenterParent(this.container),this.com.tm("\u6309\u94ae_\u8fd4\u56de").setClick(function(){t.unload()},this),this.diMonth=this.com.tm("\u4f4e\u7ea7\u6708\u5361"),this.diMonth.Init(0,this.proxy),this.gaoMonth=this.com.tm("\u9ad8\u7ea7\u6708\u5361"),this.gaoMonth.Init(1,this.proxy),this.toolSet.addListener(this.ModelMgr.ModelVO.VOMonthCardBag.GetEventProxy(),"OnChanged",function(){t.updateMonthCard()},this)},e.prototype.enter=function(){this.updateMonthCard()},e.prototype.updateMonthCard=function(){this.diMonth.updateLayer(),this.gaoMonth.updateLayer()},e.__cname="LayerMonthCardUI",i([a.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(c.GameLayerUI);r.LayerMonthCardUI=p,cc._RF.pop()},{"../../../../../framework/container/Container":void 0,"../../../../../framework/layer/common/UIOrder":void 0,"../../../model/System/ModelSystem":"ModelSystem","../../../ui/GameLayer":"GameLayer"}],LayerNewPlayerSign:[function(t,e,r){"use strict";cc._RF.push(e,"197437ernZADphn8xuIkJjL","LayerNewPlayerSign");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerNewPlayerSignUI=r.LayerNewPlayerSign=void 0;var a=t("../../../../framework/FW"),l=t("../../../../framework/container/Container"),s=t("../../../../framework/event/FWEventCenter"),c=t("../../../../framework/layer/common/UIOrder"),u=t("../../../../framework/utils/StringUtil"),p=t("../../ui/GameLayer"),f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return h},e.prototype.getUrl=function(){return"ui://\u5145\u503c\u529f\u80fd_\u65b0\u4eba\u7b7e\u5230/\u7ec4\u4ef6_\u65b0\u4eba\u7b7e\u5230_\u4e3b\u754c\u9762"},e.prototype.getSortOrder=function(){return c.LayerOrder.TowLevel},e.prototype.SetActivity=function(t){this._Obj=t},e.prototype.GetActivity=function(){return this._Obj},e.prototype.OnGetRDExpr=function(){return"[RDNewPlayerSignIn]"},e.__cname="LayerNewPlayerSign",e}(p.GameLayerProxy);r.LayerNewPlayerSign=f;var h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isShowitemTimerDown=!1,e}return n(e,t),e.prototype.getHasBackground=function(){return!0},e.prototype.GetHasCloseAnimation=function(){return!0},e.prototype.GetHasShowAnimation=function(){return!0},e.prototype.init=function(){this.com.toFullCenterParent(this.container),this.InitClick(),this.InitData(),this.InitList(),this.InitTimer(),this.updateList()},e.prototype.InitClick=function(){var t=this;t.com.tm("panel_bg.\u6309\u94ae_\u5173\u95ed").setClick(function(){t.unload()},t)},e.prototype.InitData=function(){var t=this;t.toolSet.addListener(t.ModelMgr.ModelNewPlayerSign.EventProxy,"OnChange",function(){t.updateList()},t),t.toolSet.addListener(a.FW.FWEvent.eventProxy,s.FWEventType.theNextDay,function(){t.ModelMgr.ModelNewPlayerSign.InitData()})},e.prototype.InitTimer=function(){var t=this,e=t.com,r=t.ModelMgr.ModelNewPlayerSign.GetEndTime(),o=t.TimeUtil.now();t.cacheTime=r-1e3*o;var n=function(){t.isShowitemTimerDown&&(t.cacheItem.tm("\u6587\u672c_\u5012\u8ba1\u65f6").text=t.TimeUtil.timeSec2HMSStr11(!1)),e.tm("\u6587\u672c_\u5012\u8ba1\u65f6").asTextField.setVar("time",t.TimeUtil.timeSec2HMSStr9(.001*t.cacheTime)).flushVars()};this.toolSet.addTimer(1e3,function(){n()}),n()},e.prototype.InitList=function(){var t=this,e=t.com.tm("\u5217\u8868_\u7b7e\u5230").asList,r=function(e,r,o){var n=r.asCom.tm("com_goods"),i=t.ModelMgr.ModelGoods.CreateGoodsByCmd({resId:o.resId,number:String(o.number)});n.UpdateByGoods(i),n.ClickItem(!0,i,t.proxy)};e.init(t,function(e,o,n){var i=o.asCom;i.tm("\u6587\u672c_\u6807\u9898").text=a.FW.G_W(u.StringUtil.format("\u7b2c{0}\u5929",n.ref.day)),i.setSelectedIndex("\u72b6\u6001",0);var l=i.tm("\u5217\u8868_\u5956\u52b1").asList;l.init(i,r),l.update(n.ref.reward),n.ref.day==t.checkTime+1?(t.cacheItem=i,t.isShowitemTimerDown=!0,t.cacheItem.tm("\u6587\u672c_\u5012\u8ba1\u65f6").text=t.TimeUtil.timeSec2HMSStr11(!1),i.setSelectedIndex("\u72b6\u6001",3)):n.rewardState&&(i.setSelectedIndex("\u72b6\u6001",n.rewardState.rewardState),1==n.rewardState.rewardState&&i.tm("\u6309\u94ae_\u9886\u53d6").setClick(function(){t.ModelMgr.ModelNewPlayerSign.RequestGetReward(n.ref.resId)},i))})},e.prototype.updateList=function(){var t=this,e=t.com.tm("\u5217\u8868_\u7b7e\u5230").asList;t.cacheItem=null,t.isShowitemTimerDown=!1,t.checkTime=t.ModelMgr.ModelNewPlayerSign.GetDays();var r=t.ModelMgr.ModelNewPlayerSign.GetSignData();e.update(r)},e.__cname="LayerNewPlayerSignUI",i([l.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([l.injectField("TimeUtil")],e.prototype,"TimeUtil",void 0),e}(p.GameLayerUI);r.LayerNewPlayerSignUI=h,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/container/Container":void 0,"../../../../framework/event/FWEventCenter":void 0,"../../../../framework/layer/common/UIOrder":void 0,"../../../../framework/utils/StringUtil":void 0,"../../ui/GameLayer":"GameLayer"}],LayerNotice:[function(t,e,r){"use strict";cc._RF.push(e,"5de74B4sYFFuoPPUakGfrzP","LayerNotice");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerNoticeUI=r.LayerNotice=void 0;var a=t("../../../../../engine/EngineMain"),l=t("../../../../../framework/container/Container"),s=t("../../../../../framework/layer/common/UIOrder"),c=t("../../../ui/GameLayer"),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return p},e.prototype.getUrl=function(){return"ui://\u516c\u544a/\u7ec4\u4ef6_\u516c\u544a_\u4e3b\u754c\u9762"},e.prototype.getSortOrder=function(){return s.LayerOrder.TowLevel},e.prototype.SetisClose=function(t){this._isClose=t},e.prototype.GetisClose=function(){return this._isClose},e.__cname="LayerNotice",e}(c.GameLayerProxy);r.LayerNotice=u;var p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.iconIndex=0,e.maxHeight=330,e}return n(e,t),e.prototype.getHasBackground=function(){return!0},e.prototype.GetHasCloseAnimation=function(){return!0},e.prototype.GetHasShowAnimation=function(){return!0},e.prototype.init=function(){var t=this;this.com.toFullCenterParent(this.container),this.proxy.SetisClose(!1),this.toolSet.addTimer(5e3,function(){t.UpdateImage()})},e.prototype.enter=function(){var t=this,e=t.com,r=this.CtrlNotice.NoticeLastOpenTimeKey,o=this.TimeUtil.time3String(this.TimeUtil.now(),!0);a.EngineMain.saveLocalStorage(r,o),t.InitGList(),e.tm("bg.\u6309\u94ae_\u5173\u95ed").setClick(function(){t.unload()},t);var n=[];return n.push(t.Ref.RefMgrnoticeIcon.preloadRef()),Promise.all(n).then(function(){t.InitLayer()}),null},e.prototype.InitGList=function(){var t=this,e=t.com;e.tm("\u5217\u8868_\u516c\u544a\u5185\u5bb9").asList.init(t,function(e,r,o){var n=r,i=!1;n.tm("\u6587\u672c_title").text=o.title;var a=i?o.content.replace(/\\n/g,"\n"):o.collapseContent.replace(/\\n/g,"\n"),l=n.tm("\u5217\u8868_\u516c\u544a\u5185\u5bb9").asList;l.init(t,function(e,r,o){var n=r,a=n.tm("title").asTextField;a.text=o,l.height=a.height>=t.maxHeight?t.maxHeight:a.height,n.height=a.height>=t.maxHeight?t.maxHeight:a.height,n.scrollPane.touchEffect=i}),l.update([a]),l.scrollPane.touchEffect=i,n.tm("\u70b9\u51fb\u533a\u57df").setClick(function(){var t=(i=!i)?o.content.replace(/\\n/g,"\n"):o.collapseContent.replace(/\\n/g,"\n");n.setSelectedIndex("button",i?1:0),l.update([t]),l.scrollPane.touchEffect=i},t)}),e.tm("\u5217\u8868_\u8f6e\u64ad\u56fe").asList.init(t,function(t,e,r){e.tm("icon").SetUrl(r.path)})},e.prototype.InitLayer=function(){var t=this,e=t.com,r=t.CtrlNotice.NoticeData;e.tm("\u5217\u8868_\u516c\u544a\u5185\u5bb9").asList.update(r);var o=t.Ref.RefMgrnoticeIcon.getRefAll(),n=e.tm("\u5217\u8868_\u8f6e\u64ad\u56fe").asList;n.update(o);var i=n.numItems;e.tm("\u6587\u672c_\u63d2\u56fe\u7d22\u5f15").asTextField.setVar("now",String(t.iconIndex+1)).setVar("max",String(i)).flushVars()},e.prototype.UpdateImage=function(){var t=this,e=t.com,r=e.tm("\u5217\u8868_\u8f6e\u64ad\u56fe").asList;t.iconIndex=t.iconIndex+1;var o=r.numItems,n=!0;t.iconIndex>=o&&(t.iconIndex=0,n=!1),r.scrollToView(t.iconIndex,n),e.tm("\u6587\u672c_\u63d2\u56fe\u7d22\u5f15").asTextField.setVar("now",String(t.iconIndex+1)).setVar("max",String(o)).flushVars()},e.prototype.exit=function(){return null},e.prototype.update=function(){},e.__cname="LayerNoticeUI",i([l.injectField("CtrlNotice")],e.prototype,"CtrlNotice",void 0),i([l.injectField("Ref")],e.prototype,"Ref",void 0),i([l.injectField("TimeUtil")],e.prototype,"TimeUtil",void 0),e}(c.GameLayerUI);r.LayerNoticeUI=p,cc._RF.pop()},{"../../../../../engine/EngineMain":void 0,"../../../../../framework/container/Container":void 0,"../../../../../framework/layer/common/UIOrder":void 0,"../../../ui/GameLayer":"GameLayer"}],LayerOneKeySynthesisDisplay:[function(t,e,r){"use strict";cc._RF.push(e,"c3312rFfsJBw494EyWUzD0j","LayerOneKeySynthesisDisplay");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.LayerOneKeySynthesisDisplayUI=r.LayerOneKeySynthesisDisplay=r.ShowBgType=void 0;var i=t("../../../../../framework/layer/common/UIOrder"),a=t("../../../model/vo/Goods/VOEquip"),l=t("../../../ui/GameLayer");(function(t){t[t.prop=0]="prop",t[t.rune=1]="rune"})(r.ShowBgType||(r.ShowBgType={}));var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return c},e.prototype.getUrl=function(){return"ui://\u82f1\u96c4/\u7ec4\u4ef6_\u82f1\u96c4_\u4e00\u952e\u5408\u6210\u5c55\u793a"},e.prototype.getSortOrder=function(){return i.LayerOrder.TipsUI},e.prototype.SetGoodsList=function(t){this.goodsList=t},e.prototype.GetGoodsList=function(){return this.goodsList},e.prototype.SetShowBgType=function(t){this._showBgType=t},e.prototype.GetShowBgType=function(){return this._showBgType},e.__cname="LayerOneKeySynthesisDisplay",e}(l.GameLayerProxy);r.LayerOneKeySynthesisDisplay=s;var c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getHasBackground=function(){return!0},e.prototype.init=function(){this.com.toFullCenterParent(this.container),this.InitClick(),this.InitGList(),this.UpdateLayer()},e.prototype.Sort=function(t,e){var r=t.GetQuality(),o=e.GetQuality();return r!=o?o-r:-1},e.prototype.InitClick=function(){var t=this;this.com.setClick(function(){t.unload()},this)},e.prototype.InitGList=function(){this.com.tm("\u5217\u8868_\u5408\u6210\u7ed3\u679c").init(this,function(t,e,r){var o=e.tm("com_goods");o.UpdateByGoods(r),o.GetBehavior().onNumberVisible(!1),r instanceof a.VOEquip&&o.GetBehavior().onLevelVisible(!0)})},e.prototype.UpdateLayer=function(){var t=this,e=this,r=(e.com,e.com.tm("\u5217\u8868_\u5408\u6210\u7ed3\u679c")),o=e.proxy.GetGoodsList();o.sort(function(e,r){return t.Sort(e,r)}),r.update(o)},e.__cname="LayerOneKeySynthesisDisplayUI",e}(l.GameLayerUI);r.LayerOneKeySynthesisDisplayUI=c,cc._RF.pop()},{"../../../../../framework/layer/common/UIOrder":void 0,"../../../model/vo/Goods/VOEquip":"VOEquip","../../../ui/GameLayer":"GameLayer"}],LayerPlayerDetail:[function(t,e,r){"use strict";cc._RF.push(e,"1b696zBhEBP54FFNL34n3J1","LayerPlayerDetail");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerPlayerDetailUI=r.LayerPlayerDetail=void 0;var c=t("../../../../framework/FW"),u=t("../../../../framework/container/Container"),p=t("../../../../framework/layer/common/UIOrder"),f=t("../../model/player/ModelPlayer"),h=t("../../model/vo/Goods/Goods"),y=t("../../ui/GameLayer"),d=t("../main/LayerItemDetail"),m=new Map;m.set(h.EGoodsType.weapon,"icon_weapon"),m.set(h.EGoodsType.amulet,"icon_amulet"),m.set(h.EGoodsType.armor,"icon_armor"),m.set(h.EGoodsType.belt,"icon_belt"),m.set(h.EGoodsType.glove,"icon_glove"),m.set(h.EGoodsType.shoe,"icon_shoe");var v=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return _},e.prototype.getUrl=function(){return"ui://\u73a9\u5bb6\u8be6\u60c5/\u7ec4\u4ef6_\u73a9\u5bb6\u8be6\u60c5_\u4e3b\u754c\u9762"},e.prototype.getSortOrder=function(){return p.LayerOrder.TowLevel},e.prototype.SetRoleId=function(t){this.roleId=t},e.prototype.GetRoleId=function(){return this.roleId},e.prototype.clearData=function(){this.roleId=null},e.__cname="LayerPlayerDetail",e}(y.GameLayerProxy);r.LayerPlayerDetail=v;var _=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getHasBackground=function(){return!0},e.prototype.init=function(){this.com.toFullCenterParent(this.container),this.InitClick(),this.InitListen()},e.prototype.release=function(){this.proxy.clearData(),this.ModelMgr.ModelPlayer.ClearPlayerDetail()},e.prototype.enterAsync=function(){return a(this,void 0,void 0,function(){return l(this,function(t){switch(t.label){case 0:return this.roleId=this.proxy.GetRoleId(),[4,this.ModelMgr.ModelPlayer.RequestFriendDetail(this.roleId)];case 1:return t.sent(),this.UpdateLayer(),[2]}})})},e.prototype.InitClick=function(){var t=this,e=this,r=e.com;r.tm("panel_bg.\u6309\u94ae_\u5173\u95ed").setClick(function(){t.unload()},this),r.tm("\u6309\u94ae_\u52a0\u5165\u9ed1\u540d\u5355").setClick(function(){e.ModelMgr.ModelFriends.RequestFriendsBlack(e.roleId)},e),r.tm("\u6309\u94ae_\u6dfb\u52a0\u597d\u53cb").setClick(function(){e.ModelMgr.ModelFriends.RequestFriendsApply(e.roleId)},e),r.tm("\u6309\u94ae_\u70b9\u8d5e").setClick(function(){e.ModelMgr.ModelPlayer.RequestFriendLinke(e.roleId)},e)},e.prototype.InitListen=function(){var t=this;t.toolSet.addListener(t.ModelMgr.ModelPlayer.GetEventProxy(),f.PlayerEventType.PlayerDetailUpdate,function(){t.UpdateLayer()},t)},e.prototype.UpdateLayer=function(){var t,e,r=this,o=r.com,n=r.ModelMgr.ModelPlayer.GetPlayerDetail();if(null==n)return c.FW.showTip("\u83b7\u53d6\u73a9\u5bb6\u8be6\u60c5\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5"),void r.unload();var i=n.roleInfo;o.tm("\u6587\u672c_\u73a9\u5bb6\u59d3\u540d").text=i.roleName,o.tm("\u6587\u672c_\u8d26\u53f7ID").asTextField.setVar("value",i.roleId.toString()).flushVars(),o.tm("\u6587\u672c_\u7b49\u7ea7").asTextField.setVar("level",(i.level||1).toString()).flushVars();var a=r.ModelMgr.ModelHero.GetHeroRef(i.heroId);o.tm("icon_hero").SetUrlByModel(a.bodyModel);var l=r.ModelMgr.ModelHead.GetIconByitemId(100401),u=r.ModelMgr.ModelHead.GetIconByitemId(100402);o.tm("icon_head").SetUrlByIcon(l),o.tm("icon_frame").SetUrlByIcon(u),o.tm("\u7ec4\u4ef6_\u653b\u51fb\u5c5e\u6027").visible=!1,o.tm("\u7ec4\u4ef6_\u751f\u547d\u5c5e\u6027").visible=!1;var p=n.equipList,f=function(t){var e=r.ModelMgr.ModelGoods.CreateGoodsByCmd({resId:t.resId,quality:t.quality,number:"1"});e.SetPhase(t.phase);var n=e.GetGoodsType();if(m.has(n)){var i=m.get(n),a=o.tm(i).asCom.tm("item");a.UpdateByGoods(e);var l=a.GetBehavior();l.onNumberVisible(!1),l.SetLevlUpdate(t.level),a.setClick(function(){r.LayerItemDetail.SetEquip(e),r.LayerItemDetail.SetOpenPosition(d.OpenPosition.synthesis),r.LayerItemDetail.SetEquipLevel(t.level),r.LayerItemDetail.load()},r)}};try{for(var h=s(p),y=h.next();!y.done;y=h.next())f(y.value)}catch(v){t={error:v}}finally{try{y&&!y.done&&(e=h.return)&&e.call(h)}finally{if(t)throw t.error}}o.tm("\u6587\u672c_\u4eba\u6c14\u503c").asTextField.setVar("value",(i.popularity||0).toString()).flushVars(),o.tm("\u6587\u672c_\u95ef\u5173\u4fee\u70bc\u503c").asTextField.setVar("value",i.power.toString()).flushVars()},e.__cname="LayerPlayerDetailUI",i([u.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([u.injectField("TimeUtil")],e.prototype,"TimeUtil",void 0),i([u.injectField("LayerItemDetail")],e.prototype,"LayerItemDetail",void 0),e}(y.GameLayerUI);r.LayerPlayerDetailUI=_,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/container/Container":void 0,"../../../../framework/layer/common/UIOrder":void 0,"../../model/player/ModelPlayer":"ModelPlayer","../../model/vo/Goods/Goods":"Goods","../../ui/GameLayer":"GameLayer","../main/LayerItemDetail":"LayerItemDetail"}],LayerReborn:[function(t,e,r){"use strict";cc._RF.push(e,"28f8d5gVZtGS6eFu9IRbKfs","LayerReborn");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerRebornUI=r.LayerReborn=void 0;var s=t("../../../../../../framework/container/Container"),c=t("../../../../../../framework/layer/common/UIOrder"),u=t("../../../../../../framework/utils/StringUtil"),p=t("../../../../model/goods/ModelGoods"),f=t("../../../../ui/GameLayer"),h=t("./BattleLayerOrder"),y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._countdown=15,e}return n(e,t),e.prototype.getUIClass=function(){return d},e.prototype.getUrl=function(){return"ui://\u6218\u6597/\u7ec4\u4ef6_\u6218\u6597_\u590d\u6d3b"},e.prototype.getSortOrder=function(){return c.LayerOrder.Main},e.prototype.getSortOrder2=function(){return h.BattleLayerOrder.ThreeLevel},e.prototype.SetCountdown=function(t){this._countdown=t},e.prototype.GetCountdown=function(){return this._countdown},e.prototype.SetHasReborn=function(t){this._hasReborn=t,this.ui&&this.ui.updateView()},e.prototype.GetHasReborn=function(){return this._hasReborn},e.prototype.SetReborn=function(t){this._reborn=t},e.prototype.GetReborn=function(){return this._reborn},e.__cname="LayerReborn",e}(f.GameLayerProxy);r.LayerReborn=y;var d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.playAd=!1,e}return n(e,t),e.prototype.getHasBackground=function(){return!0},e.prototype.init=function(){var t=this;this.com.toFullCenterParent(this.container);var e=this.com.tm("\u6309\u94ae_\u590d\u6d3b\u5e01\u590d\u6d3b").asButton,r=this.ModelGoods.GetRefByCurrency(p.ECurrencyType.reborn_coin);e.tm("icon").SetUrlByIcon(r.icon),this.setFairyBtnEvent(e,function(){return a(t,void 0,void 0,function(){var t,e,r;return l(this,function(o){switch(o.label){case 0:return t=this.proxy.GetReborn(),e=t>0?1:2,r=t>0?1:70,[4,this.GPGameover.Reborn(e,r)];case 1:return o.sent()?this.unload():this.proxy.SetHasReborn(!1),[2]}})})}),this.setFairyBtnEvent(this.com.tm("\u6309\u94ae_\u5e7f\u544a\u590d\u6d3b"),function(){return a(t,void 0,void 0,function(){return l(this,function(t){switch(t.label){case 0:return this.playAd=!0,[4,this.GPGameover.RebornAD()];case 1:return t.sent()&&this.unload(),this.playAd=!1,[2]}})})}),this.setFairyBtnEvent(this.com.tm("panel.\u6309\u94ae_\u5173\u95ed"),function(){return a(t,void 0,void 0,function(){return l(this,function(t){switch(t.label){case 0:return[4,this.GPGameover.AbandonReborn()];case 1:return t.sent(),this.unload(),[2]}})})});var o=this.proxy.GetCountdown(),n=this.com.tm("\u7ec4\u4ef6_\u5012\u8ba1\u65f6").asProgress;n.max=o,n.value=o;var i=this.toolSet.addTimer(1e3,function(){t.playAd||(o--,n.value=o,0==o&&(t.toolSet.removeTimer(i),t.GPGameover.AbandonReborn(),t.unload()))},this);this.GPAudio.swosh(),this.updateView()},e.prototype.updateView=function(){this.proxy.GetHasReborn();var t,e=this.proxy.GetReborn();if(e>0)t=u.StringUtil.format("{0}/{1}",1,e);else{var r=this.com.tm("\u6309\u94ae_\u590d\u6d3b\u5e01\u590d\u6d3b").asButton,o=this.ModelGoods.GetRefByCurrency(p.ECurrencyType.gem);r.tm("icon").SetUrlByIcon(o.icon),t="x 70"}this.com.tm("\u6309\u94ae_\u590d\u6d3b\u5e01\u590d\u6d3b.title").text=t},e.__cname="LayerRebornUI",i([s.injectField("GPGameover")],e.prototype,"GPGameover",void 0),i([s.injectField("ModelGoods")],e.prototype,"ModelGoods",void 0),i([s.injectField("GPAudio")],e.prototype,"GPAudio",void 0),e}(f.GameLayerUI);r.LayerRebornUI=d,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../../../../../framework/layer/common/UIOrder":void 0,"../../../../../../framework/utils/StringUtil":void 0,"../../../../model/goods/ModelGoods":"ModelGoods","../../../../ui/GameLayer":"GameLayer","./BattleLayerOrder":"BattleLayerOrder"}],LayerRewardDetail:[function(t,e,r){"use strict";cc._RF.push(e,"fa2bf3xvRNNhL5L/RyDu5GC","LayerRewardDetail");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerShowRewardUI=r.LayerRewardDetail=void 0;var s=t("../../../../../framework/container/Container"),c=t("../../../../../framework/fgui/FairyMgr"),u=t("../../../../../framework/layer/common/UIOrder"),p=t("../../../ui/GameLayer"),f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return h},e.prototype.getUrl=function(){return"ui://\u5171\u7528\u7ec4\u4ef6/\u7ec4\u4ef6_\u5171\u7528\u7ec4\u4ef6_\u5956\u52b1\u5c55\u793a\u5f39\u7a97"},e.prototype.SetGObjTarget=function(t){this.gobjTarget=t},e.prototype.GetGObjTarget=function(){return this.gobjTarget},e.prototype.SetTlCmdGoods=function(t){var e,r;this.rewards=[];try{for(var o=a(t),n=o.next();!n.done;n=o.next()){var i=n.value,l=this.ModelMgr.ModelGoods.CreateGoodsByCmd(i);this.rewards.push(l)}}catch(s){e={error:s}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}},e.prototype.SetTlGoods=function(t){this.rewards=t},e.prototype.GetReward=function(){return this.rewards},e.prototype.OnExit=function(){this.HostCom=null,this.rewards=null,this.gobjTarget=null},e.prototype.SetHostCom=function(t){this.HostCom=t},e.prototype.GetHostCom=function(){return this.HostCom},e.prototype.getSortOrder=function(){return u.LayerOrder.TipsUI},e.__cname="LayerRewardDetail",i([s.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(p.GameLayerProxy);r.LayerRewardDetail=f;var h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getPopParent=function(){return[this.proxy.GetHostCom()]},e.prototype.getFloatNode=function(){return this.com.tm("comShow.panel_bg")},e.prototype.getIsFull=function(){return!1},e.prototype.getHasBackground=function(){return!1},e.prototype.init=function(){var t=this;this.com.toFullCenterParent(this.container);var e=this.proxy.GetReward(),r=this.com.tm("comShow.list");r.init(this,function(e,r,o){var n=r.tm("item");n.UpdateByGoods(o),n.ClickItem(!0,o,t.proxy)}),r.update(e),r.resizeToFit(),this.UpdatePos()},e.prototype.UpdatePos=function(){var t=this.proxy.GetGObjTarget(),e=[],r=this.com.tm("comShow").asCom;e.push({key:c.PopInfoDirect.topmid,value:new cc.Vec2(r.tm("panel_bg.\u4e0a").x,r.tm("panel_bg.\u4e0a").y)}),e.push({key:c.PopInfoDirect.bottommid,value:new cc.Vec2(r.tm("panel_bg.\u4e0b").x,r.tm("panel_bg.\u4e0b").y)}),e.push({key:c.PopInfoDirect.leftmid,value:new cc.Vec2(r.tm("panel_bg.\u5de6").x,r.tm("panel_bg.\u5de6").y)}),e.push({key:c.PopInfoDirect.rightmid,value:new cc.Vec2(r.tm("panel_bg.\u53f3").x,r.tm("panel_bg.\u53f3").y)});var o=c.PopInfoDirect.bottommid,n=l(c.FairyMgr.instance.GetPoupPosition(r.tm("panel_bg"),t,o,e),2),i=n[0];switch(n[1]){case c.PopInfoDirect.topmid:r.setSelectedPage("\u65b9\u5411","\u4e0a");break;case c.PopInfoDirect.bottommid:r.setSelectedPage("\u65b9\u5411","\u4e0b");break;case c.PopInfoDirect.leftmid:r.setSelectedPage("\u65b9\u5411","\u53f3");break;case c.PopInfoDirect.rightmid:r.setSelectedPage("\u65b9\u5411","\u5de6")}i=this.com.globalToLocal(i.x,i.y),r.setPosition(i.x,i.y)},e.prototype.Release_cor=function(){},e.__cname="LayerShowRewardUI",e}(p.GameLayerUI);r.LayerShowRewardUI=h,cc._RF.pop()},{"../../../../../framework/container/Container":void 0,"../../../../../framework/fgui/FairyMgr":void 0,"../../../../../framework/layer/common/UIOrder":void 0,"../../../ui/GameLayer":"GameLayer"}],LayerRolePanel:[function(t,e,r){"use strict";cc._RF.push(e,"dacf6ITATpDO7JF8cba0643","LayerRolePanel");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerRolePanelUI=r.LayerRolePanel=void 0;var s=t("../../../../../../framework/container/Container"),c=t("../../../../../../framework/layer/common/UIOrder"),u=t("../../../../ui/GameLayer"),p=t("./BattleLayerOrder"),f=t("./ComPanel/HeroReticleComPanel"),h=t("./ComPanel/HeroUIComPanel"),y=function(){},d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._data=new y,e}return n(e,t),e.prototype.getUIClass=function(){return m},e.prototype.getUrl=function(){return"ui://\u6218\u6597/\u7ec4\u4ef6_\u6218\u6597\u5c42_\u9762\u677f"},e.prototype.getSortOrder=function(){return c.LayerOrder.Scene},e.prototype.getSortOrder2=function(){return p.BattleLayerOrder.Scene},e.prototype.ResetData=function(){this._data=new y},e.prototype.GetData=function(){return this._data},e.prototype.SetShowHp=function(t){this._data.showHp=t,this.ui&&this.ui.MarkDirty(h.HeroUIComPanel)},e.prototype.GetShowHp=function(){return this._data.showHp},e.__cname="LayerRolePanel",e}(u.GameLayerProxy);r.LayerRolePanel=d;var m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tmDirty=new Map,e.tmSub=new Map,e}return n(e,t),e.prototype.getHasBackground=function(){return!1},e.prototype.init=function(){this.com.toFullCenterParent(this.container),this.proxy.ResetData(),this.CreateSub(h.HeroUIComPanel),this.CreateSub(f.HeroReticleComPanel)},e.prototype.release=function(){var t,e;try{for(var r=a(this.tmSub),o=r.next();!o.done;o=r.next()){var n=l(o.value,2);n[0],n[1].Release()}}catch(i){t={error:i}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},e.prototype.enter=function(){var t,e,r,o,n=this;this.toolSet.addListener(this.SystemRole.GetEventProxy(),"CreateHero",function(){n.isStar=!0,n.MarkDirty(h.HeroUIComPanel)}),this.toolSet.addCallback(this.ComVar.GetHeroChangeCallback(),function(){n.isStar=!0,n.MarkDirty(h.HeroUIComPanel)});try{for(var i=a(this.tmSub),s=i.next();!s.done;s=i.next()){var c=l(s.value,2),u=(c[0],c[1]);this.proxy.getDependContainer().inject(u)}}catch(d){t={error:d}}finally{try{s&&!s.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}try{for(var p=a(this.tmSub),f=p.next();!f.done;f=p.next()){var y=l(f.value,2);y[0],(u=y[1]).Enter()}}catch(m){r={error:m}}finally{try{f&&!f.done&&(o=p.return)&&o.call(p)}finally{if(r)throw r.error}}},e.prototype.exit=function(){var t,e;try{for(var r=a(this.tmSub),o=r.next();!o.done;o=r.next()){var n=l(o.value,2);n[0],n[1].Exit()}}catch(i){t={error:i}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},e.prototype.update=function(t){var e,r;if(0!=this.isStar)try{for(var o=a(this.tmSub),n=o.next();!n.done;n=o.next()){var i=l(n.value,2);i[0],i[1].Update(t)}}catch(s){e={error:s}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}},e.prototype.MarkDirty=function(t){this.tmDirty.set(t,!0)},e.prototype.GetDirty=function(t){return this.tmDirty.get(t)},e.prototype.ClearDirty=function(t){this.tmDirty.set(t,!1)},e.prototype.CreateSub=function(t){var e=new t;e.Init(this.com,this.proxy),this.tmSub.set(t,e),this.tmDirty.set(t,!0)},e.prototype.GetSub=function(t){return this.tmSub.get(t)},e.__cname="LayerRolePanelUI",i([s.injectField("SystemRole")],e.prototype,"SystemRole",void 0),i([s.injectField("ComVar")],e.prototype,"ComVar",void 0),i([s.injectField("ComPos")],e.prototype,"ComPos",void 0),e}(u.GameLayerUI);r.LayerRolePanelUI=m,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../../../../../framework/layer/common/UIOrder":void 0,"../../../../ui/GameLayer":"GameLayer","./BattleLayerOrder":"BattleLayerOrder","./ComPanel/HeroReticleComPanel":"HeroReticleComPanel","./ComPanel/HeroUIComPanel":"HeroUIComPanel"}],LayerRuneBag:[function(t,e,r){"use strict";cc._RF.push(e,"4ead3SWMBBLRaHh4oPkzH6x","LayerRuneBag");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerRuneBagUI=r.LayerRuneBag=r.SiftButton=void 0;var a=t("../../../../../../framework/container/Container"),l=t("../../../../../../framework/event/EventProxy"),s=t("../../../../../../framework/layer/common/UIOrder"),c=t("../../../../model/System/ModelSystem"),u=t("../../../../ui/GameLayer"),p=t("./LayerRuneDetails"),f=function(){function t(t,e,r,o){this._com_button=null,this._com_siftList=null,this._com=null,this._layer=null,this._data=null,this._isShow=!1,this._nowType=-2,this._oldType=-2,this.eventBagSiftOnChangeProxy=new l.EventProxy,this._layer=r.com,this._com=r.com,this._com_button=t,this._com_siftList=e,this._data=o,this.Init()}return t.prototype.GetEventBagSiftOnChangeProxy=function(){return this.eventBagSiftOnChangeProxy},t.prototype.Init=function(){this._com.tm("\u6309\u94ae_\u7b5b\u9009").asCom.setSelectedPage("\u662f\u5426\u90e8\u4f4d\u7b5b\u9009","\u5426"),this.InitClick(),this.InitGlist()},t.prototype.InitGlist=function(){var t=this,e=this._com,r=e.tm("\u7b5b\u9009\u5217\u8868.list");e.tm("\u7b5b\u9009\u5217\u8868.\u6309\u94ae_\u5168\u90e8").setClick(function(){e.tm("\u6309\u94ae_\u7b5b\u9009").asCom.setSelectedPage("\u662f\u5426\u90e8\u4f4d\u7b5b\u9009","\u5426"),t.HideSelected(),t._nowType=-2,t.Update()},this),r.init(this._layer,function(t,e){e.setSelectedIndex("\u7c7b\u578b",t)},function(r,o){var n=o;e.tm("\u6309\u94ae_\u7b5b\u9009.icon").icon=n.tm("icon").icon,t.HideSelected(),e.tm("\u6309\u94ae_\u7b5b\u9009").asCom.setSelectedPage("\u662f\u5426\u90e8\u4f4d\u7b5b\u9009","\u662f"),t._nowType=Number(n.getSelectedPage("\u7c7b\u578b")),t.Update()}),r.update(this._data),r.resizeToFit()},t.prototype.InitClick=function(){var t=this,e=this,r=this._com;r.tm("\u6309\u94ae_\u7b5b\u9009").setClick(function(){t._isShow=!t._isShow,r.setSelectedPage("\u663e\u793a\u7b5b\u9009",e._isShow?"\u663e\u793a":"\u9690\u85cf"),r.tm("\u6309\u94ae_\u7b5b\u9009").asCom.setSelectedPage("button",e._isShow?"down":"up")},e._layer)},t.prototype.HideSelected=function(){this._com.setSelectedPage("\u663e\u793a\u7b5b\u9009","\u9690\u85cf"),this._isShow=!1},t.prototype.Update=function(){this._oldType!=this._nowType&&(this._oldType=this._nowType,this.eventBagSiftOnChangeProxy.execute("BagSiftOnChange"))},t.prototype.GetNowType=function(){return this._nowType},t.__cname="SiftButton",t}();r.SiftButton=f;var h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.listData=[0,1],e}return n(e,t),e.prototype.getUIClass=function(){return y},e.prototype.getUrl=function(){return"ui://\u82f1\u96c4_\u7b26\u6587/\u7ec4\u4ef6_\u82f1\u96c4\u7b26\u6587_\u6211\u7684\u7b26\u6587\u80cc\u5305"},e.prototype.getSortOrder=function(){return s.LayerOrder.OneLevel},e.prototype.GetList=function(){return this.listData},e.prototype.getSystemId=function(){return c.SystemId.VORuneBag},e.__cname="LayerRuneBag",e}(u.GameLayerProxy);r.LayerRuneBag=h;var y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isShow=!1,e.nowType=-2,e.data=[0,1],e.maxBag=100,e}return n(e,t),e.prototype.getHasBackground=function(){return!0},e.prototype.init=function(){this.com.toFullCenterParent(this.container),this.InitClick(),this.InitGList(),this.InitLayerInfo(),this.UpdateLayer(),this.toolSet.addListener(this.ModelMgr.ModelRune.GetEventVOBagOnChangeProxy(),"VOBagOnChange",this.UpdateLayer,this),this.toolSet.addListener(this.siftButton.GetEventBagSiftOnChangeProxy(),"BagSiftOnChange",this.UpdateLayer,this)},e.prototype.Sort=function(t,e){var r=t.GetQuality(),o=e.GetQuality();return r!=o?o-r:(r=t.GetPhase())!=(o=e.GetPhase())?o-r:(r=t.GetRefId())!=(o=e.GetRefId())?o-r:-1},e.prototype.InitLayerInfo=function(){var t=this;t.com.tm("\u6309\u94ae_\u7b5b\u9009").asCom.setSelectedPage("\u662f\u5426\u90e8\u4f4d\u7b5b\u9009","\u5426");var e=this.com.tm("\u6309\u94ae_\u7b5b\u9009"),r=this.com.tm("\u7b5b\u9009\u5217\u8868.list");this.siftButton=new f(e,r,t,t.data)},e.prototype.InitGList=function(){var t=this,e=this,r=e.com.tm("\u5217\u8868_\u7b26\u6587\u80cc\u5305");r.initVirtualList(e,function(e,r,o){var n=r.tm("item");if(o){n.UpdateByGoods(o),n.GetBehavior().onNumberVisible(!1);var i=n.GetBehavior().OnGetRDComponent(),a=t.ModelMgr.ModelGoodsBag.CheckIsNew(o)?1:0;i.OnRDUpdate(a),n.visible=!0}else n.UpdateByGoods(null),n.visible=!1},function(r,o,n){if(n){var i=o.tm("item");e.ModelMgr.ModelGoodsBag.ClickNew(n);var a=i.GetBehavior().OnGetRDComponent(),l=e.ModelMgr.ModelGoodsBag.CheckIsNew(n)?1:0;a.OnRDUpdate(l),t.LayerRuneDetails.SetData({rune:n}),t.LayerRuneDetails.SetViewType(p.RuneDetailsViewType.noShowButon),t.LayerRuneDetails.load()}}),r.setVirtual()},e.prototype.UpdateLayer=function(){var t=this;this.nowType=this.siftButton.GetNowType();var e=this.ModelMgr.ModelRune.GetRuneByType(this.nowType);for(e.sort(function(e,r){return t.Sort(e,r)});e.length>this.maxBag;)this.maxBag+=50;var r=e.concat(new Array(this.maxBag-e.length));this.com.tm("\u5217\u8868_\u7b26\u6587\u80cc\u5305").update(r)},e.prototype.InitClick=function(){var t=this;this.com.tm("\u6309\u94ae_\u8fd4\u56de").setClick(function(){t.unload()},t)},e.__cname="LayerRuneBagUI",i([a.injectField("LayerRuneDetails")],e.prototype,"LayerRuneDetails",void 0),e}(u.GameLayerUI);r.LayerRuneBagUI=y,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../../../../../framework/event/EventProxy":void 0,"../../../../../../framework/layer/common/UIOrder":void 0,"../../../../model/System/ModelSystem":"ModelSystem","../../../../ui/GameLayer":"GameLayer","./LayerRuneDetails":"LayerRuneDetails"}],LayerRuneDetails:[function(t,e,r){"use strict";cc._RF.push(e,"2ca33y1zK5HRYOqHHx/VpAu","LayerRuneDetails");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerRuneDetailsUI=r.LayerRuneDetails=r.RuneDetailsViewType=void 0;var a,l=t("../../../../../../framework/container/Container"),s=t("../../../../../../framework/layer/common/UIOrder"),c=t("../../../../../../libutil/BigNum"),u=t("../../../../model/vo/Goods/Goods"),p=t("../../../../ui/GameLayer"),f=t("./LayerRuneReplace");(function(t){t[t.noShowButon=0]="noShowButon",t[t.showButton=1]="showButton",t[t.MallBuy=2]="MallBuy"})(a=r.RuneDetailsViewType||(r.RuneDetailsViewType={}));var h=new Map;h.set(3,"\u84dd"),h.set(4,"\u7d2b"),h.set(5,"\u91d1"),h.set(6,"\u7ea2");var y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return d},e.prototype.getUrl=function(){return"ui://\u82f1\u96c4_\u7b26\u6587/\u7ec4\u4ef6_\u82f1\u96c4\u7b26\u6587_\u7b26\u6587\u8be6\u60c5\u5378\u4e0b\u66ff\u6362"},e.prototype.getSortOrder=function(){return s.LayerOrder.TowLevel},e.prototype.SetData=function(t){this._data=t},e.prototype.GetData=function(){return this._data},e.prototype.SetViewType=function(t){this._ViewType=t},e.prototype.GetViewType=function(){return this._ViewType},e.prototype.SetBuyInfo=function(t){this._buyInfo=t},e.prototype.GetBuyInfo=function(){return this._buyInfo},e.prototype.SetPayObj=function(t){this._payObj=t},e.prototype.GetPayObj=function(){return this._payObj},e.__cname="LayerRuneDetails",e}(p.GameLayerProxy);r.LayerRuneDetails=y;var d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getHasBackground=function(){return!0},e.prototype.GetHasCloseAnimation=function(){return!0},e.prototype.GetHasShowAnimation=function(){return!0},e.prototype.init=function(){this.com.toFullCenterParent(this.container),this.InitClick(),this.InitGList(),this.InitLayer()},e.prototype.InitClick=function(){var t=this,e=this,r=this.com,o=(e.proxy,this.proxy.GetData());r.tm("panel_bg.\u6309\u94ae_\u5173\u95ed").setClick(function(){e.unload()},e),r.tm("\u6309\u94ae_\u5378\u4e0b").setClick(function(){e.unload(),t.ModelRune.RequestRuneTakeOff(o.rune.GetId(),o.slotId)},e),r.tm("\u6309\u94ae-\u66ff\u6362").setClick(function(){e.unload(),t.LayerRuneReplace.SetData(e.proxy.GetData()),t.LayerRuneReplace.SetViewType(f.RuneReplaceViewType.replace),t.LayerRuneReplace.load()},e),r.tm("\u6309\u94ae_\u8d2d\u4e70").setClick(function(){var t=e.proxy.GetPayObj();e.ModelMgr.ModelPay.Pay(t),e.unload()},e)},e.prototype.InitGList=function(){var t=this;this.com.tm("\u5217\u8868_\u54c1\u8d28\u6280\u80fd").init(this,function(e,r,o){var n=r,i=t.proxy.GetData().rune.GetQuality()>=o.quality;n.tm("title").text=o.desc,n.setSelectedPage("\u54c1\u8d28",h.get(o.quality)),n.setSelectedIndex("\u662f\u5426\u89e3\u9501",i?0:1)})},e.prototype.InitLayer=function(){var t=this,e=t.com,r=t.proxy,o=this.proxy.GetData().rune,n=o.GetQuality(),i=o.GetPhase(),l=o.GetName(),s=String(this.ModelRune.GetRuneAttribute(o)),p=e.tm("\u7ec4\u4ef6_\u7b26\u6587.item"),f=(this.ModelGoods.GetQualityName(n,i),this.ModelRune.GetSKill(o.GetRefId()));if(e.tm("\u5217\u8868_\u54c1\u8d28\u6280\u80fd").asList.update(f),e.setSelectedIndex("\u54c1\u8d28\u6807\u7b7e",n-1),e.setSelectedIndex("\u7b26\u6587\u7c7b\u578b",o.GetGoodsType()==u.EGoodsType.atkRune?0:1),e.tm("\u7ec4\u4ef6_\u7b26\u6587\u7c7b\u578b").asCom.setSelectedIndex("\u7b26\u6587\u7c7b\u578b",o.GetGoodsType()==u.EGoodsType.atkRune?0:1),e.setSelectedIndex("\u6253\u5f00\u4f4d\u7f6e",t.proxy.GetViewType()),e.tm("\u6587\u672c_\u54c1\u8d28\u540d\u79f0").text=o.GetName(),e.tm("panel_bg.title").text=l,e.tm("\u7ec4\u4ef6_\u7b26\u6587\u5c5e\u6027.\u6587\u672c_\u57fa\u7840\u503c").text="+"+s,p.UpdateByGoods(o),p.GetBehavior().onNumberVisible(!1),r.GetViewType()==a.MallBuy){var h=r.GetBuyInfo();if(h){var y=t.ModelMgr.ModelGoods.CreateGoodsByCmd({resId:h.payResId,number:String(h.payNumber)});e.tm("\u6309\u94ae_\u8d2d\u4e70.icon").SetUrlByIcon(y.GetIconUrl()),e.tm("\u6309\u94ae_\u8d2d\u4e70.title").text="X"+c.BigNum.shortNum(h.payNumber),e.setSelectedPage("\u80fd\u5426\u8d2d\u4e70",h.isCanBuy?"\u80fd":"\u5426")}}},e.__cname="LayerRuneDetailsUI",i([l.injectField("ModelRune")],e.prototype,"ModelRune",void 0),i([l.injectField("LayerRuneReplace")],e.prototype,"LayerRuneReplace",void 0),i([l.injectField("ModelGoods")],e.prototype,"ModelGoods",void 0),i([l.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(p.GameLayerUI);r.LayerRuneDetailsUI=d,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../../../../../framework/layer/common/UIOrder":void 0,"../../../../../../libutil/BigNum":void 0,"../../../../model/vo/Goods/Goods":"Goods","../../../../ui/GameLayer":"GameLayer","./LayerRuneReplace":"LayerRuneReplace"}],LayerRuneMain:[function(t,e,r){"use strict";cc._RF.push(e,"c28e5YpcPBKNKRuntl1/d3u","LayerRuneMain");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerRuneMainUI=r.LayerRuneMain=void 0;var s=t("../../../../../../framework/FW"),c=t("../../../../../../framework/container/Container"),u=t("../../../../../../framework/layer/common/UIOrder"),p=t("../../../../../../framework/utils/StringUtil"),f=t("../../../../model/System/ModelSystem"),h=t("../../../../ui/GameLayer"),y=t("../../../alert/CtrlAlert"),d=t("../../../attr/SubAttrRune"),m=t("./LayerRuneDetails"),v=t("./LayerRuneReplace"),_=new Map;_.set(0,{type:17,name:"\u7b26\u6587\u69fd0"}),_.set(1,{type:17,name:"\u7b26\u6587\u69fd1"}),_.set(2,{type:17,name:"\u7b26\u6587\u69fd2"}),_.set(3,{type:18,name:"\u7b26\u6587\u69fd3"}),_.set(4,{type:18,name:"\u7b26\u6587\u69fd4"}),_.set(5,{type:18,name:"\u7b26\u6587\u69fd5"});var S=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return g},e.prototype.getUrl=function(){return"ui://\u82f1\u96c4_\u7b26\u6587/\u7ec4\u4ef6_\u82f1\u96c4\u7b26\u6587_\u4e3b\u754c\u9762"},e.prototype.getSortOrder=function(){return u.LayerOrder.OneLevel},e.prototype.getSystemId=function(){return f.SystemId.RuneMain},e.__cname="LayerRuneMain",e}(h.GameLayerProxy);r.LayerRuneMain=S;var g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.wearMap=new Map,e.isOpen=!1,e._dirty=!1,e}return n(e,t),e.prototype.getHasBackground=function(){return!0},e.prototype.init=function(){var t=this,e=t.com;t.com.toFullCenterParent(t.container),e.tm("\u88c5\u8f7d\u5668_\u52a8\u6548_\u94ed\u6587\u5343\u624b\u4f5b").SetUrlByIcon("\u7279\u6548_\u7b26\u6587_\u5343\u624b\u9f99\u738b"),e.tm("\u88c5\u8f7d\u5668_\u84dd\u8272\u7c92\u5b50").SetUrlByModel(y.particlesMap.get("\u7eff\u8272\u7c92\u5b50")),t.InitBtn(),t.InitGlist(),t.toolSet.addListener(t.ModelRune.GetEventVOBagOnChangeProxy(),"VOBagOnChange",function(){t.UpdateView()},t),t.toolSet.addCallback(t.CtrlAttr.GetChangeCallback(),function(){t.UpdateView()})},e.prototype.enter=function(){this.UpdateView()},e.prototype.InitBtn=function(){var t=this,e=this,r=this.com;_.forEach(function(o,n){r.tm(o.name).setClick(function(){t.wearMap.has(n)?(t.LayerRuneDetails.SetData({rune:t.wearMap.get(n),slotId:n}),t.LayerRuneDetails.SetViewType(m.RuneDetailsViewType.showButton),t.LayerRuneDetails.load()):(t.LayerRuneReplace.SetViewType(v.RuneReplaceViewType.equipment),t.LayerRuneReplace.SetData({slotId:n,type:o.type}),t.LayerRuneReplace.load())},e)}),r.tm("\u6309\u94ae_\u8fd4\u56de").setClick(function(){e.unload()},e),e.AddBtnBehavior(r.tm("\u6309\u94ae_\u7b26\u6587\u5408\u6210"),{systemId:f.SystemId.RuneSynthesis,OnRdChanged:function(e){t.com.tm("\u6309\u94ae_\u7b26\u6587\u5408\u6210.\u7ea2\u70b9").OnRDUpdate(e)}}),e.AddBtnBehavior(r.tm("\u6309\u94ae_\u7b26\u6587\u80cc\u5305"),{systemId:f.SystemId.VORuneBag,OnRdChanged:function(e){t.com.tm("\u6309\u94ae_\u7b26\u6587\u5408\u6210.\u7ea2\u70b9").OnRDUpdate(e)}})},e.prototype.InitGlist=function(){this.com.tm("\u5217\u8868_\u7b26\u6587\u63cf\u8ff0").init(this,function(t,e,r){var o=e;if(o.tm("\u5bcc\u6587\u672c_\u63cf\u8ff0").text="",o.setSelectedIndex("\u5f53\u524d\u72b6\u6001",r.type),o.tm("\u5bcc\u6587\u672c_\u540d\u79f0").text=r.name,1==r.type){var n=p.StringUtil.format(s.FW.G_W("\u63d0\u5347\u7b26\u6587\u54c1\u8d28\u81f3{0}  \u53ef\u89e3\u9501 {1} \u7279\u6b8a\u6280\u80fd"),r.lockQualityName,r.skillName);o.tm("\u5bcc\u6587\u672c_\u63cf\u8ff0").text=n}else 2==r.type&&(o.tm("\u5bcc\u6587\u672c_\u63cf\u8ff0").text=r.skilldesc)})},e.prototype.UpdateView=function(){var t,e,r,o,n=this,i=this.com,s=this.ModelRune.GetRuneMainDetailsData();i.tm("\u5217\u8868_\u7b26\u6587\u63cf\u8ff0").update2(6,s),this.wearMap=this.ModelRune.GetRuneSlotMap(),_.forEach(function(t,e){var r=i.tm(t.name),o=r.tm("item");n.wearMap.has(e)?(o.visible=!0,o.UpdateByGoods(n.wearMap.get(e)),o.GetBehavior().onNumberVisible(!1),r.setSelectedPage("\u52a0\u53f7\u663e\u793a","\u4e0d\u663e\u793a")):(o.UpdateByGoods(null),o.visible=!1,r.setSelectedPage("\u52a0\u53f7\u663e\u793a","\u663e\u793a"))});var c=0,u=0,p=this.ModelRune.GetRuneSlotMap();try{for(var f=a(p),h=f.next();!h.done;h=f.next()){var y=l(h.value,2),m=(y[0],y[1]);try{for(var v=(r=void 0,a(m.GetRuntimeSkillGroup())),S=v.next();!S.done;S=v.next()){var g=S.value;this.Ref.RefMgrskillGroup.getRef("refId",g).skillGroup.forEach(function(t){var e=n.Ref.RefMgrbuff.getRef("refId",t);110101==e.effect[0]&&(c+=e.effect[1]),110201==e.effect[0]&&(u+=e.effect[1])})}}catch(b){r={error:b}}finally{try{S&&!S.done&&(o=v.return)&&o.call(v)}finally{if(r)throw r.error}}}}catch(C){t={error:C}}finally{try{h&&!h.done&&(e=f.return)&&e.call(f)}finally{if(t)throw t.error}}i.tm("\u7ec4\u4ef6_\u5c5e\u6027_\u653b\u51fb.\u6587\u672c_\u57fa\u7840\u503c").text="+"+(Math.round(this.CtrlAttr.GetAttrByTypeAndKey(d.SubAttrRune,"atk").GetValue())+u),i.tm("\u7ec4\u4ef6_\u5c5e\u6027_\u9632\u5fa1.\u6587\u672c_\u57fa\u7840\u503c").text="+"+(Math.round(this.CtrlAttr.GetAttrByTypeAndKey(d.SubAttrRune,"hp").GetValue())+c)},e.__cname="LayerRuneMainUI",i([c.injectField("LayerRuneSynthesis")],e.prototype,"LayerRuneSynthesis",void 0),i([c.injectField("LayerRuneDetails")],e.prototype,"LayerRuneDetails",void 0),i([c.injectField("LayerRuneReplace")],e.prototype,"LayerRuneReplace",void 0),i([c.injectField("ModelVO")],e.prototype,"ModelVO",void 0),i([c.injectField("ModelRune")],e.prototype,"ModelRune",void 0),i([c.injectField("CtrlAttr")],e.prototype,"CtrlAttr",void 0),i([c.injectField("Ref")],e.prototype,"Ref",void 0),e}(h.GameLayerUI);r.LayerRuneMainUI=g,cc._RF.pop()},{"../../../../../../framework/FW":void 0,"../../../../../../framework/container/Container":void 0,"../../../../../../framework/layer/common/UIOrder":void 0,"../../../../../../framework/utils/StringUtil":void 0,"../../../../model/System/ModelSystem":"ModelSystem","../../../../ui/GameLayer":"GameLayer","../../../alert/CtrlAlert":"CtrlAlert","../../../attr/SubAttrRune":"SubAttrRune","./LayerRuneDetails":"LayerRuneDetails","./LayerRuneReplace":"LayerRuneReplace"}],LayerRuneReplace:[function(t,e,r){"use strict";cc._RF.push(e,"5f99foay9hAs7OrhT1FM7bb","LayerRuneReplace");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerRuneReplaceUI=r.LayerRuneReplace=r.RuneReplaceViewType=void 0;var a,l=t("../../../../../../framework/FW"),s=t("../../../../../../framework/container/Container"),c=t("../../../../../../framework/layer/common/UIOrder"),u=t("../../../../model/vo/Goods/Goods"),p=t("../../../../ui/GameLayer"),f=t("./LayerRuneDetails");(function(t){t[t.equipment=0]="equipment",t[t.replace=1]="replace"})(a=r.RuneReplaceViewType||(r.RuneReplaceViewType={}));var h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return y},e.prototype.getUrl=function(){return"ui://\u82f1\u96c4_\u7b26\u6587/\u7ec4\u4ef6_\u82f1\u96c4\u7b26\u6587_\u914d\u4ef6\u66ff\u6362"},e.prototype.getSortOrder=function(){return c.LayerOrder.TowLevel},e.prototype.SetViewType=function(t){this._viewType=t},e.prototype.GetViewType=function(){return this._viewType},e.prototype.SetData=function(t){this._data=t},e.prototype.GetData=function(){return this._data},e.__cname="LayerRuneReplace",e}(p.GameLayerProxy);r.LayerRuneReplace=h;var y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.minSize=2,e.maxSize=5,e}return n(e,t),e.prototype.getHasBackground=function(){return!0},e.prototype.init=function(){this.com.toCenterParent(this.container),this.InitClick(),this.InitGlist(),this.InitLayer()},e.prototype.InitClick=function(){var t=this,e=this.com;this.InitGlist(),e.tm("panel_bg.\u6309\u94ae_\u5173\u95ed").setClick(function(){t.unload()},t)},e.prototype.InitGlist=function(){var t=this,e=this;e.com.tm("\u5217\u8868_\u66ff\u6362\u7b26\u6587").init(e,function(r,o,n){var i=o,s=i.tm("\u7ec4\u4ef6_\u7b26\u6587"),c=e.ModelRune.GetIsPutById(n.GetId()),u=e.proxy.GetViewType(),p=e.proxy.GetData().slotId;i.setSelectedIndex("\u6309\u94ae\u6587\u5b57",u==a.equipment?0:1),i.setSelectedIndex("\u662f\u5426\u88c5\u5907",c?1:0),e.SetRuneComp(n,s),i.tm("\u6309\u94ae_\u88c5\u5907\u66ff\u6362").setClick(function(){u==a.equipment?(l.FW.LWX.log("\u8bf7\u6c42\u7b26\u6587\u7a7f\u6234"),e.unload(),t.ModelRune.RequestRunePutOn(n.GetId(),p)):(l.FW.LWX.log("\u8bf7\u6c42\u7b26\u6587\u66ff\u6362"),e.unload(),t.ModelRune.RequestRuneReplace(t.proxy.GetData().rune.GetId(),n.GetId()))},e)})},e.prototype.InitLayer=function(){var t=this.com,e=this.proxy.GetViewType();t.setSelectedIndex("\u754c\u9762\u7c7b\u578b",e),this.UpdateLayer()},e.prototype.UpdateLayer=function(){var t=this,e=this,r=e.com;l.FW.LWX.log("before "+r.height);var o=this.proxy.GetViewType(),n=this.proxy.GetData(),i=n.rune,s=n.type||i.GetGoodsType(),c=i?i.GetRefId():0,u=this.ModelRune.GetReplaceDataByType(s,c);u.sort(function(e,r){return t.Sort(e,r)});var p=r.tm("\u5217\u8868_\u66ff\u6362\u7b26\u6587").asList;if(p.update(u),u.length>this.minSize){var f=o==a.equipment?e.maxSize:e.maxSize-1,h=Math.min(u.length,f);p.resizeToFit(h)}if(r.setSelectedIndex("\u662f\u5426\u6709\u94ed\u6587\u53ef\u4ee5\u66ff\u6362\u88c5\u5907",u.length>0?1:0),i){var y=r.tm("\u7ec4\u4ef6_\u88c5\u5907\u7b26\u6587");this.SetRuneComp(i,y)}},e.prototype.SetRuneComp=function(t,e){var r=this,o=t.GetGoodsType(),n=String(this.ModelRune.GetRuneAttribute(t)),i=e.tm("item");i.UpdateByGoods(t),i.GetBehavior().onNumberVisible(!1),i.setClick(function(){r.LayerRuneDetails.SetData({rune:t}),r.LayerRuneDetails.SetViewType(f.RuneDetailsViewType.noShowButon),r.LayerRuneDetails.load()},this),e.tm("\u6587\u672c_\u540d\u79f0").text=t.GetName(),e.tm("\u6587\u672c_\u5c5e\u6027\u52a0\u6210").asTextField.setVar("value",n).flushVars(),e.setSelectedIndex("\u7c7b\u578b",o==u.EGoodsType.atkRune?0:1)},e.prototype.Sort=function(t,e){var r=t.GetQuality(),o=e.GetQuality();return r!=o?o-r:(r=t.GetPhase())!=(o=e.GetPhase())?o-r:(r=t.GetRefId())!=(o=e.GetRefId())?o-r:-1},e.__cname="LayerRuneReplaceUI",i([s.injectField("ModelRune")],e.prototype,"ModelRune",void 0),i([s.injectField("LayerRuneDetails")],e.prototype,"LayerRuneDetails",void 0),e}(p.GameLayerUI);r.LayerRuneReplaceUI=y,cc._RF.pop()},{"../../../../../../framework/FW":void 0,"../../../../../../framework/container/Container":void 0,"../../../../../../framework/layer/common/UIOrder":void 0,"../../../../model/vo/Goods/Goods":"Goods","../../../../ui/GameLayer":"GameLayer","./LayerRuneDetails":"LayerRuneDetails"}],LayerRuneSynthesisDisplay:[function(t,e,r){"use strict";cc._RF.push(e,"ffc48y+mqlCb4AvrWtqkrUt","LayerRuneSynthesisDisplay");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.LayerRuneSynthesisDisplayUI=r.LayerRuneSynthesisDisplay=void 0;var i=t("../../../../../../framework/FW"),a=t("../../../../../../framework/layer/common/UIOrder"),l=t("../../../../model/vo/Goods/Goods"),s=t("../../../../ui/GameLayer"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return u},e.prototype.getUrl=function(){return"ui://\u82f1\u96c4_\u7b26\u6587/\u7ec4\u4ef6_\u82f1\u96c4\u7b26\u6587_\u5408\u6210\u5c55\u793a"},e.prototype.getSortOrder=function(){return a.LayerOrder.OneLevel},e.prototype.SetData=function(t){this._data=t},e.prototype.GetData=function(){return this._data},e.prototype.SetRune=function(t){this._rune=t},e.prototype.GetRune=function(){return this._rune},e.__cname="LayerRuneSynthesisDisplay",e}(s.GameLayerProxy);r.LayerRuneSynthesisDisplay=c;var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getHasBackground=function(){return!0},e.prototype.init=function(){var t=this;this.com.toFullCenterParent(this.container),this.com.tm("\u88c5\u8f7d\u5668_\u52a8\u6548_\u94ed\u6587\u5343\u624b\u4f5b").SetUrlByIcon("\u7279\u6548_\u7b26\u6587_\u5343\u624b\u9f99\u738b"),this.com.tm("\u7279\u6548").SetUrlByIcon("\u7279\u6548_\u767e\u604b_\u5408\u6210\u7279\u6548"),this.com.tmt("\u52a8\u6548_\u64ad\u653e\u5408\u6210\u52a8\u753b").setHook("show",function(){t.InitClick(),t.UpdateLayer()}),this.com.tmt("\u52a8\u6548_\u64ad\u653e\u5408\u6210\u52a8\u753b").play()},e.prototype.InitClick=function(){var t=this;t.com.setClick(function(){t.unload()},t)},e.prototype.UpdateLayer=function(){var t=this.com,e=t.tm("\u7ec4\u4ef6_\u5408\u6210\u7b26\u6587");e.UpdateByGoods(this.proxy.GetRune()),e.GetBehavior().onNumberVisible(!1);var r=this.proxy.GetData();t.setSelectedIndex("\u662f\u5426\u89e3\u9501\u6280\u80fd",r.islockskill?1:0);var o=t.tm("\u5408\u6210\u63d0\u5347_\u5c5e\u6027").asLoader.component;if(o.tm("\u5f53\u524d\u5c5e\u6027").text=String(r.selectAttribute),o.tm("\u52a0\u6210").text=String(r.synthesisAttribute),o.tm("\u63cf\u8ff0").text=r.type==l.EGoodsType.atkRune?i.FW.G_W("\u653b\u51fb"):i.FW.G_W("\u751f\u547d"),o.setSelectedIndex("\u52a0\u6210\u7c7b\u578b",0),r.islockskill){var n=t.tm("\u5408\u6210\u63d0\u5347_\u6280\u80fd").asLoader.component;n.setSelectedIndex("\u52a0\u6210\u7c7b\u578b",1),n.tm("\u63cf\u8ff0").text=i.FW.G_W("\u89e3\u9501\u6280\u80fd"),n.tm("\u6280\u80fd\u63cf\u8ff0").text=r.skilldesc||""}},e.__cname="LayerRuneSynthesisDisplayUI",e}(s.GameLayerUI);r.LayerRuneSynthesisDisplayUI=u,cc._RF.pop()},{"../../../../../../framework/FW":void 0,"../../../../../../framework/layer/common/UIOrder":void 0,"../../../../model/vo/Goods/Goods":"Goods","../../../../ui/GameLayer":"GameLayer"}],LayerRuneSynthesis:[function(t,e,r){"use strict";cc._RF.push(e,"07d5b3uEehA6LLfsgP66Oi3","LayerRuneSynthesis");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerRuneSynthesisUI=r.LayerRuneSynthesis=void 0;var c,u=t("../../../../../../framework/FW"),p=t("../../../../../../framework/container/Container"),f=t("../../../../../../framework/layer/common/UIOrder"),h=t("../../../../model/System/ModelSystem"),y=t("../../../../ui/GameLayer"),d=t("../LayerOneKeySynthesisDisplay"),m=t("./LayerRuneBag"),v=t("./LayerRuneDetails"),_=["\u653e\u5165_\u7b26\u6587","\u6750\u65991","\u6750\u65992"],S=["1","2"];(function(t){t[t.normal=0]="normal",t[t.virtualization=1]="virtualization",t[t.synthiesis=2]="synthiesis",t[t.lockAndPlaceAsh=3]="lockAndPlaceAsh"})(c||(c={}));var g=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return b},e.prototype.getUrl=function(){return"ui://\u82f1\u96c4_\u7b26\u6587/\u7ec4\u4ef6_\u82f1\u96c4\u7b26\u6587_\u7b26\u6587\u5408\u6210"},e.prototype.getSortOrder=function(){return f.LayerOrder.OneLevel},e.prototype.getSystemId=function(){return h.SystemId.RuneSynthesis},e.__cname="LayerRuneSynthesis",e}(y.GameLayerProxy);r.LayerRuneSynthesis=g;var b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.nowType=-2,e.isSynthesis=!1,e.selectRune=null,e.synthesisRune=null,e.materialLen=-1,e.synthesisMater=[],e.synthesisMaterId=new Set,e.promoteData=null,e.data=[0,1],e.maxBag=100,e}return n(e,t),e.prototype.getHasBackground=function(){return!0},e.prototype.init=function(){this.com.toFullCenterParent(this.container),this.InitClick(),this.InitGList(),this.InitLayer(),this.toolSet.addListener(this.siftButton.GetEventBagSiftOnChangeProxy(),"BagSiftOnChange",this.UpdateLayer,this),this.toolSet.addListener(this.ModelMgr.ModelRune.GetEventVOBagOnChangeProxy(),"VOBagOnChange",this.UpdateLayer,this),this.toolSet.addListener(this.ModelMgr.ModelRune.GetEventSynthesisResultProxy(),"OnRuneSynthesisResult",this.SynthesisResult,this),this.toolSet.addListener(this.ModelMgr.ModelRune.GetEventOneKeySynthesisResultProxy(),"OnRuneOneKeySynthesisResult",this.OneKeySynthesisResult,this)},e.prototype.InitClick=function(){var t=this,e=this,r=this.com;r.tm("\u6309\u94ae_\u8fd4\u56de").setClick(function(){e.unload()},e),r.tm("\u6309\u94ae_\u5408\u6210").setClick(function(){return a(t,void 0,void 0,function(){var t,r,o,n,i,a,c,u,p,f;return l(this,function(l){switch(l.label){case 0:t=[];try{for(r=s(this.synthesisMater),o=r.next();!o.done;o=r.next())n=o.value,t.push(n.GetId())}catch(h){p={error:h}}finally{try{o&&!o.done&&(f=r.return)&&f.call(r)}finally{if(p)throw p.error}}return i=this.synthesisRune.GetRefId(),a=this.synthesisRune.GetQuality(),c=this.synthesisRune.GetPhase(),u={resId:i,quality:a,phase:c,nid:t},[4,e.ModelMgr.ModelRune.RequestRuneSynthesis(u)];case 1:return l.sent(),[2]}})})},e),r.tm("\u6309\u94ae_\u4e00\u952e\u5408\u6210").setClick(function(){t.isSynthesis||(t.onkeySynthesisState?e.ModelMgr.ModelRune.RequestRuneSynthesisOneKey():(e.LayerShowTip.SetData({context:u.FW.G_W("\u6ca1\u6709\u8db3\u591f\u7684\u7d2b\u8272\u4ee5\u4e0b\u7b26\u6587\u7528\u4f5c\u5408\u6210~\u5feb\u53bb\u6536\u96c6\u5427\uff01")}),e.LayerShowTip.load()))},e),new Map;for(var o=[{key:"\u653e\u5165_\u7b26\u6587",func:this.OnclickMaterial.bind(this)},{key:"\u6750\u65991",func:this.OnclickMaterial.bind(this)},{key:"\u6750\u65992",func:this.OnclickMaterial.bind(this)},{key:"\u5408\u6210_\u7b26\u6587",func:this.OnclicSynthesisSlot.bind(this)}],n=function(t){e.com.tm(o[t].key).setClick(function(){o[t].func(t)},e)},i=0;i<o.length;i++)n(i)},e.prototype.InitGList=function(){var t=this,e=this,r=e.com,o=function(t){t.setSelectedPage("\u5408\u6210\u72b6\u6001","\u5426"),t.setSelectedPage("\u662f\u5426\u88c5\u5907","\u5426"),t.setSelectedIndex("\u72b6\u6001",c.normal)},n=r.tm("\u5217\u8868_\u5408\u6210\u80cc\u5305");n.initVirtualList(e,function(e,r,n){var i=r,a=i.tm("item");if(o(i),n){a.visible=!0,a.UpdateByGoods(n),a.GetBehavior().onNumberVisible(!1);var l=c.normal,s=!1;t.isSynthesis?(s=!1,l=t.synthesisMaterId.has(n.GetId())?c.synthiesis:c.lockAndPlaceAsh):s=t.ModelMgr.ModelRune.GetSynthesisMap().has(n.GetId());var u=s;a.GetBehavior().OnGetRDComponent().OnRDUpdate(u),i.setSelectedIndex("\u72b6\u6001",l),i.setSelectedIndex("\u662f\u5426\u88c5\u5907",t.ModelMgr.ModelRune.GetIsPutById(n.GetId())?1:0)}else a.UpdateByGoods(null),a.visible=!1},function(r,o,n){if(n)if(t.isSynthesis)t.synthesisMaterId.has(n.GetId())&&(t.CleanSynthesisData(),t.UpdateLayer());else{var i=t.ModelMgr.ModelRune.GetIsMax(n.GetQuality(),n.GetPhase());if(null==i)return void u.FW.LWX.error("\u83b7\u53d6\u662f\u5426\u6700\u9ad8\u7b49\u7ea7\u51fa\u9519,quality,phase,",n.GetQuality(),n.GetPhase());if(i)e.CtrlAlert.LayerMessage.addMessage(u.FW.G_W("\u54c7~\u8be5\u5df2\u7ecf\u662f\u6700\u9ad8\u54c1\u8d28!\u4f60\u53ef\u771f\u5389\u5bb3~"));else{t.isSynthesis=!t.isSynthesis,t.selectRune=n;var a=t.ModelMgr.ModelRune.GetNextStage(n.GetQuality(),n.GetPhase(),n.GetGoodsType());t.materialLen=t.ModelMgr.ModelRune.GetSynthesisMaterLen(a.quality,a.phase),t.synthesisMater=t.ModelMgr.ModelRune.GetSelectSynthesisiMaterial(n),t.synthesisRune=t.CreateSynthesisRune(),t.promoteData=t.ModelMgr.ModelRune.GetPromoteData(t.selectRune,t.synthesisRune),t.RecordMaterialId(),t.UpdateSynthesicInfo(),t.com.tm("\u6309\u94ae_\u4e00\u952e\u5408\u6210").enabled=!1}}}),n.setVirtual()},e.prototype.RecordMaterialId=function(){var t,e;try{for(var r=s(this.synthesisMater),o=r.next();!o.done;o=r.next()){var n=o.value;this.synthesisMaterId.add(n.GetId())}}catch(i){t={error:i}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},e.prototype.CreateSynthesisRune=function(){var t=this.ModelMgr.ModelRune.GetNextStage(this.selectRune.GetQuality(),this.selectRune.GetPhase(),this.selectRune.GetGoodsType()),e=this.ModelMgr.ModelGoods.CreateGoodsByCmd({resId:this.selectRune.GetRefId(),number:"1"});return e.InitByCmd(this.selectRune.GetCmd()),e.SetQuality(t.quality),e.SetPhase(t.phase),e},e.prototype.UpdateSynthesicInfo=function(){var t=this.com;t.setSelectedPage("\u5408\u6210\u72b6\u6001",this.isSynthesis?"\u5408\u6210\u4e2d":"\u672a\u5408\u6210"),t.setSelectedPage("\u6750\u6599\u957f\u5ea6",S[this.materialLen-2]),t.setSelectedIndex("\u662f\u5426\u53ef\u4ee5\u5408\u6210",this.synthesisMater.length==this.materialLen?1:0),this.isSynthesis&&(t.tm("\u7ec4\u4ef6_\u63d0\u5347\u5c55\u793a").asCom.setSelectedIndex("\u7b26\u6587\u7c7b\u578b",this.promoteData.type),t.tm("\u7ec4\u4ef6_\u63d0\u5347\u5c55\u793a.\u6587\u672c_\u7b26\u6587\u540d\u79f0").text=this.promoteData.name,t.tm("\u7ec4\u4ef6_\u63d0\u5347\u5c55\u793a.\u6587\u672c_\u5f53\u524d\u5c5e\u6027").text=String(this.promoteData.selectAttribute),t.tm("\u7ec4\u4ef6_\u63d0\u5347\u5c55\u793a.\u6587\u672c_\u63d0\u5347\u540e\u5c5e\u6027").text=String(this.promoteData.synthesisAttribute),t.tm("\u7ec4\u4ef6_\u63d0\u5347\u5c55\u793a").asCom.setSelectedIndex("\u662f\u5426\u89e3\u9501\u6280\u80fd",this.promoteData.islockskill?1:0),this.promoteData.islockskill&&(t.tm("\u7ec4\u4ef6_\u63d0\u5347\u5c55\u793a.\u6587\u672c_\u89e3\u9501\u6280\u80fd").text=this.promoteData.skilldesc)),this.SetSingleSlotInfo("\u5408\u6210_\u7b26\u6587",this.synthesisRune);for(var e=0;e<_.length;e++){this.SetSingleSlotInfo(_[e],this.selectRune);var r=t.tm(_[e]);if(this.isSynthesis){var o=this.synthesisMater.length>=e+1;r.setSelectedPage("\u72b6\u6001",o?"\u6b63\u5e38":"\u865a\u5316")}else r.setSelectedPage("\u72b6\u6001","\u6b63\u5e38")}this.UpdateLayer()},e.prototype.SetSingleSlotInfo=function(t,e){var r=this.com.tm(t).tm("item");r.UpdateByGoods(e),r.GetBehavior().onNumberVisible(!1),r.visible=this.isSynthesis},e.prototype.CleanSynthesisData=function(){this.materialLen=-1,this.selectRune=null,this.synthesisRune=null,this.promoteData=null,this.synthesisMater=[],this.isSynthesis=!1,this.synthesisMaterId.clear(),this.UpdateSynthesicInfo()},e.prototype.OnclickMaterial=function(t){this.isSynthesis&&this.synthesisMater[t]&&(this.CleanSynthesisData(),this.com.setSelectedPage("\u5408\u6210\u72b6\u6001",this.isSynthesis?"\u5408\u6210\u4e2d":"\u672a\u5408\u6210"))},e.prototype.OnclicSynthesisSlot=function(){this.isSynthesis&&(this.CtrlMain.LayerRuneDetails.SetData({rune:this.synthesisRune}),this.CtrlMain.LayerRuneDetails.SetViewType(v.RuneDetailsViewType.noShowButon),this.CtrlMain.LayerRuneDetails.load())},e.prototype.InitLayer=function(){var t=this,e=(t.com,t.com.tm("\u6309\u94ae_\u7b5b\u9009")),r=t.com.tm("\u7b5b\u9009\u5217\u8868.list");t.siftButton=new m.SiftButton(e,r,t,t.data),this.UpdateLayer()},e.prototype.UpdateLayer=function(){var t=this;this.nowType=this.siftButton.GetNowType();var e=this.ModelMgr.ModelRune.GetRuneByType(this.nowType);this.isSynthesis?e.sort(function(e,r){return t.SyntthesisiStateSort(e,r)}):e.sort(function(e,r){return t.NormalSort(e,r)}),this.onkeySynthesisState=this.ModelMgr.ModelRune.GetOnekeySynthesisState(),this.com.tm("\u6309\u94ae_\u4e00\u952e\u5408\u6210").enabled=!0,this.com.tm("\u6309\u94ae_\u4e00\u952e\u5408\u6210").grayed=!this.onkeySynthesisState;for(var r=this.com.tm("\u5217\u8868_\u5408\u6210\u80cc\u5305").asList;e.length>this.maxBag;)this.maxBag+=50;var o=e.concat(new Array(this.maxBag-e.length));r.update(o)},e.prototype.Sort=function(t,e){var r=t.GetQuality(),o=e.GetQuality();return r!=o?o-r:(r=t.GetPhase())!=(o=e.GetPhase())?o-r:(r=t.GetRefId())!=(o=e.GetRefId())?r-o:-1},e.prototype.NormalSort=function(t,e){var r=this.ModelMgr.ModelRune.GetSynthesisMap().has(t.GetId())?1:0,o=this.ModelMgr.ModelRune.GetSynthesisMap().has(e.GetId())?1:0;return r!=o?o-r:this.Sort(t,e)},e.prototype.SyntthesisiStateSort=function(t,e){var r=this.synthesisMaterId.has(t.GetId())?1:0,o=this.synthesisMaterId.has(e.GetId())?1:0;return r!=o?o-r:this.Sort(t,e)},e.prototype.OneKeySynthesisResult=function(t,e){t?(this.CtrlMain.LayerOneKeySynthesisDisplay.SetGoodsList(e),this.CtrlMain.LayerOneKeySynthesisDisplay.SetShowBgType(d.ShowBgType.rune),this.CtrlMain.LayerOneKeySynthesisDisplay.load()):(this.LayerShowTip.SetData({context:u.FW.G_W("\u5408\u6210\u5931\u8d25\u4e86\uff0c\u662f\u6211\u7684\u9519\uff0c\u8bf7\u518d\u5c1d\u8bd5\u4e00\u4e0b\u5427~")}),this.LayerShowTip.load())},e.prototype.SynthesisResult=function(t){t?(this.CtrlMain.LayerRuneSynthesisDisplay.SetData(this.promoteData),this.CtrlMain.LayerRuneSynthesisDisplay.SetRune(this.synthesisRune),this.CtrlMain.LayerRuneSynthesisDisplay.load()):(this.LayerShowTip.SetData({context:u.FW.G_W("\u5408\u6210\u5931\u8d25\u4e86\uff0c\u662f\u6211\u7684\u9519\uff0c\u8bf7\u518d\u5c1d\u8bd5\u4e00\u4e0b\u5427~")}),this.LayerShowTip.load()),this.CleanSynthesisData()},e.__cname="LayerRuneSynthesisUI",i([p.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([p.injectField("LayerShowTip")],e.prototype,"LayerShowTip",void 0),i([p.injectField("CtrlMain")],e.prototype,"CtrlMain",void 0),i([p.injectField("CtrlAlert")],e.prototype,"CtrlAlert",void 0),e}(y.GameLayerUI);r.LayerRuneSynthesisUI=b,cc._RF.pop()},{"../../../../../../framework/FW":void 0,"../../../../../../framework/container/Container":void 0,"../../../../../../framework/layer/common/UIOrder":void 0,"../../../../model/System/ModelSystem":"ModelSystem","../../../../ui/GameLayer":"GameLayer","../LayerOneKeySynthesisDisplay":"LayerOneKeySynthesisDisplay","./LayerRuneBag":"LayerRuneBag","./LayerRuneDetails":"LayerRuneDetails"}],LayerSelectUpgrade:[function(t,e,r){"use strict";cc._RF.push(e,"a882dRjJc1OYpeaYO5jPaN9","LayerSelectUpgrade");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerSelectUpgradeUI=r.LayerSelectUpgrade=void 0;var a=t("../../../../../../framework/container/Container"),l=t("../../../../../../framework/fork/Fork"),s=t("../../../../../../framework/layer/common/UIOrder"),c=t("../../../../ui/GameLayer"),u=t("../../../alert/CtrlAlert"),p=t("../../logic/gameplay/sub/GPOSkill"),f=t("../../logic/gameplay/sub/GPOSupply"),h=t("./BattleLayerOrder"),y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return d},e.prototype.getUrl=function(){return"ui://\u6218\u6597/\u7ec4\u4ef6_\u6218\u6597_\u5347\u7ea7\u9009\u62e9"},e.prototype.getSortOrder=function(){return s.LayerOrder.Main},e.prototype.getSortOrder2=function(){return h.BattleLayerOrder.OneLevel},e.__cname="LayerSelectUpgrade",e}(c.GameLayerProxy);r.LayerSelectUpgrade=y;var d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}var r;return n(e,t),r=e,e.prototype.getHasBackground=function(){return!0},e.prototype.init=function(){var t,e;this.com.toFullCenterParent(this.container),this.com.tm("\u6309\u94ae_\u5237\u65b0").setClick(this.onRefresh,this),this.InitParticle(),null===(t=this.GPAudio)||void 0===t||t.levelup(),null===(e=this.GPAudio)||void 0===e||e.adjustBGM(this),this.initSupplyList(),this.initSkillList(),this.initList(),this.initAfter()},e.prototype.initAfter=function(){},e.prototype.release=function(){this.releaseAfter(),this.GPAudio.resumeBGM(this)},e.prototype.releaseAfter=function(){},e.prototype.enter=function(){var t=this;this.SystemEvent.sendPaused(this),this.toolSet.addCallback(this.GPLevelUp.GetChangeCallback(),function(){t.updateView()}),this.updateView()},e.prototype.exit=function(){this.toolSet.removeAllCallback(),this.SystemEvent.sendResume(this)},e.prototype.update=function(){},e.prototype.InitParticle=function(){this.com.tm("\u88c5\u8f7d\u5668_\u591a\u8272\u7c92\u5b50").SetUrlByModel(u.particlesMap.get("\u591a\u8272\u7c92\u5b50"))},e.prototype.updateView=function(){this.com.setSelectedPage("\u663e\u793a\u5237\u65b0",this.GPLevelUp.GetHasRefresh()?"\u662f":"\u5426"),this.updateSupply(),this.updateSkill(),this.updateList()},e.prototype.getComListSupply=function(){return this.com.tm("\u5217\u8868_\u88ab\u52a8").asList},e.prototype.initSupplyList=function(){this.getComListSupply().init(this,this.renderSupplyItem)},e.prototype.renderSupplyItem=function(t,e,r){var o=this.GPHeroSupply.GetLimit();if(!r||t>=o)e.tmc("\u5c01\u5370").setSelectedIndex(1);else{e.tmc("\u5c01\u5370").setSelectedIndex(0);var n=e.tm("icon"),i=e.tm("title");r.IsEmpty()?(n.Clean(),i.text=""):(n.SetUrlByIcon(r.GetIcon()),i.text=r.GetName())}},e.prototype.updateSupply=function(){var t=this.GPHeroSupply.GetTlSupply();this.getComListSupply().update2(6,t)},e.prototype.getComListSkill=function(){return this.com.tm("\u5217\u8868_\u6b66\u5668").asList},e.prototype.initSkillList=function(){this.getComListSkill().init(this,this.renderSkillItem)},e.prototype.renderSkillItem=function(t,e,r){var o=this.GPHeroSkill.GetLimit();if(!r||t>=o)e.tmc("\u5c01\u5370").setSelectedIndex(1);else{e.tmc("\u5c01\u5370").setSelectedIndex(0);var n=e.tm("icon"),i=e.tm("title");r.IsEmpty()?(n.Clean(),i.text=""):(n.SetUrlByIcon(r.GetIcon()),i.text=r.GetName())}},e.prototype.updateSkill=function(){var t=this.GPHeroSkill.GetTlSkill();this.getComListSkill().update2(6,t)},e.prototype.getComList=function(){return this.com.tm("\u5217\u8868_\u9009\u9879\u5361").asList},e.prototype.initList=function(){var t=this,e=this.getComList(),r=function(e,r,o){var n=r,i=o,a=i.GetIsBroken(),l=a||1==i.GetLevel();if(n.setSelectedPage("\u7c7b\u578b",a?"\u7a81\u7834":"\u6b66\u5668"),n.setSelectedPage("\u65b0",l?"\u662f":"\u5426"),n.setSelectedPage("\u663e\u793a\u7a81\u7834\u7ec4\u5408","\u5426"),n.setSelectedPage("\u663e\u793a\u7b49\u7ea7",a?"\u5426":"\u662f"),0==a){var s=n.tm("\u7ec4\u4ef6_\u6280\u80fd\u7b49\u7ea7").asProgress;s.max=i.GetMaxLevel(),s.value=i.GetLevel(),t.shakeBar(s)}},o=function(e,r,o){var n=r,i=o,a=1==i.GetLevel(),l=i.GetCompare().length>0;n.setSelectedPage("\u7c7b\u578b","\u8865\u7ed9"),n.setSelectedPage("\u65b0",a?"\u662f":"\u5426"),n.setSelectedPage("\u663e\u793a\u7a81\u7834\u7ec4\u5408",l?"\u662f":"\u5426"),n.setSelectedPage("\u663e\u793a\u7b49\u7ea7","\u662f");var s=n.tm("\u7ec4\u4ef6_\u6280\u80fd\u7b49\u7ea7").asProgress;s.max=i.GetMaxLevel(),s.value=i.GetLevel(),t.shakeBar(s),t.updateListCompare(n.tm("\u5217\u8868_\u7a81\u7834\u7ec4\u5408"),i)},n=!1;e.init(this,function(t,e,n){var i=e;i.tm("\u6587\u672c_\u6807\u9898").text=n.GetName(),i.tm("\u88c5\u8f7d\u5668_\u56fe\u6807").SetUrlByIcon(n.GetIcon()),i.tm("\u6587\u672c_\u6280\u80fd\u8bf4\u660e").text=n.GetDesc(),n instanceof p.GPOSkill?r(0,e,n):n instanceof f.GPOSupply?o(0,e,n):(i.setSelectedPage("\u7c7b\u578b","\u8865\u7ed9"),i.setSelectedPage("\u65b0","\u5426"),i.setSelectedPage("\u663e\u793a\u7a81\u7834\u7ec4\u5408","\u5426"),i.setSelectedPage("\u663e\u793a\u7b49\u7ea7","\u5426"))},function(e){n||(t.GPAudio.click(),n=!0,t.GPLevelUp.Select(e),t.unload())})},e.prototype.updateList=function(){var t=this.GPLevelUp.GetTlSelect();this.getComList().update(t)},e.prototype.updateListCompare=function(t,e){var r=this,o=e.GetCompare();t.init(this,function(t,e,o){var n=o;if(r.GPHeroSkill.HasSkill(n)){var i=r.GPHeroSkill.GetSkill(n);e.setSelectedPage("\u5df2\u62e5\u6709","\u662f"),e.tm("icon").SetUrlByIcon(i.GetIcon())}else{var a=r.ModelBattleSkill.GetSkill(n);e.setSelectedPage("\u5df2\u62e5\u6709","\u5426"),e.tm("icon").SetUrlByIcon(a.GetIcon())}}),t.update(o)},e.prototype.onRefresh=function(){this.GPLevelUp.RefreshSelector()},e.prototype.shakeBar=function(t){var e=t.asProgress,r=Math.max(0,e.value-1);e.tm("bar").asCom.getChildAt(r).asCom.setSelectedPage("\u95ea\u70c1","\u662f")},e.__cname="LayerSelectUpgradeUI",i([a.injectField("Battle")],e.prototype,"Battle",void 0),i([a.injectField("SystemEvent")],e.prototype,"SystemEvent",void 0),i([a.injectField("GPLevelUp")],e.prototype,"GPLevelUp",void 0),i([a.injectField("GPHeroSkill")],e.prototype,"GPHeroSkill",void 0),i([a.injectField("GPHeroSupply")],e.prototype,"GPHeroSupply",void 0),i([a.injectField("ModelBattleSkill")],e.prototype,"ModelBattleSkill",void 0),i([a.injectField("GPAudio")],e.prototype,"GPAudio",void 0),i([l.forkClass(r,null)],e)}(c.GameLayerUI);r.LayerSelectUpgradeUI=d,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../../../../../framework/fork/Fork":void 0,"../../../../../../framework/layer/common/UIOrder":void 0,"../../../../ui/GameLayer":"GameLayer","../../../alert/CtrlAlert":"CtrlAlert","../../logic/gameplay/sub/GPOSkill":"GPOSkill","../../logic/gameplay/sub/GPOSupply":"GPOSupply","./BattleLayerOrder":"BattleLayerOrder"}],LayerSetting:[function(t,e,r){"use strict";cc._RF.push(e,"13fd30/5fNC0bZDJxk/cdjc","LayerSetting");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerSettingUI=r.LayerSetting=void 0;var c,u=t("../../../../../../engine/EngineMain"),p=t("../../../../../../framework/container/Container"),f=t("../../../../../../framework/Func"),h=t("../../../../../../framework/FW"),y=t("../../../../../../framework/layer/common/UIOrder"),d=t("../../../../model/System/ModelSystem"),m=t("../../../../ui/GameLayer"),v=t("../../../sdk/SDKMgr");(function(t){t[t.GaiLv=0]="GaiLv",t[t.UserAgreement=1]="UserAgreement",t[t.PrivacyAgreement=2]="PrivacyAgreement"})(c||(c={}));var _=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return S},e.prototype.getUrl=function(){return"ui://\u7cfb\u7edf\u8bbe\u7f6e/\u7ec4\u4ef6_\u7cfb\u7edf\u8bbe\u7f6e_\u4e3b\u754c\u9762"},e.prototype.getSortOrder=function(){return y.LayerOrder.TowLevel},e.__cname="LayerSetting",e}(m.GameLayerProxy);r.LayerSetting=_;var S=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getHasBackground=function(){return!0},e.prototype.GetHasCloseAnimation=function(){return!0},e.prototype.GetHasShowAnimation=function(){return!0},e.prototype.init=function(){this.com.toFullCenterParent(this.container),this.InitSettingView(),this.InitClick()},e.prototype.InitSettingView=function(){var t=this,e=t.com,r=t.ModelMgr.ModelVO.VORoleBag.GetOne();this.account=r.GetRoleId().toString(),this.version=t.AppCustomData.serverVersion;var o=t.AppCustomData.audit?1:0;e.setSelectedIndex("\u662f\u5426\u63d0\u5ba1",o);var n=!t.AppCustomData.audit&&t.CtrlNotice.ShowSettingFeedBack;e.tm("\u6309\u94ae_\u53cd\u9988\u95ee\u9898").visible=n,e.tm("\u6309\u94ae_\u793c\u5305\u7801").visible=n,e.tm("\u6309\u94ae_\u5206\u4eab\u6709\u793c").visible=n,h.FW.LWX.log("\u8d26\u53f7\uff1a",t.account),e.tm("\u6587\u672c_\u8d26\u53f7ID").asTextField.setVar("account",this.account).flushVars(),e.tm("\u6587\u672c_\u7248\u672c\u53f7").asTextField.setVar("version",this.version).flushVars()},e.prototype.InitClick=function(){var t,e,r=this,o=this,n=o.com;n.tm("panel_bg.\u6309\u94ae_\u5173\u95ed").setClick(function(){o.unload()},o),this.SDKMgr.getSDK().GetCanCopyAccount()?n.tm("\u6309\u94ae_\u590d\u5236\u8d26\u53f7").setClick(function(){h.FW.LWX.log("\u70b9\u51fb\u590d\u5236\u8d26\u53f7"),f.Func.copy(r.account)},o):n.tm("\u6309\u94ae_\u590d\u5236\u8d26\u53f7").visible=!1,n.tm("\u6309\u94ae_\u53cd\u9988\u95ee\u9898").setClick(function(){h.FW.LWX.log("\u70b9\u51fb\u53cd\u9988\u95ee\u9898"),r.LayerCustomerService.load()},o),n.tm("\u6309\u94ae_\u9000\u51fa\u767b\u5f55").setClick(function(){h.FW.LWX.log("\u70b9\u51fb\u9000\u51fa\u767b\u5f55"),o.LayerLogoutTips.load()},o),n.tm("\u6309\u94ae_\u793c\u5305\u7801").setClick(function(){h.FW.LWX.log("\u70b9\u51fb\u793c\u5305\u7801"),r.LayerGiftPackage.load()},o),this.AddBtnBehavior(n.tm("\u6309\u94ae_\u5206\u4eab\u6709\u793c"),{systemId:d.SystemId.Share,OnVisibleChanged:function(t,e){t.visible=e},OnRdChanged:function(){}}),this.SDKMgr.getSDK().HasUserAgreement()?(this.setFairyBtnEvent(n.tm("\u6587\u672c_\u7528\u6237\u534f\u8bae"),function(){return a(r,void 0,void 0,function(){return l(this,function(){return this.OpenOrCopyUrl(c.UserAgreement),[2]})})}),this.setFairyBtnEvent(n.tm("\u6587\u672c_\u9690\u79c1\u534f\u8bae"),function(){return a(r,void 0,void 0,function(){return l(this,function(){return this.OpenOrCopyUrl(c.PrivacyAgreement),[2]})})})):(n.tm("\u6587\u672c_\u7528\u6237\u534f\u8bae").visible=!1,n.tm("\u6587\u672c_\u9690\u79c1\u534f\u8bae").visible=!1),this.setFairyBtnEvent(n.tm("\u6587\u672c_\u6982\u7387\u516c\u5f0f"),function(){return a(r,void 0,void 0,function(){var t;return l(this,function(){return""==(t=o.ModelMgr.ModelGameConfig.GetGameConfigValueByKey("ProbabilityFormula"))||null==t?(h.FW.showTip("\u590d\u5236\u5931\u8d25\uff0c\u5185\u5bb9\u4e3a\u7a7a"),[2]):(this.OpenOrCopyUrl(c.GaiLv),[2])})})});var i=[{key:"\u8bbe\u7f6e_\u58f0\u97f3.\u6309\u94ae_\u5f00\u5173",onoff:this.OnOffMgr.OnOffSound,renderer:function(t,e){t.asButton.selected=e.GetValue()},click:function(t,e){var o=t.asButton.selected;e.SetValue(o),e.Save(),r.CtrlAudio.SetSoundVolume(o?1:0)}},{key:"\u8bbe\u7f6e_\u97f3\u4e50.\u6309\u94ae_\u5f00\u5173",onoff:this.OnOffMgr.OnOffMusic,renderer:function(t,e){t.asButton.selected=e.GetValue()},click:function(t,e){var o=t.asButton.selected;e.SetValue(o),e.Save(),r.CtrlAudio.SetMusicVolume(o?1:0)}},{key:"\u8bbe\u7f6e_\u7279\u6548\u5f31\u5316.\u6309\u94ae_\u5f00\u5173",onoff:this.OnOffMgr.OnOffEffectWeakening,renderer:function(t,e){t.asButton.selected=e.GetValue()},click:function(t,e){var r=t.asButton.selected;e.SetValue(r),e.Save()}},{key:"\u8bbe\u7f6e_\u6447\u6746.\u6309\u94ae_\u5f00\u5173",onoff:this.OnOffMgr.OnOffJoystick,renderer:function(t,e){t.asButton.selected=e.GetValue()},click:function(t,e){var r=t.asButton.selected;e.SetValue(r),e.Save()}}],u=function(t){var e=n.tm(t.key).asButton;t.renderer(e,t.onoff),e.setClick(function(){t.click(e,t.onoff)},o)};try{for(var p=s(i),y=p.next();!y.done;y=p.next())u(y.value)}catch(m){t={error:m}}finally{try{y&&!y.done&&(e=p.return)&&e.call(p)}finally{if(t)throw t.error}}},e.prototype.OpenOrCopyUrl=function(t){var e;switch(t){case c.GaiLv:e=this.ModelMgr.ModelGameConfig.GetGameConfigValueByKey("ProbabilityFormula");break;case c.UserAgreement:e=v.SDKMgr.instance.getSDK().userAgreement();break;case c.PrivacyAgreement:e=v.SDKMgr.instance.getSDK().privacyAgreement()}null!=e&&(u.EngineMain.isMiniGameWeiXin?f.Func.copy(e)?h.FW.showTip(h.FW.G_W("\u590d\u5236\u6210\u529f\uff0c\u8bf7\u6253\u5f00\u6d4f\u89c8\u5668\u67e5\u770b")):h.FW.showTip(h.FW.G_W("\u672a\u77e5\u9519\u8bef\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5")):cc.sys.openURL(e))},e.__cname="LayerSettingUI",i([p.injectField("LayerLogoutTips")],e.prototype,"LayerLogoutTips",void 0),i([p.injectField("LayerGiftPackage")],e.prototype,"LayerGiftPackage",void 0),i([p.injectField("LayerCustomerService")],e.prototype,"LayerCustomerService",void 0),i([p.injectField("OnOffMgr")],e.prototype,"OnOffMgr",void 0),i([p.injectField("CtrlAudio")],e.prototype,"CtrlAudio",void 0),i([p.injectField("LayerShare")],e.prototype,"LayerShare",void 0),i([p.injectField("AppCustomData")],e.prototype,"AppCustomData",void 0),i([p.injectField("CtrlNotice")],e.prototype,"CtrlNotice",void 0),i([p.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([p.injectField("SDKMgr")],e.prototype,"SDKMgr",void 0),e}(m.GameLayerUI);r.LayerSettingUI=S,cc._RF.pop()},{"../../../../../../engine/EngineMain":void 0,"../../../../../../framework/FW":void 0,"../../../../../../framework/Func":void 0,"../../../../../../framework/container/Container":void 0,"../../../../../../framework/layer/common/UIOrder":void 0,"../../../../model/System/ModelSystem":"ModelSystem","../../../../ui/GameLayer":"GameLayer","../../../sdk/SDKMgr":"SDKMgr"}],LayerSettle:[function(t,e,r){"use strict";cc._RF.push(e,"bf063v0FFVLc444cgU0LsLf","LayerSettle");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerSettleUI=r.LayerSettle=void 0;var s=t("../../../../../../framework/container/Container"),c=t("../../../../../../framework/fork/Fork"),u=t("../../../../../../framework/FW"),p=t("../../../../../../framework/layer/common/UIOrder"),f=t("../../../../../../framework/layer/PopLayerMgr"),h=t("../../../../model/public/AppCustomData"),y=t("../../../../model/vo/Goods/VOItem"),d=t("../../../../ui/GameLayer"),m=t("../../../alert/CtrlAlert"),v=t("../../logic/gameplay/sub/GPNetSync"),_=t("./BattleLayerOrder"),S=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return g},e.prototype.getUrl=function(){return"ui://\u6218\u6597/\u7ec4\u4ef6_\u6218\u6597_\u7ed3\u7b97\u754c\u9762"},e.prototype.getSortOrder=function(){return p.LayerOrder.Main},e.prototype.getSortOrder2=function(){return _.BattleLayerOrder.ThreeLevel},e.prototype.SetData=function(t,e){this._data=t,this._localData=e},e.prototype.GetData=function(){return this._data},e.prototype.GetLocalData=function(){return this._localData},e.prototype.SetIsWin=function(t){this._isWin=t},e.prototype.GetIsWin=function(){return this._isWin},e.__cname="LayerSettle",e}(d.GameLayerProxy);r.LayerSettle=S;var g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isShowAnimation=!1,e.isNew=!1,e.tlReward=[],e.isWin=2,e}var r;return n(e,t),r=e,e.prototype.getHasBackground=function(){return!0},e.prototype.init=function(){var t=this;this.com.toCenterParent(this.container),this.com.tm("\u6309\u94ae_\u786e\u5b9a\u6309\u94ae").setClick(function(){t.CtrlBattle.TryExitBattle(),t.unload()},this);var e=this.com.tm("\u7ec4\u4ef6_\u6218\u6597_\u7ed3\u7b97_\u50a8\u94b1\u7f50\u6a21\u5757.\u56fe\u6807_\u50a8\u94b1\u7f50");e.visible=!h.AppCustomData.instance.audit,e.setClick(function(){t.LayerLuckyCat.load()},this),this.com.tm("\u6309\u94ae_\u7edf\u8ba1").visible=!1,this.InitData(),this.InitParticle(),this.UpdateView(),this.CheckProgress()},e.prototype.release=function(){},e.prototype.enter=function(){this.CheckUnlockSkill()},e.prototype.exit=function(){},e.prototype.update=function(t){if(this.isShowAnimation){var e=this.com.tm("\u7ec4\u4ef6_\u6218\u6597_\u7ed3\u7b97_\u50a8\u94b1\u7f50\u6a21\u5757.\u8fdb\u5ea6\u6761").asProgress;e.value<this.cacheLastProgress?e.value+=t*this._space:(this.isShowAnimation=!1,this.com.touchable=!0,this.com.tm("\u7ec4\u4ef6_\u6218\u6597_\u7ed3\u7b97_\u50a8\u94b1\u7f50\u6a21\u5757.\u56fe\u6807_\u50a8\u94b1\u7f50").visible=!0,this.com.tm("\u7ec4\u4ef6_\u6218\u6597_\u7ed3\u7b97_\u50a8\u94b1\u7f50\u6a21\u5757").asCom.tmt("\u52a8\u6548_\u50a8\u94b1\u7f50").play())}},e.prototype.InitServerData=function(){var t,e,r=this.proxy.GetData(),o=this.localData;if(r){var n=r.cmdBattleResultReward,i=this.tlReward;if(u.FW.ZJJ.log("\u670d\u52a1\u5668\u8fd4\u56de\u6218\u6597\u7ed3\u7b97",n),this.best=Math.floor(Math.max(n.bestPoint,o.GetPoint())),this.isNew=1==n.isNew,n.cmdGoods)try{for(var s=a(n.cmdGoods),c=s.next();!c.done;c=s.next()){var p=c.value,f=l(this.CheckInArray(i,p.resId),2),h=f[0],y=f[1];if(h){var d=this.ModelGoods.CreateGoods(p.resId);d.InitByCmd(p),i.push(d)}else{var m=Number(y.GetNumber())+Number(p.number);y.SetNumber(m)}}}catch(v){t={error:v}}finally{try{c&&!c.done&&(e=s.return)&&e.call(s)}finally{if(t)throw t.error}}}else this.best=null,this.isNew=!1},e.prototype.InitData=function(){var t=this.Battle.startConfig.fubenId,e=this.ModelFuben.GetFubenRefByResId(t),r=this.SystemSpawn.GetPoint(),o=new v.NetSyncData;o.SetByCmd(this.proxy.GetLocalData().beat),this.localData=o,this.name=e.name,this.kill=o.GetKill();var n=Math.floor(o.GetPoint());this.score=n<r?n:r,this.isWin=this.proxy.GetIsWin(),this.InitServerData(),this.tlReward},e.prototype.InitParticle=function(){this.com.tm("\u7ed3\u7b97\u5e95\u6846.\u88c5\u8f7d\u5668_\u56db\u5468\u6269\u6563").SetUrlByModel(m.particlesMap.get("\u56db\u5468\u6269\u6563\u91d1\u8272\u7c92\u5b50"))},e.prototype.UpdateView=function(){this.UpdateComTime(),this.UpdateRewardList(),this.UpdateFrameState()},e.prototype.UpdateFrameState=function(){this.com.tm("\u7ed3\u7b97\u5e95\u6846").setSelectedPage("\u72b6\u6001",1==this.proxy.GetIsWin()?"\u80dc\u5229":"\u5931\u8d25")},e.prototype.UpdateComTime=function(){var t=this.com.tm("\u7ec4\u4ef6_\u65f6\u95f4\u8bb0\u5f55");t.setSelectedPage("\u65b0\u7eaa\u5f55",this.isNew?"\u662f":"\u5426"),t.setSelectedPage("\u663e\u793a\u6700\u4f73\u65f6\u95f4",this.best?"\u662f":"\u5426"),t.tm("\u6587\u672c_\u7ae0\u8282").text=u.FW.G_W(this.name),t.tm("\u6587\u672c_\u6700\u4f73\u65f6\u95f4").asTextField.setVar("val",this.TimeUtil.formatTime(this.best,"%m:%s")).flushVars(),t.tm("\u6587\u672c_\u65f6\u95f4").text=this.TimeUtil.formatTime(this.score,"%m:%s"),t.tm("\u6587\u672c_\u964d\u9b54\u6570").asTextField.setVar("val",""+this.kill).flushVars()},e.prototype.UpdateRewardList=function(){var t=this.tlReward;if(0!=t.length){this.com.setSelectedPage("\u663e\u793a\u5956\u52b1","\u662f");var e=this.com.tm("\u7ec4\u4ef6_\u5956\u52b1\u5185\u5bb9.\u5217\u8868_\u5956\u52b1").asList;e.init(this,function(t,e,r){e.tm("\u7269\u54c1\u6846").UpdateByGoods(r)}),e.update(t.sort(function(t,e){return t.GetRefId()-e.GetRefId()}))}else this.com.setSelectedPage("\u663e\u793a\u5956\u52b1","\u5426")},e.prototype.CheckProgress=function(){var t=null!=this.ModelMgr.ModelVO.VOLuckyCatBag.GetOne();this.com.tm("\u7ec4\u4ef6_\u6218\u6597_\u7ed3\u7b97_\u50a8\u94b1\u7f50\u6a21\u5757").visible=t,t&&this.ShowProgress()},e.prototype.ShowProgress=function(){var t=this,e=t.com;e.touchable=!1;var r=this.ModelMgr.ModelVO.VOLuckyCatBag.GetOne(),o=r.GetRef(),n=this.ModelMgr.ModelLuckyCat.GetLastProcess();e.tm("\u7ec4\u4ef6_\u6218\u6597_\u7ed3\u7b97_\u50a8\u94b1\u7f50\u6a21\u5757.\u56fe\u6807_\u50a8\u94b1\u7f50.icon").SetUrlByIcon(o.layerIcon),e.tm("\u7ec4\u4ef6_\u6218\u6597_\u7ed3\u7b97_\u50a8\u94b1\u7f50\u6a21\u5757.\u56fe\u6807_\u5de6.icon").SetUrlByIcon(o.baseIcon),e.tm("\u7ec4\u4ef6_\u6218\u6597_\u7ed3\u7b97_\u50a8\u94b1\u7f50\u6a21\u5757.\u56fe\u6807_\u5de6.title").text=o.base.toString(),e.tm("\u7ec4\u4ef6_\u6218\u6597_\u7ed3\u7b97_\u50a8\u94b1\u7f50\u6a21\u5757.\u56fe\u6807_\u53f3.icon").SetUrlByIcon(o.lastIcon),e.tm("\u7ec4\u4ef6_\u6218\u6597_\u7ed3\u7b97_\u50a8\u94b1\u7f50\u6a21\u5757.\u56fe\u6807_\u53f3.title").text=o.last.toString(),e.tm("\u7ec4\u4ef6_\u6218\u6597_\u7ed3\u7b97_\u50a8\u94b1\u7f50\u6a21\u5757.\u8fdb\u5ea6\u6761.title.icon").SetUrlByIcon(o.progressIcon);var i=e.tm("\u7ec4\u4ef6_\u6218\u6597_\u7ed3\u7b97_\u50a8\u94b1\u7f50\u6a21\u5757.\u8fdb\u5ea6\u6761").asProgress;i.min=o.base,i.max=o.last,i.value=n,t.cacheLastProgress=r.GetProcess(),this._space=r.GetProcess()-n,this.ModelMgr.ModelLuckyCat.SetLastProcess(r.GetProcess()),t.isShowAnimation=!0},e.prototype.CheckInArray=function(t,e){var r,o;try{for(var n=a(t),i=n.next();!i.done;i=n.next()){var l=i.value;if(l.GetRefId()==e)return l instanceof y.VOItem?[!1,l]:[!0,null]}}catch(s){r={error:s}}finally{try{i&&!i.done&&(o=n.return)&&o.call(n)}finally{if(r)throw r.error}}return[!0,null]},e.prototype.CheckUnlockSkill=function(){var t,e,r=this;if(1==this.proxy.GetIsWin()){var o=this.Battle.startConfig.tlUnlockSkillId;if(o){var n=function(t){null!=i.ModelMgr.ModelChapter.GetShowSkillRef(t)&&f.PopLayerMgr.inst().AddLayer(i,i.LayerUnlockSkill,function(){r.LayerUnlockSkill.SetUnlockSkillId(t),r.LayerUnlockSkill.load()})},i=this;try{for(var l=a(o),s=l.next();!s.done;s=l.next())n(s.value)}catch(c){t={error:c}}finally{try{s&&!s.done&&(e=l.return)&&e.call(l)}finally{if(t)throw t.error}}}}},e.__cname="LayerSettleUI",i([s.injectField("CtrlBattle")],e.prototype,"CtrlBattle",void 0),i([s.injectField("ModelFuben")],e.prototype,"ModelFuben",void 0),i([s.injectField("Battle")],e.prototype,"Battle",void 0),i([s.injectField("ComVar")],e.prototype,"ComVar",void 0),i([s.injectField("SystemSpawn")],e.prototype,"SystemSpawn",void 0),i([s.injectField("TimeUtil")],e.prototype,"TimeUtil",void 0),i([s.injectField("ModelHero")],e.prototype,"ModelHero",void 0),i([s.injectField("ModelBattleSkill")],e.prototype,"ModelBattleSkill",void 0),i([s.injectField("ModelGoods")],e.prototype,"ModelGoods",void 0),i([s.injectField("ModelBattleDrop")],e.prototype,"ModelBattleDrop",void 0),i([s.injectField("LayerLuckyCat")],e.prototype,"LayerLuckyCat",void 0),i([s.injectField("LayerUnlockSkill")],e.prototype,"LayerUnlockSkill",void 0),i([c.forkClass(r,null)],e)}(d.GameLayerUI);r.LayerSettleUI=g,cc._RF.pop()},{"../../../../../../framework/FW":void 0,"../../../../../../framework/container/Container":void 0,"../../../../../../framework/fork/Fork":void 0,"../../../../../../framework/layer/PopLayerMgr":void 0,"../../../../../../framework/layer/common/UIOrder":void 0,"../../../../model/public/AppCustomData":"AppCustomData","../../../../model/vo/Goods/VOItem":"VOItem","../../../../ui/GameLayer":"GameLayer","../../../alert/CtrlAlert":"CtrlAlert","../../logic/gameplay/sub/GPNetSync":"GPNetSync","./BattleLayerOrder":"BattleLayerOrder"}],LayerSevenDayChallenge:[function(t,e,r){"use strict";cc._RF.push(e,"3d16dUSBi5O/YHwo+Mmw5ya","LayerSevenDayChallenge");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerSevenDayChallengeUI=r.LayerSevenDayChallenge=void 0;var c,u,p=t("../../../../framework/FW"),f=t("../../../../framework/container/Container"),h=t("../../../../framework/layer/common/UIOrder"),y=t("../../model/vo/Goods/VOEquip"),d=t("../../model/vo/Goods/VOItem"),m=t("../../model/vo/Goods/VORune"),v=t("../../ui/GameLayer"),_=t("../alert/PanelPopInfo"),S=t("../main/Hero/Rune/LayerRuneDetails"),g=t("../main/LayerItemDetail");(function(t){t[t.Box=0]="Box",t[t.Equip=1]="Equip",t[t.Rune=2]="Rune"})(c||(c={})),function(t){t[t.ActivityTime=0]="ActivityTime",t[t.RewardTime=1]="RewardTime"}(u||(u={}));var b=["\u6309\u94ae_\u7b2c\u4e00\u5929","\u6309\u94ae_\u7b2c\u4e8c\u5929","\u6309\u94ae_\u7b2c\u4e09\u5929","\u6309\u94ae_\u7b2c\u56db\u5929","\u6309\u94ae_\u7b2c\u4e94\u5929","\u6309\u94ae_\u7b2c\u516d\u5929","\u6309\u94ae_\u7b2c\u4e03\u5929"],C=["\u8fdb\u5ea6\u6761_\u6d3b\u8dc3.reward1","\u8fdb\u5ea6\u6761_\u6d3b\u8dc3.reward2","\u8fdb\u5ea6\u6761_\u6d3b\u8dc3.reward3","\u8fdb\u5ea6\u6761_\u6d3b\u8dc3.reward4","\u8fdb\u5ea6\u6761_\u6d3b\u8dc3.reward5","\u8fdb\u5ea6\u6761_\u6d3b\u8dc3.reward6","\u8fdb\u5ea6\u6761_\u6d3b\u8dc3.reward7","\u8fdb\u5ea6\u6761_\u6d3b\u8dc3.reward8"],R=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return M},e.prototype.getUrl=function(){return"ui://\u6d3b\u52a8_\u5f00\u670d\u4e03\u65e5\u6311\u6218/\u6d3b\u52a8_\u5f00\u670d\u4e03\u65e5\u6311\u6218"},e.prototype.getSortOrder=function(){return h.LayerOrder.TowLevel},e.prototype.SetActivity=function(t){this._Obj=t},e.prototype.GetActivity=function(){return this._Obj},e.prototype.OnGetRDExpr=function(){return"[RDSevenDayChallenge]"},e.__cname="LayerSevenDayChallenge",e}(v.GameLayerProxy);r.LayerSevenDayChallenge=R;var M=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.taskVoMap=new Map,e.boxVoMap=new Map,e.days=0,e.plan=1,e.speed=0,e.nowSelectDays=1,e.dayTabStateMap=new Map,e.dayQuestMap=new Map,e}return n(e,t),e.prototype.getHasBackground=function(){return!0},e.prototype.GetHasCloseAnimation=function(){return!0},e.prototype.GetHasShowAnimation=function(){return!0},e.prototype.init=function(){var t=this;this.com.toCenterParent(this.container),this.toolSet.addListener(this.proxy.GetActivity().GetEventProxy(),"OnChanged",function(){t.UpdateData(),t.UpdateLayer()}),this.toolSet.addTimer(1e3,function(){t.UpdateTime()}),this.UpdateTime(),this.toolSet.addDefer(function(){})},e.prototype.enter=function(){var t=this,e=this,r=e.com,o=e.proxy;r.tm("panel_bg.\u6309\u94ae_\u5173\u95ed").setClick(function(){t.unload()},e),e.modelMgr.ModelSevenDayChallenge.RequestActivityUpdate(o.GetActivity().GetId()),e.InitGList(),e.UpdateData(),e.InitTab(),e.UpdateLayer()},e.prototype.UpdateTime=function(){var t=this,e=t.com;if(t.awardTime&&t.endTime){var r;if(t.timeUtil.now()<t.endTime/1e3){var o=this.timeUtil.timeSec2HMSStr14(t.endTime/1e3);r=p.FW.G_W("\u6d3b\u52a8\u5269\u4f59\u65f6\u95f4:")+o}else o=this.timeUtil.timeSec2HMSStr14(t.awardTime/1e3),r=p.FW.G_W("\u9886\u53d6\u5956\u52b1\u5269\u4f59\u65f6\u95f4:")+o;e.tm("\u6587\u672c_\u5269\u4f59\u65f6\u95f4").text=r}},e.prototype.InitGList=function(){var t=this,e=this;e.com.tm("\u5217\u8868_\u4efb\u52a1\u5185\u5bb9").asList.init(e,function(r,o,n){var i,s,c=o,f=c.tm("item"),h=n.ref.rewardList[0],y=e.modelMgr.ModelGoods.CreateGoodsByCmd({resId:h.resId,number:h.number,quality:h.quality});f.UpdateByGoods(y),f.setClick(function(){e.OnclickGood(y,f)},e);var d=(null===(i=n.vo)||void 0===i?void 0:i.count)||0,m=(null===(s=n.vo)||void 0===s?void 0:s.state)||0;c.tm("\u6587\u672c_\u4efb\u52a1\u540d\u79f0").text=n.ref.name,c.tm("\u6587\u672c_\u8d60\u9001\u6d3b\u8dc3\u503c").text=String(n.ref.liveness);var v=e.timeUtil.now()<e.endTime?u.ActivityTime:u.RewardTime;0==m&&v==u.RewardTime?c.setSelectedPage("\u5b8c\u6210\u72b6\u6001","\u7ed3\u675f"):c.setSelectedIndex("\u5b8c\u6210\u72b6\u6001",m),e.setFairyBtnEvent(c.tm("\u6309\u94ae_\u524d\u5f80"),function(){return a(t,void 0,void 0,function(){var t;return l(this,function(r){switch(r.label){case 0:return 0!=m?[3,1]:(v==u.ActivityTime?(t=n.ref.gotoKey||[])[0]?(e.ctrlMgr.JumpLayer(t[0]),e.unload()):e.unload():e.CtrlAlert.LayerMessage.addMessage(p.FW.G_W("\u6d3b\u52a8\u5df2\u7ed3\u675f~")),[3,4]);case 1:return 1!=m?[3,3]:[4,e.modelMgr.ModelSevenDayChallenge.RequestActivitySevenDaysReward({id:e.plan,day:e.nowSelectDays,resId:n.ref.resId})];case 2:return r.sent(),[3,4];case 3:2==m&&e.CtrlAlert.LayerMessage.addMessage(p.FW.G_W("\u5df2\u9886\u53d6~")),r.label=4;case 4:return[2]}})})});var _=c.tm("\u4efb\u52a1\u8fdb\u5ea6\u6761").asProgress,S=n.ref.param.count||n.ref.param.level;S||(S=n.ref.param.talent),_.max=S;var g=Math.max(0,d);g=Math.min(d,S),_.value=g,_.tm("title").text=d+"/"+S})},e.prototype.OnclickGood=function(t,e){var r=this;if(t instanceof y.VOEquip){var o=t;r.CtrlMain.LayerItemDetail.SetEquip(o),r.CtrlMain.LayerItemDetail.SetOpenPosition(g.OpenPosition.synthesis),r.CtrlMain.LayerItemDetail.SetisShow(!1),r.CtrlMain.LayerItemDetail.load()}else if(t instanceof d.VOItem){var n=r.proxy.addPanel(_.PanelPopInfo);n.SetTitle(t.GetName()),n.SetContent(t.GetDesc()),n.SetParent(e.asCom),n.SetTitleVisible(!0),n.SetShowArrow(!0)}else if(t instanceof m.VORune){var i=t;r.CtrlMain.LayerRuneDetails.SetData({rune:i}),r.CtrlMain.LayerRuneDetails.SetViewType(S.RuneDetailsViewType.noShowButon),r.CtrlMain.LayerRuneDetails.load()}},e.prototype.UpdateData=function(){var t,e,r,o,n,i,a=this,l=a.proxy;a.taskVoMap.clear(),a.boxVoMap.clear(),a.dayTabStateMap.clear(),a.dayQuestMap.clear();var c=l.GetActivity(),u=c.GetVOActivity().GetDeTail().cmdActivitySevenDaysDetail,p=u.questData||[];try{for(var f=s(p),h=f.next();!h.done;h=f.next()){var y=h.value;a.dayQuestMap.set(y.day,y.cmdActivitySevenDaysQuestOfDay);try{for(var d=(r=void 0,s(y.cmdActivitySevenDaysQuestOfDay)),m=d.next();!m.done;m=d.next()){var v=m.value;a.taskVoMap.set(v.resId,v)}}catch(C){r={error:C}}finally{try{m&&!m.done&&(o=d.return)&&o.call(d)}finally{if(r)throw r.error}}}}catch(R){t={error:R}}finally{try{h&&!h.done&&(e=f.return)&&e.call(f)}finally{if(t)throw t.error}}var _=u.boxData||[];try{for(var S=s(_),g=S.next();!g.done;g=S.next()){var b=g.value;a.boxVoMap.set(b.resId,b)}}catch(M){n={error:M}}finally{try{g&&!g.done&&(i=S.return)&&i.call(S)}finally{if(n)throw n.error}}a.days=u.days,a.speed=u.speed,a.plan=c.GetVOActivity().GetPlan(),a.startTime=c.GetStartTime(),a.endTime=c.GetEndTime(),a.awardTime=c.GetAwardTime()},e.prototype.SpeedConversion=function(){return this.proxy.GetActivity().GetVOActivity().GetDeTail().cmdActivitySevenDaysDetail.speed},e.prototype.UpdateLayer=function(){var t,e,r=this,o=r.com;o.tm("\u8fdb\u5ea6\u6761_\u6d3b\u8dc3.\u6587\u672c_\u6d3b\u8dc3\u503c").text=String(r.speed),r.modelMgr.ModelSevenDayChallenge.GetBoxMaxActiveValue(r.plan);var n=o.tm("\u8fdb\u5ea6\u6761_\u6d3b\u8dc3.\u8fdb\u5ea6\u6761").asProgress;n.max=800;var i=r.SpeedConversion();i<500||(i=i>500&&i<700?500+.5*(i-500):i<1200?600+.2*(i-700):700+.33*(i-1200)),n.value=i,r.UpdateBox(),r.UpdateTab();var a=r.modelMgr.ModelSevenDayChallenge.GetTaskData(r.plan,r.nowSelectDays),l=[];try{for(var c=s(a),u=c.next();!u.done;u=c.next()){var p=u.value,f=r.taskVoMap.get(p.resId)||{count:0,resId:p.resId,state:0},h=f.count||0,y=p.param.count||0,d={vo:f,ref:p,order:0==y?0:h/y};l.push(d)}}catch(m){t={error:m}}finally{try{u&&!u.done&&(e=c.return)&&e.call(c)}finally{if(t)throw t.error}}l.sort(function(t,e){var r=t.vo.state,o=e.vo.state;return 2==r||2==o?r-o:o!=r?o-r:(r=t.order,(o=e.order)!=r?o-r:(r=t.ref.resId,(o=e.ref.resId)!=r?r-o:-1))}),o.tm("\u5217\u8868_\u4efb\u52a1\u5185\u5bb9").asList.update(l)},e.prototype.UpdateBox=function(){for(var t=this,e=this,r=e.com,o=e.modelMgr.ModelSevenDayChallenge.GetBoxData(e.plan),n=function(n){var i=r.tm(C[n]),s=o[n].type,u=o[n].count,f=e.boxVoMap.get(o[n].count);if(i.setSelectedIndex("\u5956\u52b1\u7c7b\u578b",s==c.Box?0:1),i.tm("\u9053\u5177").asCom.setSelectedIndex("\u662f\u5426\u662f\u6700\u7ec8\u5956\u52b1",n+1==C.length?1:0),s!=c.Box){var h=o[n].reward[0],y=e.modelMgr.ModelGoods.CreateGoodsByCmd({resId:h.resId,number:String(h.number),quality:h.quality});i.tm("\u9053\u5177.item").UpdateByGoods(y),i.tm("\u9053\u5177.title").text=String(o[n].count)}else i.tm("\u6309\u94ae_\u5b9d\u7bb1.title").text=String(o[n].count);i.setSelectedIndex("\u9886\u53d6\u72b6\u6001",f.state),e.setFairyGobjEvent(i,function(){return a(t,void 0,void 0,function(){var t,r,a;return l(this,function(l){switch(l.label){case 0:return 1!=f.state?[3,2]:[4,e.modelMgr.ModelSevenDayChallenge.RequestActivitySevenDaysGiftReward({id:e.plan,resId:u})];case 1:return l.sent(),[2];case 2:return 2==f.state?(e.CtrlAlert.LayerMessage.addMessage(p.FW.G_W("\u5956\u52b1\u5df2\u9886\u53d6~")),[2]):(s==c.Equip?(r=o[n].reward[0],t=e.modelMgr.ModelGoods.CreateGoodsByCmd(r),e.ctrlMain.LayerItemDetail.load(),e.ctrlMain.LayerItemDetail.SetEquip(t),e.ctrlMain.LayerItemDetail.SetOpenPosition(g.OpenPosition.synthesis)):s==c.Rune?(r=o[n].reward[0],a=e.modelMgr.ModelGoods.CreateGoodsByCmd(r),e.ctrlMain.LayerRuneDetails.SetData({rune:a}),e.ctrlMain.LayerRuneDetails.SetViewType(S.RuneDetailsViewType.noShowButon),e.ctrlMain.LayerRuneDetails.load()):s==c.Box&&(e.CtrlAlert.LayerRewardDetail.SetGObjTarget(i),e.CtrlAlert.LayerRewardDetail.SetHostCom(this.container),e.CtrlAlert.LayerRewardDetail.SetTlCmdGoods(o[n].reward),e.CtrlAlert.LayerRewardDetail.load()),[2])}})})})},i=0;i<C.length;i++)n(i)},e.prototype.InitTab=function(){for(var t=this,e=this,r=e.com,o=function(o){var i=r.tm(b[o]),a=e.days>=o+1;n.dayTabStateMap.set(o+1,a),i.asButton.changeStateOnClick=!1,i.setSelectedIndex("\u4e0a\u9501",a?0:1),i.setClick(function(){t.dayTabStateMap.get(o+1)?(r.setSelectedIndex("\u5929\u6570",o),e.nowSelectDays=o+1,e.UpdateLayer()):e.CtrlAlert.LayerMessage.addMessage(p.FW.G_W("\u5c1a\u672a\u89e3\u9501~"))},e)},n=this,i=0;i<b.length;i++)o(i)},e.prototype.UpdateTab=function(){for(var t=this.com,e=0;e<b.length;e++){var r=t.tm(b[e]),o=this.days>=e+1;this.dayTabStateMap.set(e+1,o),r.setSelectedIndex("\u4e0a\u9501",o?0:1),r.tm("\u7ea2\u70b9").visible=o;var n=r.tm("\u7ea2\u70b9"),i=this.CheckRDByDay(e+1);n.OnRDUpdate(i)}},e.prototype.CheckRDByDay=function(t){return(this.dayQuestMap.get(t)||[]).some(function(t){return 1==t.state})},e.prototype.exit=function(){},e.prototype.update=function(){},e.__cname="LayerSevenDayChallengeUI",i([f.injectField("CtrlMain")],e.prototype,"ctrlMain",void 0),i([f.injectField("ModelMgr")],e.prototype,"modelMgr",void 0),i([f.injectField("CtrlAlert")],e.prototype,"CtrlAlert",void 0),i([f.injectField("CtrlMgr")],e.prototype,"ctrlMgr",void 0),i([f.injectField("TimeUtil")],e.prototype,"timeUtil",void 0),i([f.injectField("CtrlMain")],e.prototype,"CtrlMain",void 0),e}(v.GameLayerUI);r.LayerSevenDayChallengeUI=M,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/container/Container":void 0,"../../../../framework/layer/common/UIOrder":void 0,"../../model/vo/Goods/VOEquip":"VOEquip","../../model/vo/Goods/VOItem":"VOItem","../../model/vo/Goods/VORune":"VORune","../../ui/GameLayer":"GameLayer","../alert/PanelPopInfo":"PanelPopInfo","../main/Hero/Rune/LayerRuneDetails":"LayerRuneDetails","../main/LayerItemDetail":"LayerItemDetail"}],LayerShare:[function(t,e,r){"use strict";cc._RF.push(e,"94107F/1YVPs4W2ejvAYv3z","LayerShare");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerShareUI=r.LayerShare=void 0;var s=t("../../../../../../framework/FW"),c=t("../../../../../../framework/container/Container"),u=t("../../../../../../framework/layer/common/UIOrder"),p=t("../../../../model/System/ModelSystem"),f=t("../../../../ui/GameLayer"),h=t("../../../sdk/SDKInterface"),y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return d},e.prototype.getUrl=function(){return"ui://\u5206\u4eab\u6709\u793c/\u7ec4\u4ef6_\u5206\u4eab\u6709\u793c_\u4e3b\u754c\u9762"},e.prototype.getSortOrder=function(){return u.LayerOrder.TowLevel},e.prototype.getSystemId=function(){return p.SystemId.Share},e.__cname="LayerShare",e}(f.GameLayerProxy);r.LayerShare=y;var d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getHasBackground=function(){return!0},e.prototype.initAsync=function(){return a(this,void 0,Promise,function(){return l(this,function(t){switch(t.label){case 0:return[4,s.FW.FairyMgr.loadByPkgNameAsync("\u5206\u4eab\u6709\u793c_\u52a0\u8f7d\u56fe")];case 1:return t.sent(),[2]}})})},e.prototype.init=function(){var t=this;this.com.toFullCenterParent(this.container),this.com.tm("\u6309\u94ae_\u5173\u95ed").setClick(function(){t.unload()},this),this.InitClick(),this.toolSet.addListener(this.modelMgr.ModelVO.VORoleBag.GetEventProxy(),"OnChanged",function(){t.UpdateView()},this)},e.prototype.release=function(){},e.prototype.enter=function(){this.UpdateView()},e.prototype.InitClick=function(){var t=this.com;this.InitShareBtn(t.tm("\u6309\u94ae_QQ\u5206\u4eab"),h.ShareType.qq),this.InitShareBtn(t.tm("\u6309\u94ae_\u5fae\u4fe1\u5206\u4eab"),h.ShareType.wx),this.InitShareBtn(t.tm("\u6309\u94ae_\u5fae\u535a\u5206\u4eab"),h.ShareType.wb),this.InitShareBtn(t.tm("\u6309\u94ae_\u670b\u53cb\u5708\u5206\u4eab"),h.ShareType.moments)},e.prototype.InitShareBtn=function(t,e){var r=this;if(this.SDKMgr.getSDK().CheckCanShare(e)){t.visible=!0;var o=function(t){t?r.modelMgr.ModelRole.GetRole().GetShareState()?s.FW.showTip(s.FW.G_W("\u5206\u4eab\u6210\u529f!")):r.RequestReward():s.FW.showTip(s.FW.G_W("\u5206\u4eab\u5931\u8d25!"))};this.setFairyBtnEvent(t,function(){return a(r,void 0,void 0,function(){var t;return l(this,function(r){switch(r.label){case 0:return s.FW.Log.log("\u5206\u4eab\u7c7b\u578b:",e),[4,this.SDKMgr.getSDK().Share(e)];case 1:return t=r.sent(),s.FW.Log.log("wb\u5206\u4eab\u7ed3\u679c:",t),o(t),[2]}})})})}else t.visible=!1},e.prototype.RequestReward=function(){return a(this,void 0,void 0,function(){return l(this,function(t){switch(t.label){case 0:return[4,this.modelMgr.ModelRole.RequestShareGetReward()];case 1:return t.sent(),[2]}})})},e.prototype.UpdateView=function(){var t=this.com,e=this.modelMgr.ModelRole.GetRole(),r=e&&e.GetShareState()||!1,o=this.modelMgr.ModelGameConfig.GetGameConfigValueByKey("shareRewardId")||1,n=this.modelMgr.ModelMail.GetMailContentById(o).rewards[0],i=this.modelMgr.ModelGoods.CreateGoodsByCmd(n);t.setSelectedPage("\u5206\u4eab\u72b6\u6001",r?"\u5df2\u5206\u4eab":"\u672a\u5206\u4eab"),t.tm("\u6587\u672c_\u5956\u52b1\u6570\u91cf").text="X"+n.number;var a=t.tm("item");a.UpdateByGoods(i),a.GetBehavior().onNumberVisible(!1)},e.__cname="LayerShareUI",i([c.injectField("SDKMgr")],e.prototype,"SDKMgr",void 0),i([c.injectField("ModelMgr")],e.prototype,"modelMgr",void 0),i([c.injectField("Ref")],e.prototype,"Ref",void 0),e}(f.GameLayerUI);r.LayerShareUI=d,cc._RF.pop()},{"../../../../../../framework/FW":void 0,"../../../../../../framework/container/Container":void 0,"../../../../../../framework/layer/common/UIOrder":void 0,"../../../../model/System/ModelSystem":"ModelSystem","../../../../ui/GameLayer":"GameLayer","../../../sdk/SDKInterface":"SDKInterface"}],LayerShowRewards:[function(t,e,r){"use strict";cc._RF.push(e,"1fb3evrskRPfaVIyQqfFlXH","LayerShowRewards");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},l=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerGetGoodsUI=r.LayerShowRewards=void 0;var s=t("../../../../../framework/layer/common/UIOrder"),c=t("../../../ui/GameLayer"),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return p},e.prototype.getUrl=function(){return"ui://\u901a\u7528_\u83b7\u5f97\u7269\u54c1/\u516c\u7528_\u83b7\u53d6\u7269\u54c1"},e.prototype.getSortOrder=function(){return s.LayerOrder.TipsUI},e.prototype.SetTlGoods=function(t){var e,r;t.sort(function(t,e){var r=t.GetQuality(),o=e.GetQuality();return r==o?t.GetRefId()-e.GetRefId():o-r}),this.tlGoods=[];try{for(var o=l(t),n=o.next();!n.done;n=o.next()){var i=n.value;this.tlGoods.push(i)}}catch(a){e={error:a}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}},e.prototype.GetTlGoods=function(){return this.tlGoods},e.__cname="LayerShowRewards",e}(c.GameLayerProxy);r.LayerShowRewards=u;var p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.data=[],e}return n(e,t),e.prototype.getHasBackground=function(){return!0},e.prototype.init=function(){var t=this;this.com.toFullCenterParent(this.container),this.setFairyEvent(this.com,fgui.Event.CLICK,function(){return i(t,void 0,void 0,function(){return a(this,function(){return this.unload(),[2]})})}),this.InitList()},e.prototype.enter=function(){this.com.tm("\u7279\u6548").tmt("\u8fdb\u5165\u52a8\u753b").play(),this.UpdateList()},e.prototype.release=function(){this.proxy.GetTlGoods().length>0&&this.PlayCloseAnimation()},e.prototype.InitList=function(){this.com.tm("\u5217\u8868_\u9053\u5177\u5c55\u793a").asList.initVirtualList(this,function(t,e,r){var o=e.asCom.tm("com_goods");o.UpdateByGoods(r),o.PlayLight()})},e.prototype.UpdateList=function(){var t=this.com.tm("\u5217\u8868_\u9053\u5177\u5c55\u793a"),e=this.proxy.GetTlGoods();e.length<=0&&(this.log("\u6ca1\u6709\u5956\u52b1\u9053\u5177\u53ef\u5c55\u793a\uff0c\u5ba2\u6237\u7aef\u68c0\u67e5\u8c03\u7528\u754c\u9762\u662f\u5426\u6b63\u786e\uff0c\u6216\u670d\u52a1\u7aef\u662f\u5426\u6709\u4e0b\u53d1\u5956\u52b1"),this.unload()),t.update(e)},e.prototype.PlayCloseAnimation=function(){var t,e;try{for(var r=l(this.proxy.GetTlGoods()),o=r.next();!o.done;o=r.next()){var n=o.value;this.CtrlMgr.CtrlAnimation.OpenLayerAnimationByGoods(null,n)}}catch(i){t={error:i}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},e.__cname="LayerGetGoodsUI",e}(c.GameLayerUI);r.LayerGetGoodsUI=p,cc._RF.pop()},{"../../../../../framework/layer/common/UIOrder":void 0,"../../../ui/GameLayer":"GameLayer"}],LayerShowTip:[function(t,e,r){"use strict";cc._RF.push(e,"feec0Rv1D5Bupoq/9tq7G77","LayerShowTip");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.LayerShowTipUI=r.LayerShowTip=void 0;var i=t("../../../../framework/FW"),a=t("../../../../framework/layer/common/UIOrder"),l=t("../../ui/GameLayer"),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tipsData={},e}return n(e,t),e.prototype.getUIClass=function(){return c},e.prototype.getUrl=function(){return"ui://\u5bf9\u8bdd\u5f39\u7a97/\u7ec4\u4ef6_\u5171\u7528_\u63d0\u793a\u7a97"},e.prototype.getSortOrder=function(){return a.LayerOrder.TipsUI},e.prototype.SetData=function(t){t.title?this.tipsData.title=t.title:this.tipsData.title=i.FW.G_W("\u63d0\u793a"),t.context?this.tipsData.context="       "+t.context:this.tipsData.context="",t.sumitFuncion?this.tipsData.sumitFuncion=t.sumitFuncion:this.tipsData.sumitFuncion=function(){},t.celFunction?this.tipsData.celFunction=t.celFunction:this.tipsData.celFunction=function(){}},e.prototype.GetData=function(){return this.tipsData},e.prototype.clearData=function(){this.tipsData={}},e.__cname="LayerShowTip",e}(l.GameLayerProxy);r.LayerShowTip=s;var c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getHasBackground=function(){return!0},e.prototype.GetHasCloseAnimation=function(){return!0},e.prototype.GetHasShowAnimation=function(){return!0},e.prototype.SetOpenPivot=function(){this.com.setPivot(0,.5)},e.prototype.init=function(){this.com.toFullCenterParent(this.container),this.InitData(),this.InitLayer(),this.InitClick()},e.prototype.release=function(){this.proxy.clearData(),this.tipsData=null},e.prototype.enter=function(){},e.prototype.exit=function(){},e.prototype.update=function(){},e.prototype.InitData=function(){var t=this.proxy;this.tipsData=t.GetData()},e.prototype.InitLayer=function(){this.com.tm("content").text=i.FW.G_W(this.tipsData.context)},e.prototype.InitClick=function(){var t=this,e=t.com;e.tm("panel_bg.\u6309\u94ae_\u5173\u95ed").setClick(function(){t.tipsData.celFunction(),t.unload()},t),e.tm("\u6309\u94ae_\u786e\u5b9a").setClick(function(){t.tipsData.sumitFuncion(),t.unload()},t),e.tm("\u6309\u94ae_\u53d6\u6d88").setClick(function(){t.tipsData.celFunction(),t.unload()},t)},e.__cname="LayerShowTipUI",e}(l.GameLayerUI);r.LayerShowTipUI=c,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/layer/common/UIOrder":void 0,"../../ui/GameLayer":"GameLayer"}],LayerSkillReplaceTips:[function(t,e,r){"use strict";cc._RF.push(e,"d7ab73rMZZH7IcF+vRZaP/L","LayerSkillReplaceTips");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerSkillReplaceTipsUI=r.LayerSkillReplaceTips=void 0;var a=t("../../../../../../framework/container/Container"),l=t("../../../../../../framework/fork/Fork"),s=t("../../../../../../framework/layer/common/UIOrder"),c=t("../../../../ui/GameLayer"),u=t("./BattleLayerOrder"),p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return f},e.prototype.getUrl=function(){return"ui://\u6218\u6597/\u7ec4\u4ef6_\u6218\u6597_\u6218\u6597\u91cd\u8fde\u63d0\u793a_\u786e\u8ba4"},e.prototype.getSortOrder=function(){return s.LayerOrder.Main},e.prototype.getSortOrder2=function(){return u.BattleLayerOrder.TwoLevel},e.__cname="LayerSkillReplaceTips",e}(c.GameLayerProxy);r.LayerSkillReplaceTips=p;var f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}var r;return n(e,t),r=e,e.prototype.getHasBackground=function(){return!0},Object.defineProperty(e.prototype,"startConfig",{get:function(){return this.Battle.startConfig},enumerable:!1,configurable:!0}),e.prototype.init=function(t){var e=this,r=e.com;this.com.toFullCenterParent(this.container),r.tm("\u6309\u94ae_\u5173\u95ed").setClick(e.unload,e),r.tm("\u6309\u94ae_\u53d6\u6d88").setClick(e.unload,e),r.tm("\u6309\u94ae_\u786e\u5b9a").setClick(e.onClickConfirm,e),r.tm("\u6309\u94ae_\u8df3\u8fc7").selected=!1;var o=t.resId,n=t.lv;e._cb=t.cb,e.renderSkillItem(r,{resId:o,lv:n})},e.prototype.renderSkillItem=function(t,e){var r=this.Ref.RefMgrbattleSkillRef.getRef("resId",e.resId);t.tm("com_skill.name").text=(null==r?void 0:r.name)||"",t.tm("com_skill.icon").SetUrlByIcon(null==r?void 0:r.icon);var o=t.tm("com_skill");o.tmc("\u89c9\u9192").setSelectedIndex(e.lv>5?1:0),o.tmc("\u661f\u7ea7").setSelectedIndex(e.lv>5?4:e.lv-1);var n=this.Ref.RefMgrbattleSkillLevel.getRef(["skillId","level"],e.resId,1);t.tm("\u6587\u672c_\u6280\u80fd\u63cf\u8ff0").text=(null==n?void 0:n.desc)||""},e.prototype.onClickConfirm=function(){var t=this;t.com.tm("\u6309\u94ae_\u8df3\u8fc7").asButton.selected&&(this.CtrlMgr.CtrlBattle.skillReplaceTips=!0),t._cb&&t._cb(),t.unload()},e.prototype.release=function(){},e.prototype.enter=function(){},e.prototype.exit=function(){},e.prototype.update=function(){},e.__cname="LayerSkillReplaceTipsUI",i([a.injectField("Battle")],e.prototype,"Battle",void 0),i([a.injectField("SystemEvent")],e.prototype,"SystemEvent",void 0),i([a.injectField("GPLevelUp")],e.prototype,"GPLevelUp",void 0),i([a.injectField("GPHeroSkill")],e.prototype,"GPHeroSkill",void 0),i([a.injectField("GPHeroSupply")],e.prototype,"GPHeroSupply",void 0),i([a.injectField("ModelBattleSkill")],e.prototype,"ModelBattleSkill",void 0),i([a.injectField("GPAudio")],e.prototype,"GPAudio",void 0),i([a.injectField("Ref")],e.prototype,"Ref",void 0),i([l.forkClass(r,null)],e)}(c.GameLayerUI);r.LayerSkillReplaceTipsUI=f,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../../../../../framework/fork/Fork":void 0,"../../../../../../framework/layer/common/UIOrder":void 0,"../../../../ui/GameLayer":"GameLayer","./BattleLayerOrder":"BattleLayerOrder"}],LayerSkillReplace:[function(t,e,r){"use strict";cc._RF.push(e,"27ecaTpSvtKBrJox2M/sjnc","LayerSkillReplace");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerSkillReplaceUI=r.LayerSkillReplace=void 0;var l=t("../../../../../../framework/FW"),s=t("../../../../../../framework/container/Container"),c=t("../../../../../../framework/fork/Fork"),u=t("../../../../../../framework/layer/common/UIOrder"),p=t("../../../../ui/GameLayer"),f=t("./BattleLayerOrder"),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return y},e.prototype.getUrl=function(){return"ui://\u6218\u6597/\u7ec4\u4ef6_\u6218\u6597_\u6218\u6597\u6280\u80fd\u9009\u62e9"},e.prototype.getSortOrder=function(){return u.LayerOrder.Main},e.prototype.getSortOrder2=function(){return f.BattleLayerOrder.OneLevel},e.__cname="LayerSkillReplace",e}(p.GameLayerProxy);r.LayerSkillReplace=h;var y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}var r;return n(e,t),r=e,e.prototype.getHasBackground=function(){return!0},Object.defineProperty(e.prototype,"startConfig",{get:function(){return this.Battle.startConfig},enumerable:!1,configurable:!0}),e.prototype.init=function(){var t=this,e=t.com;this.com.toFullCenterParent(this.container),this.SystemEvent.sendPaused(this);var r=e.tm("list1").asList;r.initVirtualList(t,t.renderItemList1,t.onClickList1),t._list1=r;var o=e.tm("list2").asList;o.initVirtualList(t,t.renderItemList2,t.onClickList2),t._list2=o,e.tm("\u6309\u94ae_\u786e\u5b9a").setClick(t.onClickConfirm,t),e.tm("\u6309\u94ae_\u5f00\u59cb").setClick(t.unload,t),this.GPAudio.levelup(),this.GPAudio.adjustBGM(this),this.updateView();var n=this.startConfig.resumeData.cmdBattleBeat.args.find(function(t){return"point"==t.key}),i=Math.floor(n.value/60)+":00";e.tm("\u6587\u672c_\u590d\u6d3b\u65f6\u95f4").text=l.FW.G_W("\u590d\u6d3b\u65f6\u95f4\u70b9: ")+i},e.prototype.updateView=function(){var t=this;t.updateList1(),t.updateList2(),t.com.tmc("\u72b6\u6001").setSelectedIndex(t._selectId2?2:t._selectId1?1:0)},e.prototype.updateList1=function(){var t=this,e=t.GPHeroSkill.GetTlSkill();t._learnSkillIds=[];var r=e.filter(function(e){var r,o=null===(r=e.GetRef())||void 0===r?void 0:r.ref;if(o){var n=t.Ref.RefMgrbattleSkillRef.getRef("resId",o.skillId);return t._learnSkillIds.push(o.skillId),n&&1!=n.type}});t._list1.update(r)},e.prototype.updateList2=function(){var t=this,e=t.startConfig.skills;if(t._selectId1){var r=e.filter(function(e){var r,o,n,i=t.Ref.RefMgrbattleSkillRef.getRef("resId",e),l=!1;try{for(var s=a(t._learnSkillIds),c=s.next();!c.done;c=s.next()){var u=c.value,p=t.Ref.RefMgrbattleSkillEvolutionRef.getRef("skillId",u);if(p&&(null===(n=p.need[0])||void 0===n?void 0:n.resId)==e){l=!0;break}}}catch(f){r={error:f}}finally{try{c&&!c.done&&(o=s.return)&&o.call(s)}finally{if(r)throw r.error}}return!t._learnSkillIds.includes(e)&&1!=i.type&&!l}),o=this.GPHeroSkill.GetSkill(this._selectId1).GetLevel(),n=[];r.forEach(function(t){var e=t;o>5&&(e+=1),n.push({resId:e,lv:o})}),t._list2.update(n)}},e.prototype.renderItemList1=function(t,e,r){e.tmc("\u9009\u4e2d").setSelectedIndex(this._selectId1==r.GetResId()?1:0),e.tm("com_skill").tmc("\u9009\u4e2d").setSelectedIndex(this._selectId1==r.GetResId()?1:0);var o=r.GetRef().ref;this.renderSkillItem(e,{resId:o.skillId,lv:o.level})},e.prototype.onClickList1=function(t,e,r){var o=this,n=r.GetResId();if(this._selectId1!=n){var i=function(){o._selectId1=n,o._selectId2=0,o.updateView()};this.CtrlMgr.CtrlBattle.skillReplaceTips?i():this.LayerSkillReplaceTips.load({cb:i,lv:r.GetLevel(),resId:n})}},e.prototype.renderItemList2=function(t,e,r){e.tmc("\u9009\u4e2d").setSelectedIndex(this._selectId2==r.resId?1:0),e.tm("com_skill").tmc("\u9009\u4e2d").setSelectedIndex(this._selectId2==r.resId?1:0),this.renderSkillItem(e,r)},e.prototype.onClickList2=function(t,e,r){var o=this;if(this._selectId2!=r.resId){var n=function(){o._selectId2=r.resId,o.updateView()};this.CtrlMgr.CtrlBattle.skillReplaceTips?n():this.LayerSkillReplaceTips.load({cb:n,lv:r.lv,resId:r.resId})}},e.prototype.renderSkillItem=function(t,e){var r=this.Ref.RefMgrbattleSkillRef.getRef("resId",e.resId);t.tm("com_skill.name").text=(null==r?void 0:r.name)||"",t.tm("com_skill.icon").SetUrlByIcon(null==r?void 0:r.icon);var o=t.tm("com_skill");o.tmc("\u89c9\u9192").setSelectedIndex(e.lv>5?1:0),o.tmc("\u661f\u7ea7").setSelectedIndex(e.lv>5?4:e.lv-1)},e.prototype.onClickConfirm=function(){var t=this,e=this.GPHeroSkill.GetSkill(this._selectId1).GetLevel(),r=function(){t.GPHeroSkill.DeleteSkill(t._selectId1);var r=t._selectId2;t.GPLevelUp.activeSkill(r,e,t._selectId1),t.unload()};this.CtrlMgr.CtrlBattle.skillReplaceTips?r():this.LayerSkillReplaceTips.load({cb:r,lv:e,resId:t._selectId2})},e.prototype.release=function(){this.GPAudio.resumeBGM(this)},e.prototype.enter=function(){this.SystemEvent.sendPaused(this)},e.prototype.exit=function(){this.SystemEvent.sendResume(this)},e.prototype.update=function(){},e.__cname="LayerSkillReplaceUI",i([s.injectField("Battle")],e.prototype,"Battle",void 0),i([s.injectField("SystemEvent")],e.prototype,"SystemEvent",void 0),i([s.injectField("GPLevelUp")],e.prototype,"GPLevelUp",void 0),i([s.injectField("GPHeroSkill")],e.prototype,"GPHeroSkill",void 0),i([s.injectField("GPHeroSupply")],e.prototype,"GPHeroSupply",void 0),i([s.injectField("ModelBattleSkill")],e.prototype,"ModelBattleSkill",void 0),i([s.injectField("GPAudio")],e.prototype,"GPAudio",void 0),i([s.injectField("Ref")],e.prototype,"Ref",void 0),i([s.injectField("LayerSkillReplaceTips")],e.prototype,"LayerSkillReplaceTips",void 0),i([c.forkClass(r,null)],e)}(p.GameLayerUI);r.LayerSkillReplaceUI=y,cc._RF.pop()},{"../../../../../../framework/FW":void 0,"../../../../../../framework/container/Container":void 0,"../../../../../../framework/fork/Fork":void 0,"../../../../../../framework/layer/common/UIOrder":void 0,"../../../../ui/GameLayer":"GameLayer","./BattleLayerOrder":"BattleLayerOrder"}],LayerSpecialGift:[function(t,e,r){"use strict";cc._RF.push(e,"1e7de6gCrNL6a5IaQMqJHIy","LayerSpecialGift");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerSpecialGiftUI=r.LayerSpecialGift=void 0;var a=t("../../../../framework/FW"),l=t("../../../../framework/container/Container"),s=t("../../../../framework/layer/common/UIOrder"),c=t("../../../../framework/utils/StringUtil"),u=t("../../model/System/ModelSystem"),p=t("../../model/pay/BuyPayObj"),f=t("../../model/vo/Goods/VOEquip"),h=t("../../model/vo/Goods/VOItem"),y=t("../../model/vo/Goods/VORune"),d=t("../../ui/GameLayer"),m=t("../alert/PanelPopInfo"),v=t("../main/Hero/Rune/LayerRuneDetails"),_=t("../main/LayerItemDetail"),S=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return g},e.prototype.getUrl=function(){return"ui://\u9996\u9875_\u4fee\u70bc_\u4f60\u4e00\u5b9a\u9700\u8981\u8fd9\u4e2a/\u9996\u9875_\u4fee\u70bc_\u4f60\u4e00\u5b9a\u9700\u8981\u8fd9\u4e2a"},e.prototype.getSortOrder=function(){return s.LayerOrder.TowLevel},e.prototype.SetRefreshShowState=function(t){this._RefreshShowState=t},e.prototype.GetRefreshShowState=function(){return this._RefreshShowState},e.prototype.getSystemId=function(){return u.SystemId.SpecialGift},e.__cname="LayerSpecialGift",e}(d.GameLayerProxy);r.LayerSpecialGift=S;var g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isBusy=!1,e}return n(e,t),e.prototype.getHasBackground=function(){return!0},e.prototype.init=function(){var t=this;this.com.toFullCenterParent(this.container),this.InitClick(),this.InitGlist(),this.toolSet.addListener(this.ModelMgr.ModelVO.VOSpecialGiftBag.GetEventProxy(),"OnChanged",function(){t.UpdateView()}),this.toolSet.addTimer(1e3,function(){t.UpdateTime()})},e.prototype.enter=function(){this.UpdateView()},e.prototype.InitGlist=function(){var t=this;t.com.tm("\u5217\u8868_\u5956\u52b1").asList.init(t,function(e,r,o){var n=r.tm("item"),i=t.ModelMgr.ModelGoods.CreateGoodsByCmd(o);n.UpdateByGoods(i),n.GetBehavior().onNumberVisible(i instanceof h.VOItem)},function(e,r,o){var n=t.ModelMgr.ModelGoods.CreateGoodsByCmd(o);if(n instanceof f.VOEquip){var i=n;t.CtrlMain.LayerItemDetail.SetEquip(i),t.CtrlMain.LayerItemDetail.SetOpenPosition(_.OpenPosition.synthesis),t.CtrlMain.LayerItemDetail.SetisShow(!1),t.CtrlMain.LayerItemDetail.load()}else if(n instanceof h.VOItem){var l=t.proxy.addPanel(m.PanelPopInfo);l.SetTitle(n.GetName()),l.SetContent(n.GetDesc()),l.SetParent(r.asCom),l.SetTitleVisible(!0),l.SetShowArrow(!0)}else if(n instanceof y.VORune){var s=n;t.CtrlMain.LayerRuneDetails.SetData({rune:s}),t.CtrlMain.LayerRuneDetails.SetViewType(v.RuneDetailsViewType.noShowButon),t.CtrlMain.LayerRuneDetails.load()}else a.FW.LWX.log("\u70b9\u51fb\u672a\u77e5\u7c7b\u578b")})},e.prototype.InitClick=function(){var t=this,e=this,r=e.com;r.tm("panel_bg.\u6309\u94ae_\u5173\u95ed").setClick(function(){e.unload()},e),r.tm("\u6309\u94ae_\u8d2d\u4e70").setClick(function(){var r=e.ModelMgr.ModelVO.VOSpecialGiftBag.GetOne();if(null!=r){var o=r.GetFromId();t.BuySpecialGift(o)}},e),r.tm("\u6309\u94ae_\u5df2\u8d2d\u4e70").setClick(function(){e.CtrlAlert.LayerMessage.addMessage(a.FW.G_W("\u793c\u5305\u5df2\u8d2d\u4e70~"))},e)},e.prototype.BuySpecialGift=function(t){var e=this;if(e.isBusy)a.FW.LWX.log("\u5f53\u524d\u6309\u94ae\u6b63\u5728\u5fd9\uff0c\u8bf7\u7a0d\u540e\u70b9\u51fb");else{var r={formId:t,isBusy:e.isBusy};e.isBusy=!0;var o=new p.DirectPurchase(r);l.Container.inst().inject(o),e.ModelMgr.ModelPay.Pay(o).then(function(){e.isBusy=!1},function(t){a.FW.LWX.error("\u5f39\u51fa\u793c\u5305\u8d2d\u4e70\u5931\u8d25+",t),e.isBusy=!1})}},e.prototype.UpdateView=function(){var t=this,e=t.com,r=t.ModelMgr.ModelVO.VOSpecialGiftBag.GetOne();if(null!=r){this.voSpecialGift=r;var o=r.GetBuyState(),n=r.GetFromId(),i=t.ModelMgr.ModelPayChannel.GetPayGoodsByFormId(n);if(null!=i){var l=r.GetDesc();e.tm("\u6587\u672c_\u63cf\u8ff0").text=l;var s=i.GetRmb(),u=i.GetUnit();e.tm("\u6309\u94ae_\u8d2d\u4e70.title").text=c.StringUtil.format(a.FW.G_W("{0}{1}\n\u8d2d\u4e70"),s,u),e.setSelectedIndex("\u8d2d\u4e70\u72b6\u6001",2==o?1:0);var p=i.GetReward();e.tm("\u5217\u8868_\u5956\u52b1").asList.update(p),this.UpdateTime()}}else this.unload()},e.prototype.UpdateTime=function(){var t=this.voSpecialGift;if(null!=t){var e=t.GetEndTime();if(null!=e)if(1e3*this.TimeUtil.now()>e)this.unload();else{var r=this.TimeUtil.timeSec2HMSStr14(e/1e3);this.com.tm("\u6587\u672c_\u5269\u4f59\u65f6\u95f4").setVar("time",r).flushVars()}}},e.__cname="LayerSpecialGiftUI",i([l.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([l.injectField("TimeUtil")],e.prototype,"TimeUtil",void 0),i([l.injectField("CtrlMain")],e.prototype,"CtrlMain",void 0),i([l.injectField("CtrlAlert")],e.prototype,"CtrlAlert",void 0),e}(d.GameLayerUI);r.LayerSpecialGiftUI=g,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/container/Container":void 0,"../../../../framework/layer/common/UIOrder":void 0,"../../../../framework/utils/StringUtil":void 0,"../../model/System/ModelSystem":"ModelSystem","../../model/pay/BuyPayObj":"BuyPayObj","../../model/vo/Goods/VOEquip":"VOEquip","../../model/vo/Goods/VOItem":"VOItem","../../model/vo/Goods/VORune":"VORune","../../ui/GameLayer":"GameLayer","../alert/PanelPopInfo":"PanelPopInfo","../main/Hero/Rune/LayerRuneDetails":"LayerRuneDetails","../main/LayerItemDetail":"LayerItemDetail"}],LayerSynthesisDisplay:[function(t,e,r){"use strict";cc._RF.push(e,"117d8L586RFzqjgRwa6kYrv","LayerSynthesisDisplay");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerSynthesisDisplayUI=r.LayerSynthesisDisplay=void 0;var a=t("../../../../framework/FW"),l=t("../../../../framework/container/Container"),s=t("../../../../framework/layer/common/UIOrder"),c=t("../../model/Hero/ModelEquipSynthesis"),u=t("../../model/vo/Goods/VOEquip"),p=t("../../ui/GameLayer"),f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return h},e.prototype.getUrl=function(){return"ui://\u82f1\u96c4/\u7ec4\u4ef6_\u82f1\u96c4_\u5408\u6210\u4e2d\u52a8\u753b"},e.prototype.getSortOrder=function(){return s.LayerOrder.TipsUI},e.prototype.SetGoods=function(t){this.Goods=t},e.prototype.GetGoods=function(){return this.Goods},e.prototype.SetListData=function(t){this.ListData=t},e.prototype.GetListData=function(){return this.ListData},e.__cname="LayerSynthesisDisplay",e}(p.GameLayerProxy);r.LayerSynthesisDisplay=f;var h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.itemList=[],e}return n(e,t),e.prototype.getHasBackground=function(){return!0},e.prototype.init=function(){this.com.toFullCenterParent(this.container),this.InitList(),this.InitClick(),this.InitLayer()},e.prototype.InitClick=function(){var t=this;t.com.setClick(function(){t.unload()},this)},e.prototype.InitLayer=function(){var t=this,e=t.com;e.tm("\u7279\u6548_\u95ea\u5149").asCom.tmt("\u7279\u6548_\u95ea\u5149").play();var r=this.proxy.GetListData(),o=this.proxy.GetGoods(),n=e.tm("\u7ec4\u4ef6_\u5408\u6210\u88c5\u5907").tm("item");n.UpdateByGoods(o),n.GetBehavior().onNumberVisible(!1),n.setSelectedPage("\u5df2\u5907\u72b6\u6001","\u5426"),n.setSelectedPage("\u4e0a\u9501","\u5426"),o instanceof u.VOEquip&&n.GetBehavior().onLevelVisible(!0),e.tm("\u5217\u8868_\u63d0\u5347").update(r),t.itemList.length>=0&&t.PlayAni()},e.prototype.InitList=function(){var t=this;t.com.tm("\u5217\u8868_\u63d0\u5347").init(this,function(e,r,o){var n=r.asCom.tm("\u7ec4\u4ef6_\u63d0\u5347").asLoader.component;n.setSelectedIndex("\u52a0\u6210\u7c7b\u578b",o.type),o.type==c.SynthesisAdditionType.attribute?(n.tm("\u63cf\u8ff0").text=o.desc,n.tm("\u5f53\u524d\u5c5e\u6027").text=o.nowValue.toString(),n.tm("\u52a0\u6210").text=o.additionValue.toString()):(n.tm("\u6280\u80fd\u63cf\u8ff0").text=o.skilldesc,n.tm("\u63cf\u8ff0").text=o.desc),t.itemList.push(r)})},e.prototype.PlayAni=function(){var t=this.itemList,e=t.length;if(!(e<=0)){var r=0,o=function(){a.FW.Task.waitUntil(function(){return 0==t[r].getTransition("\u52a8\u6548_\u51fa\u73b0").playing}).then(function(){(r+=1)<e&&(t[r].getTransition("\u52a8\u6548_\u51fa\u73b0").play(),o())})};t[r].getTransition("\u52a8\u6548_\u51fa\u73b0").play(),o()}},e.__cname="LayerSynthesisDisplayUI",i([l.injectField("ModelEquip")],e.prototype,"ModelEquip",void 0),e}(p.GameLayerUI);r.LayerSynthesisDisplayUI=h,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/container/Container":void 0,"../../../../framework/layer/common/UIOrder":void 0,"../../model/Hero/ModelEquipSynthesis":"ModelEquipSynthesis","../../model/vo/Goods/VOEquip":"VOEquip","../../ui/GameLayer":"GameLayer"}],LayerSystemOpen:[function(t,e,r){"use strict";cc._RF.push(e,"18c00FzjXBBhJEl3ur9gRar","LayerSystemOpen");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerSystemOpenUI=r.LayerSystemOpen=void 0;var l=t("../../../../framework/container/Container"),s=t("../../../../framework/layer/common/UIOrder"),c=t("../../model/System/ModelSystem"),u=t("../../ui/GameLayer"),p=t("../main/Xiulian/Entrance/GObjEntrance"),f=t("../main/Xiulian/TabXiulian"),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return y},e.prototype.getUrl=function(){return"ui://\u901a\u7528_\u63d0\u793a\u5f39\u7a97/\u7ec4\u4ef6_\u5f39\u7a97_\u65b0\u529f\u80fd\u5f00\u542f"},e.prototype.getSortOrder=function(){return s.LayerOrder.Guide},e.prototype.SetSystemObj=function(t){this.systemObj=t},e.prototype.GetSystemObj=function(){return this.systemObj},e.__cname="LayerSystemOpen",e}(u.GameLayerProxy);r.LayerSystemOpen=h;var y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.showAnimation=!1,e}return n(e,t),e.prototype.getHasBackground=function(){return!0},e.prototype.init=function(){var t=this;this.com.toFullCenterParent(this.container),this.showAnimation=!1;var e=this.proxy.GetSystemObj();if(null==e)return this.log("\u7cfb\u7edf\u52a8\u753bunload1"),void this.unload();this.ModelMgr.ModelSystem.RequestRecordClientAni(e.GetRefId());var r=a(this.GetTarget(e),2),o=r[0],n=r[1];this.entrance=o,this.target=n,this.entrance&&(this.entrance.visible=!1),this.com.setClick(function(){if(null==t.target)return t.log("\u7cfb\u7edf\u52a8\u753bunload2"),void t.unload();t.timing=t.com.tmt("\u52a8\u6548_\u79fb\u52a8").getTransitionTime(),t.speedX=(t.target.x-t.com.tm("\u88c5\u8f7d\u5668_\u73a9\u6cd5").x)/t.timing,t.speesY=(t.target.y-t.com.tm("\u88c5\u8f7d\u5668_\u73a9\u6cd5").y)/t.timing,t.showAnimation=!0,t.com.tmt("\u52a8\u6548_\u79fb\u52a8").play(function(){t.entrance&&(t.entrance.visible=!0)})},this),this.NativeX=this.com.tm("\u88c5\u8f7d\u5668_\u73a9\u6cd5").x,this.NativeY=this.com.tm("\u88c5\u8f7d\u5668_\u73a9\u6cd5").y},e.prototype.enter=function(){var t=this.proxy.GetSystemObj();if(null==t)return this.log("\u7cfb\u7edf\u52a8\u753bunload3"),void this.unload();this.updateByObj(t)},e.prototype.exit=function(){this.entrance&&(this.entrance.visible=!0),this.entrance=null,this.target=null},e.prototype.update=function(t){if(this.showAnimation){var e=this.com.tm("\u88c5\u8f7d\u5668_\u73a9\u6cd5").x+this.speedX*t,r=this.com.tm("\u88c5\u8f7d\u5668_\u73a9\u6cd5").y+this.speesY*t;this.com.tm("\u88c5\u8f7d\u5668_\u73a9\u6cd5").setPosition(e,r),this.timing-=t,this.timing<0&&(this.showAnimation=!1,this.com.tm("\u88c5\u8f7d\u5668_\u73a9\u6cd5").setPosition(this.NativeX,this.NativeY),this.unload())}},e.prototype.updateByObj=function(t){this.log("\u7cfb\u7edf\u52a8\u753b,\u64ad\u653e\u7cfb\u7edfid ",t.GetRefId());var e=this.com;e.tm("\u88c5\u8f7d\u5668_\u73a9\u6cd5").SetUrlByIcon(t.GetIcon()),e.tm("\u6587\u672c_\u73a9\u6cd5").text=t.GetName(),e.tmt("\u52a8\u6548_\u95ea\u5149").play()},e.prototype.GetTarget=function(t){switch(t.GetBelond()){case p.BelondType.left:case p.BelondType.right:return this.GetListTarget(t);case p.BelondType.pop:return[null,null];case p.BelondType.SingleButton:return this.GetSingleTarget(t);case p.BelondType.other:if(null==t.GetPreSystemId())return[null,null];var e=this.ModelMgr.ModelSystem.GetSystem(t.GetPreSystemId());if(null==e)return[null,null];var r=a(this.GetTarget(e),2);return r[0],[null,r[1]];case p.BelondType.bottomButton:return this.GetBottomTarget(t);default:return[null,null]}},e.prototype.GetXiuLianListName=function(t){switch(t){case p.BelondType.left:return"\u7ec4\u4ef6_\u6309\u94ae\u7ec4\u5de6";case p.BelondType.right:return"\u7ec4\u4ef6_\u6309\u94ae\u7ec4\u53f3";default:return null}},e.prototype.GetSingleName=function(t){switch(t){case c.SystemId.ActivityCenter:return"\u6309\u94ae_\u6d3b\u52a8\u4e2d\u5fc3";case c.SystemId.ChapterReward:return"\u7ec4\u4ef6_\u5173\u5361\u5956\u52b1\u5b9d\u7bb1";case c.SystemId.Breach:return"\u6309\u94ae_\u7a81\u7834";case c.SystemId.XiuLianOnHook:return"\u6309\u94ae_\u5b9d\u7bb1";default:return this.log("GetTargetName \u6ca1\u627e\u5230\u5bf9\u5e94\u7684\u6309\u94ae,systemId:",t),null}},e.prototype.GetBottomTargetName=function(t){switch(t){case c.SystemId.Hero:return"\u7ec4\u4ef6_\u9996\u9875_\u5e95\u83dc\u5355.\u6309\u94ae_\u82f1\u96c4";case c.SystemId.Adventure:return"\u7ec4\u4ef6_\u9996\u9875_\u5e95\u83dc\u5355.\u6309\u94ae_\u6d88\u707e";case c.SystemId.Mall:return"\u7ec4\u4ef6_\u9996\u9875_\u5e95\u83dc\u5355.\u6309\u94ae_\u5546\u5e97";default:return this.log("GetBottomTargetName \u6ca1\u627e\u5230\u5bf9\u5e94\u7684\u6309\u94ae,systemId:",t),null}},e.prototype.GetSingleTarget=function(t){var e=this.CtrlMgr.CtrlMain.LayerMain,r=e&&e.getRunningTab();if(null==r||r.className!=f.TabXiulian.__cname)return[null,null];var o=this.GetSingleName(t.GetRefId());if(null==o)return[null,null];var n=r.getGuideCom(),i=n.tm(o);if(null==i)return[null,null];var a=n.localToGlobal(i.x,i.y);return[i,this.com.globalToLocal(a.x,a.y)]},e.prototype.GetListTarget=function(t){var e=this.CtrlMgr.CtrlMain.LayerMain,r=e&&e.getRunningTab();if(null==r||r.className!=f.TabXiulian.__cname)return[null,null];var o=this.GetXiuLianListName(t.GetBelond());if(null==o)return[null,null];var n=r.getGuideCom().tm(o);if(null==n)return[null,null];var i=n.GetchildByResId(t.GetRefId());if(null==i)return[null,null];var a=n.localToGlobal(i.x,i.y);return[i,this.com.globalToLocal(a.x,a.y)]},e.prototype.GetBottomTarget=function(t){var e=this.CtrlMgr.CtrlMain.LayerMainMenu,r=this.GetBottomTargetName(t.GetRefId());if(null==r)return[null,null];var o=e.getGuideCom(),n=o.tm(r);if(null==n)return[null,null];var i=o.localToGlobal(n.x,n.y);return[n,this.com.globalToLocal(i.x,i.y)]},e.__cname="LayerSystemOpenUI",i([l.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(u.GameLayerUI);r.LayerSystemOpenUI=y,cc._RF.pop()},{"../../../../framework/container/Container":void 0,"../../../../framework/layer/common/UIOrder":void 0,"../../model/System/ModelSystem":"ModelSystem","../../ui/GameLayer":"GameLayer","../main/Xiulian/Entrance/GObjEntrance":"GObjEntrance","../main/Xiulian/TabXiulian":"TabXiulian"}],LayerTipBuy:[function(t,e,r){"use strict";cc._RF.push(e,"38202AlWJVNsITa4msFKAmG","LayerTipBuy");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerTipBuyUI=r.LayerTipBuy=void 0;var a=t("../../../../framework/container/Container"),l=t("../../../../framework/layer/common/UIOrder"),s=t("../../ui/GameLayer"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return u},e.prototype.getUrl=function(){return"ui://\u5171\u7528\u7ec4\u4ef6/\u7ec4\u4ef6_\u5171\u7528_\u8d2d\u4e70\u63d0\u793a\u7a97"},e.prototype.getSortOrder=function(){return l.LayerOrder.TipsUI},e.prototype.SetData=function(t){this.Data=t},e.prototype.GetData=function(){return this.Data},e.prototype.clearData=function(){this.Data=null},e.__cname="LayerTipBuy",e}(s.GameLayerProxy);r.LayerTipBuy=c;var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getHasBackground=function(){return!0},e.prototype.GetHasCloseAnimation=function(){return!0},e.prototype.GetHasShowAnimation=function(){return!0},e.prototype.init=function(){this.com.toFullCenterParent(this.container),this.InitList(),this.InitLayer()},e.prototype.release=function(){this.proxy.clearData()},e.prototype.enter=function(){},e.prototype.exit=function(){},e.prototype.update=function(){},e.prototype.InitLayer=function(){var t=this,e=t.com,r=t.proxy.GetData(),o=t.ModelGoods.CreateGoodsByCmd({resId:r.resId,number:"0"});e.tm("panel_bg.\u6309\u94ae_\u5173\u95ed").setClick(function(){t.unload()},t),e.tm("panel_bg.title").text=o.GetName(),e.tm("\u6587\u672c_\u63d0\u793a").asTextField.setVar("name",o.GetName()).setVar("number",r.currency.toString()).flushVars();var n=e.tm("com_goods");n.UpdateByGoods(o),n.GetBehavior().onNumberVisible(!1);var i=o.GetRef().gotokey;t.updateList(i)},e.prototype.InitList=function(){var t=this,e=this;e.com.tm("\u5217\u8868_\u8df3\u8f6c").asList.init(e,function(e,r,o){var n=r.asCom,i=t.ModelJump.GetJump(o);n.tm("\u6587\u672c_\u540d\u79f0").text=i.jumpDesc},function(r,o,n){t.CtrlMgr.JumpLayer(n),e.unload()})},e.prototype.updateList=function(t){this.com.tm("\u5217\u8868_\u8df3\u8f6c").asList.update(t)},e.__cname="LayerTipBuyUI",i([a.injectField("ModelGoods")],e.prototype,"ModelGoods",void 0),i([a.injectField("ModelJump")],e.prototype,"ModelJump",void 0),i([a.injectField("CtrlMgr")],e.prototype,"CtrlMgr",void 0),e}(s.GameLayerUI);r.LayerTipBuyUI=u,cc._RF.pop()},{"../../../../framework/container/Container":void 0,"../../../../framework/layer/common/UIOrder":void 0,"../../ui/GameLayer":"GameLayer"}],LayerTopMenu:[function(t,e,r){"use strict";cc._RF.push(e,"00f25eanV9ARryWNTm0IfYg","LayerTopMenu");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerTopMenuUI=r.LayerTopMenu=void 0;var a,l=t("../../../../../../framework/container/Container"),s=t("../../../../../../framework/FW"),c=t("../../../../../../framework/layer/common/UIOrder"),u=t("../../../../model/goods/ModelGoods"),p=t("../../../../ui/GameLayer"),f=t("../../logic/event/SystemEvent"),h=t("./BattleLayerOrder");(function(t){t[t.None=0]="None",t[t.Pass=1]="Pass",t[t.Next=2]="Next"})(a||(a={}));var y=new Map;y.set(a.None,"\u672a\u6311\u6218"),y.set(a.Pass,"\u5df2\u6311\u6218"),y.set(a.Next,"\u5373\u5c06\u6311\u6218");var d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._showboss=!1,e._bossdirty=!1,e}return n(e,t),e.prototype.getUIClass=function(){return m},e.prototype.getUrl=function(){return"ui://\u6218\u6597/\u7ec4\u4ef6_\u6218\u6597\u5c42_\u4fe1\u606f\u9762\u677f"},e.prototype.getSortOrder=function(){return c.LayerOrder.Main},e.prototype.getSortOrder2=function(){return h.BattleLayerOrder.TwoLevel},e.prototype.SetBossModel=function(t){this._showboss=t,this._bossdirty=!0,0==t&&(this._bossName=null,this._bosshp=null,this._bosshpMax=null)},e.prototype.GetBossModel=function(){return this._showboss},e.prototype.GetBossDirty=function(){return this._bossdirty},e.prototype.CleanBossDirty=function(){this._bossdirty=!1},e.prototype.SetBossName=function(t){this._bossName=t},e.prototype.GetBossName=function(){return this._bossName},e.prototype.SetBossHp=function(t,e){this._bosshp=t,this._bosshpMax=e,this._bossdirty=!0},e.prototype.GetBossHp=function(){return this._bosshp},e.prototype.GetBossHpMax=function(){return this._bosshpMax},e.__cname="LayerTopMenu",e}(p.GameLayerProxy);r.LayerTopMenu=d;var m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dirty=!1,e._lastBossPoint=null,e._tlChapterProcess=[],e}return n(e,t),e.prototype.getHasBackground=function(){return!1},e.prototype.init=function(){var t=this;this.com.toFullCenterParent(this.container),this.com.tm("\u7ec4\u4ef6_\u6218\u6597_\u4fe1\u606f\u9762\u677f\u9876\u90e8.\u6309\u94ae_\u8bbe\u7f6e").setClick(function(){t.LayerBattlePause.load()},this),this.initChapterPorcess(),this.updateView()},e.prototype.enter=function(){var t=this;this.toolSet.addListener(this.SystemRole.GetEventProxy(),"CreateHero",function(){t.dirty=!0},this),this.toolSet.addCallback(this.ComVar.GetHeroChangeCallback(),function(){t.dirty=!0}),this.toolSet.addListener(this.SystemEvent.GetEventPorxy(),f.EBattleEvent.LevelUp,function(){t.startProgress()},this),this.toolSet.addListener(this.SystemEvent.GetEventPorxy(),f.EBattleEvent.LevelUpEnd,function(){t.stopProgress()},this),this.dirty=!0},e.prototype.update=function(){this.dirty&&(this.dirty=!1,this.updateView()),this.proxy.GetBossDirty()&&(this.proxy.CleanBossDirty(),this.updateBoss())},e.prototype.getComPanel=function(){return this.com.tm("\u7ec4\u4ef6_\u6218\u6597_\u4fe1\u606f\u9762\u677f\u9876\u90e8")},e.prototype.stopProgress=function(){this.getComPanel().tm("\u8fdb\u5ea6\u6761_\u7ecf\u9a8c").asCom.tmt("\u52a8\u6548_\u95ea\u70c1").stop()},e.prototype.startProgress=function(){var t=this.getComPanel().tm("\u8fdb\u5ea6\u6761_\u7ecf\u9a8c"),e=function(){t.tmt("\u52a8\u6548_\u95ea\u70c1").play(function(){e()})};t.tmt("\u52a8\u6548_\u95ea\u70c1").play(function(){e()})},e.prototype.updateView=function(){this.updateTimer(),this.updateChapterProcess();var t=this.ComVar,e=this.getComPanel();t.IS_MAX_LEVEL?(e.tm("\u8fdb\u5ea6\u6761_\u7ecf\u9a8c").asProgress.max=1,e.tm("\u8fdb\u5ea6\u6761_\u7ecf\u9a8c").asProgress.value=1):(e.tm("\u8fdb\u5ea6\u6761_\u7ecf\u9a8c").asProgress.max=t.EXP_MAX,e.tm("\u8fdb\u5ea6\u6761_\u7ecf\u9a8c").asProgress.value=t.EXP),e.tm("\u6587\u672c_\u73a9\u5bb6\u7b49\u7ea7").asTextField.text=""+t.LEVEL,e.tm("\u6587\u672c_\u51fb\u6740\u6570").asLabel.title=""+Math.floor(t.KILL),e.tm("\u6587\u672c_\u91d1\u5e01").asLabel.title=""+Math.floor(t.GOLD);var r=this.ModelMgr.ModelGoods.GetRefByCurrency(u.ECurrencyType.coin);e.tm("\u6587\u672c_\u91d1\u5e01.icon").SetUrlByIcon(r.icon)},e.prototype.updateTimer=function(){var t=this.ComVar.STARTTIME,e=this.ComVar.GAMETIME,r=(this.ComVar.GAME_PROCESS,e-t);this.getComPanel().tm("\u6587\u672c_\u751f\u5b58\u65f6\u95f4").asTextField.setVar("var",this.formatTime(r)).flushVars()},e.prototype.formatTime=function(t){var e=(t%60).toString().padStart(2,"0");return Math.floor(t/60).toString().padStart(2,"0")+":"+e},e.prototype.updateBoss=function(){0!=this.proxy.GetBossModel()?(this.handlerBossName(),this.handlerUpdateBoss(),this.updateTimer()):this.handlerClearBoss()},e.prototype.handlerClearBoss=function(){this.getComPanel().setSelectedPage("Boss","\u5426"),this._bossname=null},e.prototype.handlerBossName=function(){var t=this.getComPanel(),e=this.proxy.GetBossName();this._bossname!=e&&(this._bossname=e,t.tm("\u6587\u672c_Boss\u540d\u5b57").asTextField.text=s.FW.G_W(e))},e.prototype.handlerUpdateBoss=function(){var t=this.getComPanel();t.setSelectedPage("Boss","\u662f");var e=this.proxy.GetBossHp(),r=this.proxy.GetBossHpMax();if(null!=e&&null!=r){var o=t.tm("\u8fdb\u5ea6\u6761_Boss\u8840\u91cf").asProgress;o.value=e,o.max=r}},e.prototype.initChapterPorcess=function(){var t=this.com.tm("\u7ec4\u4ef6_\u6218\u6597_\u4fe1\u606f\u9762\u677f\u9876\u90e8.\u7ec4\u4ef6_\u6218\u6597_\u5173\u5361\u8fdb\u5ea6.list").asList,e=this._tlChapterProcess;t.init(this,function(t,r,o){var n=y.get(o),i=t>=e.length-1;r.setSelectedPage("\u72b6\u6001",n),r.setSelectedPage("\u663e\u793a\u5206\u9694\u7b26",i?"\u5426":"\u662f")})},e.prototype.updateChapterProcess=function(){var t=this.SystemSpawn.SubMonster,e=(this._lastBossPoint,t.GetLastBossPoint(),this._tlChapterProcess);e.length=0;for(var r=t.GetTmBossPoint(),o=this.ComVar.KILL_BOSS,n=1;n<=r.size;n++)n<=o?e.push(1):n==o+1?e.push(2):e.push(0);this.UpdateChapterPorcessView()},e.prototype.UpdateChapterPorcessView=function(){var t=this._tlChapterProcess,e=this.com.tm("\u7ec4\u4ef6_\u6218\u6597_\u4fe1\u606f\u9762\u677f\u9876\u90e8.\u7ec4\u4ef6_\u6218\u6597_\u5173\u5361\u8fdb\u5ea6.list").asList;e.update(t),e.resizeToFit()},e.__cname="LayerTopMenuUI",i([l.injectField("SystemEvent")],e.prototype,"SystemEvent",void 0),i([l.injectField("SystemRole")],e.prototype,"SystemRole",void 0),i([l.injectField("SystemSpawn")],e.prototype,"SystemSpawn",void 0),i([l.injectField("ComVar")],e.prototype,"ComVar",void 0),i([l.injectField("LayerBattlePause")],e.prototype,"LayerBattlePause",void 0),i([l.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(p.GameLayerUI);r.LayerTopMenuUI=m,cc._RF.pop()},{"../../../../../../framework/FW":void 0,"../../../../../../framework/container/Container":void 0,"../../../../../../framework/layer/common/UIOrder":void 0,"../../../../model/goods/ModelGoods":"ModelGoods","../../../../ui/GameLayer":"GameLayer","../../logic/event/SystemEvent":"SystemEvent","./BattleLayerOrder":"BattleLayerOrder"}],LayerUnlockSkill:[function(t,e,r){"use strict";cc._RF.push(e,"8fd56G2xL1KlIEFTncueSo2","LayerUnlockSkill");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerUnlockSkillUI=r.LayerUnlockSkill=void 0;var s=t("../../../../../../framework/container/Container"),c=t("../../../../../../framework/FW"),u=t("../../../../../../framework/layer/common/UIOrder"),p=t("../../../../ui/GameLayer"),f=t("./BattleLayerOrder"),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return y},e.prototype.getUrl=function(){return"ui://\u6218\u6597\u89e3\u9501/\u6218\u6597_\u6218\u6597\u6280\u80fd\u89e3\u9501"},e.prototype.getSortOrder=function(){return u.LayerOrder.ThreeLevel},e.prototype.getSortOrder2=function(){return f.BattleLayerOrder.ThreeLevel},e.prototype.SetUnlockSkillId=function(t){this.unlockSkillId=t},e.prototype.GetUnlockSkillId=function(){return this.unlockSkillId},e.prototype.exit=function(){this.unlockSkillId=null},e.__cname="LayerUnlockSkill",e}(p.GameLayerProxy);r.LayerUnlockSkill=h;var y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getHasBackground=function(){return!0},e.prototype.initAsync=function(){return a(this,void 0,void 0,function(){return l(this,function(t){switch(t.label){case 0:return[4,c.FW.FairyMgr.loadByPkgNameAsyncRef("\u6218\u6597\u89e3\u9501",this)];case 1:return t.sent(),[4,c.FW.FairyMgr.loadByPkgNameAsyncRef("\u56fe\u6807_\u6218\u6597\u89e3\u9501\u6280\u80fd",this)];case 2:return t.sent(),[2]}})})},e.prototype.init=function(){this.com.toFullCenterParent(this.container),this.skillId=this.proxy.GetUnlockSkillId(),null!=this.skillId?(this.InitClick(),this.updateLayer()):this.unload()},e.prototype.release=function(){},e.prototype.enter=function(){},e.prototype.exit=function(){},e.prototype.update=function(){},e.prototype.InitClick=function(){var t=this;t.com.setClick(function(){t.unload()},t)},e.prototype.updateLayer=function(){var t=this,e=t.com,r=t.ModelMgr.ModelChapter.GetShowSkillRef(t.skillId);e.tm("\u6587\u672c_\u6280\u80fd\u540d\u79f0").text=r.skillName,e.tm("\u6587\u672c_\u5149\u5708_\u6280\u80fd\u540d\u79f0").text=r.skillName,e.tm("\u88c5\u8f7d\u5668_\u6280\u80fd\u56fe\u6807").SetUrlByIcon(r.skillIcon),e.tm("\u88c5\u8f7d\u5668_\u516c\u5f0f_\u6280\u80fd\u540d\u79f0").SetUrlByIcon(r.skillIcon),e.tm("\u6587\u672c_\u5c5e\u6027\u540d\u79f0").text=r.supplyName,e.tm("\u6587\u672c_\u5149\u5708_\u5c5e\u6027\u540d\u79f0").text=r.supplyName,e.tm("\u88c5\u8f7d\u5668_\u5c5e\u6027\u56fe\u6807").SetUrlByIcon(r.supplyIcon),e.tm("\u88c5\u8f7d\u5668_\u516c\u5f0f_\u5c5e\u6027\u56fe\u6807").SetUrlByIcon(r.supplyIcon),e.tm("\u6587\u672c_\u8d85\u6b66\u540d\u79f0").text=r.evolutionName,e.tm("\u6587\u672c_\u5149\u5708_\u8d85\u6b66\u540d\u79f0").text=r.evolutionName,e.tm("\u88c5\u8f7d\u5668_\u8d85\u6b66\u56fe\u6807").SetUrlByIcon(r.evolutionIcon),e.tm("\u88c5\u8f7d\u5668_\u516c\u5f0f_\u8d85\u6b66\u56fe\u6807").SetUrlByIcon(r.evolutionIcon),e.tm("\u6587\u672c_\u5377\u8f74\u5b57").text=r.reelName},e.__cname="LayerUnlockSkillUI",i([s.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(p.GameLayerUI);r.LayerUnlockSkillUI=y,cc._RF.pop()},{"../../../../../../framework/FW":void 0,"../../../../../../framework/container/Container":void 0,"../../../../../../framework/layer/common/UIOrder":void 0,"../../../../ui/GameLayer":"GameLayer","./BattleLayerOrder":"BattleLayerOrder"}],LayerWaiting:[function(t,e,r){"use strict";cc._RF.push(e,"d7b84ALKuNMnaq9aytLpkJz","LayerWaiting");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.LayerWaitingUI=r.LayerWaiting=void 0;var i=t("../../../../framework/layer/common/UIOrder"),a=t("../../ui/GameLayer"),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return s},e.prototype.getUrl=function(){return"ui://\u5171\u7528\u52a0\u8f7d\u4e2d/\u7ec4\u4ef6_\u52a0\u8f7d\u4e2d"},e.prototype.getSortOrder=function(){return i.LayerOrder.TipsUI},e.prototype.getIsRedsident=function(){return!0},e.__cname="LayerWaiting",e}(a.GameLayerProxy);r.LayerWaiting=l;var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getHasBackground=function(){return!0},e.prototype.init=function(){this.com.toFullCenterParent(this.container)},e.prototype.release=function(){},e.prototype.enter=function(){},e.prototype.exit=function(){},e.prototype.update=function(){},e.__cname="LayerWaitingUI",e}(a.GameLayerUI);r.LayerWaitingUI=s,cc._RF.pop()},{"../../../../framework/layer/common/UIOrder":void 0,"../../ui/GameLayer":"GameLayer"}],LayerXiulianBag:[function(t,e,r){"use strict";cc._RF.push(e,"8ffc1UMCvdI76VTx7sJ2g94","LayerXiulianBag");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerXiulianBagUI=r.LayerXiulianBag=r.ShowType=void 0;var c,u=t("../../../../../framework/container/Container"),p=t("../../../../../framework/layer/common/UIOrder"),f=t("../../../model/System/ModelSystem"),h=t("../../../model/vo/Goods/Goods"),y=t("../../../ui/GameLayer"),d=t("../../alert/PanelPopInfo");(function(t){t[t.all=0]="all",t[t.prop=1]="prop",t[t.consum=2]="consum"})(c=r.ShowType||(r.ShowType={}));var m=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return v},e.prototype.getUrl=function(){return"ui://\u9996\u9875\u4fee\u70bc_\u80cc\u5305\u7cfb\u7edf/\u7ec4\u4ef6_\u80cc\u5305\u7cfb\u7edf"},e.prototype.getSortOrder=function(){return p.LayerOrder.OneLevel},e.prototype.getSystemId=function(){return f.SystemId.XiulianBag},e.__cname="LayerXiulianBag",e}(y.GameLayerProxy);r.LayerXiulianBag=m;var v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.nowType=c.all,e.maxBag=100,e}return n(e,t),e.prototype.getHasBackground=function(){return!0},e.prototype.GetHasCloseAnimation=function(){return!0},e.prototype.GetHasShowAnimation=function(){return!0},e.prototype.init=function(){this.com.toFullCenterParent(this.container),this.InitBtn(),this.InitList(),this.InitListener()},e.prototype.InitBtn=function(){var t=this,e=this,r=e.com;r.tm("panel_bg.\u6309\u94ae_\u5173\u95ed").setClick(function(){e.unload()},e),this.setFairyBtnEvent(r.tm("\u6309\u94ae_\u5168\u90e8"),function(){return a(t,void 0,void 0,function(){return l(this,function(){return this.nowType=c.all,this.updateView(),[2]})})}),this.setFairyBtnEvent(r.tm("\u6309\u94ae_\u9053\u5177"),function(){return a(t,void 0,void 0,function(){return l(this,function(){return this.nowType=c.prop,this.updateView(),[2]})})}),this.setFairyBtnEvent(r.tm("\u6309\u94ae_\u6d88\u8017\u54c1"),function(){return a(t,void 0,void 0,function(){return l(this,function(){return this.nowType=c.consum,this.updateView(),[2]})})})},e.prototype.InitList=function(){var t=this,e=this,r=e.com.tm("\u5217\u8868_\u80cc\u5305").asList;r.initVirtualList(e,function(t,r,o){var n=r.asCom.tm("com_goods"),i=o&&o.vo;if(null!=i){n.UpdateByGoods(o.vo),n.visible=!0;var a=n.GetBehavior().OnGetRDComponent(),l=e.ModelMgr.ModelGoodsBag.CheckIsNew(i);a.OnRDUpdate(l)}else n.UpdateByGoods(null),n.visible=!1},function(t,n,i){if(i){var a=i.vo;if(null!=a){var l=n.asCom.tm("com_goods");o(i.vo,l),e.ModelMgr.ModelGoodsBag.CheckIsNew(a)&&(e.ModelMgr.ModelGoodsBag.ClickNew(a),r.refreshVirtualList())}}});var o=function(e,r){var o=t.proxy.addPanel(d.PanelPopInfo);o.SetParent(r),o.SetTitle(e.GetName()),o.SetContent(e.GetDesc()),o.SetTitleVisible(!0)}},e.prototype.InitListener=function(){var t=this,e=this.ModelMgr.ModelGoodsBag.GetTlGoodsTypeByTlShowBag([h.ShowBagType.itemBag_prop]);this.propSubSet=this.ModelMgr.ModelVO.VOItemBag.CreateSubset(),this.propSubSet.SetFilter(function(t){return!!e.has(t.GetGoodsType())});var r=this.ModelMgr.ModelGoodsBag.GetTlGoodsTypeByTlShowBag([h.ShowBagType.itemBag_consumables]);this.consumablesSubSet=this.ModelMgr.ModelVO.VOItemBag.CreateSubset(),this.consumablesSubSet.SetFilter(function(t){return!!r.has(t.GetGoodsType())}),this.toolSet.addDefer(function(){t.ModelMgr.ModelVO.VOItemBag.DestroySubset(t.propSubSet),t.propSubSet=null,t.ModelMgr.ModelVO.VOItemBag.DestroySubset(t.consumablesSubSet),t.consumablesSubSet=null}),this.toolSet.addListener(this.propSubSet.GetEventProxy(),"OnChanged",function(){t.markDirty()}),this.toolSet.addListener(this.consumablesSubSet.GetEventProxy(),"OnChanged",function(){t.markDirty()})},e.prototype.enter=function(){this.updateView()},e.prototype.update=function(){this.dirty&&(this.dirty=!1,this.updateView())},e.prototype.markDirty=function(){this.dirty=!0},e.prototype.updateView=function(){var t,e,r,o,n,i,a,l;if(this.isEnter){var u=this,p=u.com.tm("\u5217\u8868_\u80cc\u5305").asList,f=u.nowType,h=[],y=this.propSubSet.GetTlVO(),d=this.consumablesSubSet.GetTlVO();switch(f){case c.all:try{for(var m=s(y),v=m.next();!v.done;v=m.next()){var _=v.value;h.push({vo:_})}}catch(B){t={error:B}}finally{try{v&&!v.done&&(e=m.return)&&e.call(m)}finally{if(t)throw t.error}}try{for(var S=s(d),g=S.next();!g.done;g=S.next()){var b=g.value;h.push({vo:b})}}catch(P){r={error:P}}finally{try{g&&!g.done&&(o=S.return)&&o.call(S)}finally{if(r)throw r.error}}break;case c.prop:try{for(var C=s(y),R=C.next();!R.done;R=C.next())_=R.value,h.push({vo:_})}catch(G){n={error:G}}finally{try{R&&!R.done&&(i=C.return)&&i.call(C)}finally{if(n)throw n.error}}break;case c.consum:try{for(var M=s(d),w=M.next();!w.done;w=M.next())b=w.value,h.push({vo:b})}catch(k){a={error:k}}finally{try{w&&!w.done&&(l=M.return)&&l.call(M)}finally{if(a)throw a.error}}}for(;h.length>u.maxBag;)u.maxBag+=10;var O=h.concat(new Array(u.maxBag-h.length));p.update(O)}},e.__cname="LayerXiulianBagUI",i([u.injectField("ModelVO")],e.prototype,"ModelVO",void 0),i([u.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(y.GameLayerUI);r.LayerXiulianBagUI=v,cc._RF.pop()},{"../../../../../framework/container/Container":void 0,"../../../../../framework/layer/common/UIOrder":void 0,"../../../model/System/ModelSystem":"ModelSystem","../../../model/vo/Goods/Goods":"Goods","../../../ui/GameLayer":"GameLayer","../../alert/PanelPopInfo":"PanelPopInfo"}],LayerXiulianOnHook:[function(t,e,r){"use strict";cc._RF.push(e,"aa19dZ4Hc1Ho7LZOu64Jahl","LayerXiulianOnHook");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerXiulianOnHookUI=r.LayerXiulianOnHook=void 0;var s=t("../../../../../framework/FW"),c=t("../../../../../framework/container/Container"),u=t("../../../../../framework/layer/common/UIOrder"),p=t("../../../../../libutil/BigNum"),f=t("../../../model/System/ModelSystem"),h=t("../../../model/goods/ModelGoods"),y=t("../../../ui/GameLayer"),d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return m},e.prototype.getUrl=function(){return"ui://\u9996\u9875\u4fee\u70bc_\u6302\u673a\u5b9d\u7bb1/\u7ec4\u4ef6_\u4fee\u70bc\u5b9d\u7bb1"},e.prototype.getSortOrder=function(){return u.LayerOrder.TowLevel},e.prototype.getSystemId=function(){return f.SystemId.XiuLianOnHook},e.__cname="LayerXiulianOnHook",e}(y.GameLayerProxy);r.LayerXiulianOnHook=d;var m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.needUpdate=!0,e.updateTime=0,e.maxTime=86400,e.checkTime=600,e.showTime=60,e}return n(e,t),e.prototype.getHasBackground=function(){return!0},e.prototype.GetHasCloseAnimation=function(){return!0},e.prototype.GetHasShowAnimation=function(){return!0},e.prototype.init=function(){var t=this;t.com.toFullCenterParent(t.container),t.InitBtn(),t.InitList(),t.toolSet.addTimer(1e3,function(){t.cacheTime>=t.maxTime||(t.cacheTime+=1,t.updateTime+=1,t.updateTime>=t.checkTime&&(t.updateTime-=t.checkTime,t.updateList()),t.checkBtnTime())},t),t.toolSet.addListener(t.ModelMgr.ModelHangling.GetEventProxy(),"updateReward",t.OnChange,t)},e.prototype.enterAsync=function(){return a(this,void 0,Promise,function(){var t,e;return l(this,function(r){switch(r.label){case 0:return t=this,[4,this.ModelMgr.ModelHangling.RequestHanglingTime()];case 1:return t.cacheTime=r.sent(),[4,this.ModelMgr.ModelMonthCard.GetMonthState()];case 2:return e=r.sent(),this.normal=e.normal,this.premium=e.premium,this.updateTime=this.cacheTime,[2]}})})},e.prototype.enter=function(){this.checkBtnTime(),this.UpdateView()},e.prototype.UpdateView=function(){var t=this,e=t.com,r=this.ModelMgr.ModelGoods.GetRefByCurrency(h.ECurrencyType.coin).icon,o=this.ModelMgr.ModelGoods.GetRefByCurrency(h.ECurrencyType.xp).icon;e.tm("\u88c5\u8f7d\u5668_\u91d1\u5e01\u5956\u52b1").SetUrlByIcon(r),e.tm("\u88c5\u8f7d\u5668_\u7ecf\u9a8c\u5956\u52b1").SetUrlByIcon(o);var n=t.ModelMgr.ModelChapter.GetClearanceChapter(),i=t.ModelMgr.ModelChapter.GetRefChapter(n),a=i.coinPatrol||0,l=i.expPatrol||0,s=a*t.showTime,c=l*t.showTime;e.tm("\u6587\u672c_\u91d1\u5e01\u57fa\u7840\u6570\u91cf").text=p.BigNum.shortNum(s),e.tm("\u6587\u672c_\u7ecf\u9a8c\u57fa\u7840\u6570\u91cf").text=p.BigNum.shortNum(c);var u=t.ModelMgr.ModelHangling.GetAddition(s,t.normal,t.premium),f=t.ModelMgr.ModelHangling.GetAddition(c,t.normal,t.premium),y="",d="";u>0&&(y="+"+p.BigNum.shortNum(u)),f>0&&(d="+"+p.BigNum.shortNum(f)),e.tm("\u6587\u672c_\u91d1\u5e01\u52a0\u6210\u6570\u91cf").asTextField.setVar("number",y).flushVars(),e.tm("\u6587\u672c_\u7ecf\u9a8c\u52a0\u6210\u6570\u91cf").asTextField.setVar("number",d).flushVars(),t.updateList()},e.prototype.InitBtn=function(){var t=this,e=t.com;e.tm("panel_bg.\u6309\u94ae_\u5173\u95ed").setClick(function(){t.unload()},t),t.AddBtnBehavior(e.tm("\u6309\u94ae_\u5feb\u901f\u4fee\u70bc"),{systemId:0,clickCb:function(){var e=t.ModelMgr.ModelChapter.GetClearanceChapter(),r=t.ModelMgr.ModelChapter.GetRefChapter(e);t.LayerXiulianQuick.SetData({chapter:r,normal:t.normal,premium:t.premium}),t.LayerXiulianQuick.load()}}),e.tm("\u6309\u94ae_\u9886\u53d6").setClick(function(){t.ModelMgr.ModelHangling.RequestGetHanglingReward()},t)},e.prototype.InitList=function(){var t=this;t.com.tm("\u5217\u8868_\u4fee\u70bc\u5956\u52b1").asList.init(t,function(e,r,o){var n=r.asCom.tm("good_com"),i=t.ModelMgr.ModelGoods.CreateGoodsByCmd(o);n.UpdateByGoods(i),n.ClickItem(!0,i,t.proxy)})},e.prototype.OnChange=function(){this.cacheTime=0,this.updateTime=0,this.needUpdate=!0,this.updateList()},e.prototype.updateList=function(){var t=this,e=t.com.tm("\u5217\u8868_\u4fee\u70bc\u5956\u52b1").asList,r=t.ModelMgr.ModelChapter.GetClearanceChapter(),o=t.ModelMgr.ModelChapter.GetRefChapter(r),n=t.ModelMgr.ModelHangling.GetRewardByTime(t.cacheTime,o,t.normal,t.premium);e.update(n)},e.prototype.checkBtnTime=function(){var t=this,e=t.com;e.tm("\u6587\u672c_\u65f6\u95f4").text=t.TimeUtil.timeSec2HMSStr10(t.cacheTime),t.cacheTime<t.checkTime?(e.tm("\u6309\u94ae_\u9886\u53d6").enabled=!1,e.tm("\u6309\u94ae_\u9886\u53d6.title").text=t.TimeUtil.timeSec2HMSStr10(t.checkTime-t.cacheTime)):t.needUpdate&&(t.needUpdate=!1,e.tm("\u6309\u94ae_\u9886\u53d6").enabled=!0,e.tm("\u6309\u94ae_\u9886\u53d6.title").text=s.FW.G_W("\u9886\u53d6"))},e.__cname="LayerXiulianOnHookUI",i([c.injectField("LayerXiulianQuick")],e.prototype,"LayerXiulianQuick",void 0),i([c.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([c.injectField("TimeUtil")],e.prototype,"TimeUtil",void 0),i([c.injectField("CtrlMain")],e.prototype,"CtrlMain",void 0),i([c.injectField("CtrlAlert")],e.prototype,"CtrlAlert",void 0),e}(y.GameLayerUI);r.LayerXiulianOnHookUI=m,cc._RF.pop()},{"../../../../../framework/FW":void 0,"../../../../../framework/container/Container":void 0,"../../../../../framework/layer/common/UIOrder":void 0,"../../../../../libutil/BigNum":void 0,"../../../model/System/ModelSystem":"ModelSystem","../../../model/goods/ModelGoods":"ModelGoods","../../../ui/GameLayer":"GameLayer"}],LayerXiulianQuick:[function(t,e,r){"use strict";cc._RF.push(e,"a5d6b+oUH1K17wE0/nfvhy9","LayerXiulianQuick");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerXiulianQuickUI=r.LayerXiulianQuick=void 0;var s=t("../../../../../framework/FW"),c=t("../../../../../framework/container/Container"),u=t("../../../../../framework/layer/common/UIOrder"),p=t("../../../model/System/ModelSystem"),f=t("../../../model/goods/ModelGoods"),h=t("../../../ui/GameLayer"),y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return d},e.prototype.getUrl=function(){return"ui://\u9996\u9875\u4fee\u70bc_\u6302\u673a\u5b9d\u7bb1/\u7ec4\u4ef6_\u5feb\u901f\u4fee\u70bc\u5f39\u7a97"},e.prototype.getSortOrder=function(){return u.LayerOrder.TowLevel},e.prototype.getSystemId=function(){return p.SystemId.XiulianQuick},e.prototype.SetData=function(t){this.data=t},e.prototype.GetData=function(){return this.data},e.prototype.exit=function(){this.data=null},e.__cname="LayerXiulianQuick",e}(h.GameLayerProxy);r.LayerXiulianQuick=y;var d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.quickTime=18e3,e.chekEnd=15,e.isBusy=!1,e}return n(e,t),e.prototype.getHasBackground=function(){return!0},e.prototype.GetHasCloseAnimation=function(){return!0},e.prototype.GetHasShowAnimation=function(){return!0},e.prototype.initAsync=function(){return a(this,void 0,Promise,function(){return l(this,function(t){switch(t.label){case 0:return[4,this.initData()];case 1:return t.sent(),[2]}})})},e.prototype.init=function(){this.com.toFullCenterParent(this.container),this.InitClick(),this.InitList(),this.InitLayer(),this.InitListen()},e.prototype.initData=function(){return a(this,void 0,void 0,function(){var t,e,r,o,n;return l(this,function(i){switch(i.label){case 0:return this.proxy.GetData()?[3,2]:[4,this.ModelMgr.ModelMonthCard.GetMonthState()];case 1:return t=i.sent(),e=t.normal,r=t.premium,o=this.ModelMgr.ModelChapter.GetClearanceChapter(),n=this.ModelMgr.ModelChapter.GetRefChapter(o),this.data={chapter:n,normal:e,premium:r},[3,3];case 2:this.data=this.proxy.GetData(),i.label=3;case 3:return[2]}})})},e.prototype.InitLayer=function(){var t=this.com,e=this.ModelMgr.ModelGoods.GetRefByCurrency(f.ECurrencyType.sta);t.tm("\u6309\u94ae_\u9886\u53d6.icon").SetUrlByIcon(e.smallIcon)},e.prototype.InitClick=function(){var t=this,e=this,r=e.com;r.tm("panel_bg.\u6309\u94ae_\u5173\u95ed").setClick(function(){e.unload()},e),r.tm("\u6309\u94ae_\u9886\u53d6").setClick(function(){return a(t,void 0,void 0,function(){var t,r,o=this;return l(this,function(n){switch(n.label){case 0:return e.isBusy?[2]:(e.isBusy=!0,t=this.ModelMgr.ModelGameConfig.GetGameConfigValueByKey("endPractice"),r=e.roleSubset.GetOneVO(),t>r.GetEnd()?(e.isBusy=!1,this.CtrlAlert.LayerMessage.addMessage(s.FW.G_W("\u4f53\u529b\u4e0d\u8db3\u4e86\uff0c\u8d76\u7d27\u4f11\u606f\u4e00\u4e0b\u518d\u6765\u5427!")),[2]):(this.CtrlAlert.LayerMainStaConsumeAnimation.SetGObjTarget(this.com.tm("\u6309\u94ae_\u9886\u53d6")),this.CtrlAlert.LayerMainStaConsumeAnimation.SetHostCom(this.container),this.CtrlAlert.LayerMainStaConsumeAnimation.SetStaConsumeNum(t),this.CtrlAlert.LayerMainStaConsumeAnimation.Play(),[4,s.FW.Task.waitUntil(function(){return o.CtrlAlert.LayerMainStaConsumeAnimation.GetPlaybackCompleted()},this,1,1250)]));case 1:return n.sent(),this.CtrlAlert.LayerMainStaConsumeAnimation.SetPlaybackCompleted(!0),this.ModelMgr.ModelHangling.GetRewardQuick(),[2]}})})},e)},e.prototype.InitListen=function(){var t=this,e=this;e.roleSubset=e.ModelMgr.ModelVO.VORoleBag.CreateSubset(),e.roleSubset.SetFilter(function(){return!0}),e.toolSet.addListener(e.roleSubset.GetEventProxy(),"OnChanged",this.updateTimes,e),e.toolSet.addListener(e.ModelMgr.ModelHangling.GetEventProxy(),"timeChange",function(){e.isBusy=!1}),e.toolSet.addDefer(function(){e.ModelMgr.ModelVO.VORoleBag.DestroySubset(t.roleSubset),e.roleSubset=null})},e.prototype.InitList=function(){var t=this;t.com.tm("\u5217\u8868_\u5956\u52b1").asList.init(t,function(e,r,o){var n=r.asCom.tm("good_com"),i=t.ModelMgr.ModelGoods.CreateGoodsByCmd(o);n.UpdateByGoods(i),n.ClickItem(!0,i,t.proxy)}),t.updateList()},e.prototype.updateList=function(){var t=this,e=t.com,r=(t.proxy,e.tm("\u5217\u8868_\u5956\u52b1").asList),o=this.data,n=t.ModelMgr.ModelHangling.GetRewardByTime(t.quickTime,o.chapter,o.normal,o.premium,!0);r.update(n)},e.prototype.updateTimes=function(){var t=this.com,e=this.roleSubset.GetOneVO().GetQuickTimes();t.tm("\u6587\u672c_\u6b21\u6570").text=e.toString(),t.tm("\u6309\u94ae_\u9886\u53d6").enabled=!(e<=0)},e.__cname="LayerXiulianQuickUI",i([c.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([c.injectField("CtrlAlert")],e.prototype,"CtrlAlert",void 0),i([c.injectField("CtrlMain")],e.prototype,"CtrlMain",void 0),e}(h.GameLayerUI);r.LayerXiulianQuickUI=d,cc._RF.pop()},{"../../../../../framework/FW":void 0,"../../../../../framework/container/Container":void 0,"../../../../../framework/layer/common/UIOrder":void 0,"../../../model/System/ModelSystem":"ModelSystem","../../../model/goods/ModelGoods":"ModelGoods","../../../ui/GameLayer":"GameLayer"}],LayerXiulianTask:[function(t,e,r){"use strict";cc._RF.push(e,"becb77AFGRGI75MYpAxMG+d","LayerXiulianTask");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerXiulianTaskUI=r.LayerXiulianTask=void 0;var s=t("../../../../../../framework/container/Container"),c=t("../../../../../../framework/layer/common/UIOrder"),u=t("../../../../../generated/netProto/CmdInterface"),p=t("../../../../model/System/ModelSystem"),f=t("../../../../ui/GameLayer"),h=t("./TabAchieveTask"),y=t("./TabDayTask"),d=t("./TabWeekTask"),m=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return v},e.prototype.getUrl=function(){return"ui://\u9996\u9875_\u4fee\u70bc_\u4efb\u52a1\u7cfb\u7edf/\u7ec4\u4ef6_\u4efb\u52a1_\u4e3b\u754c\u9762"},e.prototype.getSortOrder=function(){return c.LayerOrder.TowLevel},e.prototype.getSystemId=function(){return p.SystemId.XiulianTask},e.__cname="LayerXiulianTask",e}(f.GameLayerProxy);r.LayerXiulianTask=m;var v=function(t){function e(){return t.call(this)||this}return n(e,t),e.prototype.getHasBackground=function(){return!0},e.prototype.GetHasCloseAnimation=function(){return!0},e.prototype.GetHasShowAnimation=function(){return!0},e.prototype.init=function(){var t=this;t.com.toFullCenterParent(this.container),t.com.tm("panel_bg.\u6309\u94ae_\u5173\u95ed").setClick(function(){t.unload()},t)},e.prototype.InitTabProxy=function(){this.proxy.addTab(y.TabDayTask),this.proxy.addTab(d.TabWeekTask),this.proxy.addTab(h.TabAchieveTask)},e.prototype.SetupTabBehaviorAsync=function(){return a(this,void 0,void 0,function(){var e,r,o,n=this;return l(this,function(){return e=this.com.tm("\u6309\u94ae_\u65e5\u5e38"),this.SetTabBtnBehavior(this.proxy.getTab(y.TabDayTask),{btn:e,onVisibleChanged:function(t,e){t.visible=e},onCallBack:function(){n.com.setSelectedPage("\u9875\u7b7e","\u65e5\u5e38")},onRdChanged:function(t){e.asCom.tm("\u7ea2\u70b9").OnRDUpdate(t)}}),r=this.com.tm("\u6309\u94ae_\u5468\u5e38"),this.SetTabBtnBehavior(this.proxy.getTab(d.TabWeekTask),{btn:r,onVisibleChanged:function(t,e){t.visible=e},onCallBack:function(){n.com.setSelectedPage("\u9875\u7b7e","\u5468\u5e38")},onRdChanged:function(t){r.asCom.tm("\u7ea2\u70b9").OnRDUpdate(t)}}),o=this.com.tm("\u6309\u94ae_\u6210\u5c31"),this.SetTabBtnBehavior(this.proxy.getTab(h.TabAchieveTask),{btn:o,onVisibleChanged:function(t,e){t.visible=e},onCallBack:function(){n.com.setSelectedPage("\u9875\u7b7e","\u6210\u5c31")},onRdChanged:function(t){o.asCom.tm("\u7ea2\u70b9").OnRDUpdate(t)}}),t.prototype.SetupTabBehaviorAsync.call(this),[2]})})},e.prototype.enterAsync=function(){return a(this,void 0,Promise,function(){return l(this,function(t){switch(t.label){case 0:return[4,this.ModelMgr.ModelTask.RequestTaskInfo(u.CmdTaskType.DAILY_TASK)];case 1:return t.sent(),[4,this.ModelMgr.ModelTask.RequestTaskInfo(u.CmdTaskType.WEEKLY_TASK)];case 2:return t.sent(),[4,this.ModelMgr.ModelTask.RequestTaskInfo(u.CmdTaskType.ACHIEVEMENT_TASK)];case 3:return t.sent(),[2]}})})},e.prototype.enter=function(){this.proxy.switchDefaultTab()},e.__cname="LayerXiulianTaskUI",i([s.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([s.injectField("CtrlMgr")],e.prototype,"CtrlMgr",void 0),i([s.injectField("TimeUtil")],e.prototype,"TimeUtil",void 0),e}(f.GameLayerUI);r.LayerXiulianTaskUI=v,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../../../../../framework/layer/common/UIOrder":void 0,"../../../../../generated/netProto/CmdInterface":"CmdInterface","../../../../model/System/ModelSystem":"ModelSystem","../../../../ui/GameLayer":"GameLayer","./TabAchieveTask":"TabAchieveTask","./TabDayTask":"TabDayTask","./TabWeekTask":"TabWeekTask"}],MallModuleBase:[function(t,e,r){"use strict";cc._RF.push(e,"ee83a6o139MU41O02IO3aJX","MallModuleBase");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.MallModuleBase=void 0;var a=t("../../../../../framework/base/ScriptObject"),l=t("../../../../../framework/container/Container"),s=t("../../../../../framework/FW"),c=t("../../../../../framework/utils/Toolset"),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.Init=function(t){this.com=s.FW.FairyMgr.createCom(this.GetUrl()).asCom,this.SetModuleId(t),this.InitListen()},e.prototype.OnDestroy=function(){this.com.destroy(),this.com=null,c.ToolSet.destroyToolSet(this.toolSet),this.toolSet=null,t.prototype.destroy.call(this)},e.prototype.Enter=function(){},e.prototype.Exit=function(){},e.prototype.OnUpdate=function(){this.ModelMgr.ModelMall.GetModuleOpenStateById(this.mallId)&&this.UpdateLayer()},e.prototype.InitListen=function(){var t=this;t.toolSet=c.ToolSet.createToolSet(),t.toolSet.addListener(t.ModelMgr.ModelMall.GetEventModuleOnChangeProxy(),"OnModuleOnChange",function(e){t.GetModuleId()==e&&t.OnUpdate()},t)},e.prototype.SetModuleId=function(t){this.mallId=t},e.prototype.GetModuleId=function(){return this.mallId},e.prototype.SetParentProxy=function(t){this.ParentProxy=t},e.prototype.GetParentProxy=function(){return this.ParentProxy},e.prototype.GetChild=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.__cname="MallModuleBase",i([l.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([l.injectField("CtrlPay")],e.prototype,"CtrlPay",void 0),e}(a.ScriptObject);r.MallModuleBase=u,cc._RF.pop()},{"../../../../../framework/FW":void 0,"../../../../../framework/base/ScriptObject":void 0,"../../../../../framework/container/Container":void 0,"../../../../../framework/utils/Toolset":void 0}],MallModuleChapterGift:[function(t,e,r){"use strict";cc._RF.push(e,"856beoN0VhFmqi6/xIS/d+w","MallModuleChapterGift");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.MallModuleChapterGift=void 0;var a=t("../../../../../framework/FW"),l=t("../../../../../framework/container/Container"),s=t("./CtrlMall"),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.selectIndex=0,e}return n(e,t),e.prototype.GetUrl=function(){return"ui://\u9996\u9875_\u5546\u57ce/\u7ec4\u4ef6_\u5546\u57ce_\u7ae0\u8282\u793c\u5305"},e.prototype.Init=function(e){t.prototype.Init.call(this,e)},e.prototype.Enter=function(){var t=this;t.com,this.isBusy=!1,t.InClick(),t.InitGlist(),t.OnUpdate()},e.prototype.InClick=function(){var t=this,e=this,r=e.com,o=function(o){var n=r.tm("\u5217\u8868_\u793c\u5305").asList;e.selectIndex=t.selectIndex+o,n.scrollToView(t.selectIndex,!0),e.UpdateArrowShow()};e.com.tm("\u6309\u94ae_\u53f3\u7bad\u5934").setClick(function(){a.FW.LWX.log("\u5207\u6362\u4e0b\u4e00\u4e2a"),o(1)},e),e.com.tm("\u6309\u94ae_\u5de6\u7bad\u5934").setClick(function(){a.FW.LWX.log("\u5207\u6362\u4e0a\u4e00\u4e2a"),o(-1)},e)},e.prototype.UpdateArrowShow=function(){var t=this,e=t.com.tm("\u5217\u8868_\u793c\u5305").asList.numItems;1==e&&(this.selectIndex=0);var r=!(this.selectIndex<=0),o=!(this.selectIndex>=e-1);t.com.tm("\u6309\u94ae_\u5de6\u7bad\u5934").visible=r,t.com.tm("\u6309\u94ae_\u53f3\u7bad\u5934").visible=o},e.prototype.InitGlist=function(){var t=this,e=this,r=e.com.tm("\u5217\u8868_\u793c\u5305").asList;r.initVirtualList(e,function(r,o,n){var i=o;i.tm("\u6587\u672c_\u793c\u5305\u540d\u79f0").text=n.title,i.tm("\u6587\u672c_\u539f\u4ef7").asTextField.setVar("value",String(n.originPrice)).flushVars(),i.tm("\u6587\u672c_\u793c\u5305\u540d\u79f0").text=n.title;var l=s.ChapterBgconfig.length;i.tm("bg").SetUrlByIcon(s.ChapterBgconfig[(n.id-1)%l]);var c=s.ChapterBoxconfig.length;i.tm("\u88c5\u8f7d\u5668_\u5b9d\u7bb1").SetUrlByIcon(s.ChapterBoxconfig[(n.id-1)%c]);var u=n.fromId,p=t.ModelMgr.ModelPayChannel.GetPayGoodsByFormId(u);if(null!=p){i.tm("\u6309\u94ae_\u8d2d\u4e70").setClick(function(){if(e.isBusy)a.FW.LWX.log("\u5f53\u524d\u6309\u94ae\u6b63\u5728\u5fd9\uff0c\u8bf7\u7a0d\u540e\u70b9\u51fb");else{e.isBusy=!0;try{t.SDKMgr.getSDK().PPP(p.GetId(),p.GetGoodsType(),p.GetFromId()).then(function(){e.isBusy=!1})}catch(r){a.FW.LWX.error("\u7ae0\u8282\u793c\u5305\u8d2d\u4e70\u9519\u8bef."+r),e.isBusy=!1}}},e),a.FW.LWX.log("t.mallId:",e.mallId),a.FW.LWX.log("mallgiftData.id:",n.id);var f=0==e.ModelMgr.ModelMallChapterGift.GetChapterGiftState(n.id);i.tm("\u6309\u94ae_\u8d2d\u4e70").enabled=f,i.tm("\u6309\u94ae_\u8d2d\u4e70").asCom.setSelectedIndex("\u80fd\u5426\u8d2d\u4e70",f?1:0);var h=p.GetUnit();i.tm("\u6309\u94ae_\u8d2d\u4e70.title").text=String(n.price)+h;var y=i.tm("\u5217\u8868_\u5956\u52b1").asList;y.init(e,function(e,r,o){var n=r.tm("item"),i=t.ModelMgr.ModelGoods.CreateGoodsByCmd(o);n.UpdateByGoods(i)});var d=p.GetReward();y.update(d)}else a.FW.LWX.error("\u7ae0\u8282\u793c\u5305\u5bf9\u5e94\u7684paygoods\u8868formid\u51fa\u9519,",u)}),r.setVirtual()},e.prototype.Exit=function(){},e.prototype.destroy=function(){},e.prototype.UpdateLayer=function(){var t=this.com,e=this.ModelMgr.ModelMallChapterGift.GetChaptGiftRefData();t.tm("\u5217\u8868_\u793c\u5305").asList.update(e),this.UpdateArrowShow()},e.__cname="MallModuleChapterGift",i([l.injectField("Ref")],e.prototype,"Ref",void 0),i([l.injectField("SDKMgr")],e.prototype,"SDKMgr",void 0),e}(t("./MallModuleBase").MallModuleBase);r.MallModuleChapterGift=c,cc._RF.pop()},{"../../../../../framework/FW":void 0,"../../../../../framework/container/Container":void 0,"./CtrlMall":"CtrlMall","./MallModuleBase":"MallModuleBase"}],MallModuleDailyShop:[function(t,e,r){"use strict";cc._RF.push(e,"123f7g/UAJNyIpIP3AEn2jV","MallModuleDailyShop");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.MallModuleDailyShop=void 0;var s,c=t("../../../../../framework/FW"),u=t("../../../../../framework/container/Container"),p=t("../../../model/pay/BuyPayObj"),f=t("../../../model/vo/Goods/VOEquip"),h=t("../../../model/vo/Goods/VOItem"),y=t("../../../model/vo/Goods/VORune"),d=t("../Hero/Rune/LayerRuneDetails"),m=t("../LayerItemDetail"),v=t("./MallModuleBase");(function(t){t[t.no=0]="no",t[t.yes=1]="yes"})(s||(s={}));var _=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.Init=function(e){var r=this;t.prototype.Init.call(this,e),this.timer=r.toolSet.addTimer(1e3,function(){r.UpdateTime()}),r.UpdateTime()},e.prototype.Enter=function(){this.timer.start(),this.InitGlist(),this.OnUpdate()},e.prototype.Exit=function(){this.timer&&this.timer.stop(!1,!1),t.prototype.Exit.call(this)},e.prototype.GetUrl=function(){return"ui://\u9996\u9875_\u5546\u57ce/\u7ec4\u4ef6_\u5546\u57ce_\u6bcf\u65e5\u5546\u5e97"},e.prototype.InitGlist=function(){var t=this,e=this;e.com.tm("\u5217\u8868_\u5546\u54c1").asList.init(e,function(r,o,n){var i=n.number,u=0==n.isFirstFree,p=e.ModelMgr.ModelMallDailyShop.GetDailyShopRewardIdByResId(n.id),f=e.ModelMgr.ModelMallDailyShop.GetDailyShopRefRewardById(p),y=e.ModelMgr.ModelMallDailyShop.GetDailyShopBuyCountByResId(n.id),d=n.buyLimitNum,m=e.ModelMgr.ModelMallDailyShop.GetDailyShopFinalNumberByResId(n.id),v=10*Number(e.ModelMgr.ModelMallDailyShop.GetDailyShopDiscountByResId(n.id)),_=f.reward[0],S=e.ModelMgr.ModelGoods.CreateGoodsByCmd({resId:_.resId,number:String(_.number),quality:_.quality}),g=o.tm("\u7ec4\u4ef6_\u7269\u54c1\u6846");if(g.UpdateByGoods(S),S instanceof h.VOItem?g.GetBehavior().onNumberVisible(!0):g.GetBehavior().onNumberVisible(!1),y>=d)o.setSelectedPage("\u8d2d\u4e70\u7c7b\u578b","\u8fbe\u5230\u4e0a\u9650");else if(y>=i&&y<d){var b=e.ModelMgr.ModelGoods.GetRefByCurrency(f.pay[0].resId).icon;o.setSelectedPage("\u8d2d\u4e70\u7c7b\u578b","\u8d27\u5e01"),o.tm("\u6587\u672c_\u4ef7\u683c").asTextField.setVar("value",String(m)).flushVars(),o.tm("\u56fe\u6807_\u8d27\u5e01\u7c7b\u578b").SetUrlByIcon(b)}else if(u&&!y)o.setSelectedPage("\u8d2d\u4e70\u7c7b\u578b","\u514d\u8d39");else{o.setSelectedPage("\u8d2d\u4e70\u7c7b\u578b","\u5e7f\u544a");var C=e.ModelMgr.ModelMallDailyShop.GetDailyShopAdTimeByResId(n.id)/1e3,R=e.TimeUtil.now(),M=60*n.cdTimes,w=R-C>=M,O=M-(R-C),B=e.TimeUtil.timeSec2HMSStr13(O);if(o.tm("\u6587\u672c_\u5e7f\u544atips").text=w?c.FW.G_W("\u514d \u8d39"):B,w)o.tm("\u6587\u672c_\u5e7f\u544atips").text=c.FW.G_W("\u514d \u8d39");else var P=e.toolSet.addTimer(1e3,function(){var r=e.TimeUtil.now(),n=M-(r-C),i=e.TimeUtil.timeSec2HMSStr13(n);o.tm("\u6587\u672c_\u5e7f\u544atips").text=i,n<=0&&(c.FW.LWX.log("\u8ba1\u65f6\u5668\u5173\u95ed"),o.tm("\u6587\u672c_\u5e7f\u544atips").text=c.FW.G_W("\u514d \u8d39"),o.tm("\u7ea2\u70b9").OnRDUpdate(1),t.toolSet.removeTimer(P))})}o.tm("\u6587\u672c_\u5546\u54c1\u540d\u79f0").text=String(S.GetName());var G=u||10==v||0==v;if(!G){var k=e.DiscountType(v);o.setSelectedPage("\u6298\u6263\u7c7b\u578b",k)}o.tm("\u6298\u6263").visible=!G,o.tm("\u6587\u672c_\u6298\u6263").asTextField.setVar("discount",String(v)).flushVars(),o.setSelectedPage("bg\u7c7b\u578b",u?"\u9ec4":"\u7070");var x=o.tm("\u7ea2\u70b9"),T=e.ModelMgr.ModelMallDailyShop.CheckRDByResId(n.id);x.OnRDUpdate(T),e.GetParentProxy().ui.setFairyGobjEvent(o,function(){return a(t,void 0,void 0,function(){var t,r,o,a;return l(this,function(l){switch(l.label){case 0:return t=s.no,y>=d?(e.CtrlAlert.LayerMessage.addMessage(c.FW.G_W("\u8fd9\u4e2a\u7269\u54c1\u5df2\u7ecf\u8d2d\u4e70\u8fc7\u4e86\u54df~")),[3,6]):[3,1];case 1:return y>=i&&y<d?(e.OnclickBuy(S,n),[3,6]):[3,2];case 2:return!u||y?[3,3]:(this.BuyRequest(t,n),[3,6]);case 3:return c.FW.Log.log("DS\u6253\u5f00\u5e7f\u544a"),t=s.yes,r=e.ModelMgr.ModelMallDailyShop.GetDailyShopAdTimeByResId(n.id)/1e3,o=e.TimeUtil.now(),a=60*n.cdTimes,o-r<a?[3,5]:[4,this.CtrlPay.PayforAdVideo()];case 4:return l.sent()&&this.BuyRequest(t,n),[3,6];case 5:e.CtrlAlert.LayerMessage.addMessage(c.FW.G_W("\u5e97\u94fa\u6574\u987f\uff0c\u8bf7\u7a0d\u540e\u518d\u6765\u8d2d\u4e70\u5427~")),l.label=6;case 6:return[2]}})})})})},e.prototype.OnclickBuy=function(t,e){var r=this,o=r.ModelMgr.ModelMallDailyShop.GetDailyShopRewardIdByResId(e.id),n=r.ModelMgr.ModelMallDailyShop.GetDailyShopRefRewardById(o),i=r.ModelMgr.ModelMallDailyShop.GetDailyShopFinalNumberByResId(e.id),a={payResId:n.pay[0].resId,payNumber:i,isCanBuy:!0},l={payResId:a.payResId,payNumber:a.payNumber,mallId:r.mallId,planId:e.id,isAd:s.no},d=new p.MallDailyShopPayObj(l);if(u.Container.inst().inject(d),t instanceof h.VOItem)r.LayerBuyGoods.SetGood(t),r.LayerBuyGoods.SetBuyInfo(a),r.LayerBuyGoods.SetPayObj(d),r.LayerBuyGoods.load();else if(t instanceof f.VOEquip){var m=t;r.BuyEquip(m,d,a)}else if(t instanceof y.VORune){var v=t;r.BuyRune(v,d,a)}else c.FW.LWX.error("\u7c7b\u578b\u9519\u8bef\uff0c\u8bf7\u68c0\u67e5\u662f\u5426\u65b0\u589e\u7c7b\u578b")},e.prototype.DiscountType=function(t){switch(!0){case t>=1&&t<=3:return"\u9ad8\u7ea7";case t>3&&t<=6:return"\u4e2d\u7ea7";case t>6&&t<=9:default:return"\u4f4e\u7ea7"}},e.prototype.BuyEquip=function(t,e,r){var o=this;o.LayerItemDetail.SetEquip(t),o.LayerItemDetail.SetBuyInfo(r),o.LayerItemDetail.SetPayObj(e),o.LayerItemDetail.SetOpenPosition(m.OpenPosition.MallBuy),o.LayerItemDetail.load()},e.prototype.BuyRune=function(t,e,r){var o=this;o.LayerRuneDetails.SetData({rune:t}),o.LayerRuneDetails.SetBuyInfo(r),o.LayerRuneDetails.SetPayObj(e),o.LayerRuneDetails.SetViewType(d.RuneDetailsViewType.MallBuy),o.LayerRuneDetails.load()},e.prototype.BuyRequest=function(t,e){var r={mallId:this.mallId,planId:e.id,isAd:t};this.ModelMgr.ModelMallDailyShop.RequestMallDailyShopBuy(r)},e.prototype.OnclickGoods=function(t,e,r,o){var n=this,i=n.ModelMgr.ModelMallDailyShop.GetDailyShopRewardIdByResId(r.id),a=n.ModelMgr.ModelMallDailyShop.GetDailyShopFinalNumberByResId(r.id),l={payResId:n.ModelMgr.ModelMallDailyShop.GetDailyShopRefRewardById(i).pay[0].resId,payNumber:a,isCanBuy:o},d={payResId:l.payResId,payNumber:l.payNumber,mallId:n.mallId,planId:r.id,isAd:s.no},m=new p.MallDailyShopPayObj(d);if(u.Container.inst().inject(m),t instanceof h.VOItem)e.GetBehavior().showTips(t,n.GetParentProxy());else if(t instanceof f.VOEquip){var v=t;n.BuyEquip(v,m,l)}else if(t instanceof y.VORune){var _=t;n.BuyRune(_,m,l)}else c.FW.LWX.error("\u7c7b\u578b\u9519\u8bef\uff0c\u8bf7\u68c0\u67e5\u662f\u5426\u65b0\u589e\u7c7b\u578b")},e.prototype.UpdateTime=function(){var t=this,e=t.com,r=t.TimeUtil.now(),o=.001*t.TimeUtil.getNextDay12(1e3*t.TimeUtil.now()),n=t.TimeUtil.timeSec2HMSStr13(o-r);e.tm("\u6587\u672c_\u5237\u65b0\u5012\u8ba1\u65f6").setVar("time",n).flushVars()},e.prototype.UpdateLayer=function(){var t=this.com,e=this.ModelMgr.ModelMallDailyShop.GetDailyShopRefData(),r=t.tm("\u5217\u8868_\u5546\u54c1").asList;r.update(e),r.resizeToFit()},e.__cname="MallModuleDailyShop",i([u.injectField("TimeUtil")],e.prototype,"TimeUtil",void 0),i([u.injectField("LayerBuyGoods")],e.prototype,"LayerBuyGoods",void 0),i([u.injectField("LayerItemDetail")],e.prototype,"LayerItemDetail",void 0),i([u.injectField("LayerRuneDetails")],e.prototype,"LayerRuneDetails",void 0),i([u.injectField("LayerShowTip")],e.prototype,"LayerShowTip",void 0),i([u.injectField("CtrlMain")],e.prototype,"CtrlMain",void 0),i([u.injectField("CtrlAlert")],e.prototype,"CtrlAlert",void 0),e}(v.MallModuleBase);r.MallModuleDailyShop=_,cc._RF.pop()},{"../../../../../framework/FW":void 0,"../../../../../framework/container/Container":void 0,"../../../model/pay/BuyPayObj":"BuyPayObj","../../../model/vo/Goods/VOEquip":"VOEquip","../../../model/vo/Goods/VOItem":"VOItem","../../../model/vo/Goods/VORune":"VORune","../Hero/Rune/LayerRuneDetails":"LayerRuneDetails","../LayerItemDetail":"LayerItemDetail","./MallModuleBase":"MallModuleBase"}],MallModuleGloden:[function(t,e,r){"use strict";cc._RF.push(e,"9770fG5DLZD97+qcF9Uu92L","MallModuleGloden");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.MallModuleGloden=void 0;var s=t("../../../../../framework/FW"),c=t("../../../../../framework/container/Container"),u=t("../../../model/goods/ModelGoods"),p=t("../../../model/pay/BuyPayObj"),f=t("./MallModuleBase"),h=t("./TabMall"),y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.anHourCoin=0,e.addCoinPercentage=0,e}return n(e,t),e.prototype.GetUrl=function(){return"ui://\u9996\u9875_\u5546\u57ce/\u7ec4\u4ef6_\u5546\u57ce_\u5145\u503c"},e.prototype.Enter=function(){return a(this,void 0,void 0,function(){var t,e;return l(this,function(r){switch(r.label){case 0:return e=t=this,[4,this.ModelMgr.ModelMonthCard.GetMonthState()];case 1:return e.monthData=r.sent(),t.InitData(),t.InitGlist(),t.OnUpdate(),[2]}})})},e.prototype.InitGlist=function(){var t=this,e=this;e.com.tm("\u5217\u8868_\u5546\u54c1").asList.init(e,function(r,o,n){o.setSelectedPage("\u5546\u54c1\u7c7b\u578b","\u91d1\u5e01");var i=n.number,f=0==n.isFirstFree,y=e.ModelMgr.ModelMallGloden.GetCoinRewardById(n.contentIds[0]),d=e.ModelMgr.ModelBox.GetCoinBoxTimes(y.boxId),m=e.anHourCoin*d,v=e.ModelMgr.ModelMallGloden.GetCoinBuycount(n.resId);if(v>=i?(o.setSelectedPage("\u8d2d\u4e70\u7c7b\u578b","\u8d27\u5e01"),o.tm("\u8d2d\u4e70_\u91d1\u5e01_\u4ef7\u683c").asTextField.setVar("value",String(y.pay[0].number)).flushVars(),o.tm("\u8d2d\u4e70_\u91d1\u5e01_\u56fe\u6807_\u8d27\u5e01\u7c7b\u578b").SetUrlByIcon(e.ModelMgr.ModelGoods.GetRefByCurrency(y.pay[0].resId).icon)):f&&!v?o.setSelectedPage("\u8d2d\u4e70\u7c7b\u578b","\u514d\u8d39"):o.setSelectedPage("\u8d2d\u4e70\u7c7b\u578b","\u5e7f\u544a"),o.tm("\u6708\u5361\u6536\u76ca").visible=e.monthData.normal||e.monthData.premium,e.monthData.normal||e.monthData.premium){var _=String(e.addCoinPercentage);o.tm("\u6587\u672c_\u6708\u5361\u6536\u76ca").asTextField.setVar("value",_).flushVars()}o.tm("\u56fe\u6807_icon").SetUrlByIcon(n.icon),o.tm("\u6587\u672c_\u6570\u91cf").text=String(m.toString()),o.tm("\u6587\u672c_\u540d\u79f0").text=String(y.name);var S=o.tm("\u7ea2\u70b9"),g=e.ModelMgr.ModelMallGloden.CheckRDByResId(n.resId);S.OnRDUpdate(g?1:0),e.GetParentProxy().ui.setFairyGobjEvent(o,function(){return a(t,void 0,void 0,function(){var t,r,o,a,d,_;return l(this,function(l){switch(l.label){case 0:return t=v>=i?h.ShopBuyType.buy:h.ShopBuyType.free,v>=i?(r=e.ModelMgr.ModelGoods.CreateGoodsByCmd({resId:u.ECurrencyType.coin,number:m.toString()}),o={payResId:y.pay[0].resId,payNumber:y.pay[0].number},a=new p.MallCoinPayObj({mallId:e.mallId,resId:n.resId,type:t,payResId:o.payResId,payNumber:o.payNumber}),c.Container.inst().inject(a),e.LayerBuyGoods.SetGood(r),e.LayerBuyGoods.SetBuyInfo(o),e.LayerBuyGoods.SetTitle(y.name),e.LayerBuyGoods.SetPayObj(a),e.LayerBuyGoods.load(),[3,4]):[3,1];case 1:return!f||v?[3,2]:(_={mallId:e.mallId,resId:n.resId,type:t},e.ModelMgr.ModelMallGloden.RequestMallCoinBuy(_),[3,4]);case 2:return s.FW.Log.log("Gloden\u6253\u5f00\u5e7f\u544a"),[4,this.CtrlPay.PayforAdVideo()];case 3:d=l.sent(),s.FW.Log.log("Gloden\u5e7f\u544a\u7ed3\u679c",d),d&&(_={mallId:e.mallId,resId:n.resId,type:t},e.ModelMgr.ModelMallGloden.RequestMallCoinBuy(_)),l.label=4;case 4:return[2]}})})})})},e.prototype.InitData=function(){var t=this,e=t.ModelMgr.ModelVO.VOChapterBag.CreateSubset();e.SetFilter(function(){return!0}),t.toolSet.addDefer(function(){t.ModelMgr.ModelVO.VOChapterBag.DestroySubset(e),e=null});var r=e.GetVOBySift(function(t,e){return t.GetResId()<e.GetResId()}),o=null==r?void 0:r.GetResId(),n=t.ModelMgr.ModelChapter.GetRefChapter(o),i=n&&60*n.coinPatrol||0,a=t.ModelMgr.ModelHangling.GetAddition(i,t.monthData.normal,t.monthData.premium);t.addCoinPercentage=t.ModelMgr.ModelHangling.GetAdditionPercentage(t.monthData.normal,t.monthData.premium),t.anHourCoin=i+a},e.prototype.UpdateLayer=function(){var t=this.com;this.SetTitle();var e=this.ModelMgr.ModelMallGloden.GetCoinData(),r=t.tm("\u5217\u8868_\u5546\u54c1").asList;r.update(e),r.resizeToFit()},e.prototype.SetTitle=function(){var t=this,e=t.com,r=t.ModelMgr.ModelMall.GetModuleDataById(t.mallId);e.tm("\u6587\u672c_title").text=r.title},e.__cname="MallModuleGloden",i([c.injectField("LayerBuyGoods")],e.prototype,"LayerBuyGoods",void 0),e}(f.MallModuleBase);r.MallModuleGloden=y,cc._RF.pop()},{"../../../../../framework/FW":void 0,"../../../../../framework/container/Container":void 0,"../../../model/goods/ModelGoods":"ModelGoods","../../../model/pay/BuyPayObj":"BuyPayObj","./MallModuleBase":"MallModuleBase","./TabMall":"TabMall"}],MallModuleLuckDraw:[function(t,e,r){"use strict";cc._RF.push(e,"e4319jHNlhOHpLZoJX4XRIj","MallModuleLuckDraw");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.MallModuleLuckDraw=void 0;var s=t("../../../../../framework/FW"),c=t("../../../../../framework/container/Container"),u=t("../../../model/mall/ModelMall"),p=t("../../../model/pay/DrawPayObj"),f=t("./MallModuleBase"),h=t("./TabMall"),y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.nowDrawType=h.DrawCount.single,e}return n(e,t),e.prototype.GetUrl=function(){return"ui://\u9996\u9875_\u5546\u57ce/\u7ec4\u4ef6_\u5546\u57ce_\u5347\u68fa\u53d1\u8d22"},e.prototype.Init=function(e){t.prototype.Init.call(this,e),this.toolSet.addListener(this.ModelMgr.ModelMallLuckDraw.GetEventLuckDrawResultProxy(),"OnLuckDrawResult",this.DrawResult,this)},e.prototype.Enter=function(){this.InitGlist(),this.OnUpdate()},e.prototype.Exit=function(){},e.prototype.InitGlist=function(){var t=this,e=this;e.com.tm("\u5217\u8868_\u6398\u5893").asList.init(e,function(r,o,n){var i=o,f=e.ModelMgr.ModelMallLuckDraw.GetLuckDrawReward();i.tm("\u6587\u672c_\u63cf\u8ff0").text=n.desc,i.tm("\u6587\u672c_title").text=n.title,i.setSelectedIndex("\u6398\u5893\u7c7b\u578b",n.type==u.MallChestType.ordinaryLuckDraw?0:1);var y=e.ModelMgr.ModelMallLuckDraw.GetLuckDrawBuyCount(n.id),d=e.ModelMgr.ModelMallLuckDraw.GetLuckDrawBigPrizeCount(n.id),m=n.bigPrize,v=n.number,_=Math.max(m-d,0),S=Math.max(v-y,0),g=n.bigPrizeDesc;i.tm("\u5bcc\u6587\u672c_\u5927\u5956\u4fdd\u5e95\u5269\u4f59\u6b21\u6570").asTextField.setVar("value",String(_)).setVar("desc",g).flushVars(),i.tm("\u6587\u672c_\u5269\u4f59\u6b21\u6570").asTextField.setVar("remainingTimes",String(S)).setVar("maxTimes",String(v)).flushVars();var b=e.ModelMgr.ModelMallLuckDraw.GetLuckDrawFreeTime(n.id)/1e3,C=e.TimeUtil.now(),R=3600*n.cdTime,M=C-b>=R;i.setSelectedIndex("\u662f\u5426\u514d\u8d39",M?1:0);var w=M;if(i.tm("\u6309\u94ae_\u5e7f\u544a.\u7ea2\u70b9").OnRDUpdate(w),!M)var O=e.toolSet.addTimer(1e3,function(){var r=e.TimeUtil.now(),o=R-(r-b),n=e.TimeUtil.timeSec2HMSStr13(o);i.tm("\u6587\u672c_\u514d\u8d39\u5012\u8ba1\u65f6").asTextField.setVar("time",n).flushVars(),o<=0&&(i.setSelectedIndex("\u662f\u5426\u514d\u8d39",1),i.tm("\u6309\u94ae_\u5e7f\u544a.\u7ea2\u70b9").OnRDUpdate(!0),t.toolSet.removeTimer(O))},e);i.tm("\u6309\u94ae_\u5b9d\u7bb1\u8be6\u60c5").setClick(function(){var t=f.get(n.id);e.LayerMallChestDetails.SetData(t.rewardData),e.LayerMallChestDetails.SetTotalWeight(t.totalWeight),e.LayerMallChestDetails.SetTitle(n.title),e.LayerMallChestDetails.load()},e),i.tm("\u6309\u94ae_\u62bd\u5956").setClick(function(){var t={mallId:e.mallId,mallchestType:n.type,resId:n.id,cost:[n.costItem[0],n.costGem[0]],drawCount:y,type:h.DrawCount.ten,maxDrawCount:n.number},r=new p.LuckDrawPayObj(t);c.Container.inst().inject(r),e.ModelMgr.ModelPay.Pay(r),e.drawRefInfo=n},e),e.GetParentProxy().ui.setFairyBtnEvent(i.tm("\u6309\u94ae_\u5e7f\u544a"),function(){return a(t,void 0,void 0,function(){var t,r;return l(this,function(o){switch(o.label){case 0:return s.FW.Log.log("LD\u6253\u5f00\u5e7f\u544a"),[4,this.CtrlPay.PayforAdVideo()];case 1:return t=o.sent(),s.FW.Log.log("LD\u5e7f\u544a\u7ed3\u679c",t),t&&(r={mallId:e.mallId,resId:n.id,type:h.DrawState.free},e.ModelMgr.ModelMallLuckDraw.RequestMallLuckDraw(r,n.type),e.drawRefInfo=n,s.FW.LWX.log("\u5e7f\u544a\u514d\u8d39")),[2]}})})});var B=S>=h.DrawCount.single;i.tm("\u6309\u94ae_\u62bd\u5956").grayed=!B;var P=e.GetDrawState([n.costItem[0],n.costGem[0]]);if(i.tm("\u6309\u94ae_\u62bd\u5956").asCom.setSelectedIndex("\u8d2d\u4e70\u72b6\u6001",P==h.DrawState.prop?0:1),P==h.DrawState.prop){var G=e.ModelMgr.ModelGoods.CreateGoods(n.costItem[0].resId),k=e.ModelMgr.ModelGoods.GetGoodsNumberByRefId(n.costItem[0].resId);i.tm("\u6309\u94ae_\u62bd\u5956.icon_\u9053\u5177\u56fe\u6807").SetUrlByIcon(G.GetIconUrl()),i.tm("\u6309\u94ae_\u62bd\u5956.\u6587\u672c_\u9053\u5177\u6570\u91cf").text=k+"/"+n.costItem[0].number,w=k>=n.costItem[0].number,i.tm("\u6309\u94ae_\u62bd\u5956.\u7ea2\u70b9").OnRDUpdate(w)}else{var x=e.ModelMgr.ModelGoods.CreateGoods(n.costGem[0].resId);i.tm("\u6309\u94ae_\u62bd\u5956.icon_money").SetUrlByIcon(x.GetIconUrl()),i.tm("\u6309\u94ae_\u62bd\u5956.\u6587\u672c_\u8d27\u5e01\u6570\u91cf").text=String(n.costGem[0].number),w=!1,i.tm("\u6309\u94ae_\u62bd\u5956.\u7ea2\u70b9").OnRDUpdate(w)}})},e.prototype.UpdateLayer=function(){var t=this.com,e=this.ModelMgr.ModelMallLuckDraw.GetLuckDrawRefInfo();t.tm("\u5217\u8868_\u6398\u5893").asList.update(e)},e.prototype.GetDrawState=function(t){return this.com,t[1]?this.ModelMgr.ModelGoods.GetGoodsNumberByRefId(t[0].resId)>=t[0].number?h.DrawState.prop:h.DrawState.Gem:h.DrawState.prop},e.prototype.DrawResult=function(t,e){var r=this;if(t){var o=r.ModelMgr.ModelMallLuckDraw.GetLuckDrawBuyCount(r.drawRefInfo.id),n={refInfo:r.drawRefInfo,drawType:r.nowDrawType,drawCount:o,mallId:u.MallModule.LuckDraw,isCanTenDraw:!1};r.LayerMallLuckyDrawDisplay.SetGoodsList(e),r.LayerMallLuckyDrawDisplay.SetDrawInfo(n),r.LayerMallLuckyDrawDisplay.isLoad&&r.LayerMallLuckyDrawDisplay.ui?r.LayerMallLuckyDrawDisplay.ui.OnUpdate():r.LayerMallLuckyDrawDisplay.load()}else r.LayerShowTip.SetData({context:s.FW.G_W("\u62bd\u53d6\u5956\u52b1\u5931\u8d25\u4e86~\u4e0d\u8981\u6c14\u9981\u518d\u8bd5\u8bd5\u3002")}),r.LayerShowTip.load()},e.prototype.GetChild=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=this,o=r.com,n=o.tm("\u5217\u8868_\u6398\u5893").asList,i=t[0][0],a=t[0][1],l=n.getChildAt(i).asCom;return l.tm(a)},e.__cname="MallModuleLuckDraw",i([c.injectField("LayerShowTip")],e.prototype,"LayerShowTip",void 0),i([c.injectField("TimeUtil")],e.prototype,"TimeUtil",void 0),i([c.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([c.injectField("LayerMallLuckyDrawDisplay")],e.prototype,"LayerMallLuckyDrawDisplay",void 0),i([c.injectField("LayerMallChestDetails")],e.prototype,"LayerMallChestDetails",void 0),e}(f.MallModuleBase);r.MallModuleLuckDraw=y,cc._RF.pop()},{"../../../../../framework/FW":void 0,"../../../../../framework/container/Container":void 0,"../../../model/mall/ModelMall":"ModelMall","../../../model/pay/DrawPayObj":"DrawPayObj","./MallModuleBase":"MallModuleBase","./TabMall":"TabMall"}],MallModuleRecharge:[function(t,e,r){"use strict";cc._RF.push(e,"24a4cztpflNbbwv+7lXX0wa","MallModuleRecharge");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.MallModuleRecharge=void 0;var a=t("../../../../../framework/container/Container"),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetUrl=function(){return"ui://\u9996\u9875_\u5546\u57ce/\u7ec4\u4ef6_\u5546\u57ce_\u5145\u503c"},e.prototype.Enter=function(){var t=this;t.com,t.InitList(),t.OnUpdate()},e.prototype.InitList=function(){var t=this,e=this;e.com.tm("\u5217\u8868_\u5546\u54c1").asList.init(e,function(r,o,n){o.setSelectedPage("\u5546\u54c1\u7c7b\u578b","\u5145\u503c");var i=t.ModelMgr.ModelMallRecharge.GetChargeDataById(n.id);o.tm("\u6587\u672c_\u6570\u91cf").text=String(i.refgoods.reward[0].number),o.tm("\u6587\u672c_\u540d\u79f0").text=String(i.refgoods.name),o.tm("\u8d2d\u4e70_\u5145\u503c_\u4ef7\u683c").asTextField.setVar("value",String(i.refpayChannel.rmb)).flushVars(),o.tm("\u56fe\u6807_icon").SetUrlByIcon(i.refgoods.icon);var a=0==e.ModelMgr.ModelMallRecharge.GetFirstChargeState(n.id);if(o.tm("\u53cc\u500d").visible=a,a){o.tm("\u6587\u672c_\u53cc\u500d\u6570\u91cf").asTextField.setVar("value",String(i.refgoods.reward[0].number)).flushVars();var l=e.ModelMgr.ModelGoods.CreateGoods(i.refgoods.reward[0].resId);o.tm("\u56fe\u6807_\u8d60\u9001icon").SetUrlByIcon(l.GetIconUrl())}},function(e,r,o){var n=t.ModelMgr.ModelMallRecharge.GetChargeDataById(o.id);t.SDKMgr.getSDK().PPP(n.refpayChannel.id,n.refgoods.type,n.refgoods.fromId)})},e.prototype.UpdateLayer=function(){var t=this.com;this.SetTitle();var e=this.ModelMgr.ModelMallRecharge.GetRechargeData(),r=t.tm("\u5217\u8868_\u5546\u54c1").asList;r.update(e),r.resizeToFit()},e.prototype.SetTitle=function(){var t=this,e=t.com,r=t.ModelMgr.ModelMall.GetModuleDataById(t.mallId);e.tm("\u6587\u672c_title").text=r.title},e.__cname="MallModuleRecharge",i([a.injectField("Ref")],e.prototype,"Ref",void 0),i([a.injectField("SDKMgr")],e.prototype,"SDKMgr",void 0),e}(t("./MallModuleBase").MallModuleBase);r.MallModuleRecharge=l,cc._RF.pop()},{"../../../../../framework/container/Container":void 0,"./MallModuleBase":"MallModuleBase"}],MallModuleSEquip:[function(t,e,r){"use strict";cc._RF.push(e,"c36d0h18vNArbr90kPIval3","MallModuleSEquip");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.MallModuleSEquip=void 0;var a=t("../../../../../framework/FW"),l=t("../../../../../framework/container/Container"),s=t("../../../model/mall/ModelMall"),c=t("../../../model/pay/DrawPayObj"),u=t("../LayerItemDetail"),p=t("./CtrlMall"),f=t("./MallModuleBase"),h=t("./TabMall"),y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetUrl=function(){return"ui://\u9996\u9875_\u5546\u57ce/\u7ec4\u4ef6_\u5546\u57ce_\u795e\u88c5\u6218\u5907"},e.prototype.Init=function(e){t.prototype.Init.call(this,e),this.toolSet.addListener(this.ModelMgr.ModelMallSEquip.GetEventSEquipDrawProxy(),"OnSEquipDrawResult",this.DrawResult,this)},e.prototype.Enter=function(){var t=this;t.InitClick(),t.InitLayer(),t.OnUpdate()},e.prototype.InitClick=function(){var t=this,e=this,r=e.com,o=e.ModelMgr.ModelMallSEquip.GetSEquipInfoById(e.mallId),n=e.ModelMgr.ModelMall.GetModuleDataById(e.mallId);r.tm("\u6309\u94ae_\u5355\u62bd").setClick(function(){e.nowDrawType=h.DrawCount.single;var r={mallId:e.mallId,mallchestType:o.type,resId:o.id,cost:[o.costItem[0],o.costGem[0]],drawCount:e.ModelMgr.ModelMallSEquip.GetSEquipBuyCount(e.mallId,o.id),type:e.nowDrawType,maxDrawCount:o.number};t.RequestDraw(r),a.FW.LWX.log("\u70b9\u51fb\u5355\u62bd")},this),r.tm("\u6309\u94ae_\u5341\u62bd").setClick(function(){e.nowDrawType=h.DrawCount.ten;var r={mallId:e.mallId,mallchestType:o.type,resId:o.id,cost:[o.tenCostItem[0],o.tenCostGem[0]],drawCount:e.ModelMgr.ModelMallSEquip.GetSEquipBuyCount(e.mallId,o.id),type:e.nowDrawType,maxDrawCount:o.number};t.RequestDraw(r),a.FW.LWX.log("\u70b9\u51fb\u5341\u62bd")},this),r.tm("\u6309\u94ae_s\u7ea7\u9884\u89c8").setClick(function(){var e=t.ModelMgr.ModelMallSEquip.GetRewardDataById(o.id).ultimatePrizeData;t.LayerItemDetail.SetPreViewList(e),t.LayerItemDetail.SetOpenPosition(u.OpenPosition.MallBoxPreview),t.LayerItemDetail.load()},this),r.tm("\u6309\u94ae_\u5b9d\u7bb1\u8be6\u60c5").setClick(function(){var e=t.ModelMgr.ModelMallSEquip.GetRewardDataById(o.id);t.LayerMallChestDetails.SetData(e.rewardData),t.LayerMallChestDetails.SetTitle(n.title),t.LayerMallChestDetails.SetTotalWeight(e.totalWeight),t.LayerMallChestDetails.load()},this)},e.prototype.GetOpenState=function(){return this.ModelMgr.ModelMall.GetModuleOpenStateById(this.mallId)},e.prototype.InitLayer=function(){var t=this,e=t.com,r=t.ModelMgr.ModelMallSEquip.GetSEquipInfoById(t.mallId);null!=r?(r.icon&&e.tm("\u88c5\u8f7d\u5668_\u5c55\u793a").SetUrlByIcon(r.icon),e.tm("bg").SetUrlByIcon(p.sEquipBgConfig.get(r.type))):console.log("s\u7ea7\u6218\u5907\u6570\u636eInitLayer\u6570\u636e\u5f02\u5e38+",t.mallId)},e.prototype.UpdateLayer=function(){var t=this,e=t.com,r=t.ModelMgr.ModelMallSEquip.GetSEquipInfoById(t.mallId);if(null!=r){var o=t.ModelMgr.ModelMall.GetModuleDataById(t.mallId),n=t.ModelMgr.ModelMallSEquip.GetSEquipBuyCount(t.mallId,r.id),i=r.costItem,a=r.costGem,l=r.tenCostItem,s=r.tenCostGem,c=r.number,u=r.bigPrize,p=r.bigPrizeDesc,f=r.ultimatePrize,y=r.ultimatePrizeDesc,d=t.ModelMgr.ModelMallSEquip.GetSEquipbigPrizeCount(t.mallId,r.id),m=t.ModelMgr.ModelMallSEquip.GetSEquipbigultimatePrizeCount(t.mallId,r.id),v=Math.max(c-n,0),_=Math.max(u-d,0),S=Math.max(f-m,0);this.SetBuybuttonInfo("\u6309\u94ae_\u5355\u62bd",i,a,h.DrawCount.single,v),this.SetBuybuttonInfo("\u6309\u94ae_\u5341\u62bd",l,s,h.DrawCount.ten,v),e.tm("\u6587\u672c_\u5269\u4f59\u6b21\u6570").asTextField.setVar("surplus",String(v)).setVar("max",String(c)).flushVars(),e.tm("\u5bcc\u6587\u672c_\u73cd\u5b9d\u5012\u6570").asTextField.setVar("value",String(_)).setVar("desc",p).flushVars(),e.tm("\u5bcc\u6587\u672c_s\u7ea7\u73cd\u5b9d\u5012\u6570").asTextField.setVar("value",String(S)).setVar("desc",y).flushVars(),e.tm("\u5bcc\u6587\u672c_\u5b9d\u7bb1\u63cf\u8ff0").text=r.desc,e.tm("\u6587\u672c_title").text=o.title}else console.log("s\u7ea7\u6218\u5907\u6570\u636e\u4e3a\u7a7a+",t.mallId)},e.prototype.SetBuybuttonInfo=function(t,e,r,o,n){var i=this.com,a=n>=o;i.tm(t).asCom.setSelectedIndex("\u7f6e\u7070",a?0:1);var l=this.GetDrawState([e[0],r[0]]);if(i.tm(t).asCom.setSelectedIndex("\u8d2d\u4e70\u72b6\u6001",l==h.DrawState.prop?0:1),l==h.DrawState.prop){var s=this.ModelMgr.ModelGoods.CreateGoods(e[0].resId),c=this.ModelMgr.ModelGoods.GetGoodsNumberByRefId(e[0].resId);i.tm(t).asCom.tm("icon_\u9053\u5177\u56fe\u6807").SetUrlByIcon(s.GetIconUrl()),i.tm(t).asCom.tm("\u6587\u672c_\u9053\u5177\u6570\u91cf").text=c+"/"+e[0].number;var u=c>=e[0].number;i.tm(t).asCom.tm("\u7ea2\u70b9").OnRDUpdate(u)}else{var p=this.ModelMgr.ModelGoods.CreateGoods(r[0].resId);i.tm(t).asCom.tm("icon_money").SetUrlByIcon(p.GetIconUrl()),i.tm(t).asCom.tm("\u6587\u672c_\u8d27\u5e01\u6570\u91cf").text=String(r[0].number),i.tm(t).asCom.tm("\u7ea2\u70b9").OnRDUpdate(0)}},e.prototype.GetDrawState=function(t){return this.com,t[1]?this.ModelMgr.ModelGoods.GetGoodsNumberByRefId(t[0].resId)>=t[0].number?h.DrawState.prop:h.DrawState.Gem:h.DrawState.prop},e.prototype.RequestDraw=function(t){if(t.maxDrawCount-t.drawCount>=t.type){var e=new c.SEquipDrawPayObj(t);l.Container.inst().inject(e),this.ModelMgr.ModelPay.Pay(e)}else this.LayerShowTip.SetData({context:"\u4eca\u5929\u5c0f\u9b3c\u4eec\u90fd\u7d2f\u4e86\uff0c\u8bf7\u660e\u5929\u518d\u6765\u5427~"}),this.LayerShowTip.load()},e.prototype.DrawResult=function(t,e,r){var o=this,n=(o.com,o.ModelMgr.ModelMallSEquip.GetSEquipInfoById(o.mallId));if(o.ModelMgr.ModelMall.GetModuleOpenStateById(o.mallId)&&r==n.type)if(t){var i=o.ModelMgr.ModelMallSEquip.GetSEquipBuyCount(o.mallId,n.id),l={refInfo:n,drawType:o.nowDrawType,drawCount:i,mallId:s.MallModule.SEquip,isCanTenDraw:!0,drawIcon:n.drawIcon};o.LayerMallDrawDisplay.SetGoodsList(e),o.LayerMallDrawDisplay.SetDrawInfo(l),o.LayerMallDrawDisplay.isLoad?o.LayerMallDrawDisplay.ui.OnUpdate():o.LayerMallDrawDisplay.load()}else o.LayerShowTip.SetData({context:a.FW.G_W("\u62bd\u53d6\u5956\u52b1\u5931\u8d25\u4e86~\u4e0d\u8981\u6c14\u9981\u518d\u8bd5\u8bd5\u3002")}),o.LayerShowTip.load()},e.__cname="MallModuleSEquip",i([l.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([l.injectField("LayerShowTip")],e.prototype,"LayerShowTip",void 0),i([l.injectField("LayerItemDetail")],e.prototype,"LayerItemDetail",void 0),i([l.injectField("LayerMallDrawDisplay")],e.prototype,"LayerMallDrawDisplay",void 0),i([l.injectField("LayerMallChestDetails")],e.prototype,"LayerMallChestDetails",void 0),e}(f.MallModuleBase);r.MallModuleSEquip=y,cc._RF.pop()},{"../../../../../framework/FW":void 0,"../../../../../framework/container/Container":void 0,"../../../model/mall/ModelMall":"ModelMall","../../../model/pay/DrawPayObj":"DrawPayObj","../LayerItemDetail":"LayerItemDetail","./CtrlMall":"CtrlMall","./MallModuleBase":"MallModuleBase","./TabMall":"TabMall"}],MathUtil:[function(t,e,r){"use strict";cc._RF.push(e,"71ca15YzZ1MKougqLrhw3LK","MathUtil"),Object.defineProperty(r,"__esModule",{value:!0}),r.MathUtil=void 0;var o,n,i,a,l,s=(o=function(t,e){return t+Math.floor(Math.random()*(e-t+1))},n=function(t,e){for(var r=t.length,n=0;n<r;n++)e(t,n,o(n,r-1))},i=function(t,e,r,o){if(e>=r)return t;for(var n=t[e],a=e,l=r+1,s=e+1;s<l;)t[s]<n?(o(t,s,a+1),a++,s++):t[s]>n?(o(t,s,l-1),l--):s++;return o(t,a,e),i(t,e,a-1,o),i(t,l,r,o),t},a=function(t,e,r){var o=t[e];t[e]=t[r],t[r]=o},{sortArray:l=function(t,e){var r=e?function(t,r,o){a(t,r,o),e(t,r,o)}:a;return n(t,r),i(t,0,t.length-1,r)},sortFunction:function(t,e){var r=t.map(function(t){return e(t)});return l(r,function(e,r,o){a(t,r,o)})}}),c=function(){function t(){}return t.GetRand=function(t,e,r){void 0===r&&(r=1);var o=e-t,n=Math.random(),i=null;return 1==r?i=Math.round:2==r?i=Math.floor:3==r&&(i=Math.ceil),t+i(n*o)},t.quickSort=s.sortArray,t.quickSort2=s.sortFunction,t}();r.MathUtil=c,cc._RF.pop()},{}],ModelAccount:[function(t,e,r){"use strict";cc._RF.push(e,"7e13a9/A65EFa28rb2wc9BV","ModelAccount");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.ModelAccount=void 0;var s=t("../../../../engine/EngineMain"),c=t("../../../../framework/container/Container"),u=t("../../../../framework/FW"),p=t("../../../../framework/utils/PromiseWrap"),f=t("../ModelBehavior"),h=t("../public/AppCustomData"),y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),Object.defineProperty(e.prototype,"account",{get:function(){var t=this._account;if(null==t){var e=s.EngineMain.readLocalStorage("account_num"),r=s.EngineMain.readLocalStorage("password_num");null!=e&&((t={}).account_num=e,t.password_num=r,this._account=t)}return t},enumerable:!1,configurable:!0}),e.prototype.setUserInfo=function(t){this.userInfo=t},e.prototype.setActionlogin=function(t){this.roleInfo=t},e.prototype.getRoleInfo=function(){return this.roleInfo?this.roleInfo:null},e.prototype.getServerAddress=function(){return this.roleInfo?this.roleInfo.serverAddress:null},e.prototype.getUserInfo=function(){return this.userInfo?this.userInfo:null},e.prototype.getAccount=function(){return this.account?this.account.account_num:""},e.prototype.getPassword=function(){return this.account?this.account.password_num:""},e.prototype.getRoleId=function(){return this.roleInfo?this.roleInfo.roleId:""},e.prototype.SendDeleteAccount_cor=function(){return a(this,void 0,void 0,function(){var t,e,r;return l(this,function(){return t=this.ModelPublicData.getDeleteUrl(),e={platform:h.AppCustomData.instance.channelCode,code:this.account.account_num},r=new p.PromiseWrap,u.FW.Http.get(t,e,null,!0).then(function(t){u.FW.ZJJ.log("\u5220\u9664\u7ed3\u679c",t),r.resolve()}).catch(function(t){t&&u.FW.ZJJ.error(t),r.resolve()}),[2]})})},e.__cname="ModelAccount",i([c.injectField("ModelPublicData")],e.prototype,"ModelPublicData",void 0),i([c.injectField("AppCustomData")],e.prototype,"AppCustomData",void 0),e}(f.ModelBehavior);r.ModelAccount=y,cc._RF.pop()},{"../../../../engine/EngineMain":void 0,"../../../../framework/FW":void 0,"../../../../framework/container/Container":void 0,"../../../../framework/utils/PromiseWrap":void 0,"../ModelBehavior":"ModelBehavior","../public/AppCustomData":"AppCustomData"}],ModelActivity:[function(t,e,r){"use strict";cc._RF.push(e,"b396dDWle9HSYz3YhtQ5x0A","ModelActivity");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},l=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},s=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.ModelActivity=r.EnumActivityKind=void 0;var c,u=t("../../../../framework/container/Container"),p=t("../../../../framework/event/EventProxy"),f=t("../../../../framework/utils/Toolset"),h=t("../../ctrl/Activity/ActivityObjectList"),y=t("../../ctrl/Activity/ActivityObjectSubset"),d=t("../ModelBehavior");(function(t){t[t.SevenDay=1001]="SevenDay",t[t.EveryDay=1002]="EveryDay",t[t.NewPlayerSign=1003]="NewPlayerSign"})(c=r.EnumActivityKind||(r.EnumActivityKind={}));var m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tmAOList=new Map,e.eventProxy=new p.EventProxy,e.tmSubset=new Map,e}return n(e,t),e.prototype.enter=function(){return i(this,void 0,Promise,function(){var t,e,r,o,n,i,u=this;return a(this,function(){this.toolSet||(this.toolSet=f.ToolSet.createToolSet()),this.CreateAOList(c.SevenDay),this.CreateAOList(c.EveryDay),this.CreateAOList(c.NewPlayerSign);try{for(t=l(this.tmAOList),e=t.next();!e.done;e=t.next())(r=s(e.value,2))[0],(o=r[1]).EnterWrap(),this.toolSet.addListener(o.eventProxy,"OnAdd",function(t){u.eventProxy.execute("OnAdd",t)}),this.toolSet.addListener(o.eventProxy,"OnUpdate",function(t){u.eventProxy.execute("OnUpdate",t)}),this.toolSet.addListener(o.eventProxy,"OnRemove",function(t){u.eventProxy.execute("OnRemove",t)})}catch(a){n={error:a}}finally{try{e&&!e.done&&(i=t.return)&&i.call(t)}finally{if(n)throw n.error}}return this.toolSet.addTimer(.3,function(){var t,e;try{for(var r=l(u.tmSubset),o=r.next();!o.done;o=r.next()){var n=s(o.value,2),i=n[0];n[1],i.OnTimerUpdate()}}catch(a){t={error:a}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}}),[2,null]})})},e.prototype.exit=function(){var t,e;try{for(var r=l(this.tmAOList),o=r.next();!o.done;o=r.next()){var n=s(o.value,2);n[0],n[1].ExitWrap()}}catch(i){t={error:i}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}return f.ToolSet.destroyToolSet(this.toolSet),this.toolSet=null,null},e.prototype.CreateAOList=function(t){var e=this.tmAOList.get(t);return null==e&&((e=new h.ActivityObjectList).InitEnumKind(t),this.tmAOList.set(t,e),u.Container.inst().inject(e)),e},e.prototype.CreateSubset=function(){var t=this,e=new y.ActivityObjectSubset;return e.Init(this.tmAOList,this.eventProxy),this.tmSubset.set(e,e),e.SetDisposeCallback(function(){t.tmSubset.set(e,null)}),e},e.prototype.DestroySubset=function(t){null!=this.tmSubset.get(t)&&t.destroy()},e.prototype.GetTlAo=function(t,e){var r,o,n=[],i=function(e){return(!t||t(e))&&n.push(e),!1};do{if(e&&(u=this.tmAOList.get(e))){u.ActivityObjectFilter(i);break}try{for(var a=(r=void 0,l(this.tmAOList)),c=a.next();!c.done;c=a.next()){var u,p=s(c.value,2);p[0],(u=p[1]).ActivityObjectFilter(i)}}catch(f){r={error:f}}finally{try{c&&!c.done&&(o=a.return)&&o.call(a)}finally{if(r)throw r.error}}}while(0);return n},e.__cname="ModelActivity",e}(d.ModelBehavior);r.ModelActivity=m,cc._RF.pop()},{"../../../../framework/container/Container":void 0,"../../../../framework/event/EventProxy":void 0,"../../../../framework/utils/Toolset":void 0,"../../ctrl/Activity/ActivityObjectList":"ActivityObjectList","../../ctrl/Activity/ActivityObjectSubset":"ActivityObjectSubset","../ModelBehavior":"ModelBehavior"}],ModelAttr:[function(t,e,r){"use strict";cc._RF.push(e,"c6042qB3ONHbYNcYeGDJ8Iz","ModelAttr");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.ModelAttr=void 0;var s=t("../../../../framework/container/Container"),c=t("../../../../framework/FW"),u=t("../../../ref/RefroleAttribute"),p=t("../../../ref/RefWrap"),f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),Object.defineProperty(e.prototype,"RefAttr",{get:function(){return this.Ref.RefMgrroleAttribute},enumerable:!1,configurable:!0}),e.prototype.enter=function(){return a(this,void 0,Promise,function(){var t,e;return l(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),t=[],[4,Promise.all(t)];case 1:return r.sent(),this.tmRefRoleAttribute=p.RefWrap.Create(this.RefAttr,u.RefroleAttribute,"refId"),[3,3];case 2:return e=r.sent(),c.FW.LWX.error("\u5c5e\u6027\u914d\u7f6e\u52a0\u8f7d\u9519\u8bef\uff1a"+e),[3,3];case 3:return[2,null]}})})},e.prototype.exit=function(){return null},e.prototype.GetChangeCallback=function(){return this.changeCallback},e.prototype.GetAttributeKeyByResId=function(t){return this.RefAttr.getRefAll().find(function(e){return Number(e.refId)==t}).key},e.prototype.GetRefRoleAttribute=function(t){return this.tmRefRoleAttribute.get(t)},e.__cname="ModelAttr",i([s.injectField("Ref")],e.prototype,"Ref",void 0),e}(t("../ModelBehavior").ModelBehavior);r.ModelAttr=f,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/container/Container":void 0,"../../../ref/RefWrap":"RefWrap","../../../ref/RefroleAttribute":"RefroleAttribute","../ModelBehavior":"ModelBehavior"}],ModelBattleDrop:[function(t,e,r){"use strict";cc._RF.push(e,"0a09fQYHw9Px54y4myFhviJ","ModelBattleDrop");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.ModelBattleDrop=r.BattleEquipDrawingType=void 0;var c=t("../../../../../framework/container/Container"),u=t("../../../../ref/RefBattleBoxDropPlan"),p=t("../../../../ref/RefBattleChestRewardRef"),f=t("../../../../ref/RefBattleDropConfig"),h=t("../../../../ref/RefBattleDropPlan"),y=t("../../../../ref/RefBattleSkillChest"),d=t("../../../../ref/RefWrap"),m=t("../../../model/ModelBehavior");(function(t){t[t.kill=1]="kill",t[t.killBoss=2]="killBoss",t[t.point=3]="point"})(r.BattleEquipDrawingType||(r.BattleEquipDrawingType={}));var v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tmSkillChest=new Map,e.tmChestReward=new Map,e.tmDropPlan=new Map,e.tmBattleDropConfig=new Map,e._GetTlDropPlan=[],e._GetEquipDrawing=[],e}return n(e,t),Object.defineProperty(e.prototype,"RefChest",{get:function(){return this.Ref.RefMgrbattleChestRef},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"RefSkillChest",{get:function(){return this.Ref.RefMgrbattleSkillChestRef},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"RefDrop",{get:function(){return this.Ref.RefMgrbattleDropRef},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"RefDropPlan",{get:function(){return this.Ref.RefMgrbattleDropPlanRef},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"RefReward",{get:function(){return this.Ref.RefMgrbattleChestRewardRef},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"RefEquipDrawing",{get:function(){return this.Ref.RefMgrbattleEquipDrawingRef},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"RefBattleDropConfig",{get:function(){return this.Ref.RefMgrbattleDropConfig},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"RefBattleBoxDropPlan",{get:function(){return this.Ref.RefMgrbattleBoxDropPlan},enumerable:!1,configurable:!0}),e.prototype.enter=function(){return a(this,void 0,Promise,function(){var t,e,r,o,n,i,a,c,m;return l(this,function(l){switch(l.label){case 0:return(t=[]).push(this.RefChest.preloadRef()),t.push(this.RefSkillChest.preloadRef()),t.push(this.RefDrop.preloadRef()),t.push(this.RefDropPlan.preloadRef()),t.push(this.RefReward.preloadRef()),t.push(this.RefEquipDrawing.preloadRef()),t.push(this.RefBattleDropConfig.preloadRef()),t.push(this.RefBattleBoxDropPlan.preloadRef()),[4,Promise.all(t)];case 1:l.sent(),e=y.RefBattleSkillChest,r=this.tmSkillChest;try{for(o=s(this.RefSkillChest.getRefAll()),n=o.next();!n.done;n=o.next())i=n.value,(a=new e).Setup(i),r.set(i.id,a)}catch(v){c={error:v}}finally{try{n&&!n.done&&(m=o.return)&&m.call(o)}finally{if(c)throw c.error}}return this.tmChestReward=d.RefWrap.Create(this.RefReward,p.RefBattleChestRewardRef,"id"),this.tmDropPlan=d.RefWrap.Create(this.RefDropPlan,h.RefBattleDropPlan,"id"),this.tmBattleDropConfig=d.RefWrap.Create(this.RefBattleDropConfig,f.RefBattleDropConfig,"id"),this.tmBattleBoxDropPlan=d.RefWrap.Create(this.RefBattleBoxDropPlan,u.RefBattleBoxDropPlan,"id"),[2]}})})},e.prototype.GetDrop=function(t){try{var e=this.RefDrop.getRef("id",t);return this.assert(null!=e,"battleDropRef \u4e0d\u5b58\u5728:",t),e}catch(r){}},e.prototype.GetGoldChest=function(t){var e=this.RefChest.getRef("id",t);return this.assert(null!=e,"RefbattleChestRef \u4e0d\u5b58\u5728:",t),e},e.prototype.GetReward=function(t){var e=this.tmChestReward.get(t);return this.assert(null!=e,"RefChestReward \u4e0d\u5b58\u5728:",t),e},e.prototype.GetDropPlan=function(t){return this.tmDropPlan.get(t)},e.prototype.GetDropPlanBy=function(t,e){for(var r=this.Ref.RefMgrfuBenRef.getRef("resId",t),o=this.RefDropPlan.getTlRef("group",r.dropId),n=o.length-1;n>=0;n--)if(e>=o[n].point)return this.GetDropPlan(o[n].id)},e.prototype.GetTlDropPlan=function(t){var e,r,o=this._GetTlDropPlan;o.length=0;var n=this.Ref.RefMgrfuBenRef.getRef("resId",t),i=this.RefDropPlan.getTlRef("group",n.dropId);try{for(var a=s(i),l=a.next();!l.done;l=a.next()){var c=l.value;o.push(this.GetDropPlan(c.id))}}catch(u){e={error:u}}finally{try{l&&!l.done&&(r=a.return)&&r.call(a)}finally{if(e)throw e.error}}return o},e.prototype.GetSkillChest=function(t){var e=this;return this.RefSkillChest.getTlRef("group",t).map(function(t){return e.tmSkillChest.get(t.id)})},e.prototype.GetEquipDrawing=function(t){var e,r,o=this._GetEquipDrawing;o.length=0;var n=this.ModelFuben.GetFubenRefByResId(t);if(n)try{for(var i=s(n.drawingDrop),a=i.next();!a.done;a=i.next()){var l=a.value,c=this.RefEquipDrawing.getRef("id",l);this.CheckEquipDrawingCondiction(c)&&o.push(c)}}catch(u){e={error:u}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return o},e.prototype.CheckEquipDrawingCondiction=function(t){var e=!0;switch(t.condictionType){case 1:e=this.handlerCondictionBroken(t.condictionValue)}return e},e.prototype.handlerCondictionBroken=function(t){return this.ModelRole.GetHasBreach(t)},e.prototype.GetAllEquipDrawingByFuben=function(t){var e=this;return this.ModelFuben.GetFubenRefByResId(t).drawingDrop.map(function(t){return e.RefEquipDrawing.getRef("id",t)})},e.prototype.GetStartDropConfig=function(){var t=this.RefBattleDropConfig.getRefAll()[0];return this.tmBattleDropConfig.get(t.id)},e.prototype.GetBoxDropPlan=function(t){return this.tmBattleBoxDropPlan.get(t)},e.__cname="ModelBattleDrop",i([c.injectField("Ref")],e.prototype,"Ref",void 0),i([c.injectField("ModelFuben")],e.prototype,"ModelFuben",void 0),i([c.injectField("ModelRole")],e.prototype,"ModelRole",void 0),e}(m.ModelBehavior);r.ModelBattleDrop=v,cc._RF.pop()},{"../../../../../framework/container/Container":void 0,"../../../../ref/RefBattleBoxDropPlan":"RefBattleBoxDropPlan","../../../../ref/RefBattleChestRewardRef":"RefBattleChestRewardRef","../../../../ref/RefBattleDropConfig":"RefBattleDropConfig","../../../../ref/RefBattleDropPlan":"RefBattleDropPlan","../../../../ref/RefBattleSkillChest":"RefBattleSkillChest","../../../../ref/RefWrap":"RefWrap","../../../model/ModelBehavior":"ModelBehavior"}],ModelBattleLevel:[function(t,e,r){"use strict";cc._RF.push(e,"3ad8fFDcKhPwrb/4mejxj23","ModelBattleLevel");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.ModelBattleLevel=void 0;var s=t("../../../../../framework/container/Container"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),Object.defineProperty(e.prototype,"RefLevel",{get:function(){return this.Ref.RefMgrbattleLevelRef},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"RefMap",{get:function(){return this.Ref.RefMgrmapRef},enumerable:!1,configurable:!0}),e.prototype.enter=function(){return a(this,void 0,Promise,function(){var t;return l(this,function(e){switch(e.label){case 0:return(t=[]).push(this.RefLevel.preloadRef()),t.push(this.RefMap.preloadRef()),[4,Promise.all(t)];case 1:return e.sent(),this.initRefLevel(),[2]}})})},e.prototype.initRefLevel=function(){var t=this.RefLevel.getRefAll();this.maxLevel=t[t.length-1].level},e.prototype.isMaxLevel=function(t){return t>=this.maxLevel},e.prototype.getNextExp=function(t){var e=t+1,r=this.RefLevel.getRef("level",e),o=r&&r.exp;return o||0},e.__cname="ModelBattleLevel",i([s.injectField("Ref")],e.prototype,"Ref",void 0),e}(t("../../../model/ModelBehavior").ModelBehavior);r.ModelBattleLevel=c,cc._RF.pop()},{"../../../../../framework/container/Container":void 0,"../../../model/ModelBehavior":"ModelBehavior"}],ModelBattleSkill:[function(t,e,r){"use strict";cc._RF.push(e,"e7a1fXUFg1HF5GPv6n0Yx5w","ModelBattleSkill");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},c=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.ModelBattleSkill=void 0;var u=t("../../../../../framework/container/Container"),p=t("../../../../ref/RefBattleBullet"),f=t("../../../../ref/RefBattleBulletTagCollision"),h=t("../../../../ref/RefBattleSkill"),y=t("../../../../ref/RefBattleSkillEvolution"),d=t("../../../../ref/RefBattleSkillLevel"),m=t("../../../../ref/RefBattleSkillMonster"),v=t("../../../../ref/RefBattleSkillTypeMonster"),_=t("../../../../ref/RefBattleSupply"),S=t("../../../../ref/RefBattleSupplyLevel"),g=t("../../../../ref/RefWrap"),b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tmBullet=new Map,e}return n(e,t),Object.defineProperty(e.prototype,"RefSkill",{get:function(){return this.Ref.RefMgrbattleSkillRef},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"RefSkillLevel",{get:function(){return this.Ref.RefMgrbattleSkillLevel},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"RefSkillMonster",{get:function(){return this.Ref.RefMgrbattleSkillMonster},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"RefSkillTypeMonster",{get:function(){return this.Ref.RefMgrbattleSkillTypeMonster},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"RefLauncher",{get:function(){return this.Ref.RefMgrbattleLauncher},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"RefBullet",{get:function(){return this.Ref.RefMgrbattleBullet},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"RefBulletTagCollision",{get:function(){return this.Ref.RefMgrbattleBulletTagCollision},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"RefSupply",{get:function(){return this.Ref.RefMgrbattleSupplyRef},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"RefSupplyLevel",{get:function(){return this.Ref.RefMgrbattleSupplyLevelRef},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"RefSkillEvolution",{get:function(){return this.Ref.RefMgrbattleSkillEvolutionRef},enumerable:!1,configurable:!0}),e.prototype.enter=function(){return a(this,void 0,Promise,function(){var t;return l(this,function(e){switch(e.label){case 0:return(t=[]).push(this.RefSkill.preloadRef()),t.push(this.RefSkillLevel.preloadRef()),t.push(this.RefSkillMonster.preloadRef()),t.push(this.RefSkillTypeMonster.preloadRef()),t.push(this.RefLauncher.preloadRef()),t.push(this.RefBullet.preloadRef()),t.push(this.RefBulletTagCollision.preloadRef()),t.push(this.RefSupply.preloadRef()),t.push(this.RefSupplyLevel.preloadRef()),t.push(this.RefSkillEvolution.preloadRef()),[4,Promise.all(t)];case 1:return e.sent(),this.initRef(),[2]}})})},e.prototype.exit=function(){return a(this,void 0,Promise,function(){return l(this,function(){return[2,null]})})},e.prototype.initRef=function(){var t,e,r,o,n,i,a,l,u,b,C,R,M,w,O,B,P,G;this.tmSkill=g.RefWrap.Create(this.RefSkill,h.RefBattleSkill,"resId"),this.tmSupply=g.RefWrap.Create(this.RefSupply,_.RefBattleSupply,"resId"),this.tmEvolution=g.RefWrap.Create(this.RefSkillEvolution,y.RefBattleSkillEvolution,"id"),this.tmSkillMonster=g.RefWrap.Create(this.RefSkillMonster,m.RefBattleSkillMonster,"id"),this.tmSkillTypeMonster=g.RefWrap.Create(this.RefSkillTypeMonster,v.RefBattleSkillTypeMonster,"resId"),this.tmBulletTagCollision=g.RefWrap.Create(this.RefBulletTagCollision,f.RefBattleBulletTagCollision,"id");var k=this.tmSkill2Evolutiom=new Map;try{for(var x=s(this.tmEvolution),T=x.next();!T.done;T=x.next()){var j=c(T.value,2),I=(j[0],j[1]);k.set(I.GetSkillId(),I)}}catch(it){t={error:it}}finally{try{T&&!T.done&&(e=x.return)&&e.call(x)}finally{if(t)throw t.error}}this.tmSkillLevel=new Map;var D=this.tmSkillLevel;try{for(var F=s(this.RefSkillLevel.getRefAll()),L=F.next();!L.done;L=F.next()){var E=L.value,A=D.get(E.skillId);null==A&&(A=new Map,D.set(E.skillId,A)),(nt=new d.RefBattleSkillLevel).Setup(E),A.set(E.level,nt)}}catch(at){r={error:at}}finally{try{L&&!L.done&&(o=F.return)&&o.call(F)}finally{if(r)throw r.error}}var V=this.tmSkillLevelList=new Map;try{for(var U=s(this.RefSkillLevel.getRefAll()),W=U.next();!W.done;W=U.next())E=W.value,null==(q=V.get(E.skillId))&&(q=[],V.set(E.skillId,q)),q.push(E.level)}catch(lt){n={error:lt}}finally{try{W&&!W.done&&(i=U.return)&&i.call(U)}finally{if(n)throw n.error}}try{for(var H=s(V),N=H.next();!N.done;N=H.next()){var q;(q=N.value).sort()}}catch(st){a={error:st}}finally{try{N&&!N.done&&(l=H.return)&&l.call(H)}finally{if(a)throw a.error}}this.tmSupplyLevel=g.RefWrap.Create(this.RefSupplyLevel,S.RefBattleSupplyLevel,"passivityId"),this.tmSupply2Compaer=new Map,k=this.tmSupply2Compaer;try{for(var K=s(this.RefSupply.getRefAll()),X=K.next();!X.done;X=K.next())E=X.value,k.set(E.resId,new Set)}catch(ct){u={error:ct}}finally{try{X&&!X.done&&(b=K.return)&&b.call(K)}finally{if(u)throw u.error}}try{for(var z=s(this.RefSkillEvolution.getRefAll()),J=z.next();!J.done;J=z.next()){I=E=J.value;try{for(var Y=(M=void 0,s(I.need)),Z=Y.next();!Z.done;Z=Y.next()){var Q=Z.value;try{for(var $=(O=void 0,s(I.need)),tt=$.next();!tt.done;tt=$.next()){var et=tt.value;Q!=et&&k.has(Q.resId)&&k.get(Q.resId).add(et.resId)}}catch(ut){O={error:ut}}finally{try{tt&&!tt.done&&(B=$.return)&&B.call($)}finally{if(O)throw O.error}}}}catch(pt){M={error:pt}}finally{try{Z&&!Z.done&&(w=Y.return)&&w.call(Y)}finally{if(M)throw M.error}}}}catch(ft){C={error:ft}}finally{try{J&&!J.done&&(R=z.return)&&R.call(z)}finally{if(C)throw C.error}}try{for(var rt=s(this.RefBullet.getRefAll()),ot=rt.next();!ot.done;ot=rt.next()){var nt;I=ot.value,(nt=new p.RefBattleBullet).Setup(I),this.tmBullet.set(I.id,nt)}}catch(ht){P={error:ht}}finally{try{ot&&!ot.done&&(G=rt.return)&&G.call(rt)}finally{if(P)throw P.error}}},e.prototype.GetSkill=function(t){return this.tmSkill.get(t)},e.prototype.FindSkillLevel=function(t,e){var r=this.tmSkillLevel.get(t);this.assert(null!=r,"\u914d\u7f6e\u8868\u672a\u914d\u7f6e\u6280\u80fd:"+t);var o=r.get(e);return this.assert(null!=o,"\u914d\u7f6e\u8868\u672a\u914d\u7f6e\u6280\u80fd\u7b49\u7ea7:"+t+"-"+e),o},e.prototype.IsSkillValid=function(t,e){if(null==t)return!1;if(0==this.GetIsSkill(t))return!1;var r=this.tmSkillLevel.get(t);return this.assert(null!=r,"\u914d\u7f6e\u8868\u672a\u914d\u7f6e\u6280\u80fd:"+t),r.has(e)},e.prototype.GetSupply=function(t){return this.tmSupply.get(t)},e.prototype.FindSupplyLevel=function(t){return this.tmSupplyLevel.get(t)},e.prototype.FindSupplyCompare=function(t){return this.tmSupply2Compaer.get(t)},e.prototype.IsSupplyValid=function(t,e){var r=this.tmSupplyLevel.get(t);return this.assert(null!=r,"\u914d\u7f6e\u8868\u672a\u914d\u7f6e\u8865\u7ed9:"+t),!!r&&null!=r.GetBuff()[e-1]},e.prototype.GetBullet=function(t){var e=this.tmBullet.get(t);return this.assert(null!=e,"\u5b50\u5f39\u4e0d\u5b58\u5728\uff0c\u8bf7\u7b56\u5212\u68c0\u67e5 battleBullet.json id:",t),e},e.prototype.GetSkillOrSupply=function(t){return this.GetIsSkill(t)?this.GetSkill(t):this.GetIsSupply(t)?this.GetSupply(t):void 0},e.prototype.GetIsSkill=function(t){return 1e4<=t&&t<2e4},e.prototype.GetIsSupply=function(t){return 1e3<=t&&t<2e3},e.prototype.GetEvolutionBySkill=function(t){return this.tmSkill2Evolutiom.get(t)},e.prototype.GetEvolution=function(t){return this.tmEvolution.get(t)},e.prototype.GetTmEvolution=function(){return this.tmEvolution},e.prototype.GetSkillMonster=function(t){return this.tmSkillMonster.get(t)},e.prototype.GetSkillTypeMonster=function(t){return this.tmSkillTypeMonster.get(t)},e.prototype.GetTmSkillMonster=function(){return this.tmSkillMonster},e.prototype.GetSkillMinLevel=function(t){var e=this.tmSkillLevelList.get(t);return this.assert(null!=e,"\u6280\u80fd\u4e0d\u5b58\u5728:"+t),e[0]},e.prototype.GetBulletTagCollision=function(t){return this.tmBulletTagCollision.get(t)},e.prototype.GetBulletCanCollision=function(t,e){var r,o,n,i,a=!1;try{t:for(var l=s(t),c=l.next();!c.done;c=l.next()){var u=c.value;try{for(var p=(n=void 0,s(e)),f=p.next();!f.done;f=p.next()){var h=f.value,y=this.GetBulletTagCollision(u);if(y&&(a=y.HasTag(h)))break t}}catch(d){n={error:d}}finally{try{f&&!f.done&&(i=p.return)&&i.call(p)}finally{if(n)throw n.error}}}}catch(m){r={error:m}}finally{try{c&&!c.done&&(o=l.return)&&o.call(l)}finally{if(r)throw r.error}}return a},e.__cname="ModelBattleSkill",i([u.injectField("Ref")],e.prototype,"Ref",void 0),e}(t("../../../model/ModelBehavior").ModelBehavior);r.ModelBattleSkill=b,cc._RF.pop()},{"../../../../../framework/container/Container":void 0,"../../../../ref/RefBattleBullet":"RefBattleBullet","../../../../ref/RefBattleBulletTagCollision":"RefBattleBulletTagCollision","../../../../ref/RefBattleSkill":"RefBattleSkill","../../../../ref/RefBattleSkillEvolution":"RefBattleSkillEvolution","../../../../ref/RefBattleSkillLevel":"RefBattleSkillLevel","../../../../ref/RefBattleSkillMonster":"RefBattleSkillMonster","../../../../ref/RefBattleSkillTypeMonster":"RefBattleSkillTypeMonster","../../../../ref/RefBattleSupply":"RefBattleSupply","../../../../ref/RefBattleSupplyLevel":"RefBattleSupplyLevel","../../../../ref/RefWrap":"RefWrap","../../../model/ModelBehavior":"ModelBehavior"}],ModelBattleStatus:[function(t,e,r){"use strict";cc._RF.push(e,"1f389n3tN9GN6LsmwZGmmam","ModelBattleStatus");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.ModelBattleStatus=void 0;var s=t("../../../../../framework/container/Container"),c=t("../../../../ref/RefBattleStatusIcon"),u=t("../../../../ref/RefWrap"),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tmStatusIcon=new Map,e}return n(e,t),Object.defineProperty(e.prototype,"RefBattleStatusIcon",{get:function(){return this.Ref.RefMgrBattleStatusIcon},enumerable:!1,configurable:!0}),e.prototype.enter=function(){return a(this,void 0,Promise,function(){var t;return l(this,function(e){switch(e.label){case 0:return(t=[]).push(this.RefBattleStatusIcon.preloadRef()),[4,Promise.all(t)];case 1:return e.sent(),this.tmStatusIcon=u.RefWrap.Create(this.RefBattleStatusIcon,c.RefBattleStatusIcon,"key"),[2]}})})},e.prototype.GetStatusIcon=function(t){return this.tmStatusIcon.get(t)},e.__cname="ModelBattleStatus",i([s.injectField("Ref")],e.prototype,"Ref",void 0),e}(t("../../../model/ModelBehavior").ModelBehavior);r.ModelBattleStatus=p,cc._RF.pop()},{"../../../../../framework/container/Container":void 0,"../../../../ref/RefBattleStatusIcon":"RefBattleStatusIcon","../../../../ref/RefWrap":"RefWrap","../../../model/ModelBehavior":"ModelBehavior"}],ModelBattleWave:[function(t,e,r){"use strict";cc._RF.push(e,"9b3e5jR0MtAFoFdG1WTunpf","ModelBattleWave");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.ModelBattleWave=r.EMonsterBehavior=void 0;var c=t("../../../../../framework/container/Container"),u=t("../../../../ref/RefBattleMonster"),p=t("../../../../ref/RefBattleMonsterBehavior"),f=t("../../../../ref/RefBattleWaveType"),h=t("../../../../ref/RefWaveNum"),y=t("../../../../ref/RefWrap"),d=t("../../../model/ModelBehavior");(function(t){t[t.SEEK=1]="SEEK",t[t.STATIC=2]="STATIC",t[t.WANDER_UPDOWN=3]="WANDER_UPDOWN",t[t.KEEP=4]="KEEP",t[t.WANDER=5]="WANDER",t[t.CHARGE=6]="CHARGE",t[t.CHARGE_LEAVE=7]="CHARGE_LEAVE",t[t.SELF_BOOM=8]="SELF_BOOM",t[t.BT_CHARGE=100]="BT_CHARGE",t[t.BT_REMOTE=101]="BT_REMOTE",t[t.BT_STATIC=102]="BT_STATIC"})(r.EMonsterBehavior||(r.EMonsterBehavior={}));var m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tmMonster=new Map,e.tmMonsterBehavior=new Map,e.tmWave2Total=new Map,e.tmWaveNum=new Map,e.tmWaveType=new Map,e}return n(e,t),Object.defineProperty(e.prototype,"RefMonster",{get:function(){return this.Ref.RefMgrbattleMonsterRef},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"RefMonsterBehavior",{get:function(){return this.Ref.RefMgrbattleMonsterBehavior},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"RefWave",{get:function(){return this.Ref.RefMgrbattleWaveRef},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"RefWavePlan",{get:function(){return this.Ref.RefMgrbattleWavePlanRef},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"RefWaveNum",{get:function(){return this.Ref.RefMgrbattleWaveNumRef},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"RefWaveType",{get:function(){return this.Ref.RefMgrbattleWaveType},enumerable:!1,configurable:!0}),e.prototype.enter=function(){return a(this,void 0,Promise,function(){var t,e,r,o,n,i,a,c,d,m,v,_,S,g,b,C,R,M,w,O;return l(this,function(l){switch(l.label){case 0:return(t=[]).push(this.RefMonster.preloadRef()),t.push(this.RefMonsterBehavior.preloadRef()),t.push(this.RefWave.preloadRef()),t.push(this.RefWavePlan.preloadRef()),t.push(this.RefWaveNum.preloadRef()),t.push(this.RefWaveType.preloadRef()),[4,Promise.all(t)];case 1:l.sent();try{for(e=s(this.RefMonster.getRefAll()),r=e.next();!r.done;r=e.next())a=r.value,(o=new u.RefBattleMonster).Setup(a),this.tmMonster.set(a.resId,o)}catch(B){b={error:B}}finally{try{r&&!r.done&&(C=e.return)&&C.call(e)}finally{if(b)throw b.error}}try{for(n=s(this.RefWave.getRefAll()),i=n.next();!i.done;i=n.next()){a=i.value,c=a.id,d=a.wavePlanId,m=0,v=this.RefWaveNum.getTlRef("groupId",d),this.assert(null!=v,"\u5237\u602a\u7ec4id\u4e0d\u5b58\u5728 ",d);try{for(w=void 0,_=s(v),S=_.next();!S.done;S=_.next())g=S.value,m=Math.max(m,g.point)}catch(P){w={error:P}}finally{try{S&&!S.done&&(O=_.return)&&O.call(_)}finally{if(w)throw w.error}}this.tmWave2Total.set(c,m)}}catch(G){R={error:G}}finally{try{i&&!i.done&&(M=n.return)&&M.call(n)}finally{if(R)throw R.error}}return this.tmWaveNum=y.RefWrap.Create(this.RefWaveNum,h.RefWaveNum,"id"),this.tmWaveType=y.RefWrap.Create(this.RefWaveType,f.RefBattleWaveType,"id"),this.tmMonsterBehavior=y.RefWrap.Create(this.RefMonsterBehavior,p.RefBattleMonsterBehavior,"resId"),[2]}})})},e.prototype.GetMonster=function(t){return this.tmMonster.get(t)},e.prototype.GetMonsterBy=function(t,e){var r,o=this.GetWave(t).monster[e];return null!=o&&(r=this.GetMonster(o)),r},e.prototype.GetWave=function(t){return this.RefWave.getRef("id",t)},e.prototype.GetWavePlan=function(t){return this.RefWavePlan.getRef("id",t)},e.prototype.GetWaveNums=function(t){var e=this;return this.RefWaveNum.getTlRef("groupId",t).map(function(t){return e.tmWaveNum.get(t.id)})},e.prototype.GetTotalTime=function(t){return this.tmWave2Total.get(t)},e.prototype.FixPointTime=function(t,e){var r=this.GetTotalTime(t);return Math.max(0,Math.min(e,r))},e.prototype.GetWaveType=function(t){return this.tmWaveType.get(t)},e.prototype.GetMonsterBehavior=function(t){return this.tmMonsterBehavior.get(t)},e.__cname="ModelBattleWave",i([c.injectField("Ref")],e.prototype,"Ref",void 0),e}(d.ModelBehavior);r.ModelBattleWave=m,cc._RF.pop()},{"../../../../../framework/container/Container":void 0,"../../../../ref/RefBattleMonster":"RefBattleMonster","../../../../ref/RefBattleMonsterBehavior":"RefBattleMonsterBehavior","../../../../ref/RefBattleWaveType":"RefBattleWaveType","../../../../ref/RefWaveNum":"RefWaveNum","../../../../ref/RefWrap":"RefWrap","../../../model/ModelBehavior":"ModelBehavior"}],ModelBattle:[function(t,e,r){"use strict";cc._RF.push(e,"f65e8v33GhIOrM+/S4Vzd2e","ModelBattle");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.ModelBattle=void 0;var c=t("../../../../framework/container/Container"),u=t("../../../../framework/FW"),p=t("../../../../framework/utils/PromiseWrap"),f=t("../../../../framework/utils/Toolset"),h=t("../../../generated/requestMsg/RequestBattleMsg"),y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.enter=function(){return a(this,void 0,Promise,function(){var t=this;return l(this,function(){return this.toolSet||(this.toolSet=f.ToolSet.createToolSet()),this.toolSet.addListener(this.ModelMgr.ModelVO.VOChapterBag.GetEventProxy(),"OnChanged",function(){t.UpdateUnlockSkillAndSupply()}),[2]})})},e.prototype.exit=function(){return a(this,void 0,Promise,function(){return l(this,function(){return f.ToolSet.destroyToolSet(this.toolSet),this.toolSet=null,this._tlUnlockCommonSkill=null,this._tlUnlockCommonSupply=null,[2]})})},e.prototype.GetRunningBattleData=function(){},e.prototype.GetUnlockCommonSkill=function(){null==this._tlUnlockCommonSkill&&this.UpdateUnlockSkillAndSupply();var t=this._tlUnlockCommonSkill;return null==t&&(u.FW.LWX.error("\u521d\u59cb\u5316\u89e3\u9501\u6b66\u5668\u6280\u80fd\u5931\u8d25\uff0c\u8bf7\u68c0\u67e5\u6b66\u5668\u6280\u80fd\u914d\u7f6e\u8868"),(t=[]).push(10029),t.push(10018),t.push(10027),t.push(10016),t.push(10020),t.push(10033),t.push(10025),t.push(10014),t.push(10010),t.push(10031),t.push(10012),t.push(10023),t.push(10024)),t},e.prototype.GetUnlockCommonSupply=function(){null==this._tlUnlockCommonSupply&&this.UpdateUnlockSkillAndSupply();var t=this._tlUnlockCommonSupply;return null==t&&(u.FW.LWX.error("\u521d\u59cb\u5316\u89e3\u9501\u8865\u7ed9\u5931\u8d25\uff0c\u8bf7\u68c0\u67e5\u8865\u7ed9\u914d\u7f6e\u8868"),(t=[]).push(1001),t.push(1002),t.push(1003),t.push(1004),t.push(1005),t.push(1006),t.push(1007),t.push(1008),t.push(1009),t.push(1010),t.push(1011),t.push(1012)),t},e.prototype.UpdateUnlockSkillAndSupply=function(){var t,e,r,o,n,i,a,l,c,u,p,f,h,y,d=this.Ref.RefMgrbattleSkillRef.getTlRef("isBase",1),m=this.Ref.RefMgrbattleSupplyRef.getTlRef("isBase",1),v=new Set,_=new Set;try{for(var S=s(d),g=S.next();!g.done;g=S.next()){var b=g.value;v.add(b.resId)}}catch(V){t={error:V}}finally{try{g&&!g.done&&(e=S.return)&&e.call(S)}finally{if(t)throw t.error}}try{for(var C=s(m),R=C.next();!R.done;R=C.next())b=R.value,_.add(b.resId)}catch(U){r={error:U}}finally{try{R&&!R.done&&(o=C.return)&&o.call(C)}finally{if(r)throw r.error}}var M=this.ModelMgr.ModelVO.VOChapterBag.GetBagAsArray();try{for(var w=s(M),O=w.next();!O.done;O=w.next()){var B=O.value;if(B.GetIsClearance()){b=B.GetRef();try{for(var P=(a=void 0,s(b.unlockSkill||[])),G=P.next();!G.done;G=P.next()){var k=G.value;v.add(k)}}catch(W){a={error:W}}finally{try{G&&!G.done&&(l=P.return)&&l.call(P)}finally{if(a)throw a.error}}try{for(var x=(c=void 0,s(b.unlockSupply||[])),T=x.next();!T.done;T=x.next()){var j=T.value;_.add(j)}}catch(H){c={error:H}}finally{try{T&&!T.done&&(u=x.return)&&u.call(x)}finally{if(c)throw c.error}}}}}catch(N){n={error:N}}finally{try{O&&!O.done&&(i=w.return)&&i.call(w)}finally{if(n)throw n.error}}if(v.size>0){this._tlUnlockCommonSkill=[];try{for(var I=s(v),D=I.next();!D.done;D=I.next()){var F=D.value;this._tlUnlockCommonSkill.push(F)}}catch(q){p={error:q}}finally{try{D&&!D.done&&(f=I.return)&&f.call(I)}finally{if(p)throw p.error}}}if(_.size>0){this._tlUnlockCommonSupply=[];try{for(var L=s(_),E=L.next();!E.done;E=L.next()){var A=E.value;this._tlUnlockCommonSupply.push(A)}}catch(K){h={error:K}}finally{try{E&&!E.done&&(y=L.return)&&y.call(L)}finally{if(h)throw h.error}}}},e.prototype.GetRunningBuff=function(){},e.prototype.SendReborn=function(t,e){void 0===t&&(t=1),void 0===e&&(e=1);var r=new p.PromiseWrap,o={number:e,type:t},n=function(t){t&&u.FW.ZJJ.error(t),r.resolve(!1)},i=new h.RequestBattleRevive(o,this,function(t){var e=1==t.state;r.resolve(e)},function(t){return n(t)});return this.CtrlGameNet.send(i,!0).catch(function(t){n(t)}),r.promise},e.prototype.GetIsBattleRunning=function(){return this.CtrlBattle.GetIsBattleRunning()},e.__cname="ModelBattle",i([c.injectField("Ref")],e.prototype,"Ref",void 0),i([c.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([c.injectField("CtrlGameNet")],e.prototype,"CtrlGameNet",void 0),i([c.injectField("CtrlBattle")],e.prototype,"CtrlBattle",void 0),e}(t("../ModelBehavior").ModelBehavior);r.ModelBattle=y,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/container/Container":void 0,"../../../../framework/utils/PromiseWrap":void 0,"../../../../framework/utils/Toolset":void 0,"../../../generated/requestMsg/RequestBattleMsg":"RequestBattleMsg","../ModelBehavior":"ModelBehavior"}],ModelBehavior:[function(t,e,r){"use strict";cc._RF.push(e,"15278W6pDVAc7VrpHrDc60T","ModelBehavior");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.ModelBehavior=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.__cname="ModelBehavior",e}(t("../GameBehavior").GameBehavior);r.ModelBehavior=i,cc._RF.pop()},{"../GameBehavior":"GameBehavior"}],ModelBox:[function(t,e,r){"use strict";cc._RF.push(e,"465c9xUxHRJbIW308sRkKIU","ModelBox");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},c=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.ModelBox=void 0;var u=t("../../../../framework/container/Container"),p=t("../../../../framework/FW"),f=t("../../../generated/requestMsg/RequestItemMsg"),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.enter=function(){return a(this,void 0,Promise,function(){return l(this,function(){return this.tmBox||(this.tmBox=this.Ref.RefMgrbox.getRefAll()),this.tmBoxContent||(this.tmBoxContent=this.Ref.RefMgrboxContent.getRefAll()),[2,null]})})},e.prototype.GetBox=function(t){return this.tmBox.find(function(e){return e.resId==t})},e.prototype.GetboxType=function(t){var e=this.GetBox(t);return e?e.boxType:0},e.prototype.GetContent=function(t){var e,r,o=this.tmBoxContent,n=[];try{for(var i=s(o),a=i.next();!a.done;a=i.next()){var l=a.value;l.contentId==t&&n.push(l)}}catch(c){e={error:c}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return n},e.prototype.GetCoinBoxTimes=function(t){var e=this.GetContent(t);return 0!=e.length?e[0].num/60:(p.FW.LWX.error("\u4e0d\u5b58\u5728\u7684\u5b9d\u7bb1id,\u8bf7\u68c0\u67e5+",t),0)},e.prototype.GetAllContent=function(t){var e,r,o=this.GetBox(t).contentIds,n=[];try{for(var i=s(o),a=i.next();!a.done;a=i.next()){var l=a.value,c=this.GetContent(l);n=n.concat(c)}}catch(u){e={error:u}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return n},e.prototype.MapToCmdGoods=function(t){var e,r,o=[];try{for(var n=s(t),i=n.next();!i.done;i=n.next()){var a=c(i.value,2),l=a[0],u=a[1];if(u.number>0){var p={resId:l,number:String(u.number),quality:u.quality};o.push(p)}}}catch(f){e={error:f}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}return o},e.prototype.RequestBox=function(t,e,r){var o,n=this;r&&(o={tlCmdGoods:r});var i={resId:t,number:e,cmdGoodsList:o};this.CtrlMgr.CtrlGameNet.send(new f.RequestItemBoxUse(i,this,function(t){t.tlCmdGoods&&n.CtrlMgr.CtrlAlert.ShowGetReward(t.tlCmdGoods)}))},e.__cname="ModelBox",i([u.injectField("Ref")],e.prototype,"Ref",void 0),i([u.injectField("CtrlMgr")],e.prototype,"CtrlMgr",void 0),e}(t("../ModelBehavior").ModelBehavior);r.ModelBox=h,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/container/Container":void 0,"../../../generated/requestMsg/RequestItemMsg":"RequestItemMsg","../ModelBehavior":"ModelBehavior"}],ModelBreach:[function(t,e,r){"use strict";cc._RF.push(e,"c492eFsQF5GgIL+Kqq5ed+B","ModelBreach");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.ModelBreach=void 0;var l=t("../../../../framework/container/Container"),s=t("../../../../framework/FW"),c=t("../../../generated/requestMsg/RequestBreachMsg"),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetAllBreachAttributeRef=function(){return null==this.tl&&(this.tl=this.Ref.RefMgrbreachAttribute.getRefAll().concat()),this.tl},e.prototype.GetBreachAttributeRef=function(t){return this.Ref.RefMgrbreachAttribute.getRef("resId",t)},e.prototype.GetBreachAttributeRefBySkillId=function(t){if(0!=t)return this.Ref.RefMgrbreachAttribute.getRef("skillId",t)},e.prototype.GetBreachSkillRef=function(t){return this.Ref.RefMgrbreachSkill.getRef("resId",t)},e.prototype.GetBreachAttrsByResId=function(t){var e,r,o=new Map,n=this.Ref.RefMgrbreachAttribute.getRefAll();try{for(var i=a(n),l=i.next();!l.done;l=i.next()){var s=l.value;if(s.resId>t)break;var c=this.ModelMgr.ModelAttr.GetAttributeKeyByResId(s.attributeId),u=0|o.get(c);u+=s.bonus,o.set(c,u)}}catch(p){e={error:p}}finally{try{l&&!l.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return o},e.prototype.GetTlSkillGroupIdByResId=function(t){var e,r,o=[],n=this.Ref.RefMgrbreachSkill.getRefAll();try{for(var i=a(n),l=i.next();!l.done;l=i.next()){var s=l.value;if(s.resId>t)break;o.push(s.buffId)}}catch(c){e={error:c}}finally{try{l&&!l.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return o},e.prototype.RequestBreach=function(t,e){var r={resId:t,type:e};this.CtrlGameNet.send(new c.RequestBreach(r,this,function(){s.FW.LWX.log("\u7a81\u7834\u6210\u529f")}))},e.__cname="ModelBreach",i([l.injectField("Ref")],e.prototype,"Ref",void 0),i([l.injectField("CtrlGameNet")],e.prototype,"CtrlGameNet",void 0),i([l.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(t("../ModelBehavior").ModelBehavior);r.ModelBreach=u,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/container/Container":void 0,"../../../generated/requestMsg/RequestBreachMsg":"RequestBreachMsg","../ModelBehavior":"ModelBehavior"}],ModelChapter:[function(t,e,r){"use strict";cc._RF.push(e,"bc0c1KHa5tGDbrvwaeW+7Kv","ModelChapter");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.ModelChapter=void 0;var c=t("../../../../engine/EngineMain"),u=t("../../../../framework/container/Container"),p=t("../../../../framework/event/EventProxy"),f=t("../../../../framework/utils/StringUtil"),h=t("../../../../framework/utils/Toolset"),y=t("../../../generated/netProto/CmdInterface"),d=t("../../../generated/requestMsg/RequestChapterMsg"),m=t("../../../ref/RefChapterMonsterStrong"),v=t("../../../ref/RefWrap"),_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.eventProxy=new p.EventProxy,e}return n(e,t),e.prototype.GetEventProxy=function(){return this.eventProxy},e.prototype.enter=function(){return a(this,void 0,Promise,function(){var t,e=this;return l(this,function(){return this.toolSet=h.ToolSet.createToolSet(),(null==(t=this.GetSelectResId())||0==t||Number.isNaN(t))&&this.UpdateSelectResId(),this.toolSet.addListener(this.ModelMgr.ModelVO.VOChapterBag.GetEventProxy(),"OnAdd",function(){e.UpdateSelectResId()}),this.tmMonsterStrong=v.RefWrap.Create(this.Ref.RefMgrchapterMonsterStrong,m.RefChapterMonsterStrong,"chapterKey"),[2]})})},e.prototype.exit=function(){h.ToolSet.destroyToolSet(this.toolSet),this.tmMonsterStrong.clear(),this.tmMonsterStrong=null},e.prototype.GetTopChapter=function(){var t,e,r=101,o=this.ModelMgr.ModelVO.VOChapterBag.GetBagAsArray();try{for(var n=s(o),i=n.next();!i.done;i=n.next()){var a=i.value;a.GetResId()>r&&(r=a.GetResId())}}catch(l){t={error:l}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}return r},e.prototype.UpdateSelectResId=function(){var t=this.GetTopChapter();this.SetSelectResId(t)},e.prototype.GetClearanceChapter=function(){var t,e,r=101,o=this.ModelMgr.ModelVO.VOChapterBag.GetBagAsArray();try{for(var n=s(o),i=n.next();!i.done;i=n.next()){var a=i.value;a.GetResId()>r&&a.GetIsClearance()&&(r=a.GetResId())}}catch(l){t={error:l}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}return r},e.prototype.RequestChapterReward=function(t){var e=this,r={resId:t};this.CtrlMgr.CtrlGameNet.send(new d.RequestChapterReward(r,this,function(t){t.tlCmdGoods&&e.CtrlMgr.CtrlAlert.ShowGetReward(t.tlCmdGoods)}))},e.prototype.SetSelectResId=function(t){this._selectResId=t;var e=this.ModelMgr.ModelVO.VORoleBag.GetOne();if(null!=e){var r=f.StringUtil.format("ChapterResId_{0}",e.GetRoleId());c.EngineMain.saveLocalStorage(r,this._selectResId),this.eventProxy.execute("selectResIdChange")}},e.prototype.GetSelectResId=function(){if(!this._selectResId){var t=this.ModelMgr.ModelVO.VORoleBag.GetOne();if(null==t)return;var e=f.StringUtil.format("ChapterResId_{0}",t.GetRoleId());this._selectResId=Number(c.EngineMain.readLocalStorage(e))}return this._selectResId},e.prototype.GetTlRefAllByDifficulty=function(){return this.Ref.RefMgrchapterRef.getTlRef("difficulty",1)},e.prototype.GetRefChapter=function(t){return null==t&&(t=this.GetSelectResId()),this.Ref.RefMgrchapterRef.getRef("resId",t)},e.prototype.GetLiveTime=function(t){var e=this.ModelMgr.ModelVO.VOChapterBag.Get(t);return e&&e.GetLiveTime()||0},e.prototype.GetTlBuff=function(t){var e,r,o=this.GetRefChapter(t),n=[];try{for(var i=s(o.bonus),a=i.next();!a.done;a=i.next()){var l=a.value,c=this.Ref.RefMgrchapterBuff.getRef("resId",l);c&&n.push(c)}}catch(u){e={error:u}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return n},e.prototype.GetTlRefChapterBox=function(t){var e,r,o=this.GetRefChapter(t),n=[];try{for(var i=s(o.box),a=i.next();!a.done;a=i.next()){var l=a.value,c=this.Ref.RefMgrchapterBox.getRef("resId",l);c&&n.push(c)}}catch(u){e={error:u}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return n},e.prototype.GetTlRewardByRewardId=function(t){var e,r,o=this.Ref.RefMgrchapterReward.getTlRef("rewardId",t),n=[];try{for(var i=s(o),a=i.next();!a.done;a=i.next()){var l=a.value;n.push({resId:l.goodsRefId,number:String(l.number),quality:l.quality})}}catch(c){e={error:c}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return n},e.prototype.CheckAllGetBoxReward=function(t){var e=this.ModelMgr.ModelVO.VOChapterBag.Get(t);return null!=e&&e.AllBoxRewardIsReceive()},e.prototype.HasRewardReceive=function(t){var e=this.ModelMgr.ModelVO.VOChapterBag.Get(t);return e&&e.HasRewardReceive()},e.prototype.GetRewardChapterResId=function(){var t,e,r,o,n=this.Ref.RefMgrchapterRef.getRefAll();try{for(var i=s(n),a=i.next();!a.done;a=i.next()){var l=a.value,c=this.ModelMgr.ModelVO.VOChapterBag.Get(l.resId);if(c){var u=l.box;try{for(var p=(r=void 0,s(u)),f=p.next();!f.done;f=p.next()){var h=f.value,d=c.GetRewardState(h);if(d&&d==y.CmdCommonState.FINISH)return l.resId}}catch(m){r={error:m}}finally{try{f&&!f.done&&(o=p.return)&&o.call(p)}finally{if(r)throw r.error}}}}}catch(v){t={error:v}}finally{try{a&&!a.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}return null},e.prototype.GetShowSkillRef=function(t){return this.Ref.RefMgrshowSkill.getRef("resId",t)},e.prototype.GetChapterMonsterStrong=function(){var t=this.GetTopChapter(),e=this.GetRefChapter(t);return this.log(e.key),this.log(this.tmMonsterStrong),this.tmMonsterStrong.get(e.key)},e.prototype.GetChapterMonsterStrongLvPass=function(){var t=this.GetClearanceChapter(),e=this.GetRefChapter(t);return this.log(e.key),this.log(this.tmMonsterStrong),this.tmMonsterStrong.get(e.key)},e.prototype.GetResId=function(t,e){var r=this.Ref.RefMgrchapterRef.getRef(["key","difficulty"],t,e);return r&&r.resId},e.prototype.GetIsUnlock=function(t){var e=this.GetRefChapter(t);return!e||!e.preResId||this.GetIsClearance(e.preResId)},e.prototype.GetIsClearance=function(t){var e=this.ModelMgr.ModelVO.VOChapterBag.Get(t);return e&&e.GetIsClearance()||!1},e.__cname="ModelChapter",i([u.injectField("Ref")],e.prototype,"Ref",void 0),i([u.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([u.injectField("CtrlMgr")],e.prototype,"CtrlMgr",void 0),e}(t("../ModelBehavior").ModelBehavior);r.ModelChapter=_,cc._RF.pop()},{"../../../../engine/EngineMain":void 0,"../../../../framework/container/Container":void 0,"../../../../framework/event/EventProxy":void 0,"../../../../framework/utils/StringUtil":void 0,"../../../../framework/utils/Toolset":void 0,"../../../generated/netProto/CmdInterface":"CmdInterface","../../../generated/requestMsg/RequestChapterMsg":"RequestChapterMsg","../../../ref/RefChapterMonsterStrong":"RefChapterMonsterStrong","../../../ref/RefWrap":"RefWrap","../ModelBehavior":"ModelBehavior"}],ModelDayWeekMonthGift:[function(t,e,r){"use strict";cc._RF.push(e,"68e0b2+UQ5DKaUAJsedtTNK","ModelDayWeekMonthGift");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.ModelDayWeekMonthGift=r.DayWeekMonthGiftType=void 0;var c,u=t("../../../../framework/container/Container"),p=t("../../../../framework/event/EventProxy"),f=t("../../../generated/requestMsg/RequestDayWeekMonthGiftMsg"),h=t("../ModelBehavior");(function(t){t[t.day=0]="day",t[t.week=1]="week",t[t.month=2]="month"})(c=r.DayWeekMonthGiftType||(r.DayWeekMonthGiftType={}));var y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dayWeekMonthGiftMap=new Map,e.dayWeekMonthFreeGiftMap=new Map,e.eventProxy=new p.EventProxy,e.cmdDayWeekMonthMap=new Map,e}return n(e,t),e.prototype.GetEventProxy=function(){return this.eventProxy},e.prototype.enter=function(){return a(this,void 0,Promise,function(){var t,e,r,o,n,i,a;return l(this,function(){this.dayWeekMonthGiftMap=new Map,t=this.dayWeekMonthGiftMap,this.dayWeekMonthFreeGiftMap=new Map,e=this.dayWeekMonthFreeGiftMap;try{for(r=s(this.Ref.RefMgrdayWeekMonthGift.getRefAll()||[]),o=r.next();!o.done;o=r.next())1==(n=o.value).isFree&&e.set(n.refId,n),t.set(n.refId,n)}catch(l){i={error:l}}finally{try{o&&!o.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return[2,null]})})},e.prototype.GetIsHasFreeGift=function(){var t=this.GetIsHasFreeGiftByType(c.day),e=this.GetIsHasFreeGiftByType(c.week),r=this.GetIsHasFreeGiftByType(c.month);return t||e||r},e.prototype.GetIsHasFreeGiftByType=function(t){var e=this;return(this.cmdDayWeekMonthMap.get(t)||[]).some(function(t){return e.dayWeekMonthFreeGiftMap.get(t.giftId)&&0==t.buyCount})},e.prototype.GetRechargeCountResult=function(){return null!=this._dayWeekMonthGiftInfo&&(this._dayWeekMonthGiftInfo.cmdDayWeekMonthGift.tlRechargeCount||[]).some(function(t){return 1==t.buyState})},e.prototype.SetDayWeekMonthGiftInfo=function(t){this._dayWeekMonthGiftInfo=t},e.prototype.GetDayWeekMonthGiftInfo=function(){return this._dayWeekMonthGiftInfo},e.prototype.ReqestInfo=function(){var t=this;this.CtrlGameNet.send(new f.RequestDayWeekMonthGiftInfo({},this,function(e){t.UpdateData(e),t.eventProxy.execute("OnUpdate",e)}))},e.prototype.UpdateData=function(t){null!=t&&(this.cmdDayWeekMonthMap.clear(),this.cmdDayWeekMonthMap.set(c.day,t.cmdDayWeekMonthGift.tlDayGift),this.cmdDayWeekMonthMap.set(c.week,t.cmdDayWeekMonthGift.tlWeekGift),this.cmdDayWeekMonthMap.set(c.month,t.cmdDayWeekMonthGift.tlMonthGift),this.SetDayWeekMonthGiftInfo(t))},e.prototype.RequestDayWeekMonthGiftGetReward=function(t){var e=this,r={id:t};this.CtrlGameNet.send(new f.RequestDayWeekMonthGiftGetReward(r,this,function(){e.ReqestInfo()}))},e.prototype.RequestDayWeekMonthGiftFreeBuy=function(t){var e=this,r={id:t};this.CtrlGameNet.send(new f.RequestDayWeekMonthGiftFreeBuy(r,this,function(){e.ReqestInfo()}))},e.__cname="ModelDayWeekMonthGift",i([u.injectField("CtrlGameNet")],e.prototype,"CtrlGameNet",void 0),i([u.injectField("Ref")],e.prototype,"Ref",void 0),i([u.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(h.ModelBehavior);r.ModelDayWeekMonthGift=y,cc._RF.pop()},{"../../../../framework/container/Container":void 0,"../../../../framework/event/EventProxy":void 0,"../../../generated/requestMsg/RequestDayWeekMonthGiftMsg":"RequestDayWeekMonthGiftMsg","../ModelBehavior":"ModelBehavior"}],ModelEquipSynthesis:[function(t,e,r){"use strict";cc._RF.push(e,"fdfdeZ0BL5LLbhqd2QYCzbE","ModelEquipSynthesis");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.ModelEquipSynthesis=r.SynthesisAdditionType=void 0;var l,s=t("../../../../framework/FW"),c=t("../../../../framework/container/Container"),u=t("../../../../framework/utils/Toolset"),p=t("../../../generated/requestMsg/RequestEquipMsg"),f=t("../../ctrl/main/Hero/LayerOneKeySynthesisDisplay"),h=t("../ModelBehavior"),y=t("../goods/ModelEquip");(function(t){t[t.attribute=0]="attribute",t[t.Skill=1]="Skill"})(l=r.SynthesisAdditionType||(r.SynthesisAdditionType={}));var d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.enter=function(){this.toolSet=u.ToolSet.createToolSet()},e.prototype.exit=function(){return u.ToolSet.destroyToolSet(this.toolSet),this.toolSet=null,null},e.prototype.GetIndex=function(t,e,r){return 100*t+10*e+r},e.prototype.GetIndexByMaterialsRefId=function(t){var e=this.Ref.RefMgrgeneralMaterials.getRef("itemId",t);if(null!=e)return 100*e.type+10*e.quality},e.prototype.GetIndexByEquip=function(t){return 100*t.GetGoodsType()+10*t.GetQuality()+t.GetPhase()},e.prototype.GetSelfIndexByEquip=function(t){return 100*t.GetRefId()+10*t.GetQuality()+t.GetPhase()},e.prototype.GetRefSynthesis=function(t,e){return this.Ref.RefMgrsynthesis.getRef(["mainQuality","mainPhase"],t,e||0)},e.prototype.GetRefSynthesisByEquip=function(t){return this.Ref.RefMgrsynthesis.getRef(["mainQuality","mainPhase"],t.GetQuality(),t.GetPhase())},e.prototype.GetRefSynthesisByQuilaty=function(t,e){return this.Ref.RefMgrsynthesis.getRef(["mainQuality","mainPhase"],t,e)},e.prototype.GetRefGeneralMaterials=function(t,e){return this.Ref.RefMgrgeneralMaterials.getRef(["type","quality"],t,e)},e.prototype.GetRefGeneralMaterialsByRefId=function(t){return this.Ref.RefMgrgeneralMaterials.getRef("itemId",t)},e.prototype.GetDownQuality=function(t){var e=[],r=t.GetPhase(),o=t.GetGoodsType(),n=t.GetQuality(),i=this.GetRefGeneralMaterials(o,n),a={resId:t.GetRefId(),num:1,quality:t.GetQuality()};e.push(a);for(var l=0;r>0;){r--;var s=this.GetRefSynthesis(n,r);if(null==s)break;l+=s.tlMaterial.length}var c={resId:i,num:l,quality:n};return e.push(c),e},e.prototype.GetAdditionData=function(t,e){var r,o;t&&e||s.FW.LWX.error("\u4f20\u5165\u6570\u636e\u4e3a\u7a7a\uff0c\u8bf7\u68c0\u67e5!");var n=[],i=t.GetMaxLevel(),c=e.GetMaxLevel(),u={type:l.attribute,desc:"\u7b49\u7ea7\u4e0a\u9650",nowValue:i,additionValue:c},p=t.GetAdditionType()==y.AdditionType.attack?"\u653b\u51fb":"\u751f\u547d",f=t.GetAdditionValue(),h=e.GetAdditionValue(),d={type:l.attribute,desc:p,nowValue:f,additionValue:h};if(n.push(u),n.push(d),t.GetQuality()!=e.GetQuality()){var m=e.GetQuiltySkill(),v="";if(m){try{for(var _=a(m),S=_.next();!S.done;S=_.next()){var g=S.value;g.quality==e.GetQuality()&&(v=g.desc)}}catch(C){r={error:C}}finally{try{S&&!S.done&&(o=_.return)&&o.call(_)}finally{if(r)throw r.error}}var b={type:l.Skill,desc:"\u89e3\u9501\u6280\u80fd",skilldesc:v};n.push(b)}}return n},e.prototype.RequestEquipSynthesis=function(t){var e=t;return this.CtrlGameNet.send(new p.RequestEquipSynthesis(e,this,function(){}))},e.prototype.RequestEquipSynthesisOneKey=function(){var t=this;return this.CtrlGameNet.send(new p.RequestEquipSynthesisOneKey({},this,function(e){var r,o,n=[];try{for(var i=a(e.id||[]),l=i.next();!l.done;l=i.next()){var s=l.value,c=t.ModelMgr.ModelVO.VOEquipBag.Get(s);n.push(c)}}catch(u){r={error:u}}finally{try{l&&!l.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}n.length>0&&(t.LayerOneKeySynthesisDisplay.SetGoodsList(n),t.LayerOneKeySynthesisDisplay.SetShowBgType(f.ShowBgType.prop),t.LayerOneKeySynthesisDisplay.load())})).catch(function(){s.FW.showTip(s.FW.G_W("\u5408\u6210\u5931\u8d25\u4e86\uff0c\u662f\u6211\u7684\u9519\uff0c\u8bf7\u518d\u5c1d\u8bd5\u4e00\u4e0b\u5427~"))})},e.__cname="ModelEquipSynthesis",i([c.injectField("Ref")],e.prototype,"Ref",void 0),i([c.injectField("CtrlGameNet")],e.prototype,"CtrlGameNet",void 0),i([c.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([c.injectField("LayerOneKeySynthesisDisplay")],e.prototype,"LayerOneKeySynthesisDisplay",void 0),e}(h.ModelBehavior);r.ModelEquipSynthesis=d,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/container/Container":void 0,"../../../../framework/utils/Toolset":void 0,"../../../generated/requestMsg/RequestEquipMsg":"RequestEquipMsg","../../ctrl/main/Hero/LayerOneKeySynthesisDisplay":"LayerOneKeySynthesisDisplay","../ModelBehavior":"ModelBehavior","../goods/ModelEquip":"ModelEquip"}],ModelEquip:[function(t,e,r){"use strict";cc._RF.push(e,"4df7aHiCUFF+ZpU27o6oCE4","ModelEquip");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.ModelEquip=r.AdditionType=void 0;var c,u=t("../../../../framework/FW"),p=t("../../../../framework/container/Container"),f=t("../../../../framework/event/EventProxy"),h=t("../../../generated/requestMsg/RequestEquipMsg"),y=t("../ModelBehavior"),d=t("../vo/Goods/Goods"),m=t("../vo/Goods/VOEquip"),v=t("./ModelGoods");(function(t){t.attack="atk",t.hp="hp"})(c=r.AdditionType||(r.AdditionType={}));var _=v.ECurrencyType.coin,S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.eventProxy=new f.EventProxy,e}return n(e,t),e.prototype.GetEventProxy=function(){return this.eventProxy},e.prototype.enter=function(){return a(this,void 0,Promise,function(){return l(this,function(){return[2,null]})})},e.prototype.exit=function(){return null},e.prototype.GetMaxLevel=function(t,e,r){var o,n,i=this.GetEnhanceData(t);try{for(var a=s(i),l=a.next();!l.done;l=a.next()){var c=l.value;if(c.quality==e&&c.phase==r)return c.levelCap}}catch(u){o={error:u}}finally{try{l&&!l.done&&(n=a.return)&&n.call(a)}finally{if(o)throw o.error}}},e.prototype.GetUpgradeDrawNumber=function(t){var e=this.Ref.RefMgrenhanceConsume.getRef("equipLevel",t+1);return e?e.drawings:0},e.prototype.GetUpgradeCoinNumber=function(t){var e=this.Ref.RefMgrenhanceConsume.getRef("equipLevel",t+1);return e?e.coin:0},e.prototype.GetAdditionType=function(t,e,r){var o,n,i=this.GetEnhanceData(t);try{for(var a=s(i),l=a.next();!l.done;l=a.next()){var u=l.value;if(u.quality==e&&u.phase==r)return 0==u.atkIncrease?c.hp:c.attack}}catch(p){o={error:p}}finally{try{l&&!l.done&&(n=a.return)&&n.call(a)}finally{if(o)throw o.error}}},e.prototype.GetEnhanceData=function(t){return this.Ref.RefMgrenhance.getTlRef("itemType",t)||null},e.prototype.level=function(t){var e=this.Ref.RefMgrenhanceConsume.getRef("equipLevel",t+1);return e?e.coin:0},e.prototype.GetAdditionValue=function(t,e,r){var o,n,i=this.GetEnhanceData(t);try{for(var a=s(i),l=a.next();!l.done;l=a.next()){var c=l.value;if(c.quality==e&&c.phase==r)return 0==c.atkIncrease?c.hpIncrease:c.atkIncrease}}catch(u){o={error:u}}finally{try{l&&!l.done&&(n=a.return)&&n.call(a)}finally{if(o)throw o.error}}},e.prototype.GetBaseAttr=function(t){var e,r,o=this.GetEnhanceData(t.GetGoodsType()),n=0,i=this.GetIsSEquip(t.GetRefId());try{for(var a=s(o),l=a.next();!l.done;l=a.next()){var c=l.value;c.quality==t.GetQuality()&&c.phase==t.GetPhase()&&(n=i?Number(c.baseattr[0])+Number(c.baseattr[1]):Number(c.baseattr[0]))}}catch(u){e={error:u}}finally{try{l&&!l.done&&(r=a.return)&&r.call(a)}finally{if(e)throw e.error}}return n},e.prototype.GetQuiltySkill=function(t){var e,r,o=[];try{for(var n=s(this.Ref.RefMgrqualitySkill.getTlRef("resId",t)||[]),i=n.next();!i.done;i=n.next()){var a=i.value;"[]"!=a.desc&&o.push(a)}}catch(l){e={error:l}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}return o},e.prototype.GetUpDownDrawId=function(t,e,r){var o,n,i=this.GetEnhanceData(t);try{for(var a=s(i),l=a.next();!l.done;l=a.next()){var c=l.value;if(c.quality==e&&c.phase==r)return c.consumeItem}}catch(u){o={error:u}}finally{try{l&&!l.done&&(n=a.return)&&n.call(a)}finally{if(o)throw o.error}}},e.prototype.GetDownLevelcoinNumber=function(t){for(var e=0,r=1;r<=t;r++)e+=this.Ref.RefMgrenhanceConsume.getRef("equipLevel",r).coin;return e},e.prototype.GetDownLevelDrawNumber=function(t){for(var e=0,r=1;r<=t;r++)e+=this.Ref.RefMgrenhanceConsume.getRef("equipLevel",r).drawings;return e},e.prototype.GetDownLevelData=function(t){var e=t.GetLevel(),r={resId:t.GetRefId(),num:1,quality:t.GetQuality(),phase:t.GetPhase()},o=[],n=this.GetDownLevelcoinNumber(e),i={resId:_,num:n},a=this.GetDownLevelDrawNumber(e),l={resId:this.GetUpDownDrawId(t.GetGoodsType(),t.GetQuality(),t.GetPhase()),num:a};return o.push(r,i,l),o},e.prototype.GetIsSEquip=function(t){return"6"==t.toString().charAt(3)},e.prototype.GetDownQualityData=function(t){var e=this.ModelMgr.ModelEquipSynthesis.GetDownQuality(t);if(t.GetLevel()>1){var r=this.GetDownLevelcoinNumber(t.GetLevel()),o={resId:_,num:r},n=this.GetDownLevelDrawNumber(t.GetLevel()),i={resId:this.GetUpDownDrawId(t.GetGoodsType(),t.GetQuality(),t.GetPhase()),num:n};e.push(o,i)}return e},e.prototype.GetPhaseLimit=function(t,e,r){var o,n,i=this.GetEnhanceData(t);try{for(var a=s(i),l=a.next();!l.done;l=a.next()){var c=l.value;if(c.quality==e&&c.phase==r)return c.phaseCap}}catch(u){o={error:u}}finally{try{l&&!l.done&&(n=a.return)&&n.call(a)}finally{if(o)throw o.error}}},e.prototype.GetQualityLimit=function(){return this.Ref.RefMgrenhance.getRef("resId",1).qualityCap},e.prototype.GetNextStage=function(t,e,r){var o=r+1>this.GetPhaseLimit(t,e,r),n=e+1>this.GetQualityLimit();return o&&n?(u.FW.LWX.log("\u5df2\u7ecf\u8fbe\u5230\u6700\u9ad8\u7ea7\u522b"),null):o?{quality:e+1,phase:0}:{quality:e,phase:r+1}},e.prototype.GetUpgradeState=function(t){var e=this.GetUpDownDrawId(t.GetGoodsType(),t.GetQuality(),t.GetPhase()),r=this.GetUpgradeDrawNumber(t.GetLevel()),o=this.GetUpgradeCoinNumber(t.GetLevel()),n=this.ModelMgr.ModelRole.getPropertyById(_),i=this.ModelMgr.ModelGoods.GetGoodsNumberByRefId(e),a=t.GetMaxLevel();return t.GetLevel()<a&&n>=o&&i>=r},e.prototype.GetWearData=function(){var t,e,r=this.ModelMgr.ModelVO.VOEquipBag.GetBagAsArray(),o=new Map;try{for(var n=s(r),i=n.next();!i.done;i=n.next()){var a=i.value;if(a.GetIsPutOn()){if(a.GetGoodsType()==d.EGoodsType.weapon){var l=this.ModelMgr.ModelVO.VORoleBag.GetOne().GetHeroId(),c=this.ModelMgr.ModelVO.VOHeroBag.Get(l).GetWeaPonId();if(a.GetId()!=c)continue}o.set(a.GetGoodsType(),a)}}}catch(u){t={error:u}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}return o},e.prototype.GetEquipAtrribute=function(){var t=this.GetWearData(),e=new Map,r=0,o=0;return t.forEach(function(t){var e=t.GetAdditionValue();t.GetAdditionType()==c.attack?o+=e:r+=e}),e.set("hp",r),e.set("atk",o),e},e.prototype.getEquipHPAdd=function(){return this.GetEquipAtrribute().get("hp")||0},e.prototype.getEquipATKAdd=function(){return this.GetEquipAtrribute().get("atk")||0},e.prototype.GetQualityIsHight=function(t){if(t.GetGoodsType()===d.EGoodsType.weapon&&t.GetEquiType()!=m.EquipType.general){var e=this.ModelMgr.ModelVO.VORoleBag.GetOne().GetHeroId(),r=this.ModelMgr.ModelHero.GetHeroRef(e).equipType;if(t.GetEquiType()!==r)return!1}var o=this.GetWearData(),n=t.GetGoodsType(),i=t.GetQuality();return!o.has(n)||i>o.get(n).GetQuality()||i===o.get(n).GetQuality()&&t.GetPhase()>o.get(n).GetPhase()},e.prototype.GetEquipMainSkill=function(t,e){var r=null,o=this.Ref.RefMgrqualitySkill.getRef(["resId","quality"],t,e);return o&&(r=o.mianSkill),r},e.prototype.RequestEquipPutOn=function(t){var e={id:t};this.CtrlGameNet.send(new h.RequestEquipPutOn(e,this,function(){}))},e.prototype.RequestEquipTakeOff=function(t){var e={id:t};this.CtrlGameNet.send(new h.RequestEquipTakeOff(e,this,function(){}))},e.prototype.RequestEquipUpLevel=function(t){var e=this,r={id:t};this.CtrlGameNet.send(new h.RequestEquipUpLevel(r,this,function(){e.eventProxy.execute("OnEquipLevel")}))},e.prototype.RequestEquipUpLevelOneKey=function(t){var e=this,r={id:t};this.CtrlGameNet.send(new h.RequestEquipUpLevelOneKey(r,this,function(){e.eventProxy.execute("OnEquipLevel")}))},e.prototype.RequestEquipDownLevel=function(t){var e={id:t};this.CtrlGameNet.send(new h.RequestEquipDownLevel(e,this,function(){}))},e.prototype.RequestEquipDownPhase=function(t){var e={id:t};this.CtrlGameNet.send(new h.RequestEquipDownPhase(e,this,function(){}))},e.__cname="ModelEquip",i([p.injectField("Ref")],e.prototype,"Ref",void 0),i([p.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([p.injectField("CtrlGameNet")],e.prototype,"CtrlGameNet",void 0),e}(y.ModelBehavior);r.ModelEquip=S,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/container/Container":void 0,"../../../../framework/event/EventProxy":void 0,"../../../generated/requestMsg/RequestEquipMsg":"RequestEquipMsg","../ModelBehavior":"ModelBehavior","../vo/Goods/Goods":"Goods","../vo/Goods/VOEquip":"VOEquip","./ModelGoods":"ModelGoods"}],ModelEveryDaySignIn:[function(t,e,r){"use strict";cc._RF.push(e,"5da0c1x4o1MFJ+/30VcPnKB","ModelEveryDaySignIn");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.ModelEveryDaySignIn=void 0;var a=t("../../../../framework/container/Container"),l=t("../../../../framework/event/EventProxy"),s=t("../../../generated/requestMsg/RequestEveryDaySignMsg"),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.eventProxy=new l.EventProxy,e}return n(e,t),e.prototype.GetEventProxy=function(){return this.eventProxy},e.prototype.SetEverySignIn=function(t){this._everySignIn=t,this.eventProxy.execute("OnUpdate")},e.prototype.GetEverySignIn=function(){return this._everySignIn},e.prototype.GetRef=function(t){return this.Ref.RefMgreveryDaySignInDayGift.getRef("day",t)},e.prototype.ReqestInfo=function(){var t=this;return this.CtrlMgr.CtrlGameNet.send(new s.RequestEveryDaySignInInfo({},this,function(e){t.SetEverySignIn(e)}))},e.prototype.ReqestSignIn=function(){var t=this;this.CtrlMgr.CtrlGameNet.send(new s.RequestEveryDaySignIn({},this,function(e){t.ReqestInfo(),e.tlCmdGoods&&t.CtrlMgr.CtrlAlert.ShowGetReward(e.tlCmdGoods)}))},e.prototype.RequestEveryDayGetRewards=function(t){var e=this,r={day:t};this.CtrlMgr.CtrlGameNet.send(new s.RequestEveryDayGetRewards(r,this,function(t){e.ReqestInfo(),t.tlCmdGoods&&e.CtrlMgr.CtrlAlert.ShowGetReward(t.tlCmdGoods)}))},e.__cname="ModelEveryDaySignIn",i([a.injectField("CtrlMgr")],e.prototype,"CtrlMgr",void 0),i([a.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([a.injectField("Ref")],e.prototype,"Ref",void 0),e}(t("../ModelBehavior").ModelBehavior);r.ModelEveryDaySignIn=c,cc._RF.pop()},{"../../../../framework/container/Container":void 0,"../../../../framework/event/EventProxy":void 0,"../../../generated/requestMsg/RequestEveryDaySignMsg":"RequestEveryDaySignMsg","../ModelBehavior":"ModelBehavior"}],ModelExpr:[function(t,e,r){"use strict";cc._RF.push(e,"5afb9MjqcxM6pF0RgelDBdM","ModelExpr");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.ModelExpr=r.RDExprType=void 0;var l=t("../../../../framework/FW"),s=t("../ModelBehavior"),c=t("./RD/Bag/RDRuneBag"),u=t("./RD/Bag/RDXiuLianBag"),p=t("./RD/Client/Friend/RDFriends"),f=t("./RD/Client/Friend/RDFriendsApply"),h=t("./RD/Client/Friend/RDFriendsReceive"),y=t("./RD/Mall/RDDailyShop"),d=t("./RD/Mall/RDGloden"),m=t("./RD/Mall/RDLuckDraw"),v=t("./RD/Mall/RDMall"),_=t("./RD/Mall/RDSEquip"),S=t("./RD/RDBreach"),g=t("./RD/RDChapterRewards"),b=t("./RD/RDInformation"),C=t("./RD/RDLuckyCat"),R=t("./RD/RDXiulianOnHook"),M=t("./RD/Server/RDAchievementRewards"),w=t("./RD/Server/RDDailyRewards"),O=t("./RD/Server/RDDayWeekMonthGift"),B=t("./RD/Server/RDEveryDaySignIn"),P=t("./RD/Server/RDHeroRewards"),G=t("./RD/Server/RDMonthCard"),k=t("./RD/Server/RDWeeklyRewards"),x=t("./RD/Server/RDXiulianMail"),T=t("./RD/adventure/RDDailyFuben"),j=t("./RD/adventure/RDGoldFuben"),I=t("./RD/hero/RDEquipSynthesis"),D=t("./RD/hero/RDHasBattleEquip"),F=t("./RD/hero/RDRuneSynthesis"),L=t("./RD/mainActivity/RDActivityCenter"),E=t("./RD/mainActivity/RDFund"),A=t("./RD/mainActivity/RDNewPlayerSignIn"),V=t("./RD/mainActivity/RDSevenDayChallenge"),U=t("./Var/VarChapterLiveTime"),W=t("./Var/VarClose"),H=t("./Var/VarEquipNumber"),N=t("./Var/VarFinishChapter"),q=t("./Var/VarFirstRechargeState"),K=t("./Var/VarFundVisible"),X=t("./Var/VarHasChapterReward"),z=t("./Var/VarHasHeroOrEquip"),J=t("./Var/VarHasLuckyCat"),Y=t("./Var/VarHasShareType"),Z=t("./Var/VarHasSpecialGift"),Q=t("./Var/VarNotTishen"),$=t("./Var/VarOpen"),tt=t("./Var/VarRoleLevel");(r.RDExprType||(r.RDExprType={})).RDXiulianMail="[RDXiulianMail]";var et=function(t){function e(){var e=t.call(this)||this;return e.Init(),e}return n(e,t),e.prototype.enter=function(){return i(this,void 0,Promise,function(){return a(this,function(){return[2,null]})})},e.prototype.Init=function(){l.FW.ExprMgr.RegistVarClass("open",$.VarOpen),l.FW.ExprMgr.RegistVarClass("close",W.VarClose),l.FW.ExprMgr.RegistVarClass("notTiShen",Q.VarNotTishen),l.FW.ExprMgr.RegistVarClass("hasChapterReward",X.VarHasChapterReward),l.FW.ExprMgr.RegistVarClass("finishChapter",N.VarFinishChapter),l.FW.ExprMgr.RegistVarClass("chapterLiveTime",U.VarChapterTime),l.FW.ExprMgr.RegistVarClass("firstRecharge",q.VarFirstRechargeState),l.FW.ExprMgr.RegistVarClass("roleLevel",tt.VarRoleLevel),l.FW.ExprMgr.RegistVarClass("fundVisible",K.VarFundVisible),l.FW.ExprMgr.RegistVarClass("hasSpecialGift",Z.VarHasSpecialGift),l.FW.ExprMgr.RegistVarClass("hasHeroOrEquip",z.VarHasHeroOrEquip),l.FW.ExprMgr.RegistVarClass("hasLuckyCat",J.VarHasLuckyCat),l.FW.ExprMgr.RegistVarClass("hasShareType",Y.VarHasShareType),l.FW.ExprMgr.RegistVarClass("EquipNumber",H.VarEquipNumber),l.FW.ExprMgr.RegistVarClass("RDFund",E.RDFund),l.FW.ExprMgr.RegistVarClass("RDXiulianBag",u.RDXiulianBag),l.FW.ExprMgr.RegistVarClass("RDXiulianOnHook",R.RDXiulianOnHook),l.FW.ExprMgr.RegistVarClass("RDInformation",b.RDInformation),l.FW.ExprMgr.RegistVarClass("RDEquipSynthesis",I.RDEquipSynthesis),l.FW.ExprMgr.RegistVarClass("RDBreach",S.RDBreach),l.FW.ExprMgr.RegistVarClass("RDRuneBag",c.RDRuneBag),l.FW.ExprMgr.RegistVarClass("RDRuneSynthesis",F.RDRuneSynthesis),l.FW.ExprMgr.RegistVarClass("RDMall",v.RDMall),l.FW.ExprMgr.RegistVarClass("RDGloden",d.RDGloden),l.FW.ExprMgr.RegistVarClass("RDDailyShop",y.RDDailyShop),l.FW.ExprMgr.RegistVarClass("RDLuckDraw",m.RDLuckDraw),l.FW.ExprMgr.RegistVarClass("RDSEquip",_.RDSEquip),l.FW.ExprMgr.RegistVarClass("RDActivityCenter",L.RDActivityCenter),l.FW.ExprMgr.RegistVarClass("RDSevenDayChallenge",V.RDSevenDayChallenge),l.FW.ExprMgr.RegistVarClass("RDGoldFuben",j.RDGoldFuben),l.FW.ExprMgr.RegistVarClass("RDDailyFuben",T.RDDailyFuben),l.FW.ExprMgr.RegistVarClass("RDChapterRewards",g.RDChapterRewards),l.FW.ExprMgr.RegistVarClass("RDNewPlayerSignIn",A.RDNewPlayerSignIn),l.FW.ExprMgr.RegistVarClass("RDEquipBag",D.RDEquipBag),l.FW.ExprMgr.RegistVarClass("RDFriendsReceive",h.RDFriendsReceive),l.FW.ExprMgr.RegistVarClass("RDFriendsApply",f.RDFriendsApply),l.FW.ExprMgr.RegistVarClass("RDLuckyCat",C.RDLuckyCat),l.FW.ExprMgr.RegistVarClass("RDDailyRewards",w.RDDailyRewards),l.FW.ExprMgr.RegistVarClass("RDWeeklyRewards",k.RDWeeklyRewards),l.FW.ExprMgr.RegistVarClass("RDAchievementRewards",M.RDAchievementRewards),l.FW.ExprMgr.RegistVarClass("RDHeroRewards",P.RDHeroRewards),l.FW.ExprMgr.RegistVarClass("RDXiulianMail",x.RDXiulianMail),l.FW.ExprMgr.RegistVarClass("RDEveryDaySignIn",B.RDEveryDaySignIn),l.FW.ExprMgr.RegistVarClass("RDDayWeekMonthGift",O.RDDayWeekMonthGift),l.FW.ExprMgr.RegistVarClass("RDMonthCard",G.RDMonthCard),l.FW.ExprMgr.RegistVarClass("RDFriends",p.RDFriends)},e.__cname="ModelExpr",e}(s.ModelBehavior);r.ModelExpr=et,cc._RF.pop()},{"../../../../framework/FW":void 0,"../ModelBehavior":"ModelBehavior","./RD/Bag/RDRuneBag":"RDRuneBag","./RD/Bag/RDXiuLianBag":"RDXiuLianBag","./RD/Client/Friend/RDFriends":"RDFriends","./RD/Client/Friend/RDFriendsApply":"RDFriendsApply","./RD/Client/Friend/RDFriendsReceive":"RDFriendsReceive","./RD/Mall/RDDailyShop":"RDDailyShop","./RD/Mall/RDGloden":"RDGloden","./RD/Mall/RDLuckDraw":"RDLuckDraw","./RD/Mall/RDMall":"RDMall","./RD/Mall/RDSEquip":"RDSEquip","./RD/RDBreach":"RDBreach","./RD/RDChapterRewards":"RDChapterRewards","./RD/RDInformation":"RDInformation","./RD/RDLuckyCat":"RDLuckyCat","./RD/RDXiulianOnHook":"RDXiulianOnHook","./RD/Server/RDAchievementRewards":"RDAchievementRewards","./RD/Server/RDDailyRewards":"RDDailyRewards","./RD/Server/RDDayWeekMonthGift":"RDDayWeekMonthGift","./RD/Server/RDEveryDaySignIn":"RDEveryDaySignIn","./RD/Server/RDHeroRewards":"RDHeroRewards","./RD/Server/RDMonthCard":"RDMonthCard","./RD/Server/RDWeeklyRewards":"RDWeeklyRewards","./RD/Server/RDXiulianMail":"RDXiulianMail","./RD/adventure/RDDailyFuben":"RDDailyFuben","./RD/adventure/RDGoldFuben":"RDGoldFuben","./RD/hero/RDEquipSynthesis":"RDEquipSynthesis","./RD/hero/RDHasBattleEquip":"RDHasBattleEquip","./RD/hero/RDRuneSynthesis":"RDRuneSynthesis","./RD/mainActivity/RDActivityCenter":"RDActivityCenter","./RD/mainActivity/RDFund":"RDFund","./RD/mainActivity/RDNewPlayerSignIn":"RDNewPlayerSignIn","./RD/mainActivity/RDSevenDayChallenge":"RDSevenDayChallenge","./Var/VarChapterLiveTime":"VarChapterLiveTime","./Var/VarClose":"VarClose","./Var/VarEquipNumber":"VarEquipNumber","./Var/VarFinishChapter":"VarFinishChapter","./Var/VarFirstRechargeState":"VarFirstRechargeState","./Var/VarFundVisible":"VarFundVisible","./Var/VarHasChapterReward":"VarHasChapterReward","./Var/VarHasHeroOrEquip":"VarHasHeroOrEquip","./Var/VarHasLuckyCat":"VarHasLuckyCat","./Var/VarHasShareType":"VarHasShareType","./Var/VarHasSpecialGift":"VarHasSpecialGift","./Var/VarNotTishen":"VarNotTishen","./Var/VarOpen":"VarOpen","./Var/VarRoleLevel":"VarRoleLevel"}],ModelFriends:[function(t,e,r){"use strict";cc._RF.push(e,"e0fc3ro2StEvZEI71tWKgGS","ModelFriends");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.ModelFriends=r.FriendsEventType=void 0;var s,c=t("../../../../framework/container/Container"),u=t("../../../../framework/event/EventProxy"),p=t("../../../../framework/FW"),f=t("../../../../framework/utils/StringUtil"),h=t("../../../generated/requestMsg/RequestFriendsMsg"),y=t("../ModelBehavior");(function(t){t.canApplyArrayUpdate="canApplyArrayUpdate"})(s=r.FriendsEventType||(r.FriendsEventType={}));var d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.eventProxy=new u.EventProxy,e}return n(e,t),e.prototype.GetEventProxy=function(){return this.eventProxy},e.prototype.GetCanApplyArray=function(){return this.canApplyArray||[]},e.prototype.enter=function(){return a(this,void 0,Promise,function(){return l(this,function(){return this.maxFriendNumber=this.ModelMgr.ModelGameConfig.GetGameConfigValueByKey("firendUpperLimit"),this.maxReceiveStaTimes=this.ModelMgr.ModelGameConfig.GetGameConfigValueByKey("frineReceiveTimes"),this.maxBlackListNumber=this.ModelMgr.ModelGameConfig.GetGameConfigValueByKey("friendBlacklistUpperLimit"),[2,null]})})},e.prototype.exit=function(){return null},e.prototype.GetMaxBlackListNumber=function(){return this.maxBlackListNumber},e.prototype.GetMaxFriendNumber=function(){return this.maxFriendNumber},e.prototype.GetMaxReceiveStaTimes=function(){return this.maxReceiveStaTimes},e.prototype.RequestFriendsApply=function(t){return a(this,void 0,void 0,function(){var e,r;return l(this,function(){return r={targetId:t},[2,(e=this).CtrlGameNet.send(new h.RequestFriendsApply(r,e,function(){p.FW.showTip("\u7533\u8bf7\u6210\u529f")}))]})})},e.prototype.RequestFriendsAdd=function(t){return a(this,void 0,void 0,function(){var e,r;return l(this,function(){return r={targetId:t},[2,(e=this).CtrlGameNet.send(new h.RequestFriendsAdd(r,e,function(){p.FW.showTip("\u5df2\u540c\u610f\u8be5\u7533\u8bf7")}))]})})},e.prototype.RequestFriendAgreeOneKey=function(){return a(this,void 0,void 0,function(){var t,e;return l(this,function(){return e={},[2,(t=this).CtrlGameNet.send(new h.RequestFriendAgreeOneKey(e,t,function(){p.FW.showTip("\u6210\u529f\u540c\u610f\u6240\u6709\u7533\u8bf7")}))]})})},e.prototype.RequestFriendsRefuse=function(t){return a(this,void 0,void 0,function(){var e,r;return l(this,function(){return r={targetId:t},[2,(e=this).CtrlGameNet.send(new h.RequestFriendsRefuse(r,e,function(){p.FW.showTip("\u6210\u529f\u62d2\u7edd\u8be5\u7533\u8bf7")}))]})})},e.prototype.RequestFriendRefuseOneKey=function(){return a(this,void 0,void 0,function(){var t,e;return l(this,function(){return e={},[2,(t=this).CtrlGameNet.send(new h.RequestFriendRefuseOneKey(e,t,function(){p.FW.showTip("\u6210\u529f\u62d2\u7edd\u6240\u6709\u7533\u8bf7")}))]})})},e.prototype.RequestFriendsRemove=function(t){return a(this,void 0,void 0,function(){var e,r;return l(this,function(){return r={targetId:t},[2,(e=this).CtrlGameNet.send(new h.RequestFriendsRemove(r,e,function(){p.FW.showTip("\u5220\u9664\u597d\u53cb\u6210\u529f")}))]})})},e.prototype.RequestFriendsBlack=function(t){return a(this,void 0,void 0,function(){var e,r;return l(this,function(){return r={targetId:t},[2,(e=this).CtrlGameNet.send(new h.RequestFriendsBlack(r,e,function(){p.FW.showTip("\u62c9\u9ed1\u6210\u529f")}))]})})},e.prototype.RequestFriendBlackRemove=function(t){return a(this,void 0,void 0,function(){var e,r;return l(this,function(){return r={targetId:t},[2,(e=this).CtrlGameNet.send(new h.RequestFriendBlackRemove(r,e,function(){p.FW.showTip("\u79fb\u51fa\u9ed1\u540d\u5355\u6210\u529f")}))]})})},e.prototype.RequestFriendGetEnd=function(t){return a(this,void 0,void 0,function(){var e,r;return l(this,function(){return r={targetId:t},[2,(e=this).CtrlGameNet.send(new h.RequestFriendGetEnd(r,e,function(){p.FW.LWX.log("\u9886\u53d6\u4f53\u529b\u6210\u529f")}))]})})},e.prototype.RequestFriendGetEndOneKey=function(){return a(this,void 0,void 0,function(){var t,e;return l(this,function(){return e={},[2,(t=this).CtrlGameNet.send(new h.RequestFriendGetEndOneKey(e,t,function(){p.FW.LWX.log("\u4e00\u952e\u9886\u53d6\u6210\u529f")}))]})})},e.prototype.RequestFriendSendEnd=function(t){return a(this,void 0,void 0,function(){var e,r;return l(this,function(){return r={targetId:t},[2,(e=this).CtrlGameNet.send(new h.RequestFriendSendEnd(r,e,function(){p.FW.showTip("\u8d60\u9001\u6210\u529f")}))]})})},e.prototype.RequestFriendSendEndOneKey=function(){return a(this,void 0,void 0,function(){var t,e;return l(this,function(){return e={},[2,(t=this).CtrlGameNet.send(new h.RequestFriendSendEndOneKey(e,t,function(){p.FW.showTip("\u4e00\u952e\u8d60\u9001\u6210\u529f")}))]})})},e.prototype.RequestSearchFriend=function(t){return a(this,void 0,void 0,function(){var e,r;return l(this,function(){return r={targetId:t},[2,(e=this).CtrlGameNet.send(new h.RequestFriendsSearch(r,e,function(t){p.FW.showTip("\u641c\u7d22\u6210\u529f"),e.canApplyArray=[],e.canApplyArray.push(t.detail),e.eventProxy.execute(s.canApplyArrayUpdate)}))]})})},e.prototype.RequestFriendRefreshSuggest=function(t){return a(this,void 0,void 0,function(){var e,r,o;return l(this,function(n){switch(n.label){case 0:return r=(e=this).TimeUtil.LocalNow(),null!=e.lastRefreshTime&&e.lastRefreshTime+3>r?(p.FW.showTip(f.StringUtil.format("\u5237\u65b0\u592a\u5feb\u5566\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5({0}s)",Math.ceil(e.lastRefreshTime+3-r))),[2]):(e.lastRefreshTime=r,o={},[4,e.CtrlGameNet.send(new h.RequestFriendRefreshSuggest(o,e,function(r){t&&p.FW.showTip(f.StringUtil.format("\u5237\u65b0\u6210\u529f")),e.canApplyArray=r.tlSuggestFriend,e.eventProxy.execute(s.canApplyArrayUpdate)}))]);case 1:return n.sent(),[2]}})})},e.prototype.GetFriend=function(t){return this.ModelMgr.ModelVO.VOFirendBag.Get(t)},e.__cname="ModelFriends",i([c.injectField("CtrlGameNet")],e.prototype,"CtrlGameNet",void 0),i([c.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([c.injectField("TimeUtil")],e.prototype,"TimeUtil",void 0),e}(y.ModelBehavior);r.ModelFriends=d,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/container/Container":void 0,"../../../../framework/event/EventProxy":void 0,"../../../../framework/utils/StringUtil":void 0,"../../../generated/requestMsg/RequestFriendsMsg":"RequestFriendsMsg","../ModelBehavior":"ModelBehavior"}],ModelFuben:[function(t,e,r){"use strict";cc._RF.push(e,"317e2UEtntNJ4aIoQJNG+Ot","ModelFuben");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.ModelFuben=void 0;var c=t("../../../../framework/container/Container"),u=t("../../../../framework/FW"),p=t("../../../../framework/utils/PromiseWrap"),f=t("../../../generated/requestMsg/RequestBattleMsg"),h=t("../../../generated/requestMsg/RequestFuBenMsg"),y=t("../../../ref/RefFuben"),d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tmFuben=new Map,e}return n(e,t),Object.defineProperty(e.prototype,"FubenRef",{get:function(){return this.Ref.RefMgrfuBenRef},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"FubenGoldPlan",{get:function(){return this.Ref.RefMgrfuBenGoldPlan},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"FubenDailyPlan",{get:function(){return this.Ref.RefMgrfuBenDailyPlan},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"FubenDailyReward",{get:function(){return this.Ref.RefMgrfuBenDailyReward},enumerable:!1,configurable:!0}),e.prototype.enter=function(){return a(this,void 0,Promise,function(){return l(this,function(){return this.InitData(),[2]})})},e.prototype.InitData=function(){var t,e,r=this.tmFuben;try{for(var o=s(this.FubenRef.getRefAll()),n=o.next();!n.done;n=o.next()){var i=n.value,a=new y.RefFuben;a.Setup(i),r.set(i.resId,a)}}catch(l){t={error:l}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}},e.prototype.GetBoxRewardByRewardId=function(t){return this.FubenDailyReward.getTlRef("rewardId",t)},e.prototype.GetDailyFubenPlanByResId=function(t){return this.FubenDailyPlan.getRef("resId",t)},e.prototype.GetFubenRefByResId=function(t){return this.FubenRef.getRef("resId",t)},e.prototype.RequestFuben=function(t,e){var r={resId:t,type:e},o=new p.PromiseWrap;return this.CtrlGameNet.send(new h.RequestFuBenEnter(r,this,function(){o.resolve(!0)},function(){o.resolve(!1)})),o},e.prototype.SetData=function(t){this._data=t},e.prototype.GetData=function(){return this._data},e.prototype.BeforRequestFubenEnter=function(){return a(this,void 0,void 0,function(){var t=this;return l(this,function(e){switch(e.label){case 0:return this._data?(this.CtrlAlert.LayerMainStaConsumeAnimation.SetGObjTarget(this._data.gobjTarget),this.CtrlAlert.LayerMainStaConsumeAnimation.SetHostCom(this._data.HostCom),this.CtrlAlert.LayerMainStaConsumeAnimation.SetStaConsumeNum(this._data.ConsumeEnd),this.CtrlAlert.LayerMainStaConsumeAnimation.Play(),[4,u.FW.Task.waitUntil(function(){return t.CtrlAlert.LayerMainStaConsumeAnimation.GetPlaybackCompleted()},this,1,1250)]):[3,2];case 1:e.sent(),this.CtrlAlert.LayerMainStaConsumeAnimation.SetPlaybackCompleted(!0),this._data=null,e.label=2;case 2:return[2]}})})},e.prototype.RequestFubenEnter=function(){return a(this,void 0,void 0,function(){var t,e,r;return l(this,function(o){switch(o.label){case 0:return t=new p.PromiseWrap,e={},[4,this.CtrlGameNet.send(new f.RequestEnterBattle(e,this,function(e){u.FW.LWX.log("\u7533\u8bf7\u6210\u529f\uff0c\u8fdb\u5165\u526f\u672c"),r=e,t.resolve(e)}))];case 1:return o.sent(),[2,r]}})})},e.prototype.RequestAbandonBattle=function(){this.CtrlGameNet.send(new f.RequestAbandonBattle({},this,function(){u.FW.LWX.log("\u653e\u5f03\u6210\u529f")}))},e.prototype.RequestBattleBeat=function(t){var e={cmdBattleBeat:t};this.CtrlGameNet.send(new f.RequestBattleBeat(e,this))},e.prototype.RequestBattleResult=function(t,e){var r={result:t,beat:e};this.CtrlGameNet.send(new f.RequestBattleResult(r,this))},e.prototype.RequestFubenDailyReward=function(t){var e={resId:t};return this.CtrlGameNet.send(new h.RequestFuBenDailyGetReward(e,this))},e.prototype.RequestFubenBuyTimes=function(t,e){var r={resId:t,type:e};this.CtrlGameNet.send(new h.RequestFuBenBuyTimes(r,this))},e.prototype.GetFuben=function(t){return this.tmFuben.get(t)},e.__cname="ModelFuben",i([c.injectField("Ref")],e.prototype,"Ref",void 0),i([c.injectField("CtrlGameNet")],e.prototype,"CtrlGameNet",void 0),i([c.injectField("LayerShowTip")],e.prototype,"LayerShowTip",void 0),i([c.injectField("LayerBuySta")],e.prototype,"LayerBuySta",void 0),i([c.injectField("CtrlAlert")],e.prototype,"CtrlAlert",void 0),e}(t("../ModelBehavior").ModelBehavior);r.ModelFuben=d,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/container/Container":void 0,"../../../../framework/utils/PromiseWrap":void 0,"../../../generated/requestMsg/RequestBattleMsg":"RequestBattleMsg","../../../generated/requestMsg/RequestFuBenMsg":"RequestFuBenMsg","../../../ref/RefFuben":"RefFuben","../ModelBehavior":"ModelBehavior"}],ModelFund:[function(t,e,r){"use strict";cc._RF.push(e,"f062e3euuRFsKtceYf93n3i","ModelFund");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},c=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.ModelFund=r.FundType=r.TabState=void 0;var u,p,f=t("../../../../framework/FW"),h=t("../../../../framework/container/Container"),y=t("../../../../framework/event/EventProxy"),d=t("../../../../framework/utils/Toolset"),m=t("../../../generated/requestMsg/RequestFundMsg"),v=t("../ModelBehavior");(function(t){t[t.close=0]="close",t[t.open=1]="open"})(u=r.TabState||(r.TabState={})),function(t){t[t.GrowUp=1]="GrowUp",t[t.Elite=2]="Elite",t[t.Expert=3]="Expert"}(p=r.FundType||(r.FundType={}));var _=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.fundRewardData=[],e.fundPlanMap=new Map,e.fundTypeMap=new Map,e.fundTypeResIdMap=new Map,e.tabOpenState=new Map,e.eventProxy=new y.EventProxy,e.rewardStateMap=new Map,e}return n(e,t),e.prototype.enter=function(){return a(this,void 0,Promise,function(){var t=this;return l(this,function(e){switch(e.label){case 0:return this.InitData(),this.toolSet=d.ToolSet.createToolSet(),this.toolSet.addListener(this.ModelMgr.ModelMall.GetEventProxy(),"BuySuccess",function(){t.RequestFundGetInfo()}),[4,this.RequestFundGetInfo()];case 1:return e.sent(),this.toolSet.addDefer(function(){}),[2,null]}})})},e.prototype.exit=function(){return d.ToolSet.destroyToolSet(this.toolSet),null},Object.defineProperty(e.prototype,"reffundTypePlan",{get:function(){return this.Ref.RefMgrfundTypePlan},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"reffund",{get:function(){return this.Ref.RefMgrfund},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"reffundReward",{get:function(){return this.Ref.RefMgrfundReward},enumerable:!1,configurable:!0}),e.prototype.InitData=function(){var t,e,r,o,n,i;this.fundRewardData=[];var a=this.fundRewardData,l=this.reffundReward.getRefAll(),c=function(t){var e=a.find(function(e){return e.roleLlvel==t.roleLevel&&e.type==t.type});e?e.rewards.push({ref:t}):a.push({rewards:[{ref:t}],roleLlvel:t.roleLevel,type:t.type})};try{for(var u=s(l),p=u.next();!p.done;p=u.next())c(p.value)}catch(g){t={error:g}}finally{try{p&&!p.done&&(e=u.return)&&e.call(u)}finally{if(t)throw t.error}}this.fundPlanMap=new Map;var f=this.fundPlanMap;l=this.reffundTypePlan.getRefAll();try{for(var h=s(l),y=h.next();!y.done;y=h.next()){var d=y.value;f.set(d.type,d)}}catch(b){r={error:b}}finally{try{y&&!y.done&&(o=h.return)&&o.call(h)}finally{if(r)throw r.error}}this.fundTypeResIdMap=new Map;var m=this.fundTypeResIdMap;this.fundTypeMap=new Map;var v=this.fundTypeMap;l=this.reffund.getRefAll();try{for(var _=s(l),S=_.next();!S.done;S=_.next())d=S.value,m.set(d.resId,{ref:d}),v.set(d.type,d)}catch(C){n={error:C}}finally{try{S&&!S.done&&(i=_.return)&&i.call(_)}finally{if(n)throw n.error}}},e.prototype.GetEventProxy=function(){return this.eventProxy},e.prototype.UpdateData=function(t){var e,r,o,n;this.rewardStateMap.clear();var i=t.cmdFundDetail;try{for(var a=s(i),l=a.next();!l.done;l=a.next()){var c=l.value,u=this.fundTypeResIdMap.get(c.resId);u?u.vo=c:f.FW.LWX.error("fund\u8868\u6ca1\u6709\u5bf9\u5e94\u7684id:"+c.resId);var p=c.cmdFundRewardState;try{for(var h=(o=void 0,s(p)),y=h.next();!y.done;y=h.next()){var d=y.value;this.rewardStateMap.set(d.resId,d.state)}}catch(m){o={error:m}}finally{try{y&&!y.done&&(n=h.return)&&n.call(h)}finally{if(o)throw o.error}}}}catch(v){e={error:v}}finally{try{l&&!l.done&&(r=a.return)&&r.call(a)}finally{if(e)throw e.error}}this.UpdateTabOpenState(),this.eventProxy.execute("OnUpdateFund")},e.prototype.UpdateTabOpenState=function(){var t,e,r,o;try{for(var n=s(this.fundTypeMap),i=n.next();!i.done;i=n.next()){var a=c(i.value,2),l=a[0],p=a[1],h="[roleLevel:"+p.roleLevel+"]",y=f.FW.ExprMgr.GetResult(h),d=!0;try{for(var m=(r=void 0,s(this.reffundReward.getTlRef("type",p.type))),v=m.next();!v.done;v=m.next()){var _=v.value;if(2!=(this.rewardStateMap.get(_.resId)||0)){d=!1;break}}}catch(S){r={error:S}}finally{try{v&&!v.done&&(o=m.return)&&o.call(m)}finally{if(r)throw r.error}}y?d?this.tabOpenState.set(l,u.close):this.tabOpenState.set(l,u.open):this.tabOpenState.set(l,u.close)}}catch(g){t={error:g}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}},e.prototype.GetTabStateByFundType=function(t){return this.tabOpenState.get(t)||u.close},e.prototype.GetFormId=function(t,e){var r;return this.fundTypeResIdMap.forEach(function(o){o.ref.type==t&&o.ref.level==e&&(r=o.ref.fromId)}),r||(f.FW.LWX.error("\u57fa\u91d1\u627e\u4e0d\u5230\u5145\u503cid,"+t,","+e),null)},e.prototype.GetFundPlanInfoByType=function(t){return this.fundPlanMap.get(t)||(f.FW.LWX.error("\u57fa\u91d1\u65b9\u6848\u8868\u4e0d\u5b58\u5728\u6b64\u7c7b\u578b:"+t),null)},e.prototype.GetOpenTab=function(){var t,e,r=[];try{for(var o=s(this.tabOpenState),n=o.next();!n.done;n=o.next()){var i=c(n.value,2),a=i[0];i[1]==u.open&&r.push(a)}}catch(l){t={error:l}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}return r.sort(function(t,e){return t-e}),r[0]||p.GrowUp},e.prototype.GetFundVisable=function(){var t,e,r=!1;try{for(var o=s(this.tabOpenState),n=o.next();!n.done;n=o.next()){var i=c(n.value,2);i[0],i[1]==u.open&&(r=!0)}}catch(a){t={error:a}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}return r},e.prototype.GetIsHasFundReward=function(){var t,e,r=!1;try{for(var o=s(this.rewardStateMap.values()),n=o.next();!n.done;n=o.next())if(1==n.value){r=!0;break}}catch(i){t={error:i}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}return r},e.prototype.GetRewardStateByResId=function(t){return this.rewardStateMap.get(t)||0},e.prototype.GetRewardDataByType=function(t){return this.fundRewardData.filter(function(e){return e.type==t})},e.prototype.GetBuyState=function(t,e){var r,o=null;return this.fundTypeResIdMap.forEach(function(r){r.ref.type==t&&r.ref.level==e&&(o=r)}),(null===(r=o.vo)||void 0===r?void 0:r.buyState)||0},e.prototype.GetFundNameByType=function(t){var e;return(null===(e=this.fundPlanMap.get(t))||void 0===e?void 0:e.name)||""},e.prototype.RequestFundGetInfo=function(){return a(this,void 0,void 0,function(){var t,e,r=this;return l(this,function(){return e={},[2,(t=this).CtrlMgr.CtrlGameNet.send(new m.RequestFundGetInfo(e,t,function(t){t&&r.UpdateData(t)}))]})})},e.prototype.RequestFundGetReward=function(t){return a(this,void 0,void 0,function(){var e,r,o=this;return l(this,function(){return r=t,[2,(e=this).CtrlMgr.CtrlGameNet.send(new m.RequestFundGetReward(r,e,function(t){t.tlCmdGoods&&o.CtrlMgr.CtrlAlert.ShowGetReward(t.tlCmdGoods),o.RequestFundGetInfo()}))]})})},e.__cname="ModelFund",i([h.injectField("Ref")],e.prototype,"Ref",void 0),i([h.injectField("CtrlMgr")],e.prototype,"CtrlMgr",void 0),i([h.injectField("TimeUtil")],e.prototype,"timeUtil",void 0),i([h.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(v.ModelBehavior);r.ModelFund=_,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/container/Container":void 0,"../../../../framework/event/EventProxy":void 0,"../../../../framework/utils/Toolset":void 0,"../../../generated/requestMsg/RequestFundMsg":"RequestFundMsg","../ModelBehavior":"ModelBehavior"}],ModelGameConfig:[function(t,e,r){"use strict";cc._RF.push(e,"3e584FriKxDrbvVzRjhUimE","ModelGameConfig");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.ModelGameConfig=void 0;var c=t("../../../../framework/container/Container"),u=t("../../../../framework/FW"),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.gameConfigMap=new Map,e}return n(e,t),Object.defineProperty(e.prototype,"RefGameConfig",{get:function(){return this.Ref.RefMgrgameConfig},enumerable:!1,configurable:!0}),e.prototype.enter=function(){return a(this,void 0,Promise,function(){var t,e,r,o,n,i,a;return l(this,function(){if(!(t=this.RefGameConfig.getRefAll()))return u.FW.LWX.error("RefGameConfig\u6570\u636e\u5f02\u5e38"),[2,null];this.gameConfigMap=new Map,e=this.gameConfigMap;try{for(r=s(t),o=r.next();!o.done;o=r.next())n=o.value,e.set(n.key,n.value)}catch(l){i={error:l}}finally{try{o&&!o.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return[2,null]})})},e.prototype.GetGameConfigValueByKey=function(t){return this.gameConfigMap.has(t)?this.gameConfigMap.get(t):(u.FW.LWX.error("RefGameConfig\u4e0d\u5b58\u5728key:"+t),null)},e.__cname="ModelGameConfig",i([c.injectField("Ref")],e.prototype,"Ref",void 0),e}(t("../ModelBehavior").ModelBehavior);r.ModelGameConfig=p,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/container/Container":void 0,"../ModelBehavior":"ModelBehavior"}],ModelGoodsBag:[function(t,e,r){"use strict";cc._RF.push(e,"6dc5aCuVuJJR5wfOvrDr4Po","ModelGoodsBag");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.ModelGoodsBag=void 0;var a=t("../../../../framework/event/EventProxy"),l=t("../ModelBehavior"),s=t("../vo/Goods/Goods"),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.eventProxy=new a.EventProxy,e}return n(e,t),e.prototype.GetEventProxy=function(){return this.eventProxy},e.prototype.GetTlGoodsTypeByTlShowBag=function(t){var e,r,o=new Set;try{for(var n=i(t),a=n.next();!a.done;a=n.next())switch(a.value){case s.ShowBagType.equipBag:o.add(s.EGoodsType.weapon),o.add(s.EGoodsType.armor),o.add(s.EGoodsType.amulet),o.add(s.EGoodsType.belt),o.add(s.EGoodsType.glove),o.add(s.EGoodsType.shoe);break;case s.ShowBagType.itemBag_prop:o.add(s.EGoodsType.normal),o.add(s.EGoodsType.equipDrawing);break;case s.ShowBagType.itemBag_consumables:o.add(s.EGoodsType.chest);break;case s.ShowBagType.runeBag:o.add(s.EGoodsType.atkRune),o.add(s.EGoodsType.defRune);break;case s.ShowBagType.itemBag_EquipDrawing:o.add(s.EGoodsType.equipDrawing);break;case s.ShowBagType.itemBag_EquipMaterials:o.add(s.EGoodsType.equipMaterial)}}catch(l){e={error:l}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}return o},e.prototype.CheckIsNew=function(){return!1},e.prototype.ClickNew=function(){},e.prototype.ClearAllNewByShowGoodsType=function(){},e.__cname="ModelGoodsBag",e}(l.ModelBehavior);r.ModelGoodsBag=c,cc._RF.pop()},{"../../../../framework/event/EventProxy":void 0,"../ModelBehavior":"ModelBehavior","../vo/Goods/Goods":"Goods"}],ModelGoods:[function(t,e,r){"use strict";cc._RF.push(e,"ac1c2EJkVJGo7Smu6phPdUl","ModelGoods");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.ModelGoods=r.ECurrencyType=void 0;var c=t("../../../../framework/container/Container"),u=t("../../../../framework/FW"),p=t("../../../../framework/utils/StringUtil"),f=t("../ModelBehavior"),h=t("../vo/Goods/Goods");(function(t){t[t.sta=1]="sta",t[t.coin=2]="coin",t[t.xp=3]="xp",t[t.gem=4]="gem",t[t.ep=5]="ep",t[t.energy=6]="energy",t[t.reborn_coin=100101]="reborn_coin",t[t.gene=100102]="gene",t[t.silver_key=100201]="silver_key",t[t.gold_key=100202]="gold_key",t[t.diamond_key=100203]="diamond_key",t[t.cure=110101]="cure"})(r.ECurrencyType||(r.ECurrencyType={}));var y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.refMap=new Map,e}return n(e,t),Object.defineProperty(e.prototype,"RefItem",{get:function(){return this.Ref.RefMgritem},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"RefEquip",{get:function(){return this.Ref.RefMgrequip},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"RefRune",{get:function(){return this.Ref.RefMgrrune},enumerable:!1,configurable:!0}),e.prototype.enter=function(){return a(this,void 0,Promise,function(){return l(this,function(){return this.refMap=new Map,this.refMap.set(2,this.RefItem),this.refMap.set(3,this.RefEquip),this.refMap.set(4,this.RefRune),[2,null]})})},e.prototype.exit=function(){return this.refMap.clear(),this.refMap=null,null},e.prototype.GetRefByResId=function(t){var e,r,o=this.Ref.RefMgridConfig.getRefAll();try{for(var n=s(o),i=n.next();!i.done;i=n.next()){var a=i.value;if(t>=a.min&&t<a.max&&this.refMap.has(a.id))return this.refMap.get(a.id)}}catch(l){e={error:l}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}return this.RefItem},e.prototype.CreateGoods=function(t){var e;if(null!=this.GetRefByResId(t).getRef("resId",t)){if(null!=(e=this.GetGoodsBagByRefId(t).CreateByRefId(t,this.GetRefByResId(t))))return e;u.FW.Log.error("\u521b\u5efaGoods\u5bf9\u8c61\u5931\u8d25\uff0c\u8bf7\u68c0\u67e5\u914d\u7f6e\u662f\u5426\u6b63\u786e")}else u.FW.Log.error("goods\u8868\u6ca1\u627e\u5230\u7269\u54c1\u914d\u7f6e refId:"+t)},e.prototype.CreateGoodsByCmd=function(t){var e=this.CreateGoods(t.resId);return e&&(e.SetNumber(t.number),e.SetQuality(t.quality)),e},e.prototype.CreateTlGoods=function(t,e){var r,o,n=[];e||(e=function(){return!0});try{for(var i=s(t),a=i.next();!a.done;a=i.next()){var l=a.value,c=this.CreateGoods(l.resId);c&&e(c)&&(c.SetNumber(l.number),c.SetCmd(l),n.push(c))}}catch(u){r={error:u}}finally{try{a&&!a.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return n},e.prototype.GetRefByCurrency=function(t){var e=t;return this.Ref.RefMgritem.getRef("resId",e)},e.prototype.GetGoodsBagByRefId=function(t){var e=this.GetRefByResId(t).getRef("resId",t);switch(null==e&&u.FW.Log.error("refId = "+t+"\u627e\u4e0d\u5230\u5bf9\u5e94\u80cc\u5305"),e.type){case h.EGoodsType.weapon:case h.EGoodsType.armor:case h.EGoodsType.amulet:case h.EGoodsType.belt:case h.EGoodsType.glove:case h.EGoodsType.shoe:return this.ModelVO.VOEquipBag;case h.EGoodsType.atkRune:case h.EGoodsType.defRune:return this.ModelVO.VORuneBag;default:return this.ModelVO.VOItemBag}},e.prototype.GetGoodsNumberByRefId=function(t){var e=this.GetGoodsBagByRefId(t);return e.Get(t)?e.Get(t).GetNumber():0},e.prototype.GetQualityName=function(t,e){void 0===e&&(e=0);var r=this.Ref.RefMgrresitemquality.getRef("quality",t);return r?0==e?p.StringUtil.format("[color={0}]{1}[/color]",r.color,r.name):p.StringUtil.format("[color={0}]{1}[/color]",r.color,r.name+"+"+e):(u.FW.LWX.error("\u8fd4\u56de\u54c1\u8d28\u540d\u5b57\u548c\u989c\u8272\u51fa\u9519quality:"+t,"phase:"+e),"")},e.__cname="ModelGoods",i([c.injectField("Ref")],e.prototype,"Ref",void 0),i([c.injectField("ModelVO")],e.prototype,"ModelVO",void 0),e}(f.ModelBehavior);r.ModelGoods=y,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/container/Container":void 0,"../../../../framework/utils/StringUtil":void 0,"../ModelBehavior":"ModelBehavior","../vo/Goods/Goods":"Goods"}],ModelGuide:[function(t,e,r){"use strict";cc._RF.push(e,"5b511aaJ3dPJ70D2AUTxuVg","ModelGuide");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.ModelGuide=r.GuideKey=void 0;var a=t("../../../../engine/EngineMain"),l=t("../../../../framework/container/Container"),s=t("../../../../framework/utils/PromiseWrap"),c=t("../../../../framework/utils/StringUtil"),u=t("../../../generated/requestMsg/RequestGuideMsg"),p=t("../ModelBehavior");(function(t){t[t.null=0]="null",t[t.FirstEnterGame=1]="FirstEnterGame",t[t.FirstEnterFight=2]="FirstEnterFight",t[t.FirstSelectBattleSkill=3]="FirstSelectBattleSkill",t[t.FirstEnterMall=4]="FirstEnterMall"})(r.GuideKey||(r.GuideKey={}));var f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.SetState=function(t,e){if(null!=t){var r=this.ModelMgr.ModelVO.VORoleBag.GetOne();if(null!=r){var o=c.StringUtil.format("Guide_{0}_{1}",r.GetRoleId(),t);a.EngineMain.saveLocalStorage(o,e?1:0)}}},e.prototype.GetState=function(t){if(null==t)return!1;var e=this.ModelMgr.ModelVO.VORoleBag.GetOne();if(null==e)return!1;var r=c.StringUtil.format("Guide_{0}_{1}",e.GetRoleId(),t),o=Number(a.EngineMain.readLocalStorage(r,0));return null!=o&&1==o},e.prototype.CheckClientTriggerSection=function(t){var e=new s.PromiseWrap(null);return this.CheckClientIsCanTriggerMission(t)?(this.CheckServerIsCanTriggerMission(t).then(function(t){e.resolve(t)}).catch(function(){e.resolve(!1)}),e):(e.resolve(!1),e)},e.prototype.CheckClientIsCanTriggerMission=function(t){return!this.GetState(t)},e.prototype.CheckServerIsCanTriggerMission=function(t){var e=this,r=new s.PromiseWrap,o={guideKey:t.toString()};return this.CtrlGameNet.send(new u.RequestGuideRead(o,this,function(o){o.notExecute||e.SetState(t,!0),r.resolve(o.notExecute)}),!0).catch(function(){r.resolve(!1)}),r},e.prototype.RequestGuideRecord=function(t){var e=this,r={guideKey:t.toString()};this.CtrlGameNet.send(new u.RequestGuideRecord(r,this,function(){e.SetState(t,!0)}))},e.__cname="ModelGuide",i([l.injectField("CtrlGameNet")],e.prototype,"CtrlGameNet",void 0),i([l.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(p.ModelBehavior);r.ModelGuide=f,cc._RF.pop()},{"../../../../engine/EngineMain":void 0,"../../../../framework/container/Container":void 0,"../../../../framework/utils/PromiseWrap":void 0,"../../../../framework/utils/StringUtil":void 0,"../../../generated/requestMsg/RequestGuideMsg":"RequestGuideMsg","../ModelBehavior":"ModelBehavior"}],ModelHangling:[function(t,e,r){"use strict";cc._RF.push(e,"5a8b1rsgY9BoZfptLSc70Zp","ModelHangling");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.ModelHangling=void 0;var c=t("../../../../framework/container/Container"),u=t("../../../../framework/event/EventCallback"),p=t("../../../../framework/event/EventProxy"),f=t("../../../../framework/utils/Toolset"),h=t("../../../generated/requestMsg/RequestHangMsg"),y=t("../ModelBehavior"),d=t("../goods/ModelGoods"),m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.eventProxy=new p.EventProxy,e.canUpdateRed=!0,e.updateRed=new u.EventCallback,e}return n(e,t),e.prototype.enter=function(){return a(this,void 0,Promise,function(){return l(this,function(){return[2,this.InitData()]})})},e.prototype.exit=function(){f.ToolSet.destroyToolSet(this.toolSet)},e.prototype.GetEventProxy=function(){return this.eventProxy},e.prototype.InitData=function(){var t=this;return this.Ref||(this.Ref=c.Container.inst().getByAlias("Ref")),this.hangingData||(this.hangingData=this.Ref.RefMgrhanging.getRefAll()),this.roleSubset=this.ModelVO.VORoleBag.CreateSubset(),this.roleSubset.SetFilter(function(){return!0}),this.toolSet=f.ToolSet.createToolSet(),this.toolSet.addDefer(function(){t.ModelVO.VORoleBag.DestroySubset(t.roleSubset),t.roleSubset=null}),this.toolSet.addTimer(1e3,function(){var e=t.roleSubset.GetOneVO();if(e){var r=e.GetHangTime()/1e3;t.TimeUtil.now()-r>=t.TimeUtil.S_DayTime&&t.canUpdateRed&&(t.canUpdateRed=!1,t.updateRed.execute())}},this),Promise.all([])},e.prototype.RequestHanglingTime=function(){return a(this,void 0,void 0,function(){var t,e=this;return l(this,function(r){switch(r.label){case 0:return t={},[4,this.CtrlMgr.CtrlGameNet.send(new h.RequestHangTime(t,this,function(t){e.cacheTime=t.time}))];case 1:return r.sent(),this.cacheTime>86400&&(this.cacheTime=86400),[2,this.cacheTime]}})})},e.prototype.RequestGetHanglingReward=function(){var t=this;this.CtrlMgr.CtrlGameNet.send(new h.RequestHangGetReward({},this,function(e){e.tlCmdGoods&&(t.CtrlMgr.CtrlAlert.ShowGetReward(e.tlCmdGoods),t.canUpdateRed=!0,t.updateRed.execute())})),this.eventProxy.execute("updateReward")},e.prototype.GetRewardQuick=function(){var t=this;this.CtrlMgr.CtrlGameNet.send(new h.RequestHangQuick({},this,function(e){e.tlCmdGoods&&(t.CtrlMgr.CtrlAlert.ShowGetReward(e.tlCmdGoods),t.eventProxy.execute("timeChange"))}))},e.prototype.GetRewardByTime=function(t,e,r,o,n){var i,a,l,c;if(void 0===n&&(n=!1),!(t<600)){t=Math.floor(t/60);var u=[],p=e.coinPatrol,f=this.GetAddition(p,r,o,!1),h={resId:d.ECurrencyType.coin,number:""+Math.floor((p+f)*t)};u.push(h);var y=e.expPatrol,m=this.GetAddition(y,r,o,!1),v={resId:d.ECurrencyType.xp,number:""+Math.floor((y+m)*t)};if(u.push(v),n){var _=e.fastPatrolReward;try{for(var S=s(_),g=S.next();!g.done;g=S.next()){var b=g.value;u.push({resId:b.resId,number:b.number})}}catch(G){i={error:G}}finally{try{g&&!g.done&&(a=S.return)&&a.call(S)}finally{if(i)throw i.error}}}else{var C=e.hanging,R=this.GetHangingById(C);try{for(var M=s(R),w=M.next();!w.done;w=M.next()){var O=w.value,B=O.timing,P=Math.floor(t/B);P>0&&u.push({resId:O.reward,number:""+P})}}catch(k){l={error:k}}finally{try{w&&!w.done&&(c=M.return)&&c.call(M)}finally{if(l)throw l.error}}}return u}},e.prototype.GetAddition=function(t,e,r,o){void 0===o&&(o=!0);var n=0,i=0;e&&(n=.05),r&&(i=.1);var a=t*(n+i);return o?Math.floor(a):a},e.prototype.GetAdditionPercentage=function(t,e){var r=0,o=0;return t&&(r=5),e&&(o=10),r+o},e.prototype.GetHangingById=function(t){var e,r,o=[];try{for(var n=s(this.hangingData),i=n.next();!i.done;i=n.next()){var a=i.value;a.chapterId==t&&o.push(a)}}catch(l){e={error:l}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}return o},e.__cname="ModelHangling",i([c.injectField("CtrlMgr")],e.prototype,"CtrlMgr",void 0),i([c.injectField("Ref")],e.prototype,"Ref",void 0),i([c.injectField("ModelVO")],e.prototype,"ModelVO",void 0),i([c.injectField("TimeUtil")],e.prototype,"TimeUtil",void 0),i([c.injectField("ModelMonthCard")],e.prototype,"ModelMonthCard",void 0),e}(y.ModelBehavior);r.ModelHangling=m,cc._RF.pop()},{"../../../../framework/container/Container":void 0,"../../../../framework/event/EventCallback":void 0,"../../../../framework/event/EventProxy":void 0,"../../../../framework/utils/Toolset":void 0,"../../../generated/requestMsg/RequestHangMsg":"RequestHangMsg","../ModelBehavior":"ModelBehavior","../goods/ModelGoods":"ModelGoods"}],ModelHead:[function(t,e,r){"use strict";cc._RF.push(e,"f5de8zcm/pJJ6zSg8npzQD3","ModelHead");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.ModelHead=void 0;var c=t("../../../../framework/container/Container"),u=t("../../../../framework/FW"),p=t("../../../generated/requestMsg/RequestRoleMsg"),f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.enter=function(){return this.InitData()},e.prototype.exit=function(){return null},e.prototype.InitData=function(){return this.Ref||(this.Ref=c.Container.inst().getByAlias("Ref")),this.headData||(this.headData=this.Ref.RefMgrhead.getRefAll()),null},e.prototype.GetHeadByType=function(t){var e,r,o=this.headData,n=[];try{for(var i=s(o),a=i.next();!a.done;a=i.next()){var l=a.value;l.type==t&&n.push(l)}}catch(c){e={error:c}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return n},e.prototype.GetIconByitemId=function(t){var e,r,o=this.headData;try{for(var n=s(o),i=n.next();!i.done;i=n.next()){var a=i.value;if(a.itemId==t)return a.icon_Key}}catch(l){e={error:l}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}},e.prototype.CheckIsHead=function(t){var e,r;try{for(var o=s(this.headData),n=o.next();!n.done;n=o.next())if(n.value.itemId==t)return!0}catch(i){e={error:i}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return!1},e.prototype.RequestChangeName=function(t){return a(this,void 0,void 0,function(){var e;return l(this,function(r){switch(r.label){case 0:return e={name:t},[4,this.CtrlGameNet.send(new p.RequestRoleChangeName(e,this,function(){}))];case 1:return[2,r.sent()]}})})},e.prototype.RequestChangeImg=function(t){var e={resId:t};this.CtrlGameNet.send(new p.RequestRoleChangeImg(e,this,function(t){t.result?u.FW.LWX.log("\u4fee\u6539\u5934\u50cf\u6210\u529f"):u.FW.LWX.log("\u4fee\u6539\u5934\u50cf\u5931\u8d25")},function(){u.FW.LWX.error("\u4fee\u6539\u9519\u8bef\uff0c\u8bf7\u68c0\u67e5\uff0cRequestRoleChangeImg")}))},e.prototype.RequestChangeFram=function(t){var e={resId:t};this.CtrlGameNet.send(new p.RequestRoleChangeHeadFrame(e,this,function(t){t.result?u.FW.LWX.log("\u4fee\u6539\u5934\u50cf\u6846\u6210\u529f"):u.FW.LWX.log("\u4fee\u6539\u5934\u50cf\u6846\u5931\u8d25")},function(){u.FW.LWX.error("\u4fee\u6539\u9519\u8bef\uff0c\u8bf7\u68c0\u67e5\uff0cRequestRoleChangeHeadFrame")}))},e.__cname="ModelHead",i([c.injectField("Ref")],e.prototype,"Ref",void 0),i([c.injectField("CtrlGameNet")],e.prototype,"CtrlGameNet",void 0),e}(t("../ModelBehavior").ModelBehavior);r.ModelHead=f,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/container/Container":void 0,"../../../generated/requestMsg/RequestRoleMsg":"RequestRoleMsg","../ModelBehavior":"ModelBehavior"}],ModelHero:[function(t,e,r){"use strict";cc._RF.push(e,"a4fd0UswqVAsoIkTVyMvR3l","ModelHero");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},c=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.ModelHero=void 0;var u=t("../../../../framework/FW"),p=t("../../../../framework/container/Container"),f=t("../../../../framework/event/EventCallback"),h=t("../../../generated/requestMsg/RequestHeroMsg"),y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tmLevelAttr=new Map,e.eventCallBack=new f.EventCallback,e}return n(e,t),e.prototype.enter=function(){this.InitData()},e.prototype.exit=function(){this.tmLevelAttr.clear()},e.prototype.InitData=function(){var t,e;try{for(var r=s(this.Ref.RefMgrheroLevel.getRefAll()),o=r.next();!o.done;o=r.next()){var n=o.value,i=this.tmLevelAttr.get(n.lv-1),a=new Map;n.atk&&(i&&i.has("atk")?a.set("atk",i.get("atk")+n.atk):a.set("atk",n.atk)),n.hp&&(i&&i.has("hp")?a.set("hp",i.get("hp")+n.atk):a.set("hp",n.hp)),this.tmLevelAttr.set(n.lv,a)}}catch(l){t={error:l}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},e.prototype.GetHeroUnlockList=function(){return null==this.tlUnlock&&(this.tlUnlock=this.Ref.RefMgrheroUnlock.getRefAll().concat()),this.tlUnlock},e.prototype.GetHeroList=function(){return null==this.tlHero&&(this.tlHero=this.Ref.RefMgrhero.getRefAll().concat()),this.tlHero},e.prototype.GetRef=function(t){return this.Ref.RefMgritem.getRef("resId",t)},e.prototype.GetHeroRef=function(t){return this.Ref.RefMgrhero.getRef("id",t)},e.prototype.GetHeroAnimationRef=function(t){return this.Ref.RefMgrheroAnimation.getRef("resId",t)},e.prototype.GetHeroAudioRef=function(t){return this.Ref.RefMgrheroAudio.getRef("resId",t)},e.prototype.GetHeroShowGetRef=function(t){return this.Ref.RefMgrheroShowGet.getRef("resId",t)},e.prototype.GetNextUpgradeNeed=function(t){var e=this.GetHeroLevelRef(t+1);if(null!=e)return e.res},e.prototype.GetHeroLevelRef=function(t){return this.Ref.RefMgrheroLevel.getRef("lv",t)},e.prototype.GetIsMaxLevel=function(t){return null==this.GetNextUpgradeNeed(t)},e.prototype.GetHeroAttribute=function(t,e){var r,o,n,i;if(e>0){var a=new Map,l=this.tmLevelAttr.get(e);if(l)try{for(var u=s(l),p=u.next();!p.done;p=u.next()){var f=c(p.value,2),h=f[0],y=f[1];a.set(h,y)}}catch(g){r={error:g}}finally{try{p&&!p.done&&(o=u.return)&&o.call(u)}finally{if(r)throw r.error}}var d=this.GetHeroRef(t);try{for(var m=s(d.property),v=m.next();!v.done;v=m.next()){var _=v.value,S=a.get(_.key)||0;a.set(_.key,S+_.value)}}catch(b){n={error:b}}finally{try{v&&!v.done&&(i=m.return)&&i.call(m)}finally{if(n)throw n.error}}return a}return null},e.prototype.GetHeroSkillByHeroId=function(t){var e,r,o,n,i=this.ModelMgr.ModelVO.VOHeroBag.Get(t),a=i&&i.GetLevel()||0,l=new Set,c=this.Ref.RefMgrheroSkill.getTlRef("heroId",t);try{for(var u=s(c),p=u.next();!p.done;p=u.next()){var f=p.value;if(f.lv<=a&&f.skillGroup&&f.skillGroup.length>0)try{for(var h=(o=void 0,s(f.skillGroup)),y=h.next();!y.done;y=h.next()){var d=y.value;l.add(d)}}catch(m){o={error:m}}finally{try{y&&!y.done&&(n=h.return)&&n.call(h)}finally{if(o)throw o.error}}}}catch(v){e={error:v}}finally{try{p&&!p.done&&(r=u.return)&&r.call(u)}finally{if(e)throw e.error}}return l},e.prototype.GetTmPassiveSkill=function(t){var e,r,o=new Map;try{for(var n=s(this.Ref.RefMgrheroPassiveSkill.getTlRef("heroId",t)),i=n.next();!i.done;i=n.next()){var a=i.value,l=a.type,c=this.ModelMgr.ModelSkill.GetSkillById(a.skillGroup);o.set(l,c)}}catch(u){e={error:u}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}return o},e.prototype.GetTlPassiveSkill=function(t){return this.Ref.RefMgrheroPassiveSkill.getTlRef("heroId",t)},e.prototype.RequestChangHero=function(t){var e=this,r={resId:t};return this.CtrlMgr.CtrlGameNet.send(new h.RequestHeroChange(r,this,function(t){t&&e.CtrlMgr.CtrlAlert.ShowTips(u.FW.G_W("\u66f4\u6362\u82f1\u96c4\u6210\u529f")),e.eventCallBack.execute()}))},e.prototype.RequestLevelUp=function(t){var e={resId:t};this.CtrlMgr.CtrlGameNet.send(new h.RequestHeroLevelUp(e,this,function(){}))},e.prototype.RequesrLevelOneKey=function(t){var e={resId:t};this.CtrlMgr.CtrlGameNet.send(new h.RequestHeroLevelUpOneKey(e,this,function(){}))},e.prototype.RequestHeroOpen=function(){this.CtrlMgr.CtrlGameNet.send(new h.RequestHeroOpen({},this,function(){}))},e.prototype.RequestHeroUnlock=function(){return a(this,void 0,Promise,function(){var t,e;return l(this,function(r){switch(r.label){case 0:return t={},[4,this.CtrlMgr.CtrlGameNet.send(new h.RequestHeroUnlockGetInfo(t,this,function(t){t.cmdHeroUnlockInfo&&(e=t.cmdHeroUnlockInfo)}))];case 1:return r.sent(),[2,e]}})})},e.prototype.RequestGetRewardHero=function(t){return a(this,void 0,void 0,function(){var e,r=this;return l(this,function(o){switch(o.label){case 0:return e={resId:t},[4,this.CtrlMgr.CtrlGameNet.send(new h.RequestHeroUnlockReward(e,this,function(){r.CtrlMgr.CtrlAlert.ShowTips(u.FW.G_W("\u9886\u53d6\u82f1\u96c4\u6210\u529f"));var e=r.Ref.RefMgrheroUnlock.getRef("resId",t);r.LayerHeroGet.SetHero(e.heroId),r.LayerHeroGet.load()}))];case 1:return o.sent(),[2]}})})},e.__cname="ModelHero",i([p.injectField("LayerHeroGet")],e.prototype,"LayerHeroGet",void 0),i([p.injectField("Ref")],e.prototype,"Ref",void 0),i([p.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([p.injectField("CtrlMgr")],e.prototype,"CtrlMgr",void 0),e}(t("../ModelBehavior").ModelBehavior);r.ModelHero=y,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/container/Container":void 0,"../../../../framework/event/EventCallback":void 0,"../../../generated/requestMsg/RequestHeroMsg":"RequestHeroMsg","../ModelBehavior":"ModelBehavior"}],ModelIcon:[function(t,e,r){"use strict";cc._RF.push(e,"a01fdDbjkBGMreTkW1riQfk","ModelIcon");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.ModelIcon=void 0;var s=t("../../../../framework/container/Container"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),Object.defineProperty(e.prototype,"RefIcon",{get:function(){return this.Ref.RefMgricon},enumerable:!1,configurable:!0}),e.prototype.enter=function(){return a(this,void 0,Promise,function(){return l(this,function(){return[2]})})},e.prototype.exit=function(){return a(this,void 0,Promise,function(){return l(this,function(){return[2]})})},e.prototype.GetPath=function(t){var e=this.RefIcon.getRef("key",t);return e?e.path:null},e.__cname="ModelIcon",i([s.injectField("Ref")],e.prototype,"Ref",void 0),e}(t("../ModelBehavior").ModelBehavior);r.ModelIcon=c,cc._RF.pop()},{"../../../../framework/container/Container":void 0,"../ModelBehavior":"ModelBehavior"}],ModelJump:[function(t,e,r){"use strict";cc._RF.push(e,"9ddc2EHVsJGO71GJmA6hb05","ModelJump");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.ModelJump=void 0;var c=t("../../../../framework/container/Container"),u=t("../../../../framework/FW"),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tmJumpMap=new Map,e}return n(e,t),e.prototype.enter=function(){return a(this,void 0,Promise,function(){return l(this,function(){return this.InitRef(),[2]})})},Object.defineProperty(e.prototype,"RefJumpLayer",{get:function(){return this.Ref.RefMgrjumpLayer.getRefAll()},enumerable:!1,configurable:!0}),e.prototype.InitRef=function(){return a(this,void 0,void 0,function(){return l(this,function(){return this.Ref||(this.Ref=c.Container.inst().getByAlias("Ref")),this.InitData(),[2,null]})})},e.prototype.InitData=function(){var t,e;this.tmJumpMap=new Map;var r=this.RefJumpLayer;try{for(var o=s(r),n=o.next();!n.done;n=o.next()){var i=n.value;this.tmJumpMap.set(i.resId,i)}}catch(a){t={error:a}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}},e.prototype.GetJump=function(t){return this.tmJumpMap.get(t)||(u.FW.LWX.error("\u627e\u4e0d\u5230\u5bf9\u5e94\u7684jump\u8868\u6570\u636e\uff0c\u8bf7\u68c0\u67e5\uff1a "+t),null)},e.__cname="ModelJump",i([c.injectField("Ref")],e.prototype,"Ref",void 0),e}(t("../ModelBehavior").ModelBehavior);r.ModelJump=p,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/container/Container":void 0,"../ModelBehavior":"ModelBehavior"}],ModelLevel:[function(t,e,r){"use strict";cc._RF.push(e,"45af315EJdKobt9M9q7nZmS","ModelLevel");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},c=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.ModelLevel=void 0;var u=t("../../../../framework/container/Container"),p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.enter=function(){return a(this,void 0,Promise,function(){var t;return l(this,function(){return t=this.Ref.RefMgrlevel.getRefAll(),this.maxLevel=t[t.length-1].level,[2,null]})})},e.prototype.GetIsMaxLevel=function(t){return t>=this.maxLevel},e.prototype.GetLevelReward=function(t,e){var r,o,n,i,a,l,u=new Map,p=this.Ref.RefMgrlevel.getRefAll();try{for(var f=s(p),h=f.next();!h.done;h=f.next()){var y=h.value;if(t<y.level&&y.level<=e)try{for(var d=(n=void 0,s(y.reward)),m=d.next();!m.done;m=d.next()){var v=m.value,_=u.get(v.resId)?u.get(v.resId):0;_+=Number(v.number),u.set(v.resId,_)}}catch(M){n={error:M}}finally{try{m&&!m.done&&(i=d.return)&&i.call(d)}finally{if(n)throw n.error}}}}catch(w){r={error:w}}finally{try{h&&!h.done&&(o=f.return)&&o.call(f)}finally{if(r)throw r.error}}var S=[];try{for(var g=s(u),b=g.next();!b.done;b=g.next()){var C=c(b.value,2),R=C[0];_=C[1],S.push({resId:R,number:_})}}catch(O){a={error:O}}finally{try{b&&!b.done&&(l=g.return)&&l.call(g)}finally{if(a)throw a.error}}return S},e.__cname="ModelLevel",i([u.injectField("Ref")],e.prototype,"Ref",void 0),e}(t("../ModelBehavior").ModelBehavior);r.ModelLevel=p,cc._RF.pop()},{"../../../../framework/container/Container":void 0,"../ModelBehavior":"ModelBehavior"}],ModelLuckyCat:[function(t,e,r){"use strict";cc._RF.push(e,"0e3aaQ+uUxGiZ7fOrafrYdq","ModelLuckyCat");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.ModelLuckyCat=void 0;var s=t("../../../../framework/container/Container"),c=t("../../../../framework/utils/Toolset"),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.enter=function(){var t=this;this.toolSet=c.ToolSet.createToolSet(),this.toolSet.addListener(this.ModelMgr.ModelVO.VOLuckyCatBag.GetEventProxy(),"OnAdd",function(){var e=t.ModelMgr.ModelVO.VOLuckyCatBag.GetOne();t.SetLastProcess(e.GetProcess())},this)},e.prototype.exit=function(){return a(this,void 0,void 0,function(){return l(this,function(){return c.ToolSet.destroyToolSet(this.toolSet),this.toolSet=null,[2,null]})})},e.prototype.GetLastProcess=function(){return this.lastProcess||0},e.prototype.SetLastProcess=function(t){return this.lastProcess=t},e.prototype.GetIcon=function(){var t=this.ModelMgr.ModelVO.VOLuckyCatBag.GetOne();return t?t.GetRef().layerIcon:null},e.__cname="ModelLuckyCat",i([s.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([s.injectField("Ref")],e.prototype,"Ref",void 0),e}(t("../ModelBehavior").ModelBehavior);r.ModelLuckyCat=u,cc._RF.pop()},{"../../../../framework/container/Container":void 0,"../../../../framework/utils/Toolset":void 0,"../ModelBehavior":"ModelBehavior"}],ModelML:[function(t,e,r){"use strict";cc._RF.push(e,"388f6Wal9tK7YBxe1XlCcvj","ModelML");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.ModelML=void 0;var s=t("../../../../framework/container/Container"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),Object.defineProperty(e.prototype,"RefML",{get:function(){return this.Ref.RefMgrmL},enumerable:!1,configurable:!0}),e.prototype.enter=function(){return a(this,void 0,Promise,function(){var t;return l(this,function(){return(t=[]).push(this.RefML.preloadRef()),[2,Promise.all(t)]})})},e.prototype.GetTranslate=function(t){var e=t,r=this.RefML.getRef("key",t);return r&&(e=r.name),e},e.__cname="ModelML",i([s.injectField("Ref")],e.prototype,"Ref",void 0),e}(t("../ModelBehavior").ModelBehavior);r.ModelML=c,cc._RF.pop()},{"../../../../framework/container/Container":void 0,"../ModelBehavior":"ModelBehavior"}],ModelMail:[function(t,e,r){"use strict";cc._RF.push(e,"ebd7ew2DURG27frCuR6TJmD","ModelMail");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.ModelMail=void 0;var c=t("../../../../framework/container/Container"),u=t("../../../../framework/event/EventProxy"),p=t("../../../../framework/FW"),f=t("../../../generated/requestMsg/RequestMailMsg"),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.eventProxy=new u.EventProxy,e.mailContentMap=new Map,e}return n(e,t),e.prototype.GetmaxMail=function(){return 50},e.prototype.SetMailList=function(t){this.tlMail=t},e.prototype.GetMailList=function(){return this.tlMail},e.prototype.GetEventProxy=function(){return this.eventProxy},e.prototype.enter=function(){return a(this,void 0,Promise,function(){return l(this,function(){return this.InitData(),[2]})})},Object.defineProperty(e.prototype,"RefMailContentRef",{get:function(){return this.Ref.RefMgrmailContent},enumerable:!1,configurable:!0}),e.prototype.InitData=function(){var t,e;this.mailContentMap=new Map;try{for(var r=s(this.RefMailContentRef.getRefAll()),o=r.next();!o.done;o=r.next()){var n=o.value;this.mailContentMap.set(n.refId,n)}}catch(i){t={error:i}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},e.prototype.GetMailContentById=function(t){return this.mailContentMap.get(t)||(p.FW.LWX.error("\u90ae\u4ef6\u5185\u5bb9\u8868\u4e2d\u4e0d\u5b58\u5728id"),null)},e.prototype.UpdateMailList=function(){return a(this,void 0,void 0,function(){var t,e=this;return l(this,function(r){switch(r.label){case 0:return t={},[4,this.CtrlMgr.CtrlGameNet.send(new f.RequestMailList(t,this,function(t){var r=t.tlCmdMailList.concat();r=r.sort(function(t,e){return t.readState==e.readState?e.time-t.time:t.readState-e.readState}),e.SetMailList(r),e.eventProxy.execute("OnMailListChanged")}))];case 1:return r.sent(),[2]}})})},e.prototype.RequestMail=function(t){return a(this,void 0,void 0,function(){var e,r,o=this;return l(this,function(n){switch(n.label){case 0:return e={id:t},r=null,[4,this.CtrlMgr.CtrlGameNet.send(new f.RequestMailRead(e,this,function(e){r=e.cmdMail;var n=o.tlMail.findIndex(function(e){return e.id==t});p.FW.Log.log("index:",n),p.FW.Log.log("ID:",t),p.FW.Log.log(o.tlMail),-1!=n&&(o.tlMail[n].readState=1,o.eventProxy.execute("OnMailListChanged"))}))];case 1:return n.sent(),[2,r]}})})},e.prototype.RequestMailDraw=function(t){return a(this,void 0,void 0,function(){var e,r=this;return l(this,function(o){switch(o.label){case 0:return e={id:t},[4,this.CtrlMgr.CtrlGameNet.send(new f.RequestMailDraw(e,this,function(e){r.CtrlMgr.CtrlAlert.ShowGetReward(e.tlGoodsReward);var o=r.tlMail.findIndex(function(e){return e.id==t});-1!=o&&(r.tlMail[o].drawState=1,r.eventProxy.execute("OnMailListChanged"))}))];case 1:return[2,o.sent()]}})})},e.prototype.RequestMailDelete=function(t){return a(this,void 0,void 0,function(){var e,r=this;return l(this,function(o){switch(o.label){case 0:return e={id:t},[4,this.CtrlMgr.CtrlGameNet.send(new f.RequestMailDelete(e,this,function(){var e=r.tlMail.findIndex(function(e){return e.id==t});p.FW.Log.log("index:",e),p.FW.Log.log("ID:",t),p.FW.Log.log(r.tlMail),-1!=e&&(r.tlMail.splice(e,1),r.eventProxy.execute("OnMailListChanged"))}))];case 1:return[2,o.sent()]}})})},e.prototype.RequestMailDeleteList=function(){var t,e,r=this,o=[];try{for(var n=s(this.GetMailList()),i=n.next();!i.done;i=n.next()){var a=i.value;o.push(a.id)}}catch(c){t={error:c}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}var l={id:o};this.CtrlMgr.CtrlGameNet.send(new f.RequestMailDeleteList(l,this,function(){r.tlMail=[],r.eventProxy.execute("OnMailListChanged")}))},e.__cname="ModelMail",i([c.injectField("CtrlMgr")],e.prototype,"CtrlMgr",void 0),i([c.injectField("Ref")],e.prototype,"Ref",void 0),e}(t("../ModelBehavior").ModelBehavior);r.ModelMail=h,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/container/Container":void 0,"../../../../framework/event/EventProxy":void 0,"../../../generated/requestMsg/RequestMailMsg":"RequestMailMsg","../ModelBehavior":"ModelBehavior"}],ModelMallChapterGift:[function(t,e,r){"use strict";cc._RF.push(e,"9c344JdwDdKXJKyaCiDZ10b","ModelMallChapterGift");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a},c=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(s(arguments[e]));return t},u=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.ModelMallChapterGift=void 0;var p=t("../../../../framework/container/Container"),f=t("../../../../framework/FW"),h=t("../../../../framework/utils/StringUtil"),y=t("../../../../framework/utils/Toolset"),d=t("../ModelBehavior"),m=t("./ModelMall"),v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mallId=m.MallModule.ChapterGift,e.chapterGiftData=[],e}return n(e,t),e.prototype.enter=function(){return a(this,void 0,Promise,function(){return l(this,function(){return[2,this.InitRef()]})})},e.prototype.exit=function(){return y.ToolSet.destroyToolSet(this.toolSet),this.toolSet=null,null},e.prototype.InitRef=function(){return a(this,void 0,Promise,function(){var t,e,r=this;return l(this,function(){return this.Ref||(this.Ref=p.Container.inst().getByAlias("Ref")),(t=[]).push(this.Ref.RefMgrmallChapterGiftReward.preloadRef()),t.push(this.Ref.RefMgrmallChapterGift.preloadRef()),t.push(this.Ref.RefMgrgoods.preloadRef()),(e=Promise.all(t)).then(function(){r.InitData(),r.InitListen()}),[2,e]})})},e.prototype.InitListen=function(){var t=this;this.toolSet=y.ToolSet.createToolSet(),this.toolSet.addListener(this.ModelMgr.ModelMall.GetEventModuleOnChangeProxy(),"OnModuleOnChange",function(e){e==t.mallId&&t.UpdateChapterGiftModuleState()},this)},e.prototype.InitData=function(){this.chapterGiftData=c(this.Ref.RefMgrmallChapterGift.getRefAll())},e.prototype.GetChaptGiftRefData=function(){var t,e,r=[];try{for(var o=u(this.chapterGiftData),n=o.next();!n.done;n=o.next()){var i=n.value;if(0==this.GetChapterGiftState(i.id))if(i.condition){var a=h.StringUtil.format("[finishChapter:{0}]",i.condition);f.FW.ExprMgr.GetResult(a)&&r.push(i)}else r.push(i)}}catch(l){t={error:l}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}return r.sort(function(t,e){return t.id-e.id}),r},e.prototype.GetChapterGiftState=function(t){var e,r=null===(e=this.ModelMgr.ModelMall.GetCmdMallDatayId(this.mallId))||void 0===e?void 0:e.GetChapterGift().find(function(e){return e.resId==t});return r?r.state:0},e.prototype.UpdateChapterGiftModuleState=function(){var t=this.GetChaptGiftRefData().length>0?m.ChangeModuleType.open:m.ChangeModuleType.close;this.ModelMgr.ModelMall.UpdateOpenModuleMap(t,this.mallId)},e.__cname="ModelMallChapterGift",i([p.injectField("Ref")],e.prototype,"Ref",void 0),i([p.injectField("Net")],e.prototype,"Net",void 0),i([p.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(d.ModelBehavior);r.ModelMallChapterGift=v,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/container/Container":void 0,"../../../../framework/utils/StringUtil":void 0,"../../../../framework/utils/Toolset":void 0,"../ModelBehavior":"ModelBehavior","./ModelMall":"ModelMall"}],ModelMallDailyShop:[function(t,e,r){"use strict";cc._RF.push(e,"3e32boqF+BCsZn81SWLABLr","ModelMallDailyShop");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.ModelMallDailyShop=void 0;var c=t("../../../../engine/EngineMain"),u=t("../../../../framework/container/Container"),p=t("../../../../framework/event/EventCallback"),f=t("../../../../framework/FW"),h=t("../../../../framework/utils/Toolset"),y=t("../../../generated/requestMsg/RequestMallMsg"),d=t("../ModelBehavior"),m=t("./ModelMall"),v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mallId=m.MallModule.DailyShop,e.isCanUpdateRD=!0,e.updateRed=new p.EventCallback,e.dailyShopData=[],e.dailyShopRewardMap=new Map,e.ids=new Set,e.cacaheIds=new Set,e}return n(e,t),e.prototype.enter=function(){return a(this,void 0,Promise,function(){return l(this,function(){return[2,this.InitRef()]})})},e.prototype.exit=function(){return h.ToolSet.destroyToolSet(this.toolSet),this.toolSet=null,null},e.prototype.InitRef=function(){return a(this,void 0,Promise,function(){var t,e,r=this;return l(this,function(){return this.Ref||(this.Ref=u.Container.inst().getByAlias("Ref")),(t=[]).push(this.Ref.RefMgrmallDailyShop.preloadRef()),t.push(this.Ref.RefMgrmallDailyShopReward.preloadRef()),(e=Promise.all(t)).then(function(){r.InitData()}),[2,e]})})},e.prototype.InitData=function(){var t,e;this.InitListen(),this.UpdateCacheId(),this.dailyShopRewardMap=new Map;var r=this.dailyShopRewardMap;try{for(var o=s(this.Ref.RefMgrmallDailyShopReward.getRefAll()),n=o.next();!n.done;n=o.next()){var i=n.value;r.set(i.id,i)}}catch(a){t={error:a}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}this.dailyShopData.sort(function(t,e){return t.sortId-e.sortId})},e.prototype.InitListen=function(){var t=this;t.toolSet=h.ToolSet.createToolSet(),t.toolSet.addTimer(1e3,function(){var e,r;try{for(var o=s(t.dailyShopData),n=o.next();!n.done;n=o.next()){var i=n.value;t.CheckRDByResId(i.id)&&t.isCanUpdateRD&&(t.isCanUpdateRD=!1,f.FW.LWX.log("\u6bcf\u65e5\u5546\u5e97\u7ea2\u70b9\u66f4\u65b0"),t.updateRed.execute())}}catch(a){e={error:a}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}},this)},e.prototype.GetDailyShopDataByResId=function(t){return this.dailyShopData.find(function(e){return e.id==t})||(f.FW.LWX.log("\u6ca1\u6709\u89e3\u9501\u6216\u4e0d\u5b58\u5728\u7684\u5546\u54c1"+t),null)},Object.defineProperty(e.prototype,"DailyShopIdKey",{get:function(){return"DailyShopId"+c.EngineMain.readLocalStorage("account_num")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"DailyShopOenTimeIdKey",{get:function(){return"OpenTime"+c.EngineMain.readLocalStorage("account_num")},enumerable:!1,configurable:!0}),e.prototype.UpdateDailyShopRefData=function(){var t,e;this.dailyShopData.length=0,this.ids.clear();var r=this.TimeUtil.time3String(this.TimeUtil.now(),!0),o=r==c.EngineMain.readLocalStorage(this.DailyShopOenTimeIdKey,""),n=this.cacaheIds.size>0;try{for(var i=s(this.Ref.RefMgrmallDailyShop.getRefAll()),a=i.next();!a.done;a=i.next()){var l=a.value;o&&n?this.cacaheIds.has(l.id)&&this.dailyShopData.push(l):null!=l.condittion?f.FW.ExprMgr.GetResult(l.condittion)&&(this.ids.add(l.id),this.dailyShopData.push(l)):(this.ids.add(l.id),this.dailyShopData.push(l))}}catch(p){t={error:p}}finally{try{a&&!a.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}if(!o||!n){var u=Array.from(this.ids.values());c.EngineMain.saveLocalStorage(this.DailyShopOenTimeIdKey,r),c.EngineMain.saveLocalStorage(this.DailyShopIdKey,u.toString()),this.UpdateCacheId()}},e.prototype.UpdateCacheId=function(){var t,e;this.cacaheIds.clear();var r=this.TimeUtil.time3String(this.TimeUtil.now(),!0)==c.EngineMain.readLocalStorage(this.DailyShopOenTimeIdKey,"");if(this.cacaheIds=new Set,r){var o=c.EngineMain.readLocalStorage(this.DailyShopIdKey,"").split(",");try{for(var n=s(o),i=n.next();!i.done;i=n.next()){var a=i.value;""!=a&&this.cacaheIds.add(Number(a))}}catch(l){t={error:l}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}}},e.prototype.GetDailyShopRefData=function(){return this.UpdateDailyShopRefData(),this.dailyShopData},e.prototype.GetDailyShopRefRewardById=function(t){return this.dailyShopRewardMap.has(t)?this.dailyShopRewardMap.get(t):(f.FW.LWX.error("\u83b7\u53d6\u6bcf\u65e5\u5546\u5e97\u5956\u52b1\u51fa\u9519,\u8bf7\u68c0\u67e5!!"+t),null)},e.prototype.GetCmdMallData=function(){return this.ModelMgr.ModelMall.GetCmdMallDatayId(this.mallId)||null},e.prototype.GetDailyShopBuyCountByResId=function(t){var e,r=null===(e=this.GetCmdMallData())||void 0===e?void 0:e.GetMalDailyShop().find(function(e){return e.resId==t});return(null==r?void 0:r.buyCount)||0},e.prototype.GetDailyShopAdTimeByResId=function(t){var e,r=null===(e=this.GetCmdMallData())||void 0===e?void 0:e.GetMalDailyShop().find(function(e){return e.resId==t});return(null==r?void 0:r.adTime)||0},e.prototype.GetDailyShopDiscountByResId=function(t){var e,r=null===(e=this.GetCmdMallData())||void 0===e?void 0:e.GetMalDailyShop().find(function(e){return e.resId==t});return(null==r?void 0:r.discount)||0},e.prototype.GetDailyShopFinalNumberByResId=function(t){var e,r=null===(e=this.GetCmdMallData())||void 0===e?void 0:e.GetMalDailyShop().find(function(e){return e.resId==t});return r?Math.ceil(Number(r.finalNumber)):(f.FW.LWX.error("\u6bcf\u65e5\u5546\u5e97\u6700\u7ec8\u4ef7\u683c\u4e0d\u5b58\u5728\uff0c\u8bf7\u68c0\u67e5"),0)},e.prototype.GetDailyShopRewardIdByResId=function(t){var e,r=null===(e=this.GetCmdMallData())||void 0===e?void 0:e.GetMalDailyShop().find(function(e){return e.resId==t});return(null==r?void 0:r.rewardId)||0},e.prototype.GetDailyShopOriginalByResId=function(t){var e,r=null===(e=this.GetCmdMallData())||void 0===e?void 0:e.GetMalDailyShop().find(function(e){return e.resId==t});return(null==r?void 0:r.original)||0},e.prototype.CheckRDByResId=function(t){var e=!1,r=this.GetDailyShopDataByResId(t),o=60*r.cdTimes,n=r.number;if(0==n)return!1;var i=this.TimeUtil.now(),a=this.GetDailyShopBuyCountByResId(t),l=this.GetDailyShopAdTimeByResId(t)/1e3;return a<n&&!(i-l<o)&&(e=!0),e},e.prototype.RequestMallDailyShopBuy=function(t){var e=this,r=t;this.CtrlMgr.CtrlGameNet.send(new y.RequestMallDailyShopBuy(r,this,function(t){t.tlCmdGoods&&e.CtrlMgr.CtrlAlert.ShowGetReward(t.tlCmdGoods),e.isCanUpdateRD=!0,e.updateRed.execute()}))},e.__cname="ModelMallDailyShop",i([u.injectField("CtrlMgr")],e.prototype,"CtrlMgr",void 0),i([u.injectField("Ref")],e.prototype,"Ref",void 0),i([u.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([u.injectField("TimeUtil")],e.prototype,"TimeUtil",void 0),e}(d.ModelBehavior);r.ModelMallDailyShop=v,cc._RF.pop()},{"../../../../engine/EngineMain":void 0,"../../../../framework/FW":void 0,"../../../../framework/container/Container":void 0,"../../../../framework/event/EventCallback":void 0,"../../../../framework/utils/Toolset":void 0,"../../../generated/requestMsg/RequestMallMsg":"RequestMallMsg","../ModelBehavior":"ModelBehavior","./ModelMall":"ModelMall"}],ModelMallGloden:[function(t,e,r){"use strict";cc._RF.push(e,"c170bUdQBtGjKqS+VNwVrEc","ModelMallGloden");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a},c=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(s(arguments[e]));return t},u=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.ModelMallGloden=void 0;var p=t("../../../../framework/container/Container"),f=t("../../../../framework/event/EventCallback"),h=t("../../../../framework/FW"),y=t("../../../../framework/utils/Toolset"),d=t("../../../generated/requestMsg/RequestMallMsg"),m=t("../ModelBehavior"),v=t("./ModelMall"),_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mallId=v.MallModule.Gloden,e.updateRed=new f.EventCallback,e.coinData=[],e.coinRewardMap=new Map,e}return n(e,t),e.prototype.enter=function(){return a(this,void 0,Promise,function(){return l(this,function(){return this.InitListen(),[2,this.InitRef()]})})},e.prototype.exit=function(){return y.ToolSet.destroyToolSet(this.toolSet),this.toolSet=null,null},e.prototype.InitListen=function(){var t=this;this.toolSet=y.ToolSet.createToolSet(),this.toolSet.addListener(this.ModelMgr.ModelMall.GetEventModuleOnChangeProxy(),"OnModuleOnChange",function(e){e==t.mallId&&t.UpdateRD()},this)},e.prototype.InitRef=function(){var t=this;this.Ref||(this.Ref=p.Container.inst().getByAlias("Ref"));var e=[];e.push(this.Ref.RefMgrmallCoin.preloadRef()),e.push(this.Ref.RefMgrmallCoinReward.preloadRef());var r=Promise.all(e);return r.then(function(){t.InitData()}),r},e.prototype.InitData=function(){var t,e;this.coinRewardMap=new Map;var r=this.coinRewardMap,o=this.Ref.RefMgrmallCoin.getRefAll();this.coinData=c(o);try{for(var n=u(this.coinData),i=n.next();!i.done;i=n.next()){var a=i.value.contentIds[0];r.set(a,this.Ref.RefMgrmallCoinReward.getRef("resId",a))}}catch(l){t={error:l}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.coinData.sort(function(t,e){return t.sortId-e.sortId})},e.prototype.GetCoinData=function(){return this.coinData},e.prototype.GetCoinDataByResId=function(t){return this.coinData.find(function(e){return e.resId==t})},e.prototype.GetCoinRewardById=function(t){return this.coinRewardMap.has(t)?this.coinRewardMap.get(t):(h.FW.LWX.error("\u91d1\u5e01\u5956\u6c60\u8868\u4e2d\u6ca1\u6709\u8be5\u6570\u636e,\u8bf7\u68c0\u67e5"+t),null)},e.prototype.GetCmdMallData=function(){return this.ModelMgr.ModelMall.GetCmdMallDatayId(this.mallId)||null},e.prototype.GetChapterCoinFreeTimes=function(t){var e,r=null===(e=this.GetCmdMallData())||void 0===e?void 0:e.GetMallCoin().find(function(e){return e.resId==t});return r?r.freeTime:0},e.prototype.GetCoinBuycount=function(t){var e,r=null===(e=this.GetCmdMallData())||void 0===e?void 0:e.GetMallCoin().find(function(e){return e.resId==t});return r?r.buyCount:0},e.prototype.UpdateRD=function(){this.updateRed.execute()},e.prototype.CheckRDByResId=function(t){var e=!1;return this.GetCoinBuycount(t)<this.GetCoinDataByResId(t).number&&(e=!0),e},e.prototype.RequestMallCoinBuy=function(t){var e=t;this.CtrlGameNet.send(new d.RequestMallCoinBuy(e,this,function(){},function(t){h.FW.LWX.error("\u91d1\u5e01\u8d2d\u4e70\u5931\u8d25,\u8bf7\u68c0\u67e5!!!!"+t)}))},e.__cname="ModelMallGloden",i([p.injectField("CtrlGameNet")],e.prototype,"CtrlGameNet",void 0),i([p.injectField("Ref")],e.prototype,"Ref",void 0),i([p.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(m.ModelBehavior);r.ModelMallGloden=_,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/container/Container":void 0,"../../../../framework/event/EventCallback":void 0,"../../../../framework/utils/Toolset":void 0,"../../../generated/requestMsg/RequestMallMsg":"RequestMallMsg","../ModelBehavior":"ModelBehavior","./ModelMall":"ModelMall"}],ModelMallLuckDraw:[function(t,e,r){"use strict";cc._RF.push(e,"75621G4tAFGuoZ+mX/gxckO","ModelMallLuckDraw");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.ModelMallLuckDraw=void 0;var c=t("../../../../framework/FW"),u=t("../../../../framework/container/Container"),p=t("../../../../framework/event/EventCallback"),f=t("../../../../framework/event/EventProxy"),h=t("../../../../framework/utils/Toolset"),y=t("../../../generated/requestMsg/RequestMallMsg"),d=t("../ModelBehavior"),m=t("./ModelMall"),v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.luckDrawRefInfo=[],e.luckDrawRewardMap=new Map,e.mallId=m.MallModule.LuckDraw,e.updateRed=new p.EventCallback,e.isCanUpdateRD=!0,e.eventLuckDrawResultProxy=new f.EventProxy,e}return n(e,t),e.prototype.enter=function(){return a(this,void 0,Promise,function(){return l(this,function(){return this.InitListen(),[2,this.InitRef()]})})},e.prototype.exit=function(){return h.ToolSet.destroyToolSet(this.toolSet),this.toolSet=null,null},e.prototype.InitRef=function(){var t=this;this.Ref||(this.Ref=u.Container.inst().getByAlias("Ref"));var e=[];e.push(this.Ref.RefMgrluckDraw.preloadRef()),e.push(this.Ref.RefMgrluckDrawReward.preloadRef());var r=Promise.all(e);return r.then(function(){t.InitData()}),r},e.prototype.InitListen=function(){var t=this;this.toolSet=h.ToolSet.createToolSet(),this.toolSet.addTimer(1e3,function(){var e,r;if(t.GetCmdMallData())try{for(var o=s(t.luckDrawRefInfo),n=o.next();!n.done;n=o.next()){var i=n.value;t.CheckIsAdCdByResId(i.id)&&t.isCanUpdateRD&&(t.isCanUpdateRD=!1,c.FW.LWX.log("\u5347\u5b98\u53d1\u8d22\u7ea2\u70b9\u66f4\u65b0"),t.updateRed.execute())}}catch(a){e={error:a}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}},this),this.toolSet.addListener(this.ModelMgr.ModelMall.GetEventModuleOnChangeProxy(),"OnModuleOnChange",function(e){e==t.mallId&&(t.isCanUpdateRD=!0,t.updateRed.execute())},this),this.itemSubset=this.ModelMgr.ModelVO.VOItemBag.CreateSubset(),this.itemSubset.SetFilter(function(t){return!!t&&!!m.LuckDrawPropSet.has(t.GetRefId())}),this.toolSet.addListener(this.itemSubset.GetEventProxy(),"OnChanged",function(){t.updateNextFrame()},this),this.toolSet.addDefer(function(){t.ModelMgr.ModelVO.VOItemBag.DestroySubset(t.itemSubset),t.itemSubset=null})},e.prototype.InitData=function(){var t,e,r,o,n=this;this.luckDrawRefInfo=this.Ref.RefMgrluckDraw.getRefAll();try{for(var i=s(this.Ref.RefMgrluckDraw.getRefAll()),a=i.next();!a.done;a=i.next()){var l=a.value,c=[],u=0,p=function(t){var e=t.reward[0],r=f.ModelMgr.ModelGoods.CreateGoodsByCmd({resId:e.resId,quality:e.quality,number:String(e.number)}),o=r.GetIsSEquip(),n=c.find(function(t){return t.quality==r.GetQuality()&&t.isS==o});n?(n.equips.push(r),n.weight+=t.showWeight):c.push({quality:e.quality,isS:r.GetIsSEquip(),weight:t.showWeight,equips:[r]}),u+=t.showWeight},f=this;try{for(var h=(r=void 0,s(this.Ref.RefMgrluckDrawReward.getTlRef("key",l.reward[0]))),y=h.next();!y.done;y=h.next())p(y.value)}catch(d){r={error:d}}finally{try{y&&!y.done&&(o=h.return)&&o.call(h)}finally{if(r)throw r.error}}c.sort(function(t,e){return n.Sort(t,e)}),this.luckDrawRewardMap.set(l.id,{rewardData:c,totalWeight:u})}}catch(m){t={error:m}}finally{try{a&&!a.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}},e.prototype.GetLuckDrawRefInfo=function(){return this.luckDrawRefInfo},e.prototype.GetLuckDrawRefInfoByResId=function(t){return this.luckDrawRefInfo.find(function(e){return e.id==t})||(c.FW.LWX.log("\u5347\u5b98\u53d1\u8d22\u4e0d\u5b58\u5728id\u5bf9\u5e94\u7684\u4fe1\u606f"+t),null)},e.prototype.GetCostItem=function(t){var e=this.luckDrawRefInfo.find(function(e){return e.id==t});return e?e.costItem:(c.FW.LWX.log("\u5347\u5b98\u53d1\u8d22\u4e0d\u5b58\u5728id\u5bf9\u5e94\u7684\u4fe1\u606f"+t),null)},e.prototype.GetLuckDrawReward=function(){return this.luckDrawRewardMap},e.prototype.GetCmdMallData=function(){return this.ModelMgr.ModelMall.GetCmdMallDatayId(this.mallId)||null},e.prototype.GetLuckDrawBuyCount=function(t){var e,r=null===(e=this.GetCmdMallData())||void 0===e?void 0:e.GetMallLuckDraw().find(function(e){return e.resId==t});return r?r.buyCount:0},e.prototype.GetLuckDrawBigPrizeCount=function(t){var e,r=null===(e=this.GetCmdMallData())||void 0===e?void 0:e.GetMallLuckDraw().find(function(e){return e.resId==t});return r?r.bigPrizeCount:0},e.prototype.GetLuckDrawFreeTime=function(t){var e,r=null===(e=this.GetCmdMallData())||void 0===e?void 0:e.GetMallLuckDraw().find(function(e){return e.resId==t});return r?r.freeTime:0},e.prototype.Sort=function(t,e){var r=t.quality,o=e.quality;return r!=o?o-r:(r=t.isS?1:0)!=(o=e.isS?1:0)?o-r:(r=t.GetGoodsType())!=(o=e.GetGoodsType())?r-o:-1},e.prototype.GetItemVOSubSet=function(){return this.itemSubset},e.prototype.updateNextFrame=function(){var t=this;this.isupdate||(this.isupdate=!0,this.toolSet.addDelay(16,function(){t.isupdate=!1,t.OnUpdate()},this))},e.prototype.OnUpdate=function(){this.updateRed.execute(),this.ModelMgr.ModelMall.GetEventModuleOnChangeProxy().execute("OnModuleOnChange",this.mallId)},e.prototype.GetEventLuckDrawResultProxy=function(){return this.eventLuckDrawResultProxy},e.prototype.DrawResult=function(t){var e,r,o=[];try{for(var n=s(t.tlCmdGoods),i=n.next();!i.done;i=n.next()){var a=i.value,l=Number(a.number);for(a.number="1";l--;)o.push(this.ModelMgr.ModelGoods.CreateGoodsByCmd(a))}}catch(c){e={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}return o},e.prototype.CheckIsAdCdByResId=function(t){var e=this.GetLuckDrawRefInfoByResId(t),r=this.GetLuckDrawFreeTime(e.id)/1e3;return this.TimeUtil.now()-r>3600*e.cdTime},e.prototype.RequestMallLuckDraw=function(t){var e=this,r=t;this.CtrlGameNet.send(new y.RequestMallLuckDraw(r,this,function(t){if(t.tlCmdGoods.length>0){var r=e.DrawResult(t);e.eventLuckDrawResultProxy.execute("OnLuckDrawResult",!0,r)}}))},e.__cname="ModelMallLuckDraw",i([u.injectField("CtrlGameNet")],e.prototype,"CtrlGameNet",void 0),i([u.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([u.injectField("Ref")],e.prototype,"Ref",void 0),i([u.injectField("TimeUtil")],e.prototype,"TimeUtil",void 0),e}(d.ModelBehavior);r.ModelMallLuckDraw=v,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/container/Container":void 0,"../../../../framework/event/EventCallback":void 0,"../../../../framework/event/EventProxy":void 0,"../../../../framework/utils/Toolset":void 0,"../../../generated/requestMsg/RequestMallMsg":"RequestMallMsg","../ModelBehavior":"ModelBehavior","./ModelMall":"ModelMall"}],ModelMallRecharge:[function(t,e,r){"use strict";cc._RF.push(e,"6d67aPO2TJOer4VY5bdWNSB","ModelMallRecharge");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a},c=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(s(arguments[e]));return t},u=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.ModelMallRecharge=void 0;var p=t("../../../../framework/container/Container"),f=t("../../../../framework/FW"),h=t("../ModelBehavior"),y=t("./ModelMall"),d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mallId=y.MallModule.Recharge,e.rechargedata=[],e.chargeDataMap=new Map,e}return n(e,t),e.prototype.enter=function(){return a(this,void 0,Promise,function(){return l(this,function(){return[2,this.InitRef()]})})},e.prototype.InitRef=function(){var t=this;this.Ref||(this.Ref=p.Container.inst().getByAlias("Ref"));var e=[];e.push(this.Ref.RefMgrgoods.preloadRef()),e.push(this.Ref.RefMgrmallCharge.preloadRef());var r=Promise.all(e);return r.then(function(){t.InitData()}),r},e.prototype.InitData=function(){var t,e,r=this.Ref.RefMgrmallCharge.getRefAll();this.rechargedata=c(r),this.chargeDataMap=new Map;var o=this.chargeDataMap;try{for(var n=u(this.rechargedata),i=n.next();!i.done;i=n.next()){var a=i.value;f.FW.LWX.log(a.fromId);var l=this.Ref.RefMgrgoods.getRef("fromId",a.fromId);f.FW.LWX.log(l);var s=this.Ref.RefMgrpayChannel.getRef("key",l.key);o.set(a.id,{refgoods:l,refpayChannel:s})}}catch(p){t={error:p}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.rechargedata.sort(function(t,e){return t.sort-e.sort})},e.prototype.GetRechargeData=function(){return this.rechargedata},e.prototype.GetChargeDataById=function(t){return this.chargeDataMap.has(t)?this.chargeDataMap.get(t):(f.FW.LWX.error("\u5145\u503c\u8868\u6ca1\u6709\u5bf9\u5e94\u7684\u6570\u636e,",t),null)},e.prototype.OnUpdate=function(){this.ModelMgr.ModelMall.GetEventModuleOnChangeProxy().execute("OnModuleOnChange",this.mallId)},e.prototype.GetFirstChargeState=function(t){var e,r=null===(e=this.ModelMgr.ModelMall.GetCmdMallDatayId(this.mallId))||void 0===e?void 0:e.GetMallRecharge().find(function(e){return e.resId==t});return r?r.state:0},e.__cname="ModelMallRecharge",i([p.injectField("Ref")],e.prototype,"Ref",void 0),i([p.injectField("Net")],e.prototype,"Net",void 0),i([p.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(h.ModelBehavior);r.ModelMallRecharge=d,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/container/Container":void 0,"../ModelBehavior":"ModelBehavior","./ModelMall":"ModelMall"}],ModelMallSEquip:[function(t,e,r){"use strict";cc._RF.push(e,"5b7017O0QlISqMG7siVG1Xl","ModelMallSEquip");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.ModelMallSEquip=void 0;var c=t("../../../../framework/FW"),u=t("../../../../framework/container/Container"),p=t("../../../../framework/event/EventCallback"),f=t("../../../../framework/event/EventProxy"),h=t("../../../../framework/event/FWEventCenter"),y=t("../../../../framework/utils/Toolset"),d=t("../../../generated/requestMsg/RequestMallMsg"),m=t("../ModelBehavior"),v=t("./ModelMall"),_=[v.MallModule.SEquip,v.MallModule.LimitLuckDraw],S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.updateRed=new p.EventCallback,e.limitSEquipData=[],e.openDrawInfoMap=new Map,e.drawRewardMap=new Map,e.eventSEquipDrawProxy=new f.EventProxy,e}return n(e,t),Object.defineProperty(e.prototype,"RefMgrSEquipReward",{get:function(){return this.Ref.RefMgrsEquipReward},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"RefMgrLimitSEquipReward",{get:function(){return this.Ref.RefMgrlimitSEquipReward},enumerable:!1,configurable:!0}),e.prototype.enter=function(){return a(this,void 0,Promise,function(){return l(this,function(){return[2,this.InitRef()]})})},e.prototype.exit=function(){return a(this,void 0,void 0,function(){return l(this,function(){return y.ToolSet.destroyToolSet(this.toolSet),this.toolSet=null,[2,null]})})},e.prototype.InitRef=function(){var t=this;this.Ref||(this.Ref=u.Container.inst().getByAlias("Ref"));var e=[];e.push(this.Ref.RefMgrsEquipReward.preloadRef()),e.push(this.Ref.RefMgrsEquip.preloadRef()),e.push(this.Ref.RefMgrlimitSEquipReward.preloadRef());var r=Promise.all(e);return r.then(function(){t.InitData()}),r},e.prototype.InitData=function(){var t,e;try{for(var r=s(this.Ref.RefMgrsEquip.getRefAll()),o=r.next();!o.done;o=r.next()){var n=o.value,i=n.type;if(i==v.MallChestType.SEquip){var a=this.RefMgrSEquipReward.getTlRef("groupId",n.reward);this.assert(null!=a,"RefMgrSEquipReward \u914d\u7f6e\u8868\u6709\u8bef\uff0c\u65e0\u6cd5\u627e\u5230 groupId: "+n.reward),this.DearRefReward(n.id,a)}else i==v.MallChestType.LimitSEquip?(a=this.RefMgrLimitSEquipReward.getTlRef("groupId",n.reward),this.DearRefReward(n.id,a)):c.FW.LWX.error("\u62bd\u5956\u5b9d\u7bb1\u7c7b\u578b\u6709\u8bef,\u8bf7\u68c0\u67e5\uff01")}}catch(l){t={error:l}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}this.SetLimitSEuipInfo(),this.InitListen()},e.prototype.InitListen=function(){var t=this,e=this;e.itemSubset=e.ModelMgr.ModelVO.VOItemBag.CreateSubset(),e.itemSubset.SetFilter(function(t){return!!t&&!!v.SEquipDrawPropSet.has(t.GetRefId())}),e.toolSet=y.ToolSet.createToolSet(),e.toolSet.addListener(c.FW.FWEvent.eventProxy,h.FWEventType.theNextDay,function(){e.UpdateLimitSEquipModuleState()},e),e.toolSet.addListener(e.itemSubset.GetEventProxy(),"OnChanged",function(){e.ModelMgr.ModelMall.GetEventModuleOnChangeProxy().execute("OnModuleOnChange",_[0]),e.ModelMgr.ModelMall.GetEventModuleOnChangeProxy().execute("OnModuleOnChange",_[1]),t.updateRed.execute()},e),e.UpdateLimitSEquipModuleState()},e.prototype.DearRefReward=function(t,e){var r,o,n=this,i=[],a=[],l=0,c=function(t){var e=t.reward[0],r=u.ModelMgr.ModelGoods.CreateGoodsByCmd({resId:e.resId,quality:e.quality,number:String(e.number)}),o=r.GetIsSEquip(),n=i.find(function(t){return t.quality==r.GetQuality()&&t.isS==o});n?(n.equips.push(r),n.weight+=t.showWeight):i.push({quality:e.quality,isS:r.GetIsSEquip(),weight:t.showWeight,equips:[r]}),t.type==v.DrawRewardType.ultimatePrize&&a.push(r),l+=t.showWeight},u=this;try{for(var p=s(e),f=p.next();!f.done;f=p.next())c(f.value)}catch(h){r={error:h}}finally{try{f&&!f.done&&(o=p.return)&&o.call(p)}finally{if(r)throw r.error}}i.sort(function(t,e){return n.Sort(t,e)}),a.sort(function(t,e){return n.Sort(t,e)}),this.drawRewardMap.set(t,{rewardData:i,ultimatePrizeData:a,totalWeight:l})},e.prototype.GetRewardDataById=function(t){return this.drawRewardMap.has(t)?this.drawRewardMap.get(t):(c.FW.LWX.error("SEquip\u4e2d\u5bf9\u5e94\u7684\u5956\u52b1\u7ec4\u5f02\u5e38,\u8bf7\u68c0\u67e5\u662f\u5426\u662f\u65b0\u7684\u62bd\u5956\u7c7b\u578b+",t),null)},e.prototype.GetOpenDrawInfo=function(){return this.openDrawInfoMap},e.prototype.SetLimitSEuipInfo=function(){var t,e;this.openDrawInfoMap.clear();try{for(var r=s(this.Ref.RefMgrsEquip.getRefAll()),o=r.next();!o.done;o=r.next()){var n=o.value,i=Date.parse(n.startTime),a=Date.parse(n.endTime),l=1e3*this.TimeUtil.now();if(l>=i&&l<=a){var u=n.moduleId;console.log("\u6ee1\u8db3\u5f00\u542f\u6761\u4ef6\uff1a",u,"resid:",n.id),this.openDrawInfoMap.has(u)&&c.FW.LWX.log("\u8986\u76d6\u5df2\u6709\u62bd\u5956\u5b9d\u7bb1\u6570\u636e,\u8bf7\u68c0\u67e5!"+u),this.openDrawInfoMap.set(u,n)}}}catch(p){t={error:p}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},e.prototype.UpdateLimitSEquipModuleState=function(){var t,e;this.SetLimitSEuipInfo();try{for(var r=s(_),o=r.next();!o.done;o=r.next()){var n=o.value;if(n!=v.MallModule.SEquip){var i=this.openDrawInfoMap.has(n)?v.ChangeModuleType.open:v.ChangeModuleType.close;this.ModelMgr.ModelMall.UpdateOpenModuleMap(i,n)}}}catch(a){t={error:a}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},e.prototype.GetCmdMallData=function(t){return this.ModelMgr.ModelMall.GetCmdMallDatayId(t)||null},e.prototype.GetSEquipBuyCount=function(t,e){var r,o=null===(r=this.GetCmdMallData(t))||void 0===r?void 0:r.GetMallSEquipDetail().find(function(t){return t.resId==e});return o?o.buyCount:0},e.prototype.GetSEquipbigPrizeCount=function(t,e){var r,o=null===(r=this.GetCmdMallData(t))||void 0===r?void 0:r.GetMallSEquipDetail().find(function(t){return t.resId==e});return o?o.bigPrizeCount:0},e.prototype.GetSEquipbigultimatePrizeCount=function(t,e){var r,o=null===(r=this.GetCmdMallData(t))||void 0===r?void 0:r.GetMallSEquipDetail().find(function(t){return t.resId==e});return o?o.ultimatePrizeCount:0},e.prototype.Sort=function(t,e){var r=t.quality,o=e.quality;return r!=o?o-r:(r=t.isS?1:0)!=(o=e.isS?1:0)?o-r:(r=t.GetGoodsType())!=(o=e.GetGoodsType())?r-o:-1},e.prototype.GetSEquipInfoById=function(t){return this.openDrawInfoMap.has(t)?this.openDrawInfoMap.get(t):(c.FW.LWX.log("\u62bd\u5956\u6d3b\u52a8\u672a\u5f00\u542f!"+t),null)},e.prototype.GetEventSEquipDrawProxy=function(){return this.eventSEquipDrawProxy},e.prototype.DrawResult=function(t){var e,r,o=[];try{for(var n=s(t.tlCmdGoods),i=n.next();!i.done;i=n.next()){var a=i.value,l=Number(a.number);for(a.number="1";l--;)o.push(this.ModelMgr.ModelGoods.CreateGoodsByCmd(a))}}catch(c){e={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}return o},e.prototype.RequestMallSEquipDraw=function(t,e){var r=this,o=t;this.CtrlGameNet.send(new d.RequestMallSEquipDraw(o,this,function(t){if(t.tlCmdGoods.length>0){var o=r.DrawResult(t);r.eventSEquipDrawProxy.execute("OnSEquipDrawResult",!0,o,e)}else c.FW.LWX.error("\u5546\u57ces\u7ea7||\u9650\u65f6s\u7ea7\u6218\u5907\u62bd\u5956\u8fd4\u56de\u7ed3\u679c\u4e3a\u7a7a,\u8bf7\u68c0\u67e5!!!!")},function(t){c.FW.LWX.error("\u5546\u57ces\u7ea7||\u9650\u65f6s\u7ea7\u6218\u5907\u62bd\u5956\u5931\u8d25,\u8bf7\u68c0\u67e5!!!!"+t),r.eventSEquipDrawProxy.execute("OnSEquipDrawResult",!1)}))},e.__cname="ModelMallSEquip",i([u.injectField("CtrlGameNet")],e.prototype,"CtrlGameNet",void 0),i([u.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([u.injectField("Ref")],e.prototype,"Ref",void 0),i([u.injectField("TimeUtil")],e.prototype,"TimeUtil",void 0),e}(m.ModelBehavior);r.ModelMallSEquip=S,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/container/Container":void 0,"../../../../framework/event/EventCallback":void 0,"../../../../framework/event/EventProxy":void 0,"../../../../framework/event/FWEventCenter":void 0,"../../../../framework/utils/Toolset":void 0,"../../../generated/requestMsg/RequestMallMsg":"RequestMallMsg","../ModelBehavior":"ModelBehavior","./ModelMall":"ModelMall"}],ModelMall:[function(t,e,r){"use strict";cc._RF.push(e,"2717dpk6bhLcIsDJWGeurJw","ModelMall");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.ModelMall=r.SEquipDrawPropSet=r.LuckDrawPropSet=r.MallModule=r.MallChestType=r.DrawRewardType=r.ChangeModuleType=void 0;var c,u,p=t("../../../../framework/container/Container"),f=t("../../../../framework/event/EventProxy"),h=t("../../../../framework/FW"),y=t("../../../../framework/utils/Toolset"),d=t("../../../generated/requestMsg/RequestMallMsg"),m=t("../../../generated/requestMsg/RequestRoleMsg"),v=t("../goods/ModelGoods"),_=t("../ModelBehavior");(function(t){t[t.close=0]="close",t[t.open=1]="open"})(c=r.ChangeModuleType||(r.ChangeModuleType={})),function(t){t[t.normal=0]="normal",t[t.bigPrize=1]="bigPrize",t[t.ultimatePrize=2]="ultimatePrize"}(r.DrawRewardType||(r.DrawRewardType={})),function(t){t[t.SEquip=1]="SEquip",t[t.LimitSEquip=2]="LimitSEquip",t[t.ordinaryLuckDraw=3]="ordinaryLuckDraw",t[t.seniorLuckDraw=4]="seniorLuckDraw"}(r.MallChestType||(r.MallChestType={})),function(t){t[t.ChapterGift=1]="ChapterGift",t[t.DailyShop=2]="DailyShop",t[t.LimitLuckDraw=3]="LimitLuckDraw",t[t.SEquip=4]="SEquip",t[t.LuckDraw=5]="LuckDraw",t[t.Recharge=6]="Recharge",t[t.Gloden=7]="Gloden"}(u=r.MallModule||(r.MallModule={})),r.LuckDrawPropSet=new Set,r.LuckDrawPropSet.add(v.ECurrencyType.silver_key),r.LuckDrawPropSet.add(v.ECurrencyType.gold_key),r.SEquipDrawPropSet=new Set,r.SEquipDrawPropSet.add(v.ECurrencyType.diamond_key);var S=function(){function t(){}return t.prototype.getRefId=function(){return null},t.prototype.InitByCmd=function(t){this.cmd=t},t.prototype.GetRefByCmd=function(){return null},t.prototype.GetMallSEquipDetail=function(){return this.cmd.detail.cmdMallSEquipDetail||[]},t.prototype.GetMallLuckDraw=function(){return this.cmd.detail.cmdMallLuckDrawDetail||[]},t.prototype.GetChapterGift=function(){return this.cmd.detail.cmdMallChapterGiftDetail||[]},t.prototype.GetMallRecharge=function(){return this.cmd.detail.cmdMallChargeDetail||[]},t.prototype.GetMallCoin=function(){return this.cmd.detail.cmdMallCoinDetail||[]},t.prototype.GetMalDailyShop=function(){return this.cmd.detail.cmdMallDailyShopDetail||[]},t.prototype.GetId=function(){return this.cmd.id},t.__cname="Mall",t}(),g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.eventProxy=new f.EventProxy,e.mallModuleMap=new Map,e.mallModuleKeyMap=new Map,e.OpenModuleMap=new Map,e.eventModuleOpenProxy=new f.EventProxy,e.eventModuleCloseProxy=new f.EventProxy,e.eventModuleOnChangeProxy=new f.EventProxy,e.mallDataMap=new Map,e}return n(e,t),e.prototype.enter=function(){return a(this,void 0,Promise,function(){return l(this,function(){return this.InitListen(),[2,this.InitRef()]})})},e.prototype.exit=function(){return null},e.prototype.InitListen=function(){var t=this;this.toolSet=y.ToolSet.createToolSet(),this.toolSet.addListener(this.CtrlMgr.CtrlGameNet.getEventProxy(),"CmdRechargeBroMsg",function(e){var r=e.cmdRecharge;t.RequestRoleRechargeReward(r.id)}),this.toolSet.addListener(this.CtrlMgr.CtrlGameNet.getEventProxy(),"CmdMallBroMsg",function(e){var r=e.mallId,o=e.cmdMall;t.UpdateMallDataMap(r,o)})},e.prototype.InitRef=function(){var t=this;this.Ref||(this.Ref=p.Container.inst().getByAlias("Ref"));var e=[];e.push(this.Ref.RefMgrmallModule.preloadRef()),e.push(this.Ref.RefMgrgoods.preloadRef());var r=Promise.all(e);return r.then(function(){t.InitData()}),r},e.prototype.InitData=function(){var t,e;this.mallModuleMap=new Map,this.mallModuleKeyMap=new Map;try{for(var r=s(this.Ref.RefMgrmallModule.getRefAll()),o=r.next();!o.done;o=r.next()){var n=o.value;this.mallModuleMap.set(n.id,n),this.mallModuleKeyMap.set(n.key,n.id)}}catch(i){t={error:i}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},e.prototype.GetModuleOpenStateById=function(t){return this.OpenModuleMap.has(t)},e.prototype.GetGoodByFromId=function(t){var e=this.Ref.RefMgrgoods.getRef("fromId",t);return e||h.FW.LWX.error("\u83b7\u53d6\u5546\u54c1\u6863\u4f4d\u5931\u8d25\uff0c\u8bf7\u68c0\u67e5fromId\uff1a"+t),e},e.prototype.GetPayChannelByKey=function(t){var e=this.Ref.RefMgrpayChannel.getRef("key",t);return e||h.FW.LWX.error("\u83b7\u53d6\u5145\u503c\u6863\u4f4d\u5931\u8d25,\u8bf7\u68c0\u67e5key\uff1a"+t),e},e.prototype.GetModuleIdByKey=function(t){return this.mallModuleKeyMap.get(t)||1},e.prototype.GetMallModuleData=function(){var t,e;try{for(var r=s(this.mallModuleMap.values()),o=r.next();!o.done;o=r.next()){var n=o.value;if(n.condition){var i=n.condition,a=h.FW.ExprMgr.GetResult(i);h.FW.LWX.log("script:{0},result:{1}",i,a),a&&(this.CtrlMgr.CtrlPay.GetCantPay()&&n.id==u.ChapterGift?h.FW.LWX.log("\u63d0\u5ba1\u6a21\u5f0f\u5c4f\u853d\u7ae0\u8282\u793c\u5305"):this.OpenModuleMap.set(n.id,n.sort))}else this.CtrlMgr.CtrlPay.GetCantPay()&&n.id==u.ChapterGift?h.FW.LWX.log("\u63d0\u5ba1\u6a21\u5f0f\u5c4f\u853d\u7ae0\u8282\u793c\u5305"):this.OpenModuleMap.set(n.id,n.sort)}}catch(l){t={error:l}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}this.ModelMgr.ModelMallSEquip.UpdateLimitSEquipModuleState(),this.OpenModuleMap.has(u.ChapterGift)&&this.ModelMgr.ModelMallChapterGift.UpdateChapterGiftModuleState()},e.prototype.GetEventModuleOpenProxy=function(){return this.eventModuleOpenProxy},e.prototype.GetEventModuleCloseProxy=function(){return this.eventModuleCloseProxy},e.prototype.UpdateOpenModuleMap=function(t,e){if(this.OpenModuleMap.has(e))t==c.close&&(this.OpenModuleMap.delete(e),this.eventModuleCloseProxy.execute("OnModuleClose",e));else if(t==c.open){var r=this.GetModuleDataById(e);this.CtrlMgr.CtrlPay.GetCantPay()&&e==u.ChapterGift?h.FW.LWX.log("\u63d0\u5ba1\u6a21\u5f0f\u5c4f\u853d\u7ae0\u8282\u793c\u5305"):this.OpenModuleMap.set(e,r.sort),this.eventModuleOpenProxy.execute("OnModuleOpen",e)}},e.prototype.GetOpenModuleMap=function(){return this.OpenModuleMap},e.prototype.GetModuleDataById=function(t){return this.mallModuleMap.get(t)},e.prototype.GetEventModuleOnChangeProxy=function(){return this.eventModuleOnChangeProxy},e.prototype.InitMallDataMap=function(t){var e,r;try{for(var o=s(t),n=o.next();!n.done;n=o.next()){var i=n.value;if(this.mallDataMap.has(i.id))this.mallDataMap.get(i.id).InitByCmd(i);else{var a=new S;a.InitByCmd(i),this.mallDataMap.set(i.id,a)}this.eventModuleOnChangeProxy.execute("OnModuleOnChange",i.id)}}catch(l){e={error:l}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}},e.prototype.UpdateMallDataMap=function(t,e){if(this.mallDataMap.has(t))this.mallDataMap.get(t).InitByCmd(e);else{var r=new S;r.InitByCmd(e),this.mallDataMap.set(e.id,r)}this.eventModuleOnChangeProxy.execute("OnModuleOnChange",t)},e.prototype.GetCmdMallDatayId=function(t){return this.mallDataMap.get(t)},e.prototype.GetEventProxy=function(){return this.eventProxy},e.prototype.RequestRoleRechargeReward=function(t){var e=this,r={id:t};this.CtrlMgr.CtrlGameNet.send(new m.RequestRoleRechargeReward(r,this,function(t){t.rewards&&e.CtrlMgr.CtrlAlert.ShowGetReward(t.rewards)}))},e.prototype.RequestMallGetData=function(){return a(this,void 0,Promise,function(){var t,e,r=this;return l(this,function(){return t=this,e={},[2,this.CtrlMgr.CtrlGameNet.send(new d.RequestMallGetData(e,t,function(t){t&&r.InitMallDataMap(t.cmdMall)}))]})})},e.__cname="ModelMall",i([p.injectField("Ref")],e.prototype,"Ref",void 0),i([p.injectField("CtrlMgr")],e.prototype,"CtrlMgr",void 0),i([p.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(_.ModelBehavior);r.ModelMall=g,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/container/Container":void 0,"../../../../framework/event/EventProxy":void 0,"../../../../framework/utils/Toolset":void 0,"../../../generated/requestMsg/RequestMallMsg":"RequestMallMsg","../../../generated/requestMsg/RequestRoleMsg":"RequestRoleMsg","../ModelBehavior":"ModelBehavior","../goods/ModelGoods":"ModelGoods"}],ModelMap:[function(t,e,r){"use strict";cc._RF.push(e,"61ac5y6OsNN/7C0q0Nft58+","ModelMap");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.ModelMap=void 0;var s=t("../../../../framework/container/Container"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),Object.defineProperty(e.prototype,"RefMap",{get:function(){return this.Ref.RefMgrmapRef},enumerable:!1,configurable:!0}),e.prototype.enter=function(){return a(this,void 0,Promise,function(){var t;return l(this,function(){return(t=[]).push(this.RefMap.preloadRef()),[2,Promise.all(t)]})})},e.prototype.GetMapPath=function(t){return this.RefMap.getRef("id",t).model},e.__cname="ModelMap",i([s.injectField("Ref")],e.prototype,"Ref",void 0),e}(t("../ModelBehavior").ModelBehavior);r.ModelMap=c,cc._RF.pop()},{"../../../../framework/container/Container":void 0,"../ModelBehavior":"ModelBehavior"}],ModelMgr:[function(t,e,r){"use strict";cc._RF.push(e,"d34eaX7rStHXYXOv8zg1wV8","ModelMgr");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},l=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.ModelMgr=void 0;var s=t("../../../framework/base/ScriptObject"),c=t("../../../framework/container/Container"),u=t("../../../framework/FW"),p=t("../ctrl/battle/model/ModelBattleDrop"),f=t("../ctrl/battle/model/ModelBattleLevel"),h=t("../ctrl/battle/model/ModelBattleSkill"),y=t("../ctrl/battle/model/ModelBattleStatus"),d=t("../ctrl/battle/model/ModelBattleWave"),m=t("../ctrl/DataReporting/DataReportingInterface"),v=t("./Activity/ModelActivity"),_=t("./battle/ModelBattle"),S=t("./box/ModelBox"),g=t("./breach/ModelBreach"),b=t("./chapter/ModelChapter"),C=t("./dayWeekMonthGift/ModelDayWeekMonthGift"),R=t("./EveryDaySignIn/ModelEveryDaySignIn"),M=t("./expr/ModelExpr"),w=t("./friend/ModelFriends"),O=t("./fuben/ModelFuben"),B=t("./fund/ModelFund"),P=t("./goods/ModelEquip"),G=t("./goods/ModelGoods"),k=t("./goods/ModelGoodsBag"),x=t("./goods/ModelRune"),T=t("./guide/ModelGuide"),j=t("./Hangling/ModelHangling"),I=t("./head/ModelHead"),D=t("./Hero/ModelAttr"),F=t("./Hero/ModelEquipSynthesis"),L=t("./Hero/ModelHero"),E=t("./Icon/ModelIcon"),A=t("./jump/ModelJump"),V=t("./login/ModelAccount"),U=t("./LuckyCat/ModelLuckyCat"),W=t("./mail/ModelMail"),H=t("./mall/ModelMall"),N=t("./mall/ModelMallChapterGift"),q=t("./mall/ModelMallDailyShop"),K=t("./mall/ModelMallGloden"),X=t("./mall/ModelMallLuckDraw"),z=t("./mall/ModelMallRecharge"),J=t("./mall/ModelMallSEquip"),Y=t("./map/ModelMap"),Z=t("./ML/ModelML"),Q=t("./month/ModelMonthCard"),$=t("./pay/ModelPay"),tt=t("./payChannel/ModelPayChannel"),et=t("./player/ModelGameConfig"),rt=t("./player/ModelLevel"),ot=t("./player/ModelPlayer"),nt=t("./prefab/ModelPrefab"),it=t("./public/ModelPublicData"),at=t("./role/ModelRole"),lt=t("./server/ModelServer"),st=t("./SevenDayChallenge/ModelSevenDayChallenge"),ct=t("./Sign/ModelNewPlayerSign"),ut=t("./skill/ModelSkill"),pt=t("./Sta/ModelSta"),ft=t("./System/ModelSystem"),ht=t("./task/ModelTask"),yt=t("./time/ModelTime"),dt=t("./vo/ModelVO"),mt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tmModel=new Set,e.tlModel=[],e.ModelPlayer=e.CreateCtrl(ot.ModelPlayer),e.ModelPublicData=e.CreateCtrl(it.ModelPublicData),e.ModelRole=e.CreateCtrl(at.ModelRole),e.ModelServer=e.CreateCtrl(lt.ModelServer),e.ModelAccount=e.CreateCtrl(V.ModelAccount),e.ModelTime=e.CreateCtrl(yt.ModelTime),e.ModelVO=e.CreateCtrl(dt.ModelVO),e.ModelGoodsBag=e.CreateCtrl(k.ModelGoodsBag),e.ModelChapter=e.CreateCtrl(b.ModelChapter),e.ModelGoods=e.CreateCtrl(G.ModelGoods),e.ModelEquip=e.CreateCtrl(P.ModelEquip),e.ModelMail=e.CreateCtrl(W.ModelMail),e.ModelPrefab=e.CreateCtrl(nt.ModelPrefab),e.ModelLevel=e.CreateCtrl(rt.ModelLevel),e.ModelHead=e.CreateCtrl(I.ModelHead),e.ModelExpr=e.CreateCtrl(M.ModelExpr),e.ModelEquipSynthesis=e.CreateCtrl(F.ModelEquipSynthesis),e.ModelHangling=e.CreateCtrl(j.ModelHangling),e.ModelBreach=e.CreateCtrl(g.ModelBreach),e.ModelTask=e.CreateCtrl(ht.ModelTask),e.ModelHero=e.CreateCtrl(L.ModelHero),e.ModelBox=e.CreateCtrl(S.ModelBox),e.ModelAttr=e.CreateCtrl(D.ModelAttr),e.ModelRune=e.CreateCtrl(x.ModelRune),e.ModelSystem=e.CreateCtrl(ft.ModelSystem),e.ModelActivity=e.CreateCtrl(v.ModelActivity),e.ModelJump=e.CreateCtrl(A.ModelJump),e.ModelNewPlayerSign=e.CreateCtrl(ct.ModelNewPlayerSign),e.ModelPay=e.CreateCtrl($.ModelPay),e.ModelSkill=e.CreateCtrl(ut.ModelSkill),e.ModelFuben=e.CreateCtrl(O.ModelFuben),e.ModelSta=e.CreateCtrl(pt.ModelSta),e.ModelMonthCard=e.CreateCtrl(Q.ModelMonthCard),e.ModelGameConfig=e.CreateCtrl(et.ModelGameConfig),e.ModelGuide=e.CreateCtrl(T.ModelGuide),e.ModelIcon=e.CreateCtrl(E.ModelIcon),e.ModelML=e.CreateCtrl(Z.ModelML),e.ModelMall=e.CreateCtrl(H.ModelMall),e.ModelMallDailyShop=e.CreateCtrl(q.ModelMallDailyShop),e.ModelMallGloden=e.CreateCtrl(K.ModelMallGloden),e.ModelMallLuckDraw=e.CreateCtrl(X.ModelMallLuckDraw),e.ModelMallSEquip=e.CreateCtrl(J.ModelMallSEquip),e.ModelMallRecharge=e.CreateCtrl(z.ModelMallRecharge),e.ModelMallChapterGift=e.CreateCtrl(N.ModelMallChapterGift),e.ModelBattle=e.CreateCtrl(_.ModelBattle),e.ModelBattleSkill=e.CreateCtrl(h.ModelBattleSkill),e.ModelBattleLevel=e.CreateCtrl(f.ModelBattleLevel),e.ModelBattleWave=e.CreateCtrl(d.ModelBattleWave),e.ModelMap=e.CreateCtrl(Y.ModelMap),e.ModelBattleDrop=e.CreateCtrl(p.ModelBattleDrop),e.ModelRoleStatus=e.CreateCtrl(y.ModelBattleStatus),e.ModelSevenDayChallenge=e.CreateCtrl(st.ModelSevenDayChallenge),e.ModelFund=e.CreateCtrl(B.ModelFund),e.ModelEveryDaySignIn=e.CreateCtrl(R.ModelEveryDaySignIn),e.ModelDayWeekMonthGift=e.CreateCtrl(C.ModelDayWeekMonthGift),e.ModelPayChannel=e.CreateCtrl(tt.ModelPayChannel),e.ModelFriends=e.CreateCtrl(w.ModelFriends),e.ModelLuckyCat=e.CreateCtrl(U.ModelLuckyCat),e._isEnter=!1,e._isAfterEnter=!1,e}return n(e,t),e.prototype.CreateCtrl=function(t){var e=c.Container.inst().collectClass(t);return this.tmModel.add(e),this.tlModel.push(e),e},e.prototype.OnEnter=function(){return i(this,void 0,void 0,function(){var t,e,r,o,n,i,s,p;return a(this,function(a){switch(a.label){case 0:if(this._isEnter)return[2];(t=c.Container.inst().getByAlias("DataReporting")).PushBuriedList(m.SingleBuriedPointType.start_init_model),this._isEnter=!0,a.label=1;case 1:a.trys.push([1,6,7,8]),e=l(this.tlModel),r=e.next(),a.label=2;case 2:return r.done?[3,5]:(o=r.value,u.FW.LWX.log("enter: "+o.className),null==(n=o.enterWrap())?[3,4]:[4,n]);case 3:a.sent(),a.label=4;case 4:return r=e.next(),[3,2];case 5:return[3,8];case 6:return i=a.sent(),s={error:i},[3,8];case 7:try{r&&!r.done&&(p=e.return)&&p.call(e)}finally{if(s)throw s.error}return[7];case 8:return t.PushBuriedList(m.SingleBuriedPointType.end_init_model),[2]}})})},e.prototype.OnAfterEnter=function(){return i(this,void 0,void 0,function(){var t,e,r,o,n,i,s;return a(this,function(a){switch(a.label){case 0:if(this._isAfterEnter)return[2];this._isAfterEnter=!0,a.label=1;case 1:a.trys.push([1,6,7,8]),t=l(this.tlModel),e=t.next(),a.label=2;case 2:return e.done?[3,5]:(r=e.value,null==(o=r.afterEnterGame())?[3,4]:[4,o]);case 3:a.sent(),a.label=4;case 4:return e=t.next(),[3,2];case 5:return[3,8];case 6:return n=a.sent(),i={error:n},[3,8];case 7:try{e&&!e.done&&(s=t.return)&&s.call(t)}finally{if(i)throw i.error}return[7];case 8:return[2]}})})},e.prototype.OnExit=function(){return i(this,void 0,void 0,function(){var t,e,r;return a(this,function(o){switch(o.label){case 0:if(0==this._isEnter)return[2];this._isEnter=!1,this._isAfterEnter=!1,t=this.tlModel.length-1,o.label=1;case 1:return t>=0?(e=this.tlModel[t],null==(r=e.exitWrap())?[3,3]:[4,r]):[3,4];case 2:o.sent(),o.label=3;case 3:return t--,[3,1];case 4:return[2]}})})},e.__cname="ModelMgr",e}(s.ScriptObject);r.ModelMgr=mt,cc._RF.pop()},{"../../../framework/FW":void 0,"../../../framework/base/ScriptObject":void 0,"../../../framework/container/Container":void 0,"../ctrl/DataReporting/DataReportingInterface":"DataReportingInterface","../ctrl/battle/model/ModelBattleDrop":"ModelBattleDrop","../ctrl/battle/model/ModelBattleLevel":"ModelBattleLevel","../ctrl/battle/model/ModelBattleSkill":"ModelBattleSkill","../ctrl/battle/model/ModelBattleStatus":"ModelBattleStatus","../ctrl/battle/model/ModelBattleWave":"ModelBattleWave","./Activity/ModelActivity":"ModelActivity","./EveryDaySignIn/ModelEveryDaySignIn":"ModelEveryDaySignIn","./Hangling/ModelHangling":"ModelHangling","./Hero/ModelAttr":"ModelAttr","./Hero/ModelEquipSynthesis":"ModelEquipSynthesis","./Hero/ModelHero":"ModelHero","./Icon/ModelIcon":"ModelIcon","./LuckyCat/ModelLuckyCat":"ModelLuckyCat","./ML/ModelML":"ModelML","./SevenDayChallenge/ModelSevenDayChallenge":"ModelSevenDayChallenge","./Sign/ModelNewPlayerSign":"ModelNewPlayerSign","./Sta/ModelSta":"ModelSta","./System/ModelSystem":"ModelSystem","./battle/ModelBattle":"ModelBattle","./box/ModelBox":"ModelBox","./breach/ModelBreach":"ModelBreach","./chapter/ModelChapter":"ModelChapter","./dayWeekMonthGift/ModelDayWeekMonthGift":"ModelDayWeekMonthGift","./expr/ModelExpr":"ModelExpr","./friend/ModelFriends":"ModelFriends","./fuben/ModelFuben":"ModelFuben","./fund/ModelFund":"ModelFund","./goods/ModelEquip":"ModelEquip","./goods/ModelGoods":"ModelGoods","./goods/ModelGoodsBag":"ModelGoodsBag","./goods/ModelRune":"ModelRune","./guide/ModelGuide":"ModelGuide","./head/ModelHead":"ModelHead","./jump/ModelJump":"ModelJump","./login/ModelAccount":"ModelAccount","./mail/ModelMail":"ModelMail","./mall/ModelMall":"ModelMall","./mall/ModelMallChapterGift":"ModelMallChapterGift","./mall/ModelMallDailyShop":"ModelMallDailyShop","./mall/ModelMallGloden":"ModelMallGloden","./mall/ModelMallLuckDraw":"ModelMallLuckDraw","./mall/ModelMallRecharge":"ModelMallRecharge","./mall/ModelMallSEquip":"ModelMallSEquip","./map/ModelMap":"ModelMap","./month/ModelMonthCard":"ModelMonthCard","./pay/ModelPay":"ModelPay","./payChannel/ModelPayChannel":"ModelPayChannel","./player/ModelGameConfig":"ModelGameConfig","./player/ModelLevel":"ModelLevel","./player/ModelPlayer":"ModelPlayer","./prefab/ModelPrefab":"ModelPrefab","./public/ModelPublicData":"ModelPublicData","./role/ModelRole":"ModelRole","./server/ModelServer":"ModelServer","./skill/ModelSkill":"ModelSkill","./task/ModelTask":"ModelTask","./time/ModelTime":"ModelTime","./vo/ModelVO":"ModelVO"}],ModelMonthCard:[function(t,e,r){"use strict";cc._RF.push(e,"abbdfFq0WRGLK9gKifBLeCp","ModelMonthCard");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.ModelMonthCard=void 0;var c=t("../../../../framework/container/Container"),u=t("../../../../framework/FW"),p=t("../../../generated/requestMsg/RequestCardMsg"),f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetIsHasReward=function(){return!1},e.prototype.GetMonthRefByType=function(t){return this.Ref.RefMgrmonthCard.getRef("monthType",t)},e.prototype.GetBuffById=function(t){return this.Ref.RefMgrmonthBuff.getRef("resId",t)},e.prototype.GetBuffArrayByList=function(t){var e,r,o=[];try{for(var n=s(t),i=n.next();!i.done;i=n.next()){var a=i.value,l=this.GetBuffById(a);1==l.showDesc&&o.push(l)}}catch(c){e={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}return o},e.prototype.GetMonthState=function(){return a(this,void 0,void 0,function(){return l(this,function(){return[2,{normal:!1,premium:!1}]})})},e.prototype.RequestMonthCardReward=function(t){var e=this,r={resId:t};return this.CtrlMgr.CtrlGameNet.send(new p.RequestMonthCardDailyReward(r,this,function(t){t.tlCmdGoods&&(e.CtrlMgr.CtrlAlert.ShowGetReward(t.tlCmdGoods),u.FW.showTip(u.FW.G_W("\u9886\u53d6\u6210\u529f")))}))},e.__cname="ModelMonthCard",i([c.injectField("Ref")],e.prototype,"Ref",void 0),i([c.injectField("CtrlMgr")],e.prototype,"CtrlMgr",void 0),i([c.injectField("TimeUtil")],e.prototype,"TimeUtil",void 0),i([c.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(t("../ModelBehavior").ModelBehavior);r.ModelMonthCard=f,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/container/Container":void 0,"../../../generated/requestMsg/RequestCardMsg":"RequestCardMsg","../ModelBehavior":"ModelBehavior"}],ModelNewPlayerSign:[function(t,e,r){"use strict";cc._RF.push(e,"c335bzWJa5IboDttkUEgR+P","ModelNewPlayerSign");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.ModelNewPlayerSign=void 0;var c=t("../../../../framework/container/Container"),u=t("../../../../framework/event/EventProxy"),p=t("../../../../framework/utils/Toolset"),f=t("../../../generated/requestMsg/RequestActivityMsg"),h=t("../Activity/ModelActivity"),y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.eventProxy=new u.EventProxy,e.signData=[],e}return n(e,t),e.prototype.enter=function(){return a(this,void 0,Promise,function(){return l(this,function(){return this.InitRef(),[2,null]})})},e.prototype.exit=function(){return a(this,void 0,Promise,function(){return l(this,function(){return p.ToolSet.destroyToolSet(this.toolSet),[2]})})},Object.defineProperty(e.prototype,"EventProxy",{get:function(){return this.eventProxy},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"refAllSign",{get:function(){return this.Ref.RefMgractiveNewPlayerSign},enumerable:!1,configurable:!0}),e.prototype.InitRef=function(){var t=this;this.Ref||(this.Ref=c.Container.inst().getByAlias("Ref"));var e=Promise.all([]);return e.then(function(){t.InitData()}),e},e.prototype.InitData=function(){var t=this;this.toolSet=p.ToolSet.createToolSet();var e=this.ModelMgr.ModelActivity.CreateSubset();e.SetFilter(function(t){return!!t&&t.GetActivityKind()==h.EnumActivityKind.NewPlayerSign});var r=function(){var r,o,n=e.GetTlAO()[0];if(n){t.activityRefId=n.GetId(),t.endTime=n.GetEndTime();var i=n.GetDeTail().cmdActivityNewPlayerSignDetail;t.days=i.days;var a=i.cmdActivityNewPlayerSignRewardState,l=t.refAllSign;t.signData=[];var c=function(e){var r=a.find(function(t){return t.resId==e.day});t.signData.push({ref:e,rewardState:r})};try{for(var u=s(l.getTlRef("id",1)),p=u.next();!p.done;p=u.next())c(p.value)}catch(f){r={error:f}}finally{try{p&&!p.done&&(o=u.return)&&o.call(u)}finally{if(r)throw r.error}}t.eventProxy.execute("OnChange")}};this.toolSet.addListener(e.GetEventProxy(),"OnChanged",r,this),this.toolSet.addDefer(function(){t.ModelMgr.ModelActivity.DestroySubset(e),e=null}),r()},e.prototype.GetAllRefArray=function(){return this.refAllSign},e.prototype.GetEndTime=function(){return this.endTime},e.prototype.GetDays=function(){return this.days},e.prototype.GetSignData=function(){return this.signData},e.prototype.RequestGetReward=function(t){var e=this,r={id:this.activityRefId,resId:t};this.CtrlMgr.CtrlGameNet.send(new f.RequestActivityNewPlayerSignReward(r,this,function(t){t.tlCmdGoods&&e.CtrlMgr.CtrlAlert.ShowGetReward(t.tlCmdGoods)}))},e.__cname="ModelNewPlayerSign",i([c.injectField("Ref")],e.prototype,"Ref",void 0),i([c.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([c.injectField("CtrlMgr")],e.prototype,"CtrlMgr",void 0),e}(t("../ModelBehavior").ModelBehavior);r.ModelNewPlayerSign=y,cc._RF.pop()},{"../../../../framework/container/Container":void 0,"../../../../framework/event/EventProxy":void 0,"../../../../framework/utils/Toolset":void 0,"../../../generated/requestMsg/RequestActivityMsg":"RequestActivityMsg","../Activity/ModelActivity":"ModelActivity","../ModelBehavior":"ModelBehavior"}],ModelPayChannel:[function(t,e,r){"use strict";cc._RF.push(e,"cfad5oKVxNA5LUKPWjjACK6","ModelPayChannel");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.PayGoods=r.ModelPayChannel=void 0;var c=t("../../../../framework/base/ScriptObject"),u=t("../../../../framework/container/Container"),p=t("../../../../framework/FW"),f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),Object.defineProperty(e.prototype,"refpayChannel",{get:function(){return this.Ref.RefMgrpayChannel},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"refgoods",{get:function(){return this.Ref.RefMgrgoods},enumerable:!1,configurable:!0}),e.prototype.enter=function(){return a(this,void 0,Promise,function(){return l(this,function(){return this.InitRef(),[2,null]})})},e.prototype.InitRef=function(){return a(this,void 0,void 0,function(){var t,e,r=this;return l(this,function(){return this.Ref||(this.Ref=u.Container.inst().getByAlias("Ref")),(t=[]).push(this.refgoods.preloadRef()),t.push(this.refpayChannel.preloadRef()),(e=Promise.all(t)).then(function(){r.InitData()}),[2,e]})})},e.prototype.InitData=function(){var t,e;this.tmObjPayGoods=new Map;var r=new h;u.Container.inst().inject(r),this.tmObjPayGoods.set(0,r);var o=this.refgoods.getRefAll();try{for(var n=s(o),i=n.next();!i.done;i=n.next()){var a=i.value,l=new h,c=a,p=this.refpayChannel.getRef("key",a.key);l.Init(p,c),u.Container.inst().inject(l),this.tmObjPayGoods.set(a.fromId,l)}}catch(f){t={error:f}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}},e.prototype.GetPayGoodsByFormId=function(t){var e=this.tmObjPayGoods.get(t);return null==e?(p.FW.LWX.error("goods\u8868\u4e2d\u6ca1\u6709formid:",t),null):e},e.__cname="ModelPayChannel",i([u.injectField("Ref")],e.prototype,"Ref",void 0),e}(t("../ModelBehavior").ModelBehavior);r.ModelPayChannel=f;var h=function(t){function e(){var e=t.call(this)||this;return e.payChannelRef=null,e.goodsRef=null,e}return n(e,t),e.prototype.Init=function(t,e){this.payChannelRef=t,this.goodsRef=e},e.prototype.GetRmb=function(){return this.payChannelRef.rmb},e.prototype.GetPayChannelName=function(){return this.payChannelRef.name},e.prototype.GetPanchannelType=function(){return this.payChannelRef.type},e.prototype.GetAddVipExp=function(){return this.payChannelRef.vipExp},e.prototype.GetDiamondNum=function(){return this.payChannelRef.diamond},e.prototype.GetId=function(){return this.payChannelRef.id},e.prototype.GetUnit=function(){return this.payChannelRef.unit||""},e.prototype.GetGoodsName=function(){return this.goodsRef.name},e.prototype.GetGoodsType=function(){return this.goodsRef.type},e.prototype.GetReward=function(){return this.goodsRef.reward},e.prototype.GetIcon=function(){return this.goodsRef.icon},e.prototype.GetIsFirstCharge=function(){return this.goodsRef.isFirstCharge},e.prototype.GetIsMonthCard=function(){return this.goodsRef.isMonthCard},e.prototype.GetKey=function(){return this.goodsRef.key},e.prototype.GetFromId=function(){return this.goodsRef.fromId},e.__cname="PayGoods",e}(c.ScriptObject);r.PayGoods=h,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/base/ScriptObject":void 0,"../../../../framework/container/Container":void 0,"../ModelBehavior":"ModelBehavior"}],ModelPay:[function(t,e,r){"use strict";cc._RF.push(e,"ff65atfMrxKZpCnYJAUExMU","ModelPay");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.ModelPay=void 0;var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.Pay=function(t){return i(this,void 0,Promise,function(){return a(this,function(e){switch(e.label){case 0:return[4,t.Auth()];case 1:return e.sent()?[4,t.Pay()]:[3,3];case 2:return[2,e.sent()];case 3:return t.ShowTips(),[2,null]}})})},e.prototype.Pay2=function(t){return i(this,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return t.Auth()?[3,2]:[4,this.WaitForRecharge()];case 1:e.sent(),e.label=2;case 2:return[4,t.Pay()];case 3:return e.sent(),[2]}})})},e.prototype.WaitForRecharge=function(){},e.__cname="ModelPay",e}(t("../ModelBehavior").ModelBehavior);r.ModelPay=l,cc._RF.pop()},{"../ModelBehavior":"ModelBehavior"}],ModelPlayer:[function(t,e,r){"use strict";cc._RF.push(e,"9d949M6xpJPdrkgVWL1gx9o","ModelPlayer");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.ModelPlayer=r.PlayerEventType=void 0;var s,c=t("../../../../framework/FW"),u=t("../../../../framework/container/Container"),p=t("../../../../framework/event/EventProxy"),f=t("../../../generated/requestMsg/RequestFriendsMsg"),h=t("../ModelBehavior");(function(t){t.PlayerDetailUpdate="PlayerDetailUpdate"})(s=r.PlayerEventType||(r.PlayerEventType={}));var y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.eventProxy=new p.EventProxy,e}return n(e,t),e.prototype.GetEventProxy=function(){return this.eventProxy},e.prototype.GetPlayerDetail=function(){return this.playerDetail},e.prototype.ClearPlayerDetail=function(){this.playerDetail=null},e.prototype.RequestFriendDetail=function(t){return a(this,void 0,void 0,function(){var e,r,o;return l(this,function(n){switch(n.label){case 0:return r={targetId:t},[4,(e=this).CtrlGameNet.send(new f.RequestFriendDetail(r,e,function(t){o={roleInfo:t.cmdFriendsShowDetail,equipList:t.equipList},e.playerDetail=o,e.eventProxy.execute(s.PlayerDetailUpdate)}))];case 1:return n.sent(),[2]}})})},e.prototype.RequestFriendLinke=function(t){return a(this,void 0,void 0,function(){var e,r;return l(this,function(){return r={targetId:t},[2,(e=this).CtrlGameNet.send(new f.RequestFriendLike(r,e,function(){c.FW.showTip("\u70b9\u8d5e\u6210\u529f"),e.playerDetail.roleInfo.todayLike=!0,e.eventProxy.execute(s.PlayerDetailUpdate)}))]})})},e.__cname="ModelPlayer",i([u.injectField("CtrlGameNet")],e.prototype,"CtrlGameNet",void 0),i([u.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(h.ModelBehavior);r.ModelPlayer=y,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/container/Container":void 0,"../../../../framework/event/EventProxy":void 0,"../../../generated/requestMsg/RequestFriendsMsg":"RequestFriendsMsg","../ModelBehavior":"ModelBehavior"}],ModelPrefab:[function(t,e,r){"use strict";cc._RF.push(e,"13d13DhkUlH8p13tY0g9XqQ","ModelPrefab");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.ModelPrefab=void 0;var c=t("../../../../framework/asset/AssetMgr"),u=t("../../../../framework/container/Container"),p=t("../../../../framework/FW"),f=t("../../../../framework/utils/PromiseWrap"),h=function(t){function e(){var r=t.call(this)||this;return r.data=new Map,r.prefab2Key=new Map,r.key2Collision=new Map,null==e._instance&&(e._instance=r),r}return n(e,t),Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e),e._instance},enumerable:!1,configurable:!0}),e.prototype.enter=function(){return a(this,void 0,Promise,function(){var t,e,r,o,n,i,a,c;return l(this,function(){t=this.data,(e=this.key2Collision).clear();try{for(r=s(this.Ref.RefMgrmodelRef.getRefAll()),o=r.next();!o.done;o=r.next())n=o.value,i=n.key,t.set(i,n.path),e.set(i,n.collision)}catch(l){a={error:l}}finally{try{o&&!o.done&&(c=r.return)&&c.call(r)}finally{if(a)throw a.error}}return[2]})})},e.prototype.exit=function(){return a(this,void 0,Promise,function(){return l(this,function(){return[2]})})},e.prototype.GetAssetsProxy=function(t){var e=this.data.get(t);this.assert(null!=e,"\u8def\u5f84\u4e0d\u5b58\u5728:"+t);var r=c.AssetMgr.instance.getAsset(e,cc.Prefab);return this.assert(null!=r,"\u8d44\u6e90\u4e0d\u5b58\u5728: ["+t+"]"+e),r},e.prototype.PreLoadAsset=function(t){var e=this.data.get(t);this.assert(null!=e,"\u8def\u5f84\u4e0d\u5b58\u5728:"+t);var r=c.AssetMgr.instance.getAsset(e,cc.Prefab);this.assert(null!=r,"\u8d44\u6e90\u4e0d\u5b58\u5728: ["+t+"]"+e);var o=new f.PromiseWrap(null);return r.getPromise().then(function(){o.resolve()}).catch(function(){o.resolve()}),o.promise},e.prototype.CreateAsset=function(t){var e=this,r=this.data.get(t);this.assert(null!=r,"\u8def\u5f84\u4e0d\u5b58\u5728:"+t);var o=c.AssetMgr.instance.getAsset(r,cc.Prefab);this.assert(null!=o,"\u8d44\u6e90\u4e0d\u5b58\u5728: ["+t+"]"+r);var n=new f.PromiseWrap,i=function(){if(null==o.getAsset())p.FW.ZJJ.error("\u8d44\u6e90\u52a0\u8f7d\u5931\u8d25",r),n.reject();else{var i=o.spawn();e.prefab2Key.set(i,t),n.resolve(i)}};return o&&"Loaded"==o.getState()?i():o.getPromise().then(function(){i()}),n.promise},e.prototype.DestroyAsset=function(t){var e=this.prefab2Key.get(t),r=this.data.get(e),o=c.AssetMgr.instance.getAsset(r,cc.Prefab);this.prefab2Key.delete(t),o.despawn(t)},e.prototype.GetModelCollision=function(t){return this.key2Collision.get(t)||1},e.__cname="ModelPrefab",i([u.injectField("Ref")],e.prototype,"Ref",void 0),e}(t("../ModelBehavior").ModelBehavior);r.ModelPrefab=h,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/asset/AssetMgr":void 0,"../../../../framework/container/Container":void 0,"../../../../framework/utils/PromiseWrap":void 0,"../ModelBehavior":"ModelBehavior"}],ModelPublicData:[function(t,e,r){"use strict";cc._RF.push(e,"d50dcsG4ZdDmbfV4euHyl/P","ModelPublicData");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.ModelPublicData=void 0;var i=t("../../../../framework/container/Container"),a=t("../ModelBehavior"),l=t("./AppCustomData"),s=t("./AppCustomInfo"),c=function(t){function e(){var e=t.call(this)||this;return e.tmData=new Set,e.tlData=[],e.deviceInfo={},e.appCustomData=l.AppCustomData.instance,e._isUseWhiteList=!1,e.clickTestTime=0,i.Container.inst().collectObj(s.AppCustomInfo,"AppCustomInfo"),e}return n(e,t),e.prototype.CreaterData=function(t){var e=i.Container.inst().collectClass(t);return this.tmData.add(e),this.tlData.push(e),e},e.prototype.getserverCenterUrl=function(){var t=this.appCustomData;return t?t.url:null},e.prototype.getBackstageUrl=function(){var t=this.appCustomData;return t?t.backstageurl:null},e.prototype.getChannel=function(){var t=this.appCustomData;return t?t.channel:null},e.prototype.getLoginUrl=function(){var t=this.getserverCenterUrl();return t?t+"/center/account/login?":null},e.prototype.getNoticeUrl=function(){var t=this.getBackstageUrl(),e=this.getChannel();return t&&e?t+"/notice/24/"+e+".json":null},e.prototype.getPayUrl=function(){var t=this.getserverCenterUrl();return t?t+"/center/order/create":null},e.prototype.getBuriedPointUrl=function(){var t=this.getserverCenterUrl();return t?t+"/center/track":null},e.prototype.getInternalPayUrl=function(){var t=this.getserverCenterUrl();return t?t+"/center/order/confirm/"+this.appCustomData.channel:null},e.prototype.getDeleteUrl=function(){var t=this.getserverCenterUrl();return t?t+"/center/account/deleteRole":null},e.prototype.getRegisterUrl=function(){var t=this.getserverCenterUrl();return t?t+"/center/account/register?":null},e.prototype.getServerAddressUrl=function(){var t=this.getserverCenterUrl();return t?t+"/center/action/login":null},e.prototype.getIsGM=function(){return this.appCustomData.isEdit},Object.defineProperty(e.prototype,"isUseWhiteList",{get:function(){return this._isUseWhiteList},set:function(t){this._isUseWhiteList=t},enumerable:!1,configurable:!0}),e.prototype.isClickTestOK=function(){return this.clickTestTime>=5},e.prototype.addClickTestTime=function(){var t=this.clickTestTime+1;this.clickTestTime=t,console.log(t),this.isClickTestOK()&&(this.isUseWhiteList=!0,this.log("\u767d\u540d\u5355\u5df2\u7ecf\u5f00\u542f"))},e.prototype.isMiniGameTiShen=function(){return!1},e.__cname="ModelPublicData",e}(a.ModelBehavior);r.ModelPublicData=c,cc._RF.pop()},{"../../../../framework/container/Container":void 0,"../ModelBehavior":"ModelBehavior","./AppCustomData":"AppCustomData","./AppCustomInfo":"AppCustomInfo"}],ModelRole:[function(t,e,r){"use strict";cc._RF.push(e,"77be9XM3KJE7KoeJ41mqEIW","ModelRole");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.ModelRole=void 0;var s=t("../../../../framework/FW"),c=t("../../../../framework/container/Container"),u=t("../../../generated/requestMsg/RequestRoleMsg"),p=t("../../../generated/requestMsg/RequestShareMsg"),f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.enter=function(){return a(this,void 0,Promise,function(){return l(this,function(){return[2,null]})})},e.prototype.exit=function(){return null},e.prototype.GetRoleId=function(){return this.GetRole().GetRoleId()},e.prototype.GetRole=function(){return this.ModelMgr.ModelVO.VORoleBag.GetOne()},e.prototype.getPropertyById=function(t){var e=this.GetRole();return e?Number(e.GetAttributeBy(t)):0},e.prototype.GetHasBreach=function(t){return t>=this.GetRole().Getpassive()},e.prototype.GetRenameGoods=function(){var t=this.ModelMgr.ModelGameConfig.GetGameConfigValueByKey("renameItem"),e=this.ModelMgr.ModelGoods.CreateGoods(t.resId);return e.SetNumber(t.number),e},e.prototype.RequestChangeName=function(t){return a(this,void 0,void 0,function(){var e;return l(this,function(r){switch(r.label){case 0:return e={name:t},[4,this.CtrlMgr.CtrlGameNet.send(new u.RequestRoleChangeName(e,this,function(){}))];case 1:return[2,r.sent()]}})})},e.prototype.RequestShareGetReward=function(){return a(this,void 0,void 0,function(){var t;return l(this,function(e){switch(e.label){case 0:return t={},[4,this.CtrlMgr.CtrlGameNet.send(new p.RequestShareGetReward(t,this,function(){s.FW.showTip(s.FW.G_W("\u5206\u4eab\u6210\u529f,\u5956\u52b1\u5df2\u901a\u8fc7\u90ae\u4ef6\u65b9\u5f0f\u53d1\u9001!"))}))];case 1:return[2,e.sent()]}})})},e.__cname="ModelRole",i([c.injectField("ModelVO")],e.prototype,"ModelVO",void 0),i([c.injectField("Ref")],e.prototype,"Ref",void 0),i([c.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([c.injectField("CtrlMgr")],e.prototype,"CtrlMgr",void 0),e}(t("../ModelBehavior").ModelBehavior);r.ModelRole=f,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/container/Container":void 0,"../../../generated/requestMsg/RequestRoleMsg":"RequestRoleMsg","../../../generated/requestMsg/RequestShareMsg":"RequestShareMsg","../ModelBehavior":"ModelBehavior"}],ModelRune:[function(t,e,r){"use strict";cc._RF.push(e,"b85fc6zhF1KJorrXZanoMwN","ModelRune");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},c=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.ModelRune=void 0;var u=t("../../../../framework/FW"),p=t("../../../../framework/container/Container"),f=t("../../../../framework/event/EventCallback"),h=t("../../../../framework/event/EventProxy"),y=t("../../../../framework/fork/Fork"),d=t("../../../../framework/utils/Toolset"),m=t("../../../generated/requestMsg/RequestRuneMsg"),v=t("../ModelBehavior"),_=t("../vo/Goods/Goods"),S=t("./ModelEquip"),g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.runeMap=new Map,e.wearRuneMap=new Map,e.tmRuneEnhance=[],e.tmRuneSkill=new Map,e.tmRuneSpecilaSkill=new Map,e.tmRuneSynthesis=new Map,e.runeSlotMap=new Map,e.SynthesisRuneMap=new Map,e.eventRuneSynthesisResultProxy=new h.EventProxy,e.eventRuneOneKeySynthesisResultProxy=new h.EventProxy,e.eventVOBagOnChangeProxy=new h.EventProxy,e.wearRefId=new Set,e.allRuneMap=new Map,e.updateRuneSynthesisRd=new f.EventCallback,e}var r;return n(e,t),r=e,Object.defineProperty(e.prototype,"RefRuneSynthesis",{get:function(){return this.Ref.RefMgrruneSynthesis},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"RefRuneEnhance",{get:function(){return this.Ref.RefMgrruneEnhance},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"RefRuneSkill",{get:function(){return this.Ref.RefMgrruneQualitySkill},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"RefSkillGroup",{get:function(){return this.Ref.RefMgrskillGroup},enumerable:!1,configurable:!0}),e.prototype.enter=function(){return a(this,void 0,Promise,function(){return l(this,function(){return this.InitVoBag(),this.InitData(),[2]})})},e.prototype.exit=function(){return a(this,void 0,void 0,function(){return l(this,function(){return d.ToolSet.destroyToolSet(this.toolSet),this.toolSet=null,[2,null]})})},e.prototype.GetEventOneKeySynthesisResultProxy=function(){return this.eventRuneOneKeySynthesisResultProxy},e.prototype.GetEventSynthesisResultProxy=function(){return this.eventRuneSynthesisResultProxy},e.prototype.InitVoBag=function(){var t=this;this.toolSet=d.ToolSet.createToolSet(),this.runeVoSubset=this.ModelMgr.ModelVO.VORuneBag.CreateSubset(),this.runeVoSubset.SetFilter(function(){return!0}),this.toolSet.addListener(this.runeVoSubset.GetEventProxy(),"OnChanged",function(){t.updateNextFrame()}),this.roleVoSubset=this.ModelMgr.ModelVO.VORoleBag.CreateSubset(),this.roleVoSubset.SetFilter(function(){return!0}),this.toolSet.addListener(this.roleVoSubset.GetEventProxy(),"OnChanged",function(){t.updateNextFrame()}),this.toolSet.addDefer(function(){t.ModelMgr.ModelVO.VORuneBag.DestroySubset(t.runeVoSubset),t.runeVoSubset=null,t.ModelMgr.ModelVO.VORoleBag.DestroySubset(t.roleVoSubset),t.roleVoSubset=null})},e.prototype.InitData=function(){var t,e,r,o,n,i,a,l,c,u;this.tmRuneSkill=new Map;var p=this.tmRuneSkill;this.tmRuneSpecilaSkill=new Map;var f=this.tmRuneSpecilaSkill;try{for(var h=s(this.RefRuneSkill.getRefAll()),y=h.next();!y.done;y=h.next()){var d=y.value.resId,m=new Map,v=new Map;p.set(d,m),f.set(d,v);try{for(var _=(r=void 0,s(this.RefRuneSkill.getTlRef("resId",d))),S=_.next();!S.done;S=_.next()){var g=S.value;1==g.type&&v.set(g.quality,g),m.set(g.quality,g)}}catch(I){r={error:I}}finally{try{S&&!S.done&&(o=_.return)&&o.call(_)}finally{if(r)throw r.error}}}}catch(D){t={error:D}}finally{try{y&&!y.done&&(e=h.return)&&e.call(h)}finally{if(t)throw t.error}}this.tmRuneEnhance=[];var b=this.tmRuneEnhance;try{for(var C=s(this.RefRuneEnhance.getRefAll()),R=C.next();!R.done;R=C.next()){var M=R.value,w={itemtype:M.itemType,quality:M.quality,phase:M.phase,RefruneEnhance:M};b.push(w)}}catch(F){n={error:F}}finally{try{R&&!R.done&&(i=C.return)&&i.call(C)}finally{if(n)throw n.error}}this.tmRuneSynthesis=new Map;var O=this.tmRuneSynthesis;try{for(var B=s(this.RefRuneSynthesis.getRefAll()),P=B.next();!P.done;P=B.next()){var G=P.value.quality,k=new Map;O.set(G,k);try{for(var x=(c=void 0,s(this.RefRuneSynthesis.getTlRef("quality",G))),T=x.next();!T.done;T=x.next()){var j=T.value;k.set(j.phase,j.number)}}catch(L){c={error:L}}finally{try{T&&!T.done&&(u=x.return)&&u.call(x)}finally{if(c)throw c.error}}}}catch(E){a={error:E}}finally{try{P&&!P.done&&(l=B.return)&&l.call(B)}finally{if(a)throw a.error}}},e.prototype.updateNextFrame=function(){var t=this;this.isupdate||(this.isupdate=!0,this.toolSet.addDelay(16,function(){t.isupdate=!1,t.UpdateData(),t.eventVOBagOnChangeProxy.execute("VOBagOnChange")},this))},e.prototype.GetSynthesisMaterLen=function(t,e){return this.tmRuneSynthesis.get(t).get(e)},e.prototype.GetIsMax=function(t,e,r){void 0===r&&(r=_.EGoodsType.atkRune);var o=this.GetEnhance(r,t,e);return null==o?null:t>=o.qualityCap&&e>=o.phaseCap},e.prototype.GetIsMaxQuality=function(t){var e=this.tmRuneEnhance[0].RefruneEnhance;return null==e?null:t>=e.qualityCap},e.prototype.GetNextStage=function(t,e,r){void 0===r&&(r=_.EGoodsType.atkRune);var o=this.GetIsMax(t,e);if(null==o)return u.FW.LWX.log("\u6570\u636e\u51fa\u9519,\u8bf7\u68c0\u67e5"),null;if(o)return u.FW.LWX.log("\u5df2\u7ecf\u8fbe\u5230\u6700\u9ad8\u7ea7\u522b"),null;var n=e>=this.GetEnhance(r,t,e).phaseCap;return{quality:n?t+1:t,phase:n?0:e+1}},e.prototype.GetSynthesisLockSkillInfo=function(t){var e,r=this.GetNextStage(t.GetQuality(),t.GetPhase());return r!=t.GetQuality()&&(null===(e=this.tmRuneSkill.get(t.GetRefId()))||void 0===e?void 0:e.has(r.quality))?{isUnlockSkill:!0,skilldesc:this.tmRuneSkill.get(t.GetRefId()).get(r.quality).desc}:{isUnlockSkill:!1}},e.prototype.GetSelectSynthesisiMaterial=function(t){var e,r,o=this.GetNextStage(t.GetQuality(),t.GetPhase()),n=this.GetSynthesisMaterLen(o.quality,o.phase),i=this.GetRuneByType(t.GetGoodsType()),a=[];a.push(t);try{for(var l=s(i),c=l.next();!c.done;c=l.next()){var u=c.value;if(t.GetId()!=u.GetId()&&t.GetRefId()==u.GetRefId()&&t.GetQuality()==u.GetQuality()&&t.GetPhase()==u.GetPhase()&&a.push(u)>=n)break}}catch(p){e={error:p}}finally{try{c&&!c.done&&(r=l.return)&&r.call(l)}finally{if(e)throw e.error}}return a},e.prototype.GetRuneAttribute=function(t){var e=this.GetEnhance(t.GetGoodsType(),t.GetQuality(),t.GetPhase());return null==e?0:t.GetGoodsType()==_.EGoodsType.atkRune?e.atkIncrease:e.hpIncrease},e.prototype.GetRuneAttribute1=function(t,e,r){var o=this.GetEnhance(t,e,r);return null==o?0:t==_.EGoodsType.atkRune?o.atkIncrease:o.hpIncrease},e.prototype.GetRuneAttributeType=function(t){return t==_.EGoodsType.atkRune?S.AdditionType.attack:S.AdditionType.hp},e.prototype.GetEnhance=function(t,e,r){var o=this.tmRuneEnhance.find(function(o){return o.itemtype==t&&o.quality==e&&o.phase==r});return o?o.RefruneEnhance:(u.FW.LWX.error("\u83b7\u53d6\u7b26\u6587\u5f3a\u5316\u6570\u636e\u51fa\u9519\uff0c\u8bf7\u68c0\u67e5"+t+","+e+","+r),null)},e.prototype.GetSKill=function(t){var e,r,o=[],n=this.tmRuneSkill.get(t);if(!n)return u.FW.LWX.error("\u7b26\u6587\u6280\u80fd\u8868\u4e2d\u6ca1\u6709\u5bf9\u5e94\u7684\u7b26\u6587,\u8bf7\u68c0\u67e5!!resId:",t),o;try{for(var i=s(n.values()),a=i.next();!a.done;a=i.next()){var l=a.value;o.push(l)}}catch(c){e={error:c}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return o},e.prototype.GetRuneTLVO=function(){return this.runeVoSubset.GetTlVO()},e.prototype.GetEventVOBagOnChangeProxy=function(){return this.eventVOBagOnChangeProxy},e.prototype.UpdateData=function(){var t,e,r,o,n,i,a=this;this.runeMap.clear(),this.wearRefId.clear(),this.SynthesisRuneMap.clear(),this.allRuneMap.clear();var l=new Map;this.wearRuneMap.clear();var c=this.GetRuneTLVO();this.runeMap.set(_.EGoodsType.atkRune,[]),this.runeMap.set(_.EGoodsType.defRune,[]);try{for(var p=s(c),f=p.next();!f.done;f=p.next()){var h=f.value;h.GetGoodsType()==_.EGoodsType.atkRune?this.runeMap.get(_.EGoodsType.atkRune).push(h):h.GetGoodsType()==_.EGoodsType.defRune&&this.runeMap.get(_.EGoodsType.defRune).push(h),this.allRuneMap.set(h.GetId(),h);var y=this.GetNextStage(h.GetQuality(),h.GetPhase());if(!this.SynthesisRuneMap.has(h.GetId())&&null!=y){var d=0;l.clear();var m=this.GetSynthesisMaterLen(y.quality,y.phase);try{for(var v=(r=void 0,s(c)),S=v.next();!S.done;S=v.next()){var g=S.value;h.GetRefId()==g.GetRefId()&&h.GetQuality()==g.GetQuality()&&h.GetPhase()==g.GetPhase()&&(d+=1,l.set(g.GetId(),g))}}catch(O){r={error:O}}finally{try{S&&!S.done&&(o=v.return)&&o.call(v)}finally{if(r)throw r.error}}d>=m&&l.forEach(function(t,e){a.SynthesisRuneMap.set(e,t)})}}}catch(B){t={error:B}}finally{try{f&&!f.done&&(e=p.return)&&e.call(p)}finally{if(t)throw t.error}}this.runeSlotMap.clear();var b=this.roleVoSubset.GetOneVO();if(b){var C=b.GetWearRuneList();try{for(var R=s(C),M=R.next();!M.done;M=R.next()){var w=M.value;this.allRuneMap.has(w.id)?(this.runeSlotMap.set(w.area,this.allRuneMap.get(w.id)),this.wearRefId.add(this.allRuneMap.get(w.id).GetRefId()),this.wearRuneMap.set(w.id,this.allRuneMap.get(w.id))):u.FW.LWX.error("\u7b26\u6587\u80cc\u5305\u4e0d\u5b58\u5728\u8be5\u7b26\u6587,\u8bf7\u68c0\u67e5!"+w.id)}}catch(P){n={error:P}}finally{try{M&&!M.done&&(i=R.return)&&i.call(R)}finally{if(n)throw n.error}}}this.updateRuneSynthesisRd.execute()},e.prototype.GetOnekeySynthesisState=function(){var t,e;try{for(var r=s(this.SynthesisRuneMap.values()),o=r.next();!o.done;o=r.next())if(o.value.GetQuality()<4)return!0}catch(n){t={error:n}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}return!1},e.prototype.GetSynthesisMap=function(){return this.SynthesisRuneMap},e.prototype.GetQuiltySkill=function(t){var e,r,o=[];try{for(var n=s(this.RefRuneSkill.getTlRef("resId",t)),i=n.next();!i.done;i=n.next()){var a=i.value;"[]"!=a.desc?o.push(a):u.FW.LWX.log("\u6280\u80fd\u4e3a\u7a7a!")}}catch(l){e={error:l}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}return o},e.prototype.GetRuneSlotMap=function(){return this.runeSlotMap},e.prototype.GetRuneByType=function(t){var e,r;if(-2==t){var o=[];try{for(var n=s(this.allRuneMap),i=n.next();!i.done;i=n.next()){var a=c(i.value,2),l=(a[0],a[1]);o.push(l)}}catch(p){e={error:p}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}return o}return this.runeMap.has(t)?this.runeMap.get(t):(u.FW.LWX.error("\u4e0d\u5b58\u5728\u7684\u7b26\u6587\u7c7b\u578b\uff0c\u8bf7\u68c0\u67e5!!"),null)},e.prototype.GetReplaceDataByType=function(t,e){var r=this;return void 0===e&&(e=0),this.GetRuneByType(t).filter(function(t){return!r.wearRefId.has(t.GetRefId())||t.GetRefId()==e})},e.prototype.GetIsPutById=function(t){return this.wearRuneMap.has(t)},e.prototype.GetLockSpceialSkillInfo=function(t){var e=t.GetQuality(),r=this.tmRuneSpecilaSkill.get(t.GetRefId()),o="",n=!1,i=null;return r.forEach(function(t,r){e>=r?(o=""==o?t.desc:o+"\n"+t.desc,n=!0):i=i||t}),{str:o,state:n,nextRuneSpecialSkill:i}},e.prototype.GetRuneMainDetailsData=function(){for(var t=[],e=0;e<6;e++)if(this.runeSlotMap.has(e)){var r=this.runeSlotMap.get(e),o=this.GetLockSpceialSkillInfo(r),n=o.str,i=o.state,a=o.nextRuneSpecialSkill;i?t.push({type:2,name:r.GetNameStr(),skilldesc:n}):t.push({type:1,name:r.GetNameStr(),lockQualityName:this.ModelMgr.ModelGoods.GetQualityName(a.quality),skillName:a.name})}else t.push(this.getTips());return t},e.prototype.getTips=function(){return{type:0,name:u.FW.G_W("\u7b26\u6587\u672a\u88c5\u5907")}},e.prototype.GetDataById=function(t){var e,r,o=[];try{for(var n=s(t),i=n.next();!i.done;i=n.next()){var a=i.value;this.allRuneMap.has(a)?o.push(this.allRuneMap.get(a)):u.FW.Log.error("\u4e0d\u5b58\u5728\u7b26\u6587,id:"+a)}}catch(l){e={error:l}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}return o},e.prototype.GetRuneSize=function(){return this.allRuneMap.size},e.prototype.GetPromoteData=function(t,e){var r=t.GetGoodsType()-_.EGoodsType.atkRune,o=t.GetName(),n=this.GetRuneAttribute(t),i=this.GetRuneAttribute(e),a=this.GetSynthesisLockSkillInfo(t);return{name:o,type:r,selectAttribute:n,synthesisAttribute:i,islockskill:a.isUnlockSkill,skilldesc:a.skilldesc||""}},e.prototype.RequestRuneTakeOff=function(t,e){var r={id:t,area:e};this.CtrlGameNet.send(new m.RequestRuneTakeOff(r,this,function(){},function(t){u.FW.LWX.error("\u7b26\u6587\u5378\u4e0b\u9519\u8bef,\u8bf7\u68c0\u67e5"+t)}))},e.prototype.RequestRunePutOn=function(t,e){var r={id:t,area:e};this.CtrlGameNet.send(new m.RequestRunePutOn(r,this,function(){},function(t){u.FW.LWX.error("\u7b26\u6587\u7a7f\u6234\u9519\u8bef,\u8bf7\u68c0\u67e5"+t)}))},e.prototype.RequestRuneReplace=function(t,e){var r={id:t,replaceId:e};this.CtrlGameNet.send(new m.RequestRuneReplace(r,this,function(){},function(t){u.FW.LWX.error("\u7b26\u6587\u7a7f\u66ff\u6362\u8bef,\u8bf7\u68c0\u67e5"+t)}))},e.prototype.RequestRuneSynthesis=function(t){var e=this,r=t;this.CtrlGameNet.send(new m.RequestRuneSynthesis(r,this,function(){e.eventRuneSynthesisResultProxy.execute("OnRuneSynthesisResult",!0)}),!0)},e.prototype.RequestRuneSynthesisOneKey=function(){var t=this;this.CtrlGameNet.send(new m.RequestRuneSynthesisOneKey({},this,function(e){var r=t.GetDataById(e.id);t.eventRuneOneKeySynthesisResultProxy.execute("OnRuneOneKeySynthesisResult",!0,r)}))},e.__cname="ModelRune",i([p.injectField("Ref")],e.prototype,"Ref",void 0),i([p.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([p.injectField("CtrlGameNet")],e.prototype,"CtrlGameNet",void 0),i([y.forkClass(r,null)],e)}(v.ModelBehavior);r.ModelRune=g,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/container/Container":void 0,"../../../../framework/event/EventCallback":void 0,"../../../../framework/event/EventProxy":void 0,"../../../../framework/fork/Fork":void 0,"../../../../framework/utils/Toolset":void 0,"../../../generated/requestMsg/RequestRuneMsg":"RequestRuneMsg","../ModelBehavior":"ModelBehavior","../vo/Goods/Goods":"Goods","./ModelEquip":"ModelEquip"}],ModelServer:[function(t,e,r){"use strict";cc._RF.push(e,"43a79FhJYdA3bInyQiAxO2q","ModelServer");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.ModelServer=void 0;var a=t("../../../../framework/container/Container"),l=t("../ModelBehavior"),s=t("./SubServerDefault"),c=t("./SubServerWX"),u=function(t){function e(){var e=t.call(this)||this;return e.tmHandler=new Map,e.CreateHandler(s.SubServerDefault),e.CreateHandler(c.SubServerWX),e}return n(e,t),e.prototype.getIsSeverActivityOpen=function(){return this.net.info},e.prototype.CreateHandler=function(t){var e=new t;return e.ModelServer=this,this.tmHandler.set(t,e),e},e.prototype.GetHandler=function(){return this.AppCustomData.isWss?this.tmHandler.get(c.SubServerWX):this.tmHandler.get(s.SubServerDefault)},e.prototype.GetServerAddress=function(){return this.ModelAccount.getServerAddress()},e.__cname="ModelServer",i([a.injectField("Net")],e.prototype,"net",void 0),i([a.injectField("ModelAccount")],e.prototype,"ModelAccount",void 0),i([a.injectField("AppCustomData")],e.prototype,"AppCustomData",void 0),e}(l.ModelBehavior);r.ModelServer=u,cc._RF.pop()},{"../../../../framework/container/Container":void 0,"../ModelBehavior":"ModelBehavior","./SubServerDefault":"SubServerDefault","./SubServerWX":"SubServerWX"}],ModelSevenDayChallenge:[function(t,e,r){"use strict";cc._RF.push(e,"5a687zhPspNsqzWin+2VhfB","ModelSevenDayChallenge");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},c=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a},u=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(c(arguments[e]));return t};Object.defineProperty(r,"__esModule",{value:!0}),r.ModelSevenDayChallenge=void 0;var p=t("../../../../framework/container/Container"),f=t("../../../../framework/event/EventProxy"),h=t("../../../../framework/event/FWEventCenter"),y=t("../../../../framework/FW"),d=t("../../../../framework/utils/Toolset"),m=t("../../../generated/requestMsg/RequestActivityMsg"),v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.eventProxy=new f.EventProxy,e.isUpdate=!0,e.taskRefData=[],e.boxRefMap=new Map,e}return n(e,t),e.prototype.GetEventProxy=function(){return this.eventProxy},e.prototype.enter=function(){return a(this,void 0,Promise,function(){var t=this;return l(this,function(){return this.toolSet=d.ToolSet.createToolSet(),this.toolSet.addListener(y.FW.FWEvent.eventProxy,h.FWEventType.theNextDay,function(){t.isUpdate=!0},this),this.InitRef(),[2,null]})})},e.prototype.exit=function(){return d.ToolSet.destroyToolSet(this.toolSet),null},Object.defineProperty(e.prototype,"refactiveSevenPlan",{get:function(){return this.Ref.RefMgractiveSevenPlan},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"refactiveSevenMission",{get:function(){return this.Ref.RefMgractiveSevenMission},enumerable:!1,configurable:!0}),e.prototype.InitRef=function(){var t=this;this.Ref||(this.Ref=p.Container.inst().getByAlias("Ref"));var e=[];e.push(this.Ref.RefMgractiveSevenMission.preloadRef()),e.push(this.Ref.RefMgractiveSevenPlan.preloadRef());var r=Promise.all(e);return r.then(function(){t.InitData()}),r},e.prototype.InitData=function(){var t,e,r,o,n=this.refactiveSevenPlan.getRefAll();this.boxRefMap=new Map;try{for(var i=s(n),a=i.next();!a.done;a=i.next()){var l=a.value,c=u(l.gift);c.sort(function(t,e){return t.count-e.count}),this.boxRefMap.set(l.id,c)}}catch(m){t={error:m}}finally{try{a&&!a.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}var p=this.refactiveSevenMission.getRefAll();this.taskRefData=[];var f=function(t){var e=h.taskRefData.find(function(e){return e.plan==t.plan&&e.belong==t.belong});e?e.taskArr.push(t):h.taskRefData.push({plan:t.plan,belong:t.belong,taskArr:[t]})},h=this;try{for(var y=s(p),d=y.next();!d.done;d=y.next())f(d.value)}catch(v){r={error:v}}finally{try{d&&!d.done&&(o=y.return)&&o.call(y)}finally{if(r)throw r.error}}},e.prototype.GetTaskData=function(t,e){var r=this.taskRefData.find(function(r){return r.plan==t&&r.belong==e});return r?r.taskArr:(y.FW.LWX.error("\u4e03\u65e5\u6311\u6218\u4efb\u52a1\u9519\u8bef\u7684\u65b9\u6848\u6216\u8005\u5929\u6570"+t,+e),null)},e.prototype.GetBoxData=function(t){return this.boxRefMap.get(t)||(y.FW.LWX.error("\u4e03\u65e5\u6311\u6218\u5b9d\u7bb1\u9519\u8bef\u7684\u65b9\u6848"+t),null)},e.prototype.GetBoxMaxActiveValue=function(t){var e=this.boxRefMap.get(t);return e?e[e.length-1].count:(y.FW.LWX.error("\u4e03\u65e5\u6311\u6218\u5b9d\u7bb1\u9519\u8bef\u7684\u65b9\u6848"+t),1500)},e.prototype.RequestActivitySevenDaysGiftReward=function(t){var e=this,r=t;return this.CtrlMgr.CtrlGameNet.send(new m.RequestActivitySevenDaysGiftReward(r,this,function(t){t.tlCmdGoods&&e.CtrlMgr.CtrlAlert.ShowGetReward(t.tlCmdGoods)}))},e.prototype.RequestActivitySevenDaysReward=function(t){return a(this,void 0,void 0,function(){var e,r,o=this;return l(this,function(){return e=this,r=t,[2,this.CtrlMgr.CtrlGameNet.send(new m.RequestActivitySevenDaysReward(r,e,function(t){t.tlCmdGoods&&o.CtrlMgr.CtrlAlert.ShowGetReward(t.tlCmdGoods)}))]})})},e.prototype.RequestActivityUpdate=function(t){var e={id:t};return this.CtrlMgr.CtrlGameNet.send(new m.RequestActivityUpdate(e,this,function(){}))},e.__cname="ModelSevenDayChallenge",i([p.injectField("Ref")],e.prototype,"Ref",void 0),i([p.injectField("CtrlMgr")],e.prototype,"CtrlMgr",void 0),i([p.injectField("TimeUtil")],e.prototype,"timeUtil",void 0),e}(t("../ModelBehavior").ModelBehavior);r.ModelSevenDayChallenge=v,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/container/Container":void 0,"../../../../framework/event/EventProxy":void 0,"../../../../framework/event/FWEventCenter":void 0,"../../../../framework/utils/Toolset":void 0,"../../../generated/requestMsg/RequestActivityMsg":"RequestActivityMsg","../ModelBehavior":"ModelBehavior"}],ModelSkill:[function(t,e,r){"use strict";cc._RF.push(e,"46bfcwOSJxJtaaODRgUEkKy","ModelSkill");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},c=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.ModelSkill=void 0;var u=t("../../../../framework/container/Container"),p=t("../../../../framework/FW"),f=t("../../../ref/RefBuff"),h=t("../../../ref/RefBuffCarrier"),y=t("../../../ref/RefSkillGroup"),d=t("../../../ref/RefSkillLuncher"),m=t("../../../ref/RefWrap"),v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tmSkillLuncher=new Map,e.tmBuffCarrier=new Map,e}return n(e,t),Object.defineProperty(e.prototype,"SkillGroupRef",{get:function(){return this.Ref.RefMgrskillGroup},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"RefBuff",{get:function(){return this.Ref.RefMgrbuff},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"RefSkillLuncher",{get:function(){return this.Ref.RefMgrskillLauncher},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"RefBuffCarrier",{get:function(){return this.Ref.RefMgrbuffCarrier},enumerable:!1,configurable:!0}),e.prototype.enter=function(){return a(this,void 0,Promise,function(){return l(this,function(t){switch(t.label){case 0:return[4,this.InitRef()];case 1:return t.sent(),this.InitData(),[2]}})})},e.prototype.InitRef=function(){return a(this,void 0,void 0,function(){return l(this,function(){return this.Ref||(this.Ref=u.Container.inst().getByAlias("Ref")),[2]})})},e.prototype.GetSkillById=function(t){return this.SkillGroupRef.getRef("refId",t)},e.prototype.InitData=function(){this.tmBuff=m.RefWrap.Create(this.RefBuff,f.RefBuff,"refId"),this.tlSkillGroup=m.RefWrap.Create(this.SkillGroupRef,y.RefSkillGroup,"refId"),this.tmSkillLuncher=m.RefWrap.Create(this.RefSkillLuncher,d.RefSkillLuncher,"refId"),this.tmBuffCarrier=m.RefWrap.Create(this.RefBuffCarrier,h.RefBuffCarrier,"refId")},e.prototype.GetSkillGroup=function(t){var e=this.tlSkillGroup.get(t);return null==e&&p.FW.Log.warn("SkillGroupId \u4e0d\u5b58\u5728:"+t),e},e.prototype.GetBuff=function(t){return this.tmBuff.get(t)},e.prototype.GetTmBuff=function(){return this.tmBuff},e.prototype.GetSkillLuncher=function(t){return this.tmSkillLuncher.get(t)},e.prototype.GetTlLuncherGroup=function(){var t,e,r=this._tlLuncherGroup;if(null==r){r=new Set,this._tlLuncherGroup=r;try{for(var o=s(this.tmSkillLuncher),n=o.next();!n.done;n=o.next()){var i=c(n.value,2),a=(i[0],i[1]);r.add(a.GetGroupId())}}catch(l){t={error:l}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}}return r},e.prototype.GetTlRefSkillLuncher=function(t){var e=this;return this.RefSkillLuncher.getTlRef("groupId",t).map(function(t){return e.GetSkillLuncher(t.refId)})},e.prototype.GetBuffCarrier=function(t){var e=this.tmBuffCarrier.get(t);return this.assert(null!=e,"\u914d\u7f6e\u8868RefbuffCarrier.json\u65e0\u6cd5\u627e\u5230"+t+",\u8bf7\u7b56\u5212\u68c0\u67e5"),e},e.__cname="ModelSkill",i([u.injectField("Ref")],e.prototype,"Ref",void 0),e}(t("../ModelBehavior").ModelBehavior);r.ModelSkill=v,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/container/Container":void 0,"../../../ref/RefBuff":"RefBuff","../../../ref/RefBuffCarrier":"RefBuffCarrier","../../../ref/RefSkillGroup":"RefSkillGroup","../../../ref/RefSkillLuncher":"RefSkillLuncher","../../../ref/RefWrap":"RefWrap","../ModelBehavior":"ModelBehavior"}],ModelSta:[function(t,e,r){"use strict";cc._RF.push(e,"d87f8ZnA0lCOqoOr2Q/wTtq","ModelSta");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.ModelSta=void 0;var c=t("../../../../framework/container/Container"),u=t("../../../../framework/event/EventProxy"),p=t("../../../../framework/utils/PromiseWrap"),f=t("../../../../framework/utils/Toolset"),h=t("../../../generated/requestMsg/RequestBuyStaMsg"),y=t("../../../generated/requestMsg/RequestRoleMsg"),d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.eventProxy=new u.EventProxy,e}return n(e,t),e.prototype.GetEventProxy=function(){return this.eventProxy},e.prototype.enter=function(){return a(this,void 0,Promise,function(){var t=this;return l(this,function(){return this.toolSet=f.ToolSet.createToolSet(),this.toolSet.addListener(this.CtrlGameNet.getEventProxy(),"CmdEndBroMsg",function(e){t.updateEnd(e)},this),[2,null]})})},e.prototype.exit=function(){return a(this,void 0,Promise,function(){return l(this,function(){return f.ToolSet.destroyToolSet(this.toolSet),this.toolSet=null,[2,null]})})},e.prototype.updateEnd=function(t){var e=t.nextTime,r=t.end;this.SetnextFreshTime(e),this.SetEnd(r),this.eventProxy.execute("OnStaNextTimeReFreshUpdate")},e.prototype.SetnextFreshTime=function(t){this._nextFreshTime=t},e.prototype.GetnextFreshTime=function(){return this._nextFreshTime},e.prototype.SetEnd=function(t){this._end=t},e.prototype.GetEnd=function(){return this._end||0},e.prototype.SetEndMax=function(t){this._endMax=t},e.prototype.GetEndMax=function(){var t;return(null===(t=this.ModelMgr.ModelRole.GetRole())||void 0===t?void 0:t.GetEndMax())||30},e.prototype.RequestRoleEndUpdate=function(t){var e=this,r=t;this.SetnextFreshTime(),this.CtrlGameNet.send(new y.RequestRoleEndUpdate(r,this,function(t){if(t){var r=t.nextTime,o=t.end;e.SetnextFreshTime(r),e.SetEnd(o),e.eventProxy.execute("OnStaNextTimeReFreshUpdate")}},function(){e.eventProxy.execute("OnReFreshUpdateState")}))},e.prototype.GetAllRef=function(){return this.Ref.RefMgrbuySta.getRefAll()},e.prototype.SetData=function(t){this._data=t},e.prototype.GetData=function(){return this._data},e.prototype.BuySuc=function(t){var e,r;try{for(var o=s(this.GetData()||[]),n=o.next();!n.done;n=o.next()){var i=n.value;if(i.resId==t){i.state+=1;break}}}catch(a){e={error:a}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}},e.prototype.GetDataById=function(t){var e,r;this.log("data:",this.GetData());try{for(var o=s(this.GetData()||[]),n=o.next();!n.done;n=o.next()){var i=n.value;if(i.resId==t)return i}}catch(a){e={error:a}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return null},e.prototype.RequestBuyStaInfo=function(){var t=this;return this.CtrlGameNet.send(new h.RequestBuyStaInfo({},this,function(e){e&&t.SetData(e.cmdBuyStaState)}))},e.prototype.RequestBuyStaBuy=function(t){var e=this,r=t,o=new p.PromiseWrap;return this.CtrlGameNet.send(new h.RequestBuyStaBuy(r,this,function(r){r&&(e.BuySuc(t.resId),o.resolve(!0))})),o},e.__cname="ModelSta",i([c.injectField("Ref")],e.prototype,"Ref",void 0),i([c.injectField("CtrlGameNet")],e.prototype,"CtrlGameNet",void 0),i([c.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(t("../ModelBehavior").ModelBehavior);r.ModelSta=d,cc._RF.pop()},{"../../../../framework/container/Container":void 0,"../../../../framework/event/EventProxy":void 0,"../../../../framework/utils/PromiseWrap":void 0,"../../../../framework/utils/Toolset":void 0,"../../../generated/requestMsg/RequestBuyStaMsg":"RequestBuyStaMsg","../../../generated/requestMsg/RequestRoleMsg":"RequestRoleMsg","../ModelBehavior":"ModelBehavior"}],ModelSystem:[function(t,e,r){"use strict";cc._RF.push(e,"e2be0TSsLRDep1M0AJen10n","ModelSystem");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},c=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.SystemObject=r.ModelSystem=r.SystemId=void 0;var u=t("../../../../engine/EngineMain"),p=t("../../../../framework/FW"),f=t("../../../../framework/base/ScriptObject"),h=t("../../../../framework/condition/ConditionSet"),y=t("../../../../framework/container/Container"),d=t("../../../../framework/event/EventProxy"),m=t("../../../../framework/utils/StringUtil"),v=t("../../../../framework/utils/Toolset"),_=t("../../../generated/requestMsg/RequestSystemMsg"),S=t("../ModelBehavior");(function(t){t[t.None=0]="None",t[t.FirstRecharge=1]="FirstRecharge",t[t.MonthCard=2]="MonthCard",t[t.Fund=3]="Fund",t[t.DayWeekMonthGift=4]="DayWeekMonthGift",t[t.XiulianTask=5]="XiulianTask",t[t.EveryDaySignIn=6]="EveryDaySignIn",t[t.XiulianBag=7]="XiulianBag",t[t.HeroUnlock=8]="HeroUnlock",t[t.ActivityCenter=9]="ActivityCenter",t[t.ChapterReward=10]="ChapterReward",t[t.XiulianQuick=11]="XiulianQuick",t[t.HeroBag=12]="HeroBag",t[t.HeroLevelUp=13]="HeroLevelUp",t[t.Information=14]="Information",t[t.Contacts=15]="Contacts",t[t.VORuneBag=16]="VORuneBag",t[t.RuneSynthesis=17]="RuneSynthesis",t[t.Mall=18]="Mall",t[t.Breach=19]="Breach",t[t.Adventure=20]="Adventure",t[t.Mail=21]="Mail",t[t.XiuLianOnHook=22]="XiuLianOnHook",t[t.SpecialGift=23]="SpecialGift",t[t.EquipSynthesis=24]="EquipSynthesis",t[t.RuneMain=25]="RuneMain",t[t.DayTask=26]="DayTask",t[t.WeekTask=27]="WeekTask",t[t.AchieveTask=28]="AchieveTask",t[t.TabFund1=29]="TabFund1",t[t.TabFund2=30]="TabFund2",t[t.TabFund3=31]="TabFund3",t[t.Hero=32]="Hero",t[t.LuckyCat=33]="LuckyCat",t[t.Share=34]="Share"})(r.SystemId||(r.SystemId={}));var g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.eventProxy=new d.EventProxy,e}return n(e,t),e.prototype.enter=function(){return a(this,void 0,Promise,function(){var t,e,r,o,n,i,a,u,p,f,h,d,m,_,S,g=this;return l(this,function(){this.toolSet||(this.toolSet=v.ToolSet.createToolSet()),this.Ref=y.Container.inst().getByAlias("Ref"),this.tmObjSystem=new Map,n=new b,y.Container.inst().inject(n),this.tmObjSystem.set(0,n),t=this.Ref.RefMgropen.getRefAll();try{for(e=s(t),r=e.next();!r.done;r=e.next())o=r.value,(n=new b).Init(o,this),y.Container.inst().inject(n),this.log("systemidInit:",o.refId),this.tmObjSystem.set(o.refId,n)}catch(l){d={error:l}}finally{try{r&&!r.done&&(m=e.return)&&m.call(e)}finally{if(d)throw d.error}}i=function(t,e){a.toolSet.AddScriptListener(e.GetVisibleConditionSet().GetBoolScript(),function(t){g.eventProxy.execute("visiableUpdate",e),t&&e.GetNeedShowOpen()&&(g.isReqOver?g.PushSysAni(e):(null==g.tlSystemOpenSave&&(g.tlSystemOpenSave=[]),g.tlSystemOpenSave.push(e)))},a)},a=this;try{for(u=s(this.tmObjSystem),p=u.next();!p.done;p=u.next())(f=c(p.value,2))[0],h=f[1],i(0,h)}catch(C){_={error:C}}finally{try{p&&!p.done&&(S=u.return)&&S.call(u)}finally{if(_)throw _.error}}return[2,null]})})},e.prototype.afterEnterGame=function(){return a(this,void 0,Promise,function(){return l(this,function(){return this.RequestGetAllPlayClientAni(),[2]})})},e.prototype.exit=function(){return a(this,void 0,Promise,function(){var t,e,r,o;return l(this,function(){v.ToolSet.destroyToolSet(this.toolSet),this.toolSet=null,this.tlSystemOpenSave=null;try{for(t=s(this.tmObjSystem),e=t.next();!e.done;e=t.next())c(e.value,2)[1].destroy()}catch(n){r={error:n}}finally{try{e&&!e.done&&(o=t.return)&&o.call(t)}finally{if(r)throw r.error}}return this.tmObjSystem.clear(),this.tmObjSystem=null,[2,null]})})},e.prototype.GetSystem=function(t){if(null!=this.tmObjSystem){var e=this.tmObjSystem.get(t);return null==e&&p.FW.LWX.error("\u5f02\u5e38\uff0c\u6ca1\u8fd9\u4e2a\u7cfb\u7edf\uff0csystemId:",t),e}p.FW.LWX.error("\u5f02\u5e38\uff0c\u7cfb\u7edfobj\u521d\u59cb\u5316\u5931\u8d25")},e.prototype.GetAllSystem=function(){return this.tmObjSystem||[]},e.prototype.GetIsSystemOpen=function(t){var e,r=!1,o=this.GetSystem(t);return null!=o&&(r=o.GetConditionSet().GetBool(),e=o.GetConditionSet().GetReason()),[r,e]},e.prototype.RequestGetAllPlayClientAni=function(){var t=this;this.log("RequestGetAllPlayClientAni \u5ba2\u6237\u7aef\u8bf7\u6c42"),this.isReqOver=!1,this.CtrlMgr.CtrlGameNet.send(new _.RequestGetAllPlayClientAni({},this,function(e){t.log("RequestGetAllPlayClientAni \u670d\u52a1\u5668\u8fd4\u56de:",e),e&&(t.UpdateCache(e.clientAniRefId),t.tryPushTlSysAni())})).catch(function(){t.tryPushTlSysAni()})},e.prototype.UpdateCache=function(t){var e,r,o=this.ModelMgr.ModelVO.VORoleBag.GetOne();try{for(var n=s(t||[]),i=n.next();!i.done;i=n.next()){var a=i.value,l=m.StringUtil.format("systemOpen_{0}_",o.GetRoleId()+a);u.EngineMain.saveLocalStorage(l,"1")}}catch(c){e={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}},e.prototype.tryPushTlSysAni=function(){var t,e;if(this.isReqOver=!0,this.tlSystemOpenSave)try{for(var r=s(this.tlSystemOpenSave),o=r.next();!o.done;o=r.next()){var n=o.value;this.PushSysAni(n)}}catch(i){t={error:i}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},e.prototype.PushSysAni=function(t){var e=this.ModelMgr.ModelVO.VORoleBag.GetOne(),r=t.GetRefId(),o=m.StringUtil.format("systemOpen_{0}_",e.GetRoleId()+r);"0"==u.EngineMain.readLocalStorage(o,"0")&&this.CtrlMgr.CtrlSystem.PushShowOpenSystemObj(t)},e.prototype.RequestRecordClientAni=function(t){return a(this,void 0,void 0,function(){var e,r,o=this;return l(this,function(){return r={clientAniRefId:t},[2,(e=this).CtrlMgr.CtrlGameNet.send(new _.RequestRecordClientAni(r,e,function(){var e=o.ModelMgr.ModelVO.VORoleBag.GetOne(),r=m.StringUtil.format("systemOpen_{0}_",e.GetRoleId()+t);u.EngineMain.saveLocalStorage(r,"1")}))]})})},e.__cname="ModelSystem",i([y.injectField("Ref")],e.prototype,"Ref",void 0),i([y.injectField("CtrlMgr")],e.prototype,"CtrlMgr",void 0),i([y.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(S.ModelBehavior);r.ModelSystem=g;var b=function(t){function e(){var e=t.call(this)||this;return e.tlCondition=null,e.tlVisiableCondition=null,e}return n(e,t),e.prototype.Init=function(t,e){this.ref=t,this.mgr=e},e.prototype.GetRefId=function(){return this.ref&&this.ref.refId},e.prototype.GetOrder=function(){return this.ref&&this.ref.order},e.prototype.GetIcon=function(){if("LayerLuckyCat"==this.ref.url){var t=this.mgr.ModelMgr.ModelLuckyCat.GetIcon();if(null!=t)return t}return this.ref&&this.ref.icon},e.prototype.GetName=function(){return this.ref&&this.ref.name},e.prototype.GetEffect=function(){},e.prototype.GetNeedShowOpen=function(){return this.ref&&1==this.ref.isShowOpen||!1},e.prototype.GetUrl=function(){return this.ref&&this.ref.url},e.prototype.GetBelond=function(){return this.ref&&this.ref.belond},e.prototype.GetPreSystemId=function(){return this.ref&&this.ref.preResId},e.prototype.GetShowPreSystem=function(){return this.ref&&1==this.ref.ShowPreResId||!1},e.prototype.GetSystemRef=function(){return this.ref},e.prototype.GetTlRedDotList=function(){return this.ref&&this.ref.tlRDResId||[]},e.prototype.GetRDRefExpr=function(){return this.ref&&this.ref.RDExpr},e.prototype.GetRDExpr=function(){var t,e;if(null!=this.rdExpr)return this.rdExpr;var r=this.GetRDRefExpr(),o=new Map;try{for(var n=s(this.GetTlRedDotList()),i=n.next();!i.done;i=n.next()){var a=i.value;a==this.GetRefId()&&p.FW.Log.error("\u81ea\u5df1\u5173\u6ce8\u81ea\u5df1\u7ea2\u70b9,\u8bf7\u7b56\u5212\u68c0\u67e5\u914d\u7f6e\u8868\uff01resId:",a),o.set(a,!0);var l=this.mgr.GetSystem(a);if(null==l)p.FW.Log.error("\u7f3a\u5c11\u7cfb\u7edf\u914d\u7f6e\uff01\u5f00\u542f\u8868\u6dfb\u52a0 resId:",a);else{var c=l.GetRDExprToPre(o);c&&""!=c&&(r=r&&""!=r&&m.StringUtil.format("{0}+({1})",r,c)||c)}}}catch(u){t={error:u}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}return this.rdExpr=r,r},e.prototype.GetRDExprToPre=function(t){var e,r;if(null!=this.rdExpr)return this.rdExpr;var o=this.GetRDRefExpr();try{for(var n=s(this.GetTlRedDotList()),i=n.next();!i.done;i=n.next()){var a=i.value;if(a==this.GetRefId())p.FW.Log.error("\u81ea\u5df1\u5173\u6ce8\u81ea\u5df1\u7ea2\u70b9,\u8bf7\u7b56\u5212\u68c0\u67e5\u914d\u7f6e\u8868\uff01resId:",a);else if(t.has(a))p.FW.Log.error("\u91cd\u590d\u5f15\u7528\u7ea2\u70b9,\u8bf7\u7b56\u5212\u68c0\u67e5\u914d\u7f6e\u8868\uff0c\u53ea\u62a5\u9519\uff0c\u4e0d\u5f71\u54cd\u83b7\u53d6 resId:",a);else{t.set(a,!0);var l=this.mgr.GetSystem(a);if(null==l)p.FW.Log.error("\u7f3a\u5c11\u7cfb\u7edf\u914d\u7f6e\uff01\u5f00\u542f\u8868\u6dfb\u52a0 resId:",a);else{var c=l.GetRDExprToPre(t);c&&""!=c&&(o=m.StringUtil.format("{0}+({1})",o,c)||c)}}}}catch(u){e={error:u}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}return this.rdExpr=o,o},e.prototype.GetConditionSet=function(){return null==this.conditionSet&&(this.conditionSet=h.ConditionSet.CombineCondition(this.GetTlCondition(),"&&")),this.conditionSet},e.prototype.GetVisibleConditionSet=function(){return null==this.visibleConditionSet&&(this.visibleConditionSet=h.ConditionSet.CombineCondition(this.GetTlVisiableCondition(),"&&")),this.visibleConditionSet},e.prototype.GetTlVisiableCondition=function(){var t,e;if(!this.tlVisiableCondition){var r=[];if(this.GetTlVisiableConditionToPre(r),this.ref)try{for(var o=s(this.ref.visibleCondition),n=o.next();!n.done;n=o.next()){var i=n.value;i.type&&r.push(this.GetCondition(i))}}catch(a){t={error:a}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}this.tlVisiableCondition=r}return this.tlVisiableCondition},e.prototype.GetTlVisiableConditionToPre=function(t){var e=this.GetPreSystemId();e&&this.mgr.GetSystem(e).GetTlVisiableConditionToPre(t)},e.prototype.GetTlCondition=function(){var t,e;if(!this.tlCondition){var r=[];if(this.GetTlConditionToPre(r),this.ref)try{for(var o=s(this.ref.condition),n=o.next();!n.done;n=o.next()){var i=n.value;i.type&&r.push(this.GetCondition(i))}}catch(a){t={error:a}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}this.tlCondition=r}return this.tlCondition},e.prototype.GetTlConditionToPre=function(t){var e=this.GetPreSystemId();e&&this.mgr.GetSystem(e).GetTlConditionToPre(t)},e.prototype.GetCondition=function(t){var e={expr:null,tip:null},r=t.param;switch(t.type){case"open":e.expr="[open]",e.tip="\u5e38\u5f00";break;case"close":e.expr="[close]",e.tip=p.FW.G_W("\u7cfb\u7edf\u6682\u672a\u5f00\u542f");break;case"chapterLiveTime":e.expr=m.StringUtil.format("[chapterLiveTime:{0},{1}]",r.resId,r.value),e.tip=p.FW.G_W("\u7b49\u7ea7\u4e0d\u8db3");break;case"finishChapter":e.expr=m.StringUtil.format("[finishChapter:{0}]",r.resId),e.tip=m.StringUtil.format(p.FW.G_W("\u8bf7\u5148\u901a\u5173\u5173\u5361"));break;case"notTiShen":e.expr="[notTiShen]",e.tip="\u63d0\u5ba1\u6a21\u5f0f\u4e0d\u5f00\u542f";break;case"firstRecharge":e.expr="[firstRecharge]",e.tip=p.FW.G_W("\u9996\u5145\u5956\u52b1\u5df2\u9886\u53d6");break;case"fundVisible":e.expr="[fundVisible]",e.tip=p.FW.G_W("\u57fa\u91d1\u6ca1\u6709\u53ef\u9886\u53d6\u7684\u5956\u52b1");break;case"roleLevel":e.expr=m.StringUtil.format("[roleLevel:{0}]",r.value),e.tip=p.FW.G_W("\u89d2\u8272\u7b49\u7ea7\u4e0d\u6ee1\u8db3");break;case"hasSpecialGift":e.expr="[hasSpecialGift]",e.tip=p.FW.G_W("\u6ca1\u6709\u5c0f\u91d1\u732a");break;case"hasChapterReward":e.expr="[hasChapterReward]",e.tip=p.FW.G_W("\u6ca1\u6709\u53ef\u9886\u53d6\u7684\u7ae0\u8282\u5956\u52b1");break;case"hasHeroOrEquip":e.expr="[hasHeroOrEquip]",e.tip=p.FW.G_W("\u83b7\u53d6\u5230\u88c5\u5907\u6216\u8005\u82f1\u96c4\u65f6\u89e3\u9501");break;case"hasLuckyCat":e.expr="[hasLuckyCat]",e.tip=p.FW.G_W("\u6682\u65f6\u6ca1\u6709\u65b0\u7684\u5c0f\u91d1\u732a");break;case"hasShareType":e.expr="[hasShareType]",e.tip=p.FW.G_W("\u529f\u80fd\u8fd8\u5728\u5f00\u53d1\u4e2d\uff0c\u656c\u8bf7\u671f\u5f85");break;default:p.FW.Log.error("\u672a\u5b9a\u4e49\u7c7b\u578b ",t.type)}return e},e.__cname="SystemObject",e}(f.ScriptObject);r.SystemObject=b,cc._RF.pop()},{"../../../../engine/EngineMain":void 0,"../../../../framework/FW":void 0,"../../../../framework/base/ScriptObject":void 0,"../../../../framework/condition/ConditionSet":void 0,"../../../../framework/container/Container":void 0,"../../../../framework/event/EventProxy":void 0,"../../../../framework/utils/StringUtil":void 0,"../../../../framework/utils/Toolset":void 0,"../../../generated/requestMsg/RequestSystemMsg":"RequestSystemMsg","../ModelBehavior":"ModelBehavior"}],ModelTask:[function(t,e,r){"use strict";cc._RF.push(e,"423bdg3KKBE7rlJMP2rYs67","ModelTask");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.ModelTask=void 0;var s=t("../../../../framework/container/Container"),c=t("../../../../framework/event/EventProxy"),u=t("../../../generated/netProto/CmdInterface"),p=t("../../../generated/requestMsg/RequestTaskMsg"),f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.eventProxy=new c.EventProxy,e}return n(e,t),e.prototype.GetEventProxy=function(){return this.eventProxy},e.prototype.enter=function(){return a(this,void 0,Promise,function(){return l(this,function(){return this.Ref=s.Container.inst().getByAlias("Ref"),[2]})})},e.prototype.GetTlRefActiveTask=function(t){return this.Ref.RefMgractiveProcess.getTlRef("page",t)},e.prototype.RequestTakeActiveReward=function(t){return a(this,void 0,void 0,function(){var e,r=this;return l(this,function(o){switch(o.label){case 0:return e={page:t},[4,this.CtrlMgr.CtrlGameNet.send(new p.RequestTakeActiveReward(e,this,function(e){0==t?r.eventProxy.execute("dayTaskChange"):r.eventProxy.execute("weekTaskChange"),r.CtrlMgr.CtrlAlert.ShowGetReward(e.tlCmdGoods)}))];case 1:return o.sent(),[2]}})})},e.prototype.RequestTaskReward=function(t,e){var r=this,o={resId:t};return this.CtrlMgr.CtrlGameNet.send(new p.RequestTaskGetReward(o,this,function(t){t.tlCmdGoods&&(r.CtrlMgr.CtrlAlert.ShowGetReward(t.tlCmdGoods),r.RequestTaskInfo(e))}))},e.prototype.GetRefTaskReward=function(t){return this.Ref.RefMgrtaskReward.getRef("resId",t)},e.prototype.RequestTaskInfo=function(t){return a(this,void 0,void 0,function(){var e,r=this;return l(this,function(o){switch(o.label){case 0:return e={taskType:t},[4,this.CtrlMgr.CtrlGameNet.send(new p.RequestTaskGetInfo(e,this,function(e){r.UpdateTask(t,e.cmdTask)}))];case 1:return o.sent(),[2]}})})},e.prototype.UpdateTask=function(t,e){switch(t){case u.CmdTaskType.DAILY_TASK:this.UpdateDayTask(e);break;case u.CmdTaskType.WEEKLY_TASK:this.UpdateWeekTask(e);break;case u.CmdTaskType.ACHIEVEMENT_TASK:this.UpdateAchievementTask(e)}},e.prototype.GetRefDailyTask=function(t){return this.Ref.RefMgrdailyTask.getRef("resId",t)},e.prototype.GetTlDayTask=function(){return this.tlDayTask},e.prototype.UpdateDayTask=function(t){this.tlDayTask=t,this.eventProxy.execute("dayTaskChange")},e.prototype.GetRefWeekTask=function(t){return this.Ref.RefMgrweeklyTask.getRef("resId",t)},e.prototype.GetTlWeekTask=function(){return this.tlWeekTask},e.prototype.UpdateWeekTask=function(t){this.tlWeekTask=t,this.eventProxy.execute("weekTaskChange")},e.prototype.GetRefAchieveTask=function(t){return this.Ref.RefMgrachieveTask.getRef("resId",t)},e.prototype.GetTlRefAchieveTask=function(){return this.tlRefAchieveTask},e.prototype.UpdateAchievementTask=function(t){this.tlRefAchieveTask=t,this.eventProxy.execute("achieveTaskChange")},e.__cname="ModelTask",i([s.injectField("Ref")],e.prototype,"Ref",void 0),i([s.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([s.injectField("CtrlMgr")],e.prototype,"CtrlMgr",void 0),e}(t("../ModelBehavior").ModelBehavior);r.ModelTask=f,cc._RF.pop()},{"../../../../framework/container/Container":void 0,"../../../../framework/event/EventProxy":void 0,"../../../generated/netProto/CmdInterface":"CmdInterface","../../../generated/requestMsg/RequestTaskMsg":"RequestTaskMsg","../ModelBehavior":"ModelBehavior"}],ModelTime:[function(t,e,r){"use strict";cc._RF.push(e,"1b6fcYDY/RIB5wkzO/kzQRD","ModelTime");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.ModelTime=void 0;var s=t("../../../../framework/container/Container"),c=t("../../../../framework/FW"),u=t("../../../../framework/utils/PromiseWrap"),p=t("../../../../framework/utils/Toolset"),f=t("../../../generated/requestMsg/RequestSystemMsg"),h=t("../../../utils/ServerTime"),y=function(t){function e(){var e=t.call(this)||this;return e.lastSendTime=0,e.SendTimeGap=3e3,e._millisecondServerTime=0,e._serverTime=0,e.serverDayDate=new Date,e.tempDate=new Date,e.timeDate=new Date,e.toolSet=p.ToolSet.createToolSet(),e}return n(e,t),e.prototype.destroy=function(){this.toolSet&&(p.ToolSet.destroyToolSet(this.toolSet),this.toolSet=null),t.prototype.destroy.call(this)},e.prototype.enter=function(){return a(this,void 0,void 0,function(){return l(this,function(){return this.startUpdate(),[2]})})},e.prototype.exit=function(){return a(this,void 0,void 0,function(){return l(this,function(){return this.clearUpdate(),this.toolSet.removeAllListener(),[2]})})},e.prototype.startUpdate=function(){this.clearUpdate(),this.toolSet.addUpdateFrame(this.updateTime,this)},e.prototype.clearUpdate=function(){this.toolSet.stopAllUpdateFrame()},e.prototype.updateTime=function(){this.CtrlGameNet.getLogin()&&this.UpdateSync()},e.prototype.UpdateSync=function(){var t=this;if(null==this._promise){var e=cc.director.getTotalTime();if(0==this.lastSendTime||e-this.lastSendTime>this.SendTimeGap){var r=this.UpdateSyncInner();this._promise=r,r.then(function(){t._promise=null,t.lastSendTime=cc.director.getTotalTime()})}}},e.prototype.UpdateSyncInner=function(){var t=this,e=new u.PromiseWrap,r=h.ServerTime.GetLocalTime(),o=new f.RequestSystemSyncTime({},this,function(e){h.ServerTime.GetLocalTime();var o=e.serverTime,n=.001*o;t.setMillisecondServerTime(o),t.setServerTime(n);var i=n-r;h.ServerTime.SetDelta(i),t.ModelMallSEquip.UpdateLimitSEquipModuleState()});return this.CtrlGameNet.send(o).then(function(){e.resolve()}).catch(function(){e.resolve()}),e.promise},e.prototype.setMillisecondServerTime=function(t){var e=this;null==t?e.error("update millisecondServerTime null"):t<=0&&e.error("update millisecondServerTime <=0: ",t),e._millisecondServerTime=t,e._serverTime=Math.ceil(.001*t),e.afterUpdateTime()},e.prototype.getMillisecondServerTime=function(){return this._millisecondServerTime},e.prototype.setServerTime=function(t){var e=this;null==t?e.error("update serverTime null"):t<=0&&e.error("update serverTime <=0: ",t),e._serverTime=t,e._millisecondServerTime=1e3*t,e.afterUpdateTime()},e.prototype.getServerTime=function(){return this._serverTime},e.prototype.afterUpdateTime=function(){this.timeDate.setTime(this.getMillisecondServerTime()),this.updateServerDay()},e.prototype.updateServerDay=function(){this.serverDayDate.setTime(this.getMillisecondServerTime());var t=this.serverDayDate.getDate();this._serverDay?t!=this._serverDay&&(this._serverDay=t,c.FW.FWEvent.dispatchNextDayEvent(),this.log("================\u5938\u5929\u4e86 \u53d1\u9001\u81ea\u5b9a\u4e49\u6d88\u606f\u901a\u77e5================")):this._serverDay=t},e.prototype.getServerDay=function(){return this._serverDay},e.prototype.getNowOffsetTime=function(t,e,r,o){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===o&&(o=0),this._millisecondServerTime-this.getNowTempDate(t,e,r,o).getTime()},e.prototype.getNowTempDate=function(t,e,r,o){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===o&&(o=0),this.getTempDate(null,t,e,r,o)},e.prototype.getTempDate=function(t,e,r,o,n){void 0===t&&(t=null),void 0===e&&(e=0),void 0===r&&(r=0),void 0===o&&(o=0),void 0===n&&(n=0);var i=this;return null==t&&(t=i._millisecondServerTime),i.tempDate.setTime(t),i.tempDate.setHours(e),i.tempDate.setMinutes(r),i.tempDate.setSeconds(o),i.tempDate.setMilliseconds(n),i.tempDate},e.prototype.setServerStartData=function(t){this._startDate=t},e.prototype.getServerStartDate=function(){return this._startDate},e.prototype.getOpenServerDay=function(){var t=this._millisecondServerTime-this._startDate;return Math.ceil(t/1e3/86400)},e.prototype.getFullYear=function(){return this.timeDate.getFullYear()},e.prototype.getMonth=function(){return this.timeDate.getMonth()},e.prototype.getDate=function(){return this.timeDate.getDate()},e.prototype.getHours=function(){return this.timeDate.getHours()},e.prototype.getMinutes=function(){return this.timeDate.getMinutes()},e.prototype.getSeconds=function(){return this.timeDate.getSeconds()},e.prototype.getMilliseconds=function(){return this.timeDate.getMilliseconds()},e.prototype.getSeasonIdx=function(){return this.getOpenServerDay()%4},e.prototype.getCurYear=function(){var t=this.getOpenServerDay();return Math.ceil(t/4)},e.prototype.getIsSpring=function(){return 1==this.getSeasonIdx()},e.prototype.getIsSummer=function(){return 2==this.getSeasonIdx()},e.prototype.getNextWinter22Time=function(){return this.getNextWinter24Time()-7200},e.prototype.getNextWinter24Time=function(){var t=this.TimeUtil.now(),e=this.TimeUtil.time2Date(t),r=86400-(e.getHours()%24*3600+60*e.getMinutes()+e.getSeconds()),o=this.getSeasonIdx();return r+86400*(4-(o>0?o:4))},e.prototype.getTimeStr=function(){var t=this;return[t.getFullYear(),":",t.getMonth()+1,":",t.getDate()," ",t.getHours(),":",t.getMinutes(),":",t.getSeconds()].join("")},e.prototype.getServerTimeZone=function(){return null==this._serverTimeZone&&(this._serverTimeZone=0),this._serverTimeZone},e.prototype.setServerTimeZone=function(t){this._serverTimeZone=t,this.TimeUtil.localTimeDifference=this.localTimeDifference},Object.defineProperty(e.prototype,"localTimeDifference",{get:function(){if(null==this._localTimeDifference){var t=new Date;this._localTimeDifference=3600*this.getServerTimeZone()- -60*t.getTimezoneOffset(),this._localTimeDifference=1e3*this._localTimeDifference}return this._localTimeDifference},enumerable:!1,configurable:!0}),e.prototype.getZoneToServerMillisecond=function(){return this._millisecondServerTime+this.localTimeDifference},e.prototype.getZoneToServerTime=function(){return Math.floor(.001*this.getZoneToServerMillisecond())},e.prototype.getLocalTime=function(t,e,r,o){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===o&&(o=0);var n=3600*e+60*r+o-.001*this.localTimeDifference;return n<0?(t--,n+=86400):n>86400&&(t++,n-=86400),t<=0?t+=7:t>7&&(t-=7),{week:t,hour:e=Math.ceil(n/3600),min:r=Math.ceil((n-3600*e)/60),sec:o=n%60,sH:(e<10?"0":"")+e,sM:(r<10?"0":"")+r,sS:(o<10?"0":"")+o}},e.prototype.getNextResetTime=function(){return Math.floor(.001*this.TimeUtil.getNextDay12(this._millisecondServerTime))},e.__cname="ModelTime",i([s.injectField("TimeUtil")],e.prototype,"TimeUtil",void 0),i([s.injectField("CtrlGameNet")],e.prototype,"CtrlGameNet",void 0),i([s.injectField("ModelMallSEquip")],e.prototype,"ModelMallSEquip",void 0),e}(t("../ModelBehavior").ModelBehavior);r.ModelTime=y,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/container/Container":void 0,"../../../../framework/utils/PromiseWrap":void 0,"../../../../framework/utils/Toolset":void 0,"../../../generated/requestMsg/RequestSystemMsg":"RequestSystemMsg","../../../utils/ServerTime":"ServerTime","../ModelBehavior":"ModelBehavior"}],ModelVO:[function(t,e,r){"use strict";cc._RF.push(e,"99f15J8/pBEXJcwvBkcz7S8","ModelVO");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.ModelVO=void 0;var c=t("../../../../framework/container/Container"),u=t("../ModelBehavior"),p=t("./Friend/VOApplyFirend"),f=t("./Friend/VOBlackFriend"),h=t("./Friend/VOFirend"),y=t("./Goods/VOEquip"),d=t("./Goods/VOItem"),m=t("./Goods/VORune"),v=t("./Other/VOActivity"),_=t("./Other/VOChapter"),S=t("./Other/VOFuben"),g=t("./Other/VOHero"),b=t("./Other/VOLuckyCat"),C=t("./Other/VOMonthCard"),R=t("./Other/VORole"),M=t("./Other/VOServerRedDot"),w=t("./Other/VOSpecialGift"),O=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tlBag=[],e.tlGoodsBag=[],e.VOItemBag=e.CreateGoodsBag(d.VOItemBag),e.VOEquipBag=e.CreateGoodsBag(y.VOEquipBag),e.VORuneBag=e.CreateGoodsBag(m.VORuneBag),e.VORoleBag=e.CreateBag(R.VORoleBag),e.VOHeroBag=e.CreateBag(g.VOHeroBag),e.VOChapterBag=e.CreateBag(_.VOChapterBag),e.ActivityBag=e.CreateBag(v.VOActivityBag),e.VOFubenBag=e.CreateBag(S.VOFubenBag),e.VOSpecialGiftBag=e.CreateBag(w.VOSpecialGiftBag),e.VOFirendBag=e.CreateBag(h.VOFirendBag),e.VOApplyFirendBag=e.CreateBag(p.VOApplyFirendBag),e.VOBlackFriendBag=e.CreateBag(f.VOBlackFirendBag),e.VOServerRDBag=e.CreateBag(M.VOServerRedDotBag),e.VOMonthCardBag=e.CreateBag(C.VOMonthCardBag),e.VOLuckyCatBag=e.CreateBag(b.VOLuckyCatBag),e}return n(e,t),e.prototype.GetTlGoodsBag=function(){return this.tlGoodsBag},e.prototype.GetTlBag=function(){return this.tlBag},e.prototype.CreateBag=function(t){var e=c.Container.inst(),r=new t;return r.Init(this,e),this.tlBag.push(r),r},e.prototype.CreateGoodsBag=function(t){var e=this.CreateBag(t);return this.tlGoodsBag.push(e),e},e.prototype.enter=function(){return a(this,void 0,Promise,function(){var t,e,r,o,n,i;return l(this,function(){t=c.Container.inst();try{for(e=s(this.tlBag),r=e.next();!r.done;r=e.next())o=r.value,t.inject(o),o.OnEnterWrap()}catch(a){n={error:a}}finally{try{r&&!r.done&&(i=e.return)&&i.call(e)}finally{if(n)throw n.error}}return[2,null]})})},e.prototype.exit=function(){return a(this,void 0,Promise,function(){var t,e,r,o;return l(this,function(){try{for(t=s(this.tlBag),e=t.next();!e.done;e=t.next())e.value.OnExitWrap_cor()}catch(n){r={error:n}}finally{try{e&&!e.done&&(o=t.return)&&o.call(t)}finally{if(r)throw r.error}}return[2,null]})})},e.__cname="ModelVO",i([c.injectField("Ref")],e.prototype,"Ref",void 0),e}(u.ModelBehavior);r.ModelVO=O,cc._RF.pop()},{"../../../../framework/container/Container":void 0,"../ModelBehavior":"ModelBehavior","./Friend/VOApplyFirend":"VOApplyFirend","./Friend/VOBlackFriend":"VOBlackFriend","./Friend/VOFirend":"VOFirend","./Goods/VOEquip":"VOEquip","./Goods/VOItem":"VOItem","./Goods/VORune":"VORune","./Other/VOActivity":"VOActivity","./Other/VOChapter":"VOChapter","./Other/VOFuben":"VOFuben","./Other/VOHero":"VOHero","./Other/VOLuckyCat":"VOLuckyCat","./Other/VOMonthCard":"VOMonthCard","./Other/VORole":"VORole","./Other/VOServerRedDot":"VOServerRedDot","./Other/VOSpecialGift":"VOSpecialGift"}],NetMgr:[function(t,e,r){"use strict";cc._RF.push(e,"b531aFQ2cNHmp2++L1N0+oN","NetMgr");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.NetMgr=void 0;var l=t("../../framework/base/ScriptObject"),s=t("../../framework/utils/UpdateBeat"),c=t("./Net"),u=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return n(e,t),Object.defineProperty(e,"instance",{get:function(){return this._instance||(this._instance=new e)},enumerable:!1,configurable:!0}),e.prototype.init=function(){this.inited||(this.inited=!0,this.tmNet=new Map,s.UpdateBeat.addListener(this.update,this))},e.prototype.get=function(t,e){e=e||"main";var r=this.tmNet.get(e);return null==r&&(r=new c.Net(e,t),this.tmNet.set(e,r)),r},e.prototype.update=function(t){var e,r;try{for(var o=i(this.tmNet),n=o.next();!n.done;n=o.next()){var l=a(n.value,2);l[0],l[1].update(t)}}catch(s){e={error:s}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}},e.__cname="NetMgr",e}(l.ScriptObject);r.NetMgr=u,cc._RF.pop()},{"../../framework/base/ScriptObject":void 0,"../../framework/utils/UpdateBeat":void 0,"./Net":"Net"}],Net:[function(t,e,r){"use strict";cc._RF.push(e,"4bc7etWXqxG24HZOQG61ukA","Net");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.Net=void 0;var s=t("../../framework/base/ScriptObject"),c=t("../../framework/container/Container"),u=t("../../framework/FW"),p=t("../../framework/net/NetSocket"),f=t("../../framework/net/NetworkRequest"),h=t("../../framework/net/ProtoMgr"),y=function(t){function e(e,r){var o=t.call(this)||this;o.serverIndex=null,o.clientIndex=null;var n=o;n.serverIndex=0,n.clientIndex=0;var i=new p.NetSocket(e,r);n.netSocket=i;var a=h.ProtoMgr.get();return n.protoMgr=a,i.protoMgr=a,r.collectObj(i),o}return n(e,t),e.prototype.destroy=function(){var e=this;e.serverIndex=null,e.clientIndex=null;var r=this.netSocket;r&&r.destroy(),e.netSocket=null,e.protoMgr=null,t.prototype.destroy.call(this)},e.prototype.closeSocket=function(){return a(this,void 0,void 0,function(){return l(this,function(t){switch(t.label){case 0:return[4,this.netSocket.switchTo("idle")];case 1:return t.sent(),[2]}})})},e.prototype.connectServer=function(){return a(this,void 0,Promise,function(){var t,e;return l(this,function(r){switch(r.label){case 0:return[4,(t=this.netSocket).switchTo("idle")];case 1:return r.sent(),e=this.modelMgr.ModelServer.GetHandler(),t.setConnectInfo(e.GetHost(),e.GetPort(),e.GetIsWSS()),[2,t.connect()]}})})},e.prototype.send=function(t,e){var r=this;void 0===e&&(e=!0);var o=t.getReqMsgProtoName();return-1==u.FW.ignoreShowloadingNet.indexOf(o)?this.log("showLoading:net"):e=!1,new Promise(function(n,i){var a=t.cmdReqMsg,l=r.createCmdClientData(o,a),s=new f.NetworkRequest;s.packageRequest(r.clientIndex,l,t,e),r.netSocket.addNetworkRequest(s)||r.error("send add fail: "+s.messageName+" "+s.index),s.promise.then(function(t){n(t)}).catch(function(t){i(t)})})},e.prototype.createCmdClientData=function(t,r){var o=this.protoMgr,n=o.getMessageId(t);n||this.assert(!1,"\u4e0d\u5b58\u5728\u534f\u8bae"),null==r&&(r=e.netParamNull);var i=o.encode(t,r);this.clientIndex=this.clientIndex+1;var a={messageId:n,clientIndex:this.clientIndex,data:i,appendData:null};return o.encode("ClientCmdData",a)},e.prototype.update=function(t){var e=this.netSocket;e&&e.update(t)},e.prototype.addEvent=function(t,e,r){p.NetSocket.msgEventProxy.addListener(t,e,r)},e.prototype.removeEvent=function(t,e,r){p.NetSocket.msgEventProxy.removeListener(t,e,r)},e.prototype.removeCallerEvent=function(t){p.NetSocket.msgEventProxy.removeCallerListener(t)},e.prototype.getEventProxy=function(){return p.NetSocket.msgEventProxy},e.__cname="Net",e.netParamNull={},i([c.injectField("ModelMgr")],e.prototype,"modelMgr",void 0),e}(s.ScriptObject);r.Net=y,cc._RF.pop()},{"../../framework/FW":void 0,"../../framework/base/ScriptObject":void 0,"../../framework/container/Container":void 0,"../../framework/net/NetSocket":void 0,"../../framework/net/NetworkRequest":void 0,"../../framework/net/ProtoMgr":void 0}],NodeProxyMgr:[function(t,e,r){"use strict";cc._RF.push(e,"f428aIZFNdPYYARpsO3z6hh","NodeProxyMgr");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.NodeProxyMgr=void 0;var a=t("../../../../../../framework/base/ScriptObject"),l=t("../../../../../../framework/FW"),s=t("../../../../../../framework/pool/Pool"),c=t("./NodeProxy"),u=function(t){function e(){var e=t.call(this)||this;return e.tlNodeProxy=new Set,e.tlRemove=new Set,e.tlReturnPool=new Set,e.tlDirty=new Set,e.dirty=!1,e._t=0,e.pool=new s.Pool(function(){var t=new c.NodeProxy;return t.NodeProxyMgr=e,e.root.addChild(t.GetRoot()),t},function(t){t.destroy()},function(t){t.OnGetFromPool()},function(){return!0}),e}return n(e,t),e.prototype.onDestroy=function(){this.pool.returnAllToPool(),this.pool.destroy()},e.prototype.SetRoot=function(t){this.root=t},e.prototype.Update=function(){var t,e,r,o,n,a;try{for(var l=i(this.tlRemove),s=l.next();!s.done;s=l.next()){var c=s.value;this.TryReturnProxy(c)&&this.tlRemove.delete(c)}}catch(y){t={error:y}}finally{try{s&&!s.done&&(e=l.return)&&e.call(l)}finally{if(t)throw t.error}}if(this.dirty){this.dirty=!1;try{for(var u=i(this.tlDirty),p=u.next();!p.done;p=u.next())(c=p.value).UpdateChange()}catch(d){r={error:d}}finally{try{p&&!p.done&&(o=u.return)&&o.call(u)}finally{if(r)throw r.error}}this.tlDirty.clear()}try{for(var f=i(this.tlReturnPool),h=f.next();!h.done;h=f.next())c=h.value,this.pool.returnToPool(c)}catch(m){n={error:m}}finally{try{h&&!h.done&&(a=f.return)&&a.call(f)}finally{if(n)throw n.error}}this.tlReturnPool.clear()},e.prototype.debugNodeProxy=function(t){if(this._t-=t,this._t<=0){this._t=2;var e=this.pool;l.FW.ZJJ.log("\u5bf9\u8c61\u6c60: count:"+e.getCount()+" use:"+e.getUseCount())}},e.prototype.CreateProxy=function(){var t=this.pool.getFromPool();return this.tlNodeProxy.add(t),t},e.prototype.DestroyProxy=function(t){this.tlNodeProxy.has(t)&&(this.tlNodeProxy.delete(t),0==this.TryReturnProxy(t)&&this.tlRemove.add(t))},e.prototype.TryReturnProxy=function(t){var e=t.OnReturnToPool();return e&&this.tlReturnPool.add(t),e},e.prototype.MarkProxyDirty=function(t){this.dirty=!0,this.tlDirty.add(t)},e.prototype.GetTlNodeProxy=function(){return this.tlNodeProxy},e.__cname="NodeProxyMgr",e}(a.ScriptObject);r.NodeProxyMgr=u,cc._RF.pop()},{"../../../../../../framework/FW":void 0,"../../../../../../framework/base/ScriptObject":void 0,"../../../../../../framework/pool/Pool":void 0,"./NodeProxy":"NodeProxy"}],NodeProxy:[function(t,e,r){"use strict";cc._RF.push(e,"59905TqHFRHYoEAAYuH3mlX","NodeProxy");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},l=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.NodeProxy=r.INodeProxyAni=r.NodeProxyOrder=void 0;var s,c=t("../../../../../../framework/base/ScriptObject"),u=t("../../../../../../framework/FW"),p=t("../../../../../../framework/utils/StringUtil"),f=t("../../../../model/prefab/ModelPrefab");(function(t){t[t.ModelNotLoad=0]="ModelNotLoad",t[t.AnimationNotExist=1]="AnimationNotExist"})(s||(s={}));var h,y=function(t,e){this.code=t,this.reason=e||""};(function(t){t[t.EffectBack=0]="EffectBack",t[t.Ground=1]="Ground",t[t.RoleWedgitBack=2]="RoleWedgitBack",t[t.Role=3]="Role",t[t.RoleWedgit=4]="RoleWedgit",t[t.Effect=5]="Effect"})(h=r.NodeProxyOrder||(r.NodeProxyOrder={})),function(t){t[t.Idle=0]="Idle",t[t.Walk=1]="Walk",t[t.Die=2]="Die",t[t.Conjure=3]="Conjure"}(r.INodeProxyAni||(r.INodeProxyAni={}));var d=new cc.Color(255,255,255,255),m=function(t){function e(){var e=t.call(this)||this;return e.dirty=!1,e.loading=!1,e.isReturn=!0,e.isReturning=!1,e.active=!0,e.runtimeData={},e.nextData={},e.tlStreak=[],e.animations=[],e._isUpdateing=!1,e.root=new cc.Node,e.ResetRuntimeData(),e}return n(e,t),e.prototype.ResetRuntimeData=function(){var t,e,r,o;this.x=0,this.y=0,this.order=h.Role;var n=this.runtimeData;try{for(var i=l(Object.keys(n)),a=i.next();!a.done;a=i.next())n[u=a.value]=null}catch(p){t={error:p}}finally{try{a&&!a.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}n.model=null,n.alpha=1,n.scale=1,n.scaleX=1,n.scaleY=1,n.pivotX=.5,n.pivotY=.5,n.rotation=0,n.flip=!1,n.animation=null,n.additionColor=0,n.prototypeSize=null;try{for(var s=l(Object.keys(n)),c=s.next();!c.done;c=s.next()){var u=c.value;this.nextData[u]=n[u]}}catch(f){r={error:f}}finally{try{c&&!c.done&&(o=s.return)&&o.call(s)}finally{if(r)throw r.error}}},e.prototype.onDestroy=function(){this.root.removeFromParent(),this.root.destroy()},e.prototype.OnGetFromPool=function(){this.isReturn=!1,this.isReturning=!1,this.UpdateRootActive()},e.prototype.OnReturnToPool=function(){return this.root.active=!1,this.isReturning=!0,1!=this.loading&&(this.isReturn?void 0:(this.isReturn=!0,this.OnUnloadModel(),this.ResetRuntimeData(),this.root.angle=0,this.root.opacity=255,this.root.scaleX=1,this.root.scaleY=1,!0))},e.prototype.SetPropertype=function(t,e){this.runtimeData[t]!=e&&(this.nextData[t]=e,this.MarkDirty())},e.prototype.GetRoot=function(){return this.root},e.prototype.GetPrefab=function(){return this.prefab},e.prototype.PauseAnimation=function(){var t,e;if(this.animations&&this.animations.length>0)try{for(var r=l(this.animations),o=r.next();!o.done;o=r.next())o.value.pause()}catch(n){t={error:n}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},e.prototype.ResumeAnimation=function(){var t,e;if(this.animations&&this.animations.length>0)try{for(var r=l(this.animations),o=r.next();!o.done;o=r.next())o.value.resume()}catch(n){t={error:n}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},e.prototype.GetAnimationClip=function(t){return this.anim?this.anim.getClips()[t]:null},e.prototype.GetAnimationDruation=function(t){var e=0;if(this.anim){var r=this.anim.getClips()[t];r&&(e=r.duration)}return e},e.prototype.SetActive=function(t){this.active!=t&&(this.active=t,this.UpdateRootActive())},e.prototype.SetXY=function(t,e){this.x=t,this.y=e,this.UpdateRootActive()},e.prototype.GetAnimate=function(){return this.anim},e.prototype.SetZIndex=function(t){this.root.zIndex=1e3*t-this.y/100},e.prototype.SetScale=function(t){this.SetPropertype("scale",t)},e.prototype.SetLocalScale=function(t,e){this.SetPropertype("scaleX",t),this.SetPropertype("scaleY",e)},e.prototype.SetPivot=function(t,e){this.SetPropertype("pivotX",t),this.SetPropertype("pivotY",e)},e.prototype.SetRotation=function(t){this.SetPropertype("rotation",t)},e.prototype.GetRotation=function(){return this.root.angle},e.prototype.FindChild=function(t,e){var r=e;if(this.prefab)for(var o=this.prefab,n=t.split("."),i=0;i<n.length;i++){var a=n[i];if(null==(o=o.getChildByName(a)))break;i==n.length-1&&(r=o)}return r},e.prototype.MarkDirty=function(){this.dirty=!0,this.NodeProxyMgr.MarkProxyDirty(this)},e.prototype.UpdateChange=function(){var t=this;this._isUpdateing||(this._isUpdateing=!0,this.UpdateChangeInner().then(function(){t._isUpdateing=!1}).catch(function(e){t._isUpdateing=!1,t.HandlerError(e)}))},e.prototype.GetIsLoading=function(){return this.loading},e.prototype.HandlerError=function(t){u.FW.ZJJ.debug(p.StringUtil.format("nodeproxy error:{0} {1}",s[t.code],t.reason)),t.code==s.ModelNotLoad&&this.SetPropertype("model",null)},e.prototype.UpdateChangeInner=function(){return i(this,void 0,void 0,function(){var t,e;return a(this,function(r){switch(r.label){case 0:return this.UpdateProperty(),t=this.runtimeData,e=this.nextData,t.model==e.model?[3,2]:(this.loading=!0,[4,this.UpdateChangeModel()]);case 1:r.sent(),this.loading=!1,r.label=2;case 2:return null!=this.prefab&&(this.UpdateChangePrototypeSize(),this.UpdateChangeAnimation(),this.UpdateChangePiovt(),this.UpdateChangeAdditionColor(),this.UpdateChangeStreak()),this.UpdateNodeName(),[2]}})})},e.prototype.UpdateProperty=function(){this.UpdateChangeRotation(),this.UpdateChangeScale(),this.UpdateChangeAlpha()},e.prototype.UpdateChangeModel=function(){return i(this,void 0,void 0,function(){var t,e,r,o,n,i;return a(this,function(a){switch(a.label){case 0:if(t=this.runtimeData,e=this.nextData,t.model==e.model)return[2];a.label=1;case 1:if(this.prefab&&(this.OnUnloadModel(),this.prefab=null),null==e.model)return[2];r=e.model,o=void 0,a.label=2;case 2:return a.trys.push([2,4,,5]),[4,f.ModelPrefab.instance.CreateAsset(r)];case 3:return(o=a.sent()).opacity=255,o.scale=1,o.active=!0,[3,5];case 4:throw a.sent(),n=s.ModelNotLoad,i="\u6a21\u578b\u52a0\u8f7d\u5931\u8d25"+e.model,new y(n,i);case 5:return r!=e.model?(f.ModelPrefab.instance.DestroyAsset(o),[3,1]):(t.model=r,this.prefab=o,o.setParent(this.root),this.OnLoadModel(),[3,6]);case 6:return[2]}})})},e.prototype.OnUnloadModel=function(){var t,e;try{for(var r=l(this.tlStreak),o=r.next();!o.done;o=r.next()){var n=o.value;n.com.stroke=n.stroke,n.com.color=n.color}}catch(a){t={error:a}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}this.tlStreak.length=0,this.ResumeAnimation(),this.sprite&&this.sprite.node.setAnchorPoint(this.originAnchorX,this.originAnchorY),this.anim&&this.anim.stop(),this.SetAdditionColor(0),this.prefab&&(this.prefab.scale=1,this.prefab.active=!0,this.prefab.removeFromParent(),f.ModelPrefab.instance.DestroyAsset(this.prefab)),this.prefab=null,this.sprite=null,this.material=null,this.anim=null,this.animations.length=0;var i=this.runtimeData;i.animation=null,i.prototypeSize=null,i.additionColor=null},e.prototype.OnLoadModel=function(){var t,e;try{for(var r=l(this.prefab.getComponentsInChildren(cc.MotionStreak)),o=r.next();!o.done;o=r.next()){var n=o.value,i={stroke:n.stroke,color:n.color,com:n};this.tlStreak.push(i)}}catch(u){t={error:u}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}var a,s,c=this.prefab;null!=(c=c.getChildByName("position"))&&(c=c.getChildByName("sprite")),!(a=c.getComponent(cc.Sprite))&&(a=c.getComponentInChildren(cc.Sprite)),a&&(this.sprite=a,this.material=a.getMaterial(0)),this.animations=this.prefab.getComponentsInChildren(cc.Animation),!(s=a.node.getComponent(cc.Animation))&&!(s=a.node.getComponentInChildren(cc.Animation))&&(s=this.animations[0]),s&&(this.anim=s,s.play()),this.originAnchorX=a.node.anchorX,this.originAnchorY=a.node.anchorY},e.prototype.UpdateChangeAnimation=function(){var t=this.runtimeData,e=this.nextData;if(t.animation!=e.animation&&null!=this.anim&&null!=e.animation){var r=e.animation;this.SetAnim(r),t.animation=r}},e.prototype.SetAnim=function(t){if(null!=this.anim){var e=this.anim.getClips();if(0!=e.length){var r=this.runtimeData,o=this.nextData;if(r.animation!=o.animation){var n=e[t];if(null!=n)this.anim.play(n.name);else{s.AnimationNotExist;var i=p.StringUtil.format("\u65e0\u6cd5\u83b7\u53d6\u52a8\u753b\u4e0b\u6807{0} {1}",r.model,o.animation);console.error(i)}}}}},e.prototype.UpdateChangeScale=function(){var t=this.runtimeData,e=this.nextData,r=!1;if(0!=(r=(r=(r=(r=r||t.scale!=e.scale)||t.flip!=e.flip)||t.scaleX!=e.scaleX)||t.scaleY!=e.scaleY)){var o=e.scale,n=e.flip,i=null==e.scaleX?1:e.scaleX,a=null==e.scaleY?1:e.scaleY,l=o*(n?-1:1)*i,s=o*a;this.root.scaleX=l,this.root.scaleY=s,t.scale=o,t.flip=n,t.scaleX=i,t.scaleY=a}},e.prototype.UpdateChangePiovt=function(){var t=this.runtimeData,e=this.nextData;if(t.pivotX!=e.pivotX||t.pivotY!=e.pivotY){var r=this.sprite;if(null!=r){var o=null==e.pivotX?.5:e.pivotX,n=null==e.pivotY?.5:e.pivotY;r.node.setAnchorPoint(o,n),t.pivotX=o,t.pivotY=n}}},e.prototype.UpdateChangeAlpha=function(){var t,e,r=this.runtimeData,o=this.nextData;if(r.alpha!=o.alpha){var n=o.alpha;n=Math.max(0,Math.min(1,n)),this.root.opacity=255*n,d.a=255*n;try{for(var i=l(this.tlStreak),a=i.next();!a.done;a=i.next())a.value.com.color=d}catch(s){t={error:s}}finally{try{a&&!a.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}r.alpha=o.alpha}},e.prototype.UpdateChangeRotation=function(){var t=this.runtimeData,e=this.nextData;t.rotation!=e.rotation&&(this.root.angle=e.rotation,t.rotation=e.rotation)},e.prototype.UpdateChangeAdditionColor=function(){var t=this.runtimeData,e=this.nextData;if(t.additionColor!=e.additionColor){var r=e.additionColor;this.SetAdditionColor(r),t.additionColor=r}},e.prototype.SetAdditionColor=function(t){null!=this.material&&null!=this.material.getProperty("additionColor",0)&&this.material.setProperty("additionColor",t,0)},e.prototype.UpdateNodeName=function(){this.runtimeData.model?this.root.name=this.runtimeData.model:this.root.name="no_name"},e.prototype.IsRootActive=function(){var t=!0;return 1==this.loading&&(t=!1),this.isReturning&&(t=!1),t},e.prototype.UpdateRootActive=function(){var t=this.active;0==this.IsRootActive()&&(t=!1),this.root.active=t,t&&(this.root.x=this.x,this.root.y=this.y)},e.prototype.SetPrototypeSize=function(t){null!=t&&this.SetPropertype("prototypeSize",t)},e.prototype.UpdateChangePrototypeSize=function(){var t=this.runtimeData,e=this.nextData;if(t.prototypeSize!=e.prototypeSize){for(var r=!1,o=this.runtimeData.model,n=0,i=0;;){var a=this.FindChild("position",null);if(null==a)break;if(n=a.width,i=a.height,0==n&&0==i)break;var l=Math.abs(Math.max(n,i)),s=e.prototypeSize;if(0==l)break;this.prefab.scale=s/l,r=!0;break}this.assert(1==r,"\u6a21\u578b\u539f\u578b\u5927\u5c0f\u6570\u636e\u9519\u8bef\uff0c\u8bf7\u68c0\u67e5 \u6a21\u578b:"+o+" \u8282\u70b9:position \u5bbd\u9ad8:"+n+","+i),t.prototypeSize=e.prototypeSize}},e.prototype.UpdateChangeStreak=function(){var t,e,r=this.runtimeData,o=this.nextData.scale*this.prefab.scale;if(r.streakScale!=o)try{for(var n=l(this.tlStreak),i=n.next();!i.done;i=n.next()){var a=i.value;a.com.stroke=o*a.stroke}}catch(s){t={error:s}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}r.streakScale=o},e.__cname="NodeProxy",e}(c.ScriptObject);r.NodeProxy=m,cc._RF.pop()},{"../../../../../../framework/FW":void 0,"../../../../../../framework/base/ScriptObject":void 0,"../../../../../../framework/utils/StringUtil":void 0,"../../../../model/prefab/ModelPrefab":"ModelPrefab"}],ObjPayGift:[function(t,e,r){"use strict";cc._RF.push(e,"1ae01UhQdxKV45Gp/oWw3ex","ObjPayGift"),Object.defineProperty(r,"__esModule",{value:!0}),r.ObjPayGift=void 0;var o=function(){function t(){}return t.prototype.Init=function(t,e){this.gift=t,this.product=e,this.status="Idle"},t.prototype.GetOrderStatus=function(){return this.status},t.prototype.SetOrderStatus=function(t){this.status=t},t.prototype.GetPrice=function(){return this.gift.price},t}();r.ObjPayGift=o,cc._RF.pop()},{}],OnOffBattleParams:[function(t,e,r){"use strict";cc._RF.push(e,"7c9e3WrBY5Fc5Im47AzIh0v","OnOffBattleParams");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.OnOffBattleParams=void 0;var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._value=!1,e}return n(e,t),e.prototype.GetKey=function(){return"battle_show_params"},e.__cname="OnOffBattleParams",e}(t("./OnOff").OnOff);r.OnOffBattleParams=i,cc._RF.pop()},{"./OnOff":"OnOff"}],OnOffEffectWeakening:[function(t,e,r){"use strict";cc._RF.push(e,"6590aEBgpNLB5+T1EzGU+s/","OnOffEffectWeakening");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.OnOffEffectWeakening=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetKey=function(){return"setting_effectWeakening"+this.GetAccount()},e.__cname="OnOffEffectWeakening",e}(t("./OnOff").OnOff);r.OnOffEffectWeakening=i,cc._RF.pop()},{"./OnOff":"OnOff"}],OnOffJoystick:[function(t,e,r){"use strict";cc._RF.push(e,"57f2a1jthtHToFpksTtndNP","OnOffJoystick");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.OnOffJoystick=void 0;var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._value=!0,e}return n(e,t),e.prototype.GetKey=function(){return"setting_rocker"+this.GetAccount()},e.__cname="OnOffJoystick",e}(t("./OnOff").OnOff);r.OnOffJoystick=i,cc._RF.pop()},{"./OnOff":"OnOff"}],OnOffLog:[function(t,e,r){"use strict";cc._RF.push(e,"82001EN8YFJo64l5J/wKeJc","OnOffLog");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.OnOffLog=void 0;var i=t("../../../framework/log/Log"),a=function(t){function e(e){var r=t.call(this)||this;return r._value=!1,r._name=e,r}return n(e,t),e.prototype.GetKey=function(){return"setting_log_"+this.GetLogName()},e.prototype.GetLogName=function(){return this._name||""},e.prototype.Save=function(){t.prototype.Save.call(this),i.Log.tmLogsss.get(this._name).setEnabled(this._value)},e.prototype.Load=function(){t.prototype.Load.call(this),i.Log.tmLogsss.get(this._name).setEnabled(this._value)},e.__cname="OnOffLog",e}(t("./OnOff").OnOff);r.OnOffLog=a,cc._RF.pop()},{"../../../framework/log/Log":void 0,"./OnOff":"OnOff"}],OnOffMgr:[function(t,e,r){"use strict";cc._RF.push(e,"37feeFOAs1A0aYy5ze961FC","OnOffMgr"),Object.defineProperty(r,"__esModule",{value:!0}),r.OnOffMgr=void 0;var o=t("./OnOffBattleParams"),n=t("./OnOffEffectWeakening"),i=t("./OnOffJoystick"),a=t("./OnOffLog"),l=t("./OnOffMusic"),s=t("./OnOffSound"),c=function(){function t(){this.tmSub=new Map,this.OnOffSound=this.CreateSub(s.OnOffSound),this.OnOffMusic=this.CreateSub(l.OnOffMusic),this.OnOffEffectWeakening=this.CreateSub(n.OnOffEffectWeakening),this.OnOffJoystick=this.CreateSub(i.OnOffJoystick),this.OnOffBattleParams=this.CreateSub(o.OnOffBattleParams)}return t.prototype.CreateSub=function(t,e){var r=new t,o=e||t.__cname;return this.tmSub.set(o,r),r.Load(),r},t.prototype.CreateLogOnOff=function(t){var e=new a.OnOffLog(t);this.tmSub.set(t,e),e.Load()},t.prototype.GetSub=function(t){return this.tmSub.get(t)},t.__cname="OnOffMgr",t}();r.OnOffMgr=c,cc._RF.pop()},{"./OnOffBattleParams":"OnOffBattleParams","./OnOffEffectWeakening":"OnOffEffectWeakening","./OnOffJoystick":"OnOffJoystick","./OnOffLog":"OnOffLog","./OnOffMusic":"OnOffMusic","./OnOffSound":"OnOffSound"}],OnOffMusic:[function(t,e,r){"use strict";cc._RF.push(e,"d010ec0ZxRJspv9Lze7OqKF","OnOffMusic");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.OnOffMusic=void 0;var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._value=!0,e}return n(e,t),e.prototype.GetKey=function(){return"setting_music"+this.GetAccount()},e.__cname="OnOffMusic",e}(t("./OnOff").OnOff);r.OnOffMusic=i,cc._RF.pop()},{"./OnOff":"OnOff"}],OnOffSound:[function(t,e,r){"use strict";cc._RF.push(e,"71ef9OXXoNDl6PCxybVCwT3","OnOffSound");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.OnOffSound=void 0;var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._value=!0,e}return n(e,t),e.prototype.GetKey=function(){return"setting_sound"+this.GetAccount()},e.__cname="OnOffSound",e}(t("./OnOff").OnOff);r.OnOffSound=i,cc._RF.pop()},{"./OnOff":"OnOff"}],OnOff:[function(t,e,r){"use strict";cc._RF.push(e,"a3697mEHB1LMYK4DpwReUnZ","OnOff"),Object.defineProperty(r,"__esModule",{value:!0}),r.OnOff=void 0;var o=t("../../../engine/EngineMain"),n=t("../../../framework/FW"),i=function(){function t(){}return t.prototype.SetValue=function(t){this._value=t},t.prototype.GetValue=function(){return this._value},t.prototype.Save=function(){n.FW.ZJJ.log("save onoff: ",this.GetKey(),this.GetValue()),o.EngineMain.saveLocalStorage(this.GetKey(),this.GetValue())},t.prototype.Load=function(){var t=o.EngineMain.readLocalStorage(this.GetKey());null!=t&&("true"==t?this._value=!0:"false"==t?this._value=!1:isNaN(t)?this._value=t:this._value=Number(t)),n.FW.Log.log("load onoff: ",this.GetKey(),this.GetValue())},t.prototype.Delete=function(){o.EngineMain.removeLocalStorage(this.GetKey())},t.prototype.GetAccount=function(){return o.EngineMain.readLocalStorage("account_num")},t.__cname="OnOff",t}();r.OnOff=i,cc._RF.pop()},{"../../../engine/EngineMain":void 0,"../../../framework/FW":void 0}],OtherSkillBrickSuper:[function(t,e,r){"use strict";cc._RF.push(e,"59be5wcKW5D4a+2Vk2l9Lu7","OtherSkillBrickSuper");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.OtherSkillBrickSuper=void 0;var a,l=t("../../../view/nodeproxy/NodeProxy"),s=t("../../role/RoleBuilder"),c=t("../../type/ComType"),u=t("../BaseSkill"),p=t("./BaseOthersSkill");(function(t){t[t.Idle=0]="Idle",t[t.Ready=1]="Ready",t[t.Conjure=2]="Conjure",t[t.Run=3]="Run"})(a||(a={}));var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state=[],e.time=[],e.count=[],e}return n(e,t),e.prototype.OnChangeParams=function(t){this.SwitchIdle(t)},e.prototype.OnUpdateParam=function(){},e.prototype.OnAddContext=function(){},e.prototype.OnRemoveContext=function(t){this.state[t]=null,this.time[t]=null,this.count[t]=null},e.prototype.OnUpdate=function(t){var e,r;try{for(var o=i(this.tlContextId),n=o.next();!n.done;n=o.next()){var l=n.value;switch(this.state[l]){case a.Idle:this.UpdateIdle(l,t);break;case a.Conjure:this.UpdateConjure(l,t);break;case a.Run:this.UpdateRunning(l,t)}}}catch(s){e={error:s}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}},e.prototype.SwitchIdle=function(t){this.state[t]=a.Idle,this.time[t]=0,this.count[t]=0},e.prototype.UpdateIdle=function(t,e){this.time[t]+=e,this.time[t]>this.GetCD(t)&&this.SwitchReady(t)},e.prototype.SwitchReady=function(t){var e=this.tlContext[t];this.state[t]=a.Ready,e.isAuto&&this.SwitchConjure(t)},e.prototype.SwitchConjure=function(t){var e=this.tlContext[t].eid;if(this.GetHasAnimationClip(t,l.INodeProxyAni.Conjure)){var r=this.GetAnimationDruationConjure(t,l.INodeProxyAni.Conjure);this.state[t]=a.Conjure,this.time[t]=r,this.ComState.SwitchConjure(e)}else this.SwitchRunning(t)},e.prototype.UpdateConjure=function(t,e){var r=this.time;r[t]-=e,r[t]<0&&this.SwitchRunning(t)},e.prototype.SwitchRunning=function(t){this.state[t]=a.Run,this.time[t]=0,this.count[t]=0},e.prototype.UpdateRunning=function(t,e){var r=this.GetInterval(t),o=this.GetNum(t);for(this.time[t]+=e;!(this.time[t]<=r||this.count[t]>=o);)this.OnTrigger(t),this.count[t]++,this.time[t]-=r;this.count[t]>=o&&this.SwitchIdle(t)},e.prototype.OnTrigger=function(t){var e=this.tlContext[t].eid,r=this.Battle.getRef(e),o=(this.ComPos.d,this.GetNum(t)),n=this.count[t],i=(this._param[t],this.GetBullet(t,0)),a=2*Math.PI/o,l=n*a+.5*a,u=new s.RBContext;u.sender=r,u.rad=l;var p=new(this.GetBulletBuilder(i));p.Setup(u),p.SetProperty("resId",i),p.SetProperty("bullet_tag",c.EComTag.MonsterBullet),this.SystemRole.ApplyBuilder(p),this.Battle.applyModify()},e.prototype.GetState=function(t){var e=t.cid;switch(this.state[e]){case a.Idle:return u.SkillState.Idle;case a.Ready:return u.SkillState.Ready;case a.Conjure:case a.Run:return u.SkillState.Running}},e.prototype.TryRun=function(t){var e=t.cid;return this.GetState(t)==u.SkillState.Ready&&(this.SwitchConjure(e),!0)},e.__cname="OtherSkillBrickSuper",e}(p.BaseOthersSkill);r.OtherSkillBrickSuper=f,cc._RF.pop()},{"../../../view/nodeproxy/NodeProxy":"NodeProxy","../../role/RoleBuilder":"RoleBuilder","../../type/ComType":"ComType","../BaseSkill":"BaseSkill","./BaseOthersSkill":"BaseOthersSkill"}],OtherSkillCharge:[function(t,e,r){"use strict";cc._RF.push(e,"aa33f5XLl1MzKUyHA7hel0y","OtherSkillCharge");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.OtherSkillCharge=void 0;var s,c=t("../../../../../../../framework/container/Container"),u=t("../../../view/effect/SubSysEffectWarning"),p=t("../../../view/nodeproxy/NodeProxy"),f=t("../BaseSkill"),h=t("./BaseOthersSkill");(function(t){t[t.Idle=0]="Idle",t[t.Ready=1]="Ready",t[t.Conjure=2]="Conjure",t[t.Run=3]="Run"})(s||(s={}));var y={type:u.EEffectWarnningType.Square,x:0,y:0,target:null,min:50,max:0,duration:0,direction:0,lineWidth:0},d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state=[],e.time=[],e.time_ani=[],e.target_direction=[],e}return n(e,t),e.prototype.OnUpdateParam=function(t,e){var r=this._param[t];r.distance=parseInt(e[0])||50,r.conjure=(parseInt(e[1])||1e3)/1e3,r.effecttime=(parseInt(e[2])||1e3)/1e3},e.prototype.OnChangeParams=function(t){this.SwitchReady(t)},e.prototype.OnAddContext=function(){},e.prototype.OnRemoveContext=function(t){this.state[t]=null,this.time[t]=null},e.prototype.OnUpdate=function(t){var e,r;try{for(var o=a(this.tlContextId),n=o.next();!n.done;n=o.next()){var i=n.value;switch(this.state[i]){case s.Idle:this.UpdateIdle(i,t);break;case s.Conjure:this.UpdateConjure(i,t);break;case s.Run:this.UpdateRunning(i,t)}}}catch(l){e={error:l}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}},e.prototype.SwitchReady=function(t){this.state[t]=s.Ready,this.tlContext[t].isAuto&&this.SwitchConjure(t)},e.prototype.SwitchIdle=function(t){this.state[t]=s.Idle,this.time[t]=0},e.prototype.UpdateIdle=function(t,e){this.time[t]+=e,this.time[t]>this.GetCD(t)&&this.SwitchReady(t)},e.prototype.SwitchConjure=function(t){var e=this.ComPos.x,r=this.ComPos.y,o=this._param[t],n=this.time_ani,i=o.conjure,a=this.tlContext[t].eid,l=this.ComVelocity.speed,c=(this.ComVelocity.basespeed,this.ComCollision.r),f=this.ComPos.d,h=this.ComVelocity.vx,d=this.ComVelocity.vy,m=this.ComVelocity.moving,v=this.ComVar.SHOOT_TARGET,_=this.target_direction;if(n[t]=0,this.GetHasAnimationClip(t,p.INodeProxyAni.Conjure)){var S=this.GetAnimationDruationConjure(t,p.INodeProxyAni.Conjure);n[t]=S,this.state[t]=s.Conjure,this.time[t]=i,this.ComState.SwitchConjure(a,!1)}else{var g=this.Battle.getRef(a);this.ComState.SwitchIdle(g),this.state[t]=s.Conjure,this.time[t]=i}var b=f[a],C=v[a],R=this.time[t];if(C){var M=m[C]?h[C]:0,w=m[C]?d[C]:0,O=e[C]+M*l[C]*R,B=r[C]+w*l[C]*R;b=Math.atan2(B-r[a],O-e[a])}_[t]=b;var P=o.effecttime,G=y;G.type=u.EEffectWarnningType.Square,G.x=e[a],G.y=r[a],G.target=null,G.direction=_[t],G.lineWidth=2*c[a],G.min=288,G.max=720,G.duration=P,this.SystemViewEffect.AddEffectWarning(G)},e.prototype.UpdateConjure=function(t,e){var r=this.time;r[t]-=e,r[t]<0&&this.SwitchRunning(t)},e.prototype.SwitchRunning=function(t){var e=this.tlContext[t].eid;this.ComVelocity.speed,this.ComVelocity.basespeed,this.state[t]=s.Run,this.time[t]=0,this.ComPrefab.ChangeModel(e,null,p.INodeProxyAni.Walk)},e.prototype.UpdateRunning=function(t,e){this.ComVelocity.speed,this.ComVelocity.basespeed;var r=this.ComVelocity.moving,o=this.ComPos.x,n=this.ComPos.y,i=this.ComPos.d,a=this.target_direction,s=this.tlContext[t].eid,c=this.time[t]+e;if(this.time[t]=c,c>1.2){var u=this.Battle.getRef(s);return this.ComState.SwitchIdle(u),void this.SwitchReady(t)}var p=c/1.2,f=cc.misc.lerp(250,600,p),h=a[t],y=o[s]+Math.cos(h)*f*e,d=n[s]+Math.sin(h)*f*e,m=l(this.SystemMove.fixPosMove(y,d),2),v=m[0],_=m[1];o[s]=v,n[s]=_,i[s]=h,r[s]=!0},e.prototype.GetState=function(t){var e=t.cid;switch(this.state[e]){case s.Idle:return f.SkillState.Idle;case s.Ready:return f.SkillState.Ready;case s.Conjure:case s.Run:return f.SkillState.Running}},e.prototype.TryRun=function(t){var e=t.cid;return this.GetState(t)==f.SkillState.Ready&&(this.SwitchConjure(e),!0)},e.__cname="OtherSkillCharge",i([c.injectField("ComVelocity")],e.prototype,"ComVelocity",void 0),i([c.injectField("ComVar")],e.prototype,"ComVar",void 0),i([c.injectField("ComPos")],e.prototype,"ComPos",void 0),i([c.injectField("ComCollision")],e.prototype,"ComCollision",void 0),i([c.injectField("ComState")],e.prototype,"ComState",void 0),i([c.injectField("ComPrefab")],e.prototype,"ComPrefab",void 0),i([c.injectField("SystemMove")],e.prototype,"SystemMove",void 0),i([c.injectField("Battle")],e.prototype,"Battle",void 0),i([c.injectField("SystemRole")],e.prototype,"SystemRole",void 0),i([c.injectField("SystemViewEffect")],e.prototype,"SystemViewEffect",void 0),i([c.injectField("ModelBattleSkill")],e.prototype,"ModelBattleSkill",void 0),i([c.injectField("ModelPrefab")],e.prototype,"ModelPrefab",void 0),e}(h.BaseOthersSkill);r.OtherSkillCharge=d,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../../view/effect/SubSysEffectWarning":"SubSysEffectWarning","../../../view/nodeproxy/NodeProxy":"NodeProxy","../BaseSkill":"BaseSkill","./BaseOthersSkill":"BaseOthersSkill"}],OtherSkillCircle:[function(t,e,r){"use strict";cc._RF.push(e,"13329gdlQRN0qbJX0rM8DRS","OtherSkillCircle");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.OtherSkillCircle=void 0;var a,l=t("../../../view/nodeproxy/NodeProxy"),s=t("../../role/RoleBuilder"),c=t("../../type/ComType"),u=t("../BaseSkill"),p=t("./BaseOthersSkill");(function(t){t[t.Idle=0]="Idle",t[t.Ready=1]="Ready",t[t.Conjure=2]="Conjure",t[t.Run=3]="Run"})(a||(a={}));var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state=[],e.time=[],e.count=[],e.initAngle=[],e}return n(e,t),e.prototype.OnChangeParams=function(t){this.SwitchIdle(t)},e.prototype.OnUpdateParam=function(t,e){this._param[t].clockwise=Math.sign(parseInt(e[0])||1),e[1]&&(this.initAngle[t]=Number(e[1]))},e.prototype.OnAddContext=function(){},e.prototype.OnRemoveContext=function(t){this.state[t]=null,this.time[t]=null,this.count[t]=null},e.prototype.OnUpdate=function(t){var e,r;try{for(var o=i(this.tlContextId),n=o.next();!n.done;n=o.next()){var l=n.value;switch(this.state[l]){case a.Idle:this.UpdateIdle(l,t);break;case a.Conjure:this.UpdateConjure(l,t);break;case a.Run:this.UpdateRunning(l,t)}}}catch(s){e={error:s}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}},e.prototype.SwitchIdle=function(t){this.state[t]=a.Idle,this.time[t]=0,this.count[t]=0},e.prototype.UpdateIdle=function(t,e){this.time[t]+=e,this.count[t]=0,this.time[t]>this.GetCD(t)&&this.SwitchReady(t)},e.prototype.SwitchReady=function(t){var e=this.tlContext[t];this.state[t]=a.Ready,e.isAuto&&this.SwitchConjure(t)},e.prototype.SwitchConjure=function(t){var e=this.tlContext[t].eid;if(this.GetHasAnimationClip(t,l.INodeProxyAni.Conjure)){var r=this.GetAnimationDruationConjure(t,l.INodeProxyAni.Conjure);this.state[t]=a.Conjure,this.time[t]=r,this.ComState.SwitchConjure(e)}else this.SwitchRunning(t)},e.prototype.UpdateConjure=function(t,e){var r=this.time;r[t]-=e,r[t]<0&&this.SwitchRunning(t)},e.prototype.SwitchRunning=function(t){this.state[t]=a.Run,this.time[t]=0,this.count[t]=0},e.prototype.UpdateRunning=function(t,e){var r=this.GetInterval(t),o=this.GetNum(t);for(this.time[t]+=e;!(this.time[t]<=r||this.count[t]>=o);)this.OnTrigger(t),this.count[t]++,this.time[t]-=r;this.count[t]>=o&&this.SwitchIdle(t)},e.prototype.OnTrigger=function(t){var e=this.tlContext[t].eid,r=this.Battle.getRef(e),o=this.ComPos.d,n=this.GetNum(t),i=this.count[t],a=this._param[t],l=this.GetBullet(t,0),u=a.clockwise,p=2*Math.PI,f=p/n,h=u*i*f+.5*f;h-=p/2,this.initAngle[t]?h+=this.initAngle[t]*Math.PI/180:h+=o[e];var y=new s.RBContext;y.sender=r,y.rad=h;var d=new(this.GetBulletBuilder(l));d.Setup(y),d.SetProperty("resId",l),d.SetProperty("bullet_tag",c.EComTag.MonsterBullet),this.SystemRole.ApplyBuilder(d),this.Battle.applyModify()},e.prototype.GetState=function(t){var e=t.cid;switch(this.state[e]){case a.Idle:return u.SkillState.Idle;case a.Ready:return u.SkillState.Ready;case a.Conjure:case a.Run:return u.SkillState.Running}},e.prototype.TryRun=function(t){var e=t.cid;return this.GetState(t)==u.SkillState.Ready&&(this.SwitchConjure(e),!0)},e.__cname="OtherSkillCircle",e}(p.BaseOthersSkill);r.OtherSkillCircle=f,cc._RF.pop()},{"../../../view/nodeproxy/NodeProxy":"NodeProxy","../../role/RoleBuilder":"RoleBuilder","../../type/ComType":"ComType","../BaseSkill":"BaseSkill","./BaseOthersSkill":"BaseOthersSkill"}],OtherSkillDeathWhisper:[function(t,e,r){"use strict";cc._RF.push(e,"8d895Coc7BCcLfxlDH7pFf6","OtherSkillDeathWhisper");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.OtherSkillDeathWhisper=void 0;var l=t("../../../../../../../framework/container/Container"),s=t("../../../../../../../framework/utils/Toolset"),c=t("../../event/SystemEvent"),u=t("../../role/RoleBuilder"),p=t("../../type/ComType"),f=t("../BaseSkill"),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isShot=[],e.tlKill=new Set,e}return n(e,t),e.prototype.OnUpdateParam=function(){},e.prototype.OnChangeParams=function(){},e.prototype.OnEnter=function(){var e=this;t.prototype.OnEnter.call(this),this.toolSet=s.ToolSet.createToolSet(),this.toolSet.addListener(this.SystemEvent.GetEventPorxy(),c.EBattleEvent.KillMonster,function(t){e.OnKillMonster(t)})},e.prototype.OnExit=function(){t.prototype.OnExit.call(this),s.ToolSet.destroyToolSet(this.toolSet)},e.prototype.OnAddContext=function(){},e.prototype.OnRemoveContext=function(t){var e=this.tlContext[t].eid;this.tlKill.delete(e),this.isShot[t]=null},e.prototype.OnUpdate=function(){this.ComVar.ALIVE;var t,e,r=this.isShot;try{for(var o=a(this.tlContextId),n=o.next();!n.done;n=o.next()){var i=n.value;if(!r[i]){var l=this.tlContext[i].eid;this.tlKill.has(l)&&(this.tlKill.delete(l),r[i]=!0,this.OnTrigger(i))}}}catch(s){t={error:s}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}this.tlKill.clear()},e.prototype.OnTrigger=function(t){var e=this.ComPos.x,r=this.ComPos.y,o=this.tlContext[t].eid,n=(this.ComVar.REACTION[o],this.ComVar.ALIVE,this.ComVar.CAMP,this.ComVar.SHOOT_TARGET[o]),i=this.Battle.getRef(o),a=Math.atan2(r[n]-r[o],e[n]-e[o]),l=new u.RBContext;l.rad=a,l.sender=i;var s=this.GetBullet(t,0),c=new(this.GetBulletBuilder(s));c.Setup(l),c.SetProperty("resId",s),c.SetProperty("bullet_tag",p.EComTag.MonsterBullet),this.SystemRole.ApplyBuilder(c),this.Battle.applyModify()},e.prototype.GetState=function(){return f.SkillState.Ready},e.prototype.OnKillMonster=function(t){this.tlKill.add(t)},e.__cname="OtherSkillDeathWhisper",i([l.injectField("ComVar")],e.prototype,"ComVar",void 0),i([l.injectField("SystemEvent")],e.prototype,"SystemEvent",void 0),e}(t("./BaseOthersSkill").BaseOthersSkill);r.OtherSkillDeathWhisper=h,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../../../../../../framework/utils/Toolset":void 0,"../../event/SystemEvent":"SystemEvent","../../role/RoleBuilder":"RoleBuilder","../../type/ComType":"ComType","../BaseSkill":"BaseSkill","./BaseOthersSkill":"BaseOthersSkill"}],OtherSkillGuarder:[function(t,e,r){"use strict";cc._RF.push(e,"a771eQ6wntLo45pLEMl7BIY","OtherSkillGuarder");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.OtherSkillGuarder=void 0;var a,l=t("../../../view/nodeproxy/NodeProxy"),s=t("../../role/RoleBuilder"),c=t("../../type/ComType"),u=t("../BaseSkill"),p=t("./BaseOthersSkill");(function(t){t[t.Idle=0]="Idle",t[t.Ready=1]="Ready",t[t.Conjure=2]="Conjure",t[t.Run=3]="Run"})(a||(a={}));var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state=[],e.time=[],e.count=[],e}return n(e,t),e.prototype.OnChangeParams=function(t){this.SwitchIdle(t)},e.prototype.OnUpdateParam=function(t,e){this._param[t].radius=parseInt(e[0])||0},e.prototype.OnAddContext=function(){},e.prototype.OnRemoveContext=function(t){this.state[t]=null,this.time[t]=null,this.count[t]=null},e.prototype.OnUpdate=function(t){var e,r;try{for(var o=i(this.tlContextId),n=o.next();!n.done;n=o.next()){var l=n.value;switch(this.state[l]){case a.Idle:this.UpdateIdle(l,t);break;case a.Conjure:this.UpdateConjure(l,t);break;case a.Run:this.UpdateRunning(l,t)}}}catch(s){e={error:s}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}},e.prototype.SwitchIdle=function(t){this.state[t]=a.Idle,this.time[t]=0,this.count[t]=0},e.prototype.UpdateIdle=function(t,e){this.time[t]+=e,this.time[t]>this.GetCD(t)&&this.SwitchReady(t)},e.prototype.SwitchReady=function(t){this.state[t]=a.Ready,this.tlContext[t].isAuto&&this.SwitchConjure(t)},e.prototype.SwitchConjure=function(t){if(this.GetHasAnimationClip(t,l.INodeProxyAni.Conjure)){var e=this.tlContext[t].eid,r=this.GetAnimationDruationConjure(t,l.INodeProxyAni.Conjure);this.state[t]=a.Conjure,this.time[t]=r,this.ComState.SwitchConjure(e)}else this.SwitchRunning(t)},e.prototype.UpdateConjure=function(t,e){var r=this.time;r[t]-=e,r[t]<0&&this.SwitchRunning(t)},e.prototype.SwitchRunning=function(t){this.state[t]=a.Run,this.time[t]=0,this.count[t]=0},e.prototype.UpdateRunning=function(t,e){var r=this.GetInterval(t),o=this.GetNum(t);for(this.time[t]+=e;!(this.time[t]<=r||this.count[t]>=o);)this.OnTrigger(t),this.count[t]++,this.time[t]-=r;this.count[t]>=o&&this.SwitchIdle(t)},e.prototype.OnTrigger=function(t){var e=this.tlContext[t].eid,r=this.Battle.getRef(e),o=(this.ComPos.d,this.GetNum(t)),n=this.count[t],i=this._param[t],a=this.GetBullet(t,0),l=i.radius,u=2*Math.PI/o,p=n*u+.5*u,f=new s.RBContext;f.sender=r,f.rad=p,f.radius=l;var h=new(this.GetBulletBuilder(a));h.Setup(f),h.SetProperty("resId",a),h.SetProperty("bullet_tag",c.EComTag.MonsterBullet),this.SystemRole.ApplyBuilder(h),this.Battle.applyModify()},e.prototype.GetState=function(t){var e=t.cid;switch(this.state[e]){case a.Idle:return u.SkillState.Idle;case a.Ready:return u.SkillState.Ready;case a.Conjure:case a.Run:return u.SkillState.Running}},e.prototype.TryRun=function(t){var e=t.cid;return this.GetState(t)==u.SkillState.Ready&&(this.SwitchConjure(e),!0)},e.__cname="OtherSkillGuarder",e}(p.BaseOthersSkill);r.OtherSkillGuarder=f,cc._RF.pop()},{"../../../view/nodeproxy/NodeProxy":"NodeProxy","../../role/RoleBuilder":"RoleBuilder","../../type/ComType":"ComType","../BaseSkill":"BaseSkill","./BaseOthersSkill":"BaseOthersSkill"}],OtherSkillSelfBoom:[function(t,e,r){"use strict";cc._RF.push(e,"4ced1KzbNZGNZaFgVkcku1s","OtherSkillSelfBoom");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.OtherSkillSelfBoom=void 0;var l,s=t("../../../../../../../framework/container/Container"),c=t("../../../view/effect/SubSysEffectWarning"),u=t("../../../view/nodeproxy/NodeProxy"),p=t("../../role/RoleBuilder"),f=t("../../type/ComType"),h=t("../BaseSkill"),y=t("./BaseOthersSkill");(function(t){t[t.Ready=0]="Ready",t[t.Idle=1]="Idle",t[t.Conjure=2]="Conjure",t[t.Run=3]="Run",t[t.Die=4]="Die"})(l||(l={}));var d={type:c.EEffectWarnningType.Circular,x:0,y:0,target:null,min:50,max:0,duration:0},m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state=[],e.count=[],e.time=[],e.time_ani=[],e._tempOnTrigger=[],e.tmMonsterBullet=new Map,e}return n(e,t),e.prototype.OnUpdateParam=function(t,e){var r=this._param[t];r.distance=parseInt(e[0])||50,r.conjure=(parseInt(e[1])||1e3)/1e3,r.effecttime=(parseInt(e[2])||1e3)/1e3},e.prototype.OnChangeParams=function(t){this.SwitchReady(t)},e.prototype.OnAddContext=function(){},e.prototype.OnRemoveContext=function(t){this.state[t]=null,this.time[t]=null},e.prototype.OnUpdate=function(t){var e,r;try{for(var o=a(this.tlContextId),n=o.next();!n.done;n=o.next()){var i=n.value;switch(this.state[i]){case l.Idle:this.UpdateIdle(i,t);break;case l.Conjure:this.UpdateConjure(i,t);break;case l.Run:this.UpdateRunning(i,t)}}}catch(s){e={error:s}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}},e.prototype.SwitchReady=function(t){this.state[t]=l.Ready,this.tlContext[t],this.SwitchIdle(t)},e.prototype.SwitchIdle=function(t){this.state[t]=l.Idle,this.time[t]=0},e.prototype.UpdateIdle=function(t,e){var r=this.ComVar.SHOOT_TARGET,o=this.ComVar.ALIVE,n=this.ComPos.x,i=this.ComPos.y,a=(this.ComCollision.r,this.tlContext[t].eid),l=this._param[t].distance,s=this.time,c=r[a];if(null!=c&&0!=o[a]){var u=l*l,p=n[c]-n[a],f=i[c]-i[a];p*p+f*f<=u?this.SwitchConjure(t):(s[t]+=e,s[t]>5e3&&this.SwitchConjure(t))}else this.SwitchConjure(t)},e.prototype.SwitchConjure=function(t){var e=this.ComPos.x,r=this.ComPos.y,o=this._param[t],n=this.time_ani,i=o.conjure,a=this.tlContext[t].eid;if(n[t]=0,this.GetHasAnimationClip(t,u.INodeProxyAni.Conjure)){var s=this.GetAnimationDruationConjure(t,u.INodeProxyAni.Conjure);n[t]=s,this.state[t]=l.Conjure,this.time[t]=i,this.ComState.SwitchConjure(a,!1)}else{var c=this.Battle.getRef(a);this.ComState.SwitchIdle(c),this.state[t]=l.Conjure,this.time[t]=i}var p=2*this.findMonsterBullet(t,0,0),f=o.effecttime,h=d;h.x=e[a],h.y=r[a],h.min=.6*p,h.max=p,h.duration=f,this.SystemViewEffect.AddEffectWarning(h)},e.prototype.UpdateConjure=function(t,e){var r=this.time;r[t]-=e,r[t]<0&&this.SwitchRunning(t)},e.prototype.SwitchRunning=function(t){this.state[t]=l.Run,this.time[t]=0,this.count[t]=0},e.prototype.UpdateRunning=function(t,e){var r=this.GetInterval(t),o=this.GetNum(t);for(this.time[t]+=e;!(this.time[t]<=r||this.count[t]>=o);)this.OnTrigger(t),this.count[t]++,this.time[t]-=r;this.count[t]>=o&&this.SwitchDie(t)},e.prototype.SwitchDie=function(t){var e=this.tlContext[t].eid;this.ComState.SwitchDestroy(e)},e.prototype.OnTrigger=function(t){var e=this.tlContext[t].eid,r=this.ComPos.x,o=this.ComPos.y,n=(this.ComVar.REACTION[e],this.ComVar.ALIVE,this.ComVar.CAMP,this.ComVar.SHOOT_TARGET[e]),i=this.Battle.getRef(e),a=Math.atan2(o[n]-o[e],r[n]-r[e]),l=new p.RBContext;l.rad=a,l.sender=i;var s=this.GetBullet(t,0),c=new(this.GetBulletBuilder(s));c.Setup(l),c.SetProperty("resId",s),c.SetProperty("bullet_tag",f.EComTag.MonsterBullet),this.SystemRole.ApplyBuilder(c),this.Battle.applyModify()},e.prototype.findMonsterBullet=function(t,e,r){var o=this.tlContext[t].eid,n=this.tmMonsterBullet,i=n.get(o);if(null==i)for(;;){var a=this.ComVar.MONSTER_REF[o];if(null==a)break;var l=this.ModelBattleSkill,s=(this.ModelPrefab,this.ComVar,a.GetSkillAt(e)),c=l.GetSkillMonster(s);if(null==c)break;var u=c.GetBulletNum(),p={};i=p;for(var f=0;f<u;f++){var h=c.GetBullet(r),y=l.GetBullet(h);if(null!=y){var d=y.GetDamageRadius(0)*(1+y.GetDamageRange());p[f]=d}}n.set(t,p);break}var m=50;return i&&null!=i[r]&&(m=i[r]),m},e.prototype.GetState=function(t){var e=t.cid;switch(this.state[e]){case l.Idle:return h.SkillState.Idle;case l.Ready:return h.SkillState.Ready;case l.Conjure:case l.Run:case l.Die:return h.SkillState.Running}},e.__cname="OtherSkillSelfBoom",i([s.injectField("ComVar")],e.prototype,"ComVar",void 0),i([s.injectField("ComPos")],e.prototype,"ComPos",void 0),i([s.injectField("ComCollision")],e.prototype,"ComCollision",void 0),i([s.injectField("SystemMove")],e.prototype,"SystemMove",void 0),i([s.injectField("Battle")],e.prototype,"Battle",void 0),i([s.injectField("SystemRole")],e.prototype,"SystemRole",void 0),i([s.injectField("SystemViewEffect")],e.prototype,"SystemViewEffect",void 0),i([s.injectField("ModelBattleSkill")],e.prototype,"ModelBattleSkill",void 0),i([s.injectField("ModelPrefab")],e.prototype,"ModelPrefab",void 0),e}(y.BaseOthersSkill);r.OtherSkillSelfBoom=m,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../../view/effect/SubSysEffectWarning":"SubSysEffectWarning","../../../view/nodeproxy/NodeProxy":"NodeProxy","../../role/RoleBuilder":"RoleBuilder","../../type/ComType":"ComType","../BaseSkill":"BaseSkill","./BaseOthersSkill":"BaseOthersSkill"}],OtherSkillShotgun:[function(t,e,r){"use strict";cc._RF.push(e,"a29f3DMAuNBjaDmX42IY2oK","OtherSkillShotgun");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.OtherSkillShotgun=void 0;var a,l=t("../../../view/nodeproxy/NodeProxy"),s=t("../../role/RoleBuilder"),c=t("../../type/ComType"),u=t("../BaseSkill"),p=t("./BaseOthersSkill");(function(t){t[t.Idle=0]="Idle",t[t.Ready=1]="Ready",t[t.Conjure=2]="Conjure",t[t.Run=3]="Run"})(a||(a={}));var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state=[],e.time=[],e.count=[],e}return n(e,t),e.prototype.OnUpdateParam=function(t,e){this._param[t].shootDegree=parseInt(e[0])||0},e.prototype.OnChangeParams=function(t){this.SwitchIdle(t)},e.prototype.OnAddContext=function(){},e.prototype.OnRemoveContext=function(t){this.state[t]=null,this.time[t]=null,this.count[t]=null},e.prototype.OnUpdate=function(t){var e,r;try{for(var o=i(this.tlContextId),n=o.next();!n.done;n=o.next()){var l=n.value;switch(this.state[l]){case a.Idle:this.UpdateIdle(l,t);break;case a.Conjure:this.UpdateConjure(l,t);break;case a.Run:this.UpdateRunning(l,t)}}}catch(s){e={error:s}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}},e.prototype.SwitchIdle=function(t){this.state[t]=a.Idle,this.time[t]=0,this.count[t]=0},e.prototype.UpdateIdle=function(t,e){this.time[t]+=e,this.time[t]>this.GetCD(t)&&this.SwitchReady(t)},e.prototype.SwitchReady=function(t){this.state[t]=a.Ready,this.tlContext[t].isAuto&&this.SwitchConjure(t)},e.prototype.SwitchConjure=function(t){var e=this.tlContext[t].eid;if(this.GetHasAnimationClip(t,l.INodeProxyAni.Conjure)){var r=this.GetAnimationDruationConjure(t,l.INodeProxyAni.Conjure);this.state[t]=a.Conjure,this.time[t]=r,this.ComState.SwitchConjure(e)}else this.SwitchRunning(t)},e.prototype.UpdateConjure=function(t,e){var r=this.time;r[t]-=e,r[t]<0&&this.SwitchRunning(t)},e.prototype.SwitchRunning=function(t){this.state[t]=a.Run,this.time[t]=0,this.count[t]=0},e.prototype.UpdateRunning=function(t,e){var r=this.GetInterval(t),o=this.GetNum(t);for(this.time[t]+=e;!(this.time[t]<=r||this.count[t]>=o);)this.OnTrigger(t),this.count[t]++,this.time[t]-=r;this.count[t]>=o&&this.SwitchIdle(t)},e.prototype.OnTrigger=function(t){var e=this.tlContext[t].eid,r=this.Battle.getRef(e),o=this.ComPos.d,n=this.GetNum(t),i=this.count[t],a=this._param[t],l=this.GetBullet(t,0),u=a.shootDegree/180*Math.PI,p=u/n,f=i*p+.5*p;f-=u/2,f+=o[e];var h=new s.RBContext;h.sender=r,h.rad=f;var y=new(this.GetBulletBuilder(l));y.Setup(h),y.SetProperty("resId",l),y.SetProperty("bullet_tag",c.EComTag.MonsterBullet),this.SystemRole.ApplyBuilder(y),this.Battle.applyModify()},e.prototype.GetState=function(t){var e=t.cid;switch(this.state[e]){case a.Idle:return u.SkillState.Idle;case a.Ready:return u.SkillState.Ready;case a.Conjure:case a.Run:return u.SkillState.Running}},e.prototype.TryRun=function(t){var e=t.cid;return this.GetState(t)==u.SkillState.Ready&&(this.SwitchConjure(e),!0)},e.__cname="OtherSkillShotgun",e}(p.BaseOthersSkill);r.OtherSkillShotgun=f,cc._RF.pop()},{"../../../view/nodeproxy/NodeProxy":"NodeProxy","../../role/RoleBuilder":"RoleBuilder","../../type/ComType":"ComType","../BaseSkill":"BaseSkill","./BaseOthersSkill":"BaseOthersSkill"}],OthersSkillDart:[function(t,e,r){"use strict";cc._RF.push(e,"a8914P6qzRDe6EgHrVlYuxX","OthersSkillDart");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.OthersSkillDart=void 0;var l,s=t("../../../../../../../framework/container/Container"),c=t("../../../view/nodeproxy/NodeProxy"),u=t("../../role/RoleBuilder"),p=t("../../type/ComType"),f=t("../BaseSkill"),h=t("./BaseOthersSkill");(function(t){t[t.Idle=0]="Idle",t[t.Ready=1]="Ready",t[t.Conjure=2]="Conjure",t[t.Run=3]="Run"})(l||(l={}));var y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state=[],e.time=[],e.count=[],e._tempOnTrigger=[],e}return n(e,t),e.prototype.OnUpdateParam=function(){},e.prototype.OnChangeParams=function(t){this.SwitchIdle(t)},e.prototype.OnAddContext=function(){},e.prototype.OnRemoveContext=function(t){this.time[t]=null},e.prototype.OnUpdate=function(t){var e,r;try{for(var o=a(this.tlContextId),n=o.next();!n.done;n=o.next()){var i=n.value;switch(this.state[i]){case l.Idle:this.UpdateIdle(i,t);break;case l.Conjure:this.UpdateConjure(i,t);break;case l.Run:this.UpdateRunning(i,t)}}}catch(s){e={error:s}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}},e.prototype.SwitchIdle=function(t){this.state[t]=l.Idle,this.time[t]=0},e.prototype.UpdateIdle=function(t,e){this.time[t]+=e,this.time[t]>this.GetCD(t)&&this.SwitchReady(t)},e.prototype.SwitchReady=function(t){this.state[t]=l.Ready,this.tlContext[t].isAuto&&this.SwitchConjure(t)},e.prototype.SwitchConjure=function(t){var e=this.tlContext[t].eid;if(this.GetHasAnimationClip(t,c.INodeProxyAni.Conjure)){var r=this.GetAnimationDruationConjure(t,c.INodeProxyAni.Conjure);this.state[t]=l.Conjure,this.time[t]=r,this.ComState.SwitchConjure(e)}else this.SwitchRunning(t)},e.prototype.UpdateConjure=function(t,e){var r=this.time;r[t]-=e,r[t]<0&&this.SwitchRunning(t)},e.prototype.SwitchRunning=function(t){this.state[t]=l.Run,this.time[t]=0,this.count[t]=0},e.prototype.UpdateRunning=function(t,e){var r=this.GetInterval(t),o=this.GetNum(t);for(this.time[t]+=e;!(this.time[t]<=r||this.count[t]>=o);)this.OnTrigger(t),this.count[t]++,this.time[t]-=r;this.count[t]>=o&&this.SwitchIdle(t)},e.prototype.OnTrigger=function(t){var e=this.tlContext[t].eid,r=this.ComPos.x,o=this.ComPos.y,n=(this.ComVar.REACTION[e],this.ComVar.ALIVE,this.ComVar.CAMP,this.ComVar.SHOOT_TARGET[e]),i=this.Battle.getRef(e),a=Math.atan2(o[n]-o[e],r[n]-r[e]),l=new u.RBContext;l.rad=a,l.sender=i;var s=this.GetBullet(t,0),c=new(this.GetBulletBuilder(s));c.Setup(l),c.SetProperty("resId",s),c.SetProperty("bullet_tag",p.EComTag.MonsterBullet),this.SystemRole.ApplyBuilder(c),this.Battle.applyModify()},e.prototype.GetState=function(t){var e=t.cid;switch(this.state[e]){case l.Idle:return f.SkillState.Idle;case l.Ready:return f.SkillState.Ready;case l.Conjure:case l.Run:return f.SkillState.Running}},e.prototype.TryRun=function(t){var e=t.cid;return this.GetState(t)==f.SkillState.Ready&&(this.SwitchConjure(e),!0)},e.__cname="OthersSkillDart",i([s.injectField("ComVar")],e.prototype,"ComVar",void 0),i([s.injectField("ComPos")],e.prototype,"ComPos",void 0),i([s.injectField("SystemMove")],e.prototype,"SystemMove",void 0),i([s.injectField("Battle")],e.prototype,"Battle",void 0),i([s.injectField("SystemRole")],e.prototype,"SystemRole",void 0),i([s.injectField("ModelBattleSkill")],e.prototype,"ModelBattleSkill",void 0),e}(h.BaseOthersSkill);r.OthersSkillDart=y,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../../view/nodeproxy/NodeProxy":"NodeProxy","../../role/RoleBuilder":"RoleBuilder","../../type/ComType":"ComType","../BaseSkill":"BaseSkill","./BaseOthersSkill":"BaseOthersSkill"}],PanelPopBreach:[function(t,e,r){"use strict";cc._RF.push(e,"b436fX0+qpC0YmHs4ybiGKa","PanelPopBreach");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.PanelPopBreachUI=r.PanelPopBreach=void 0;var a=t("../../../../../framework/fgui/FairyMgr"),l=t("../../../../../framework/layer/common/UIOrder"),s=t("../../../ui/GamePanel"),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.Title="",e.Content="",e.Tip="",e.Type="\u4e0d\u5c55\u793a",e.Btn=null,e.BtnState=!0,e.showArrow=!0,e}return n(e,t),e.prototype.getUIClass=function(){return u},e.prototype.getUrl=function(){return"ui://\u82f1\u96c4_\u7a81\u7834/\u7ec4\u4ef6_\u63d0\u793a\u6c14\u6ce1"},e.prototype.getSortOrder=function(){return l.LayerOrder.ThreeLevel},e.prototype.SetTitle=function(t){this.Title=t},e.prototype.GetTitle=function(){return this.Title},e.prototype.SetContent=function(t){this.Content=t},e.prototype.GetContent=function(){return this.Content},e.prototype.SetTip=function(t){this.Tip=t},e.prototype.GetTip=function(){return this.Tip},e.prototype.SetType=function(t){this.Type=t},e.prototype.GetType=function(){return this.Type},e.prototype.SetBtn=function(t){this.Btn=t},e.prototype.GetBtn=function(){return this.Btn},e.prototype.SetBtnState=function(t){this.BtnState=t},e.prototype.GetBtnState=function(){return this.BtnState},e.prototype.SetShowArrow=function(t){this.showArrow=t},e.prototype.GetShowArrow=function(){return this.showArrow},e.prototype.SetParent=function(t){this.Parent=t},e.prototype.GetParent=function(){return this.Parent},e.__cname="PanelPopBreach",e}(s.GamePanelProxy);r.PanelPopBreach=c;var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getHasBackground=function(){return!1},e.prototype.init=function(){this.com.toCenterParent(this.container)},e.prototype.enter=function(){this.updateLayer()},e.prototype.updateLayer=function(){"\u5c55\u793a"==this.proxy.GetType()&&this.updateBtn(),this.updateContent(),this.updatePos()},e.prototype.updateBtn=function(){var t=this,e=t.com,r=t.proxy,o=r.GetBtn(),n=r.GetBtnState();e.tm("\u6309\u94ae_\u89e3\u9501.icon").SetUrlByIcon(o.icon),e.tm("\u6309\u94ae_\u89e3\u9501.title").text=o.title,e.setSelectedPage("\u6309\u94ae\u72b6\u6001",o.type),e.tm("\u6309\u94ae_\u89e3\u9501").setClick(function(){o.click(),t.unload()},t),e.tm("\u6309\u94ae_\u89e3\u9501").enabled=n},e.prototype.updateContent=function(){var t=this.com,e=this.proxy;t.tm("\u6587\u672c_\u6807\u9898").text=e.GetTitle(),t.tm("\u6587\u672c_\u5185\u5bb9").text=e.GetContent(),t.tm("\u6587\u672c_\u63d0\u793a").text=e.GetTip(),t.setSelectedPage("\u5c55\u793a\u6309\u94ae",e.GetType())},e.prototype.updatePos=function(){var t=this.com,e=t.tm("com_float"),r=this.proxy.GetParent(),o=e.getArrowPos(),n=a.PopInfoDirect.bottommid,l=i(a.FairyMgr.instance.GetPoupPosition(e,r,n,o),2),s=l[0],c=l[1];s=this.com.parent.globalToLocal(s.x,s.y),t.setPosition(s.x,s.y),this.proxy.GetShowArrow()?e.setArrowVisible(c):e.setArrowVisible(null)},e.__cname="PanelPopBreachUI",e}(s.GamePanelUI);r.PanelPopBreachUI=u,cc._RF.pop()},{"../../../../../framework/fgui/FairyMgr":void 0,"../../../../../framework/layer/common/UIOrder":void 0,"../../../ui/GamePanel":"GamePanel"}],PanelPopInfo:[function(t,e,r){"use strict";cc._RF.push(e,"70e7bIxtnFLW6agL65WiPqT","PanelPopInfo");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.PanelPopInfoUI=r.PanelPopInfo=void 0;var a=t("../../../../framework/fgui/FairyMgr"),l=t("../../ui/GamePanel"),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.Title="",e.content="",e.showArrow=!0,e}return n(e,t),e.prototype.getUIClass=function(){return c},e.prototype.getUrl=function(){return"ui://\u5171\u7528\u7ec4\u4ef6/\u7ec4\u4ef6_\u5171\u7528_\u63d0\u793a\u6c14\u6ce1"},e.prototype.SetTitle=function(t){this.Title=t},e.prototype.GetTitle=function(){return this.Title},e.prototype.SetTitleVisible=function(t){this.titleVisible=t},e.prototype.GetTitleVisible=function(){return this.titleVisible},e.prototype.SetContent=function(t){this.content=t},e.prototype.GetContent=function(){return this.content},e.prototype.SetParent=function(t){this.Parent=t},e.prototype.GetParent=function(){return this.Parent},e.prototype.SetShowArrow=function(t){this.showArrow=t},e.prototype.GetShowArrow=function(){return this.showArrow},e.__cname="PanelPopInfo",e}(l.GamePanelProxy);r.PanelPopInfo=s;var c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getHasBackground=function(){return!1},e.prototype.init=function(){this.com.toCenterParent(this.container),this.proxy.GetContent()||this.proxy.unload()},e.prototype.release=function(){},e.prototype.enter=function(){this.updateView()},e.prototype.updateView=function(){this.updateContent(),this.updatePos()},e.prototype.updateContent=function(){this.com.tm("text_title").text=this.proxy.GetTitle(),this.com.tm("text_title").visible=this.proxy.GetTitleVisible(),this.com.tm("text_content").text=this.proxy.GetContent()},e.prototype.updatePos=function(){var t=this.com,e=t.tm("com_float"),r=this.proxy.GetParent(),o=e.getArrowPos(),n=i(a.FairyMgr.instance.GetPoupPosition(e,r,null,o),2),l=n[0],s=n[1];l=this.com.parent.globalToLocal(l.x,l.y),t.setPosition(l.x,l.y),this.proxy.GetShowArrow()?e.setArrowVisible(s):e.setArrowVisible(null)},e.__cname="PanelPopInfoUI",e}(l.GamePanelUI);r.PanelPopInfoUI=c,cc._RF.pop()},{"../../../../framework/fgui/FairyMgr":void 0,"../../ui/GamePanel":"GamePanel"}],PanelPopUse:[function(t,e,r){"use strict";cc._RF.push(e,"d2ae3gc1nJForfM0kutp902","PanelPopUse");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.PanelPopUseUI=r.PanelPopUse=void 0;var l=t("../../../../framework/container/Container"),s=t("../../../../framework/fgui/FairyMgr"),c=t("../../../../framework/layer/common/UIOrder"),u=t("../../ui/GamePanel"),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._type=0,e}return n(e,t),e.prototype.getUIClass=function(){return f},e.prototype.getUrl=function(){return"ui://\u5171\u7528\u7ec4\u4ef6/\u7ec4\u4ef6_\u5171\u7528_\u4f7f\u7528\u6c14\u6ce1"},e.prototype.getSortOrder=function(){return c.LayerOrder.TipsUI},e.prototype.SetParent=function(t){this._Parent=t},e.prototype.GetParent=function(){return this._Parent},e.prototype.SetGood=function(t){this._good=t},e.prototype.GetGood=function(){return this._good},e.prototype.Settype=function(t){this._type=t},e.prototype.Gettype=function(){return this._type},e.__cname="PanelPopUse",e}(u.GamePanelProxy);r.PanelPopUse=p;var f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getHasBackground=function(){return!1},e.prototype.init=function(){this.com.toCenterParent(this.container)},e.prototype.enter=function(){this.updateView()},e.prototype.updateView=function(){this.InitClick(),this.updatePos()},e.prototype.InitClick=function(){var t=this,e=t.com;e.tm("\u6309\u94ae_\u4f7f\u7528").setClick(function(){var e=t.proxy.GetGood();t.ModelMgr.ModelBox.RequestBox(e.GetRefId(),e.GetNumber()),t.unload()},t),e.tm("\u6309\u94ae_\u53d6\u6d88").setClick(function(){t.unload()},t)},e.prototype.updatePos=function(){var t=this.com,e=this.proxy,r=t.tm("com_float"),o=e.GetParent(),n=r.getArrowPos(),i=s.PopInfoDirect.leftmid,l=a(s.FairyMgr.instance.GetPoupPosition(r,o,i,n),2),c=l[0],u=l[1];c=t.parent.globalToLocal(c.x,c.y),t.setPosition(c.x,c.y),r.setArrowVisible(u)},e.__cname="PanelPopUseUI",i([l.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(u.GamePanelUI);r.PanelPopUseUI=f,cc._RF.pop()},{"../../../../framework/container/Container":void 0,"../../../../framework/fgui/FairyMgr":void 0,"../../../../framework/layer/common/UIOrder":void 0,"../../ui/GamePanel":"GamePanel"}],PanelUseDiamondTips:[function(t,e){"use strict";cc._RF.push(e,"72120Z1QKZLq6eYqAG+OO6F","PanelUseDiamondTips"),cc._RF.pop()},{}],PayObj:[function(t,e,r){"use strict";cc._RF.push(e,"198b5USLrBG3YX8UGBj53LG","PayObj");var o=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.PayObj=r.TipsType=void 0;var n,i=t("../../../../framework/container/Container");(function(t){t[t.buyTips=0]="buyTips",t[t.tips=1]="tips",t[t.inexactEnunciation=2]="inexactEnunciation"})(n=r.TipsType||(r.TipsType={}));var a=function(){function t(t){this.RedefinitionType(),this.SetpayInfo(t)}return t.prototype.SetpayInfo=function(t){this._payInfo=t},t.prototype.GetpayInfo=function(){return this._payInfo},t.prototype.ShowTips=function(){if(null!=this.tipsInfo)switch(this.tipsInfo.type){case n.buyTips:this.LayerTipBuy.SetData({resId:this.tipsInfo.resId,currency:this.tipsInfo.currency}),this.LayerTipBuy.load();break;case n.tips:this.LayerShowTip.SetData({context:this.tipsInfo.context}),this.LayerShowTip.load();break;case n.inexactEnunciation:this.CtrlMgr.CtrlAlert.LayerMessage.addMessage(this.tipsInfo.context)}},t.__cname="PayObj",o([i.injectField("LayerTipBuy")],t.prototype,"LayerTipBuy",void 0),o([i.injectField("LayerShowTip")],t.prototype,"LayerShowTip",void 0),o([i.injectField("CtrlMgr")],t.prototype,"CtrlMgr",void 0),o([i.injectField("ModelMgr")],t.prototype,"ModelMgr",void 0),o([i.injectField("SDKMgr")],t.prototype,"SDKMgr",void 0),o([i.injectField("CtrlPay")],t.prototype,"CtrlPay",void 0),t}();r.PayObj=a,cc._RF.pop()},{"../../../../framework/container/Container":void 0}],PorcessTimeline:[function(t,e,r){"use strict";cc._RF.push(e,"ea7c9VqYkpKCok/LxRFwt3s","PorcessTimeline");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.PorcessTimeline=void 0;var a=function(t){function e(){var e=t.call(this)||this;return e.isStart=!1,e.orbital=[],e.event=[],e.clear(),e}return n(e,t),e.prototype.start=function(){this.isStart=!0,this.frame=0},e.prototype.stop=function(){this.isStart=!1},e.prototype.resme=function(){this.isStart=!0},e.prototype.clear=function(){this.orbital.length=0,this.event.length=0,this.frame=0,this.total=0,this.isStart=!1,this.__lastframe=0},e.prototype.update=function(){this.isStart&&(this.processEvent(),this.processFrame(),this.frame>this.__lastframe?this.stop():this.frame++)},e.prototype.addKeyframe=function(t,e,r){var o={frame:t,duration:e,process:r};this.orbital.push(o);var n=t+e;n>this.__lastframe&&(this.__lastframe=n)},e.prototype.processFrame=function(){var t,e,r=this.frame;try{for(var o=i(this.orbital),n=o.next();!n.done;n=o.next()){var a=n.value;if(a.frame<=r&&r<=a.frame+a.duration){var l=r-a.frame;a.process(l,a.duration)}}}catch(s){t={error:s}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}},e.prototype.addEvent=function(t,e,r){var o={frame:t,event:e,callback:r};this.event.push(o);var n=t;n>this.__lastframe&&(this.__lastframe=n)},e.prototype.processEvent=function(){var t,e,r=this.frame;try{for(var o=i(this.event),n=o.next();!n.done;n=o.next()){var a=n.value;a.frame==r&&a.callback()}}catch(l){t={error:l}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}},e.prototype.isStop=function(){return 0==this.isStart},e.__cname="PorcessTimeline",e}(t("../../../../framework/base/ScriptObject").ScriptObject);r.PorcessTimeline=a,cc._RF.pop()},{"../../../../framework/base/ScriptObject":void 0}],PrefabMgr:[function(t,e,r){"use strict";cc._RF.push(e,"98e656CPG9JPJ/jQFG4QT1I","PrefabMgr"),Object.defineProperty(r,"__esModule",{value:!0}),r.PrefabProxy=r.PrefabMgr=void 0;var o=function(){function t(){}return t.__cname="PrefabMgr",t}();r.PrefabMgr=o;r.PrefabProxy=function(){},cc._RF.pop()},{}],PropMgr:[function(t,e,r){"use strict";cc._RF.push(e,"73a9aePqklKLamho1t/ii3F","PropMgr");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.PropMgr=void 0;var l=t("../../../../../../framework/base/ScriptObject"),s=t("../../../../../../framework/container/Container"),c=t("../../../../../../framework/event/EventCallback"),u=t("./SystemCommon"),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ani_during=.6,e.ani_time=[],e.ani_sx=[],e.ani_sy=[],e.ids_loading=new Set,e.ids=new Set,e.picks=new Set,e.addOrUpdateCallback=new c.EventCallback,e.deleteCallback=new c.EventCallback,e}return n(e,t),Object.defineProperty(e.prototype,"posData",{get:function(){return this.SystemCommon.posData},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"idpool",{get:function(){return this.SystemCommon.idpool},enumerable:!1,configurable:!0}),e.prototype.createProp=function(t,e,r,o){var n=t.GetType();if(n!=u.EBProp.NONE&&(n!=u.EBProp.EXPBALL&&n!=u.EBProp.GOLD&&n!=u.EBProp.GOLD_CHEST&&n!=u.EBProp.SKILL_CHEST||0!=e&&null!=e)){var i=this.SystemCommon.GetSub(n);i.ref=t,this.assert(null!=i,"\u7c7b\u578b\u672a\u6ce8\u518c"+n);var a=this.idpool.Add(n);this.ids_loading.add(a),this.posData.setupXY(a,r,o),this.posData.model[a]=i.GetModel(a),this.posData.order[a]=i.GetOrder(),this.posData.loaded[a]=!1,i.Add(a),i.SetParam(a,e),this.addOrUpdateCallback.execute(a),this.__print()}},e.prototype.createItemProp=function(t,e,r,o){var n=u.EBProp.ITEM,i=this.SystemCommon.GetSub(n);i.ref=t,this.assert(null!=i,"\u7c7b\u578b\u672a\u6ce8\u518c"+n);var a=this.idpool.Add(n);this.ids_loading.add(a),this.posData.setupXY(a,r,o),this.posData.model[a]=i.GetModel(a),this.posData.order[a]=i.GetOrder(),this.posData.loaded[a]=!1,i.Add(a),i.SetParam(a,e),this.addOrUpdateCallback.execute(a),this.__print()},e.prototype.destroyProp=function(t){var e=this.idpool.GetItem(t);this.SystemCommon.GetSub(e).Delete(t),this.posData.model[t]=null,this.posData.order[t]=null,this.posData.loaded[t]=!1,this.posData.upsetXY(t),this.idpool.Remove(t),this.ids.delete(t),this.ani_time[t]=null,this.ani_sx[t]=null,this.ani_sy[t]=null,this.picks.delete(t),this.deleteCallback.execute(t),this.__print()},e.prototype.__print=function(){},e.prototype.pickProp=function(t){this.ids.delete(t)&&(this.ani_time[t]=0,this.ani_sx[t]=this.posData.x[t],this.ani_sy[t]=this.posData.y[t],this.picks.add(t),this.posData.upsetGrid(t))},e.prototype.takeProp=function(t){if(this.picks.delete(t)){this.GPAudio.prop();var e=this.idpool.GetItem(t);this.SystemCommon.GetSub(e).Pick(t)}},e.prototype.findNear=function(t,e,r,o){for(var n,i,l=this.SystemMap.gridSize,s=this.posData.x,c=this.posData.y,u=Math.floor(t/l),p=Math.floor(e/l),f=Math.ceil(r/l),h=this.posData.grids,y=r*r,d=this.posData.loaded,m=-f;m<f;m++)for(var v=-f;v<f;v++){var _=h[u+m];if(null!=_){var S=_[p+v];if(null!=S)try{for(var g=(n=void 0,a(S.ids)),b=g.next();!b.done;b=g.next()){var C=b.value;0!=d[C]&&(s[C]-t)*(s[C]-t)+(c[C]-e)*(c[C]-e)<=y&&o.push(C)}}catch(R){n={error:R}}finally{try{b&&!b.done&&(i=g.return)&&i.call(g)}finally{if(n)throw n.error}}}}},e.__cname="PropMgr",i([s.injectField("SystemCommon")],e.prototype,"SystemCommon",void 0),i([s.injectField("SystemMap")],e.prototype,"SystemMap",void 0),i([s.injectField("GPAudio")],e.prototype,"GPAudio",void 0),e}(l.ScriptObject);r.PropMgr=p,cc._RF.pop()},{"../../../../../../framework/base/ScriptObject":void 0,"../../../../../../framework/container/Container":void 0,"../../../../../../framework/event/EventCallback":void 0,"./SystemCommon":"SystemCommon"}],RBBat:[function(t,e,r){"use strict";cc._RF.push(e,"27094Su7aNDY5iAB0KL21+7","RBBat");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.RBBat=void 0;var a=t("../../../../../../framework/container/Container"),l=t("../../view/nodeproxy/NodeProxy"),s=t("../../view/prefab/ComPrefab"),c=t("../move/ComPos"),u=t("../move/ComVelocity"),p=t("../physical/ComCollision"),f=t("../state/ComState"),h=t("../type/ComType"),y=t("../var/ComVar"),d=t("./RoleBuilder"),m=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.Create=function(t){var r=new d.RBContext;r.sender=t;var o=new e;return o.Setup(r),o},e.prototype.OnGetTlComClazz=function(){return[h.ComType,u.ComVelocity,c.ComPos,f.ComState,y.ComVar,p.ComCollision,s.ComPrefab]},e.prototype.Apply=function(t){var e=this.Battle.ref2id(this.context.sender),r=this.GetCom(h.ComType),o=this.GetCom(c.ComPos),n=this.GetCom(u.ComVelocity),i=this.GetCom(f.ComState),a=this.GetCom(p.ComCollision),y=this.GetCom(s.ComPrefab);r.nextType[t]=h.EComType.Bullet,n.vx[t]=0,n.vy[t]=0,n.vgx[t]=0,n.vgy[t]=0,o.x[t]=o.x[e],o.y[t]=o.y[e],o.d[t]=o.d[e],y.order[t]=l.NodeProxyOrder.Effect,this.ApplyBullet(e,t,this.GetProperty("resId"));var d=a.r[t]/2;a.r[t]=d,i.SwitchBat(t,this.GetProperty("resId"),this.context.sender,d)},e.__cname="RBBat",i([a.injectField("Battle")],e.prototype,"Battle",void 0),e}(d.RoleBuilder);r.RBBat=m,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../view/nodeproxy/NodeProxy":"NodeProxy","../../view/prefab/ComPrefab":"ComPrefab","../move/ComPos":"ComPos","../move/ComVelocity":"ComVelocity","../physical/ComCollision":"ComCollision","../state/ComState":"ComState","../type/ComType":"ComType","../var/ComVar":"ComVar","./RoleBuilder":"RoleBuilder"}],RBBoomerangeSuperFire:[function(t,e,r){"use strict";cc._RF.push(e,"73ad1VdmzlMNp5LwNYObGDS","RBBoomerangeSuperFire");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.RBBoomerangeSuperFire=void 0;var a=t("../../../../../../framework/container/Container"),l=t("../../view/nodeproxy/NodeProxy"),s=t("../../view/prefab/ComPrefab"),c=t("../move/ComPos"),u=t("../move/ComVelocity"),p=t("../physical/ComCollision"),f=t("../state/ComState"),h=t("../type/ComType"),y=t("../var/ComVar"),d=t("./RoleBuilder"),m=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.Create=function(t,r){var o=new d.RBContext;o.sender=t,o.rad=r;var n=new e;return n.Setup(o),n},e.prototype.OnGetTlComClazz=function(){return[h.ComType,u.ComVelocity,c.ComPos,f.ComState,y.ComVar,p.ComCollision,s.ComPrefab]},e.prototype.Apply=function(t){var e=this.Battle.ref2id(this.context.sender),r=this.GetCom(h.ComType),o=this.GetCom(c.ComPos),n=(this.GetCom(u.ComVelocity),this.GetCom(y.ComVar),this.GetCom(p.ComCollision),this.GetCom(s.ComPrefab)),i=this.GetCom(f.ComState);r.nextType[t]=h.EComType.Bullet,n.ChangeModel(t,"\u767e\u604b_\u6280\u80fd_\u6843\u6728\u98de\u5251",l.INodeProxyAni.Idle);var a=this.context.rad;o.x[t]=o.x[e],o.y[t]=o.y[e],o.d[t]=a,o.dType[t]=c.EDirectionType.Normal,this.ApplyBullet(e,t,this.GetProperty("resId")),i.SwitchBoomerangeSuper(t,this.GetProperty("resId"))},e.__cname="RBBoomerangeSuperFire",i([a.injectField("Battle")],e.prototype,"Battle",void 0),e}(d.RoleBuilder);r.RBBoomerangeSuperFire=m,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../view/nodeproxy/NodeProxy":"NodeProxy","../../view/prefab/ComPrefab":"ComPrefab","../move/ComPos":"ComPos","../move/ComVelocity":"ComVelocity","../physical/ComCollision":"ComCollision","../state/ComState":"ComState","../type/ComType":"ComType","../var/ComVar":"ComVar","./RoleBuilder":"RoleBuilder"}],RBBoomerangeSuper:[function(t,e,r){"use strict";cc._RF.push(e,"c18bfHP8UVGnLWJyno6bm5k","RBBoomerangeSuper");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.RBBoomerangeSuper=void 0;var a=t("../../../../../../framework/container/Container"),l=t("../../view/prefab/ComPrefab"),s=t("../move/ComPos"),c=t("../move/ComVelocity"),u=t("../physical/ComCollision"),p=t("../state/ComState"),f=t("../type/ComType"),h=t("../var/ComVar"),y=t("./RoleBuilder"),d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.Create=function(t,r){var o=new y.RBContext;o.sender=t,o.rad=r;var n=new e;return n.Setup(o),n},e.prototype.OnGetTlComClazz=function(){return[f.ComType,c.ComVelocity,s.ComPos,p.ComState,h.ComVar,u.ComCollision,l.ComPrefab]},e.prototype.Apply=function(t){var e=this.Battle.ref2id(this.context.sender),r=this.GetCom(f.ComType),o=this.GetCom(s.ComPos),n=this.GetCom(c.ComVelocity),i=(this.GetCom(h.ComVar),this.GetCom(u.ComCollision),this.GetCom(l.ComPrefab),this.GetCom(p.ComState));r.nextType[t]=f.EComType.Bullet;var a=this.context.rad;n.vx[t]=Math.cos(a),n.vy[t]=Math.sin(a),n.vgx[t]=Math.cos(a),n.vgy[t]=Math.sin(a);var y=this.GetProperty("pos");o.x[t]=y[0],o.y[t]=y[1],o.d[t]=a,o.dType[t]=s.EDirectionType.Normal,this.ApplyBullet(e,t,this.GetProperty("resId")),i.SwitchBoomerangeSuper(t,this.GetProperty("resId"))},e.__cname="RBBoomerangeSuper",i([a.injectField("Battle")],e.prototype,"Battle",void 0),e}(y.RoleBuilder);r.RBBoomerangeSuper=d,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../view/prefab/ComPrefab":"ComPrefab","../move/ComPos":"ComPos","../move/ComVelocity":"ComVelocity","../physical/ComCollision":"ComCollision","../state/ComState":"ComState","../type/ComType":"ComType","../var/ComVar":"ComVar","./RoleBuilder":"RoleBuilder"}],RBBoomerange:[function(t,e,r){"use strict";cc._RF.push(e,"f815fPxCnVEE5pGqmsZIbUH","RBBoomerange");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.RBBoomerange=void 0;var a=t("../../../../../../framework/container/Container"),l=t("../../view/prefab/ComPrefab"),s=t("../move/ComPos"),c=t("../move/ComVelocity"),u=t("../physical/ComCollision"),p=t("../state/ComState"),f=t("../type/ComType"),h=t("../var/ComVar"),y=t("./RoleBuilder"),d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.Create=function(t,r){var o=new y.RBContext;o.sender=t,o.rad=r;var n=new e;return n.Setup(o),n},e.prototype.OnGetTlComClazz=function(){return[f.ComType,c.ComVelocity,s.ComPos,p.ComState,h.ComVar,u.ComCollision,l.ComPrefab]},e.prototype.Apply=function(t){var e=this.Battle.ref2id(this.context.sender),r=this.GetCom(f.ComType),o=this.GetCom(s.ComPos),n=this.GetCom(c.ComVelocity),i=(this.GetCom(h.ComVar),this.GetCom(u.ComCollision),this.GetCom(l.ComPrefab),this.GetCom(p.ComState));r.nextType[t]=f.EComType.Bullet;var a=this.context.rad;n.vx[t]=Math.cos(a),n.vy[t]=Math.sin(a),n.vgx[t]=Math.cos(a),n.vgy[t]=Math.sin(a),o.x[t]=o.x[e],o.y[t]=o.y[e],o.d[t]=a,o.dType[t]=s.EDirectionType.Normal,this.ApplyBullet(e,t,this.GetProperty("resId")),i.SwitchBoomerange(t,this.GetProperty("resId"))},e.__cname="RBBoomerange",i([a.injectField("Battle")],e.prototype,"Battle",void 0),e}(y.RoleBuilder);r.RBBoomerange=d,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../view/prefab/ComPrefab":"ComPrefab","../move/ComPos":"ComPos","../move/ComVelocity":"ComVelocity","../physical/ComCollision":"ComCollision","../state/ComState":"ComState","../type/ComType":"ComType","../var/ComVar":"ComVar","./RoleBuilder":"RoleBuilder"}],RBBoom:[function(t,e,r){"use strict";cc._RF.push(e,"2cc7dxMpmNCR4jHkv4YNAJy","RBBoom");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.RBBoom=void 0;var a=t("../../../../../../framework/container/Container"),l=t("../../view/prefab/ComPrefab"),s=t("../move/ComPos"),c=t("../physical/ComCollision"),u=t("../state/ComState"),p=t("../type/ComType"),f=t("../var/ComVar"),h=t("./RoleBuilder"),y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.Create=function(t){var r=new h.RBContext;r.target=t;var o=new e;return o.Setup(r),o},e.prototype.OnGetTlComClazz=function(){return[p.ComType,s.ComPos,u.ComState,f.ComVar,c.ComCollision,l.ComPrefab]},e.prototype.Apply=function(t){var e=this.Battle.ref2id(this.context.sender),r=this.GetCom(p.ComType),o=this.GetCom(s.ComPos),n=(this.GetCom(f.ComVar),this.GetCom(c.ComCollision),this.GetCom(l.ComPrefab),this.GetCom(u.ComState));r.nextType[t]=p.EComType.Bullet,this.Battle.ref2id(this.context.target);var i=this.GetProperty("pos");o.x[t]=i[0],o.y[t]=i[1],this.ApplyBullet(e,t,this.GetProperty("resId")),n.SwitchLightning(t,this.context.target,this.GetProperty("resId"))},e.__cname="RBBoom",i([a.injectField("Battle")],e.prototype,"Battle",void 0),e}(h.RoleBuilder);r.RBBoom=y,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../view/prefab/ComPrefab":"ComPrefab","../move/ComPos":"ComPos","../physical/ComCollision":"ComCollision","../state/ComState":"ComState","../type/ComType":"ComType","../var/ComVar":"ComVar","./RoleBuilder":"RoleBuilder"}],RBBox:[function(t,e,r){"use strict";cc._RF.push(e,"e9dc0ONrAFKAZH3J3SL3cxM","RBBox");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.RBBox=void 0;var a=t("../../../../../../framework/container/Container"),l=t("../../../../../../framework/FW"),s=t("../../view/prefab/ComPrefab"),c=t("../move/ComPos"),u=t("../physical/ComCollision"),p=t("../state/ComState"),f=t("../type/ComType"),h=t("../var/ComVar"),y=t("./RoleBuilder"),d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.Create=function(t,r){var o=new y.RBContext;o.x=t,o.y=r;var n=new e;return n.Setup(o),n},e.prototype.OnGetTlComClazz=function(){return[f.ComType,c.ComPos,p.ComState,h.ComVar,u.ComCollision,s.ComPrefab]},e.prototype.Apply=function(t){var e=this.GetCom(f.ComType),r=this.GetCom(c.ComPos),o=this.GetCom(h.ComVar),n=this.GetCom(u.ComCollision),i=this.GetCom(s.ComPrefab),a=this.GetCom(p.ComState),y=this.context.x,d=this.context.y;e.nextType[t]=f.EComType.PropBox,r.x[t]=y,r.y[t]=d,o.HP[t]=1,o.CAMP[t]=h.EComCamp.Monster,n.r[t]=20,i.nextModel[t]="\u767e\u604b_\u516c\u5171_\u9676\u7f502",a.SwitchIdle(this.Battle.getRef(t)),l.FW.ZJJ.log("[\u9676\u7f50"+t+"]\u751f\u6210")},e.__cname="RBBox",i([a.injectField("Battle")],e.prototype,"Battle",void 0),e}(y.RoleBuilder);r.RBBox=d,cc._RF.pop()},{"../../../../../../framework/FW":void 0,"../../../../../../framework/container/Container":void 0,"../../view/prefab/ComPrefab":"ComPrefab","../move/ComPos":"ComPos","../physical/ComCollision":"ComCollision","../state/ComState":"ComState","../type/ComType":"ComType","../var/ComVar":"ComVar","./RoleBuilder":"RoleBuilder"}],RBBrick:[function(t,e,r){"use strict";cc._RF.push(e,"dcc4dlG2i1KGLry7yNC0kLc","RBBrick");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.RBBrick=void 0;var a=t("../../../../../../framework/container/Container"),l=t("../../view/prefab/ComPrefab"),s=t("../move/ComPos"),c=t("../move/ComVelocity"),u=t("../physical/ComCollision"),p=t("../state/ComState"),f=t("../type/ComType"),h=t("../var/ComVar"),y=t("./RoleBuilder"),d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.Create=function(t){var r=new y.RBContext;r.sender=t;var o=new e;return o.Setup(r),o},e.prototype.OnGetTlComClazz=function(){return[f.ComType,c.ComVelocity,s.ComPos,p.ComState,h.ComVar,u.ComCollision,l.ComPrefab]},e.prototype.Apply=function(t){var e=this.Battle.ref2id(this.context.sender),r=this.GetCom(f.ComType),o=this.GetCom(s.ComPos),n=this.GetCom(c.ComVelocity),i=this.GetCom(p.ComState),a=this.GetCom(h.ComVar);r.nextType[t]=f.EComType.Bullet,n.vx[t]=0,n.vy[t]=1,n.vgx[t]=0,n.vgy[t]=1,o.x[t]=o.x[e],o.y[t]=o.y[e],this.ApplyBullet(e,t,this.GetProperty("resId"));var l=a.CalHeroAttr("s7044",0);0!=l&&(a.PENETRATE[t]=l),i.SwitchBrick(t,this.GetProperty("resId"))},e.__cname="RBBrick",i([a.injectField("Battle")],e.prototype,"Battle",void 0),e}(y.RoleBuilder);r.RBBrick=d,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../view/prefab/ComPrefab":"ComPrefab","../move/ComPos":"ComPos","../move/ComVelocity":"ComVelocity","../physical/ComCollision":"ComCollision","../state/ComState":"ComState","../type/ComType":"ComType","../var/ComVar":"ComVar","./RoleBuilder":"RoleBuilder"}],RBCrossBow:[function(t,e,r){"use strict";cc._RF.push(e,"704f0R9FBVIz4xAnkhpiZ2x","RBCrossBow");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.RBCrossBow=void 0;var a=t("../../../../../../framework/container/Container"),l=t("../../view/prefab/ComPrefab"),s=t("../move/ComPos"),c=t("../move/ComVelocity"),u=t("../physical/ComCollision"),p=t("../state/ComState"),f=t("../type/ComType"),h=t("../var/ComVar"),y=t("./RoleBuilder"),d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.Create=function(t,r,o,n){var i=new y.RBContext;i.sender=t,i.rad=r,i.x=o,i.y=n;var a=new e;return a.Setup(i),a},e.prototype.OnGetTlComClazz=function(){return[f.ComType,c.ComVelocity,s.ComPos,p.ComState,h.ComVar,u.ComCollision,l.ComPrefab]},e.prototype.Apply=function(t){var e=this.Battle.ref2id(this.context.sender),r=this.GetCom(f.ComType),o=this.GetCom(s.ComPos),n=this.GetCom(c.ComVelocity),i=this.GetCom(p.ComState);r.nextType[t]=f.EComType.Bullet;var a=this.context.rad;n.vx[t]=Math.cos(a),n.vy[t]=Math.sin(a),n.vgx[t]=Math.cos(a),n.vgy[t]=Math.sin(a),null!=this.context.x?(o.x[t]=this.context.x,o.y[t]=this.context.y):(o.x[t]=o.x[e],o.y[t]=o.y[e]),this.ApplyBullet(e,t,this.GetProperty("resId")),this.Battle.getRef(e),i.SwitchCrossBow(t,this.GetProperty("resId"))},e.__cname="RBCrossBow",i([a.injectField("Battle")],e.prototype,"Battle",void 0),e}(y.RoleBuilder);r.RBCrossBow=d,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../view/prefab/ComPrefab":"ComPrefab","../move/ComPos":"ComPos","../move/ComVelocity":"ComVelocity","../physical/ComCollision":"ComCollision","../state/ComState":"ComState","../type/ComType":"ComType","../var/ComVar":"ComVar","./RoleBuilder":"RoleBuilder"}],RBDartSuperRed:[function(t,e,r){"use strict";cc._RF.push(e,"23175514WhKTqkEavP8LhuK","RBDartSuperRed");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.RBDartSuperRed=void 0;var a=t("../../../../../../framework/container/Container"),l=t("../../view/prefab/ComPrefab"),s=t("../move/ComPos"),c=t("../move/ComVelocity"),u=t("../physical/ComCollision"),p=t("../state/ComState"),f=t("../type/ComType"),h=t("../var/ComVar"),y=t("./RoleBuilder"),d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.Create=function(t,r,o,n){var i=new y.RBContext;i.sender=t,i.rad=r,i.x=o,i.y=n;var a=new e;return a.Setup(i),a},e.prototype.OnGetTlComClazz=function(){return[f.ComType,c.ComVelocity,s.ComPos,p.ComState,h.ComVar,u.ComCollision,l.ComPrefab]},e.prototype.Apply=function(t){var e=this.Battle.ref2id(this.context.sender),r=this.GetCom(f.ComType),o=this.GetCom(s.ComPos),n=this.GetCom(c.ComVelocity),i=this.GetCom(p.ComState);r.nextType[t]=f.EComType.Bullet;var a=this.context.rad;n.vx[t]=Math.cos(a),n.vy[t]=Math.sin(a),n.vgx[t]=Math.cos(a),n.vgy[t]=Math.sin(a),n.moving[t]=!0,o.x[t]=this.context.x,o.y[t]=this.context.y,this.ApplyBullet(e,t,this.GetProperty("resId")),this.Battle.getRef(e),i.SwitchDartSuperRed(t,this.GetProperty("resId"))},e.__cname="RBDartSuperRed",i([a.injectField("Battle")],e.prototype,"Battle",void 0),e}(y.RoleBuilder);r.RBDartSuperRed=d,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../view/prefab/ComPrefab":"ComPrefab","../move/ComPos":"ComPos","../move/ComVelocity":"ComVelocity","../physical/ComCollision":"ComCollision","../state/ComState":"ComState","../type/ComType":"ComType","../var/ComVar":"ComVar","./RoleBuilder":"RoleBuilder"}],RBDart:[function(t,e,r){"use strict";cc._RF.push(e,"48ec755yIJGj7Cbd071DqoM","RBDart");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.RBDart=void 0;var a=t("../../../../../../framework/container/Container"),l=t("../../view/prefab/ComPrefab"),s=t("../move/ComPos"),c=t("../move/ComVelocity"),u=t("../physical/ComCollision"),p=t("../state/ComState"),f=t("../type/ComType"),h=t("../var/ComVar"),y=t("./RoleBuilder"),d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.Create=function(t,r,o,n){var i=new y.RBContext;i.sender=t,i.rad=r,i.x=o,i.y=n;var a=new e;return a.Setup(i),a},e.prototype.OnGetTlComClazz=function(){return[f.ComType,c.ComVelocity,s.ComPos,p.ComState,h.ComVar,u.ComCollision,l.ComPrefab]},e.prototype.Apply=function(t){var e=this.Battle.ref2id(this.context.sender),r=this.GetCom(f.ComType),o=this.GetCom(s.ComPos),n=this.GetCom(c.ComVelocity),i=this.GetCom(p.ComState);r.nextType[t]=f.EComType.Bullet;var a=this.context.rad;n.vx[t]=Math.cos(a),n.vy[t]=Math.sin(a),n.vgx[t]=Math.cos(a),n.vgy[t]=Math.sin(a),o.x[t]=this.context.x,o.y[t]=this.context.y,this.ApplyBullet(e,t,this.GetProperty("resId"));var l=this.Battle.getRef(e);i.SwitchDart(t,l,this.GetProperty("resId"))},e.__cname="RBDart",i([a.injectField("Battle")],e.prototype,"Battle",void 0),e}(y.RoleBuilder);r.RBDart=d,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../view/prefab/ComPrefab":"ComPrefab","../move/ComPos":"ComPos","../move/ComVelocity":"ComVelocity","../physical/ComCollision":"ComCollision","../state/ComState":"ComState","../type/ComType":"ComType","../var/ComVar":"ComVar","./RoleBuilder":"RoleBuilder"}],RBDrillSuper:[function(t,e,r){"use strict";cc._RF.push(e,"30caddbC5dL4bDGlF5OwfEl","RBDrillSuper");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.RBDrillSuper=void 0;var a=t("../../../../../../framework/container/Container"),l=t("../../view/prefab/ComPrefab"),s=t("../move/ComPos"),c=t("../move/ComVelocity"),u=t("../physical/ComCollision"),p=t("../state/ComState"),f=t("../type/ComType"),h=t("../var/ComVar"),y=t("./RoleBuilder"),d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.Create=function(t,r){var o=new y.RBContext;o.sender=t,o.rad=r;var n=new e;return n.Setup(o),n},e.prototype.OnGetTlComClazz=function(){return[f.ComType,c.ComVelocity,s.ComPos,p.ComState,h.ComVar,u.ComCollision,l.ComPrefab]},e.prototype.Apply=function(t){var e=this.Battle.ref2id(this.context.sender),r=this.GetCom(f.ComType),o=this.GetCom(s.ComPos),n=this.GetCom(c.ComVelocity),i=(this.GetCom(h.ComVar),this.GetCom(u.ComCollision),this.GetCom(l.ComPrefab),this.GetCom(p.ComState));r.nextType[t]=f.EComType.Bullet;var a=this.context.rad;n.vx[t]=Math.cos(a),n.vy[t]=Math.sin(a),n.vgx[t]=Math.cos(a),n.vgy[t]=Math.sin(a),o.x[t]=o.x[e],o.y[t]=o.y[e],o.d[t]=a,this.ApplyBullet(e,t,this.GetProperty("resId")),i.SwitchDrillSuper(t,this.context.sender,this.GetProperty("resId"))},e.__cname="RBDrillSuper",i([a.injectField("Battle")],e.prototype,"Battle",void 0),e}(y.RoleBuilder);r.RBDrillSuper=d,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../view/prefab/ComPrefab":"ComPrefab","../move/ComPos":"ComPos","../move/ComVelocity":"ComVelocity","../physical/ComCollision":"ComCollision","../state/ComState":"ComState","../type/ComType":"ComType","../var/ComVar":"ComVar","./RoleBuilder":"RoleBuilder"}],RBDrill:[function(t,e,r){"use strict";cc._RF.push(e,"a0022f7k79HT4CKxrdpl95z","RBDrill");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.RBDrill=void 0;var a=t("../../../../../../framework/container/Container"),l=t("../../view/prefab/ComPrefab"),s=t("../move/ComPos"),c=t("../move/ComVelocity"),u=t("../physical/ComCollision"),p=t("../state/ComState"),f=t("../type/ComType"),h=t("../var/ComVar"),y=t("./RoleBuilder"),d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.Create=function(t,r){var o=new y.RBContext;o.sender=t,o.rad=r;var n=new e;return n.Setup(o),n},e.prototype.OnGetTlComClazz=function(){return[f.ComType,c.ComVelocity,s.ComPos,p.ComState,h.ComVar,u.ComCollision,l.ComPrefab]},e.prototype.Apply=function(t){var e=this.Battle.ref2id(this.context.sender),r=this.GetCom(f.ComType),o=this.GetCom(s.ComPos),n=this.GetCom(c.ComVelocity),i=this.GetCom(h.ComVar),a=(this.GetCom(u.ComCollision),this.GetCom(l.ComPrefab),this.GetCom(p.ComState));r.nextType[t]=f.EComType.Bullet;var y=this.context.rad;n.vx[t]=Math.cos(y),n.vy[t]=Math.sin(y),n.vgx[t]=Math.cos(y),n.vgy[t]=Math.sin(y),o.x[t]=o.x[e],o.y[t]=o.y[e],o.d[t]=y;var d=this.GetProperty("resId");this.ApplyBullet(e,t,d);var m=i.CalHeroAttr("s7124",1);if(m>1){var v=this.ModelBattleSkill.GetBullet(d).GetSpeed();n.speed[t]=i.CalAttr(e,"bsp",v)*m}a.SwitchDrill(t,d)},e.__cname="RBDrill",i([a.injectField("Battle")],e.prototype,"Battle",void 0),e}(y.RoleBuilder);r.RBDrill=d,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../view/prefab/ComPrefab":"ComPrefab","../move/ComPos":"ComPos","../move/ComVelocity":"ComVelocity","../physical/ComCollision":"ComCollision","../state/ComState":"ComState","../type/ComType":"ComType","../var/ComVar":"ComVar","./RoleBuilder":"RoleBuilder"}],RBDurianSuper:[function(t,e,r){"use strict";cc._RF.push(e,"19c10g/d9hGU4nsbqAouWz1","RBDurianSuper");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.RBDurianSuper=void 0;var a=t("../../../../../../framework/container/Container"),l=t("../../view/prefab/ComPrefab"),s=t("../move/ComPos"),c=t("../move/ComVelocity"),u=t("../physical/ComCollision"),p=t("../state/ComState"),f=t("../type/ComType"),h=t("../var/ComVar"),y=t("./RoleBuilder"),d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.Create=function(t,r){var o=new y.RBContext;o.sender=t,o.rad=r;var n=new e;return n.Setup(o),n},e.prototype.OnGetTlComClazz=function(){return[f.ComType,c.ComVelocity,s.ComPos,p.ComState,h.ComVar,u.ComCollision,l.ComPrefab]},e.prototype.Apply=function(t){var e=this.Battle.ref2id(this.context.sender),r=this.GetCom(f.ComType),o=this.GetCom(s.ComPos),n=this.GetCom(c.ComVelocity),i=(this.GetCom(h.ComVar),this.GetCom(u.ComCollision),this.GetCom(l.ComPrefab),this.GetCom(p.ComState));r.nextType[t]=f.EComType.Bullet;var a=this.context.rad;n.vx[t]=Math.cos(a),n.vy[t]=Math.sin(a),n.vgx[t]=Math.cos(a),n.vgy[t]=Math.sin(a),o.x[t]=o.x[e],o.y[t]=o.y[e],o.d[t]=a,o.dType[t]=s.EDirectionType.LeftRight,this.ApplyBullet(e,t,this.GetProperty("resId")),i.SwitchDurian(t,this.GetProperty("resId"))},e.__cname="RBDurianSuper",i([a.injectField("Battle")],e.prototype,"Battle",void 0),e}(y.RoleBuilder);r.RBDurianSuper=d,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../view/prefab/ComPrefab":"ComPrefab","../move/ComPos":"ComPos","../move/ComVelocity":"ComVelocity","../physical/ComCollision":"ComCollision","../state/ComState":"ComState","../type/ComType":"ComType","../var/ComVar":"ComVar","./RoleBuilder":"RoleBuilder"}],RBDurian:[function(t,e,r){"use strict";cc._RF.push(e,"4599c+YxSRBJZFKFwB/qjKi","RBDurian");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.RBDurian=void 0;var a=t("../../../../../../framework/container/Container"),l=t("../../view/prefab/ComPrefab"),s=t("../move/ComPos"),c=t("../move/ComVelocity"),u=t("../physical/ComCollision"),p=t("../state/ComState"),f=t("../type/ComType"),h=t("../var/ComVar"),y=t("./RoleBuilder"),d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.Create=function(t,r){var o=new y.RBContext;o.sender=t,o.rad=r;var n=new e;return n.Setup(o),n},e.prototype.OnGetTlComClazz=function(){return[f.ComType,c.ComVelocity,s.ComPos,p.ComState,h.ComVar,u.ComCollision,l.ComPrefab]},e.prototype.Apply=function(t){var e=this.Battle.ref2id(this.context.sender),r=this.GetCom(f.ComType),o=this.GetCom(s.ComPos),n=this.GetCom(c.ComVelocity),i=(this.GetCom(h.ComVar),this.GetCom(u.ComCollision),this.GetCom(l.ComPrefab),this.GetCom(p.ComState));r.nextType[t]=f.EComType.Bullet;var a=this.context.rad;n.vx[t]=Math.cos(a),n.vy[t]=Math.sin(a),n.vgx[t]=Math.cos(a),n.vgy[t]=Math.sin(a),o.x[t]=o.x[e],o.y[t]=o.y[e],o.d[t]=a,o.dType[t]=s.EDirectionType.LeftRight,this.ApplyBullet(e,t,this.GetProperty("resId")),i.SwitchDurian(t,this.GetProperty("resId"))},e.__cname="RBDurian",i([a.injectField("Battle")],e.prototype,"Battle",void 0),e}(y.RoleBuilder);r.RBDurian=d,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../view/prefab/ComPrefab":"ComPrefab","../move/ComPos":"ComPos","../move/ComVelocity":"ComVelocity","../physical/ComCollision":"ComCollision","../state/ComState":"ComState","../type/ComType":"ComType","../var/ComVar":"ComVar","./RoleBuilder":"RoleBuilder"}],RBFieldSlow:[function(t,e,r){"use strict";cc._RF.push(e,"e076b8NwMNER6y+y2hlZ1wY","RBFieldSlow");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.RBFieldSlow=void 0;var a=t("../../../../../../framework/container/Container"),l=t("../../view/prefab/ComPrefab"),s=t("../move/ComPos"),c=t("../move/ComVelocity"),u=t("../physical/ComCollision"),p=t("../state/ComState"),f=t("../type/ComType"),h=t("../var/ComVar"),y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnGetTlComClazz=function(){return[f.ComType,c.ComVelocity,s.ComPos,p.ComState,h.ComVar,u.ComCollision,l.ComPrefab]},e.prototype.Apply=function(t){var e=this.Battle.ref2id(this.context.sender),r=this.GetCom(f.ComType),o=this.GetCom(s.ComPos),n=(this.GetCom(h.ComVar),this.GetCom(u.ComCollision),this.GetCom(l.ComPrefab),this.GetCom(p.ComState));this.GetCom(c.ComVelocity),r.nextType[t]=f.EComType.Bullet,o.x[t]=o.x[e],o.y[t]=o.y[e],this.ApplyBullet(e,t,this.GetProperty("resId")),n.SwitchFieldSlow(t,this.GetProperty("resId"))},e.__cname="RBFieldSlow",i([a.injectField("Battle")],e.prototype,"Battle",void 0),e}(t("./RoleBuilder").RoleBuilder);r.RBFieldSlow=y,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../view/prefab/ComPrefab":"ComPrefab","../move/ComPos":"ComPos","../move/ComVelocity":"ComVelocity","../physical/ComCollision":"ComCollision","../state/ComState":"ComState","../type/ComType":"ComType","../var/ComVar":"ComVar","./RoleBuilder":"RoleBuilder"}],RBField:[function(t,e,r){"use strict";cc._RF.push(e,"8e425w+WhxKVplOqPihiIxt","RBField");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.RBField=void 0;var a=t("../../../../../../framework/container/Container"),l=t("../../view/nodeproxy/NodeProxy"),s=t("../../view/prefab/ComPrefab"),c=t("../move/ComPos"),u=t("../physical/ComCollision"),p=t("../state/ComState"),f=t("../type/ComType"),h=t("../var/ComVar"),y=t("./RoleBuilder"),d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.Create=function(t){var r=new y.RBContext;r.sender=t;var o=new e;return o.Setup(r),o},e.prototype.OnGetTlComClazz=function(){return[f.ComType,c.ComPos,p.ComState,h.ComVar,u.ComCollision,s.ComPrefab]},e.prototype.Apply=function(t){var e=this.Battle.ref2id(this.context.sender),r=this.GetCom(f.ComType),o=this.GetCom(c.ComPos),n=this.GetCom(h.ComVar),i=this.GetCom(u.ComCollision),a=this.GetCom(s.ComPrefab),y=this.GetCom(p.ComState);r.nextType[t]=f.EComType.Bullet,o.x[t]=o.x[e],o.y[t]=o.y[e],a.order[t]=l.NodeProxyOrder.EffectBack,this.ApplyBullet(e,t,this.GetProperty("resId"));var d=n.CalHeroAttr("s7034",1);if(d>1){var m=this.ModelBattleSkill.GetBullet(this.GetProperty("resId")),v=m.GetModel(0),_=i.r,S=n.BULLET_MODEL_PROTOTYPE_SIZE,g=m.GetPrototypeSizeBy(v),b=n.CalBulletPrototypeSize(t,g),C=m.GetDamageRadiusBy(v),R=n.CalBulletPrototypeSize(t,C);S[t]=.75*g,_[t]=.75*R,n.BULLET_ATTR_DAMAGE_RATE[t]*=d,a.ChangeModel(t,v,1,null,null,.75*b)}y.SwitchField(t,this.context.sender,this.GetProperty("resId"))},e.__cname="RBField",i([a.injectField("Battle")],e.prototype,"Battle",void 0),e}(y.RoleBuilder);r.RBField=d,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../view/nodeproxy/NodeProxy":"NodeProxy","../../view/prefab/ComPrefab":"ComPrefab","../move/ComPos":"ComPos","../physical/ComCollision":"ComCollision","../state/ComState":"ComState","../type/ComType":"ComType","../var/ComVar":"ComVar","./RoleBuilder":"RoleBuilder"}],RBFollow:[function(t,e,r){"use strict";cc._RF.push(e,"12c2a9/IH1K5o6fqiiDDw9u","RBFollow");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.RBFollow=void 0;var a=t("../../../../../../framework/container/Container"),l=t("../../view/prefab/ComPrefab"),s=t("../move/ComPos"),c=t("../move/ComVelocity"),u=t("../physical/ComCollision"),p=t("../state/ComState"),f=t("../type/ComType"),h=t("../var/ComVar"),y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnGetTlComClazz=function(){return[f.ComType,c.ComVelocity,s.ComPos,p.ComState,h.ComVar,u.ComCollision,l.ComPrefab]},e.prototype.Apply=function(t){var e=this.Battle.ref2id(this.context.sender),r=this.GetCom(f.ComType),o=this.GetCom(s.ComPos),n=(this.GetCom(h.ComVar),this.GetCom(u.ComCollision),this.GetCom(l.ComPrefab),this.GetCom(p.ComState));this.GetCom(c.ComVelocity),r.nextType[t]=f.EComType.Bullet,o.x[t]=o.x[e],o.y[t]=o.y[e];var i=this.Battle.startConfig.mainSkill,a=this.GPHeroSkill.GetSkill(i).GetLevel(),y=this.ModelBattleSkill.FindSkillLevel(i,a),d=this.ModelBattleSkill.GetBullet(y.GetBullet(0));this.ApplyBullet(e,t,this.GetProperty("resId"),d.GetDamageRate()),n.SwitchFollow(t,this.context.sender,this.GetProperty("resId"))},e.__cname="RBFollow",i([a.injectField("Battle")],e.prototype,"Battle",void 0),i([a.injectField("ComVar")],e.prototype,"ComVar",void 0),i([a.injectField("ModelBattleSkill")],e.prototype,"ModelBattleSkill",void 0),i([a.injectField("GPHeroSkill")],e.prototype,"GPHeroSkill",void 0),e}(t("./RoleBuilder").RoleBuilder);r.RBFollow=y,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../view/prefab/ComPrefab":"ComPrefab","../move/ComPos":"ComPos","../move/ComVelocity":"ComVelocity","../physical/ComCollision":"ComCollision","../state/ComState":"ComState","../type/ComType":"ComType","../var/ComVar":"ComVar","./RoleBuilder":"RoleBuilder"}],RBFootball:[function(t,e,r){"use strict";cc._RF.push(e,"b944f8M4BhCw7qqFTFD98lZ","RBFootball");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.RBFootball=void 0;var a=t("../../../../../../framework/container/Container"),l=t("../../view/prefab/ComPrefab"),s=t("../move/ComPos"),c=t("../move/ComVelocity"),u=t("../physical/ComCollision"),p=t("../state/ComState"),f=t("../type/ComType"),h=t("../var/ComVar"),y=t("./RoleBuilder"),d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.Create=function(t,r){var o=new y.RBContext;o.sender=t,o.rad=r;var n=new e;return n.Setup(o),n},e.prototype.OnGetTlComClazz=function(){return[f.ComType,c.ComVelocity,s.ComPos,p.ComState,h.ComVar,u.ComCollision,l.ComPrefab]},e.prototype.Apply=function(t){var e=this.Battle.ref2id(this.context.sender),r=this.GetCom(f.ComType),o=this.GetCom(s.ComPos),n=this.GetCom(c.ComVelocity),i=this.GetCom(h.ComVar),a=(this.GetCom(u.ComCollision),this.GetCom(l.ComPrefab),this.GetCom(p.ComState));r.nextType[t]=f.EComType.Bullet;var y=this.context.rad;n.vx[t]=Math.cos(y),n.vy[t]=Math.sin(y),n.vgx[t]=Math.cos(y),n.vgy[t]=Math.sin(y),n.speed[t]=512,o.x[t]=o.x[e],o.y[t]=o.y[e],this.ApplyBullet(e,t,this.GetProperty("resId"));var d=i.CalHeroAttr("s7134",1);if(d>1){var m=this.ModelBattleSkill.GetBullet(this.GetProperty("resId")).GetSpeed();n.speed[t]=i.CalAttr(e,"bsp",m)*d}var v=i.CalHeroAttr("s7136",0);if(v>0){var _=this.ModelBattleSkill.GetBullet(this.GetProperty("resId")).GetLifeTime();this.GetProperty("has_let")&&(_=i.CalAttr(e,"let",_)),i.BULLET_LIFETIME[t]=_+v}a.SwitchFootball(t,this.context.rad,this.GetProperty("resId"))},e.__cname="RBFootball",i([a.injectField("Battle")],e.prototype,"Battle",void 0),e}(y.RoleBuilder);r.RBFootball=d,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../view/prefab/ComPrefab":"ComPrefab","../move/ComPos":"ComPos","../move/ComVelocity":"ComVelocity","../physical/ComCollision":"ComCollision","../state/ComState":"ComState","../type/ComType":"ComType","../var/ComVar":"ComVar","./RoleBuilder":"RoleBuilder"}],RBGuarder:[function(t,e,r){"use strict";cc._RF.push(e,"818196ow/BFfJ5zCitH7V4O","RBGuarder");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.RBGuarder=void 0;var a=t("../../../../../../framework/container/Container"),l=t("../../view/prefab/ComPrefab"),s=t("../move/ComPos"),c=t("../move/ComVelocity"),u=t("../physical/ComCollision"),p=t("../state/ComState"),f=t("../type/ComType"),h=t("../var/ComVar"),y=t("./RoleBuilder"),d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.Create=function(t,r,o){var n=new y.RBContext;n.sender=t,n.rad=r,n.radius=o;var i=new e;return i.Setup(n),i},e.prototype.OnGetTlComClazz=function(){return[f.ComType,c.ComVelocity,s.ComPos,p.ComState,h.ComVar,u.ComCollision,l.ComPrefab]},e.prototype.Apply=function(t){var e=this.Battle.ref2id(this.context.sender),r=this.GetCom(f.ComType),o=this.GetCom(s.ComPos),n=this.GetCom(h.ComVar),i=(this.GetCom(u.ComCollision),this.GetCom(l.ComPrefab),this.GetCom(p.ComState)),a=this.GetCom(c.ComVelocity);r.nextType[t]=f.EComType.Bullet;var y=this.context.radius,d=this.context.rad;o.x[t]=o.x[e]+y*Math.cos(d),o.y[t]=o.y[e]+y*Math.sin(d),o.d[t]=d,o.dType[t]=s.EDirectionType.Normal,a.speed[t]=512,this.ApplyBullet(e,t,this.GetProperty("resId"));var m=n.CalHeroAttr("s7144",1);1!=m&&(n.BULLET_REPEL[t]=n.BULLET_REPEL[t]*m),i.SwitchGuarder(t,this.context.sender,d,y,this.GetProperty("resId"))},e.__cname="RBGuarder",i([a.injectField("Battle")],e.prototype,"Battle",void 0),e}(y.RoleBuilder);r.RBGuarder=d,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../view/prefab/ComPrefab":"ComPrefab","../move/ComPos":"ComPos","../move/ComVelocity":"ComVelocity","../physical/ComCollision":"ComCollision","../state/ComState":"ComState","../type/ComType":"ComType","../var/ComVar":"ComVar","./RoleBuilder":"RoleBuilder"}],RBHero:[function(t,e,r){"use strict";cc._RF.push(e,"5ea0bGRGDNKGLfKHsvaMT0G","RBHero");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.RBHero=void 0;var a=t("../../../../../../framework/container/Container"),l=t("../../../../../../framework/utils/Toolset"),s=t("../../view/nodeproxy/NodeProxy"),c=t("../../view/prefab/ComPrefab"),u=t("../ai/ComAI"),p=t("../buffCarrier/ComBuffCarrier"),f=t("../move/ComPos"),h=t("../move/ComVelocity"),y=t("../physical/ComCollision"),d=t("../skill/ComSkill"),m=t("../state/ComState"),v=t("../type/ComType"),_=t("../var/ComVar"),S=t("./RoleBuilder"),g=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.Create=function(t){var r=new S.RBContext;r.resId=t;var o=new e;return o.Setup(r),o},e.prototype.OnGetTlComClazz=function(){return[v.ComType,h.ComVelocity,f.ComPos,m.ComState,u.ComAI,_.ComVar,y.ComCollision,c.ComPrefab,d.ComSkill,p.ComBuffCarrier]},e.prototype.Apply=function(t){var e=this;this.toolSet||(this.toolSet=l.ToolSet.createToolSet());var r=this.GetCom(h.ComVelocity),o=this.GetCom(v.ComType),n=this.GetCom(f.ComPos),i=this.GetCom(_.ComVar),a=this.GetCom(y.ComCollision),d=this.GetCom(c.ComPrefab),m=this.GetCom(u.ComAI),S=(this.GetCom(p.ComBuffCarrier),this.context.resId);i.HEROID=t,i.HEROREF=this.Battle.getRef(t),o.nextType[t]=v.EComType.Player;var g=this.ModelHero.GetHeroRef(S).modelBattle;r.vx[t]=0,r.vy[t]=0,r.vgx[t]=0,r.vgy[t]=0;var b=this.SystemMap.mapSafeRect;n.x[t]=b.x+b.width/2,n.y[t]=b.y+b.height/2,n.dType[t]=f.EDirectionType.LeftRight,this.toolSet.addDelay(100,function(){i.MONSTER_DROP_RATE<1&&e.SystemViewWedgit.AddWedgit(t,"\u6218\u6597_\u6218\u6597\u573a\u666f\u7279\u6548_BUFF\u8bc5\u5492"),e.SystemViewWedgit.MarkDirty(t)});var C=i.HERO_ATTR.GetAttr("hp").GetValue(),R=i.CalAttr(t,"\u5de5\u5320",1);R>1&&(C+=this.ModelEquip.getEquipHPAdd()*(R-1)),i.HP[t]=i.HEROHP||C,i.HP_Max[t]=C,i.CAMP[t]=_.EComCamp.Hero,i.REACTION[t]=2e3,i.HERO_ATTR.MarkChange(),a.r[t]=this.ModelPrefab.GetModelCollision(g),a.mass[t]=100,d.ChangeModel(t,g,s.INodeProxyAni.Idle),m.SwitchControllable(t)},e.__cname="RBHero",i([a.injectField("SystemMap")],e.prototype,"SystemMap",void 0),i([a.injectField("ModelHero")],e.prototype,"ModelHero",void 0),i([a.injectField("CtrlAttr")],e.prototype,"CtrlAttr",void 0),i([a.injectField("ModelPrefab")],e.prototype,"ModelPrefab",void 0),i([a.injectField("Battle")],e.prototype,"Battle",void 0),i([a.injectField("SystemViewWedgit")],e.prototype,"SystemViewWedgit",void 0),i([a.injectField("ModelEquip")],e.prototype,"ModelEquip",void 0),e}(S.RoleBuilder);r.RBHero=g,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../../../../../framework/utils/Toolset":void 0,"../../view/nodeproxy/NodeProxy":"NodeProxy","../../view/prefab/ComPrefab":"ComPrefab","../ai/ComAI":"ComAI","../buffCarrier/ComBuffCarrier":"ComBuffCarrier","../move/ComPos":"ComPos","../move/ComVelocity":"ComVelocity","../physical/ComCollision":"ComCollision","../skill/ComSkill":"ComSkill","../state/ComState":"ComState","../type/ComType":"ComType","../var/ComVar":"ComVar","./RoleBuilder":"RoleBuilder"}],RBLightningSuper:[function(t,e,r){"use strict";cc._RF.push(e,"bf96aIBtX5Gp7BGSFv19Szm","RBLightningSuper");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.RBLightningSuper=void 0;var a=t("../../../../../../framework/container/Container"),l=t("../../view/prefab/ComPrefab"),s=t("../move/ComPos"),c=t("../physical/ComCollision"),u=t("../state/ComState"),p=t("../type/ComType"),f=t("../var/ComVar"),h=t("./RoleBuilder"),y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.Create=function(t){var r=new h.RBContext;r.target=t;var o=new e;return o.Setup(r),o},e.prototype.OnGetTlComClazz=function(){return[p.ComType,s.ComPos,u.ComState,f.ComVar,c.ComCollision,l.ComPrefab]},e.prototype.Apply=function(t){var e=this.Battle.ref2id(this.context.sender),r=this.GetCom(p.ComType),o=this.GetCom(s.ComPos),n=this.GetCom(f.ComVar),i=this.GetCom(c.ComCollision),a=this.GetCom(l.ComPrefab),h=this.GetCom(u.ComState);r.nextType[t]=p.EComType.Bullet;var y=this.Battle.ref2id(this.context.target);o.x[t]=o.x[y],o.y[t]=o.y[y],this.ApplyBullet(e,t,this.GetProperty("resId"));var d=n.CalHeroAttr("s7156",1);if(1!=d){var m=this.ModelBattleSkill.GetBullet(this.GetProperty("resId")),v=m.GetModel(0),_=m.GetPrototypeSizeBy(v)*d;n.BULLET_MODEL_PROTOTYPE_SIZE[t]=_;var S=m.GetDamageRadiusBy(v),g=n.CalBulletPrototypeSize(t,S);i.r[t]=g*d;var b=n.CalBulletPrototypeSize(t,_);a.ChangeModel(t,v,0,0,null,b)}h.SwitchLightningSuper(t,null,this.GetProperty("resId"))},e.__cname="RBLightningSuper",i([a.injectField("Battle")],e.prototype,"Battle",void 0),e}(h.RoleBuilder);r.RBLightningSuper=y,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../view/prefab/ComPrefab":"ComPrefab","../move/ComPos":"ComPos","../physical/ComCollision":"ComCollision","../state/ComState":"ComState","../type/ComType":"ComType","../var/ComVar":"ComVar","./RoleBuilder":"RoleBuilder"}],RBLightning:[function(t,e,r){"use strict";cc._RF.push(e,"0c695GXAlNJb7ZEMcEjzyyS","RBLightning");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.RBLightning=void 0;var a=t("../../../../../../framework/container/Container"),l=t("../../view/nodeproxy/NodeProxy"),s=t("../../view/prefab/ComPrefab"),c=t("../move/ComPos"),u=t("../physical/ComCollision"),p=t("../state/ComState"),f=t("../type/ComType"),h=t("../var/ComVar"),y=t("./RoleBuilder"),d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.Create=function(t){var r=new y.RBContext;r.target=t;var o=new e;return o.Setup(r),o},e.prototype.OnGetTlComClazz=function(){return[f.ComType,c.ComPos,p.ComState,h.ComVar,u.ComCollision,s.ComPrefab]},e.prototype.Apply=function(t){var e=this.Battle.ref2id(this.context.sender),r=this.GetCom(f.ComType),o=this.GetCom(c.ComPos),n=(this.GetCom(h.ComVar),this.GetCom(u.ComCollision),this.GetCom(s.ComPrefab)),i=this.GetCom(p.ComState);r.nextType[t]=f.EComType.Bullet;var a=this.Battle.ref2id(this.context.target);o.x[t]=o.x[a],o.y[t]=o.y[a],n.order[t]=l.NodeProxyOrder.Effect,this.ApplyBullet(e,t,this.GetProperty("resId")),i.SwitchLightning(t,this.context.target,this.GetProperty("resId"))},e.__cname="RBLightning",i([a.injectField("Battle")],e.prototype,"Battle",void 0),e}(y.RoleBuilder);r.RBLightning=d,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../view/nodeproxy/NodeProxy":"NodeProxy","../../view/prefab/ComPrefab":"ComPrefab","../move/ComPos":"ComPos","../physical/ComCollision":"ComCollision","../state/ComState":"ComState","../type/ComType":"ComType","../var/ComVar":"ComVar","./RoleBuilder":"RoleBuilder"}],RBMissile:[function(t,e,r){"use strict";cc._RF.push(e,"9379foq3KhGjIn7soUiJYic","RBMissile");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.RBMissile=void 0;var a=t("../../../../../../framework/container/Container"),l=t("../../view/prefab/ComPrefab"),s=t("../move/ComPos"),c=t("../move/ComVelocity"),u=t("../physical/ComCollision"),p=t("../state/ComState"),f=t("../type/ComType"),h=t("../var/ComVar"),y=t("./RoleBuilder"),d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.Create=function(t,r,o,n,i){var a=new y.RBContext;a.sender=t,a.target=r,a.x=o,a.y=n,a.rad=i;var l=new e;return l.Setup(a),l},e.prototype.OnGetTlComClazz=function(){return[f.ComType,c.ComVelocity,s.ComPos,p.ComState,h.ComVar,u.ComCollision,l.ComPrefab]},e.prototype.Apply=function(t){var e=this.Battle.ref2id(this.context.sender),r=this.context.target&&this.Battle.ref2id(this.context.target),o=this.context.x,n=this.context.y,i=this.context.rad,a=this.GetCom(f.ComType),y=this.GetCom(s.ComPos),d=(this.GetCom(h.ComVar),this.GetCom(u.ComCollision),this.GetCom(l.ComPrefab),this.GetCom(p.ComState)),m=this.GetCom(c.ComVelocity);if(a.nextType[t]=f.EComType.Bullet,null==o?(y.x[t]=y.x[e],y.y[t]=y.y[e]):(y.x[t]=o,y.y[t]=n),null==i&&r){var v=y.x[r]-y.x[e],_=y.y[r]-y.y[e];i=Math.atan2(_,v)}var S=180*i/Math.PI;m.vx[t]=Math.cos(i),m.vy[t]=Math.sin(i),m.vgx[t]=Math.cos(i),m.vgy[t]=Math.sin(i),this.ApplyBullet(e,t,this.GetProperty("resId")),d.SwitchMissile(t,S,this.GetProperty("resId"))},e.__cname="RBMissile",i([a.injectField("Battle")],e.prototype,"Battle",void 0),e}(y.RoleBuilder);r.RBMissile=d,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../view/prefab/ComPrefab":"ComPrefab","../move/ComPos":"ComPos","../move/ComVelocity":"ComVelocity","../physical/ComCollision":"ComCollision","../state/ComState":"ComState","../type/ComType":"ComType","../var/ComVar":"ComVar","./RoleBuilder":"RoleBuilder"}],RBMolotov:[function(t,e,r){"use strict";cc._RF.push(e,"7a828nrkPtOgqqyW2GBFQUb","RBMolotov");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.RBMolotov=void 0;var a=t("../../../../../../framework/container/Container"),l=t("../../view/prefab/ComPrefab"),s=t("../move/ComPos"),c=t("../move/ComVelocity"),u=t("../physical/ComCollision"),p=t("../state/ComState"),f=t("../type/ComType"),h=t("../var/ComVar"),y=t("./RoleBuilder"),d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.Create=function(t,r){var o=new y.RBContext;o.sender=t,o.rad=r;var n=new e;return n.Setup(o),n},e.prototype.OnGetTlComClazz=function(){return[f.ComType,c.ComVelocity,s.ComPos,p.ComState,h.ComVar,u.ComCollision,l.ComPrefab]},e.prototype.Apply=function(t){var e=this.Battle.ref2id(this.context.sender),r=this.GetCom(f.ComType),o=this.GetCom(s.ComPos),n=(this.GetCom(h.ComVar),this.GetCom(u.ComCollision),this.GetCom(l.ComPrefab),this.GetCom(p.ComState)),i=this.GetCom(c.ComVelocity);r.nextType[t]=f.EComType.Bullet;var a=this.context.rad;i.vx[t]=Math.cos(a),i.vy[t]=Math.sin(a),i.vgx[t]=Math.cos(a),i.vgy[t]=Math.sin(a),o.x[t]=o.x[e],o.y[t]=o.y[e],o.d[t]=a,this.ApplyBullet(e,t,this.GetProperty("resId")),n.SwitchMolotov(t,this.GetProperty("resId"))},e.__cname="RBMolotov",i([a.injectField("Battle")],e.prototype,"Battle",void 0),e}(y.RoleBuilder);r.RBMolotov=d,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../view/prefab/ComPrefab":"ComPrefab","../move/ComPos":"ComPos","../move/ComVelocity":"ComVelocity","../physical/ComCollision":"ComCollision","../state/ComState":"ComState","../type/ComType":"ComType","../var/ComVar":"ComVar","./RoleBuilder":"RoleBuilder"}],RBMonster:[function(t,e,r){"use strict";cc._RF.push(e,"57840GO5XFIQ6aL0EwM/PqJ","RBMonster");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.RBMonster=void 0;var l=t("../../../../../../framework/container/Container"),s=t("../../../../../../framework/FW"),c=t("../../../../../../framework/utils/Toolset"),u=t("../../model/ModelBattleWave"),p=t("../../view/nodeproxy/NodeProxy"),f=t("../../view/prefab/ComPrefab"),h=t("../ai/ComAI"),y=t("../buffCarrier/ComBuffCarrier"),d=t("../move/ComPos"),m=t("../move/ComVelocity"),v=t("../physical/ComCollision"),_=t("../skill/ComSkill"),S=t("../state/ComState"),g=t("../type/ComType"),b=t("../var/ComVar"),C=t("./RoleBuilder"),R=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.Create=function(t,r,o){var n=new C.RBContext,i=new e;return i.UpdateContext(n,t,r,o),i.Setup(n),i},e.prototype.UpdateContext=function(t,e,r,o){t.resId=e,t.x=r,t.y=o},e.prototype.OnGetTlComClazz=function(){return[g.ComType,m.ComVelocity,d.ComPos,S.ComState,b.ComVar,v.ComCollision,f.ComPrefab,_.ComSkill,y.ComBuffCarrier]},e.prototype.Apply=function(t){var e,r,o=this;this.toolSet||(this.toolSet=c.ToolSet.createToolSet());var n=this.GetCom(g.ComType),i=this.GetCom(m.ComVelocity),l=this.GetCom(b.ComVar),C=this.GetCom(d.ComPos),R=this.GetCom(v.ComCollision),M=this.GetCom(f.ComPrefab),w=this.GetCom(S.ComState),O=this.GetCom(_.ComSkill);this.GetCom(y.ComBuffCarrier),w.nextDestory[t]=!1,w.locked[t]=!1;var B=this.ModelBattleWave.GetMonster(this.context.resId),P=B.GetModel(),G=this.Battle.startConfig.roleLevelMonster,k=this.ComVar.MONSTER_STRONG_LEVEL;n.nextType[t]=g.EComType.Monster,4==B.GetMonsterType()&&(n.nextType[t]=g.EComType.BossGuardMonster),i.vx[t]=0,i.vy[t]=0,i.vgx[t]=0,i.vgy[t]=0,i.basespeed[t]=B.GetSpd()*this.ComVar.MONSTER_SPEED_ADD,i.speed[t]=B.GetSpd()*this.ComVar.MONSTER_SPEED_ADD,C.x[t]=this.context.x||0,C.y[t]=this.context.y||0,C.dType[t]=d.EDirectionType.LeftRight,l.REACTION[t]=1e3,l.HP[t]=B.GetHp()*G*(1+k)*this.ComVar.MONSTER_HP_ADD,l.HP_Max[t]=l.HP[t],l.ATK[t]=B.GetAtk()*G*this.ComVar.MONSTER_ATK_ADD,l.CAMP[t]=b.EComCamp.Monster,l.NAME[t]=B.GetName(),l.RESID[t]=this.context.resId,l.MONSTER_DEF_REPEL[t]=B.GetWeg(),l.MONSTER_REF[t]=B,l.MONSTER_NO_HP[t]=-1==B.GetHp(),l.BEHIT_TIME[t]=0,l.BEHIT_DURATION[t]=0,4!=B.GetMonsterType()&&this.toolSet.addDelay(100,function(){o.ComVar.MONSTER_SPEED_ADD>1&&o.SystemViewWedgit.AddWedgit(t,"\u6218\u6597_\u6218\u6597\u573a\u666f\u7279\u6548_BUFF\u72c2\u66b4"),o.ComVar.MONSTER_ATK_ADD>1&&o.SystemViewWedgit.AddWedgit(t,"\u6218\u6597_\u6218\u6597\u573a\u666f\u7279\u6548_BUFF\u9b54\u5316"),o.SystemViewWedgit.MarkDirty(t)});var x=B.GetPhy(),T=B.GetCollisionRadius();R.r[t]=T*x,R.mass[t]=100;var j=p.INodeProxyAni.Idle,I=(x=B.GetPhy(),B.GetPrototypeSize()*x);M.ChangeModel(t,P,j,null,null,I),this.Battle.getRef(t);var D=this.ComVar.MONSTER_CAN_REPEL,F=!0;switch(B.GetBehavior()){case u.EMonsterBehavior.CHARGE:w.SwitchCharge(t,l.HEROREF,300,20);break;case u.EMonsterBehavior.STATIC:D[t]=!1,w.SwitchStatic(t);break;case u.EMonsterBehavior.WANDER_UPDOWN:w.SwitchWanderVeritical(t,l.HEROREF,600);break;case u.EMonsterBehavior.KEEP:w.SwitchKeep(t,l.HEROREF,300,20);break;case u.EMonsterBehavior.WANDER:w.SwitchWander(t,l.HEROREF,600);break;case u.EMonsterBehavior.CHARGE_LEAVE:w.SwitchChargeLeave(t,l.HEROREF);break;case u.EMonsterBehavior.SELF_BOOM:w.SwitchSelfBoom(t,l.HEROREF,100);break;case u.EMonsterBehavior.SEEK:w.SwitchSeek(t,l.HEROREF,20);break;case u.EMonsterBehavior.BT_REMOTE:F=!1,this.UsetAI(t,h.EComAITree.BossRemote);break;case u.EMonsterBehavior.BT_CHARGE:F=!1,this.UsetAI(t,h.EComAITree.BossCharge);break;case u.EMonsterBehavior.BT_STATIC:F=!1,D[t]=!1,this.UsetAI(t,h.EComAITree.BossStatic)}var L=B.GetRef().resId;try{for(var E=a(B.GetSkill()),A=E.next();!A.done;A=E.next()){var V=A.value,U=!1,W=null,H=null;if(V){W=V;var N=this.ModelBattleSkill.GetSkillMonster(V);if(N){var q=N.GetSkillType();q&&(H=q,O.SetOtherSkill(t,q,V,F),U=!0)}}U||s.FW.Log.error("\u602a\u7269\u6280\u80fd\u6709\u95ee\u9898\uff0c\u8bf7\u7b56\u5212\u68c0\u67e5: \u602a\u7269\uff1a"+L+" \u6280\u80fd\u5217\u8868id:"+W+" \u6280\u80fdid:"+H)}}catch(K){e={error:K}}finally{try{A&&!A.done&&(r=E.return)&&r.call(E)}finally{if(e)throw e.error}}},e.prototype.UsetAI=function(t,e){this.GetCom(_.ComSkill);var r=this.GetCom(b.ComVar);this.Battle.AddEntityCom(t,h.ComAI).SwitchBehaviorTree(t,e),r.REACTION[t]=5e3},e.__cname="RBMonster",i([l.injectField("Battle")],e.prototype,"Battle",void 0),i([l.injectField("ModelBattleWave")],e.prototype,"ModelBattleWave",void 0),i([l.injectField("SystemMap")],e.prototype,"SystemMap",void 0),i([l.injectField("ModelPrefab")],e.prototype,"ModelPrefab",void 0),i([l.injectField("ComVar")],e.prototype,"ComVar",void 0),i([l.injectField("SystemViewWedgit")],e.prototype,"SystemViewWedgit",void 0),e}(C.RoleBuilder);r.RBMonster=R,cc._RF.pop()},{"../../../../../../framework/FW":void 0,"../../../../../../framework/container/Container":void 0,"../../../../../../framework/utils/Toolset":void 0,"../../model/ModelBattleWave":"ModelBattleWave","../../view/nodeproxy/NodeProxy":"NodeProxy","../../view/prefab/ComPrefab":"ComPrefab","../ai/ComAI":"ComAI","../buffCarrier/ComBuffCarrier":"ComBuffCarrier","../move/ComPos":"ComPos","../move/ComVelocity":"ComVelocity","../physical/ComCollision":"ComCollision","../skill/ComSkill":"ComSkill","../state/ComState":"ComState","../type/ComType":"ComType","../var/ComVar":"ComVar","./RoleBuilder":"RoleBuilder"}],RBPulses:[function(t,e,r){"use strict";cc._RF.push(e,"4f120+LQ0FFJKaSwjT9ZEKu","RBPulses");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.RBPulses=void 0;var a=t("../../../../../../framework/container/Container"),l=t("../../view/prefab/ComPrefab"),s=t("../move/ComPos"),c=t("../move/ComVelocity"),u=t("../physical/ComCollision"),p=t("../state/ComState"),f=t("../type/ComType"),h=t("../var/ComVar"),y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnGetTlComClazz=function(){return[f.ComType,c.ComVelocity,s.ComPos,p.ComState,h.ComVar,u.ComCollision,l.ComPrefab]},e.prototype.Apply=function(t){var e=this.Battle.ref2id(this.context.sender),r=this.GetCom(f.ComType),o=this.GetCom(s.ComPos),n=(this.GetCom(h.ComVar),this.GetCom(u.ComCollision),this.GetCom(l.ComPrefab),this.GetCom(p.ComState));this.GetCom(c.ComVelocity),r.nextType[t]=f.EComType.Bullet,o.x[t]=o.x[e],o.y[t]=o.y[e],this.ApplyBullet(e,t,this.GetProperty("resId")),n.SwitchPulses(t,this.GetProperty("resId"))},e.__cname="RBPulses",i([a.injectField("Battle")],e.prototype,"Battle",void 0),e}(t("./RoleBuilder").RoleBuilder);r.RBPulses=y,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../view/prefab/ComPrefab":"ComPrefab","../move/ComPos":"ComPos","../move/ComVelocity":"ComVelocity","../physical/ComCollision":"ComCollision","../state/ComState":"ComState","../type/ComType":"ComType","../var/ComVar":"ComVar","./RoleBuilder":"RoleBuilder"}],RBRadiation:[function(t,e,r){"use strict";cc._RF.push(e,"6f46ekH0RtM2oltCC3pvAIm","RBRadiation");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.RBRadiation=void 0;var a=t("../../../../../../framework/container/Container"),l=t("../../view/prefab/ComPrefab"),s=t("../move/ComPos"),c=t("../move/ComVelocity"),u=t("../physical/ComCollision"),p=t("../state/ComState"),f=t("../type/ComType"),h=t("../var/ComVar"),y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnGetTlComClazz=function(){return[f.ComType,c.ComVelocity,s.ComPos,p.ComState,h.ComVar,u.ComCollision,l.ComPrefab]},e.prototype.Apply=function(t){var e=this.Battle.ref2id(this.context.sender),r=this.GetCom(f.ComType),o=this.GetCom(s.ComPos),n=this.GetCom(p.ComState);r.nextType[t]=f.EComType.Bullet,o.x[t]=o.x[e],o.y[t]=o.y[e],this.ApplyBullet(e,t,this.GetProperty("resId")),n.SwitchRadiation(t,this.context.sender,this.GetProperty("resId"))},e.__cname="RBRadiation",i([a.injectField("Battle")],e.prototype,"Battle",void 0),e}(t("./RoleBuilder").RoleBuilder);r.RBRadiation=y,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../view/prefab/ComPrefab":"ComPrefab","../move/ComPos":"ComPos","../move/ComVelocity":"ComVelocity","../physical/ComCollision":"ComCollision","../state/ComState":"ComState","../type/ComType":"ComType","../var/ComVar":"ComVar","./RoleBuilder":"RoleBuilder"}],RBRobotBullet:[function(t,e,r){"use strict";cc._RF.push(e,"ecddaKdPfZE1rvk/+LsB19Z","RBRobotBullet");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.RBRobotBullet=void 0;var a=t("../../../../../../framework/container/Container"),l=t("../../view/prefab/ComPrefab"),s=t("../move/ComPos"),c=t("../move/ComVelocity"),u=t("../physical/ComCollision"),p=t("../state/ComState"),f=t("../type/ComType"),h=t("../var/ComVar"),y=t("./RoleBuilder"),d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.Create=function(t,r,o,n){var i=new y.RBContext;i.sender=t,i.rad=r,i.x=o,i.y=n;var a=new e;return a.Setup(i),a},e.prototype.OnGetTlComClazz=function(){return[f.ComType,c.ComVelocity,s.ComPos,p.ComState,h.ComVar,u.ComCollision,l.ComPrefab]},e.prototype.Apply=function(t){var e=this.Battle.ref2id(this.context.sender),r=this.GetCom(f.ComType),o=this.GetCom(s.ComPos),n=this.GetCom(c.ComVelocity),i=this.GetCom(p.ComState),a=this.GetCom(h.ComVar),l=this.GetCom(u.ComCollision);r.nextType[t]=f.EComType.Bullet;var y=this.context.rad;n.vx[t]=Math.cos(y),n.vy[t]=Math.sin(y),n.vgx[t]=Math.cos(y),n.vgy[t]=Math.sin(y),o.d[t]=y,o.x[t]=o.x[e],o.y[t]=o.y[e];var d=this.context.x,m=this.context.y;if(0!=a.CalHeroAttr("s7114",0)){var v=[];this.SystemMove.findOtherCampNoBullet(h.EComCamp.Hero,d,m,200,v),v.length>0&&(d=o.x[v[0]],m=o.y[v[0]])}if(this.ApplyBullet(e,t,this.GetProperty("resId")),0!=a.CalHeroAttr("s7116",0)&&10022==a.BULLET_SKILL[t]){var _=this.ModelBattleSkill.GetBullet(this.GetProperty("resId")),S=_.GetModel(0),g=_.GetDamageRadiusBy(S),b=a.CalBulletPrototypeSize(t,g);l.r[t]=2*b}i.SwitchRobotBullet(t,this.GetProperty("resId"),d,m)},e.__cname="RBRobotBullet",i([a.injectField("Battle")],e.prototype,"Battle",void 0),i([a.injectField("SystemMove")],e.prototype,"SystemMove",void 0),e}(y.RoleBuilder);r.RBRobotBullet=d,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../view/prefab/ComPrefab":"ComPrefab","../move/ComPos":"ComPos","../move/ComVelocity":"ComVelocity","../physical/ComCollision":"ComCollision","../state/ComState":"ComState","../type/ComType":"ComType","../var/ComVar":"ComVar","./RoleBuilder":"RoleBuilder"}],RBStorm:[function(t,e,r){"use strict";cc._RF.push(e,"2d4c0chx1ROZbCQEflENm9n","RBStorm");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.RBStorm=void 0;var a=t("../../../../../../framework/container/Container"),l=t("../../view/prefab/ComPrefab"),s=t("../move/ComPos"),c=t("../move/ComVelocity"),u=t("../physical/ComCollision"),p=t("../state/ComState"),f=t("../type/ComType"),h=t("../var/ComVar"),y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnGetTlComClazz=function(){return[f.ComType,c.ComVelocity,s.ComPos,p.ComState,h.ComVar,u.ComCollision,l.ComPrefab]},e.prototype.Apply=function(t){var e=this.Battle.ref2id(this.context.sender),r=this.GetCom(f.ComType),o=this.GetCom(s.ComPos),n=(this.GetCom(h.ComVar),this.GetCom(u.ComCollision),this.GetCom(l.ComPrefab),this.GetCom(p.ComState));this.GetCom(c.ComVelocity),r.nextType[t]=f.EComType.Bullet,o.x[t]=o.x[e],o.y[t]=o.y[e];var i=this.GetProperty("pos");i&&(o.x[t]=i[0],o.y[t]=i[1]),this.ApplyBullet(e,t,this.GetProperty("resId")),n.SwitchStorm(t,this.GetProperty("resId"))},e.__cname="RBStorm",i([a.injectField("Battle")],e.prototype,"Battle",void 0),e}(t("./RoleBuilder").RoleBuilder);r.RBStorm=y,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../view/prefab/ComPrefab":"ComPrefab","../move/ComPos":"ComPos","../move/ComVelocity":"ComVelocity","../physical/ComCollision":"ComCollision","../state/ComState":"ComState","../type/ComType":"ComType","../var/ComVar":"ComVar","./RoleBuilder":"RoleBuilder"}],RBStraights:[function(t,e,r){"use strict";cc._RF.push(e,"8c1fftqsIVHELjpZ+m9Mqp6","RBStraights");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.RBStraights=void 0;var a=t("../../../../../../framework/container/Container"),l=t("../../view/prefab/ComPrefab"),s=t("../move/ComPos"),c=t("../move/ComVelocity"),u=t("../physical/ComCollision"),p=t("../state/ComState"),f=t("../type/ComType"),h=t("../var/ComVar"),y=t("./RoleBuilder"),d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.Create=function(t,r,o,n){var i=new y.RBContext;i.sender=t,i.rad=r,i.x=o,i.y=n;var a=new e;return a.Setup(i),a},e.prototype.OnGetTlComClazz=function(){return[f.ComType,c.ComVelocity,s.ComPos,p.ComState,h.ComVar,u.ComCollision,l.ComPrefab]},e.prototype.Apply=function(t){var e=this.Battle.ref2id(this.context.sender),r=this.GetCom(f.ComType),o=this.GetCom(s.ComPos),n=this.GetCom(c.ComVelocity),i=this.GetCom(p.ComState);r.nextType[t]=f.EComType.Bullet;var a=this.context.rad;n.vx[t]=Math.cos(a),n.vy[t]=Math.sin(a),n.vgx[t]=Math.cos(a),n.vgy[t]=Math.sin(a),null!=this.context.x?(o.x[t]=this.context.x,o.y[t]=this.context.y):(o.x[t]=o.x[e],o.y[t]=o.y[e]),this.ApplyBullet(e,t,this.GetProperty("resId")),this.Battle.getRef(e),i.SwitchStraight(t,this.GetProperty("resId"))},e.__cname="RBStraights",i([a.injectField("Battle")],e.prototype,"Battle",void 0),e}(y.RoleBuilder);r.RBStraights=d,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../view/prefab/ComPrefab":"ComPrefab","../move/ComPos":"ComPos","../move/ComVelocity":"ComVelocity","../physical/ComCollision":"ComCollision","../state/ComState":"ComState","../type/ComType":"ComType","../var/ComVar":"ComVar","./RoleBuilder":"RoleBuilder"}],RBSwordField:[function(t,e,r){"use strict";cc._RF.push(e,"33c7cH0HbJDXp5jQeSdnLI2","RBSwordField");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.RBSwordField=void 0;var a=t("../../../../../../framework/container/Container"),l=t("../../view/prefab/ComPrefab"),s=t("../move/ComPos"),c=t("../move/ComVelocity"),u=t("../physical/ComCollision"),p=t("../state/ComState"),f=t("../type/ComType"),h=t("../var/ComVar"),y=t("./RoleBuilder"),d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.range=300,e.swordtime=2,e.stop=20,e}return n(e,t),e.Create=function(t,r){var o=new y.RBContext;o.sender=t,o.rad=r;var n=new e;return n.Setup(o),n},e.prototype.OnGetTlComClazz=function(){return[f.ComType,c.ComVelocity,s.ComPos,p.ComState,h.ComVar,u.ComCollision,l.ComPrefab]},e.prototype.Apply=function(t){var e=this.GetCom(f.ComType),r=this.GetCom(s.ComPos),o=this.GetCom(c.ComVelocity),n=(this.GetCom(h.ComVar),this.GetCom(u.ComCollision),this.GetCom(l.ComPrefab),this.GetCom(p.ComState)),i=this.Battle.ref2id(this.context.sender);e.nextType[t]=f.EComType.Bullet,r.x[t]=r.x[i],r.y[t]=r.y[i];var a=this.context.rad;o.vx[t]=Math.cos(a),o.vy[t]=Math.sin(a),o.vgx[t]=Math.cos(a),o.vgy[t]=Math.sin(a),this.ApplyBullet(i,t,this.GetProperty("resId")),n.SwitchSwordField(t,this.stop,this.GetProperty("resId"))},e.__cname="RBSwordField",i([a.injectField("Battle")],e.prototype,"Battle",void 0),e}(y.RoleBuilder);r.RBSwordField=d,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../view/prefab/ComPrefab":"ComPrefab","../move/ComPos":"ComPos","../move/ComVelocity":"ComVelocity","../physical/ComCollision":"ComCollision","../state/ComState":"ComState","../type/ComType":"ComType","../var/ComVar":"ComVar","./RoleBuilder":"RoleBuilder"}],RBVenom:[function(t,e,r){"use strict";cc._RF.push(e,"142e6QZjJFL+a0rNYtSFD8z","RBVenom");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.RBVenom=void 0;var a=t("../../../../../../framework/container/Container"),l=t("../../view/nodeproxy/NodeProxy"),s=t("../../view/prefab/ComPrefab"),c=t("../move/ComPos"),u=t("../physical/ComCollision"),p=t("../state/ComState"),f=t("../type/ComType"),h=t("../var/ComVar"),y=t("./RoleBuilder"),d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.Create=function(t){var r=new y.RBContext;r.sender=t;var o=new e;return o.Setup(r),o},e.prototype.OnGetTlComClazz=function(){return[f.ComType,c.ComPos,p.ComState,h.ComVar,u.ComCollision,s.ComPrefab]},e.prototype.Apply=function(t){var e=this.Battle.ref2id(this.context.sender),r=this.GetCom(f.ComType),o=this.GetCom(c.ComPos),n=(this.GetCom(h.ComVar),this.GetCom(u.ComCollision),this.GetCom(s.ComPrefab)),i=this.GetCom(p.ComState);r.nextType[t]=f.EComType.Bullet,o.x[t]=o.x[e],o.y[t]=o.y[e],n.order[t]=l.NodeProxyOrder.EffectBack,this.ApplyBullet(e,t,this.GetProperty("resId")),i.SwitchVenom(t,this.context.sender,this.GetProperty("resId"))},e.__cname="RBVenom",i([a.injectField("Battle")],e.prototype,"Battle",void 0),e}(y.RoleBuilder);r.RBVenom=d,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../view/nodeproxy/NodeProxy":"NodeProxy","../../view/prefab/ComPrefab":"ComPrefab","../move/ComPos":"ComPos","../physical/ComCollision":"ComCollision","../state/ComState":"ComState","../type/ComType":"ComType","../var/ComVar":"ComVar","./RoleBuilder":"RoleBuilder"}],RDAchievementRewards:[function(t,e,r){"use strict";cc._RF.push(e,"d5edawyWHpPCoYNPexzk6Ix","RDAchievementRewards");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RDAchievementRewards=void 0;var i=t("../../../../../generated/netProto/CmdInterface"),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetRedDotType=function(){return i.CmdRedDotType.ACHIEVEMENT_TASK},e.__cname="RDAchievementRewards",e}(t("./RDServerBase").RDServerBase);r.RDAchievementRewards=a,cc._RF.pop()},{"../../../../../generated/netProto/CmdInterface":"CmdInterface","./RDServerBase":"RDServerBase"}],RDActivityCenter:[function(t,e,r){"use strict";cc._RF.push(e,"bcd92V48fVG8q9JHgtfTmqZ","RDActivityCenter");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RDActivityCenter=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnEnter=function(){},e.prototype.OnExit=function(){},e.prototype.OnComputeResult=function(){return!0},e.__cname="RDActivityCenter",e}(t("../../../../../../framework/expr/ExprVarBase").ExprVarBase);r.RDActivityCenter=i,cc._RF.pop()},{"../../../../../../framework/expr/ExprVarBase":void 0}],RDBreach:[function(t,e,r){"use strict";cc._RF.push(e,"7591dNYrolKIp2kz385W5oL","RDBreach");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.RDBreach=void 0;var a=t("../../../../../framework/container/Container"),l=t("../../../../../framework/expr/ExprVarBase"),s=t("../../../../../libutil/BigNum"),c=t("../../goods/ModelGoods"),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnEnter=function(){var t=this;this.toolSet.addListener(this.ModelMgr.ModelVO.VORoleBag.GetEventProxy(),"OnChanged",function(){t.MarkDirty()}),this.toolSet.addListener(this.ModelMgr.ModelVO.VOItemBag.GetEventProxy(),"OnChanged",function(){t.MarkDirty()})},e.prototype.OnExit=function(){},e.prototype.OnComputeResult=function(){var t=this.ModelMgr.ModelVO.VORoleBag.GetOne();if(null==t)return 0;var e=t.GetLevel(),r=this.ModelMgr.ModelBreach.GetBreachAttributeRef(t.Getpassive()+1),o=t.GetCoin();if(r&&s.BigNum.isGreaterThanOrEqualTo(o,r.deplete)&&r.level<=e)return 1;var n=this.ModelMgr.ModelBreach.GetBreachSkillRef(t.GetSpecial()+1),i=this.ModelMgr.ModelGoods.GetGoodsNumberByRefId(c.ECurrencyType.gene);return n&&i>=n.deplete?1:0},e.__cname="RDBreach",i([a.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(l.ExprVarBase);r.RDBreach=u,cc._RF.pop()},{"../../../../../framework/container/Container":void 0,"../../../../../framework/expr/ExprVarBase":void 0,"../../../../../libutil/BigNum":void 0,"../../goods/ModelGoods":"ModelGoods"}],RDChapterRewards:[function(t,e,r){"use strict";cc._RF.push(e,"5ed15DWlMVEWImWEg6QwEeG","RDChapterRewards");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.RDChapterRewards=void 0;var l=t("../../../../../framework/container/Container"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnEnter=function(){var t=this;this.toolSet.addListener(this.ModelMgr.ModelVO.VOChapterBag.GetEventProxy(),"OnChanged",function(){t.MarkDirty()})},e.prototype.OnComputeResult=function(){var t,e,r,o,n=0,i=this.ModelMgr.ModelVO.VOChapterBag.GetBagAsArray();try{for(var l=a(i),s=l.next();!s.done;s=l.next()){var c=s.value;try{for(var u=(r=void 0,a(c.GetTlChapterBoxState())),p=u.next();!p.done;p=u.next())1==p.value.rewardState&&(n+=1)}catch(f){r={error:f}}finally{try{p&&!p.done&&(o=u.return)&&o.call(u)}finally{if(r)throw r.error}}}}catch(h){t={error:h}}finally{try{s&&!s.done&&(e=l.return)&&e.call(l)}finally{if(t)throw t.error}}return n},e.__cname="RDChapterRewards",i([l.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(t("../../../../../framework/expr/ExprVarBase").ExprVarBase);r.RDChapterRewards=s,cc._RF.pop()},{"../../../../../framework/container/Container":void 0,"../../../../../framework/expr/ExprVarBase":void 0}],RDClientSet:[function(t,e,r){"use strict";cc._RF.push(e,"3aab109sxxClYZPTfYpuycG","RDClientSet");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.RDClientSet=void 0;var a=t("../../../../../../framework/FW"),l=t("../../../../../../framework/container/Container"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnEnter=function(){var t=this,e=a.FW.ExprMgr.AddScriptListener(this.GetScript(),function(){t.MarkDirty()},this);this.handler=e},e.prototype.OnExit=function(){null!=this.handler&&(a.FW.ExprMgr.RemoveScriptListener(this.handler),a.FW.ExprMgr.RemoveScriptRef(this.handler.event),this.handler=null)},e.prototype.OnComputeResult=function(){if(null==this.handler)return 0;var t=a.FW.ExprMgr.GetResult(this.GetScript());return a.FW.LWX.log(this.GetScript()+":",t),t},e.__cname="RDClientSet",i([l.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(t("../../../../../../framework/expr/ExprVarBase").ExprVarBase);r.RDClientSet=s,cc._RF.pop()},{"../../../../../../framework/FW":void 0,"../../../../../../framework/container/Container":void 0,"../../../../../../framework/expr/ExprVarBase":void 0}],RDConsumablesBag:[function(t,e,r){"use strict";cc._RF.push(e,"9f46bDkAC1JBIL3ZIMVi+Yq","RDConsumablesBag");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RDConsumablesBag=void 0;var i=t("../../../vo/Goods/Goods"),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetGoodsBag=function(){return this.ModelMgr.ModelVO.VOItemBag},e.prototype.GetTlShowBagType=function(){return[i.ShowBagType.itemBag_consumables]},e.__cname="RDConsumablesBag",e}(t("./RDGoodsBagNewBase").RDGoodsBagNewBase);r.RDConsumablesBag=a,cc._RF.pop()},{"../../../vo/Goods/Goods":"Goods","./RDGoodsBagNewBase":"RDGoodsBagNewBase"}],RDDailyFuben:[function(t,e,r){"use strict";cc._RF.push(e,"1d8e4WdTPpE7oNxi3d2QF78","RDDailyFuben");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.RDDailyFuben=void 0;var a=t("../../../../../../framework/container/Container"),l=t("../../../../../../framework/expr/ExprVarBase"),s=t("../../../vo/Other/VOFuben"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnEnter=function(){var t=this;this.fubenSubset=this.ModelMgr.ModelVO.VOFubenBag.CreateSubset(),this.fubenSubset.SetFilter(function(t){return t.CheckFubenType(s.FubenType.daily)}),this.toolSet.addListener(this.fubenSubset.GetEventProxy(),"OnChanged",function(){t.MarkDirty()}),this.toolSet.addDefer(function(){t.ModelMgr.ModelVO.VOFubenBag.DestroySubset(t.fubenSubset),t.fubenSubset=null}),this.MarkDirty()},e.prototype.OnExit=function(){},e.prototype.OnComputeResult=function(){var t=this.fubenSubset.GetOneVO();if(null==t)return!1;var e=this.ModelMgr.ModelGameConfig.GetGameConfigValueByKey("dailyChallenge"),r=t.GetFreeTimes(),o=(t.GetDailyAllBoxData()||[]).some(function(t){return 1===t.state}),n=this.ModelMgr.ModelSta.GetEnd();return r>0&&n>=e||o},e.__cname="RDDailyFuben",i([a.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(l.ExprVarBase);r.RDDailyFuben=c,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../../../../../framework/expr/ExprVarBase":void 0,"../../../vo/Other/VOFuben":"VOFuben"}],RDDailyRewards:[function(t,e,r){"use strict";cc._RF.push(e,"cd420/eAJZLBKzGY+4E0Cq+","RDDailyRewards");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RDDailyRewards=void 0;var i=t("../../../../../generated/netProto/CmdInterface"),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetRedDotType=function(){return i.CmdRedDotType.DAILY_TASK},e.__cname="RDDailyRewards",e}(t("./RDServerBase").RDServerBase);r.RDDailyRewards=a,cc._RF.pop()},{"../../../../../generated/netProto/CmdInterface":"CmdInterface","./RDServerBase":"RDServerBase"}],RDDailyShop:[function(t,e,r){"use strict";cc._RF.push(e,"330afy0XulK+rgEKOc6ktjH","RDDailyShop");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.RDDailyShop=void 0;var l=t("../../../../../../framework/container/Container"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnEnter=function(){var t=this;this.toolSet.addCallback(this.ModelMgr.ModelMallDailyShop.updateRed,function(){t.MarkDirty()}),this.MarkDirty()},e.prototype.OnExit=function(){},e.prototype.GetDailyShopRDResult=function(){var t,e,r=!1,o=this.ModelMgr.ModelMallDailyShop.GetDailyShopRefData();try{for(var n=a(o),i=n.next();!i.done;i=n.next()){var l=i.value,s=60*l.cdTimes,c=l.number;if(0!=c){var u=this.TimeUtil.now(),p=this.ModelMgr.ModelMallDailyShop.GetDailyShopBuyCountByResId(l.id),f=this.ModelMgr.ModelMallDailyShop.GetDailyShopAdTimeByResId(l.id)/1e3;if(p<c&&!(u-f<s)){r=!0;break}}}}catch(h){t={error:h}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}return r},e.prototype.OnComputeResult=function(){return this.GetDailyShopRDResult()},e.__cname="RDDailyShop",i([l.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([l.injectField("TimeUtil")],e.prototype,"TimeUtil",void 0),e}(t("../../../../../../framework/expr/ExprVarBase").ExprVarBase);r.RDDailyShop=s,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../../../../../framework/expr/ExprVarBase":void 0}],RDDayWeekMonthGift:[function(t,e,r){"use strict";cc._RF.push(e,"52575jStA9LA5EmBZ9wZHp9","RDDayWeekMonthGift");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RDDayWeekMonthGift=void 0;var i=t("../../../../../generated/netProto/CmdInterface"),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetRedDotType=function(){return i.CmdRedDotType.DAY_WEEK_MONTH_GIFT},e.__cname="RDDayWeekMonthGift",e}(t("./RDServerBase").RDServerBase);r.RDDayWeekMonthGift=a,cc._RF.pop()},{"../../../../../generated/netProto/CmdInterface":"CmdInterface","./RDServerBase":"RDServerBase"}],RDEquipSynthesis:[function(t,e,r){"use strict";cc._RF.push(e,"6d5d0INMuxKr49T32ssRS7/","RDEquipSynthesis");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.RDEquipSynthesis=void 0;var s=t("../../../../../../framework/container/Container"),c=t("../../../../../../framework/expr/ExprVarBase"),u=t("../../../vo/Goods/Goods"),p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnEnter=function(){this.CheckSubSet(),this.MarkDirty()},e.prototype.OnExit=function(){},e.prototype.OnComputeResult=function(){var t,e,r,o,n,i,s,c;this.CheckSubSet(),this.InitData();var u=this.ModelMgr.ModelVO.VOEquipBag.GetBag(),p=new Map,f=new Map;try{for(var h=a(u),y=h.next();!y.done;y=h.next()){var d=l(y.value,2),m=(d[0],d[1]);if(m.GetQuality()>=4)return!1;var v=this.ModelMgr.ModelEquipSynthesis.GetRefSynthesisByEquip(m);if(v){f.clear(),p.clear();var _=this.ModelMgr.ModelEquipSynthesis.GetSelfIndexByEquip(m),S=this.ModelMgr.ModelEquipSynthesis.GetIndexByEquip(m);p.set(_,1),f.set(S,1);try{for(var g=(r=void 0,a(v.tlMaterial)),b=g.next();!b.done;b=g.next()){var C=b.value;if(1==C.type){var R=this.ModelMgr.ModelEquipSynthesis.GetIndex(m.GetRefId(),C.quality,C.phase),M=p.get(R)||0;M+=1,p.set(R,M)}else 2==C.type&&(R=this.ModelMgr.ModelEquipSynthesis.GetIndex(m.GetGoodsType(),C.quality,C.phase),M=f.get(R)||0,M+=1,f.set(R,M))}}catch(j){r={error:j}}finally{try{b&&!b.done&&(o=g.return)&&o.call(g)}finally{if(r)throw r.error}}var w=!0;try{for(var O=(n=void 0,a(f)),B=O.next();!B.done;B=O.next()){var P=l(B.value,2),G=P[0];if((M=P[1])>(this.tmEquip.get(G)||0)+(this.tmMaterials.get(G)||0)){w=!1;break}}}catch(I){n={error:I}}finally{try{B&&!B.done&&(i=O.return)&&i.call(O)}finally{if(n)throw n.error}}try{for(var k=(s=void 0,a(p)),x=k.next();!x.done;x=k.next()){var T=l(x.value,2);if(G=T[0],(M=T[1])>(this.tmSelfEquip.get(G)||0)){w=!1;break}}}catch(D){s={error:D}}finally{try{x&&!x.done&&(c=k.return)&&c.call(k)}finally{if(s)throw s.error}}if(w)return 1}}}catch(F){t={error:F}}finally{try{y&&!y.done&&(e=h.return)&&e.call(h)}finally{if(t)throw t.error}}return 0},e.prototype.CheckSubSet=function(){var t=this;if(null==this.subSet){this.subSet=this.ModelMgr.ModelVO.VOItemBag.CreateSubset();var e=this.ModelMgr.ModelGoodsBag.GetTlGoodsTypeByTlShowBag([u.ShowBagType.itemBag_EquipMaterials]);this.subSet.SetFilter(function(t){return e.has(t.GetGoodsType())}),this.toolSet.addListener(this.subSet.GetEventProxy(),"OnChanged",function(){t.MarkDirty()}),this.toolSet.addListener(this.ModelMgr.ModelVO.VOEquipBag.GetEventProxy(),"OnChanged",function(){t.MarkDirty()}),this.toolSet.addDefer(function(){t.subSet&&(t.ModelMgr.ModelVO.VOItemBag.DestroySubset(t.subSet),t.subSet=null)})}return this.subSet},e.prototype.InitData=function(){var t,e,r,o,n=this.subSet.GetTlVO();null==this.tmMaterials?this.tmMaterials=new Map:this.tmMaterials.clear();try{for(var i=a(n),s=i.next();!s.done;s=i.next()){var c=s.value;if(y=this.ModelMgr.ModelEquipSynthesis.GetIndexByMaterialsRefId(c.GetRefId())){var u=this.tmMaterials.get(y)||0;this.tmMaterials.set(y,u+c.GetNumber())}}}catch(_){t={error:_}}finally{try{s&&!s.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}var p=this.ModelMgr.ModelVO.VOEquipBag.GetBag();null==this.tmEquip?this.tmEquip=new Map:this.tmEquip.clear(),null==this.tmSelfEquip?this.tmSelfEquip=new Map:this.tmSelfEquip.clear();try{for(var f=a(p),h=f.next();!h.done;h=f.next()){var y,d=l(h.value,2),m=(d[0],d[1]);(y=this.ModelMgr.ModelEquipSynthesis.GetIndexByEquip(m))&&(u=this.tmEquip.get(y)||0,this.tmEquip.set(y,u+1));var v=this.ModelMgr.ModelEquipSynthesis.GetSelfIndexByEquip(m);v&&(u=this.tmSelfEquip.get(v)||0,this.tmSelfEquip.set(v,u+1))}}catch(S){r={error:S}}finally{try{h&&!h.done&&(o=f.return)&&o.call(f)}finally{if(r)throw r.error}}},e.__cname="RDEquipSynthesis",i([s.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(c.ExprVarBase);r.RDEquipSynthesis=p,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../../../../../framework/expr/ExprVarBase":void 0,"../../../vo/Goods/Goods":"Goods"}],RDEveryDaySignIn:[function(t,e,r){"use strict";cc._RF.push(e,"40b4eYjVtNNvrXgmHgJ53G8","RDEveryDaySignIn");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RDEveryDaySignIn=void 0;var i=t("../../../../../generated/netProto/CmdInterface"),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetRedDotType=function(){return i.CmdRedDotType.EVERY_DAY_SIGN},e.__cname="RDEveryDaySignIn",e}(t("./RDServerBase").RDServerBase);r.RDEveryDaySignIn=a,cc._RF.pop()},{"../../../../../generated/netProto/CmdInterface":"CmdInterface","./RDServerBase":"RDServerBase"}],RDFriendsApply:[function(t,e,r){"use strict";cc._RF.push(e,"cb2caFaTPZN6a02iL/2UWGg","RDFriendsApply");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.RDFriendsApply=void 0;var a=t("../../../../../../../framework/container/Container"),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnEnter=function(){var t=this;this.toolSet.addListener(this.ModelMgr.ModelVO.VOApplyFirendBag.GetEventProxy(),"OnChanged",function(){t.MarkDirty()},this)},e.prototype.OnComputeResult=function(){var t=this.ModelMgr.ModelVO.VOApplyFirendBag.GetBagAsArray();return t&&t.length||0},e.__cname="RDFriendsApply",i([a.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(t("../../../../../../../framework/expr/ExprVarBase").ExprVarBase);r.RDFriendsApply=l,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../../../../../../framework/expr/ExprVarBase":void 0}],RDFriendsReceive:[function(t,e,r){"use strict";cc._RF.push(e,"c9680T3/f9A4ai868ZwLEyn","RDFriendsReceive");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.RDFriendsReceive=void 0;var a=t("../../../../../../../framework/container/Container"),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnEnter=function(){var t=this;this.toolSet.addListener(this.ModelMgr.ModelVO.VOFirendBag.GetEventProxy(),"OnChanged",function(){t.MarkDirty()},this)},e.prototype.OnComputeResult=function(){var t=this.ModelMgr.ModelVO.VOFirendBag.GetBagAsArray(function(t){return t.GetTodayReceive()&&!t.GetTodayTake()});return t&&t.length||0},e.__cname="RDFriendsReceive",i([a.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(t("../../../../../../../framework/expr/ExprVarBase").ExprVarBase);r.RDFriendsReceive=l,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../../../../../../framework/expr/ExprVarBase":void 0}],RDFriends:[function(t,e,r){"use strict";cc._RF.push(e,"14f9aaz2l1EMaq4Gs4LvbDt","RDFriends");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.RDFriends=void 0;var a=t("../../../../../../../framework/container/Container"),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetScript=function(){return"[RDFriendsApply]+([RDFriendsReceive])"},e.__cname="RDFriends",i([a.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(t("../RDClientSet").RDClientSet);r.RDFriends=l,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../RDClientSet":"RDClientSet"}],RDFund:[function(t,e,r){"use strict";cc._RF.push(e,"f73dd+JgE5DGbRfnNggtMYz","RDFund");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.RDFund=void 0;var a=t("../../../../../../framework/container/Container"),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnEnter=function(){var t=this;this.toolSet.addListener(this.ModelMgr.ModelFund.GetEventProxy(),"OnUpdateFund",function(){t.MarkDirty()},this)},e.prototype.OnExit=function(){},e.prototype.OnComputeResult=function(){return this.ModelMgr.ModelFund.GetIsHasFundReward()},e.__cname="RDFund",i([a.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(t("../../../../../../framework/expr/ExprVarBase").ExprVarBase);r.RDFund=l,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../../../../../framework/expr/ExprVarBase":void 0}],RDGloden:[function(t,e,r){"use strict";cc._RF.push(e,"66632JyetFJkYDz/IMrwsjd","RDGloden");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.RDGloden=void 0;var l=t("../../../../../../framework/container/Container"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnEnter=function(){var t=this;this.toolSet.addCallback(this.ModelMgr.ModelMallGloden.updateRed,function(){t.MarkDirty()}),this.MarkDirty()},e.prototype.OnExit=function(){},e.prototype.GetGlodenRDResult=function(){var t,e,r,o=!1;try{for(var n=a((null===(r=this.ModelMallGloden.GetCmdMallData())||void 0===r?void 0:r.GetMallCoin())||[]),i=n.next();!i.done;i=n.next()){var l=i.value;if(l.buyCount<this.ModelMallGloden.GetCoinDataByResId(l.resId).number){o=!0;break}}}catch(s){t={error:s}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}return o},e.prototype.OnComputeResult=function(){return this.GetGlodenRDResult()},e.__cname="RDGloden",i([l.injectField("ModelMallGloden")],e.prototype,"ModelMallGloden",void 0),i([l.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([l.injectField("TimeUtil")],e.prototype,"TimeUtil",void 0),e}(t("../../../../../../framework/expr/ExprVarBase").ExprVarBase);r.RDGloden=s,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../../../../../framework/expr/ExprVarBase":void 0}],RDGoldFuben:[function(t,e,r){"use strict";cc._RF.push(e,"2a9c73qzm1CCrrDL+Q+e9Ib","RDGoldFuben");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.RDGoldFuben=void 0;var a=t("../../../../../../framework/container/Container"),l=t("../../../../../../framework/expr/ExprVarBase"),s=t("../../../vo/Other/VOFuben"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnEnter=function(){var t=this;this.fubenSubset=this.ModelMgr.ModelVO.VOFubenBag.CreateSubset(),this.fubenSubset.SetFilter(function(t){return t.CheckFubenType(s.FubenType.gold)}),this.toolSet.addListener(this.fubenSubset.GetEventProxy(),"OnChanged",function(){t.MarkDirty()}),this.toolSet.addDefer(function(){t.ModelMgr.ModelVO.VOFubenBag.DestroySubset(t.fubenSubset),t.fubenSubset=null}),this.MarkDirty()},e.prototype.OnComputeResult=function(){var t=this.fubenSubset.GetOneVO();return null!=t&&t.GetFreeTimes()>0},e.__cname="RDGoldFuben",i([a.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(l.ExprVarBase);r.RDGoldFuben=c,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../../../../../framework/expr/ExprVarBase":void 0,"../../../vo/Other/VOFuben":"VOFuben"}],RDGoodsBagNewBase:[function(t,e,r){"use strict";cc._RF.push(e,"9cb50nf3jJBM7y2pV/2/aSQ","RDGoodsBagNewBase");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.RDGoodsBagNewBase=void 0;var l=t("../../../../../../framework/container/Container"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnEnter=function(){this.CheckSubSet(),this.MarkDirty()},e.prototype.OnComputeResult=function(){var t,e;this.CheckSubSet();var r=this.subSet.GetTlVO();try{for(var o=a(r),n=o.next();!n.done;n=o.next()){var i=n.value;if(this.ModelMgr.ModelGoodsBag.CheckIsNew(i))return 1}}catch(l){t={error:l}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}return 0},e.prototype.CheckSubSet=function(){var t=this;if(null==this.subSet){var e=this.GetGoodsBag();this.subSet=e.CreateSubset();var r=this.ModelMgr.ModelGoodsBag.GetTlGoodsTypeByTlShowBag(this.GetTlShowBagType());this.subSet.SetFilter(function(t){return r.has(t.GetGoodsType())}),this.toolSet.addListener(this.subSet.GetEventProxy(),"OnChanged",function(){t.MarkDirty()}),this.toolSet.addListener(this.ModelMgr.ModelGoodsBag.GetEventProxy(),"OnNewRDUpdate",function(){t.MarkDirty()}),this.toolSet.addDefer(function(){t.subSet&&e.DestroySubset(t.subSet)})}return this.subSet},e.__cname="RDGoodsBagNewBase",i([l.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(t("../../../../../../framework/expr/ExprVarBase").ExprVarBase);r.RDGoodsBagNewBase=s,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../../../../../framework/expr/ExprVarBase":void 0}],RDHasBattleEquip:[function(t,e,r){"use strict";cc._RF.push(e,"042b223d15Fj7cSG1Y52NDn","RDHasBattleEquip");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.RDEquipBag=void 0;var l=t("../../../../../../framework/container/Container"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnEnter=function(){var t=this;this.toolSet.addListener(this.ModelVO.VOEquipBag.GetEventProxy(),"OnChanged",function(){t.MarkDirty()})},e.prototype.OnExit=function(){},e.prototype.OnComputeResult=function(){var t,e,r=this.ModelVO.VOEquipBag.GetBagAsArray();try{for(var o=a(r),n=o.next();!n.done;n=o.next()){var i=n.value;if(i.GetIsPutOn()){if(this.ModelEquip.GetUpgradeState(i))return 1}else if(this.ModelEquip.GetQualityIsHight(i))return 1}}catch(l){t={error:l}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}return 0},e.__cname="RDEquipBag",i([l.injectField("ModelVO")],e.prototype,"ModelVO",void 0),i([l.injectField("ModelEquip")],e.prototype,"ModelEquip",void 0),i([l.injectField("ModelEquipSynthesis")],e.prototype,"ModelEquipSynthesis",void 0),e}(t("../../../../../../framework/expr/ExprVarBase").ExprVarBase);r.RDEquipBag=s,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../../../../../framework/expr/ExprVarBase":void 0}],RDHeroRewards:[function(t,e,r){"use strict";cc._RF.push(e,"452b1rNRMZMHbZ0jTFSlqOj","RDHeroRewards");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RDHeroRewards=void 0;var i=t("../../../../../generated/netProto/CmdInterface"),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetRedDotType=function(){return i.CmdRedDotType.HERO_TASK},e.__cname="RDHeroRewards",e}(t("./RDServerBase").RDServerBase);r.RDHeroRewards=a,cc._RF.pop()},{"../../../../../generated/netProto/CmdInterface":"CmdInterface","./RDServerBase":"RDServerBase"}],RDInformation:[function(t,e,r){"use strict";cc._RF.push(e,"a17b2vbBghLoJwlou9pKwXq","RDInformation");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.RDInformation=void 0;var a=t("../../../../../framework/container/Container"),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnEnter=function(){},e.prototype.OnExit=function(){},e.prototype.OnComputeResult=function(){return 0},e.__cname="RDInformation",i([a.injectField("ModelVO")],e.prototype,"ModelVO",void 0),e}(t("../../../../../framework/expr/ExprVarBase").ExprVarBase);r.RDInformation=l,cc._RF.pop()},{"../../../../../framework/container/Container":void 0,"../../../../../framework/expr/ExprVarBase":void 0}],RDLuckDraw:[function(t,e,r){"use strict";cc._RF.push(e,"fbb7e3swvpLBZZqsubWajZA","RDLuckDraw");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.RDLuckDraw=void 0;var l=t("../../../../../../framework/container/Container"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnEnter=function(){var t=this;this.toolSet.addCallback(this.ModelMgr.ModelMallLuckDraw.updateRed,function(){t.MarkDirty()}),this.MarkDirty()},e.prototype.OnExit=function(){},e.prototype.GetLuckDrawRDResult=function(){var t,e,r=!1,o=this.ModelMgr.ModelMallLuckDraw.GetLuckDrawRefInfo();try{for(var n=a(o),i=n.next();!i.done;i=n.next()){var l=i.value,s=3600*l.cdTime,c=this.TimeUtil.now()-this.ModelMgr.ModelMallLuckDraw.GetLuckDrawFreeTime(l.id)/1e3<s,u=this.ModelMgr.ModelMallLuckDraw.GetCostItem(l.id),p=this.ModelMgr.ModelGoods.GetGoodsNumberByRefId(u[0].resId)>=u[0].number;if(!c||p){r=!0;break}}}catch(f){t={error:f}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}return r},e.prototype.OnComputeResult=function(){return this.GetLuckDrawRDResult()},e.__cname="RDLuckDraw",i([l.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([l.injectField("TimeUtil")],e.prototype,"TimeUtil",void 0),e}(t("../../../../../../framework/expr/ExprVarBase").ExprVarBase);r.RDLuckDraw=s,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../../../../../framework/expr/ExprVarBase":void 0}],RDLuckyCat:[function(t,e,r){"use strict";cc._RF.push(e,"b3436Jlg5RKKaP2tmbQLYx1","RDLuckyCat");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.RDLuckyCat=void 0;var a=t("../../../../../framework/container/Container"),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnEnter=function(){var t=this;this.toolSet.addListener(this.ModelMgr.ModelVO.VOLuckyCatBag.GetEventProxy(),"OnChanged",function(){t.MarkDirty()})},e.prototype.OnExit=function(){},e.prototype.OnComputeResult=function(){var t=this.ModelMgr.ModelVO.VOLuckyCatBag.GetOne();if(null==t)return 0;var e=t.GetRef().last;return t.GetProcess()>=e?1:0},e.__cname="RDLuckyCat",i([a.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(t("../../../../../framework/expr/ExprVarBase").ExprVarBase);r.RDLuckyCat=l,cc._RF.pop()},{"../../../../../framework/container/Container":void 0,"../../../../../framework/expr/ExprVarBase":void 0}],RDMall:[function(t,e,r){"use strict";cc._RF.push(e,"d6de4pAdJpMS7/u7UuOmXNE","RDMall");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.RDMall=void 0;var l=t("../../../../../../framework/container/Container"),s=t("../../../../../../framework/expr/ExprVarBase"),c=t("../../../mall/ModelMall"),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnEnter=function(){var t=this;this.subSet=this.ModelMgr.ModelVO.VOItemBag.CreateSubset(),this.subSet.SetFilter(function(t){return!(!t||!c.LuckDrawPropSet.has(t.GetRefId())&&!c.SEquipDrawPropSet.has(t.GetRefId()))}),this.toolSet.addListener(this.subSet.GetEventProxy(),"OnChanged",function(){t.MarkDirty()}),this.toolSet.addCallback(this.ModelMgr.ModelMallDailyShop.updateRed,function(){t.MarkDirty()}),this.toolSet.addCallback(this.ModelMgr.ModelMallGloden.updateRed,function(){t.MarkDirty()}),this.toolSet.addCallback(this.ModelMgr.ModelMallLuckDraw.updateRed,function(){t.MarkDirty()}),this.toolSet.addDefer(function(){t.ModelMgr.ModelVO.VOItemBag.DestroySubset(t.subSet),t.subSet=null}),this.MarkDirty()},e.prototype.OnExit=function(){},e.prototype.GetGlodenRDResult=function(){var t,e,r,o=0;try{for(var n=a((null===(r=this.ModelMallGloden.GetCmdMallData())||void 0===r?void 0:r.GetMallCoin())||[]),i=n.next();!i.done;i=n.next()){var l=i.value;l.buyCount<this.ModelMallGloden.GetCoinDataByResId(l.resId).number&&(o+=1)}}catch(s){t={error:s}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}return o},e.prototype.GetDailyShopRDResult=function(){var t,e,r=0,o=this.ModelMgr.ModelMallDailyShop.GetDailyShopRefData();try{for(var n=a(o),i=n.next();!i.done;i=n.next()){var l=i.value,s=60*l.cdTimes,c=l.number;if(0!=c){var u=this.TimeUtil.now(),p=this.ModelMgr.ModelMallDailyShop.GetDailyShopBuyCountByResId(l.id),f=this.ModelMgr.ModelMallDailyShop.GetDailyShopAdTimeByResId(l.id)/1e3;p<c&&!(u-f<s)&&(r+=1)}}}catch(h){t={error:h}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}return r},e.prototype.GetLuckDrawRDResult=function(){var t,e,r=0,o=this.ModelMgr.ModelMallLuckDraw.GetLuckDrawRefInfo();try{for(var n=a(o),i=n.next();!i.done;i=n.next()){var l=i.value,s=l.cdTime*this.TimeUtil.S_DayTime,c=this.TimeUtil.now()-this.ModelMgr.ModelMallLuckDraw.GetLuckDrawFreeTime(l.id)/1e3<s,u=this.ModelMgr.ModelMallLuckDraw.GetCostItem(l.id),p=this.ModelMgr.ModelGoods.GetGoodsNumberByRefId(u[0].resId)>=u[0].number;c&&!p||(r+=1)}}catch(f){t={error:f}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}return r},e.prototype.GetSEquipRDResult=function(){var t,e,r=0,o=this.ModelMgr.ModelMallSEquip.GetOpenDrawInfo();try{for(var n=a(o.values()),i=n.next();!i.done;i=n.next()){var l=i.value.costItem;this.ModelMgr.ModelGoods.GetGoodsNumberByRefId(l[0].resId)>=l[0].number&&(r+=1)}}catch(s){t={error:s}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}return r},e.prototype.OnComputeResult=function(){return this.GetGlodenRDResult()+this.GetDailyShopRDResult()+this.GetLuckDrawRDResult()+this.GetSEquipRDResult()},e.__cname="RDMall",i([l.injectField("ModelMallGloden")],e.prototype,"ModelMallGloden",void 0),i([l.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([l.injectField("TimeUtil")],e.prototype,"TimeUtil",void 0),e}(s.ExprVarBase);r.RDMall=u,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../../../../../framework/expr/ExprVarBase":void 0,"../../../mall/ModelMall":"ModelMall"}],RDMonthCard:[function(t,e,r){"use strict";cc._RF.push(e,"8a75fn4bTVCtbJkuU+MvhXp","RDMonthCard");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RDMonthCard=void 0;var i=t("../../../../../generated/netProto/CmdInterface"),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetRedDotType=function(){return i.CmdRedDotType.MONTH_CARD},e.__cname="RDMonthCard",e}(t("./RDServerBase").RDServerBase);r.RDMonthCard=a,cc._RF.pop()},{"../../../../../generated/netProto/CmdInterface":"CmdInterface","./RDServerBase":"RDServerBase"}],RDNewPlayerSignIn:[function(t,e,r){"use strict";cc._RF.push(e,"80d87lUIfFO/oZNn0yZFmKI","RDNewPlayerSignIn");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.RDNewPlayerSignIn=void 0;var a=t("../../../../../../framework/container/Container"),l=t("../../../../../../framework/expr/ExprVarBase"),s=t("../../../Activity/ModelActivity"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnEnter=function(){var t=this;this.newPlayerSignInChallSubSet=this.ModelMgr.ModelVO.ActivityBag.CreateSubset(),this.newPlayerSignInChallSubSet.SetFilter(function(t){return null!=t&&t.GetActivityKind()==s.EnumActivityKind.NewPlayerSign}),this.toolSet.addListener(this.newPlayerSignInChallSubSet.GetEventProxy(),"OnChanged",function(){t.MarkDirty()}),this.toolSet.addListener(this.ModelMgr.ModelActivity.eventProxy,"OnUpdate",function(){t.MarkDirty()}),this.toolSet.addDefer(function(){t.ModelMgr.ModelVO.ActivityBag.DestroySubset(t.newPlayerSignInChallSubSet),t.newPlayerSignInChallSubSet=null}),this.MarkDirty()},e.prototype.OnExit=function(){},e.prototype.GetSignResult=function(t){return t.some(function(t){return 1==t.rewardState})},e.prototype.OnComputeResult=function(){var t=this.newPlayerSignInChallSubSet.GetOneVO();if(null==t)return!1;var e=t.GetDeTail().cmdActivityNewPlayerSignDetail.cmdActivityNewPlayerSignRewardState||[];return this.GetSignResult(e)},e.__cname="RDNewPlayerSignIn",i([a.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(l.ExprVarBase);r.RDNewPlayerSignIn=c,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../../../../../framework/expr/ExprVarBase":void 0,"../../../Activity/ModelActivity":"ModelActivity"}],RDPropBag:[function(t,e,r){"use strict";cc._RF.push(e,"f549bYNN6ZJUK5ElRIU7LXd","RDPropBag");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RDPropBag=void 0;var i=t("../../../vo/Goods/Goods"),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetGoodsBag=function(){return this.ModelMgr.ModelVO.VOItemBag},e.prototype.GetTlShowBagType=function(){return[i.ShowBagType.itemBag_prop]},e.__cname="RDPropBag",e}(t("./RDGoodsBagNewBase").RDGoodsBagNewBase);r.RDPropBag=a,cc._RF.pop()},{"../../../vo/Goods/Goods":"Goods","./RDGoodsBagNewBase":"RDGoodsBagNewBase"}],RDRuneBag:[function(t,e,r){"use strict";cc._RF.push(e,"348d0NmW4pH3JxE2Rf1ZURY","RDRuneBag");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RDRuneBag=void 0;var i=t("../../../vo/Goods/Goods"),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetGoodsBag=function(){return this.ModelMgr.ModelVO.VORuneBag},e.prototype.GetTlShowBagType=function(){return[i.ShowBagType.runeBag]},e.__cname="RDRuneBag",e}(t("./RDGoodsBagNewBase").RDGoodsBagNewBase);r.RDRuneBag=a,cc._RF.pop()},{"../../../vo/Goods/Goods":"Goods","./RDGoodsBagNewBase":"RDGoodsBagNewBase"}],RDRuneSynthesis:[function(t,e,r){"use strict";cc._RF.push(e,"1acfdJmZJFP1rCCIODIg/n6","RDRuneSynthesis");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.RDRuneSynthesis=void 0;var a=t("../../../../../../framework/container/Container"),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnEnter=function(){var t=this;this.toolSet.addCallback(this.ModelRune.updateRuneSynthesisRd,function(){t.MarkDirty()}),this.MarkDirty()},e.prototype.OnExit=function(){},e.prototype.OnComputeResult=function(){return this.ModelRune.GetSynthesisMap().size>0},e.__cname="RDRuneSynthesis",i([a.injectField("ModelRune")],e.prototype,"ModelRune",void 0),e}(t("../../../../../../framework/expr/ExprVarBase").ExprVarBase);r.RDRuneSynthesis=l,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../../../../../framework/expr/ExprVarBase":void 0}],RDSEquip:[function(t,e,r){"use strict";cc._RF.push(e,"4e186a/wshIpavcAA6TE38w","RDSEquip");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.RDSEquip=void 0;var l=t("../../../../../../framework/container/Container"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnEnter=function(){var t=this;this.toolSet.addCallback(this.ModelMgr.ModelMallSEquip.updateRed,function(){t.MarkDirty()}),this.MarkDirty()},e.prototype.OnExit=function(){},e.prototype.GetSEquipRDResult=function(){var t,e,r=!1,o=this.ModelMgr.ModelMallSEquip.GetOpenDrawInfo();try{for(var n=a(o.values()),i=n.next();!i.done;i=n.next()){var l=i.value.costItem;if(this.ModelMgr.ModelGoods.GetGoodsNumberByRefId(l[0].resId)>=l[0].number){r=!0;break}}}catch(s){t={error:s}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}return r},e.prototype.OnComputeResult=function(){return this.GetSEquipRDResult()},e.__cname="RDSEquip",i([l.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(t("../../../../../../framework/expr/ExprVarBase").ExprVarBase);r.RDSEquip=s,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../../../../../framework/expr/ExprVarBase":void 0}],RDServerBase:[function(t,e,r){"use strict";cc._RF.push(e,"8220aPVlJpBfK/ZJ6dfVhI6","RDServerBase");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.RDServerBase=void 0;var a=t("../../../../../../framework/container/Container"),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnEnter=function(){this.CheckSubSet(),this.MarkDirty()},e.prototype.OnExit=function(){this.subSet&&(this.ModelVO.VOServerRDBag.DestroySubset(this.subSet),this.subSet=null)},e.prototype.OnComputeResult=function(){this.CheckSubSet();var t=this.subSet.GetOneVO();return t&&t.GetNumber()||0},e.prototype.CheckSubSet=function(){var t=this;null==this.subSet&&(this.subSet=this.ModelVO.VOServerRDBag.CreateSubset(),this.subSet.SetFilter(function(e){return e.GetRedDotType()==t.GetRedDotType()}),this.toolSet.addListener(this.subSet.GetEventProxy(),"OnChanged",function(){t.MarkDirty()}))},e.__cname="RDServerBase",i([a.injectField("ModelVO")],e.prototype,"ModelVO",void 0),e}(t("../../../../../../framework/expr/ExprVarBase").ExprVarBase);r.RDServerBase=l,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../../../../../framework/expr/ExprVarBase":void 0}],RDSevenDayChallenge:[function(t,e,r){"use strict";cc._RF.push(e,"802d7xtifhJGKht772cytiq","RDSevenDayChallenge");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.RDSevenDayChallenge=void 0;var a=t("../../../../../../framework/container/Container"),l=t("../../../../../../framework/expr/ExprVarBase"),s=t("../../../Activity/ModelActivity"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnEnter=function(){var t=this;this.sevenDayChallSubSet=this.ModelMgr.ModelVO.ActivityBag.CreateSubset(),this.sevenDayChallSubSet.SetFilter(function(t){return t.GetActivityKind()==s.EnumActivityKind.SevenDay}),this.toolSet.addListener(this.sevenDayChallSubSet.GetEventProxy(),"OnChanged",function(){t.MarkDirty()}),this.toolSet.addListener(this.ModelMgr.ModelActivity.eventProxy,"OnUpdate",function(){t.MarkDirty()}),this.toolSet.addDefer(function(){t.ModelMgr.ModelVO.ActivityBag.DestroySubset(t.sevenDayChallSubSet),t.sevenDayChallSubSet=null}),this.MarkDirty()},e.prototype.GetBoxResult=function(t){return t.some(function(t){return 1==t.state})},e.prototype.GetQuestResult=function(t,e){return t.some(function(t){var r=t.day,o=t.cmdActivitySevenDaysQuestOfDay;return e>=r&&o.some(function(t){return 1==t.state})})},e.prototype.OnComputeResult=function(){var t=this.sevenDayChallSubSet.GetOneVO();if(!t)return!1;var e=t.GetDeTail(),r=e.cmdActivitySevenDaysDetail.boxData||[],o=e.cmdActivitySevenDaysDetail.questData||[],n=e.cmdActivitySevenDaysDetail.days,i=this.GetBoxResult(r),a=this.GetQuestResult(o,n);return i||a},e.__cname="RDSevenDayChallenge",i([a.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(l.ExprVarBase);r.RDSevenDayChallenge=c,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../../../../../framework/expr/ExprVarBase":void 0,"../../../Activity/ModelActivity":"ModelActivity"}],RDWeeklyRewards:[function(t,e,r){"use strict";cc._RF.push(e,"1f178iMdnFLkYW2/1C+6mPD","RDWeeklyRewards");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RDWeeklyRewards=void 0;var i=t("../../../../../generated/netProto/CmdInterface"),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetRedDotType=function(){return i.CmdRedDotType.WEEKLY_TASK},e.__cname="RDWeeklyRewards",e}(t("./RDServerBase").RDServerBase);r.RDWeeklyRewards=a,cc._RF.pop()},{"../../../../../generated/netProto/CmdInterface":"CmdInterface","./RDServerBase":"RDServerBase"}],RDXiuLianBag:[function(t,e,r){"use strict";cc._RF.push(e,"5f8daQKWmJNV50paXZ81Sf9","RDXiuLianBag");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RDXiulianBag=void 0;var i=t("../../../vo/Goods/Goods"),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetGoodsBag=function(){return this.ModelMgr.ModelVO.VOItemBag},e.prototype.GetTlShowBagType=function(){return[i.ShowBagType.itemBag_prop,i.ShowBagType.itemBag_consumables]},e.__cname="RDXiulianBag",e}(t("./RDGoodsBagNewBase").RDGoodsBagNewBase);r.RDXiulianBag=a,cc._RF.pop()},{"../../../vo/Goods/Goods":"Goods","./RDGoodsBagNewBase":"RDGoodsBagNewBase"}],RDXiulianMail:[function(t,e,r){"use strict";cc._RF.push(e,"33eafY6NYtDqLERfSEpf9E4","RDXiulianMail");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RDXiulianMail=void 0;var i=t("../../../../../generated/netProto/CmdInterface"),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetRedDotType=function(){return i.CmdRedDotType.MAIL},e.__cname="RDXiulianMail",e}(t("./RDServerBase").RDServerBase);r.RDXiulianMail=a,cc._RF.pop()},{"../../../../../generated/netProto/CmdInterface":"CmdInterface","./RDServerBase":"RDServerBase"}],RDXiulianOnHook:[function(t,e,r){"use strict";cc._RF.push(e,"b94f3e1iIJL8Y/dw/0Ij52/","RDXiulianOnHook");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.RDXiulianOnHook=void 0;var a=t("../../../../../framework/container/Container"),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnEnter=function(){var t=this;this.subset=this.ModelVO.VORoleBag.CreateSubset(),this.subset.SetFilter(function(){return!0}),this.toolSet.addCallback(this.ModelHangling.updateRed,function(){t.MarkDirty()}),this.toolSet.addDefer(function(){t.ModelVO.VORoleBag.DestroySubset(t.subset),t.subset=null}),this.MarkDirty()},e.prototype.OnComputeResult=function(){var t=this.subset.GetOneVO().GetHangTime()/1e3;return this.TimeUtil.now()-t>=this.TimeUtil.S_DayTime},e.__cname="RDXiulianOnHook",i([a.injectField("ModelHangling")],e.prototype,"ModelHangling",void 0),i([a.injectField("ModelVO")],e.prototype,"ModelVO",void 0),i([a.injectField("TimeUtil")],e.prototype,"TimeUtil",void 0),e}(t("../../../../../framework/expr/ExprVarBase").ExprVarBase);r.RDXiulianOnHook=l,cc._RF.pop()},{"../../../../../framework/container/Container":void 0,"../../../../../framework/expr/ExprVarBase":void 0}],RefBase:[function(t,e,r){"use strict";cc._RF.push(e,"bba0bbCxslFR6ThK5ZhbQVs","RefBase");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RefMgrchapterMonsterBase=r.RefMgrchapterBuffBase=r.RefMgrchapterBoxBase=r.RefMgrbuyStaBase=r.RefMgrbuffCarrierBase=r.RefMgrbuffBase=r.RefMgrbreachSkillBase=r.RefMgrbreachAttributeBase=r.RefMgrboxContentBase=r.RefMgrboxBase=r.RefMgrbigNumBase=r.RefMgrbattleWaveTypeBase=r.RefMgrbattleWaveRefBase=r.RefMgrbattleWavePlanRefBase=r.RefMgrbattleWaveNumRefBase=r.RefMgrbattleSupplyRefBase=r.RefMgrbattleSupplyLevelRefBase=r.RefMgrbattleSkillTypeMonsterBase=r.RefMgrbattleSkillRefBase=r.RefMgrbattleSkillMonsterBase=r.RefMgrbattleSkillLevelBase=r.RefMgrbattleSkillEvolutionRefBase=r.RefMgrbattleSkillChestRefBase=r.RefMgrbattleSkillBehaviorRefBase=r.RefMgrbattleMonsterRefBase=r.RefMgrbattleMonsterBehaviorBase=r.RefMgrbattleLevelRefBase=r.RefMgrbattleLauncherBase=r.RefMgrbattleEquipDrawingRefBase=r.RefMgrbattleDropRefBase=r.RefMgrbattleDropPlanRefBase=r.RefMgrbattleDropConfigBase=r.RefMgrbattleConfigBase=r.RefMgrbattleChestRewardRefBase=r.RefMgrbattleChestRefBase=r.RefMgrbattleBulletTagCollisionBase=r.RefMgrbattleBulletBase=r.RefMgrbattleBoxDropPlanBase=r.RefMgrbattleBehaviorTemplateRefBase=r.RefMgraudioConfigBase=r.RefMgractivityOpenBase=r.RefMgractivityBase=r.RefMgractiveSevenPlanBase=r.RefMgractiveSevenMissionBase=r.RefMgractiveRechargeDayRewardBase=r.RefMgractiveRechargeDayPlanBase=r.RefMgractiveProcessBase=r.RefMgractiveNewPlayerSignBase=r.RefMgrachieveTaskBase=r.RefMgrBattleStatusIconBase=void 0,r.RefMgrluckDrawBase=r.RefMgrlimitSEquipRewardBase=r.RefMgrlevelBase=r.RefMgrjumpLayerBase=r.RefMgritemTypeBase=r.RefMgritemBase=r.RefMgridConfigBase=r.RefMgriconBase=r.RefMgrheroUnlockBase=r.RefMgrheroSkillBase=r.RefMgrheroShowGetBase=r.RefMgrheroPassiveSkillBase=r.RefMgrheroLevelBase=r.RefMgrheroAudioBase=r.RefMgrheroAnimationBase=r.RefMgrheroBase=r.RefMgrheadBase=r.RefMgrhangingBase=r.RefMgrhallConfigBase=r.RefMgrguidingTaskBase=r.RefMgrgotoBase=r.RefMgrgoodsBase=r.RefMgrgiftChapterBase=r.RefMgrgeneralMaterialsBase=r.RefMgrgameRuleBase=r.RefMgrgameConfigBase=r.RefMgrfundTypePlanBase=r.RefMgrfundRewardBase=r.RefMgrfundBase=r.RefMgrfuBenRefBase=r.RefMgrfuBenGoldPlanBase=r.RefMgrfuBenDailyRewardBase=r.RefMgrfuBenDailyPlanBase=r.RefMgrfuBenCanUseSkillGroupRefBase=r.RefMgrfirstRechargeBase=r.RefMgreveryDaySignInDayGiftBase=r.RefMgreveryDaySignInCountGiftBase=r.RefMgrequipBase=r.RefMgrenhanceConsumeBase=r.RefMgrenhanceBase=r.RefMgrdayWeekMonthGiftConfigBase=r.RefMgrdayWeekMonthGiftBase=r.RefMgrdailyTaskBase=r.RefMgrdailyRechargePlanBase=r.RefMgrconsumeGiftPlanBase=r.RefMgrcodeBase=r.RefMgrchapterSkillBase=r.RefMgrchapterRewardBase=r.RefMgrchapterRefBase=r.RefMgrchapterMonsterStrongBase=void 0,r.RefMgrtaskRewardBase=r.RefMgrtaskConfigBase=r.RefMgrtaskBase=r.RefMgrsynthesisBase=r.RefMgrspecialGiftBase=r.RefMgrskillLauncherBase=r.RefMgrskillGroupBase=r.RefMgrshowSkillBase=r.RefMgrshareIconBase=r.RefMgrsEquipRewardBase=r.RefMgrsEquipBase=r.RefMgrruneSynthesisBase=r.RefMgrruneQualitySkillBase=r.RefMgrruneEnhanceBase=r.RefMgrruneBase=r.RefMgrroleAttributeBase=r.RefMgrressoldierqualityBase=r.RefMgrresskillqualityBase=r.RefMgrresitemqualityBase=r.RefMgrresheroqualityBase=r.RefMgrresequipqualityBase=r.RefMgrresbuildqualityBase=r.RefMgrrefAllConfigBase=r.RefMgrqualitySkillBase=r.RefMgrpowerRankRewardBase=r.RefMgrpopularityRankRewardBase=r.RefMgrplotBase=r.RefMgrplayOpenBase=r.RefMgrpayChannelBase=r.RefMgropenBase=r.RefMgrnoticeIconBase=r.RefMgrmysteriousStorePlanBase=r.RefMgrmonthCardBase=r.RefMgrmonthBuffBase=r.RefMgrmoneyDrawRewardBase=r.RefMgrmodelRefBase=r.RefMgrmapRefBase=r.RefMgrmallModuleBase=r.RefMgrmallDailyShopRewardBase=r.RefMgrmallDailyShopDiscountBase=r.RefMgrmallDailyShopBase=r.RefMgrmallCoinRewardBase=r.RefMgrmallCoinBase=r.RefMgrmallChargeBase=r.RefMgrmallChapterGiftRewardBase=r.RefMgrmallChapterGiftBase=r.RefMgrmailContentBase=r.RefMgrmLBase=r.RefMgrluckyCatRewardBase=r.RefMgrluckDrawRewardBase=void 0,r.RefMgrweeklyTaskBase=r.RefMgrvirtueRankRewardBase=void 0;var i=t("../../../framework/ref/RefMgrBase"),a=function(){function t(){}return Object.defineProperty(t.prototype,"RefMgrBattleStatusIcon",{get:function(){return this._RefMgrBattleStatusIcon||(this._RefMgrBattleStatusIcon=new l),this._RefMgrBattleStatusIcon},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrachieveTask",{get:function(){return this._RefMgrachieveTask||(this._RefMgrachieveTask=new s),this._RefMgrachieveTask},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgractiveNewPlayerSign",{get:function(){return this._RefMgractiveNewPlayerSign||(this._RefMgractiveNewPlayerSign=new c),this._RefMgractiveNewPlayerSign},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgractiveProcess",{get:function(){return this._RefMgractiveProcess||(this._RefMgractiveProcess=new u),this._RefMgractiveProcess},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgractiveRechargeDayPlan",{get:function(){return this._RefMgractiveRechargeDayPlan||(this._RefMgractiveRechargeDayPlan=new p),this._RefMgractiveRechargeDayPlan},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgractiveRechargeDayReward",{get:function(){return this._RefMgractiveRechargeDayReward||(this._RefMgractiveRechargeDayReward=new f),this._RefMgractiveRechargeDayReward},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgractiveSevenMission",{get:function(){return this._RefMgractiveSevenMission||(this._RefMgractiveSevenMission=new h),this._RefMgractiveSevenMission},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgractiveSevenPlan",{get:function(){return this._RefMgractiveSevenPlan||(this._RefMgractiveSevenPlan=new y),this._RefMgractiveSevenPlan},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgractivity",{get:function(){return this._RefMgractivity||(this._RefMgractivity=new d),this._RefMgractivity},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgractivityOpen",{get:function(){return this._RefMgractivityOpen||(this._RefMgractivityOpen=new m),this._RefMgractivityOpen},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgraudioConfig",{get:function(){return this._RefMgraudioConfig||(this._RefMgraudioConfig=new v),this._RefMgraudioConfig},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrbattleBehaviorTemplateRef",{get:function(){return this._RefMgrbattleBehaviorTemplateRef||(this._RefMgrbattleBehaviorTemplateRef=new _),this._RefMgrbattleBehaviorTemplateRef},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrbattleBoxDropPlan",{get:function(){return this._RefMgrbattleBoxDropPlan||(this._RefMgrbattleBoxDropPlan=new S),this._RefMgrbattleBoxDropPlan},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrbattleBullet",{get:function(){return this._RefMgrbattleBullet||(this._RefMgrbattleBullet=new g),this._RefMgrbattleBullet},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrbattleBulletTagCollision",{get:function(){return this._RefMgrbattleBulletTagCollision||(this._RefMgrbattleBulletTagCollision=new b),this._RefMgrbattleBulletTagCollision},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrbattleChestRef",{get:function(){return this._RefMgrbattleChestRef||(this._RefMgrbattleChestRef=new C),this._RefMgrbattleChestRef},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrbattleChestRewardRef",{get:function(){return this._RefMgrbattleChestRewardRef||(this._RefMgrbattleChestRewardRef=new R),this._RefMgrbattleChestRewardRef},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrbattleConfig",{get:function(){return this._RefMgrbattleConfig||(this._RefMgrbattleConfig=new M),this._RefMgrbattleConfig},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrbattleDropConfig",{get:function(){return this._RefMgrbattleDropConfig||(this._RefMgrbattleDropConfig=new w),this._RefMgrbattleDropConfig},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrbattleDropPlanRef",{get:function(){return this._RefMgrbattleDropPlanRef||(this._RefMgrbattleDropPlanRef=new O),this._RefMgrbattleDropPlanRef},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrbattleDropRef",{get:function(){return this._RefMgrbattleDropRef||(this._RefMgrbattleDropRef=new B),this._RefMgrbattleDropRef},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrbattleEquipDrawingRef",{get:function(){return this._RefMgrbattleEquipDrawingRef||(this._RefMgrbattleEquipDrawingRef=new P),this._RefMgrbattleEquipDrawingRef},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrbattleLauncher",{get:function(){return this._RefMgrbattleLauncher||(this._RefMgrbattleLauncher=new G),this._RefMgrbattleLauncher},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrbattleLevelRef",{get:function(){return this._RefMgrbattleLevelRef||(this._RefMgrbattleLevelRef=new k),this._RefMgrbattleLevelRef},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrbattleMonsterBehavior",{get:function(){return this._RefMgrbattleMonsterBehavior||(this._RefMgrbattleMonsterBehavior=new x),this._RefMgrbattleMonsterBehavior},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrbattleMonsterRef",{get:function(){return this._RefMgrbattleMonsterRef||(this._RefMgrbattleMonsterRef=new T),this._RefMgrbattleMonsterRef},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrbattleSkillBehaviorRef",{get:function(){return this._RefMgrbattleSkillBehaviorRef||(this._RefMgrbattleSkillBehaviorRef=new j),this._RefMgrbattleSkillBehaviorRef},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrbattleSkillChestRef",{get:function(){return this._RefMgrbattleSkillChestRef||(this._RefMgrbattleSkillChestRef=new I),this._RefMgrbattleSkillChestRef},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrbattleSkillEvolutionRef",{get:function(){return this._RefMgrbattleSkillEvolutionRef||(this._RefMgrbattleSkillEvolutionRef=new D),this._RefMgrbattleSkillEvolutionRef},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrbattleSkillLevel",{get:function(){return this._RefMgrbattleSkillLevel||(this._RefMgrbattleSkillLevel=new F),this._RefMgrbattleSkillLevel},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrbattleSkillMonster",{get:function(){return this._RefMgrbattleSkillMonster||(this._RefMgrbattleSkillMonster=new L),this._RefMgrbattleSkillMonster},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrbattleSkillRef",{get:function(){return this._RefMgrbattleSkillRef||(this._RefMgrbattleSkillRef=new E),this._RefMgrbattleSkillRef},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrbattleSkillTypeMonster",{get:function(){return this._RefMgrbattleSkillTypeMonster||(this._RefMgrbattleSkillTypeMonster=new A),this._RefMgrbattleSkillTypeMonster},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrbattleSupplyLevelRef",{get:function(){return this._RefMgrbattleSupplyLevelRef||(this._RefMgrbattleSupplyLevelRef=new V),this._RefMgrbattleSupplyLevelRef},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrbattleSupplyRef",{get:function(){return this._RefMgrbattleSupplyRef||(this._RefMgrbattleSupplyRef=new U),this._RefMgrbattleSupplyRef},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrbattleWaveNumRef",{get:function(){return this._RefMgrbattleWaveNumRef||(this._RefMgrbattleWaveNumRef=new W),this._RefMgrbattleWaveNumRef},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrbattleWavePlanRef",{get:function(){return this._RefMgrbattleWavePlanRef||(this._RefMgrbattleWavePlanRef=new H),this._RefMgrbattleWavePlanRef},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrbattleWaveRef",{get:function(){return this._RefMgrbattleWaveRef||(this._RefMgrbattleWaveRef=new N),this._RefMgrbattleWaveRef},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrbattleWaveType",{get:function(){return this._RefMgrbattleWaveType||(this._RefMgrbattleWaveType=new q),this._RefMgrbattleWaveType},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrbigNum",{get:function(){return this._RefMgrbigNum||(this._RefMgrbigNum=new K),this._RefMgrbigNum},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrbox",{get:function(){return this._RefMgrbox||(this._RefMgrbox=new X),this._RefMgrbox},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrboxContent",{get:function(){return this._RefMgrboxContent||(this._RefMgrboxContent=new z),this._RefMgrboxContent},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrbreachAttribute",{get:function(){return this._RefMgrbreachAttribute||(this._RefMgrbreachAttribute=new J),this._RefMgrbreachAttribute},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrbreachSkill",{get:function(){return this._RefMgrbreachSkill||(this._RefMgrbreachSkill=new Y),this._RefMgrbreachSkill},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrbuff",{get:function(){return this._RefMgrbuff||(this._RefMgrbuff=new Z),this._RefMgrbuff},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrbuffCarrier",{get:function(){return this._RefMgrbuffCarrier||(this._RefMgrbuffCarrier=new Q),this._RefMgrbuffCarrier},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrbuySta",{get:function(){return this._RefMgrbuySta||(this._RefMgrbuySta=new $),this._RefMgrbuySta},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrchapterBox",{get:function(){return this._RefMgrchapterBox||(this._RefMgrchapterBox=new tt),this._RefMgrchapterBox},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrchapterBuff",{get:function(){return this._RefMgrchapterBuff||(this._RefMgrchapterBuff=new et),this._RefMgrchapterBuff},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrchapterMonster",{get:function(){return this._RefMgrchapterMonster||(this._RefMgrchapterMonster=new rt),this._RefMgrchapterMonster},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrchapterMonsterStrong",{get:function(){return this._RefMgrchapterMonsterStrong||(this._RefMgrchapterMonsterStrong=new ot),this._RefMgrchapterMonsterStrong},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrchapterRef",{get:function(){return this._RefMgrchapterRef||(this._RefMgrchapterRef=new nt),this._RefMgrchapterRef},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrchapterReward",{get:function(){return this._RefMgrchapterReward||(this._RefMgrchapterReward=new it),this._RefMgrchapterReward},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrchapterSkill",{get:function(){return this._RefMgrchapterSkill||(this._RefMgrchapterSkill=new at),this._RefMgrchapterSkill},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrcode",{get:function(){return this._RefMgrcode||(this._RefMgrcode=new lt),this._RefMgrcode},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrconsumeGiftPlan",{get:function(){return this._RefMgrconsumeGiftPlan||(this._RefMgrconsumeGiftPlan=new st),this._RefMgrconsumeGiftPlan},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrdailyRechargePlan",{get:function(){return this._RefMgrdailyRechargePlan||(this._RefMgrdailyRechargePlan=new ct),this._RefMgrdailyRechargePlan},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrdailyTask",{get:function(){return this._RefMgrdailyTask||(this._RefMgrdailyTask=new ut),this._RefMgrdailyTask},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrdayWeekMonthGift",{get:function(){return this._RefMgrdayWeekMonthGift||(this._RefMgrdayWeekMonthGift=new pt),this._RefMgrdayWeekMonthGift},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrdayWeekMonthGiftConfig",{get:function(){return this._RefMgrdayWeekMonthGiftConfig||(this._RefMgrdayWeekMonthGiftConfig=new ft),this._RefMgrdayWeekMonthGiftConfig},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrenhance",{get:function(){return this._RefMgrenhance||(this._RefMgrenhance=new ht),this._RefMgrenhance},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrenhanceConsume",{get:function(){return this._RefMgrenhanceConsume||(this._RefMgrenhanceConsume=new yt),this._RefMgrenhanceConsume},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrequip",{get:function(){return this._RefMgrequip||(this._RefMgrequip=new dt),this._RefMgrequip},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgreveryDaySignInCountGift",{get:function(){return this._RefMgreveryDaySignInCountGift||(this._RefMgreveryDaySignInCountGift=new mt),this._RefMgreveryDaySignInCountGift},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgreveryDaySignInDayGift",{get:function(){return this._RefMgreveryDaySignInDayGift||(this._RefMgreveryDaySignInDayGift=new vt),this._RefMgreveryDaySignInDayGift},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrfirstRecharge",{get:function(){return this._RefMgrfirstRecharge||(this._RefMgrfirstRecharge=new _t),this._RefMgrfirstRecharge},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrfuBenCanUseSkillGroupRef",{get:function(){return this._RefMgrfuBenCanUseSkillGroupRef||(this._RefMgrfuBenCanUseSkillGroupRef=new St),this._RefMgrfuBenCanUseSkillGroupRef},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrfuBenDailyPlan",{get:function(){return this._RefMgrfuBenDailyPlan||(this._RefMgrfuBenDailyPlan=new gt),this._RefMgrfuBenDailyPlan},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrfuBenDailyReward",{get:function(){return this._RefMgrfuBenDailyReward||(this._RefMgrfuBenDailyReward=new bt),this._RefMgrfuBenDailyReward},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrfuBenGoldPlan",{get:function(){return this._RefMgrfuBenGoldPlan||(this._RefMgrfuBenGoldPlan=new Ct),this._RefMgrfuBenGoldPlan},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrfuBenRef",{get:function(){return this._RefMgrfuBenRef||(this._RefMgrfuBenRef=new Rt),this._RefMgrfuBenRef},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrfund",{get:function(){return this._RefMgrfund||(this._RefMgrfund=new Mt),this._RefMgrfund},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrfundReward",{get:function(){return this._RefMgrfundReward||(this._RefMgrfundReward=new wt),this._RefMgrfundReward},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrfundTypePlan",{get:function(){return this._RefMgrfundTypePlan||(this._RefMgrfundTypePlan=new Ot),this._RefMgrfundTypePlan},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrgameConfig",{get:function(){return this._RefMgrgameConfig||(this._RefMgrgameConfig=new Bt),this._RefMgrgameConfig},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrgameRule",{get:function(){return this._RefMgrgameRule||(this._RefMgrgameRule=new Pt),this._RefMgrgameRule},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrgeneralMaterials",{get:function(){return this._RefMgrgeneralMaterials||(this._RefMgrgeneralMaterials=new Gt),this._RefMgrgeneralMaterials},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrgiftChapter",{get:function(){return this._RefMgrgiftChapter||(this._RefMgrgiftChapter=new kt),this._RefMgrgiftChapter},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrgoods",{get:function(){return this._RefMgrgoods||(this._RefMgrgoods=new xt),this._RefMgrgoods},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrgoto",{get:function(){return this._RefMgrgoto||(this._RefMgrgoto=new Tt),this._RefMgrgoto},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrguidingTask",{get:function(){return this._RefMgrguidingTask||(this._RefMgrguidingTask=new jt),this._RefMgrguidingTask},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrhallConfig",{get:function(){return this._RefMgrhallConfig||(this._RefMgrhallConfig=new It),this._RefMgrhallConfig},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrhanging",{get:function(){return this._RefMgrhanging||(this._RefMgrhanging=new Dt),this._RefMgrhanging},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrhead",{get:function(){return this._RefMgrhead||(this._RefMgrhead=new Ft),this._RefMgrhead},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrhero",{get:function(){return this._RefMgrhero||(this._RefMgrhero=new Lt),this._RefMgrhero},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrheroAnimation",{get:function(){return this._RefMgrheroAnimation||(this._RefMgrheroAnimation=new Et),this._RefMgrheroAnimation},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrheroAudio",{get:function(){return this._RefMgrheroAudio||(this._RefMgrheroAudio=new At),this._RefMgrheroAudio},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrheroLevel",{get:function(){return this._RefMgrheroLevel||(this._RefMgrheroLevel=new Vt),this._RefMgrheroLevel},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrheroPassiveSkill",{get:function(){return this._RefMgrheroPassiveSkill||(this._RefMgrheroPassiveSkill=new Ut),this._RefMgrheroPassiveSkill},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrheroShowGet",{get:function(){return this._RefMgrheroShowGet||(this._RefMgrheroShowGet=new Wt),this._RefMgrheroShowGet},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrheroSkill",{get:function(){return this._RefMgrheroSkill||(this._RefMgrheroSkill=new Ht),this._RefMgrheroSkill},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrheroUnlock",{get:function(){return this._RefMgrheroUnlock||(this._RefMgrheroUnlock=new Nt),this._RefMgrheroUnlock},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgricon",{get:function(){return this._RefMgricon||(this._RefMgricon=new qt),this._RefMgricon},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgridConfig",{get:function(){return this._RefMgridConfig||(this._RefMgridConfig=new Kt),this._RefMgridConfig},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgritem",{get:function(){return this._RefMgritem||(this._RefMgritem=new Xt),this._RefMgritem},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgritemType",{get:function(){return this._RefMgritemType||(this._RefMgritemType=new zt),this._RefMgritemType},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrjumpLayer",{get:function(){return this._RefMgrjumpLayer||(this._RefMgrjumpLayer=new Jt),this._RefMgrjumpLayer},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrlevel",{get:function(){return this._RefMgrlevel||(this._RefMgrlevel=new Yt),this._RefMgrlevel},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrlimitSEquipReward",{get:function(){return this._RefMgrlimitSEquipReward||(this._RefMgrlimitSEquipReward=new Zt),this._RefMgrlimitSEquipReward},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrluckDraw",{get:function(){return this._RefMgrluckDraw||(this._RefMgrluckDraw=new Qt),this._RefMgrluckDraw},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrluckDrawReward",{get:function(){return this._RefMgrluckDrawReward||(this._RefMgrluckDrawReward=new $t),this._RefMgrluckDrawReward},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrluckyCatReward",{get:function(){return this._RefMgrluckyCatReward||(this._RefMgrluckyCatReward=new te),this._RefMgrluckyCatReward},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrmL",{get:function(){return this._RefMgrmL||(this._RefMgrmL=new ee),this._RefMgrmL},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrmailContent",{get:function(){return this._RefMgrmailContent||(this._RefMgrmailContent=new re),this._RefMgrmailContent},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrmallChapterGift",{get:function(){return this._RefMgrmallChapterGift||(this._RefMgrmallChapterGift=new oe),this._RefMgrmallChapterGift},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrmallChapterGiftReward",{get:function(){return this._RefMgrmallChapterGiftReward||(this._RefMgrmallChapterGiftReward=new ne),this._RefMgrmallChapterGiftReward},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrmallCharge",{get:function(){return this._RefMgrmallCharge||(this._RefMgrmallCharge=new ie),this._RefMgrmallCharge},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrmallCoin",{get:function(){return this._RefMgrmallCoin||(this._RefMgrmallCoin=new ae),this._RefMgrmallCoin},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrmallCoinReward",{get:function(){return this._RefMgrmallCoinReward||(this._RefMgrmallCoinReward=new le),this._RefMgrmallCoinReward},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrmallDailyShop",{get:function(){return this._RefMgrmallDailyShop||(this._RefMgrmallDailyShop=new se),this._RefMgrmallDailyShop},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrmallDailyShopDiscount",{get:function(){return this._RefMgrmallDailyShopDiscount||(this._RefMgrmallDailyShopDiscount=new ce),this._RefMgrmallDailyShopDiscount},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrmallDailyShopReward",{get:function(){return this._RefMgrmallDailyShopReward||(this._RefMgrmallDailyShopReward=new ue),this._RefMgrmallDailyShopReward},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrmallModule",{get:function(){return this._RefMgrmallModule||(this._RefMgrmallModule=new pe),this._RefMgrmallModule},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrmapRef",{get:function(){return this._RefMgrmapRef||(this._RefMgrmapRef=new fe),this._RefMgrmapRef},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrmodelRef",{get:function(){return this._RefMgrmodelRef||(this._RefMgrmodelRef=new he),this._RefMgrmodelRef},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrmoneyDrawReward",{get:function(){return this._RefMgrmoneyDrawReward||(this._RefMgrmoneyDrawReward=new ye),this._RefMgrmoneyDrawReward},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrmonthBuff",{get:function(){return this._RefMgrmonthBuff||(this._RefMgrmonthBuff=new de),this._RefMgrmonthBuff},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrmonthCard",{get:function(){return this._RefMgrmonthCard||(this._RefMgrmonthCard=new me),this._RefMgrmonthCard},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrmysteriousStorePlan",{get:function(){return this._RefMgrmysteriousStorePlan||(this._RefMgrmysteriousStorePlan=new ve),this._RefMgrmysteriousStorePlan},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrnoticeIcon",{get:function(){return this._RefMgrnoticeIcon||(this._RefMgrnoticeIcon=new _e),this._RefMgrnoticeIcon},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgropen",{get:function(){return this._RefMgropen||(this._RefMgropen=new Se),this._RefMgropen},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrpayChannel",{get:function(){return this._RefMgrpayChannel||(this._RefMgrpayChannel=new ge),this._RefMgrpayChannel},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrplayOpen",{get:function(){return this._RefMgrplayOpen||(this._RefMgrplayOpen=new be),this._RefMgrplayOpen},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrplot",{get:function(){return this._RefMgrplot||(this._RefMgrplot=new Ce),this._RefMgrplot},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrpopularityRankReward",{get:function(){return this._RefMgrpopularityRankReward||(this._RefMgrpopularityRankReward=new Re),this._RefMgrpopularityRankReward},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrpowerRankReward",{get:function(){return this._RefMgrpowerRankReward||(this._RefMgrpowerRankReward=new Me),this._RefMgrpowerRankReward},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrqualitySkill",{get:function(){return this._RefMgrqualitySkill||(this._RefMgrqualitySkill=new we),this._RefMgrqualitySkill},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrrefAllConfig",{get:function(){return this._RefMgrrefAllConfig||(this._RefMgrrefAllConfig=new Oe),this._RefMgrrefAllConfig},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrresbuildquality",{get:function(){return this._RefMgrresbuildquality||(this._RefMgrresbuildquality=new Be),this._RefMgrresbuildquality},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrresequipquality",{get:function(){return this._RefMgrresequipquality||(this._RefMgrresequipquality=new Pe),this._RefMgrresequipquality},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrresheroquality",{get:function(){return this._RefMgrresheroquality||(this._RefMgrresheroquality=new Ge),this._RefMgrresheroquality},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrresitemquality",{get:function(){return this._RefMgrresitemquality||(this._RefMgrresitemquality=new ke),this._RefMgrresitemquality},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrresskillquality",{get:function(){return this._RefMgrresskillquality||(this._RefMgrresskillquality=new xe),this._RefMgrresskillquality},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrressoldierquality",{get:function(){return this._RefMgrressoldierquality||(this._RefMgrressoldierquality=new Te),this._RefMgrressoldierquality},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrroleAttribute",{get:function(){return this._RefMgrroleAttribute||(this._RefMgrroleAttribute=new je),this._RefMgrroleAttribute},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrrune",{get:function(){return this._RefMgrrune||(this._RefMgrrune=new Ie),this._RefMgrrune},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrruneEnhance",{get:function(){return this._RefMgrruneEnhance||(this._RefMgrruneEnhance=new De),this._RefMgrruneEnhance},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrruneQualitySkill",{get:function(){return this._RefMgrruneQualitySkill||(this._RefMgrruneQualitySkill=new Fe),this._RefMgrruneQualitySkill},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrruneSynthesis",{get:function(){return this._RefMgrruneSynthesis||(this._RefMgrruneSynthesis=new Le),this._RefMgrruneSynthesis},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrsEquip",{get:function(){return this._RefMgrsEquip||(this._RefMgrsEquip=new Ee),this._RefMgrsEquip},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrsEquipReward",{get:function(){return this._RefMgrsEquipReward||(this._RefMgrsEquipReward=new Ae),this._RefMgrsEquipReward},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrshareIcon",{get:function(){return this._RefMgrshareIcon||(this._RefMgrshareIcon=new Ve),this._RefMgrshareIcon},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrshowSkill",{get:function(){return this._RefMgrshowSkill||(this._RefMgrshowSkill=new Ue),this._RefMgrshowSkill},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrskillGroup",{get:function(){return this._RefMgrskillGroup||(this._RefMgrskillGroup=new We),this._RefMgrskillGroup},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrskillLauncher",{get:function(){return this._RefMgrskillLauncher||(this._RefMgrskillLauncher=new He),this._RefMgrskillLauncher},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrspecialGift",{get:function(){return this._RefMgrspecialGift||(this._RefMgrspecialGift=new Ne),this._RefMgrspecialGift},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrsynthesis",{get:function(){return this._RefMgrsynthesis||(this._RefMgrsynthesis=new qe),this._RefMgrsynthesis},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrtask",{get:function(){return this._RefMgrtask||(this._RefMgrtask=new Ke),this._RefMgrtask},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrtaskConfig",{get:function(){return this._RefMgrtaskConfig||(this._RefMgrtaskConfig=new Xe),this._RefMgrtaskConfig},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrtaskReward",{get:function(){return this._RefMgrtaskReward||(this._RefMgrtaskReward=new ze),this._RefMgrtaskReward},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrvirtueRankReward",{get:function(){return this._RefMgrvirtueRankReward||(this._RefMgrvirtueRankReward=new Je),this._RefMgrvirtueRankReward},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RefMgrweeklyTask",{get:function(){return this._RefMgrweeklyTask||(this._RefMgrweeklyTask=new Ye),this._RefMgrweeklyTask},enumerable:!1,configurable:!0}),t}();r.default=a;var l=function(t){function e(){return t.call(this,"BattleStatusIcon")||this}return n(e,t),e}(i.default);r.RefMgrBattleStatusIconBase=l;var s=function(t){function e(){return t.call(this,"achieveTask")||this}return n(e,t),e}(i.default);r.RefMgrachieveTaskBase=s;var c=function(t){function e(){return t.call(this,"activeNewPlayerSign")||this}return n(e,t),e}(i.default);r.RefMgractiveNewPlayerSignBase=c;var u=function(t){function e(){return t.call(this,"activeProcess")||this}return n(e,t),e}(i.default);r.RefMgractiveProcessBase=u;var p=function(t){function e(){return t.call(this,"activeRechargeDayPlan")||this}return n(e,t),e}(i.default);r.RefMgractiveRechargeDayPlanBase=p;var f=function(t){function e(){return t.call(this,"activeRechargeDayReward")||this}return n(e,t),e}(i.default);r.RefMgractiveRechargeDayRewardBase=f;var h=function(t){function e(){return t.call(this,"activeSevenMission")||this}return n(e,t),e}(i.default);r.RefMgractiveSevenMissionBase=h;var y=function(t){function e(){return t.call(this,"activeSevenPlan")||this}return n(e,t),e}(i.default);r.RefMgractiveSevenPlanBase=y;var d=function(t){function e(){return t.call(this,"activity")||this}return n(e,t),e}(i.default);r.RefMgractivityBase=d;var m=function(t){function e(){return t.call(this,"activityOpen")||this}return n(e,t),e}(i.default);r.RefMgractivityOpenBase=m;var v=function(t){function e(){return t.call(this,"audioConfig")||this}return n(e,t),e}(i.default);r.RefMgraudioConfigBase=v;var _=function(t){function e(){return t.call(this,"battleBehaviorTemplateRef")||this}return n(e,t),e}(i.default);r.RefMgrbattleBehaviorTemplateRefBase=_;var S=function(t){function e(){return t.call(this,"battleBoxDropPlan")||this}return n(e,t),e}(i.default);r.RefMgrbattleBoxDropPlanBase=S;var g=function(t){function e(){return t.call(this,"battleBullet")||this}return n(e,t),e}(i.default);r.RefMgrbattleBulletBase=g;var b=function(t){function e(){return t.call(this,"battleBulletTagCollision")||this}return n(e,t),e}(i.default);r.RefMgrbattleBulletTagCollisionBase=b;var C=function(t){function e(){return t.call(this,"battleChestRef")||this}return n(e,t),e}(i.default);r.RefMgrbattleChestRefBase=C;var R=function(t){function e(){return t.call(this,"battleChestRewardRef")||this}return n(e,t),e}(i.default);r.RefMgrbattleChestRewardRefBase=R;var M=function(t){function e(){return t.call(this,"battleConfig")||this}return n(e,t),e}(i.default);r.RefMgrbattleConfigBase=M;var w=function(t){function e(){return t.call(this,"battleDropConfig")||this}return n(e,t),e}(i.default);r.RefMgrbattleDropConfigBase=w;var O=function(t){function e(){return t.call(this,"battleDropPlanRef")||this}return n(e,t),e}(i.default);r.RefMgrbattleDropPlanRefBase=O;var B=function(t){function e(){return t.call(this,"battleDropRef")||this}return n(e,t),e}(i.default);r.RefMgrbattleDropRefBase=B;var P=function(t){function e(){return t.call(this,"battleEquipDrawingRef")||this}return n(e,t),e}(i.default);r.RefMgrbattleEquipDrawingRefBase=P;var G=function(t){function e(){return t.call(this,"battleLauncher")||this}return n(e,t),e}(i.default);r.RefMgrbattleLauncherBase=G;var k=function(t){function e(){return t.call(this,"battleLevelRef")||this}return n(e,t),e}(i.default);r.RefMgrbattleLevelRefBase=k;var x=function(t){function e(){return t.call(this,"battleMonsterBehavior")||this}return n(e,t),e}(i.default);r.RefMgrbattleMonsterBehaviorBase=x;var T=function(t){function e(){return t.call(this,"battleMonsterRef")||this}return n(e,t),e}(i.default);r.RefMgrbattleMonsterRefBase=T;var j=function(t){function e(){return t.call(this,"battleSkillBehaviorRef")||this}return n(e,t),e}(i.default);r.RefMgrbattleSkillBehaviorRefBase=j;var I=function(t){function e(){return t.call(this,"battleSkillChestRef")||this}return n(e,t),e}(i.default);r.RefMgrbattleSkillChestRefBase=I;var D=function(t){function e(){return t.call(this,"battleSkillEvolutionRef")||this}return n(e,t),e}(i.default);r.RefMgrbattleSkillEvolutionRefBase=D;var F=function(t){function e(){return t.call(this,"battleSkillLevel")||this}return n(e,t),e}(i.default);r.RefMgrbattleSkillLevelBase=F;var L=function(t){function e(){return t.call(this,"battleSkillMonster")||this}return n(e,t),e}(i.default);r.RefMgrbattleSkillMonsterBase=L;var E=function(t){function e(){return t.call(this,"battleSkillRef")||this}return n(e,t),e}(i.default);r.RefMgrbattleSkillRefBase=E;var A=function(t){function e(){return t.call(this,"battleSkillTypeMonster")||this}return n(e,t),e}(i.default);r.RefMgrbattleSkillTypeMonsterBase=A;var V=function(t){function e(){return t.call(this,"battleSupplyLevelRef")||this}return n(e,t),e}(i.default);r.RefMgrbattleSupplyLevelRefBase=V;var U=function(t){function e(){return t.call(this,"battleSupplyRef")||this}return n(e,t),e}(i.default);r.RefMgrbattleSupplyRefBase=U;var W=function(t){function e(){return t.call(this,"battleWaveNumRef")||this}return n(e,t),e}(i.default);r.RefMgrbattleWaveNumRefBase=W;var H=function(t){function e(){return t.call(this,"battleWavePlanRef")||this}return n(e,t),e}(i.default);r.RefMgrbattleWavePlanRefBase=H;var N=function(t){function e(){return t.call(this,"battleWaveRef")||this}return n(e,t),e}(i.default);r.RefMgrbattleWaveRefBase=N;var q=function(t){function e(){return t.call(this,"battleWaveType")||this}return n(e,t),e}(i.default);r.RefMgrbattleWaveTypeBase=q;var K=function(t){function e(){return t.call(this,"bigNum")||this}return n(e,t),e}(i.default);r.RefMgrbigNumBase=K;var X=function(t){function e(){return t.call(this,"box")||this}return n(e,t),e}(i.default);r.RefMgrboxBase=X;var z=function(t){function e(){return t.call(this,"boxContent")||this}return n(e,t),e}(i.default);r.RefMgrboxContentBase=z;var J=function(t){function e(){return t.call(this,"breachAttribute")||this}return n(e,t),e}(i.default);r.RefMgrbreachAttributeBase=J;var Y=function(t){function e(){return t.call(this,"breachSkill")||this}return n(e,t),e}(i.default);r.RefMgrbreachSkillBase=Y;var Z=function(t){function e(){return t.call(this,"buff")||this}return n(e,t),e}(i.default);r.RefMgrbuffBase=Z;var Q=function(t){function e(){return t.call(this,"buffCarrier")||this}return n(e,t),e}(i.default);r.RefMgrbuffCarrierBase=Q;var $=function(t){function e(){return t.call(this,"buySta")||this}return n(e,t),e}(i.default);r.RefMgrbuyStaBase=$;var tt=function(t){function e(){return t.call(this,"chapterBox")||this}return n(e,t),e}(i.default);r.RefMgrchapterBoxBase=tt;var et=function(t){function e(){return t.call(this,"chapterBuff")||this}return n(e,t),e}(i.default);r.RefMgrchapterBuffBase=et;var rt=function(t){function e(){return t.call(this,"chapterMonster")||this}return n(e,t),e}(i.default);r.RefMgrchapterMonsterBase=rt;var ot=function(t){function e(){return t.call(this,"chapterMonsterStrong")||this}return n(e,t),e}(i.default);r.RefMgrchapterMonsterStrongBase=ot;var nt=function(t){function e(){return t.call(this,"chapterRef")||this}return n(e,t),e}(i.default);r.RefMgrchapterRefBase=nt;var it=function(t){function e(){return t.call(this,"chapterReward")||this}return n(e,t),e}(i.default);r.RefMgrchapterRewardBase=it;var at=function(t){function e(){return t.call(this,"chapterSkill")||this}return n(e,t),e}(i.default);r.RefMgrchapterSkillBase=at;var lt=function(t){function e(){return t.call(this,"code")||this}return n(e,t),e}(i.default);r.RefMgrcodeBase=lt;var st=function(t){function e(){return t.call(this,"consumeGiftPlan")||this}return n(e,t),e}(i.default);r.RefMgrconsumeGiftPlanBase=st;var ct=function(t){function e(){return t.call(this,"dailyRechargePlan")||this}return n(e,t),e}(i.default);r.RefMgrdailyRechargePlanBase=ct;var ut=function(t){function e(){return t.call(this,"dailyTask")||this}return n(e,t),e}(i.default);r.RefMgrdailyTaskBase=ut;var pt=function(t){function e(){return t.call(this,"dayWeekMonthGift")||this}return n(e,t),e}(i.default);r.RefMgrdayWeekMonthGiftBase=pt;var ft=function(t){function e(){return t.call(this,"dayWeekMonthGiftConfig")||this}return n(e,t),e}(i.default);r.RefMgrdayWeekMonthGiftConfigBase=ft;var ht=function(t){function e(){return t.call(this,"enhance")||this}return n(e,t),e}(i.default);r.RefMgrenhanceBase=ht;var yt=function(t){function e(){return t.call(this,"enhanceConsume")||this}return n(e,t),e}(i.default);r.RefMgrenhanceConsumeBase=yt;var dt=function(t){function e(){return t.call(this,"equip")||this}return n(e,t),e}(i.default);r.RefMgrequipBase=dt;var mt=function(t){function e(){return t.call(this,"everyDaySignInCountGift")||this}return n(e,t),e}(i.default);r.RefMgreveryDaySignInCountGiftBase=mt;var vt=function(t){function e(){return t.call(this,"everyDaySignInDayGift")||this}return n(e,t),e}(i.default);r.RefMgreveryDaySignInDayGiftBase=vt;var _t=function(t){function e(){return t.call(this,"firstRecharge")||this}return n(e,t),e}(i.default);r.RefMgrfirstRechargeBase=_t;var St=function(t){function e(){return t.call(this,"fuBenCanUseSkillGroupRef")||this}return n(e,t),e}(i.default);r.RefMgrfuBenCanUseSkillGroupRefBase=St;var gt=function(t){function e(){return t.call(this,"fuBenDailyPlan")||this}return n(e,t),e}(i.default);r.RefMgrfuBenDailyPlanBase=gt;var bt=function(t){function e(){return t.call(this,"fuBenDailyReward")||this}return n(e,t),e}(i.default);r.RefMgrfuBenDailyRewardBase=bt;var Ct=function(t){function e(){return t.call(this,"fuBenGoldPlan")||this}return n(e,t),e}(i.default);r.RefMgrfuBenGoldPlanBase=Ct;var Rt=function(t){function e(){return t.call(this,"fuBenRef")||this}return n(e,t),e}(i.default);r.RefMgrfuBenRefBase=Rt;var Mt=function(t){function e(){return t.call(this,"fund")||this}return n(e,t),e}(i.default);r.RefMgrfundBase=Mt;var wt=function(t){function e(){return t.call(this,"fundReward")||this}return n(e,t),e}(i.default);r.RefMgrfundRewardBase=wt;var Ot=function(t){function e(){return t.call(this,"fundTypePlan")||this}return n(e,t),e}(i.default);r.RefMgrfundTypePlanBase=Ot;var Bt=function(t){function e(){return t.call(this,"gameConfig")||this}return n(e,t),e}(i.default);r.RefMgrgameConfigBase=Bt;var Pt=function(t){function e(){return t.call(this,"gameRule")||this}return n(e,t),e}(i.default);r.RefMgrgameRuleBase=Pt;var Gt=function(t){function e(){return t.call(this,"generalMaterials")||this}return n(e,t),e}(i.default);r.RefMgrgeneralMaterialsBase=Gt;var kt=function(t){function e(){return t.call(this,"giftChapter")||this}return n(e,t),e}(i.default);r.RefMgrgiftChapterBase=kt;var xt=function(t){function e(){return t.call(this,"goods")||this}return n(e,t),e}(i.default);r.RefMgrgoodsBase=xt;var Tt=function(t){function e(){return t.call(this,"goto")||this}return n(e,t),e}(i.default);r.RefMgrgotoBase=Tt;var jt=function(t){function e(){return t.call(this,"guidingTask")||this}return n(e,t),e}(i.default);r.RefMgrguidingTaskBase=jt;var It=function(t){function e(){return t.call(this,"hallConfig")||this}return n(e,t),e}(i.default);r.RefMgrhallConfigBase=It;var Dt=function(t){function e(){return t.call(this,"hanging")||this}return n(e,t),e}(i.default);r.RefMgrhangingBase=Dt;var Ft=function(t){function e(){return t.call(this,"head")||this}return n(e,t),e}(i.default);r.RefMgrheadBase=Ft;var Lt=function(t){function e(){return t.call(this,"hero")||this}return n(e,t),e}(i.default);r.RefMgrheroBase=Lt;var Et=function(t){function e(){return t.call(this,"heroAnimation")||this}return n(e,t),e}(i.default);r.RefMgrheroAnimationBase=Et;var At=function(t){function e(){return t.call(this,"heroAudio")||this}return n(e,t),e}(i.default);r.RefMgrheroAudioBase=At;var Vt=function(t){function e(){return t.call(this,"heroLevel")||this}return n(e,t),e}(i.default);r.RefMgrheroLevelBase=Vt;var Ut=function(t){function e(){return t.call(this,"heroPassiveSkill")||this}return n(e,t),e}(i.default);r.RefMgrheroPassiveSkillBase=Ut;var Wt=function(t){function e(){return t.call(this,"heroShowGet")||this}return n(e,t),e}(i.default);r.RefMgrheroShowGetBase=Wt;var Ht=function(t){function e(){return t.call(this,"heroSkill")||this}return n(e,t),e}(i.default);r.RefMgrheroSkillBase=Ht;var Nt=function(t){function e(){return t.call(this,"heroUnlock")||this}return n(e,t),e}(i.default);r.RefMgrheroUnlockBase=Nt;var qt=function(t){function e(){return t.call(this,"icon")||this}return n(e,t),e}(i.default);r.RefMgriconBase=qt;var Kt=function(t){function e(){return t.call(this,"idConfig")||this}return n(e,t),e}(i.default);r.RefMgridConfigBase=Kt;var Xt=function(t){function e(){return t.call(this,"item")||this}return n(e,t),e}(i.default);r.RefMgritemBase=Xt;var zt=function(t){function e(){return t.call(this,"itemType")||this}return n(e,t),e}(i.default);r.RefMgritemTypeBase=zt;var Jt=function(t){function e(){return t.call(this,"jumpLayer")||this}return n(e,t),e}(i.default);r.RefMgrjumpLayerBase=Jt;var Yt=function(t){function e(){return t.call(this,"level")||this}return n(e,t),e}(i.default);r.RefMgrlevelBase=Yt;var Zt=function(t){function e(){return t.call(this,"limitSEquipReward")||this}return n(e,t),e}(i.default);r.RefMgrlimitSEquipRewardBase=Zt;var Qt=function(t){function e(){return t.call(this,"luckDraw")||this}return n(e,t),e}(i.default);r.RefMgrluckDrawBase=Qt;var $t=function(t){function e(){return t.call(this,"luckDrawReward")||this}return n(e,t),e}(i.default);r.RefMgrluckDrawRewardBase=$t;var te=function(t){function e(){return t.call(this,"luckyCatReward")||this}return n(e,t),e}(i.default);r.RefMgrluckyCatRewardBase=te;var ee=function(t){function e(){return t.call(this,"mL")||this}return n(e,t),e}(i.default);r.RefMgrmLBase=ee;var re=function(t){function e(){return t.call(this,"mailContent")||this}return n(e,t),e}(i.default);r.RefMgrmailContentBase=re;var oe=function(t){function e(){return t.call(this,"mallChapterGift")||this}return n(e,t),e}(i.default);r.RefMgrmallChapterGiftBase=oe;var ne=function(t){function e(){return t.call(this,"mallChapterGiftReward")||this}return n(e,t),e}(i.default);r.RefMgrmallChapterGiftRewardBase=ne;var ie=function(t){function e(){return t.call(this,"mallCharge")||this}return n(e,t),e}(i.default);r.RefMgrmallChargeBase=ie;var ae=function(t){function e(){return t.call(this,"mallCoin")||this}return n(e,t),e}(i.default);r.RefMgrmallCoinBase=ae;var le=function(t){function e(){return t.call(this,"mallCoinReward")||this}return n(e,t),e}(i.default);r.RefMgrmallCoinRewardBase=le;var se=function(t){function e(){return t.call(this,"mallDailyShop")||this}return n(e,t),e}(i.default);r.RefMgrmallDailyShopBase=se;var ce=function(t){function e(){return t.call(this,"mallDailyShopDiscount")||this}return n(e,t),e}(i.default);r.RefMgrmallDailyShopDiscountBase=ce;var ue=function(t){function e(){return t.call(this,"mallDailyShopReward")||this}return n(e,t),e}(i.default);r.RefMgrmallDailyShopRewardBase=ue;var pe=function(t){function e(){return t.call(this,"mallModule")||this}return n(e,t),e}(i.default);r.RefMgrmallModuleBase=pe;var fe=function(t){function e(){return t.call(this,"mapRef")||this}return n(e,t),e}(i.default);r.RefMgrmapRefBase=fe;var he=function(t){function e(){return t.call(this,"modelRef")||this}return n(e,t),e}(i.default);r.RefMgrmodelRefBase=he;var ye=function(t){function e(){return t.call(this,"moneyDrawReward")||this}return n(e,t),e}(i.default);r.RefMgrmoneyDrawRewardBase=ye;var de=function(t){function e(){return t.call(this,"monthBuff")||this}return n(e,t),e}(i.default);r.RefMgrmonthBuffBase=de;var me=function(t){function e(){return t.call(this,"monthCard")||this}return n(e,t),e}(i.default);r.RefMgrmonthCardBase=me;var ve=function(t){function e(){return t.call(this,"mysteriousStorePlan")||this}return n(e,t),e}(i.default);r.RefMgrmysteriousStorePlanBase=ve;var _e=function(t){function e(){return t.call(this,"noticeIcon")||this}return n(e,t),e}(i.default);r.RefMgrnoticeIconBase=_e;var Se=function(t){function e(){return t.call(this,"open")||this}return n(e,t),e}(i.default);r.RefMgropenBase=Se;var ge=function(t){function e(){return t.call(this,"payChannel")||this}return n(e,t),e}(i.default);r.RefMgrpayChannelBase=ge;var be=function(t){function e(){return t.call(this,"playOpen")||this}return n(e,t),e}(i.default);r.RefMgrplayOpenBase=be;var Ce=function(t){function e(){return t.call(this,"plot")||this}return n(e,t),e}(i.default);r.RefMgrplotBase=Ce;var Re=function(t){function e(){return t.call(this,"popularityRankReward")||this}return n(e,t),e}(i.default);r.RefMgrpopularityRankRewardBase=Re;var Me=function(t){function e(){return t.call(this,"powerRankReward")||this}return n(e,t),e}(i.default);r.RefMgrpowerRankRewardBase=Me;var we=function(t){function e(){return t.call(this,"qualitySkill")||this}return n(e,t),e}(i.default);r.RefMgrqualitySkillBase=we;var Oe=function(t){function e(){return t.call(this,"refAllConfig")||this}return n(e,t),e}(i.default);r.RefMgrrefAllConfigBase=Oe;var Be=function(t){function e(){return t.call(this,"resbuildquality")||this}return n(e,t),e}(i.default);r.RefMgrresbuildqualityBase=Be;var Pe=function(t){function e(){return t.call(this,"resequipquality")||this}return n(e,t),e}(i.default);r.RefMgrresequipqualityBase=Pe;var Ge=function(t){function e(){return t.call(this,"resheroquality")||this}return n(e,t),e}(i.default);r.RefMgrresheroqualityBase=Ge;var ke=function(t){function e(){return t.call(this,"resitemquality")||this}return n(e,t),e}(i.default);r.RefMgrresitemqualityBase=ke;var xe=function(t){function e(){return t.call(this,"resskillquality")||this}return n(e,t),e}(i.default);r.RefMgrresskillqualityBase=xe;var Te=function(t){function e(){return t.call(this,"ressoldierquality")||this}return n(e,t),e}(i.default);r.RefMgrressoldierqualityBase=Te;var je=function(t){function e(){return t.call(this,"roleAttribute")||this}return n(e,t),e}(i.default);r.RefMgrroleAttributeBase=je;var Ie=function(t){function e(){return t.call(this,"rune")||this}return n(e,t),e}(i.default);r.RefMgrruneBase=Ie;var De=function(t){function e(){return t.call(this,"runeEnhance")||this}return n(e,t),e}(i.default);r.RefMgrruneEnhanceBase=De;var Fe=function(t){function e(){return t.call(this,"runeQualitySkill")||this}return n(e,t),e}(i.default);r.RefMgrruneQualitySkillBase=Fe;var Le=function(t){function e(){return t.call(this,"runeSynthesis")||this}return n(e,t),e}(i.default);r.RefMgrruneSynthesisBase=Le;var Ee=function(t){function e(){return t.call(this,"sEquip")||this}return n(e,t),e}(i.default);r.RefMgrsEquipBase=Ee;var Ae=function(t){function e(){return t.call(this,"sEquipReward")||this}return n(e,t),e}(i.default);r.RefMgrsEquipRewardBase=Ae;var Ve=function(t){function e(){return t.call(this,"shareIcon")||this}return n(e,t),e}(i.default);r.RefMgrshareIconBase=Ve;var Ue=function(t){function e(){return t.call(this,"showSkill")||this}return n(e,t),e}(i.default);r.RefMgrshowSkillBase=Ue;var We=function(t){function e(){return t.call(this,"skillGroup")||this}return n(e,t),e}(i.default);r.RefMgrskillGroupBase=We;var He=function(t){function e(){return t.call(this,"skillLauncher")||this}return n(e,t),e}(i.default);r.RefMgrskillLauncherBase=He;var Ne=function(t){function e(){return t.call(this,"specialGift")||this}return n(e,t),e}(i.default);r.RefMgrspecialGiftBase=Ne;var qe=function(t){function e(){return t.call(this,"synthesis")||this}return n(e,t),e}(i.default);r.RefMgrsynthesisBase=qe;var Ke=function(t){function e(){return t.call(this,"task")||this}return n(e,t),e}(i.default);r.RefMgrtaskBase=Ke;var Xe=function(t){function e(){return t.call(this,"taskConfig")||this}return n(e,t),e}(i.default);r.RefMgrtaskConfigBase=Xe;var ze=function(t){function e(){return t.call(this,"taskReward")||this}return n(e,t),e}(i.default);r.RefMgrtaskRewardBase=ze;var Je=function(t){function e(){return t.call(this,"virtueRankReward")||this}return n(e,t),e}(i.default);r.RefMgrvirtueRankRewardBase=Je;var Ye=function(t){function e(){return t.call(this,"weeklyTask")||this}return n(e,t),e}(i.default);r.RefMgrweeklyTaskBase=Ye,cc._RF.pop()},{"../../../framework/ref/RefMgrBase":void 0}],RefBattleBoxDropPlan:[function(t,e,r){"use strict";cc._RF.push(e,"0345ftM3GNF7rrVj9QVycFP","RefBattleBoxDropPlan");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RefBattleBoxDropPlan=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetGridSize=function(){return this.ref.gridSize},e.prototype.GetRadiusMax=function(){return this.ref.bigRadius*this.GetGridSize()},e.prototype.GetRadiusMin=function(){return this.ref.smallRadius*this.GetGridSize()},e.prototype.GetMaxNum=function(){return this.ref.maxNum},e.prototype.GetOpenRadius=function(){return this.ref.openRadius*this.GetGridSize()},e.__cname="RefBattleBoxDropPlan",e}(t("./RefWrap").RefWrap);r.RefBattleBoxDropPlan=i,cc._RF.pop()},{"./RefWrap":"RefWrap"}],RefBattleBulletTagCollision:[function(t,e,r){"use strict";cc._RF.push(e,"05917sHRJZDyZZmY12QF6IZ","RefBattleBulletTagCollision");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RefBattleBulletTagCollision=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetTlTag=function(){return this.ref.tag},e.prototype.HasTag=function(t){return 1==this.GetTlTag()[t]},e.__cname="RefBattleBulletTagCollision",e}(t("./RefWrap").RefWrap);r.RefBattleBulletTagCollision=i,cc._RF.pop()},{"./RefWrap":"RefWrap"}],RefBattleBullet:[function(t,e,r){"use strict";cc._RF.push(e,"09685DX2EBFDIHLD8nWJxKr","RefBattleBullet");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RefBattleBullet=r.RefBattleBullet_tag=void 0;var i=t("./RefWrap");(function(t){t[t.Melee=0]="Melee",t[t.Remote=1]="Remote",t[t.Field=2]="Field"})(r.RefBattleBullet_tag||(r.RefBattleBullet_tag={}));var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetPrototypeSize=function(t){return this.ref.prototypeSize[t]},e.prototype.GetModel=function(t){return this.ref.model[t]},e.prototype.GetDamageRate=function(){return(this.ref.damage||0)/100},e.prototype.GetDamageInterval=function(){return this.ref.damageInterval},e.prototype.GetPenetrate=function(){return this.ref.penetrate||0},e.prototype.GetBulletKiller=function(){return this.ref.bulletKill||0},e.prototype.GetBulletKillerDef=function(){return this.ref.bulletKillDef||0},e.prototype.GetEffectTime=function(){return(this.ref.effectTime||0)/1e3},e.prototype.GetLifeTime=function(){return(this.ref.effectTime||0)/1e3},e.prototype.GetSpeed=function(){return this.ref.speed||100},e.prototype.GetRepel=function(){return this.ref.repel||0},e.prototype.GetRebound=function(){return this.ref.rebound||0},e.prototype.GetScript=function(){return this.ref.script},e.prototype.GetScriptParam=function(){return this.ref.param},e.prototype.GetDamageRange=function(){return(this.ref.damageRange||0)/100},e.prototype.GetDirectionType=function(){return this.ref.directionType},e.prototype.GetTlTag=function(){var t=this._tlTag;if(null==t){t=[];for(var e=this.ref.tag,r=0;r<e.length;r++)1==e[r]&&t.push(r);this._tlTag=t}return t},e.prototype.HasTag=function(t){return 1==this.GetTlTag()[t]},e.prototype.GetPrototypeSizeBy=function(t){var e=this._tmPrototypeSize;if(null==e){e=new Map,this._tmPrototypeSize=e;for(var r=this.ref.model,o=this.ref.prototypeSize,n=0;n<r.length;n++)e.set(r[n],o[n])}return e.get(t)},e.prototype.GetDamageRadiusBy=function(t){return this.GetPrototypeSizeBy(t)/2},e.prototype.GetDamageRadius=function(t){return this.GetPrototypeSize(t)/2},e.__cname="RefBattleBullet",e}(i.RefWrap);r.RefBattleBullet=a,cc._RF.pop()},{"./RefWrap":"RefWrap"}],RefBattleChestRewardRef:[function(t,e,r){"use strict";cc._RF.push(e,"bd6274/suxGWrbTD8CzJO0L","RefBattleChestRewardRef");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RefBattleChestRewardRef=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetModel=function(){return this.ref.model},e.prototype.GetModel2=function(){return this.ref.model2},e.prototype.GetType=function(){return this.ref.type},e.prototype.GetValue=function(){return this.ref.value},e.__cname="RefBattleChestRewardRef",e}(t("./RefWrap").RefWrap);r.RefBattleChestRewardRef=i,cc._RF.pop()},{"./RefWrap":"RefWrap"}],RefBattleDropConfig:[function(t,e,r){"use strict";cc._RF.push(e,"4e461nQZg1KP7P3cZm6hFfp","RefBattleDropConfig");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RefBattleDropConfig=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetStartDrop=function(){return this.ref.startDrop},e.prototype.GetReconnectDrop=function(){return this.ref.reconnectDrop},e.prototype.GerRadius=function(){return this.ref.radius},e.__cname="RefBattleDropConfig",e}(t("./RefWrap").RefWrap);r.RefBattleDropConfig=i,cc._RF.pop()},{"./RefWrap":"RefWrap"}],RefBattleDropPlan:[function(t,e,r){"use strict";cc._RF.push(e,"07ce00VPslDALKavu+sH85+","RefBattleDropPlan");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RefBattleDropPlan=r.RefBattleDropPlan_boxDropPlan=void 0;var i=t("./RefWrap");r.RefBattleDropPlan_boxDropPlan=function(){};var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetMonster=function(){return this.ref.monster},e.prototype.GetBoxDrop=function(){return this.ref.boxDrop},e.prototype.GetSkillChest=function(){return this.ref.skillChest},e.prototype.GetGoldChestProp=function(){return this.ref.goldChestProp},e.prototype.GetMonsterDrop=function(t){var e=this.GetMonster()[t];return null!=e?e:null},e.prototype.GetBoxDropPlan=function(){return this.ref.boxDropPlan[0]},e.prototype.GetPoint=function(){return this.ref.point},e.__cname="RefDropPlan",e}(i.RefWrap);r.RefBattleDropPlan=a,cc._RF.pop()},{"./RefWrap":"RefWrap"}],RefBattleMonsterBehavior:[function(t,e,r){"use strict";cc._RF.push(e,"d0047OvAadHvqCEUN9kIuOb","RefBattleMonsterBehavior");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RefBattleMonsterBehavior=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.__cname="RefBattleMonsterBehavior",e}(t("./RefWrap").RefWrap);r.RefBattleMonsterBehavior=i,cc._RF.pop()},{"./RefWrap":"RefWrap"}],RefBattleMonster:[function(t,e,r){"use strict";cc._RF.push(e,"c71055rqptMvagmKzhvqOc3","RefBattleMonster");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RefBattleMonster=r.ERefBattleMonsterType=void 0;var i,a=t("./RefWrap");(function(t){t[t.Monster=1]="Monster",t[t.Elite=2]="Elite",t[t.Boss=3]="Boss"})(i=r.ERefBattleMonsterType||(r.ERefBattleMonsterType={}));var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetPrototypeSize=function(){return this.ref.prototypeSize},e.prototype.GetCollisionRadius=function(){return this.GetPrototypeSize()/2},e.prototype.GetModel=function(){return this.ref.model},e.prototype.GetSpd=function(){return this.ref.spd},e.prototype.GetMonsterType=function(){return this.ref.type},e.prototype.GetIsMonster=function(){return this.ref.type==i.Monster},e.prototype.GetIsElite=function(){return this.ref.type==i.Elite},e.prototype.GetIsBoss=function(){return this.ref.type==i.Boss},e.prototype.GetHp=function(){return this.ref.hp},e.prototype.GetAtk=function(){return this.ref.atk},e.prototype.GetName=function(){return this.ref.name},e.prototype.GetWeg=function(){return this.ref.weg||0},e.prototype.GetSkill=function(){var t=this._GetSkill;return null==t&&(t=this.ref.skill?this.ref.skill:[],this._GetSkill=t),t},e.prototype.GetSkillAt=function(t){var e=this.ref.skill;return e?e[t]:null},e.prototype.GetFirstSkill=function(){return this.ref.skill[0]},e.prototype.GetBehavior=function(){return this.ref.behavior},e.prototype.GetPhy=function(){return(this.ref.phy||0)/100},e.prototype.GetDropLevel=function(){return this.ref.dropLevel},e.__cname="RefBattleMonster",e}(a.RefWrap);r.RefBattleMonster=l,cc._RF.pop()},{"./RefWrap":"RefWrap"}],RefBattleSkillChest:[function(t,e,r){"use strict";cc._RF.push(e,"8d80e7Io9xBaKlQvwd/GlCQ","RefBattleSkillChest");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RefBattleSkillChest=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetSkillNum=function(){return this.ref.skillNum},e.prototype.GetWeight=function(){return this.ref.weight},e.prototype.GetMoneyNumRange=function(){return this.ref.moneyNumRange},e.prototype.GetMoneyMin=function(){return this.GetMoneyNumRange()[0]},e.prototype.GetMoneyMax=function(){return this.GetMoneyNumRange()[1]},e.prototype.GetMoneyStep=function(){return this.GetMoneyNumRange()[2]},e.__cname="RefBattleSkillChest",e}(t("./RefWrap").RefWrap);r.RefBattleSkillChest=i,cc._RF.pop()},{"./RefWrap":"RefWrap"}],RefBattleSkillEvolution:[function(t,e,r){"use strict";cc._RF.push(e,"c0d58OwJzNBFJTWVhGno/1D","RefBattleSkillEvolution");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RefBattleSkillEvolution=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetNeed=function(){return this.ref.need},e.prototype.GetSkillId=function(){return this.ref.skillId},e.prototype.GetSkillLevel=function(){return 6},e.prototype.GetId=function(){return this.ref.id},e.__cname="RefBattleSkillEvolution",e}(t("./RefWrap").RefWrap);r.RefBattleSkillEvolution=i,cc._RF.pop()},{"./RefWrap":"RefWrap"}],RefBattleSkillLevel:[function(t,e,r){"use strict";cc._RF.push(e,"a2600qj/nZEEqbaq2L/647H","RefBattleSkillLevel");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RefBattleSkillLevel=r.EBattleSkillShootMode=void 0;var i,a=t("./RefWrap");(function(t){t[t.Normal=0]="Normal",t[t.Single=1]="Single"})(i=r.EBattleSkillShootMode||(r.EBattleSkillShootMode={}));var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetRefId=function(){return this.ref.id},e.prototype.GetCd=function(){return this.ref.CD/1e3},e.prototype.GetLevel=function(){return this.ref.level},e.prototype.GetMaxLevel=function(){return 5},e.prototype.GetNum=function(){return this.ref.num},e.prototype.GetInterval=function(){return this.ref.interval/1e3},e.prototype.GetBullets=function(){return this.ref.bullet},e.prototype.GetBullet=function(t){return this.ref.bullet[t]},e.prototype.GetBulletLength=function(){return this.ref.bullet.length},e.prototype.GetShootMode=function(){return this.ref.mode||0},e.prototype.GetIsSingleMode=function(){return this.GetShootMode()==i.Single},e.prototype.GetParam=function(){return this.ref.param},e.prototype.GetSoundEffect=function(){return this.ref.soundtime},e.prototype.GetSkillId=function(){return this.ref.skillId},e.__cname="RefBattleSkillLevel",e}(a.RefWrap);r.RefBattleSkillLevel=l,cc._RF.pop()},{"./RefWrap":"RefWrap"}],RefBattleSkillMonster:[function(t,e,r){"use strict";cc._RF.push(e,"833ceBlrg9Bg4V/WqvC4bYe","RefBattleSkillMonster");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RefBattleSkillMonster=void 0;var i=t("./RefBattleSkillLevel"),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetRefId=function(){return this.ref.id},e.prototype.GetCd=function(){return this.ref.CD/1e3},e.prototype.GetNum=function(){return this.ref.num},e.prototype.GetInterval=function(){return this.ref.interval/1e3},e.prototype.GetBullet=function(t){return this.ref.bullet[t]},e.prototype.GetBulletNum=function(){return this.ref.bullet.length},e.prototype.GetShootMode=function(){return this.ref.mode||0},e.prototype.GetIsSingleMode=function(){return this.GetShootMode()==i.EBattleSkillShootMode.Single},e.prototype.GetSkillType=function(){return this.ref.skillId},e.prototype.GetSkillParam=function(){return this.ref.param},e.prototype.GetConjureDistance=function(){return this.ref.conjureDistance||0},e.__cname="RefBattleSkillMonster",e}(t("./RefWrap").RefWrap);r.RefBattleSkillMonster=a,cc._RF.pop()},{"./RefBattleSkillLevel":"RefBattleSkillLevel","./RefWrap":"RefWrap"}],RefBattleSkillTypeMonster:[function(t,e,r){"use strict";cc._RF.push(e,"f62d7bKa9hDWLV+Vc36oXjB","RefBattleSkillTypeMonster");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RefBattleSkillTypeMonster=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetRefId=function(){return this.ref.resId},e.__cname="RefBattleSkillTypeMonster",e}(t("./RefWrap").RefWrap);r.RefBattleSkillTypeMonster=i,cc._RF.pop()},{"./RefWrap":"RefWrap"}],RefBattleSkill:[function(t,e,r){"use strict";cc._RF.push(e,"66a32fLwIZIAIoytG/ghTQv","RefBattleSkill");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RefBattleSkill=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetRefId=function(){return this.ref.resId},e.prototype.GetIcon=function(){return this.ref.icon},e.prototype.GetModel=function(){return this.ref.model},e.prototype.GetName=function(){return this.ref.name},e.prototype.GetMaxLevel=function(){return 5},e.__cname="RefBattleSkill",e}(t("./RefWrap").RefWrap);r.RefBattleSkill=i,cc._RF.pop()},{"./RefWrap":"RefWrap"}],RefBattleStatusIcon:[function(t,e,r){"use strict";cc._RF.push(e,"dc15fIwZH5P069nBm5+qSLZ","RefBattleStatusIcon");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RefBattleStatusIcon=r.RefBattleStatusIcon_Position=void 0;var i=t("./RefWrap");(function(t){t[t.Top=1]="Top",t[t.Center=2]="Center"})(r.RefBattleStatusIcon_Position||(r.RefBattleStatusIcon_Position={}));var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetPath=function(){return this.ref.path},e.prototype.GetPositon=function(){return this.ref.position},e.prototype.GetWidth=function(){return this.ref.width},e.prototype.GetHeight=function(){return this.ref.height},e.__cname="RefBattleStatusIcon",e}(i.RefWrap);r.RefBattleStatusIcon=a,cc._RF.pop()},{"./RefWrap":"RefWrap"}],RefBattleSupplyLevel:[function(t,e,r){"use strict";cc._RF.push(e,"77e76HUYmpHi4dL4oolF7Hs","RefBattleSupplyLevel");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RefBattleSupplyLevel=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetMaxLevel=function(){return 5},e.prototype.GetBuff=function(){return this.ref.buff},e.__cname="RefBattleSupplyLevel",e}(t("./RefWrap").RefWrap);r.RefBattleSupplyLevel=i,cc._RF.pop()},{"./RefWrap":"RefWrap"}],RefBattleSupply:[function(t,e,r){"use strict";cc._RF.push(e,"19f61cv+EdB66akkQF75gd6","RefBattleSupply");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RefBattleSupply=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetIcon=function(){return this.ref.icon},e.prototype.GetName=function(){return this.ref.name},e.prototype.GetMaxLevel=function(){return 5},e.__cname="RefBattleSupply",e}(t("./RefWrap").RefWrap);r.RefBattleSupply=i,cc._RF.pop()},{"./RefWrap":"RefWrap"}],RefBattleWaveType:[function(t,e,r){"use strict";cc._RF.push(e,"8d85cb8UUlO849lpm0oP+xL","RefBattleWaveType");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RefBattleWaveType=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetType=function(){return this.ref.type},e.prototype.GetParams=function(){return this.ref.param},e.__cname="RefBattleWaveType",e}(t("./RefWrap").RefWrap);r.RefBattleWaveType=i,cc._RF.pop()},{"./RefWrap":"RefWrap"}],RefBuffCarrier:[function(t,e,r){"use strict";cc._RF.push(e,"75e91QgN6tBxrZXKdVfa8uz","RefBuffCarrier");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RefBuffCarrier=r.RefBuffCarrier_EffetType=r.RefBuffCarrier_TriggerType=r.RefBuffCarrier_TargetType=void 0;var i,a,l=t("../../framework/FW"),s=t("./RefWrap");(function(t){t[t.DEFAULT=1]="DEFAULT",t[t.SELF=10]="SELF",t[t.ENEMY_CLOSE=21]="ENEMY_CLOSE",t[t.ENEMY_LOW_HP=22]="ENEMY_LOW_HP",t[t.ENEMY_RANDOM=23]="ENEMY_RANDOM"})(r.RefBuffCarrier_TargetType||(r.RefBuffCarrier_TargetType={})),function(t){t[t.MSTimer=1]="MSTimer",t[t.OnBeHit=2]="OnBeHit",t[t.OnKillMonster=3]="OnKillMonster",t[t.OnReadyDie=4]="OnReadyDie",t[t.OnKillEliteOrBoss=5]="OnKillEliteOrBoss",t[t.OnImmediately=6]="OnImmediately",t[t.OnRestore=7]="OnRestore",t[t.OnHpChange=8]="OnHpChange",t[t.OnTake=9]="OnTake",t[t.MSMove=10]="MSMove",t[t.AtkNum=11]="AtkNum"}(i=r.RefBuffCarrier_TriggerType||(r.RefBuffCarrier_TriggerType={})),function(t){t[t.TakedamageHPP=1001]="TakedamageHPP",t[t.ShootBullet=1002]="ShootBullet",t[t.RestorePrecent=1003]="RestorePrecent",t[t.Reborn=1004]="Reborn",t[t.ModifyAttr=1005]="ModifyAttr",t[t.AddBuff=1006]="AddBuff",t[t.Invincible=1007]="Invincible"}(a=r.RefBuffCarrier_EffetType||(r.RefBuffCarrier_EffetType={}));var c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetTargetType=function(){return this.ref.targetType},e.prototype.GetDuration=function(){return this.ref.duration/1e3},e.prototype.GetTriggerType=function(){return this.ref.triggerType},e.prototype.GetTriggerData=function(){return null==this._triggerdata&&(this._triggerdata=this.OnGetTriggerData()),this._triggerdata},e.prototype.OnGetTriggerData=function(){var t=this.GetTriggerType(),e=(this.ref,{});switch(e.triggerType=t,e.duration=this.GetDuration(),t){case i.MSTimer:case i.OnBeHit:return(r=e).spacing=this.ref.triggerParam[0]/1e3,r;case i.OnKillMonster:return(r=e).num=this.ref.triggerParam[0],r;case i.OnReadyDie:case i.OnKillEliteOrBoss:case i.OnImmediately:case i.OnRestore:case i.OnHpChange:case i.OnTake:return e;case i.MSMove:case i.AtkNum:var r;return(r=e).spacing=this.ref.triggerParam[0],r}},e.prototype.GetEffectType=function(){return this.ref.effectType},e.prototype.GetEffectData=function(){return null==this._effectData&&(this._effectData=this.OnGetEffectData()),this._effectData},e.prototype.OnGetEffectData=function(){var t=this.GetEffectType(),e=(this.ref,{});switch(e.type=t,t){case a.TakedamageHPP:return(s=e).hpp=this.ref.effectParam[0]/1e4,s;case a.ShootBullet:return(s=e).bulletId=this.ref.effectParam[0],s;case a.RestorePrecent:case a.Reborn:return(s=e).hpp=this.ref.effectParam[0]/1e4,s;case a.ModifyAttr:(s=e).attrs=[];var r=this.ref.effectParam;r.length%2!=0&&l.FW.Log.error("\u6301\u7eedBuff\u89e6\u53d1\u5668\u53c2\u6570\u6709\u95ee\u9898:"+this.ref.refId);for(var o=0;o<r.length;o+=2){var n=r[o],i=r[o+1]/1e4;s.attrs.push({attrId:n,value:i})}return s;case a.AddBuff:return(s=e).buffCarrierId=this.ref.effectParam[0],s;case a.Invincible:var s;return e}},e.prototype.GetScript=function(){return this.ref.script},e.prototype.GetScriptParam=function(){return this.ref.scriptParam},e.__cname="RefBuffCarrier",e}(s.RefWrap);r.RefBuffCarrier=c,cc._RF.pop()},{"../../framework/FW":void 0,"./RefWrap":"RefWrap"}],RefBuff:[function(t,e,r){"use strict";cc._RF.push(e,"ffcdeY1LLdChb/v8TNNHy0c","RefBuff");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RefBuff=r.RefBuffEventType=r.RefBuffTriggerType=void 0;var i=t("./RefWrap");(function(t){t[t.Weakly=1]="Weakly",t[t.Immediately=2]="Immediately",t[t.HitTarget=3]="HitTarget",t[t.BeHit=4]="BeHit",t[t.Cure=5]="Cure",t[t.KillMonster=6]="KillMonster",t[t.WeaponAttack=7]="WeaponAttack",t[t.Moving=8]="Moving",t[t.Die=9]="Die",t[t.BeforeDie=10]="BeforeDie",t[t.LevelUp=11]="LevelUp",t[t.UpgrateSupply=12]="UpgrateSupply",t[t.GameStart=13]="GameStart",t[t.Game=14]="Game",t[t.WeaponHit=15]="WeaponHit"})(r.RefBuffTriggerType||(r.RefBuffTriggerType={})),function(t){t[t.None=0]="None",t.Attr="1001",t.SkillAttr="1013",t.SetBuff="201503"}(r.RefBuffEventType||(r.RefBuffEventType={}));var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetRefId=function(){return this.ref.refId},e.prototype.GetPreCalculate=function(){return this.ref.preCalculate},e.prototype.GetEvent=function(){return this.ref.event[0]},e.prototype.GetEventType=function(){return this.GetEvent().type},e.prototype.GetEffect=function(){var t=this._effect;if(null==t){t=[],this._effect=t;var e=this.ref.effect;if(e)for(var r=e.length,o=0;o<r;o+=2)t.push({resId:e[o],value:e[o+1]})}return t},e.__cname="RefBuff",e}(i.RefWrap);r.RefBuff=a,cc._RF.pop()},{"./RefWrap":"RefWrap"}],RefChapterMonsterStrong:[function(t,e,r){"use strict";cc._RF.push(e,"d9967gapGhD87ITnJXRDlHn","RefChapterMonsterStrong");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RefChapterMonsterStrong=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetStrong_Chapter=function(){return this.ref.strong/100},e.prototype.GetStrong_Gold=function(){return this.ref.gold_strong/100},e.prototype.GetGold_Gold=function(){return this.ref.gold_gold/100},e.prototype.GetStrong_Daily=function(){return this.ref.daily_strong/100},e.__cname="RefChapterMonsterStrong",e}(t("./RefWrap").RefWrap);r.RefChapterMonsterStrong=i,cc._RF.pop()},{"./RefWrap":"RefWrap"}],RefEnum:[function(t,e,r){"use strict";cc._RF.push(e,"1b833ALTltCNr3CUfRHivAg","RefEnum"),Object.defineProperty(r,"__esModule",{value:!0}),r.GoodsType=void 0,function(t){t[t.playerAtt=1]="playerAtt",t[t.item=2]="item",t[t.equip=3]="equip",t[t.rune=4]="rune"}(r.GoodsType||(r.GoodsType={})),cc._RF.pop()},{}],RefFuben:[function(t,e,r){"use strict";cc._RF.push(e,"34903/EYVlNdYMa+HzZL96r","RefFuben");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RefFuben=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetModify=function(){return this.ref.modify[0]},e.prototype.GetModifySkill=function(){return this.ref.modifySkill},e.__cname="RefFuben",e}(t("./RefWrap").RefWrap);r.RefFuben=i,cc._RF.pop()},{"./RefWrap":"RefWrap"}],RefSkillGroup:[function(t,e,r){"use strict";cc._RF.push(e,"532c1k+6jpBHIGs5CCFyp14","RefSkillGroup");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RefSkillGroup=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetSkillGroup=function(){return this.ref.skillGroup},e.__cname="RefSkillGroup",e}(t("./RefWrap").RefWrap);r.RefSkillGroup=i,cc._RF.pop()},{"./RefWrap":"RefWrap"}],RefSkillLuncher:[function(t,e,r){"use strict";cc._RF.push(e,"c417ehWG9VB37qFnQyGunp/","RefSkillLuncher");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RefSkillLuncher=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetSkillId=function(){return this.ref.skillId},e.prototype.GetLevel=function(){return this.ref.skillLevel},e.prototype.GetGroupId=function(){return this.ref.groupId},e.prototype.GetBullet=function(){return this.ref.targetBullet},e.prototype.GetAttr=function(){return this.ref.attr},e.prototype.GetParam=function(){return this.ref.param},e.prototype.GetBulletParam=function(){return this.ref.bulletParam},e.__cname="RefSkillLuncher",e}(t("./RefWrap").RefWrap);r.RefSkillLuncher=i,cc._RF.pop()},{"./RefWrap":"RefWrap"}],RefWaveNum:[function(t,e,r){"use strict";cc._RF.push(e,"e6308CvMWtB04hRaSBB1cG6","RefWaveNum");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RefWaveNum=r.RefWaveNumTips=void 0;var i=t("./RefWrap");(function(t){t[t.None=0]="None",t[t.Monster=1]="Monster",t[t.Boss=2]="Boss"})(r.RefWaveNumTips||(r.RefWaveNumTips={}));var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetTips=function(){return this.ref.tips},e.prototype.GetPoint=function(){return this.ref.point},e.prototype.GetMonster=function(){return this.ref.monster},e.prototype.GetCameraZoom=function(){return this.ref.cameraZoom},e.prototype.GetTypeId=function(){return this.ref.typeId},e.__cname="RefWaveNum",e}(i.RefWrap);r.RefWaveNum=a,cc._RF.pop()},{"./RefWrap":"RefWrap"}],RefWrap:[function(t,e,r){"use strict";cc._RF.push(e,"07664pGJyVCY5M2cQBqnRXl","RefWrap");var o=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.RefWrap=void 0;var n=function(){function t(){}return t.Create=function(t,e,r){var n,i,a=new Map;try{for(var l=o(t.getRefAll()),s=l.next();!s.done;s=l.next()){var c=s.value,u=new e;u.Setup(c),a.set(c[r],u)}}catch(p){n={error:p}}finally{try{s&&!s.done&&(i=l.return)&&i.call(l)}finally{if(n)throw n.error}}return a},t.prototype.Setup=function(t){this.ref=t},t.prototype.GetRef=function(){return this.ref},t}();r.RefWrap=n,cc._RF.pop()},{}],RefroleAttribute:[function(t,e,r){"use strict";cc._RF.push(e,"e6fc0jaLC9AEYs77jO3gwmm","RefroleAttribute");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RefroleAttribute=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetType=function(){return this.ref.type},e.prototype.GetKey=function(){return this.ref.key},e.prototype.GetIsAddition=function(){return"\u56fa\u5b9a\u503c"==this.GetType()},e.prototype.GetIsRate=function(){return"\u767e\u5206\u6bd4"==this.GetType()},e.prototype.ParseValue=function(t){return"cd"==this.GetKey()&&"\u56fa\u5b9a\u503c"==this.GetType()?t/1e3:"\u56fa\u5b9a\u503c"==this.GetType()?t:"\u767e\u5206\u6bd4"==this.GetType()?t/1e4:t},e.__cname="RefroleAttribute",e}(t("./RefWrap").RefWrap);r.RefroleAttribute=i,cc._RF.pop()},{"./RefWrap":"RefWrap"}],Ref:[function(t,e,r){"use strict";cc._RF.push(e,"1f548BZ+29LzKanaP7vl8Xz","Ref");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0});var c=t("../../engine/ResourceMgr"),u=t("../../framework/container/Container"),p=t("../../framework/ref/RefUtil"),f=t("../../libutil/BigNum"),h=t("../generated/refGen/RefBase"),y=(t("./../../engine/EngineMain"),function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tlRefAllConfig=[],e}return n(e,t),e.prototype.initAsync=function(){return a(this,void 0,void 0,function(){var t,e,r,o,n,i,a,u,h,y,d,m,v,_,S,g,b,C,R,M,w,O,B,P,G;return l(this,function(l){switch(l.label){case 0:return t=this,e=p.RefUtil.tmMergeRef,r={},o="refAllConfig.json",[4,c.ResourceMgr.loadJson(o)];case 1:if(n=l.sent()){t.tlRefAllConfig=n;try{for(i=s(n),a=i.next();!a.done;a=i.next()){u=a.value,h=u.n,y=u.fs;try{for(O=void 0,d=s(y),m=d.next();!m.done;m=d.next())v=m.value,e[v]=h,"firstRefAll"==h&&(r[v]=!0)}catch(k){O={error:k}}finally{try{m&&!m.done&&(B=d.return)&&B.call(d)}finally{if(O)throw O.error}}}}catch(x){M={error:x}}finally{try{a&&!a.done&&(w=i.return)&&w.call(i)}finally{if(M)throw M.error}}c.ResourceMgr.release(o)}_=[t.RefMgrbox,t.RefMgrboxContent,t.RefMgrruneEnhance,t.RefMgrruneQualitySkill,t.RefMgrruneSynthesis,t.RefMgropen,t.RefMgrchapterRef,t.RefMgrchapterMonsterStrong,t.RefMgrchapterBox,t.RefMgrchapterReward,t.RefMgrchapterBuff,t.RefMgrhanging,t.RefMgrchapterMonster,t.RefMgrshowSkill,t.RefMgrgameRule,t.RefMgractiveNewPlayerSign,t.RefMgridConfig,t.RefMgrfundReward,t.RefMgrfund,t.RefMgrfundTypePlan,t.RefMgrbuff,t.RefMgrbuffCarrier,t.RefMgrskillLauncher,t.RefMgrskillGroup,t.RefMgrroleAttribute,t.RefMgrdayWeekMonthGift,t.RefMgrspecialGift,t.RefMgreveryDaySignInDayGift,t.RefMgrmodelRef,t.RefMgrdailyTask,t.RefMgrweeklyTask,t.RefMgrachieveTask,t.RefMgractiveProcess,t.RefMgrtaskReward,t.RefMgrgameConfig,t.RefMgrbigNum,t.RefMgrjumpLayer,t.RefMgrbuySta,t.RefMgrhead,t.RefMgrbreachAttribute,t.RefMgrbreachSkill,t.RefMgritem,t.RefMgrhero,t.RefMgrheroLevel,t.RefMgrheroSkill,t.RefMgrheroPassiveSkill,t.RefMgrheroAnimation,t.RefMgrheroShowGet,t.RefMgrheroAudio,t.RefMgrheroUnlock,t.RefMgrmailContent,t.RefMgrmonthCard,t.RefMgrmonthBuff,t.RefMgrfuBenRef,t.RefMgrfuBenGoldPlan,t.RefMgrfuBenDailyPlan,t.RefMgrfuBenDailyReward,t.RefMgrfuBenCanUseSkillGroupRef,t.RefMgrresitemquality,t.RefMgrsynthesis,t.RefMgrgeneralMaterials,t.RefMgrenhanceConsume,t.RefMgrenhance,t.RefMgrqualitySkill,t.RefMgrluckyCatReward],S=[];try{for(g=s(_),b=g.next();!b.done;b=g.next())C=b.value,R=C.fileName,null!=r[R]&&delete r[R],S.push(C.preloadRef())}catch(T){P={error:T}}finally{try{b&&!b.done&&(G=g.return)&&G.call(g)}finally{if(P)throw P.error}}return[4,Promise.all(S)];case 2:return l.sent(),f.BigNum.tlRefShort=t.RefMgrbigNum.getRefAll(),[2]}})})},e.__cname="Ref",i([u.injectField("ModelMgr")],e.prototype,"modelMgr",void 0),i([u.injectField("CacheMgr")],e.prototype,"cacheMgr",void 0),e}(h.default));r.default=y,cc._RF.pop()},{"../../engine/ResourceMgr":void 0,"../../framework/container/Container":void 0,"../../framework/ref/RefUtil":void 0,"../../libutil/BigNum":void 0,"../generated/refGen/RefBase":"RefBase","./../../engine/EngineMain":void 0}],RequestActivityMsg:[function(t,e,r){"use strict";cc._RF.push(e,"d3d0eJfNtZCgLobP1Vk9f/+","RequestActivityMsg");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RequestActivityConsumeGiftTake=r.RequestActivityMysteriousStoreBuy=r.RequestActivityDayRechargeReward=r.RequestActivityUpdate=r.RequestActivityNewPlayerSignReward=r.RequestActivitySevenDaysGiftReward=r.RequestActivitySevenDaysReward=r.RequestActivityFirstRechargeReward=void 0;var i=t("../../../framework/net/RequestMsg"),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdActivityFirstRechargeRewardReqMsg"},e}(i.RequestMsg);r.RequestActivityFirstRechargeReward=a;var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdActivitySevenDaysRewardReqMsg"},e}(i.RequestMsg);r.RequestActivitySevenDaysReward=l;var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdActivitySevenDaysGiftRewardReqMsg"},e}(i.RequestMsg);r.RequestActivitySevenDaysGiftReward=s;var c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdActivityNewPlayerSignRewardReqMsg"},e}(i.RequestMsg);r.RequestActivityNewPlayerSignReward=c;var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdActivityUpdateReqMsg"},e}(i.RequestMsg);r.RequestActivityUpdate=u;var p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdActivityDayRechargeRewardReqMsg"},e}(i.RequestMsg);r.RequestActivityDayRechargeReward=p;var f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdActivityMysteriousStoreBuyReqMsg"},e}(i.RequestMsg);r.RequestActivityMysteriousStoreBuy=f;var h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdActivityConsumeGiftTakeReqMsg"},e}(i.RequestMsg);r.RequestActivityConsumeGiftTake=h,cc._RF.pop()},{"../../../framework/net/RequestMsg":void 0}],RequestBattleMsg:[function(t,e,r){"use strict";cc._RF.push(e,"b20eezXu+NMGJQElw/lJaA9","RequestBattleMsg");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RequestBattleRevive=r.RequestBattleResult=r.RequestBattleBeat=r.RequestEnterBattle=r.RequestAbandonBattle=void 0;var i=t("../../../framework/net/RequestMsg"),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdAbandonBattleReqMsg"},e}(i.RequestMsg);r.RequestAbandonBattle=a;var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdEnterBattleReqMsg"},e}(i.RequestMsg);r.RequestEnterBattle=l;var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdBattleBeatReqMsg"},e}(i.RequestMsg);r.RequestBattleBeat=s;var c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdBattleResultReqMsg"},e}(i.RequestMsg);r.RequestBattleResult=c;var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdBattleReviveReqMsg"},e}(i.RequestMsg);r.RequestBattleRevive=u,cc._RF.pop()},{"../../../framework/net/RequestMsg":void 0}],RequestBreachMsg:[function(t,e,r){"use strict";cc._RF.push(e,"0bbc1TaNstEoYoiVNZQUd5k","RequestBreachMsg");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RequestBreach=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdBreachReqMsg"},e}(t("../../../framework/net/RequestMsg").RequestMsg);r.RequestBreach=i,cc._RF.pop()},{"../../../framework/net/RequestMsg":void 0}],RequestBuyStaMsg:[function(t,e,r){"use strict";cc._RF.push(e,"43068wZqLxKDa6HS3EwyNK4","RequestBuyStaMsg");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RequestBuyStaInfo=r.RequestBuyStaBuy=void 0;var i=t("../../../framework/net/RequestMsg"),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdBuyStaBuyReqMsg"},e}(i.RequestMsg);r.RequestBuyStaBuy=a;var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdBuyStaInfoReqMsg"},e}(i.RequestMsg);r.RequestBuyStaInfo=l,cc._RF.pop()},{"../../../framework/net/RequestMsg":void 0}],RequestCardMsg:[function(t,e,r){"use strict";cc._RF.push(e,"68e085IYNZPSpGsH3q3Pb/q","RequestCardMsg");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RequestMonthCardDailyReward=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdMonthCardDailyRewardReqMsg"},e}(t("../../../framework/net/RequestMsg").RequestMsg);r.RequestMonthCardDailyReward=i,cc._RF.pop()},{"../../../framework/net/RequestMsg":void 0}],RequestChapterMsg:[function(t,e,r){"use strict";cc._RF.push(e,"3ce81HABY9O8b3Gbk4jNUCP","RequestChapterMsg");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RequestChapterReward=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdChapterRewardReqMsg"},e}(t("../../../framework/net/RequestMsg").RequestMsg);r.RequestChapterReward=i,cc._RF.pop()},{"../../../framework/net/RequestMsg":void 0}],RequestCodeMsg:[function(t,e,r){"use strict";cc._RF.push(e,"5505bgKQ4BIprPlHtRkkedx","RequestCodeMsg");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RequestCodeExchange=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdCodeExchangeReqMsg"},e}(t("../../../framework/net/RequestMsg").RequestMsg);r.RequestCodeExchange=i,cc._RF.pop()},{"../../../framework/net/RequestMsg":void 0}],RequestDayWeekMonthGiftMsg:[function(t,e,r){"use strict";cc._RF.push(e,"64134ilLHFOy7X6FcJGVXxB","RequestDayWeekMonthGiftMsg");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RequestDayWeekMonthGiftFreeBuy=r.RequestDayWeekMonthGiftInfo=r.RequestDayWeekMonthGiftGetReward=void 0;var i=t("../../../framework/net/RequestMsg"),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdDayWeekMonthGiftGetRewardReqMsg"},e}(i.RequestMsg);r.RequestDayWeekMonthGiftGetReward=a;var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdDayWeekMonthGiftInfoReqMsg"},e}(i.RequestMsg);r.RequestDayWeekMonthGiftInfo=l;var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdDayWeekMonthGiftFreeBuyReqMsg"},e}(i.RequestMsg);r.RequestDayWeekMonthGiftFreeBuy=s,cc._RF.pop()},{"../../../framework/net/RequestMsg":void 0}],RequestEquipMsg:[function(t,e,r){"use strict";cc._RF.push(e,"9d5a2uHl4ZH4KTEc8wCbljx","RequestEquipMsg");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RequestEquipDownPhase=r.RequestEquipSynthesisOneKey=r.RequestEquipSynthesis=r.RequestEquipUpLevelOneKey=r.RequestEquipUpLevel=r.RequestEquipDownLevel=r.RequestEquipTakeOff=r.RequestEquipPutOn=void 0;var i=t("../../../framework/net/RequestMsg"),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdEquipPutOnReqMsg"},e}(i.RequestMsg);r.RequestEquipPutOn=a;var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdEquipTakeOffReqMsg"},e}(i.RequestMsg);r.RequestEquipTakeOff=l;var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdEquipDownLevelReqMsg"},e}(i.RequestMsg);r.RequestEquipDownLevel=s;var c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdEquipUpLevelReqMsg"},e}(i.RequestMsg);r.RequestEquipUpLevel=c;var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdEquipUpLevelOneKeyReqMsg"},e}(i.RequestMsg);r.RequestEquipUpLevelOneKey=u;var p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdEquipSynthesisReqMsg"},e}(i.RequestMsg);r.RequestEquipSynthesis=p;var f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdEquipSynthesisOneKeyReqMsg"},e}(i.RequestMsg);r.RequestEquipSynthesisOneKey=f;var h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdEquipDownPhaseReqMsg"},e}(i.RequestMsg);r.RequestEquipDownPhase=h,cc._RF.pop()},{"../../../framework/net/RequestMsg":void 0}],RequestEveryDaySignMsg:[function(t,e,r){"use strict";cc._RF.push(e,"b97faIcQ6xNZJzYc2Gl8u4m","RequestEveryDaySignMsg");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RequestEveryDayGetRewards=r.RequestEveryDaySignIn=r.RequestEveryDaySignInInfo=void 0;var i=t("../../../framework/net/RequestMsg"),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdEveryDaySignInInfoReqMsg"},e}(i.RequestMsg);r.RequestEveryDaySignInInfo=a;var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdEveryDaySignInReqMsg"},e}(i.RequestMsg);r.RequestEveryDaySignIn=l;var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdEveryDayGetRewardsReqMsg"},e}(i.RequestMsg);r.RequestEveryDayGetRewards=s,cc._RF.pop()},{"../../../framework/net/RequestMsg":void 0}],RequestFirstRechargeMsg:[function(t,e,r){"use strict";cc._RF.push(e,"a55f1DGwy5Kd7yTFw+8yG5d","RequestFirstRechargeMsg");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RequestFirstRechargeOpen=r.RequestFirstRechargeReward=void 0;var i=t("../../../framework/net/RequestMsg"),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdFirstRechargeRewardReqMsg"},e}(i.RequestMsg);r.RequestFirstRechargeReward=a;var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdFirstRechargeOpenReqMsg"},e}(i.RequestMsg);r.RequestFirstRechargeOpen=l,cc._RF.pop()},{"../../../framework/net/RequestMsg":void 0}],RequestFriendsMsg:[function(t,e,r){"use strict";cc._RF.push(e,"17e98dk5Y9FypiVTtTGfG5U","RequestFriendsMsg");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RequestFriendRefreshSuggest=r.RequestFriendBlackRemove=r.RequestFriendLike=r.RequestFriendDetail=r.RequestFriendRefuseOneKey=r.RequestFriendAgreeOneKey=r.RequestFriendSendEndOneKey=r.RequestFriendSendEnd=r.RequestFriendGetEndOneKey=r.RequestFriendGetEnd=r.RequestFriendsSearch=r.RequestFriendsBlack=r.RequestFriendsRemove=r.RequestFriendsRefuse=r.RequestFriendsAdd=r.RequestFriendsApply=void 0;var i=t("../../../framework/net/RequestMsg"),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdFriendsApplyReqMsg"},e}(i.RequestMsg);r.RequestFriendsApply=a;var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdFriendsAddReqMsg"},e}(i.RequestMsg);r.RequestFriendsAdd=l;var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdFriendsRefuseReqMsg"},e}(i.RequestMsg);r.RequestFriendsRefuse=s;var c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdFriendsRemoveReqMsg"},e}(i.RequestMsg);r.RequestFriendsRemove=c;var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdFriendsBlackReqMsg"},e}(i.RequestMsg);r.RequestFriendsBlack=u;var p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdFriendsSearchReqMsg"},e}(i.RequestMsg);r.RequestFriendsSearch=p;var f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdFriendGetEndReqMsg"},e}(i.RequestMsg);r.RequestFriendGetEnd=f;var h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdFriendGetEndOneKeyReqMsg"},e}(i.RequestMsg);r.RequestFriendGetEndOneKey=h;var y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdFriendSendEndReqMsg"},e}(i.RequestMsg);r.RequestFriendSendEnd=y;var d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdFriendSendEndOneKeyReqMsg"},e}(i.RequestMsg);r.RequestFriendSendEndOneKey=d;var m=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdFriendAgreeOneKeyReqMsg"},e}(i.RequestMsg);r.RequestFriendAgreeOneKey=m;var v=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdFriendRefuseOneKeyReqMsg"},e}(i.RequestMsg);r.RequestFriendRefuseOneKey=v;var _=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdFriendDetailReqMsg"},e}(i.RequestMsg);r.RequestFriendDetail=_;var S=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdFriendLikeReqMsg"},e}(i.RequestMsg);r.RequestFriendLike=S;var g=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdFriendBlackRemoveReqMsg"},e}(i.RequestMsg);r.RequestFriendBlackRemove=g;var b=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdFriendRefreshSuggestReqMsg"},e}(i.RequestMsg);r.RequestFriendRefreshSuggest=b,cc._RF.pop()},{"../../../framework/net/RequestMsg":void 0}],RequestFuBenMsg:[function(t,e,r){"use strict";cc._RF.push(e,"4546eV2popBJbsde+05+Yxh","RequestFuBenMsg");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RequestFuBenBuyTimes=r.RequestFuBenDailyGetReward=r.RequestFuBenEnter=void 0;var i=t("../../../framework/net/RequestMsg"),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdFuBenEnterReqMsg"},e}(i.RequestMsg);r.RequestFuBenEnter=a;var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdFuBenDailyGetRewardReqMsg"},e}(i.RequestMsg);r.RequestFuBenDailyGetReward=l;var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdFuBenBuyTimesReqMsg"},e}(i.RequestMsg);r.RequestFuBenBuyTimes=s,cc._RF.pop()},{"../../../framework/net/RequestMsg":void 0}],RequestFundMsg:[function(t,e,r){"use strict";cc._RF.push(e,"a66b2kl06lESJpC4Qrw1YKC","RequestFundMsg");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RequestFundGetReward=r.RequestFundGetInfo=void 0;var i=t("../../../framework/net/RequestMsg"),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdFundGetInfoReqMsg"},e}(i.RequestMsg);r.RequestFundGetInfo=a;var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdFundGetRewardReqMsg"},e}(i.RequestMsg);r.RequestFundGetReward=l,cc._RF.pop()},{"../../../framework/net/RequestMsg":void 0}],RequestGuideMsg:[function(t,e,r){"use strict";cc._RF.push(e,"81c54SGqHBJPIghZ1cUMcj0","RequestGuideMsg");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RequestGuideRead=r.RequestGuideRecord=void 0;var i=t("../../../framework/net/RequestMsg"),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdGuideRecordReqMsg"},e}(i.RequestMsg);r.RequestGuideRecord=a;var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdGuideReadReqMsg"},e}(i.RequestMsg);r.RequestGuideRead=l,cc._RF.pop()},{"../../../framework/net/RequestMsg":void 0}],RequestHallMsg:[function(t,e,r){"use strict";cc._RF.push(e,"8c05fvSWEJKd5n3nN1m0PuO","RequestHallMsg");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RequestGetHallRoleList=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdGetHallRoleListReqMsg"},e}(t("../../../framework/net/RequestMsg").RequestMsg);r.RequestGetHallRoleList=i,cc._RF.pop()},{"../../../framework/net/RequestMsg":void 0}],RequestHangMsg:[function(t,e,r){"use strict";cc._RF.push(e,"59af1iM+IhBqoztlLKNEhX/","RequestHangMsg");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RequestHangTime=r.RequestHangQuick=r.RequestHangGetReward=void 0;var i=t("../../../framework/net/RequestMsg"),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdHangGetRewardReqMsg"},e}(i.RequestMsg);r.RequestHangGetReward=a;var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdHangQuickReqMsg"},e}(i.RequestMsg);r.RequestHangQuick=l;var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdHangTimeReqMsg"},e}(i.RequestMsg);r.RequestHangTime=s,cc._RF.pop()},{"../../../framework/net/RequestMsg":void 0}],RequestHeroMsg:[function(t,e,r){"use strict";cc._RF.push(e,"de20e/so+9BqLSCRxz7j843","RequestHeroMsg");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RequestHeroUnlockReward=r.RequestHeroUnlockGetInfo=r.RequestHeroOpen=r.RequestHeroLevelUpOneKey=r.RequestHeroLevelUp=r.RequestHeroChange=void 0;var i=t("../../../framework/net/RequestMsg"),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdHeroChangeReqMsg"},e}(i.RequestMsg);r.RequestHeroChange=a;var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdHeroLevelUpReqMsg"},e}(i.RequestMsg);r.RequestHeroLevelUp=l;var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdHeroLevelUpOneKeyReqMsg"},e}(i.RequestMsg);r.RequestHeroLevelUpOneKey=s;var c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdHeroOpenReqMsg"},e}(i.RequestMsg);r.RequestHeroOpen=c;var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdHeroUnlockGetInfoReqMsg"},e}(i.RequestMsg);r.RequestHeroUnlockGetInfo=u;var p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdHeroUnlockRewardReqMsg"},e}(i.RequestMsg);r.RequestHeroUnlockReward=p,cc._RF.pop()},{"../../../framework/net/RequestMsg":void 0}],RequestItemMsg:[function(t,e,r){"use strict";cc._RF.push(e,"800a8wWxuRP9KrxVp8/Nnwk","RequestItemMsg");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RequestItemBoxUse=r.RequestItemUse=void 0;var i=t("../../../framework/net/RequestMsg"),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdItemUseReqMsg"},e}(i.RequestMsg);r.RequestItemUse=a;var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdItemBoxUseReqMsg"},e}(i.RequestMsg);r.RequestItemBoxUse=l,cc._RF.pop()},{"../../../framework/net/RequestMsg":void 0}],RequestMailMsg:[function(t,e,r){"use strict";cc._RF.push(e,"e857fnGoNBH5qbkqYDGLvAV","RequestMailMsg");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RequestMailDraw=r.RequestMailDelete=r.RequestMailDeleteList=r.RequestMailRead=r.RequestMailList=void 0;var i=t("../../../framework/net/RequestMsg"),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdMailListReqMsg"},e}(i.RequestMsg);r.RequestMailList=a;var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdMailReadReqMsg"},e}(i.RequestMsg);r.RequestMailRead=l;var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdMailDeleteListReqMsg"},e}(i.RequestMsg);r.RequestMailDeleteList=s;var c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdMailDeleteReqMsg"},e}(i.RequestMsg);r.RequestMailDelete=c;var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdMailDrawReqMsg"},e}(i.RequestMsg);r.RequestMailDraw=u,cc._RF.pop()},{"../../../framework/net/RequestMsg":void 0}],RequestMallMsg:[function(t,e,r){"use strict";cc._RF.push(e,"59bedpNwKZMI5S928+I4iGG","RequestMallMsg");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RequestMallGetData=r.RequestMallCoinBuy=r.RequestMallDailyShopBuy=r.RequestMallLuckDraw=r.RequestMallSEquipDraw=void 0;var i=t("../../../framework/net/RequestMsg"),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdMallSEquipDrawReqMsg"},e}(i.RequestMsg);r.RequestMallSEquipDraw=a;var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdMallLuckDrawReqMsg"},e}(i.RequestMsg);r.RequestMallLuckDraw=l;var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdMallDailyShopBuyReqMsg"},e}(i.RequestMsg);r.RequestMallDailyShopBuy=s;var c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdMallCoinBuyReqMsg"},e}(i.RequestMsg);r.RequestMallCoinBuy=c;var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdMallGetDataReqMsg"},e}(i.RequestMsg);r.RequestMallGetData=u,cc._RF.pop()},{"../../../framework/net/RequestMsg":void 0}],RequestRankMsg:[function(t,e,r){"use strict";cc._RF.push(e,"b815bn3ga1KdoqRW4aNkNSO","RequestRankMsg");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RequestGetRankList=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdGetRankListReqMsg"},e}(t("../../../framework/net/RequestMsg").RequestMsg);r.RequestGetRankList=i,cc._RF.pop()},{"../../../framework/net/RequestMsg":void 0}],RequestRedDotMsg:[function(t,e,r){"use strict";cc._RF.push(e,"8a27eC0WUVBkao+VQTTSim8","RequestRedDotMsg");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RequestGoodsRedDotDispel=r.RequestUpdateRedDot=void 0;var i=t("../../../framework/net/RequestMsg"),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdUpdateRedDotReqMsg"},e}(i.RequestMsg);r.RequestUpdateRedDot=a;var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdGoodsRedDotDispelReqMsg"},e}(i.RequestMsg);r.RequestGoodsRedDotDispel=l,cc._RF.pop()},{"../../../framework/net/RequestMsg":void 0}],RequestRoleMsg:[function(t,e,r){"use strict";cc._RF.push(e,"a2d12tq6sdGuoIL1s1lgaxW","RequestRoleMsg");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RequestRoleEndUpdate=r.RequestRoleRechargeReward=r.RequestRoleChangeHeadFrame=r.RequestRoleChangeImg=r.RequestRoleChangeName=r.RequestRoleLogin=r.RequestRoleRegister=void 0;var i=t("../../../framework/net/RequestMsg"),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdRoleRegisterReqMsg"},e}(i.RequestMsg);r.RequestRoleRegister=a;var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdRoleLoginReqMsg"},e}(i.RequestMsg);r.RequestRoleLogin=l;var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdRoleChangeNameReqMsg"},e}(i.RequestMsg);r.RequestRoleChangeName=s;var c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdRoleChangeImgReqMsg"},e}(i.RequestMsg);r.RequestRoleChangeImg=c;var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdRoleChangeHeadFrameReqMsg"},e}(i.RequestMsg);r.RequestRoleChangeHeadFrame=u;var p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdRoleRechargeRewardReqMsg"},e}(i.RequestMsg);r.RequestRoleRechargeReward=p;var f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdRoleEndUpdateReqMsg"},e}(i.RequestMsg);r.RequestRoleEndUpdate=f,cc._RF.pop()},{"../../../framework/net/RequestMsg":void 0}],RequestRuneMsg:[function(t,e,r){"use strict";cc._RF.push(e,"cc0d3uQGQ1Bt6YyexNTFTWI","RequestRuneMsg");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RequestRuneSynthesisOneKey=r.RequestRuneSynthesis=r.RequestRuneReplace=r.RequestRuneTakeOff=r.RequestRunePutOn=void 0;var i=t("../../../framework/net/RequestMsg"),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdRunePutOnReqMsg"},e}(i.RequestMsg);r.RequestRunePutOn=a;var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdRuneTakeOffReqMsg"},e}(i.RequestMsg);r.RequestRuneTakeOff=l;var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdRuneReplaceReqMsg"},e}(i.RequestMsg);r.RequestRuneReplace=s;var c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdRuneSynthesisReqMsg"},e}(i.RequestMsg);r.RequestRuneSynthesis=c;var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdRuneSynthesisOneKeyReqMsg"},e}(i.RequestMsg);r.RequestRuneSynthesisOneKey=u,cc._RF.pop()},{"../../../framework/net/RequestMsg":void 0}],RequestShareMsg:[function(t,e,r){"use strict";cc._RF.push(e,"d535f6b1ANATJVNFPmubKcu","RequestShareMsg");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RequestShareGetReward=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdShareGetRewardReqMsg"},e}(t("../../../framework/net/RequestMsg").RequestMsg);r.RequestShareGetReward=i,cc._RF.pop()},{"../../../framework/net/RequestMsg":void 0}],RequestSystemMsg:[function(t,e,r){"use strict";cc._RF.push(e,"04c0c0JnApIFro8CQHlef/n","RequestSystemMsg");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RequestGetAllPlayClientAni=r.RequestRecordClientAni=r.RequestGmList=r.RequestSystemGm=r.RequestSystemSyncTime=void 0;var i=t("../../../framework/net/RequestMsg"),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdSystemSyncTimeReqMsg"},e}(i.RequestMsg);r.RequestSystemSyncTime=a;var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdSystemGmReqMsg"},e}(i.RequestMsg);r.RequestSystemGm=l;var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdGmListReqMsg"},e}(i.RequestMsg);r.RequestGmList=s;var c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdRecordClientAniReqMsg"},e}(i.RequestMsg);r.RequestRecordClientAni=c;var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdGetAllPlayClientAniReqMsg"},e}(i.RequestMsg);r.RequestGetAllPlayClientAni=u,cc._RF.pop()},{"../../../framework/net/RequestMsg":void 0}],RequestTaskMsg:[function(t,e,r){"use strict";cc._RF.push(e,"fe156aA5fNHkLrJ1tMFvan1","RequestTaskMsg");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RequestTakeActiveReward=r.RequestTaskGetInfo=r.RequestTaskGetReward=void 0;var i=t("../../../framework/net/RequestMsg"),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdTaskGetRewardReqMsg"},e}(i.RequestMsg);r.RequestTaskGetReward=a;var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdTaskGetInfoReqMsg"},e}(i.RequestMsg);r.RequestTaskGetInfo=l;var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getReqMsgProtoName=function(){return"CmdTakeActiveRewardReqMsg"},e}(i.RequestMsg);r.RequestTakeActiveReward=s,cc._RF.pop()},{"../../../framework/net/RequestMsg":void 0}],RobotPrefabBehavior:[function(t,e,r){"use strict";cc._RF.push(e,"c8c41mI6h9AlZHjF3pqI20d","RobotPrefabBehavior");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.RobotPrefabBehavior=void 0;var a=t("../../../../../../../framework/container/Container"),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.Update=function(t,e){var r=this.ComPos.x,o=this.ComPos.y,n=t.x,i=t.y,a=cc.misc.lerp(n,r[e],.1),l=cc.misc.lerp(i,o[e],.1);t.SetXY(a,l)},e.__cname="RobotPrefabBehavior",i([a.injectField("ComPos")],e.prototype,"ComPos",void 0),e}(t("./BasePrefabBehavior").BasePrefabBehavior);r.RobotPrefabBehavior=l,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"./BasePrefabBehavior":"BasePrefabBehavior"}],RoleBuilder:[function(t,e,r){"use strict";cc._RF.push(e,"961d5qMfDJF6IUXtI3J1z8a","RoleBuilder");var o=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.RoleBuilder=r.RBContext=void 0;var n=t("../../../../../../framework/container/Container"),i=t("../../view/prefab/ComPrefab"),a=t("../move/ComPos"),l=t("../move/ComVelocity"),s=t("../physical/ComCollision"),c=t("../state/ComState"),u=t("../type/ComType"),p=t("../var/ComVar");r.RBContext=function(){};var f=function(){function t(){this.tmCom=new Map,this.tmProperty=new Map}return t.prototype.Setup=function(t){this.ClearProperty(),this.context=t,this.OnSetup(t)},t.prototype.GetTlComClazz=function(){var t=this.tlComClazz;return null==t&&(t=this.OnGetTlComClazz(),this.tlComClazz=t),t},t.prototype.SetCom=function(t){for(var e=this.GetTlComClazz(),r=0;r<e.length;r++){var o=e[r],n=t[r];this.tmCom.set(o,n)}},t.prototype.GetCom=function(t){return this.tmCom.get(t)},t.prototype.SetContainer=function(t){null==this.container&&(this.container=t,t.inject(this))},t.prototype.SetProperty=function(t,e){this.tmProperty.set(t,e)},t.prototype.GetProperty=function(t){return this.tmProperty.get(t)||0},t.prototype.HasProperty=function(t){return this.tmProperty.has(t)},t.prototype.ClearProperty=function(){this.tmProperty.clear()},t.prototype.OnSetup=function(){},t.prototype.ApplyBullet=function(t,e,r,o){var n=this.GetCom(l.ComVelocity),f=this.GetCom(p.ComVar),h=this.GetCom(s.ComCollision),y=this.GetCom(i.ComPrefab),d=this.GetCom(a.ComPos),m=(this.GetCom(c.ComState),this.GetCom(u.ComType)),v=this.ModelBattleSkill.GetBullet(r),_=v.GetModel(0),S=v.GetDamageRange();if(d.dType[e]=v.GetDirectionType(),n){var g=v.GetSpeed();n.speed[e]=f.CalAttr(t,"bsp",g)}var b=v.GetLifeTime();this.GetProperty("has_let")&&(b=f.CalAttr(t,"let",b)),m.ClearTag(e),this.HasProperty("bullet_tag")&&m.AddTag(e,this.GetProperty("bullet_tag"));var C=v.GetScriptParam(),R=this.GPSkillData.GetBulletParam(r);R&&(C=R),f.HP[e]=1,f.CAMP[e]=f.CAMP[t],f.SHOOT_TARGET[e]=f.SHOOT_TARGET[t],f.BULLET_SENDER[e]=t,f.PENETRATE[e]=v.GetPenetrate(),f.BULLET_KILLER[e]=v.GetBulletKiller(),f.BULLET_REBOUND[e]=v.GetRebound(),f.BULLET_REPEL[e]=v.GetRepel()*(1+(f.SKILL_REPEL[this.GetProperty("skill_attr_modify")]||0)),f.BULLET_LIFETIME[e]=b,f.BULLET_EFFECT_TIME[e]=v.GetLifeTime(),f.BULLET_SCRIPT_PARAMS[e]=C,f.BULLET_ATTR_DAMAGE_RATE[e]=o||v.GetDamageRate(),f.BULLET_DAMAGE_INTERVAL[e]=v.GetDamageInterval(),f.BULLET_BUILDER[e]=this.GetProperty("builder"),f.BULLET_SKILL[e]=this.GetProperty("skill_attr_modify"),f.BULLET_ATTR_BVE[e]=1==this.GetProperty("has_bve"),f.BULLET_REF[e]=v,f.BULLET_SCALE_RATE[e]=S;var M=v.GetPrototypeSizeBy(_);f.BULLET_MODEL_PROTOTYPE_SIZE[e]=M;var w=v.GetDamageRadiusBy(_),O=f.CalBulletPrototypeSize(e,w);if(h.r[e]=O,h.isTrigger[e]=!0,h.recycle[e]=!1,this.OnOffMgr.OnOffEffectWeakening.GetValue()){var B=this.ModelGameConfig.GetGameConfigValueByKey("BattleEffectWeak")/100;y.alpha[e]=B}var P=f.CalBulletPrototypeSize(e,M);y.ChangeModel(e,_,0,0,null,P);var G=this.GetProperty("order");G&&(y.order[e]=G)},o([n.injectField("ModelBattleSkill")],t.prototype,"ModelBattleSkill",void 0),o([n.injectField("ModelPrefab")],t.prototype,"ModelPrefab",void 0),o([n.injectField("OnOffMgr")],t.prototype,"OnOffMgr",void 0),o([n.injectField("ModelGameConfig")],t.prototype,"ModelGameConfig",void 0),o([n.injectField("GPSkillData")],t.prototype,"GPSkillData",void 0),o([n.injectField("SystemEvent")],t.prototype,"SystemEvent",void 0),t}();r.RoleBuilder=f,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../view/prefab/ComPrefab":"ComPrefab","../move/ComPos":"ComPos","../move/ComVelocity":"ComVelocity","../physical/ComCollision":"ComCollision","../state/ComState":"ComState","../type/ComType":"ComType","../var/ComVar":"ComVar"}],RoulettelProxy:[function(t,e,r){"use strict";cc._RF.push(e,"1b941SJ3MJKE4Wlk0JdJqjh","RoulettelProxy");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.RouttelProxyMgr=r.RouttelProxy=r.RoulettelBlock=void 0;var l=t("../../../../../../framework/base/ScriptObject"),s=function(){function t(){this.tlSuffer=new Set}return t.prototype.Clear=function(){this.tlSuffer.clear()},t.prototype.Mark=function(t){this.tlSuffer.add(t)},t}();r.RoulettelBlock=s;var c=function(){function t(){this.tmBlock=new Map,this.tmLastTick=new Map}return t.prototype.Clear=function(){var t,e;try{for(var r=i(this.tmBlock),o=r.next();!o.done;o=r.next()){var n=a(o.value,2);n[0],n[1].Clear()}}catch(l){t={error:l}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}this.tmLastTick.clear()},t.prototype.Mark=function(t){var e=t[0];this.mgr.Battle.ref2id(t)||this.ClearSender(e);var r=this.mgr.tick;this.GetBlock(r).Mark(t);var o=this.mgr.totalTick;this.tmLastTick.set(e,o)},t.prototype.Check=function(t,e){var r=t[0],o=this.tmLastTick.get(r);return null==o||(this.mgr.Battle.ref2id(t)?this.mgr.totalTick-o>=e:(this.ClearSender(r),!0))},t.prototype.GetBlock=function(t){var e=this.tmBlock.get(t);null==e&&((e=new s).mgr=this.mgr,this.tmBlock.set(t,e));var r=this.mgr.round;return r!=e.round&&(e.Clear(),e.round=r),e},t.prototype.ClearSender=function(t){this.tmLastTick.delete(t)},t}();r.RouttelProxy=c;var u=function(t){function e(e){var r=t.call(this)||this;return r.frame=0,r.totalTick=0,r.tick=0,r.round=0,r.isNewRound=!1,r.tmRoulettel=new Map,r.Battle=e,r}return n(e,t),e.prototype.onDestroy=function(){var t,e;try{for(var r=i(this.tmRoulettel),o=r.next();!o.done;o=r.next()){var n=a(o.value,2);n[0],n[1].Clear()}}catch(l){t={error:l}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}this.tmRoulettel.clear()},e.prototype.OnAddEntity=function(t){this.AddRouttel(t)},e.prototype.OnRemoveEntity=function(t){this.RemoveRouttel(t)},e.prototype.Update=function(){this.UpdateTick(),this.isNewRound=!1},e.prototype.UpdateTick=function(){var t=this.frame++,e=cc.game.getFrameRate(),r=10*Math.floor(t/e)+Math.floor(t%e/e*10),o=r%10;this.totalTick=r,this.tick=o,0!=r&&o==e&&(this.isNewRound=!0,this.round++)},e.prototype.GetIsNewRound=function(){return this.isNewRound},e.prototype.AddRouttel=function(t){var e=new c;e.mgr=this,this.tmRoulettel.set(t,e)},e.prototype.GetRouttel=function(t){return this.tmRoulettel.get(t)},e.prototype.RemoveRouttel=function(t){var e=this.tmRoulettel.get(t);e&&(e.Clear(),this.tmRoulettel.delete(t))},e.prototype.checkDamateRoulettle=function(t,e,r){var o=e[0],n=this.GetRouttel(o).Check(t,r);return n&&this.markDamageRoulettle(t,e),n},e.prototype.markDamageRoulettle=function(t,e){var r=e[0];this.GetRouttel(r).Mark(t)},e.__cname="RouttelProxyMgr",e}(l.ScriptObject);r.RouttelProxyMgr=u,cc._RF.pop()},{"../../../../../../framework/base/ScriptObject":void 0}],RuneBehavior:[function(t,e,r){"use strict";cc._RF.push(e,"3343asZ4pZCSoHdenb2hbD4","RuneBehavior");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.RuneBehavior=void 0;var i=t("../../alert/PanelPopInfo"),a=t("./GObjGoodsBehavior"),l=new Map;l.set(1,"\u767d"),l.set(2,"\u7eff"),l.set(3,"\u84dd"),l.set(4,"\u7d2b"),l.set(5,"\u91d1"),l.set(6,"\u7ea2");var s=new Map;s.set(17,"\u653b\u51fb"),s.set(18,"\u9632\u5fa1");var c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetUrl=function(){return"ui://\u5171\u7528\u7ec4\u4ef6/\u7269\u54c1\u6846_\u7b26\u6587"},e.prototype.onReset=function(){},e.prototype.onGetIconLoader=function(){return this.com.tm("icon")},e.prototype.onIconVisible=function(t){this.onGetIconLoader().visible=t},e.prototype.onGetIconEffectLoader=function(){return this.com.tm("iconEffect")},e.prototype.onIconEffectVisible=function(t){this.onGetIconEffectLoader().visible=t},e.prototype.onGetUnderEffectLoader=function(){return this.com.tm("underEffect")},e.prototype.onUnderEffectVisible=function(t){this.onGetUnderEffectLoader().visible=t},e.prototype.onGetSKillIconLoader=function(){return this.com.tm("icon_skill")},e.prototype.onTitleUpdate=function(t){this.com.tm("text_name").text=t},e.prototype.onTitleVisible=function(t){this.com.tm("text_name").visible=t},e.prototype.onNumberUpdate=function(t){this.com.tm("text_number").text=t},e.prototype.onNumberVisible=function(t){this.com.tm("text_number").visible=t},e.prototype.onFrameUpdate=function(t){this.com.setSelectedPage("\u54c1\u8d28",l.get(t))},e.prototype.onFrameVisible=function(t){this.com.tm("icon_frame").visible=t},e.prototype.OnGetRDComponent=function(){return this.com.tm("\u7ea2\u70b9")},e.prototype.onPhaseVisible=function(t){this.com.setSelectedIndex("\u9636\u7ea7\u663e\u793a",t?1:0)},e.prototype.onPhaseTextUpdate=function(t){this.com.tm("text_phase").text=t},e.prototype.onRuneTypeUpdate=function(t){this.com.setSelectedPage("\u7b26\u6587\u7c7b\u578b",s.get(t))},e.prototype.onTypeVisible=function(t){this.com.tm("icon_type").visible=t},e.prototype.onSkillVisible=function(t){this.com.tm("bg_skill").visible=t,this.com.tm("icon_skill").visible=t},e.prototype.Clean=function(){this.onGetIconLoader().Clean(),this.onGetIconEffectLoader().Clean(),this.onGetUnderEffectLoader().Clean(),this.onGetSKillIconLoader().Clean(),this.onNumberUpdate(""),this.onTitleUpdate(""),this.onFrameUpdate(1),this.onRuneTypeUpdate(17),this.onPhaseTextUpdate(""),this.onPhaseVisible(!1)},e.prototype.onUpdateByGoods=function(t){this.onGetIconLoader().SetUrlByIcon(t.GetIconUrl()),this.onGetSKillIconLoader().SetUrlByIcon(t.GetSkillIconUrl()),this.onTitleUpdate(t.GetName()),this.onNumberUpdate(t.GetNumberStr()),this.onFrameUpdate(t.GetQuality()),this.onPhaseTextUpdate(t.GetPhaseStr()),this.onRuneTypeUpdate(t.GetGoodsType()),this.onPhaseVisible(t.GetIsShowPhase());var e=t.GetIconEffect();null!=e&&this.onGetIconEffectLoader().SetUrlByIcon(e);var r=t.GetUnderEffect();null!=r&&this.onGetUnderEffectLoader().SetUrlByIcon(r),this.onIconEffectVisible(null!=e),this.onUnderEffectVisible(null!=r)},e.prototype.onSelectedUpdate=function(t){this.com.tm("icon_selected").visible=t},e.prototype.onGrayUpdate=function(t){this.com.grayed=t},e.prototype.showTips=function(t,e){var r=t.GetRef(),o=e.addPanel(i.PanelPopInfo);o.SetParent(this.com),o.SetTitle(r.name),o.SetContent(r.desc),o.SetTitleVisible(!0),o.SetShowArrow(!0)},e.__cname="RuneBehavior",e}(a.GObjGoodsBehavior);r.RuneBehavior=c,cc._RF.pop()},{"../../alert/PanelPopInfo":"PanelPopInfo","./GObjGoodsBehavior":"GObjGoodsBehavior"}],SBBoss:[function(t,e,r){"use strict";cc._RF.push(e,"2660bxOe2JCtLramGJGF8sa","SBBoss");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.SBBoss=void 0;var a=t("../../../../../../../framework/container/Container"),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.Apply=function(){var t=this.ComPos.x,e=this.ComPos.y,r=this.startX,o=this.startY;if(isNaN(r)){var n=this.ComVar.HEROID;r=t[n],o=e[n]+100}for(var i=this.monster,a=this.SystemRole.CreateEntity(i,r,o),l=this.ComVar.BOSS_CREATE_NUM,s=1;s<l;s++){var c=this.SystemRole.CreateEntity(i,r,o+200*s);this.ComVar.BOSS_COPY[c]=a}this.Battle.applyModify(),this.SystemEvent.sendBossGen(a)},e.prototype.GetMaxNum=function(){return 1},e.prototype.GetXY=function(){throw new Error("Method not implemented.")},e.__cname="SBBoss",i([a.injectField("ComVar")],e.prototype,"ComVar",void 0),i([a.injectField("ComPos")],e.prototype,"ComPos",void 0),i([a.injectField("SystemRole")],e.prototype,"SystemRole",void 0),i([a.injectField("Battle")],e.prototype,"Battle",void 0),i([a.injectField("SystemEvent")],e.prototype,"SystemEvent",void 0),e}(t("./SpawnBuilder").SpawnBuilder);r.SBBoss=l,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"./SpawnBuilder":"SpawnBuilder"}],SBBox:[function(t,e,r){"use strict";cc._RF.push(e,"c08f3iecdtIFLkRMpEC2X1g","SBBox");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.SBBox=r.SBBoxContext=void 0;var l=t("../../../../../../../framework/container/Container"),s=t("../../type/ComType"),c=t("./SpawnBuilder"),u=function(){};r.SBBoxContext=u;var p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._context=new u,e._dirtyContext=!1,e._tlInner=[],e._tlOuter=[],e}return n(e,t),e.prototype.GetContext=function(){return this._context},e.prototype.SetContext=function(t){this._context=t,this._dirtyContext=!0},e.prototype.Apply=function(){var t,e,r,o;if(0!=this._dirtyContext){this._dirtyContext=!1;var n=this._context,i=n.radiusMin,l=n.radiusMax,c=this.GetMaxNum(),u=n.num,p=n.radiusDestroy,f=this.startX,h=this.startY,y=this.ComPos.x,d=this.ComPos.y,m=this.ComVar.HEROID,v=!1,_=this.ComType.GetGroup(s.EComType.PropBox),S=this._tlInner,g=this._tlOuter,b=0,C=0;S.length=0,g.length=0;var R=p*p;try{for(var M=a(_),w=M.next();!w.done;w=M.next()){var O=w.value,B=y[O]-y[m],P=d[O]-d[m];P*P+B*B>=R?g.push(O):S.push(O)}}catch(E){t={error:E}}finally{try{w&&!w.done&&(e=M.return)&&e.call(M)}finally{if(t)throw t.error}}S.length<c&&(C=u,_.length+C>c&&0!=(b=_.length+C-c)&&C>b&&(C=b));var G=0;try{for(var k=a(g),x=k.next();!x.done;x=k.next()){var T=x.value;G<b&&(this.ComState.SwitchDestroy(T),this.SystemEvent.sendKillBox(T),G++,v=!0)}}catch(A){r={error:A}}finally{try{x&&!x.done&&(o=k.return)&&o.call(k)}finally{if(r)throw r.error}}if(C>0){for(var j=0;j<C;j++){var I=2*Math.random()*Math.PI,D=Math.random()*(l-i)+i,F=f+Math.cos(I)*D,L=h+Math.sin(I)*D;this.SystemRole.CreateBox(F,L)}v=!0}v&&this.Battle.applyModify()}},e.prototype.GetMaxNum=function(){var t=0;return this._context&&(t=this._context.numMax||0),t},e.prototype.GetXY=function(){},e.__cname="SBBox",i([l.injectField("ComPos")],e.prototype,"ComPos",void 0),i([l.injectField("ComType")],e.prototype,"ComType",void 0),i([l.injectField("ComVar")],e.prototype,"ComVar",void 0),i([l.injectField("ComState")],e.prototype,"ComState",void 0),i([l.injectField("Battle")],e.prototype,"Battle",void 0),i([l.injectField("SystemRole")],e.prototype,"SystemRole",void 0),i([l.injectField("SystemEvent")],e.prototype,"SystemEvent",void 0),e}(c.SpawnBuilder);r.SBBox=p,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../type/ComType":"ComType","./SpawnBuilder":"SpawnBuilder"}],SBCEffectAddBuff:[function(t,e,r){"use strict";cc._RF.push(e,"6e26552wmxOYpN20yLN0uet","SBCEffectAddBuff");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.SBCEffectAddBuff=void 0;var l=t("../../../../../../../framework/container/Container"),s=t("../role/BuffCarrierHandler"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.Apply=function(t){var e=t.ref.GetEffectData(),r=t.sender,o=t.target,n=e.buffCarrierId,i=s.BuffCarrierHandler.Create(r,o,n);this.SystemBuffCarrier.HandlerBuff(i),null==t.tlAddBuff&&(t.tlAddBuff=[]),t.tlAddBuff.push(i)},e.prototype.Unuse=function(t){var e,r;if(t.ref.GetEffectData(),t.tlAddBuff){try{for(var o=a(t.tlAddBuff),n=o.next();!n.done;n=o.next()){var i=n.value;this.SystemBuffCarrier.DeleteHandler(i)}}catch(l){e={error:l}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}t.tlAddBuff.length=0}},e.__cname="SBCEffectAddBuff",i([l.injectField("SystemBuffCarrier")],e.prototype,"SystemBuffCarrier",void 0),e}(t("./SBCEffect").SBCEffect);r.SBCEffectAddBuff=c,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../role/BuffCarrierHandler":"BuffCarrierHandler","./SBCEffect":"SBCEffect"}],SBCEffectInvincible:[function(t,e,r){"use strict";cc._RF.push(e,"6ad41QAiw1K/7w9Y5nRowco","SBCEffectInvincible");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.SBCEffectInvincible=void 0;var i=t("../../SystemDamage"),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.Apply=function(t,e){t.ref.GetEffectData(),e&&e instanceof i.DamageInfo&&(e.damageTag.IsStopDie=!0,e.damageTag.Failure=!0)},e.prototype.Unuse=function(){},e.__cname="SBCEffectInvincible",e}(t("./SBCEffect").SBCEffect);r.SBCEffectInvincible=a,cc._RF.pop()},{"../../SystemDamage":"SystemDamage","./SBCEffect":"SBCEffect"}],SBCEffectMgr:[function(t,e,r){"use strict";cc._RF.push(e,"5301cQpzHNIBqM2Fx+N4gnB","SBCEffectMgr");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.SBCEffectMgr=void 0;var i=t("../../../../../../../framework/base/ScriptObject"),a=t("../../../../../../ref/RefBuffCarrier"),l=t("./SBCEffectAddBuff"),s=t("./SBCEffectInvincible"),c=t("./SBCEffectModifyAttr"),u=t("./SBCEffectReborn"),p=t("./SBCEffectRestorePrecent"),f=t("./SBCEffectShootBullet"),h=t("./SBCEffectTakedamageHPP"),y=function(t){function e(e){var r=t.call(this)||this;return r.tmEffect=new Map,r.container=e,r}return n(e,t),e.prototype.onDestroy=function(){},e.prototype.GetEffect=function(t){var e=t.ref.GetEffectType(),r=this.tmEffect.get(e);if(null==r){var o=this.OnGetEffectClass(t);null!=o&&(r=new o,this.container.inject(r),this.tmEffect.set(e,r))}return r},e.prototype.OnGetEffectClass=function(t){switch(t.ref.GetEffectType()){case a.RefBuffCarrier_EffetType.TakedamageHPP:return h.SBCEffectTakedamageHPP;case a.RefBuffCarrier_EffetType.ShootBullet:return f.SBCEffectShootBullet;case a.RefBuffCarrier_EffetType.RestorePrecent:return p.SBCEffectRestorePrecent;case a.RefBuffCarrier_EffetType.Reborn:return u.SBCEffectReborn;case a.RefBuffCarrier_EffetType.ModifyAttr:return c.SBCEffectModifyAttr;case a.RefBuffCarrier_EffetType.AddBuff:return l.SBCEffectAddBuff;case a.RefBuffCarrier_EffetType.Invincible:return s.SBCEffectInvincible}return null},e.__cname="SBCEffectMgr",e}(i.ScriptObject);r.SBCEffectMgr=y,cc._RF.pop()},{"../../../../../../../framework/base/ScriptObject":void 0,"../../../../../../ref/RefBuffCarrier":"RefBuffCarrier","./SBCEffectAddBuff":"SBCEffectAddBuff","./SBCEffectInvincible":"SBCEffectInvincible","./SBCEffectModifyAttr":"SBCEffectModifyAttr","./SBCEffectReborn":"SBCEffectReborn","./SBCEffectRestorePrecent":"SBCEffectRestorePrecent","./SBCEffectShootBullet":"SBCEffectShootBullet","./SBCEffectTakedamageHPP":"SBCEffectTakedamageHPP"}],SBCEffectModifyAttr:[function(t,e,r){"use strict";cc._RF.push(e,"aa94cVCjFRPsbxoH54LC5AW","SBCEffectModifyAttr");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.SBCEffectModifyAttr=void 0;var l=t("../../../../../../../framework/container/Container"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.Apply=function(t){var e,r,o=t.ref.GetEffectData(),n=t.target,i=this.ModelAttr;try{for(var l=a(o.attrs),s=l.next();!s.done;s=l.next()){var c=s.value,u=i.GetAttributeKeyByResId(c.attrId),p=i.GetRefRoleAttribute(c.attrId).GetType();"\u56fa\u5b9a\u503c"==p?this.ComVar.SetAttr(n,u,null,1e4*c.value):"\u767e\u5206\u6bd4"==p&&this.ComVar.SetAttr(n,u,null,null,c.value)}}catch(f){e={error:f}}finally{try{s&&!s.done&&(r=l.return)&&r.call(l)}finally{if(e)throw e.error}}},e.prototype.Unuse=function(t){var e,r,o=t.ref.GetEffectData(),n=t.target,i=this.ModelAttr;try{for(var l=a(o.attrs),s=l.next();!s.done;s=l.next()){var c=s.value,u=i.GetAttributeKeyByResId(c.attrId),p=i.GetRefRoleAttribute(c.attrId).GetType();"\u56fa\u5b9a\u503c"==p?this.ComVar.SetAttr(n,u,null,1e4*-c.value):"\u767e\u5206\u6bd4"==p&&this.ComVar.SetAttr(n,u,null,null,-c.value)}}catch(f){e={error:f}}finally{try{s&&!s.done&&(r=l.return)&&r.call(l)}finally{if(e)throw e.error}}},e.__cname="SBCEffectModifyAttr",i([l.injectField("ComVar")],e.prototype,"ComVar",void 0),i([l.injectField("ModelAttr")],e.prototype,"ModelAttr",void 0),e}(t("./SBCEffect").SBCEffect);r.SBCEffectModifyAttr=s,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"./SBCEffect":"SBCEffect"}],SBCEffectReborn:[function(t,e,r){"use strict";cc._RF.push(e,"38b85rrIUhO8JGEI8oQlJgt","SBCEffectReborn");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.SBCEffectReborn=void 0;var a=t("../../../../../../../framework/container/Container"),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.Apply=function(t){var e=t.ref.GetEffectData(),r=t.target,o=this.ComVar.HP_Max[r],n=e.hpp*o;this.ComVar.takeReborn(r,n)},e.__cname="SBCEffectReborn",i([a.injectField("ComVar")],e.prototype,"ComVar",void 0),e}(t("./SBCEffect").SBCEffect);r.SBCEffectReborn=l,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"./SBCEffect":"SBCEffect"}],SBCEffectRestorePrecent:[function(t,e,r){"use strict";cc._RF.push(e,"18276BqEk9G/o7HIHo1/unw","SBCEffectRestorePrecent");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.SBCEffectRestorePrecent=void 0;var a=t("../../../../../../../framework/container/Container"),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.Apply=function(t){var e=t.ref.GetEffectData(),r=this.ComVar.HEROID,o=this.ComVar.HP_Max[r],n=Math.max(0,o*e.hpp);n>0&&this.ComVar.takeRDE(r,n)},e.__cname="SBCEffectRestorePrecent",i([a.injectField("ComVar")],e.prototype,"ComVar",void 0),e}(t("./SBCEffect").SBCEffect);r.SBCEffectRestorePrecent=l,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"./SBCEffect":"SBCEffect"}],SBCEffectShootBullet:[function(t,e,r){"use strict";cc._RF.push(e,"2b44aTycBpLhK8xB9T2VfVu","SBCEffectShootBullet");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.SBCEffectShootBullet=void 0;var a=t("../../../../../../../framework/container/Container"),l=t("../../role/RoleBuilder"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.Apply=function(t){var e=this.Battle.getRef(t.sender),r=t.ref.GetEffectData(),o=new l.RBContext;o.sender=e;var n=r.bulletId,i=new(this.SystemRole.GetBulletBuilder(n));i.Setup(o),i.SetProperty("resId",n),i.SetProperty("builder",i),this.SystemRole.ApplyBuilder(i),this.Battle.applyModify()},e.__cname="SBCEffectShootBullet",i([a.injectField("Battle")],e.prototype,"Battle",void 0),i([a.injectField("SystemRole")],e.prototype,"SystemRole",void 0),i([a.injectField("ComPos")],e.prototype,"ComPos",void 0),e}(t("./SBCEffect").SBCEffect);r.SBCEffectShootBullet=s,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../role/RoleBuilder":"RoleBuilder","./SBCEffect":"SBCEffect"}],SBCEffectTakedamageHPP:[function(t,e,r){"use strict";cc._RF.push(e,"ad783maUhtHHpfhjyoWQrd0","SBCEffectTakedamageHPP");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.SBCEffectTakedamageHPP=void 0;var a=t("../../../../../../../framework/container/Container"),l=t("../../SystemDamage"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.Apply=function(t){var e=this.ComVar.ALIVE,r=this.ComVar.HP,o=t.ref.GetEffectData(),n=t.target;if(e[n]){var i=r[n]*o.hpp,a=t.sender,s=l.DamageInfo.CreateDefault(a,n);s.damageValue.base=i,s.damageValue.rate=0,s.damageTag.Bleed=!0,this.SystemDamage.BuffDamage(s)}},e.__cname="SBCEffectTakedamageHPP",i([a.injectField("SystemDamage")],e.prototype,"SystemDamage",void 0),i([a.injectField("ComVar")],e.prototype,"ComVar",void 0),e}(t("./SBCEffect").SBCEffect);r.SBCEffectTakedamageHPP=s,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../SystemDamage":"SystemDamage","./SBCEffect":"SBCEffect"}],SBCEffect:[function(t,e,r){"use strict";cc._RF.push(e,"389e7yfRJtJaYR7XfIJWLMk","SBCEffect");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.SBCEffect=r.SBCEffectContext=void 0;var i=t("../../../../../../../framework/base/ScriptObject"),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e}(t("../role/BuffCarrierHandler").BuffCarrierHandler);r.SBCEffectContext=a;var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.Unuse=function(){},e.__cname="SBCEffect",e}(i.ScriptObject);r.SBCEffect=l,cc._RF.pop()},{"../../../../../../../framework/base/ScriptObject":void 0,"../role/BuffCarrierHandler":"BuffCarrierHandler"}],SBCTriggerMSAtk:[function(t,e,r){"use strict";cc._RF.push(e,"f1004LNSVBG0KpeYb9cvAer","SBCTriggerMSAtk");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.SBCTriggerMSAtk=void 0;var a=t("../../../../../../../framework/container/Container"),l=t("../../../../../../../framework/utils/Toolset"),s=t("../../event/SystemEvent"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnStart=function(t){var e=this,r=t.ref.GetTriggerData();this.times=0;var o=r.spacing,n=l.ToolSet.createToolSet(),i=this.SystemEvent.GetEventPorxy();n.addListener(i,s.EBattleEvent.TriggerAtk,function(t){t==e.Battle.startConfig.mainSkill&&(e.times++,console.log("\u653b\u51fb\u6b21\u6570:",e.times)),e.times>o&&(e.times=0,e.Emit())},this)},e.prototype.OnExit=function(){},e.prototype.Update=function(){},e.__cname="SBCTriggerMSAtk",i([a.injectField("ComState")],e.prototype,"ComState",void 0),i([a.injectField("ComVar")],e.prototype,"ComVar",void 0),i([a.injectField("SystemEvent")],e.prototype,"SystemEvent",void 0),i([a.injectField("Battle")],e.prototype,"Battle",void 0),e}(t("./SBCTrigger").SBCTrigger);r.SBCTriggerMSAtk=c,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../../../../../../framework/utils/Toolset":void 0,"../../event/SystemEvent":"SystemEvent","./SBCTrigger":"SBCTrigger"}],SBCTriggerMSMove:[function(t,e,r){"use strict";cc._RF.push(e,"3cd61PbKAZD6an0/1K/8PjW","SBCTriggerMSMove");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.SBCTriggerMSMove=void 0;var a=t("../../../../../../../framework/container/Container"),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.lastPos=[],e}return n(e,t),e.prototype.OnStart=function(t){var e=t.ref.GetTriggerData();this.data=e,this.move=0,this.EnableUpdate()},e.prototype.OnExit=function(){},e.prototype.Update=function(){var t=this.data.spacing,e=this.ComVelocity.moving,r=this.ComVelocity.speed,o=this.ComVelocity.vx,n=this.ComVelocity.vy,i=this.ComVar.HEROID,a=e[i]?r[i]:0,l=(o[i]||0)*a*.016,s=(n[i]||0)*a*.016,c=cc.v2(l,s).len();this.move+=c,this.move>t&&(this.move=0,this.Emit())},e.__cname="SBCTriggerMSMove",i([a.injectField("ComState")],e.prototype,"ComState",void 0),i([a.injectField("ComVar")],e.prototype,"ComVar",void 0),i([a.injectField("SystemEvent")],e.prototype,"SystemEvent",void 0),i([a.injectField("LayerJoystick")],e.prototype,"LayerJoystick",void 0),i([a.injectField("ComPos")],e.prototype,"ComPos",void 0),i([a.injectField("ComVelocity")],e.prototype,"ComVelocity",void 0),e}(t("./SBCTrigger").SBCTrigger);r.SBCTriggerMSMove=l,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"./SBCTrigger":"SBCTrigger"}],SBCTriggerMSTimer:[function(t,e,r){"use strict";cc._RF.push(e,"ef291edbGVMM441IHMSDMQ3","SBCTriggerMSTimer");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.SBCTriggerMSTimer=void 0;var a=t("../../../../../../../framework/container/Container"),l=t("../../state/SystemState"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnStart=function(t){var e=t.ref,r=e.GetTriggerData();this.data=r,e.GetScriptParam()[0]&&(this.condition=Number(e.GetScriptParam()[0])),this.time=0,this.next=this.time+r.spacing,this.EnableUpdate()},e.prototype.OnExit=function(){},e.prototype.Update=function(t){this.condition?1==this.condition&&this.ComState.type[this.ComVar.HEROID]==l.ComStateType.MOVE&&(this.time+=t):this.time+=t;var e=this.time,r=this.data;e>this.next&&(this.next=e+r.spacing,this.Emit()),e>r.duration&&r.duration>=0&&this.End()},e.__cname="SBCTriggerMSTimer",i([a.injectField("ComState")],e.prototype,"ComState",void 0),i([a.injectField("ComVar")],e.prototype,"ComVar",void 0),e}(t("./SBCTrigger").SBCTrigger);r.SBCTriggerMSTimer=s,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../state/SystemState":"SystemState","./SBCTrigger":"SBCTrigger"}],SBCTriggerMgr:[function(t,e,r){"use strict";cc._RF.push(e,"20ff7vzFgNC4KRvyV3y8NJp","SBCTriggerMgr");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.SBCTriggerMgr=void 0;var a=t("../../../../../../../framework/base/ScriptObject"),l=t("../../../../../../ref/RefBuffCarrier"),s=t("./SBCTriggerMSAtk"),c=t("./SBCTriggerMSMove"),u=t("./SBCTriggerMSTimer"),p=t("./SBCTriggerOnBeHit"),f=t("./SBCTriggerOnHpChange"),h=t("./SBCTriggerOnImmediately"),y=t("./SBCTriggerOnKillEliteOrBoss"),d=t("./SBCTriggerOnKillMonster"),m=t("./SBCTriggerOnReadyDie"),v=t("./SBCTriggerOnRestore"),_=t("./SBCTriggerOnTake"),S=function(t){function e(e){var r=t.call(this)||this;return r.tlContext=new Set,r.tlUpdate=new Set,r.container=e,r}return n(e,t),e.prototype.Update=function(t){var e,r;try{for(var o=i(this.tlUpdate),n=o.next();!n.done;n=o.next())n.value.trigger.Update(t)}catch(a){e={error:a}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}},e.prototype.CreateTrigger=function(t){var e=new(this.OnGetTriggerClass(t));return this.container.inject(e),t.trigger=e,t.mgr=this,this.tlContext.add(t),t},e.prototype.DestroyTrigger=function(t){t.trigger.Exit(),this.tlUpdate.delete(t),this.tlContext.delete(t)},e.prototype.EnableTriggerUpdate=function(t){this.tlUpdate.add(t)},e.prototype.DisableTriggerUpdate=function(t){this.tlUpdate.delete(t)},e.prototype.OnGetTriggerClass=function(t){switch(t.ref.GetTriggerType()){case l.RefBuffCarrier_TriggerType.MSTimer:return u.SBCTriggerMSTimer;case l.RefBuffCarrier_TriggerType.OnBeHit:return p.SBCTriggerOnBeHit;case l.RefBuffCarrier_TriggerType.OnKillMonster:return d.SBCTriggerOnKillMonster;case l.RefBuffCarrier_TriggerType.OnReadyDie:return m.SBCTriggerOnReadyDie;case l.RefBuffCarrier_TriggerType.OnKillEliteOrBoss:return y.SBCTriggerOnKillEliteOrBoss;case l.RefBuffCarrier_TriggerType.OnImmediately:return h.SBCTriggerOnImmediately;case l.RefBuffCarrier_TriggerType.OnRestore:return v.SBCTriggerOnRestore;case l.RefBuffCarrier_TriggerType.OnHpChange:return f.SBCTriggerOnHpChange;case l.RefBuffCarrier_TriggerType.OnTake:return _.SBCTriggerOnTake;case l.RefBuffCarrier_TriggerType.MSMove:return c.SBCTriggerMSMove;case l.RefBuffCarrier_TriggerType.AtkNum:return s.SBCTriggerMSAtk}return null},e.__cname="SBCTriggerMgr",e}(a.ScriptObject);r.SBCTriggerMgr=S,cc._RF.pop()},{"../../../../../../../framework/base/ScriptObject":void 0,"../../../../../../ref/RefBuffCarrier":"RefBuffCarrier","./SBCTriggerMSAtk":"SBCTriggerMSAtk","./SBCTriggerMSMove":"SBCTriggerMSMove","./SBCTriggerMSTimer":"SBCTriggerMSTimer","./SBCTriggerOnBeHit":"SBCTriggerOnBeHit","./SBCTriggerOnHpChange":"SBCTriggerOnHpChange","./SBCTriggerOnImmediately":"SBCTriggerOnImmediately","./SBCTriggerOnKillEliteOrBoss":"SBCTriggerOnKillEliteOrBoss","./SBCTriggerOnKillMonster":"SBCTriggerOnKillMonster","./SBCTriggerOnReadyDie":"SBCTriggerOnReadyDie","./SBCTriggerOnRestore":"SBCTriggerOnRestore","./SBCTriggerOnTake":"SBCTriggerOnTake"}],SBCTriggerOnBeHit:[function(t,e,r){"use strict";cc._RF.push(e,"aca6fbkvO1Du7zcy0GhsyUJ","SBCTriggerOnBeHit");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.SBCTriggerOnBeHit=void 0;var a=t("../../../../../../../framework/container/Container"),l=t("../../../../../../../framework/Func"),s=t("../../../../../../../framework/utils/Toolset"),c=t("../../event/SystemEvent"),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnStart=function(){var t=this.context.ref.GetTriggerData();this.spacing=l.Func.deepCopy(t.spacing),this.toolSet=s.ToolSet.createToolSet();var e=this.SystemEvent.GetEventPorxy();this.toolSet.addListener(e,c.EBattleEvent.TriggerBehit,this.OnBeHit,this)},e.prototype.OnExit=function(){s.ToolSet.destroyToolSet(this.toolSet),this.toolSet=null},e.prototype.OnBeHit=function(t){var e=cc.director.getTotalTime()/1e3;null!=this.lastTriggerTime&&e<this.lastTriggerTime||t.tid==this.context.eid&&(this.lastTriggerTime=e+this.spacing,this.Emit(t))},e.__cname="SBCTriggerOnBeHit",i([a.injectField("SystemEvent")],e.prototype,"SystemEvent",void 0),e}(t("./SBCTrigger").SBCTrigger);r.SBCTriggerOnBeHit=u,cc._RF.pop()},{"../../../../../../../framework/Func":void 0,"../../../../../../../framework/container/Container":void 0,"../../../../../../../framework/utils/Toolset":void 0,"../../event/SystemEvent":"SystemEvent","./SBCTrigger":"SBCTrigger"}],SBCTriggerOnHpChange:[function(t,e,r){"use strict";cc._RF.push(e,"43df2Gb6uhOrJB/NHkh+J6U","SBCTriggerOnHpChange");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.SBCTriggerOnHpChange=void 0;var a=t("../../../../../../../framework/container/Container"),l=t("../../../../../../../framework/utils/Toolset"),s=t("../../event/SystemEvent"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnStart=function(){this.context.ref.GetTriggerData(),this.toolSet=l.ToolSet.createToolSet();var t=this.SystemEvent.GetEventPorxy();this.toolSet.addListener(t,s.EBattleEvent.TriggerHpChange,this.OnHpChange,this)},e.prototype.OnExit=function(){l.ToolSet.destroyToolSet(this.toolSet)},e.prototype.OnHpChange=function(t){t==this.context.eid&&this.Emit()},e.__cname="SBCTriggerOnHpChange",i([a.injectField("SystemEvent")],e.prototype,"SystemEvent",void 0),e}(t("./SBCTrigger").SBCTrigger);r.SBCTriggerOnHpChange=c,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../../../../../../framework/utils/Toolset":void 0,"../../event/SystemEvent":"SystemEvent","./SBCTrigger":"SBCTrigger"}],SBCTriggerOnImmediately:[function(t,e,r){"use strict";cc._RF.push(e,"f412307DlhDv62tU/YVQ8yz","SBCTriggerOnImmediately");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.SBCTriggerOnImmediately=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnStart=function(){this.context.ref.GetTriggerData(),this.Emit()},e.__cname="SBCTriggerOnImmediately",e}(t("./SBCTrigger").SBCTrigger);r.SBCTriggerOnImmediately=i,cc._RF.pop()},{"./SBCTrigger":"SBCTrigger"}],SBCTriggerOnKillEliteOrBoss:[function(t,e,r){"use strict";cc._RF.push(e,"3390b9O+U9GWJdxSlmXKSbV","SBCTriggerOnKillEliteOrBoss");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.SBCTriggerOnKillEliteOrBoss=void 0;var a=t("../../../../../../../framework/container/Container"),l=t("../../../../../../../framework/utils/Toolset"),s=t("../../event/SystemEvent"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnStart=function(){this.context.ref.GetTriggerData(),this.toolSet=l.ToolSet.createToolSet();var t=this.SystemEvent.GetEventPorxy();this.toolSet.addListener(t,s.EBattleEvent.EliteDown,this.OnEliteDown,this),this.toolSet.addListener(t,s.EBattleEvent.BossDown,this.OnBossDown,this)},e.prototype.OnExit=function(){l.ToolSet.destroyToolSet(this.toolSet)},e.prototype.OnEliteDown=function(){this.Emit()},e.prototype.OnBossDown=function(){this.Emit()},e.__cname="SBCTriggerOnKillEliteOrBoss",i([a.injectField("SystemEvent")],e.prototype,"SystemEvent",void 0),i([a.injectField("ComType")],e.prototype,"ComType",void 0),e}(t("./SBCTrigger").SBCTrigger);r.SBCTriggerOnKillEliteOrBoss=c,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../../../../../../framework/utils/Toolset":void 0,"../../event/SystemEvent":"SystemEvent","./SBCTrigger":"SBCTrigger"}],SBCTriggerOnKillMonster:[function(t,e,r){"use strict";cc._RF.push(e,"335e4humr9B5a1opwivQoSs","SBCTriggerOnKillMonster");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.SBCTriggerOnKillMonster=void 0;var l=t("../../../../../../../framework/container/Container"),s=t("../../../../../../../framework/utils/Toolset"),c=t("../../event/SystemEvent"),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.toolSet=s.ToolSet.createToolSet(),e}return n(e,t),e.prototype.onDestroy=function(){s.ToolSet.destroyToolSet(this.toolSet)},e.prototype.OnStart=function(t){var e=this.context.ref.GetTriggerData();this.num=e.num,this.ListenKillMonster(t),t.count=0},e.prototype.OnExit=function(t){this.UnListenKillMonster(t)},e.prototype.ListenKillMonster=function(t){var e=this,r=this.SystemEvent.GetEventPorxy(),o=this.toolSet.addListener(r,c.EBattleEvent.KillMonster,function(r){e.OnKillMonster(r,t)},this),n=t.eventHandler.get(this);null==n&&(n=[],t.eventHandler.set(this,n)),n.push(o)},e.prototype.UnListenKillMonster=function(t){var e,r,o=t.eventHandler.get(this);if(o){try{for(var n=a(o),i=n.next();!i.done;i=n.next()){var l=i.value;this.toolSet.removeListener(l)}}catch(s){e={error:s}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}o.length=0,t.eventHandler.delete(this)}},e.prototype.OnKillMonster=function(t,e){e.count++,this.OnCountUpdate(e,t)},e.prototype.OnCountUpdate=function(t,e){var r=t.count,o=this.num;r>o&&(t.count-=o,this.Emit(e))},e.__cname="SBCTriggerOnKillMonster",i([l.injectField("SystemEvent")],e.prototype,"SystemEvent",void 0),e}(t("./SBCTrigger").SBCTrigger);r.SBCTriggerOnKillMonster=u,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../../../../../../framework/utils/Toolset":void 0,"../../event/SystemEvent":"SystemEvent","./SBCTrigger":"SBCTrigger"}],SBCTriggerOnReadyDie:[function(t,e,r){"use strict";cc._RF.push(e,"471e6f0QV5CXIoSKlsSkJUn","SBCTriggerOnReadyDie");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.SBCTriggerOnReadyDie=void 0;var a=t("../../../../../../../framework/container/Container"),l=t("../../../../../../../framework/utils/Toolset"),s=t("../../event/SystemEvent"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnStart=function(){this.context.ref.GetTriggerData(),this.toolSet=l.ToolSet.createToolSet();var t=this.SystemEvent.GetEventPorxy();this.toolSet.addListener(t,s.EBattleEvent.TriggerReadyDie,this.OnReadyDie,this)},e.prototype.OnExit=function(){l.ToolSet.destroyToolSet(this.toolSet),this.toolSet=null},e.prototype.OnReadyDie=function(t){t.tid==this.ComVar.HEROID&&this.Emit(t)},e.__cname="SBCTriggerOnReadyDie",i([a.injectField("SystemEvent")],e.prototype,"SystemEvent",void 0),i([a.injectField("ComVar")],e.prototype,"ComVar",void 0),e}(t("./SBCTrigger").SBCTrigger);r.SBCTriggerOnReadyDie=c,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../../../../../../framework/utils/Toolset":void 0,"../../event/SystemEvent":"SystemEvent","./SBCTrigger":"SBCTrigger"}],SBCTriggerOnRestore:[function(t,e,r){"use strict";cc._RF.push(e,"d1dc1QmyA9JZJvyMt81HNiT","SBCTriggerOnRestore");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.SBCTriggerOnRestore=void 0;var a=t("../../../../../../../framework/container/Container"),l=t("../../../../../../../framework/utils/Toolset"),s=t("../../event/SystemEvent"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnStart=function(){this.context.ref.GetTriggerData(),this.toolSet=l.ToolSet.createToolSet();var t=this.SystemEvent.GetEventPorxy();this.toolSet.addListener(t,s.EBattleEvent.TriggerRestore,this.OnRestore,this)},e.prototype.OnExit=function(){l.ToolSet.destroyToolSet(this.toolSet),this.toolSet=null},e.prototype.OnRestore=function(t){this.Emit(t)},e.__cname="SBCTriggerOnRestore",i([a.injectField("SystemEvent")],e.prototype,"SystemEvent",void 0),e}(t("./SBCTrigger").SBCTrigger);r.SBCTriggerOnRestore=c,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../../../../../../framework/utils/Toolset":void 0,"../../event/SystemEvent":"SystemEvent","./SBCTrigger":"SBCTrigger"}],SBCTriggerOnTake:[function(t,e,r){"use strict";cc._RF.push(e,"f2bb041G1dAV4aDgW5ANY88","SBCTriggerOnTake");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.SBCTriggerOnTake=void 0;var a=t("../../../../../../../framework/container/Container"),l=t("../../../../../../../framework/utils/Toolset"),s=t("../../event/SystemEvent"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnStart=function(){this.context.ref.GetTriggerData(),this.toolSet=l.ToolSet.createToolSet();var t=this.SystemEvent.GetEventPorxy();this.toolSet.addListener(t,s.EBattleEvent.TriggerTake,this.OnRestore,this)},e.prototype.OnExit=function(){l.ToolSet.destroyToolSet(this.toolSet),this.toolSet=null},e.prototype.OnRestore=function(){this.Emit()},e.__cname="SBCTriggerOnTake",i([a.injectField("SystemEvent")],e.prototype,"SystemEvent",void 0),e}(t("./SBCTrigger").SBCTrigger);r.SBCTriggerOnTake=c,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../../../../../../framework/utils/Toolset":void 0,"../../event/SystemEvent":"SystemEvent","./SBCTrigger":"SBCTrigger"}],SBCTrigger:[function(t,e,r){"use strict";cc._RF.push(e,"1e0eenFcZlP2I9o6s4Ck5WN","SBCTrigger");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a},a=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(i(arguments[e]));return t};Object.defineProperty(r,"__esModule",{value:!0}),r.SBCTrigger=r.SBCTriggerContext=void 0;var l=t("../../../../../../../framework/base/ScriptObject"),s=function(){function t(){this.eventHandler=new Map}return t.Create=function(e,r,o,n){var i=new t;return i.eid=e,i.ref=r,i.onTrigger=o,i.onEnd=n,i},t}();r.SBCTriggerContext=s;var c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isend=!1,e}return n(e,t),e.prototype.Start=function(t){this.isend=!1,this.context=t,this.OnStart(t)},e.prototype.Exit=function(){this.End(),this.OnExit(this.context)},e.prototype.OnStart=function(){},e.prototype.OnExit=function(){},e.prototype.EnableUpdate=function(){this.context.mgr.EnableTriggerUpdate(this.context)},e.prototype.DisableUpdate=function(){this.context.mgr.DisableTriggerUpdate(this.context)},e.prototype.Update=function(){},e.prototype.Emit=function(){for(var t,e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this.context.onTrigger&&(t=this.context).onTrigger.apply(t,a(e))},e.prototype.End=function(){this.isend||(this.isend=!0,this.context.onEnd&&this.context.onEnd())},e.__cname="SBCTrigger",e}(l.ScriptObject);r.SBCTrigger=c,cc._RF.pop()},{"../../../../../../../framework/base/ScriptObject":void 0}],SBLeftRight:[function(t,e,r){"use strict";cc._RF.push(e,"870f9K3uBJMc5L4k8VBVZ+t","SBLeftRight");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.SBLeftRight=void 0;var s=t("../../../../../../../framework/container/Container"),c=t("../../../../../../../framework/Func"),u=t("../../../BattleUtil"),p=t("../../type/ComType"),f=t("./SpawnBuilder"),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.SetAreaData=function(t){this.areaData=t},e.prototype.OnUpdateGrid=function(t,e){var r=this.tlGrid,o=this.tlPosX,n=this.tlPosY,i=this.tmGrid2Index;r.length=0,o.length=0,n.length=0,i.clear();var a=this.areaData,l=a.gs,s=a.ex,u=a.ey,p=(s+a.ox)*l,f=(u+a.oy)*l,h=s*l,y=u*l,d=this.SystemMap.gridSize,m=this.SystemMap.mapBound,v=Math.floor(Math.max(0,t-p)/d)-1,_=Math.floor(Math.max(0,e-f)/d)-1,S=Math.floor(Math.min(m.x+m.width-d,t+p)/d),g=Math.floor(Math.min(m.y+m.height-d,e+f)/d),b={x:0,y:0,w:0,h:0};b.x=t-h,b.y=e-y,b.w=2*h,b.h=2*y;for(var C=v;C<S;C++)for(var R=_;R<g;R++){var M=b.x,w=b.y,O=b.x+b.w,B=b.y+b.h;if(!c.Func.isRectIntersect(M,w,O,B,C*d,R*d,(C+1)*d,(R+1)*d)){var P=this.SystemMove.TryGetGrid(C,R);P&&this.AddGrid(P,C,R)}}},e}(f.SpawnGridHandler),y=function(){function t(){this.tlSpawn=[]}return t.prototype.Clear=function(){this.candidate=null,this.tlSpawn.length=0},t}(),d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.context=new y,e}return n(e,t),e.prototype.Init=function(){var t=this.refWaveType.GetParams;this.areaData={gs:t[0]||60,ex:t[1]||5,ey:t[2]||9,ox:t[3]||9,oy:t[4]||0}},e.prototype.Enter=function(){this.GridHandler=new h,this.GridHandler.SetAreaData(this.areaData),this.container.inject(this.GridHandler)},e.prototype.Exit=function(){this.GridHandler=null},e.prototype.Apply=function(){var t,e,r=this.monster,o=this.sparse,n=(this.SystemMove,this.GridHandler),i=this.ComVar.HEROID,s=this.ComPos.x,c=this.ComPos.y;n.UpdateGridPreFrame(s[i],c[i]);var f=this.context,h=n.GetTlGrid();f.Clear(),f.candidate=h;try{for(var y=a(h),d=y.next();!d.done;d=y.next()){var m=d.value;0==m.ids.size&&f.tlSpawn.push(m)}}catch(j){t={error:j}}finally{try{d&&!d.done&&(e=y.return)&&e.call(y)}finally{if(t)throw t.error}}u.BattleUtil.Knuth(f.tlSpawn);for(var v=function(){var t;if(null==t&&f.tlSpawn.length>0&&(t=f.tlSpawn.shift()),null==t){var e=f.candidate.length;if(e>0){var r=Math.floor(Math.random()*e);t=f.candidate[r],f.candidate.splice(r,1)}}return t},_=this.SystemMap.gridXCount,S=this.SystemMap.gridYCount,g=this.GetEntityNum(p.EComType.Monster,r),b=o,C=!1;g<b;){var R=v();if(null==R)break;if(!(R.ids.size>0)){var M=this.SystemMap.gridSize,w=l(n.GetGridXY(R),2),O=w[0],B=w[1];if(0!=n.SetReadySpawn(O,B,_,S)){var P=O*M+.5*M,G=B*M+.5*M,k=l(this.SystemMove.fixPos(P,G),2),x=k[0],T=k[1];this.SystemRole.CreateEntity(r,x,T),g++,C=!0}}}C&&this.Battle.applyModify()},e.__cname="SBLeftRight",i([s.injectField("SystemMove")],e.prototype,"SystemMove",void 0),i([s.injectField("SystemRole")],e.prototype,"SystemRole",void 0),i([s.injectField("SystemMap")],e.prototype,"SystemMap",void 0),i([s.injectField("ComPos")],e.prototype,"ComPos",void 0),i([s.injectField("ComVar")],e.prototype,"ComVar",void 0),i([s.injectField("Battle")],e.prototype,"Battle",void 0),i([s.injectField("ComType")],e.prototype,"ComType",void 0),e}(f.SpawnBuilder);r.SBLeftRight=d,cc._RF.pop()},{"../../../../../../../framework/Func":void 0,"../../../../../../../framework/container/Container":void 0,"../../../BattleUtil":"BattleUtil","../../type/ComType":"ComType","./SpawnBuilder":"SpawnBuilder"}],SBRing:[function(t,e,r){"use strict";cc._RF.push(e,"c7d6cfWEYlIXohv1pzmistM","SBRing");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.SBRing=void 0;var s=t("../../../../../../../framework/container/Container"),c=t("../../../../../../../framework/Func"),u=t("../../../BattleUtil"),p=t("../../type/ComType"),f=t("./SpawnBuilder"),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.SetAreaData=function(t){this.areaData=t},e.prototype.OnUpdateGrid=function(t,e){var r=this.tlGrid,o=this.tlPosX,n=this.tlPosY,i=this.tmGrid2Index;r.length=0,o.length=0,n.length=0,i.clear();var a=this.areaData,l=a.gs,s=a.r1,u=a.r2,p=u*l,f=u*l,h=s*l,y=s*l,d=this.SystemMap.gridSize,m=this.SystemMap.mapBound,v=Math.floor(Math.max(0,t-p)/d)-1,_=Math.floor(Math.max(0,e-f)/d)-1,S=Math.floor(Math.min(m.x+m.width-d,t+p)/d),g=Math.floor(Math.min(m.y+m.height-d,e+f)/d),b={x:0,y:0,w:0,h:0};b.x=t-h,b.y=e-y,b.w=2*h,b.h=2*y;for(var C=v;C<S;C++)for(var R=_;R<g;R++){var M=t,w=e,O=s*l,B=u*l;if(!c.Func.isCircRectIntersect(M,w,O,C*d,R*d,d,d)&&0!=c.Func.isCircRectIntersect(M,w,B,C*d,R*d,d,d)){var P=this.SystemMove.TryGetGrid(C,R);P&&this.AddGrid(P,C,R)}}},e}(f.SpawnGridHandler),y=function(){function t(){this.tlSpawn=[]}return t.prototype.Clear=function(){this.candidate=null,this.tlSpawn.length=0},t}(),d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.context=new y,e}return n(e,t),e.prototype.Init=function(){var t=this.refWaveType.GetParams;this.areaData={gs:t[0]||60,r1:t[1]||13,r2:t[2]||15}},e.prototype.Enter=function(){this.GridHandler=new h,this.GridHandler.SetAreaData(this.areaData),this.container.inject(this.GridHandler)},e.prototype.Exit=function(){this.GridHandler=null},e.prototype.Apply=function(){var t,e,r=this.monster,o=this.sparse,n=(this.SystemMove,this.GridHandler),i=this.ComVar.HEROID,s=this.ComPos.x,c=this.ComPos.y;n.UpdateGridPreFrame(s[i],c[i]);var f=this.context,h=n.GetTlGrid();f.Clear(),f.candidate=h;try{for(var y=a(h),d=y.next();!d.done;d=y.next()){var m=d.value;0==m.ids.size&&f.tlSpawn.push(m)}}catch(j){t={error:j}}finally{try{d&&!d.done&&(e=y.return)&&e.call(y)}finally{if(t)throw t.error}}u.BattleUtil.Knuth(f.tlSpawn);for(var v=function(){var t;if(null==t&&f.tlSpawn.length>0&&(t=f.tlSpawn.shift()),null==t){var e=f.candidate.length;if(e>0){var r=Math.floor(Math.random()*e);t=f.candidate[r],f.candidate.splice(r,1)}}return t},_=this.SystemMap.gridXCount,S=this.SystemMap.gridYCount,g=this.GetEntityNum(p.EComType.Monster,r),b=o,C=!1;g<b;){var R=v();if(null==R)break;if(!(R.ids.size>0)){var M=this.SystemMap.gridSize,w=l(n.GetGridXY(R),2),O=w[0],B=w[1];if(0!=n.SetReadySpawn(O,B,_,S)){var P=O*M+.5*M,G=B*M+.5*M,k=l(this.SystemMove.fixPos(P,G),2),x=k[0],T=k[1];this.SystemRole.CreateEntity(r,x,T),g++,C=!0}}}C&&this.Battle.applyModify()},e.__cname="SBRing",i([s.injectField("SystemMove")],e.prototype,"SystemMove",void 0),i([s.injectField("SystemRole")],e.prototype,"SystemRole",void 0),i([s.injectField("ComPos")],e.prototype,"ComPos",void 0),i([s.injectField("ComVar")],e.prototype,"ComVar",void 0),i([s.injectField("ComType")],e.prototype,"ComType",void 0),i([s.injectField("SystemMap")],e.prototype,"SystemMap",void 0),i([s.injectField("Battle")],e.prototype,"Battle",void 0),e}(f.SpawnBuilder);r.SBRing=d,cc._RF.pop()},{"../../../../../../../framework/Func":void 0,"../../../../../../../framework/container/Container":void 0,"../../../BattleUtil":"BattleUtil","../../type/ComType":"ComType","./SpawnBuilder":"SpawnBuilder"}],SBSquareAngle:[function(t,e,r){"use strict";cc._RF.push(e,"7fb7ciG+MlOnZf0t5JX+PM8","SBSquareAngle");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.SBSquareAngle=void 0;var s=t("../../../../../../../framework/container/Container"),c=t("../../../../../../../framework/Func"),u=t("../../../BattleUtil"),p=t("../../type/ComType"),f=t("./SpawnBuilder"),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.SetAreaData=function(t){this.areaData=t},e.prototype.OnUpdateGrid=function(t,e){var r=this.tlGrid,o=this.tlPosX,n=this.tlPosY,i=this.tmGrid2Index;r.length=0,o.length=0,n.length=0,i.clear();for(var a=this.areaData,l=a.gs,s=a.ex,u=a.ey,p=(s+a.ox)*l,f=(u+a.oy)*l,h=s*l,y=u*l,d=this.SystemMap.gridSize,m=this.SystemMap.mapBound,v=Math.floor(Math.max(0,t-p)/d)-1,_=Math.floor(Math.max(0,e-f)/d)-1,S=Math.floor(Math.min(m.x+m.width-d,t+p)/d),g=Math.floor(Math.min(m.y+m.height-d,e+f)/d),b=v;b<S;b++)for(var C=_;C<g;C++){for(var R=b*d,M=C*d,w=(b+1)*d,O=(C+1)*d,B=!1;;){var P,G,k=(P=t-p)+(p-h),x=(G=e+y)+(f-y);if(c.Func.isRectIntersect(R,M,w,O,P,G,k,x)){B=!0;break}if(k=(P=t+h)+(p-h),x=(G=e+y)+(f-y),c.Func.isRectIntersect(R,M,w,O,P,G,k,x)){B=!0;break}if(k=(P=t+h)+(p-h),x=(G=e-f)+(f-y),c.Func.isRectIntersect(R,M,w,O,P,G,k,x)){B=!0;break}if(k=(P=t-p)+(p-h),x=(G=e-f)+(f-y),c.Func.isRectIntersect(R,M,w,O,P,G,k,x)){B=!0;break}break}if(0!=B){var T=this.SystemMove.TryGetGrid(b,C);T&&this.AddGrid(T,b,C)}}},e}(f.SpawnGridHandler),y=function(){function t(){this.tlSpawn=[]}return t.prototype.Clear=function(){this.candidate=null,this.tlSpawn.length=0},t}(),d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.context=new y,e}return n(e,t),e.prototype.Init=function(){var t=this.refWaveType.GetParams;this.areaData={gs:t[0]||60,ex:t[1]||7,ey:t[2]||11,ox:t[3]||5,oy:t[4]||5}},e.prototype.Enter=function(){this.GridHandler=new h,this.GridHandler.SetAreaData(this.areaData),this.container.inject(this.GridHandler)},e.prototype.Exit=function(){this.GridHandler=null},e.prototype.Apply=function(){var t,e,r=this.monster,o=this.sparse,n=(this.SystemMove,this.GridHandler),i=this.ComVar.HEROID,s=this.ComPos.x,c=this.ComPos.y;n.UpdateGridPreFrame(s[i],c[i]);var f=this.context,h=n.GetTlGrid();f.Clear(),f.candidate=h;try{for(var y=a(h),d=y.next();!d.done;d=y.next()){var m=d.value;0==m.ids.size&&f.tlSpawn.push(m)}}catch(j){t={error:j}}finally{try{d&&!d.done&&(e=y.return)&&e.call(y)}finally{if(t)throw t.error}}u.BattleUtil.Knuth(f.tlSpawn);for(var v=function(){var t;if(null==t&&f.tlSpawn.length>0&&(t=f.tlSpawn.shift()),null==t){var e=f.candidate.length;if(e>0){var r=Math.floor(Math.random()*e);t=f.candidate[r],f.candidate.splice(r,1)}}return t},_=this.SystemMap.gridXCount,S=this.SystemMap.gridYCount,g=this.GetEntityNum(p.EComType.Monster,r),b=o,C=!1;g<b;){var R=v();if(null==R)break;if(!(R.ids.size>0)){var M=this.SystemMap.gridSize,w=l(n.GetGridXY(R),2),O=w[0],B=w[1];if(0!=n.SetReadySpawn(O,B,_,S)){var P=O*M+.5*M,G=B*M+.5*M,k=l(this.SystemMove.fixPos(P,G),2),x=k[0],T=k[1];this.SystemRole.CreateEntity(r,x,T),g++,C=!0}}}C&&this.Battle.applyModify()},e.__cname="SBSquareAngle",i([s.injectField("SystemMove")],e.prototype,"SystemMove",void 0),i([s.injectField("SystemRole")],e.prototype,"SystemRole",void 0),i([s.injectField("SystemMap")],e.prototype,"SystemMap",void 0),i([s.injectField("ComPos")],e.prototype,"ComPos",void 0),i([s.injectField("ComVar")],e.prototype,"ComVar",void 0),i([s.injectField("Battle")],e.prototype,"Battle",void 0),i([s.injectField("ComType")],e.prototype,"ComType",void 0),e}(f.SpawnBuilder);r.SBSquareAngle=d,cc._RF.pop()},{"../../../../../../../framework/Func":void 0,"../../../../../../../framework/container/Container":void 0,"../../../BattleUtil":"BattleUtil","../../type/ComType":"ComType","./SpawnBuilder":"SpawnBuilder"}],SBSquare:[function(t,e,r){"use strict";cc._RF.push(e,"adb58L2w9NMmYkue0DPW+Xo","SBSquare");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.SBSquare=void 0;var s=t("../../../../../../../framework/container/Container"),c=t("../../../../../../../framework/Func"),u=t("../../../BattleUtil"),p=t("../../type/ComType"),f=t("./SpawnBuilder"),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.SetAreaData=function(t){this.areaData=t},e.prototype.OnUpdateGrid=function(t,e){var r=this.tlGrid,o=this.tlPosX,n=this.tlPosY,i=this.tmGrid2Index;r.length=0,o.length=0,n.length=0,i.clear();for(var a=this.areaData,l=a.gs,s=a.ex,u=a.ey,p=(s+a.ox)*l,f=(u+a.oy)*l,h=s*l,y=u*l,d=this.SystemMap.gridSize,m=this.SystemMap.mapBound,v=Math.floor(Math.max(0,t-p)/d)-1,_=Math.floor(Math.max(0,e-f)/d)-1,S=Math.floor(Math.min(m.x+m.width-d,t+p)/d),g=Math.floor(Math.min(m.y+m.height-d,e+f)/d),b=v;b<S;b++)for(var C=_;C<g;C++){for(var R=b*d,M=C*d,w=R+d,O=M+d,B=!1;;){var P,G,k=(P=t-p)+(p-h),x=(G=e-y)+2*y;if(c.Func.isRectIntersect(R,M,w,O,P,G,k,x)){B=!0;break}if(k=(P=t-h)+2*h,x=(G=e+y)+(f-y),c.Func.isRectIntersect(R,M,w,O,P,G,k,x)){B=!0;break}if(k=(P=t+h)+(p-h),x=(G=e-y)+2*y,c.Func.isRectIntersect(R,M,w,O,P,G,k,x)){B=!0;break}if(k=(P=t-h)+2*h,x=(G=e-f)+(f-y),c.Func.isRectIntersect(R,M,w,O,P,G,k,x)){B=!0;break}break}if(0!=B){var T=this.SystemMove.TryGetGrid(b,C);T&&this.AddGrid(T,b,C)}}},e}(f.SpawnGridHandler),y=function(){function t(){this.tlSpawn=[]}return t.prototype.Clear=function(){this.candidate=null,this.tlSpawn.length=0},t}(),d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.context=new y,e}return n(e,t),e.prototype.Init=function(){var t=this.refWaveType.GetParams;this.areaData={gs:t[0]||60,ex:t[1]||7,ey:t[2]||11,ox:t[3]||5,oy:t[4]||5}},e.prototype.Enter=function(){this.GridHandler=new h,this.GridHandler.SetAreaData(this.areaData),this.container.inject(this.GridHandler)},e.prototype.Exit=function(){this.GridHandler=null},e.prototype.Apply=function(){var t,e,r=this.monster,o=this.sparse,n=(this.SystemMove,this.GridHandler),i=this.ComVar.HEROID,s=this.ComPos.x,c=this.ComPos.y;n.UpdateGridPreFrame(s[i],c[i]);var f=this.context,h=n.GetTlGrid();f.Clear(),f.candidate=h;try{for(var y=a(h),d=y.next();!d.done;d=y.next()){var m=d.value;0==m.ids.size&&f.tlSpawn.push(m)}}catch(j){t={error:j}}finally{try{d&&!d.done&&(e=y.return)&&e.call(y)}finally{if(t)throw t.error}}u.BattleUtil.Knuth(f.tlSpawn);for(var v=function(){var t;if(null==t&&f.tlSpawn.length>0&&(t=f.tlSpawn.shift()),null==t){var e=f.candidate.length;if(e>0){var r=Math.floor(Math.random()*e);t=f.candidate[r],f.candidate.splice(r,1)}}return t},_=this.SystemMap.gridXCount,S=this.SystemMap.gridYCount,g=this.GetEntityNum(p.EComType.Monster,r),b=o,C=!1;g<b;){var R=v();if(null==R)break;if(!(R.ids.size>0)){var M=this.SystemMap.gridSize,w=l(n.GetGridXY(R),2),O=w[0],B=w[1];if(0!=n.SetReadySpawn(O,B,_,S)){var P=O*M+.5*M,G=B*M+.5*M,k=l(this.SystemMove.fixPos(P,G),2),x=k[0],T=k[1];this.SystemRole.CreateEntity(r,x,T),g++,C=!0}}}C&&this.Battle.applyModify()},e.__cname="SBSquare",i([s.injectField("SystemMove")],e.prototype,"SystemMove",void 0),i([s.injectField("SystemRole")],e.prototype,"SystemRole",void 0),i([s.injectField("SystemMap")],e.prototype,"SystemMap",void 0),i([s.injectField("ComPos")],e.prototype,"ComPos",void 0),i([s.injectField("ComVar")],e.prototype,"ComVar",void 0),i([s.injectField("Battle")],e.prototype,"Battle",void 0),i([s.injectField("ComType")],e.prototype,"ComType",void 0),e}(f.SpawnBuilder);r.SBSquare=d,cc._RF.pop()},{"../../../../../../../framework/Func":void 0,"../../../../../../../framework/container/Container":void 0,"../../../BattleUtil":"BattleUtil","../../type/ComType":"ComType","./SpawnBuilder":"SpawnBuilder"}],SBTopBot:[function(t,e,r){"use strict";cc._RF.push(e,"5607fHyV79JbYYzYUF4KHek","SBTopBot");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.SBTopBot=void 0;var s=t("../../../../../../../framework/container/Container"),c=t("../../../../../../../framework/Func"),u=t("../../../BattleUtil"),p=t("../../type/ComType"),f=t("./SpawnBuilder"),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.SetAreaData=function(t){this.areaData=t},e.prototype.OnUpdateGrid=function(t,e){var r=this.tlGrid,o=this.tlPosX,n=this.tlPosY,i=this.tmGrid2Index;r.length=0,o.length=0,n.length=0,i.clear();var a=this.areaData,l=a.gs,s=a.ex,u=a.ey,p=(s+a.ox)*l,f=(u+a.oy)*l,h=s*l,y=u*l,d=this.SystemMap.gridSize,m=this.SystemMap.mapBound,v=Math.floor(Math.max(0,t-p)/d)-1,_=Math.floor(Math.max(0,e-f)/d)-1,S=m.x+m.width;S=S>t+p?S-d:S;var g=Math.floor(Math.min(S,t+p)/d),b=Math.floor(Math.min(m.y+m.height-d,e+f)/d),C={x:0,y:0,w:0,h:0};C.x=t-h,C.y=e-y,C.w=2*h,C.h=2*y;for(var R=v;R<g;R++)for(var M=_;M<b;M++){var w=C.x,O=C.y,B=C.x+C.w,P=C.y+C.h,G=R*d,k=M*d,x=(R+1)*d,T=(M+1)*d;if(!c.Func.isRectIntersect(w,O,B,P,G,k,x,T)){var j=this.SystemMove.TryGetGrid(R,M);j&&this.AddGrid(j,R,M)}}},e}(f.SpawnGridHandler),y=function(){function t(){this.tlSpawn=[]}return t.prototype.Clear=function(){this.candidate=null,this.tlSpawn.length=0},t}(),d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.context=new y,e}return n(e,t),e.prototype.Init=function(){var t=this.refWaveType.GetParams;this.areaData={gs:t[0]||60,ex:t[1]||10,ey:t[2]||9,ox:t[3]||0,oy:t[4]||5}},e.prototype.Enter=function(){this.GridHandler=new h,this.GridHandler.SetAreaData(this.areaData),this.container.inject(this.GridHandler)},e.prototype.Exit=function(){this.GridHandler=null},e.prototype.Apply=function(){var t,e,r=this.monster,o=this.sparse,n=(this.SystemMove,this.GridHandler),i=this.ComVar.HEROID,s=this.ComPos.x,c=this.ComPos.y;n.UpdateGridPreFrame(s[i],c[i]);var f=this.context,h=n.GetTlGrid();f.Clear(),f.candidate=h;try{for(var y=a(h),d=y.next();!d.done;d=y.next()){var m=d.value;0==m.ids.size&&f.tlSpawn.push(m)}}catch(j){t={error:j}}finally{try{d&&!d.done&&(e=y.return)&&e.call(y)}finally{if(t)throw t.error}}u.BattleUtil.Knuth(f.tlSpawn);for(var v=function(){var t;if(null==t&&f.tlSpawn.length>0&&(t=f.tlSpawn.shift()),null==t){var e=f.candidate.length;if(e>0){var r=Math.floor(Math.random()*e);t=f.candidate[r],f.candidate.splice(r,1)}}return t},_=this.SystemMap.gridXCount,S=this.SystemMap.gridYCount,g=this.GetEntityNum(p.EComType.Monster,r),b=o,C=!1;g<b;){var R=v();if(null==R)break;if(!(R.ids.size>0)){var M=this.SystemMap.gridSize,w=l(n.GetGridXY(R),2),O=w[0],B=w[1];if(0!=n.SetReadySpawn(O,B,_,S)){var P=O*M+.5*M,G=B*M+.5*M,k=l(this.SystemMove.fixPos(P,G),2),x=k[0],T=k[1];this.SystemRole.CreateEntity(r,x,T),g++,C=!0}}}C&&this.Battle.applyModify()},e.__cname="SBTopBot",i([s.injectField("SystemMove")],e.prototype,"SystemMove",void 0),i([s.injectField("SystemRole")],e.prototype,"SystemRole",void 0),i([s.injectField("SystemMap")],e.prototype,"SystemMap",void 0),i([s.injectField("ComPos")],e.prototype,"ComPos",void 0),i([s.injectField("ComVar")],e.prototype,"ComVar",void 0),i([s.injectField("Battle")],e.prototype,"Battle",void 0),i([s.injectField("ComType")],e.prototype,"ComType",void 0),e}(f.SpawnBuilder);r.SBTopBot=d,cc._RF.pop()},{"../../../../../../../framework/Func":void 0,"../../../../../../../framework/container/Container":void 0,"../../../BattleUtil":"BattleUtil","../../type/ComType":"ComType","./SpawnBuilder":"SpawnBuilder"}],SDKDataReporting:[function(t,e,r){"use strict";cc._RF.push(e,"a333fogn91KPYEdM47NtUHR","SDKDataReporting");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.SDKDataReporting=void 0;var a=t("../../../../framework/container/Container"),l=t("../../../../framework/FW"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.BuriedPoint=function(t){l.FW.LWX.log("sdk\u4e8b\u4ef6\u4e0a\u62a5:",t),this.SDKMgr.getSDK().submitDataUserInfo(t)},e.__cname="SDKDataReporting",i([a.injectField("SDKMgr")],e.prototype,"SDKMgr",void 0),e}(t("./DataReportingInterface").DataReportingInterface);r.SDKDataReporting=s,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/container/Container":void 0,"./DataReportingInterface":"DataReportingInterface"}],SDKInterface:[function(t,e,r){"use strict";cc._RF.push(e,"d3af5vZ5ghMkazZtXTMIger","SDKInterface");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.SDKInterface=r.ShareType=r.AdvertisementType=r.SubmitDataUserInfoType=void 0;var l=t("../../../../framework/base/ScriptObject");(function(t){t[t.arriveServerSelectPage=1]="arriveServerSelectPage",t[t.createRole=2]="createRole",t[t.enterGame=3]="enterGame",t[t.upRoleLevel=4]="upRoleLevel",t[t.arriveEntrance=5]="arriveEntrance",t[t.enterServer=6]="enterServer",t[t.arriveFirstScene=7]="arriveFirstScene",t[t.arriveLoadingFinish=8]="arriveLoadingFinish",t[t.arriveLoadingZero=9]="arriveLoadingZero",t[t.arriveCreateRolePage=10]="arriveCreateRolePage",t[t.newcomerFinish=11]="newcomerFinish",t[t.checkpointStart=12]="checkpointStart",t[t.checkpointEnd=13]="checkpointEnd",t[t.selectRole=14]="selectRole",t[t.renameRole=15]="renameRole",t[t.newcomerStart=16]="newcomerStart",t[t.exitGame=17]="exitGame",t[t.leveup=18]="leveup"})(r.SubmitDataUserInfoType||(r.SubmitDataUserInfoType={})),function(t){t[t.shipin=1]="shipin",t[t.banner=2]="banner",t[t.closeBanner=-2]="closeBanner",t[t.insert=3]="insert"}(r.AdvertisementType||(r.AdvertisementType={})),function(t){t[t.qq=0]="qq",t[t.wx=1]="wx",t[t.wb=2]="wb",t[t.moments=3]="moments"}(r.ShareType||(r.ShareType={}));var s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sdkShowPay=!0,e}return n(e,t),e.prototype.setShowPay=function(t){this.sdkShowPay=t},e.prototype.getShowPay=function(){return this.sdkShowPay},e.prototype.isLocalSDK=function(){return!1},e.prototype.initAsync=function(){return i(this,void 0,void 0,function(){return a(this,function(){return[2]})})},e.prototype.register=function(){},e.prototype.logOut=function(){return i(this,void 0,void 0,function(){return a(this,function(){return[2]})})},e.prototype.getServerAddress=function(){},e.prototype.userAgreement=function(){return""},e.prototype.privacyAgreement=function(){return""},e.prototype.verification=function(){},e.prototype.verifyAccount=function(){return i(this,void 0,Promise,function(){return a(this,function(){return[2,!0]})})},e.prototype.submitDataUserInfo=function(){},e.prototype.exit=function(){},e.prototype.beCallByNativeWithInfo=function(){},e.prototype.callNativeWithInfo=function(){},e.prototype.loginOut=function(){},e.prototype.removeSplashView=function(){},e.prototype.switchAccount=function(){},e.prototype.closeGame=function(){},e.prototype.showServer=function(){},e.prototype.checkIsShowDesktopIcon=function(){return!1},e.prototype.createDesktopIcon=function(){},e.prototype.hasOpenApplink=function(){return!1},e.prototype.openApplink=function(){},e.prototype.msgCheckName=function(){return i(this,void 0,void 0,function(){return a(this,function(){return[2,!0]})})},e.prototype.msgCheckChat=function(){return i(this,void 0,void 0,function(){return a(this,function(){return[2,!0]})})},e.prototype.Advertisement=function(t){return void 0===t&&(t=1),i(this,void 0,Promise,function(){return a(this,function(){return[2,!0]})})},e.prototype.HasADVideo=function(){return!1},e.prototype.HasUserAgreement=function(){return!0},e.prototype.OpenSdkCustomerService=function(){},e.prototype.GetCanCopyAccount=function(){return!0},e.__cname="SDKInterface",e}(l.ScriptObject);r.SDKInterface=s,cc._RF.pop()},{"../../../../framework/base/ScriptObject":void 0}],SDKMgr:[function(t,e,r){"use strict";cc._RF.push(e,"60264Dj6wZC9pISEX/yo2ey","SDKMgr");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.SDKMgr=void 0;var l=t("../../../../engine/PathUtils"),s=t("../../../../framework/FW"),c=t("../../../../framework/base/ScriptObject"),u=t("../../../../framework/container/Container"),p=t("./ConstSDK"),f=(l.PathUtils,function(t){function e(){return t.call(this)||this}return n(e,t),Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e),e._instance},enumerable:!1,configurable:!0}),e.prototype.createSDK=function(t){return i(this,void 0,void 0,function(){var e;return a(this,function(r){switch(r.label){case 0:return s.FW.Log.log("SDKMgr createSDK"),e=this,[4,this.createClazz(t)];case 1:return e.sdk=r.sent(),[4,this.sdk.initAsync()];case 2:return r.sent(),this.sdk.init(),[2,this.sdk]}})})},e.prototype.createClazz=function(t){return i(this,void 0,Promise,function(){var e;return a(this,function(r){switch(r.label){case 0:return[4,p.LoadSdk(t)];case 1:return e=r.sent(),u.Container.inst().inject(e),[2,e]}})})},e.prototype.getSDK=function(){return this.sdk},e.__cname="SDKMgr",e}(c.ScriptObject));r.SDKMgr=f,cc._RF.pop()},{"../../../../engine/PathUtils":void 0,"../../../../framework/FW":void 0,"../../../../framework/base/ScriptObject":void 0,"../../../../framework/container/Container":void 0,"./ConstSDK":"ConstSDK"}],SG_LayerBatterCamerEffect:[function(t,e,r){"use strict";cc._RF.push(e,"d8000vZdy5PPby1l3DGwgCm","SG_LayerBatterCamerEffect");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.SG_LayerBatterCamerEffectUI=r.SG_LayerBatterCamerEffect=void 0;var c=t("../../../../../../../ConstFork"),u=t("../../../../../../framework/coord/Coord"),p=t("../../../../../../framework/fork/Fork"),f=t("../../../../../../framework/FW"),h=t("../../../../../game/ctrl/battle/view/common/LayerBatterCamerEffect"),y=t("../../../../../game/model/prefab/ModelPrefab"),d=["\u6c34\u679c_\u6218\u6597\u573a\u666f\u7279\u6548_\u679c\u6d6a\u5165\u4fb5","\u6c34\u679c_\u6218\u6597\u573a\u666f\u7279\u6548_BOSS\u6765\u88ad"],m=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.preloadRes=function(){return a(this,void 0,Promise,function(){var t,e,r,o,n,i,a,c=this;return l(this,function(l){switch(l.label){case 0:t=[],e=function(e){var r=y.ModelPrefab.instance.PreLoadAsset(e);r.then(function(){y.ModelPrefab.instance.GetAssetsProxy(e).addRef(c)}),t.push(r)};try{for(r=s(d),o=r.next();!o.done;o=r.next())n=o.value,e(n)}catch(u){i={error:u}}finally{try{o&&!o.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return[4,Promise.all(t)];case 1:return l.sent(),f.FW.ZJJ.log("\u6218\u6597\u955c\u5934\u7279\u6548\uff0c\u52a0\u8f7d\u5b8c\u6210"),[2]}})})},e.prototype.unloadRes=function(){return a(this,void 0,Promise,function(){var t,e,r,o,n,i;return l(this,function(){try{for(t=s(d),e=t.next();!e.done;e=t.next())r=e.value,(o=y.ModelPrefab.instance.GetAssetsProxy(r))&&o.removeRef(this)}catch(a){n={error:a}}finally{try{e&&!e.done&&(i=t.return)&&i.call(t)}finally{if(n)throw n.error}}return[2]})})},i([p.forkClass(h.LayerBatterCamerEffect,c.FORK_SGTG)],e)}(h.LayerBatterCamerEffect);r.SG_LayerBatterCamerEffect=m;var v=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.initAsync=function(){return a(this,void 0,Promise,function(){return l(this,function(){return[2]})})},e.prototype.onRelease=function(){y.ModelPrefab.instance.GetAssetsProxy("\u6c34\u679c_\u6218\u6597\u573a\u666f\u7279\u6548_\u679c\u6d6a\u5165\u4fb5").removeRef(this)},e.prototype.AfterEnterSG=function(){var t;u.Coord.logicSize,(t=this.com.tm("\u7279\u6548_\u6218\u6597_\u5996\u738b\u73b0\u4e16")).width=0,t.height=0,(t=this.com.tm("\u7279\u6548_\u6218\u6597_\u5f3a\u654c\u6765\u88ad")).width=0,t.height=0},e.prototype.ShowBoss=function(){var t=this.com.tm("\u7279\u6548_\u6218\u6597_\u5996\u738b\u73b0\u4e16");this.HandlerTipsModel(t,"\u6c34\u679c_\u6218\u6597\u573a\u666f\u7279\u6548_BOSS\u6765\u88ad",3500),this.GPAudio.battleBoss()},e.prototype.ShowElite=function(){var t=this.com.tm("\u7279\u6548_\u6218\u6597_\u5f3a\u654c\u6765\u88ad");this.HandlerTipsModel(t,"\u6c34\u679c_\u6218\u6597\u573a\u666f\u7279\u6548_\u679c\u6d6a\u5165\u4fb5",3330),this.GPAudio.tipWarn()},e.prototype.HandlerTipsModel=function(t,e,r){t.SetUrlByModel(e),t.visible=!1,t.visible=!0,this.toolSet.addDelay(r,function(){t.visible=!1})},e.__cname="SG_LayerBatterCamerEffectUI",i([p.forkClass(h.LayerBatterCamerEffectUI,c.FORK_SGTG)],e)}(h.LayerBatterCamerEffectUI);r.SG_LayerBatterCamerEffectUI=v,cc._RF.pop()},{"../../../../../../../ConstFork":void 0,"../../../../../../framework/FW":void 0,"../../../../../../framework/coord/Coord":void 0,"../../../../../../framework/fork/Fork":void 0,"../../../../../game/ctrl/battle/view/common/LayerBatterCamerEffect":"LayerBatterCamerEffect","../../../../../game/model/prefab/ModelPrefab":"ModelPrefab"}],SG_LayerMain:[function(t,e,r){"use strict";cc._RF.push(e,"a0ffe5dA/9KJZDst2BmAjDB","SG_LayerMain");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.SG_LayerMain=void 0;var a=t("../../../../../ConstFork"),l=t("../../../../framework/fork/Fork"),s=t("../../../game/ctrl/main/LayerMain"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.xxx=function(){console.log("fff: sgtg")},e.__cname="SG_LayerMain",i([l.forkClass(s.LayerMain,a.FORK_SGTG)],e)}(s.LayerMain);r.SG_LayerMain=c,cc._RF.pop()},{"../../../../../ConstFork":void 0,"../../../../framework/fork/Fork":void 0,"../../../game/ctrl/main/LayerMain":"LayerMain"}],SG_LayerSelectUpgrade:[function(t,e,r){"use strict";cc._RF.push(e,"2c9283VZCpArL0M8ENC1eoI","SG_LayerSelectUpgrade");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.SG_LayerSelectUpgradeUI=void 0;var a=t("../../../../../../../ConstFork"),l=t("../../../../../../framework/fork/Fork"),s=t("../../../../../game/ctrl/battle/view/common/LayerSelectUpgrade"),c=t("../../../../../utils/CustomListWrap"),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getComListSupply=function(){return this.com.tm("\u5217\u8868_\u88ab\u52a8.list").asList},e.prototype.getComListSkill=function(){return this.com.tm("\u5217\u8868_\u6b66\u5668.list").asList},e.prototype.getComList=function(){return this.com.tm("\u5217\u8868_\u9009\u9879\u5361.list").asList},e.prototype.initAfter=function(){var t=this.getComListSupply(),e=new c.CustomListWrap,r=this.com.tm("\u5217\u8868_\u88ab\u52a8").asCom;e.init(r,t,6),this.listWrapSupply=e,t=this.getComListSkill(),e=new c.CustomListWrap,r=this.com.tm("\u5217\u8868_\u6b66\u5668").asCom,e.init(r,t,6,"item"),this.listWrapSkill=e,t=this.getComList(),e=new c.CustomListWrap,r=this.com.tm("\u5217\u8868_\u9009\u9879\u5361").asCom,e.init(r,t,3,"item"),this.listSelector=e},e.prototype.renderSkillItem=function(t,e,r){var o=this.com.tm("\u5217\u8868_\u6b66\u5668").asCom,n=this.GPHeroSupply.GetLimit();o.tmc("\u5c01\u5370").setSelectedIndex(6-n);var i=e.tm("icon"),a=e.tm("title");r.IsEmpty()?(i.Clean(),a.text=""):(i.SetUrlByIcon(r.GetIcon()),a.text=r.GetName())},e.prototype.renderSupplyItem=function(t,e,r){var o=this.com.tm("\u5217\u8868_\u6b66\u5668").asCom,n=this.GPHeroSupply.GetLimit();o.tmc("\u5c01\u5370").setSelectedIndex(6-n);var i=e.tm("icon"),a=e.tm("title");r.IsEmpty()?(i.Clean(),a.text=""):(i.SetUrlByIcon(r.GetIcon()),a.text=r.GetName())},e.prototype.release=function(){this.listWrapSkill.destroy(),this.listWrapSupply.destroy()},e.prototype.updateSupply=function(){var t=this.GPHeroSupply.GetTlSupply();this.listWrapSupply.update(t)},e.prototype.updateSkill=function(){var t=this.GPHeroSkill.GetTlSkill();this.listWrapSkill.update(t)},e.prototype.updateList=function(){var t=this.GPLevelUp.GetTlSelect();this.listSelector.update(t);for(var e=t.length,r=this.listSelector.container._children,o=0;o<r.length;o++){var n=r[o];o==Math.floor(e/2)?n.sortingOrder=1:n.sortingOrder=0}},e.__cname="SG_LayerSelectUpgradeUI",i([l.forkClass(s.LayerSelectUpgradeUI,a.FORK_SGTG)],e)}(s.LayerSelectUpgradeUI);r.SG_LayerSelectUpgradeUI=u,cc._RF.pop()},{"../../../../../../../ConstFork":void 0,"../../../../../../framework/fork/Fork":void 0,"../../../../../game/ctrl/battle/view/common/LayerSelectUpgrade":"LayerSelectUpgrade","../../../../../utils/CustomListWrap":"CustomListWrap"}],SG_LayerSettle:[function(t,e,r){"use strict";cc._RF.push(e,"e06f78KGHtMjpvqUiyLnodX","SG_LayerSettle");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.SG_LayerSettleUI=void 0;var a=t("../../../../../../../ConstFork"),l=t("../../../../../../framework/fork/Fork"),s=t("../../../../../game/ctrl/alert/CtrlAlert"),c=t("../../../../../game/ctrl/battle/view/common/LayerSettle"),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.InitParticle=function(){this.com.tm("\u7ed3\u7b97\u9876\u6846.\u88c5\u8f7d\u5668_\u56db\u5468\u6269\u6563").SetUrlByModel(s.particlesMap.get("\u56db\u5468\u6269\u6563\u91d1\u8272\u7c92\u5b50"))},e.prototype.UpdateFrameState=function(){this.com.setSelectedPage("\u72b6\u6001",1==this.proxy.GetIsWin()?"\u80dc\u5229":"\u5931\u8d25")},e.__cname="SG_LayerSettle",i([l.forkClass(c.LayerSettleUI,a.FORK_SGTG)],e)}(c.LayerSettleUI);r.SG_LayerSettleUI=u,cc._RF.pop()},{"../../../../../../../ConstFork":void 0,"../../../../../../framework/fork/Fork":void 0,"../../../../../game/ctrl/alert/CtrlAlert":"CtrlAlert","../../../../../game/ctrl/battle/view/common/LayerSettle":"LayerSettle"}],SG_MallModuleGloden:[function(t,e,r){"use strict";cc._RF.push(e,"96a869R1HNC7JT4/N60amNl","SG_MallModuleGloden");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.SG_MallModuleGloden=void 0;var a=t("../../../../../../ConstFork"),l=t("../../../../../framework/fork/Fork"),s=t("../../../../game/ctrl/main/mall/MallModuleGloden"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.SetTitle=function(){this.com.setSelectedPage("\u6807\u9898",String(this.mallId))},e.__cname="SG_MallModuleGloden",i([l.forkClass(s.MallModuleGloden,a.FORK_SGTG)],e)}(s.MallModuleGloden);r.SG_MallModuleGloden=c,cc._RF.pop()},{"../../../../../../ConstFork":void 0,"../../../../../framework/fork/Fork":void 0,"../../../../game/ctrl/main/mall/MallModuleGloden":"MallModuleGloden"}],SG_MallModuleRecharge:[function(t,e,r){"use strict";cc._RF.push(e,"5710eA17H9F2I6PqlWzjRPU","SG_MallModuleRecharge");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.SG_MallModuleRecharge=void 0;var a=t("../../../../../../ConstFork"),l=t("../../../../../framework/fork/Fork"),s=t("../../../../game/ctrl/main/mall/MallModuleRecharge"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.SetTitle=function(){this.com.setSelectedPage("\u6807\u9898",String(this.mallId))},e.__cname="SG_MallModuleRecharge",i([l.forkClass(s.MallModuleRecharge,a.FORK_SGTG)],e)}(s.MallModuleRecharge);r.SG_MallModuleRecharge=c,cc._RF.pop()},{"../../../../../../ConstFork":void 0,"../../../../../framework/fork/Fork":void 0,"../../../../game/ctrl/main/mall/MallModuleRecharge":"MallModuleRecharge"}],SG_ModelRune:[function(t,e,r){"use strict";cc._RF.push(e,"609d5it6uhH/o80wPLFArrN","SG_ModelRune");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.SG_ModelRune=void 0;var a=t("../../../../../../ConstFork"),l=t("../../../../../framework/FW"),s=t("../../../../../framework/fork/Fork"),c=t("../../../../game/model/goods/ModelRune"),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getTips=function(){return{type:0,name:l.FW.G_W("\u6d3b\u529b\u83cc\u672a\u6fc0\u6d3b")}},i([s.forkClass(c.ModelRune,a.FORK_SGTG)],e)}(c.ModelRune);r.SG_ModelRune=u,cc._RF.pop()},{"../../../../../../ConstFork":void 0,"../../../../../framework/FW":void 0,"../../../../../framework/fork/Fork":void 0,"../../../../game/model/goods/ModelRune":"ModelRune"}],SG_SubStateLightningSuper:[function(t,e,r){"use strict";cc._RF.push(e,"f66ceCw2pVFGo4e+UBDph+m","SG_SubStateLightningSuper");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.SG_SubStateLightningSuper=void 0;var a=t("../../../../../../../../ConstFork"),l=t("../../../../../../../framework/fork/Fork"),s=t("../../../../../../game/ctrl/battle/logic/state/bullet/SubStateLightningSuper"),c=function(){function t(){this.DURATION_IDLE=1/12*5,this.DURATION_DAMAGE=1,this.DURATION_EXIT=1/12*4}return t.__cname="ConstData",t}(),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnGetConstData=function(){return c},e.__cname="SG_SubStateLightningSuper",i([l.forkClass(s.SubStateLightningSuper,a.FORK_SGTG)],e)}(s.SubStateLightningSuper);r.SG_SubStateLightningSuper=u,cc._RF.pop()},{"../../../../../../../../ConstFork":void 0,"../../../../../../../framework/fork/Fork":void 0,"../../../../../../game/ctrl/battle/logic/state/bullet/SubStateLightningSuper":"SubStateLightningSuper"}],SG_SubStateLightning:[function(t,e,r){"use strict";cc._RF.push(e,"de641EgEClDaYPJ9lpi14YN","SG_SubStateLightning");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.SG_SubStateLightning=void 0;var a=t("../../../../../../../../ConstFork"),l=t("../../../../../../../framework/fork/Fork"),s=t("../../../../../../game/ctrl/battle/logic/state/bullet/SubStateLightning"),c=function(){function t(){this.DURATION_IDLE=1/12*2,this.DURATION_DAMAGE=1/12*11,this.DURATION_EXIT=1/12*4}return t.__cname="ConstData",t}(),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnGetConstData=function(){return c},e.__cname="SG_SubStateLightning",i([l.forkClass(s.SubStateLightning,a.FORK_SGTG)],e)}(s.SubStateLightning);r.SG_SubStateLightning=u,cc._RF.pop()},{"../../../../../../../../ConstFork":void 0,"../../../../../../../framework/fork/Fork":void 0,"../../../../../../game/ctrl/battle/logic/state/bullet/SubStateLightning":"SubStateLightning"}],ServerTime:[function(t,e,r){"use strict";cc._RF.push(e,"05433YSZRBF6rnj1O8FL67N","ServerTime"),Object.defineProperty(r,"__esModule",{value:!0}),r.ServerTime=void 0;var o=function(){function t(){this.delta=0}return Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"localTime",{get:function(){return.001*Date.now()},enumerable:!1,configurable:!0}),t.prototype.SetDelta=function(t){this.delta=t},t.prototype.GetNowTimestamp=function(){return this.GetLocalTime()+this.delta},t.prototype.GetLocalTime=function(){return this.localTime},t.__cname="ServerTime",t}();r.ServerTime=o.instance,cc._RF.pop()},{}],SkillContext:[function(t,e,r){"use strict";var o;cc._RF.push(e,"855e3qQcGFMnJuf4sPYxhBH","SkillContext"),Object.defineProperty(r,"__esModule",{value:!0}),r.SkillContextMgr=r.SkillContext=r.SkillContextType=void 0,function(t){t[t.Monster=0]="Monster",t[t.Hero=1]="Hero"}(o=r.SkillContextType||(r.SkillContextType={}));var n=function(){function t(){}return t.prototype.Setup=function(t,e,r,o){this.eid=t,this.type=e,this.refSkillType=r,this.refSkillPlan=o,this.skillTypeId=r.GetRefId(),this.skillPlanId=o.GetRefId(),this.isAuto=!0,this.skill=null},t.prototype.Clear=function(){this.eid=null,this.refSkillPlan=null,this.refSkillType=null,this.skillPlanId=null,this.skillTypeId=null,this.isAuto=!1,this.skill=null},t.prototype.toString=function(){return"eid:"+this.eid+"_"+o[this.type]+"_skill:"+this.refSkillType.GetRefId()+"_plan:"+this.refSkillPlan.GetRefId()},t.__cname="SkillContext",t}();r.SkillContext=n;var i=function(){function t(){this.curId=1,this.tlData=[]}return t.prototype.CreateId=function(){var t=this.curId;return this.curId++,t},t.prototype.GetData=function(){var t=this.tlData.shift();return null==t&&((t=new n).cid=this.CreateId()),t},t.prototype.ReturnData=function(t){t.Clear(),this.tlData.push(t)},t}();r.SkillContextMgr=i,cc._RF.pop()},{}],SkillEventBase:[function(t,e,r){"use strict";cc._RF.push(e,"56007L9hSpBV4/jmcbNFQHz","SkillEventBase"),Object.defineProperty(r,"__esModule",{value:!0}),r.SkillEventBase=void 0;var o=t("../../../../../../framework/FW"),n=function(){function t(){this.isrun=!1}return t.prototype.Init=function(){},t.prototype.Release=function(){},t.prototype.IsRun=function(){return this.isrun},t.prototype.Run=function(){this.isrun?o.FW.ZJJ.log("\u4e0d\u80fd\u91cd\u590d\u542f\u52a8\u4e8b\u4ef6",this):(this.isrun=!0,this.OnRun())},t.prototype.Back=function(){this.isrun&&this.OnBack()},t.__cname="SkillEventBase",t}();r.SkillEventBase=n,cc._RF.pop()},{"../../../../../../framework/FW":void 0}],SkillEventHelper:[function(t,e,r){"use strict";cc._RF.push(e,"9e069GIj1tIkILWNmuTlLOP","SkillEventHelper");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.SkillEventHelper=void 0;var l=function(t){function e(){var e=t.call(this)||this;return e.tmEvent=new Map,e}return n(e,t),e.Create=function(t){var r=new e;return t.inject(r),r},e.prototype.onDestroy=function(){var t,e;try{for(var r=i(this.tmEvent),o=r.next();!o.done;o=r.next()){var n=a(o.value,2);n[0],n[1].Release()}}catch(l){t={error:l}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},e.prototype.Add=function(t){var e=new t;return e.Init(),e},e.prototype.Remove=function(t){this.tmEvent.delete(t)},e.prototype.Trigge=function(t){this.tmEvent.get(t).Run()},e.__cname="SkillEventHelper",e}(t("../../../../../../framework/base/ScriptObject").ScriptObject);r.SkillEventHelper=l,cc._RF.pop()},{"../../../../../../framework/base/ScriptObject":void 0}],SkillGroupMgr:[function(t,e,r){"use strict";cc._RF.push(e,"f3443PdvdVCm6Uj7xtHQB/5","SkillGroupMgr");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.SkillGroupMgr=void 0;var a=t("../../../../../framework/base/ScriptObject"),l=t("../../../../../framework/container/Container"),s=function(t){function e(e){var r=t.call(this)||this;return r.tmBuffProxy=new Map,r.container=e,r}return n(e,t),e.Create=function(t,e){var r=new e(t);return t.inject(r),r},e.prototype.GetBuffProxyMgr=function(){return this._BuffProxyMgr||(this._BuffProxyMgr=this.OnGetProxyMgr())},e.prototype.GetBehaviorMgr=function(){return this._BehaviorMgr||(this._BehaviorMgr=this.OnGetBehaviorMgr())},e.prototype.AddSkillGroupId=function(t){this.RemoveSkillGroupId(t);var e=this.GetBuffProxyMgr().CreateProxy();this.tmBuffProxy.set(t,e),e.SetSkillGroupId(t),e.Apply()},e.prototype.RemoveSkillGroupId=function(t){var e=this.tmBuffProxy;if(e.has(t)){var r=e.get(t);this.GetBuffProxyMgr().DestroyProxy(r),e.delete(t)}},e.__cname="SkillGroupMgr",i([l.injectField("ModelSkill")],e.prototype,"ModelSkill",void 0),e}(a.ScriptObject);r.SkillGroupMgr=s,cc._RF.pop()},{"../../../../../framework/base/ScriptObject":void 0,"../../../../../framework/container/Container":void 0}],SkillHandlerDart:[function(t,e,r){"use strict";cc._RF.push(e,"26267406W1JBpd2MmmD7tEw","SkillHandlerDart");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.SkillHandlerDart=void 0;var a=t("../../../../../../../framework/container/Container"),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.Shoot=function(t,e,r,o,n){var i=this.ComPos.x,a=this.ComPos.y;this.GPAudio.throwing();var l=this.Battle.getRef(t),s=(this.Battle.getRef(n),Math.atan2(a[n]-a[t],i[n]-i[t])),c=o.context;c.sender=l,c.rad=s,c.x=i[e],c.y=a[e],o.SetProperty("resId",r),this.SystemRole.ApplyBuilder(o),this.Battle.applyModify()},e.prototype.Shoot_red=function(t,e,r,o){this.GPAudio.throwing();var n,i=this.ComPos.x,a=this.ComPos.y,l=this.findNear(e);if(l&&(n=l),null!=n){var s=this.Battle.getRef(t),c=Math.atan2(a[n]-a[e],i[n]-i[e]),u=o.context;u.sender=s,u.rad=c,u.x=i[e],u.y=a[e],o.Setup(u),o.SetProperty("resId",r),this.SystemRole.ApplyBuilder(o),this.Battle.applyModify()}},e.__cname="SkillHandlerDart",i([a.injectField("ComPos")],e.prototype,"ComPos",void 0),e}(t("./BaseSkillHandler").BaseSkillHandler);r.SkillHandlerDart=l,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"./BaseSkillHandler":"BaseSkillHandler"}],SkillTriggerBase:[function(t,e,r){"use strict";cc._RF.push(e,"c1a8dU0xCVNgZuBtsaad/0l","SkillTriggerBase"),Object.defineProperty(r,"__esModule",{value:!0}),r.SkillTriggerBase=void 0;var o=function(){function t(){}return t.prototype.SetOnTrigger=function(t){this._onTrigger=t},t.prototype.Trigger=function(){this._onTrigger&&(this._onTrigger(),console.log("\u89e6\u53d1\u6280\u80fd"))},t.prototype.Init=function(){},t.prototype.Release=function(){},t.prototype.Update=function(){},t.__cname="SkillTriggerBase",t}();r.SkillTriggerBase=o,cc._RF.pop()},{}],SkillTriggerHelper:[function(t,e,r){"use strict";cc._RF.push(e,"1a222eILxJMirL41kQCj8TQ","SkillTriggerHelper");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.SkillTriggerHelper=void 0;var l=function(t){function e(){var e=t.call(this)||this;return e.tmEvent=new Map,e}return n(e,t),e.Create=function(t){var r=new e;return t.inject(r),r},e.prototype.onDestroy=function(){var t,e;try{for(var r=i(this.tmEvent),o=r.next();!o.done;o=r.next()){var n=a(o.value,2);n[0],n[1].Release()}}catch(l){t={error:l}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}this.tmEvent.clear()},e.prototype.AddTrigger=function(t){var e=new t;return e.Init(),e},e.prototype.Update=function(t){var e,r;try{for(var o=i(this.tmEvent),n=o.next();!n.done;n=o.next()){var l=a(n.value,2);l[0],l[1].Update(t)}}catch(s){e={error:s}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}},e.__cname="SkillTriggerHelper",e}(t("../../../../../../framework/base/ScriptObject").ScriptObject);r.SkillTriggerHelper=l,cc._RF.pop()},{"../../../../../../framework/base/ScriptObject":void 0}],SpawnBaseState:[function(t,e,r){"use strict";cc._RF.push(e,"21507sASi9P7ZFCnOawPQ9R","SpawnBaseState");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.SpawnBaseState=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.start=function(){this.onStart()},e.prototype.release=function(){this.onRelease()},e.prototype.onStart=function(){},e.prototype.onRelease=function(){},e.__cname="SpawnBaseState",e}(t("../../../../../../../framework/fsm/FSMState").FSMState);r.SpawnBaseState=i,cc._RF.pop()},{"../../../../../../../framework/fsm/FSMState":void 0}],SpawnBuilder:[function(t,e,r){"use strict";cc._RF.push(e,"8c725zEywBDhb2mKc770tAY","SpawnBuilder");var o=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},n=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.SpawnBuilder=r.SpawnGridHandler=void 0;var i=t("../../../../../../../framework/container/Container"),a=t("../../../../../../../framework/FW"),l=function(){function t(){this.tlGrid=[],this.tlPosX=[],this.tlPosY=[],this.tmGrid2Index=new Map,this._get_tlgrid=[],this._frame=0}return t.prototype.UpdateGridPreFrame=function(t,e){var r=cc.director.getTotalFrames();this._lastupdate!=r&&(this._lastupdate=r,this.UpdateGrid(t,e))},t.prototype.AddGrid=function(t,e,r){var o=this.tlGrid,n=this.tlPosX,i=this.tlPosY,a=this.tmGrid2Index,l=n.length;a.set(t,l),o.push(t),n.push(e),i.push(r)},t.prototype.UpdateGrid=function(t,e){this.ClearReadySpawn(),this.OnUpdateGrid(t,e)},t.prototype.TryGetGrid=function(t,e){return this.SystemMove.TryGetGrid(t,e)},t.prototype.GetTlGrid=function(t){var e,r,o=this._get_tlgrid;o.length=0;try{for(var i=n(this.tlGrid),a=i.next();!a.done;a=i.next()){var l=a.value;(null==t||t(l))&&o.push(l)}}catch(s){e={error:s}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return o},t.prototype.GetGridXY=function(t){var e=0,r=0,o=this.tmGrid2Index.get(t);return o&&o>=0&&(e=this.tlPosX[o],r=this.tlPosY[o]),[e,r]},t.prototype.SetReadySpawn=function(e,r,o,n){if(null==this._last_gxc)this._last_gxc=o,this._last_gyc=n;else if(this._last_gxc!=o||this._last_gyc!=n)return a.FW.ZJJ.error("SetReadySpawn \u4e0d\u652f\u6301\u52a8\u6001\u4fee\u6539\u5730\u56fe\u5927\u5c0f"),!1;var i=t._r_grid,l=r*o+e;return!i.has(l)&&(i.set(l,!1),!0)},t.prototype.ClearReadySpawn=function(){var e=cc.director.getTotalFrames();e!=this._frame&&(this._frame=e,t._r_grid.clear())},t._r_grid=new Map,o([i.injectField("SystemMove")],t.prototype,"SystemMove",void 0),o([i.injectField("SystemMap")],t.prototype,"SystemMap",void 0),t}();r.SpawnGridHandler=l;var s=function(){function t(){}return t.prototype.Init=function(){},t.prototype.Release=function(){},t.prototype.Enter=function(){},t.prototype.Exit=function(){},t.prototype.SetContainer=function(t){null==this.container&&(this.container=t,t.inject(this))},t.prototype.SetRefWaveType=function(t){this.refWaveType=t},t.prototype.SetStartXY=function(t,e){this.startX=t,this.startY=e},t.prototype.GetEntityNum=function(t,e){var r,o,i=this.ComVar.RESID,a=this.ComType.GetGroup(t),l=0;try{for(var s=n(a),c=s.next();!c.done;c=s.next())e==i[c.value]&&l++}catch(u){r={error:u}}finally{try{c&&!c.done&&(o=s.return)&&o.call(s)}finally{if(r)throw r.error}}return l},t.prototype.Setup=function(t,e){this.monster=t,this.sparse=e},o([i.injectField("ComVar")],t.prototype,"ComVar",void 0),o([i.injectField("ComType")],t.prototype,"ComType",void 0),t}();r.SpawnBuilder=s,cc._RF.pop()},{"../../../../../../../framework/FW":void 0,"../../../../../../../framework/container/Container":void 0}],SpawnFSM:[function(t,e,r){"use strict";cc._RF.push(e,"f786fasQqRGib7PpbNF8rfr","SpawnFSM");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.SpawnFSM=void 0;var l=t("../../../../../../../framework/fsm/FSM"),s=t("./SpawnStateBoss"),c=t("./SpawnStateDebugField"),u=t("./SpawnStateIdle"),p=t("./SpawnStateSpawn"),f=function(t){function e(e){var r=t.call(this,new u.SpawnStateIdle,new p.SpawnStateSpawn,new s.SpawnStateBoss,new c.SpawnStateDebugField)||this;return r.locked=!1,r.container=e,r}return n(e,t),e.prototype.Start=function(){var t,e,r,o;try{for(var n=i(this.tmState),l=n.next();!l.done;l=n.next()){var s=a(l.value,2),c=(s[0],s[1]);this.container.inject(c)}}catch(h){t={error:h}}finally{try{l&&!l.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}try{for(var u=i(this.tmState),p=u.next();!p.done;p=u.next()){var f=a(p.value,2);f[0],f[1].start()}}catch(y){r={error:y}}finally{try{p&&!p.done&&(o=u.return)&&o.call(u)}finally{if(r)throw r.error}}},e.prototype.Release=function(){var t,e;try{for(var r=i(this.tmState),o=r.next();!o.done;o=r.next()){var n=a(o.value,2);n[0],n[1].release()}}catch(l){t={error:l}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},e.prototype.SetLock=function(t){this.locked=t},e.prototype.checkSwitch=function(){return!this.locked},e.prototype.SwitchIdle=function(){this.checkSwitch("idle")&&this.switchTo("idle")},e.prototype.SwitchSpawn=function(){this.checkSwitch("spawn")&&this.switchTo("spawn")},e.prototype.SwitchBoss=function(){this.checkSwitch("boss")&&this.switchTo("boss")},e.__cname="SpawnFSM",e}(l.FSM);r.SpawnFSM=f,cc._RF.pop()},{"../../../../../../../framework/fsm/FSM":void 0,"./SpawnStateBoss":"SpawnStateBoss","./SpawnStateDebugField":"SpawnStateDebugField","./SpawnStateIdle":"SpawnStateIdle","./SpawnStateSpawn":"SpawnStateSpawn"}],SpawnStateBoss:[function(t,e,r){"use strict";cc._RF.push(e,"4a357wz3C5OWaepx8Po/NMS","SpawnStateBoss");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.SpawnStateBoss=void 0;var l=t("../../../../../../../art/Mesh/BossArea"),s=t("../../../../../../../framework/container/Container"),c=t("../../../../../../../framework/utils/Toolset"),u=t("../../../../utils/PorcessTimeline"),p=t("../../event/SystemEvent"),f=function(t){function e(){var e=t.call(this,"boss")||this;return e.toolSet=c.ToolSet.createToolSet(),e.isBossShow=!1,e.killbossId=[],e._isshowboss=!1,e}return n(e,t),e.prototype.onDestroy=function(){c.ToolSet.destroyToolSet(this.toolSet)},e.prototype.onStart=function(){var t=this;this.toolSet.addListener(this.SystemEvent.GetEventPorxy(),p.EBattleEvent.BossGenerate,this.OnBossGen,this);var e=new u.PorcessTimeline,r=cc.game.getFrameRate(),o=this.CCArea=this.SystemSpawn.SubPrefab.GetPrefab("\u516c\u5171_Boss\u9886\u57df"),n=this.bossarea=o.getComponentInChildren(l.default);o.active=!1,e.addEvent(0,"start",function(){t.isBossShow=!1,t.Battle.startConfig.bossShow=!1,t.SystemEvent.sendkillAllMonsterBoss()}),e.addEvent(4,"show",function(){var e,r;o.active=!0;var i=t.ModelMgr.ModelChapter.GetSelectResId(),l=t.ModelMgr.ModelChapter.GetRefChapter(i);l&&(t.Battle.startConfig.bossAreaType=l.bossAreaType||1,t.Battle.startConfig.bossAreaRadius=l.bossAreaRadius||500,t.Battle.startConfig.bossAreaModel=l.bossAreaModel||2000159);var s=2*t.Battle.startConfig.bossAreaRadius,c=t.ComVar.HEROID,u=t.ComPos.x[c],p=t.ComPos.y[c]+300;t.SystemMove.SetBossArea(!0);var f=t.SystemMap.ModifyBossBound(u-s/2,p-s/2,s,s,t.Battle.startConfig.bossAreaType);t.SystemMap.refreshMonsterFence([f.x+f.width/2,f.y+f.height/2]);var h=t.SystemMap.GetBossBound(),y=h.x+h.width/2,d=h.y+h.height/2,m=t.SystemSpawn.SubMonster.GetCurWave();try{for(var v=a(m),_=v.next();!_.done;_=v.next()){var S=_.value;t.SystemSpawn.SubBuilder.getBuilder(S.GetTypeId()).SetStartXY(y,d)}}catch(g){e={error:g}}finally{try{_&&!_.done&&(r=v.return)&&r.call(v)}finally{if(e)throw e.error}}n.Setup(s+80,40),o.x=y-s/2-40,o.y=d-s/2-40,t.SystemViewEffect.AddEffectXY("\u767e\u604b_\u6218\u6597\u573a\u666f\u7279\u6548_BOSS\u51fa\u73b0\u6cd5\u9635",y,d,!1,!1,3)}),e.addKeyframe(0,4.5*r,function(){}),e.addEvent(3*r,"showBoss",function(){var e=t.SystemMap.GetBossBound(),r=e.x+e.width/2,o=e.y+e.height/2;t.SystemViewEffect.AddEffectXY("\u767e\u604b_\u6218\u6597\u573a\u666f\u7279\u6548_BOSS\u51fa\u73b0\u70df\u96fe",r,o,!1,!1,3),t.SystemSpawn.SubMonster.ApplyWave(!0),t.SystemSpawn.GetSpawnFsm().SwitchIdle(),t.isBossShow=!0,t.Battle.startConfig.bossShow=!0}),e.addEvent(3*r+1.25*r,"clearEffect",function(){}),this.timeline=e},e.prototype.onRelease=function(){this.timeline.destroy(),this.CCArea=null},e.prototype.enter=function(){this.EnableListenBoss(),this.SystemSpawn.GetSpawnFsm().SetLock(!0),this.resetFinshed(),this.startAnim(),this.timeline.start(),this.SystemSpawn.pause=!0},e.prototype.exit=function(){this.DisableListenBoss(),this.CCArea.active=!1,this.SystemMap.ModifyBossBound(0,0,0,0,1),this.SystemMap.deleteMonsterFence(),this.SystemMove.SetBossArea(!1),this.SystemSpawn.pause=!1},e.prototype.update=function(t){this.timeline.update(t),this.updateBoss(),this.updateAnim()},e.prototype.GetAreaCenter=function(){var t=this.ComVar.HEROID,e=this.ComPos.x,r=this.ComPos.y;return[e[t],r[t]+200]},e.prototype.resetFinshed=function(){this.bossId=null,this.bossPoint=null,this.bossgen=!1,this.bossEntity=null,this.killbossId.length=0},e.prototype.onFinshed=function(){this.isBossShow=!1,this.SystemSpawn.SubTimer.JumpNextWave(),this.SystemEvent.sendKillMonsterBullet();var t=this.SystemSpawn.GetSpawnFsm();t.SetLock(!1),t.SwitchIdle()},e.prototype.EnableListenBoss=function(){var t=this;this.DisableListenBoss();var e=this.killbossId;this.Battle,e.length=0;var r=this.toolSet.addListener(this.SystemEvent.GetEventPorxy(),p.EBattleEvent.KillMonster,function(e){e==t.bossId&&t.updateFinish()});this.killmonsterHandler=r},e.prototype.DisableListenBoss=function(){this.killmonsterHandler&&(this.toolSet.removeListener(this.killmonsterHandler),this.killmonsterHandler=null)},e.prototype.OnBossGen=function(t){this.bossgen=!0,this.bossId=t,this.bossPoint=this.SystemSpawn.GetPoint();var e=this.Battle.getRef(t);this.bossEntity=e,this.OnBossStart()},e.prototype.updateFinish=function(){this.bossgen&&this.isBossShow&&(this.Battle.ref2id(this.bossEntity),this.killbossId,this.OnBossDie(),this.SystemEvent.sendBossDown(this.bossId),this.resetFinshed(),this.onFinshed())},e.prototype.startAnim=function(){this.alphtime=0},e.prototype.updateAnim=function(){this.alphtime++;var t=this.alphtime,e=this.bossarea,r=t%120,o=r>=60,n=o?255:204,i=o?204:255,a=cc.misc.lerp(n,i,r%60/60);e.SetAlpha(a)},e.prototype.OnBossStart=function(){this._isshowboss=!0;var t=this.bossId,e=this.getBossName(t);this.LayerTopMenu.SetBossName(e),this.LayerTopMenu.SetBossModel(!0)},e.prototype.OnBossDie=function(){this._isshowboss=!1,this.LayerTopMenu.SetBossModel(!1)},e.prototype.updateBoss=function(){var t=this.bossId;if(this._isshowboss&&t){var e=this.ComVar.HP[t],r=this.ComVar.HP_Max[t];this.LayerTopMenu.SetBossHp(e,r)}},e.prototype.getBossName=function(t){var e="",r=this.ComVar.NAME[t];return r&&(e=r),e},e.__cname="SpawnStateBoss",i([s.injectField("SystemSpawn")],e.prototype,"SystemSpawn",void 0),i([s.injectField("SystemEvent")],e.prototype,"SystemEvent",void 0),i([s.injectField("SystemMap")],e.prototype,"SystemMap",void 0),i([s.injectField("SystemMove")],e.prototype,"SystemMove",void 0),i([s.injectField("SystemViewEffect")],e.prototype,"SystemViewEffect",void 0),i([s.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([s.injectField("ComPos")],e.prototype,"ComPos",void 0),i([s.injectField("ComVar")],e.prototype,"ComVar",void 0),i([s.injectField("Battle")],e.prototype,"Battle",void 0),i([s.injectField("LayerTopMenu")],e.prototype,"LayerTopMenu",void 0),i([s.injectField("GPAudio")],e.prototype,"GPAudio",void 0),e}(t("./SpawnBaseState").SpawnBaseState);r.SpawnStateBoss=f,cc._RF.pop()},{"../../../../../../../art/Mesh/BossArea":void 0,"../../../../../../../framework/container/Container":void 0,"../../../../../../../framework/utils/Toolset":void 0,"../../../../utils/PorcessTimeline":"PorcessTimeline","../../event/SystemEvent":"SystemEvent","./SpawnBaseState":"SpawnBaseState"}],SpawnStateDebugField:[function(t,e,r){"use strict";cc._RF.push(e,"2feb3dcCFdC6JSjqtgTSoVR","SpawnStateDebugField");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.SpawnStateDebugField=void 0;var a=t("../../../../../../../framework/container/Container"),l=t("../../../../../../../framework/utils/Toolset"),s=t("../../event/SystemEvent"),c=t("../WaveType"),u=function(t){function e(){return t.call(this,"debugfield")||this}return n(e,t),Object.defineProperty(e.prototype,"startConfig",{get:function(){return this.Battle.startConfig},enumerable:!1,configurable:!0}),e.prototype.onStart=function(){var t=this;this.toolSet=l.ToolSet.createToolSet(),this.toolSet.addListener(this.SystemEvent.GetEventPorxy(),s.EBattleEvent.TrySpawnAfterKill,function(){t._trySpawn=!0})},e.prototype.onRelease=function(){l.ToolSet.destroyToolSet(this.toolSet)},e.prototype.enter=function(){this._time=this.getdebugtime(),this.SystemSpawn.pause=!1},e.prototype.exit=function(){},e.prototype.getdebugtime=function(){return this.startConfig.debugFieldFieldType==c.WaveType.Boss?240:10},e.prototype.update=function(t){var e=this.SystemSpawn.GetDebugSpwan();if(this._time+=t,this._time>=this.getdebugtime()||e){if(this._time=0,this.SystemSpawn.SetDebugSpawn(!1),0==this.SystemSpawn.HasDebugWave()){var r=this.startConfig.debugFieldMonster,o=this.startConfig.debugFieldFieldType,n=this.startConfig.debugFieldSparse||50;this.SystemSpawn.PushDebugWave(r,o,n)}this.SystemSpawn.ApplyDebugWave()}},e.__cname="SpawnStateDebugField",i([a.injectField("SystemSpawn")],e.prototype,"SystemSpawn",void 0),i([a.injectField("SystemEvent")],e.prototype,"SystemEvent",void 0),i([a.injectField("Battle")],e.prototype,"Battle",void 0),e}(t("./SpawnBaseState").SpawnBaseState);r.SpawnStateDebugField=u,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../../../../../../framework/utils/Toolset":void 0,"../../event/SystemEvent":"SystemEvent","../WaveType":"WaveType","./SpawnBaseState":"SpawnBaseState"}],SpawnStateIdle:[function(t,e,r){"use strict";cc._RF.push(e,"8c4d08n9AFPpJ9x8+H5D8vC","SpawnStateIdle");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.SpawnStateIdle=void 0;var a=t("../../../../../../../framework/container/Container"),l=t("../../../../../../../framework/utils/Toolset"),s=t("../../event/SystemEvent"),c=function(t){function e(){return t.call(this,"idle")||this}return n(e,t),e.prototype.onStart=function(){var t=this;this.toolSet=l.ToolSet.createToolSet(),this.toolSet.addListener(this.SystemEvent.GetEventPorxy(),s.EBattleEvent.TrySpawnAfterKill,function(){t._trySpawn=!0})},e.prototype.onRelease=function(){l.ToolSet.destroyToolSet(this.toolSet)},e.prototype.enter=function(){this._time=0,this.SystemSpawn.pause=!1},e.prototype.exit=function(){},e.prototype.update=function(t){this._time+=t,(this._trySpawn||this._time>=.2)&&(this._time=0,this._trySpawn=!1,this.SystemSpawn.GetSpawnFsm().SwitchSpawn()),this.SystemSpawn.GetDebugSpwan()&&(this.SystemSpawn.SetDebugSpawn(!1),this.SystemSpawn.ApplyDebugWave())},e.__cname="SpawnStateIdle",i([a.injectField("SystemSpawn")],e.prototype,"SystemSpawn",void 0),i([a.injectField("SystemEvent")],e.prototype,"SystemEvent",void 0),e}(t("./SpawnBaseState").SpawnBaseState);r.SpawnStateIdle=c,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../../../../../../framework/utils/Toolset":void 0,"../../event/SystemEvent":"SystemEvent","./SpawnBaseState":"SpawnBaseState"}],SpawnStateSpawn:[function(t,e,r){"use strict";cc._RF.push(e,"52e9dJjDXxMjIputd+UUHnu","SpawnStateSpawn");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.SpawnStateSpawn=void 0;var a=t("../../../../../../../framework/container/Container"),l=function(t){function e(){return t.call(this,"spawn")||this}return n(e,t),e.prototype.enter=function(){this.SystemSpawn.ApplyCurrentWave(),this.SystemSpawn.GetSpawnFsm().SwitchIdle(),this.SystemSpawn.pause=!1},e.prototype.exit=function(){},e.prototype.update=function(){},e.__cname="SpawnStateSpawn",i([a.injectField("SystemSpawn")],e.prototype,"SystemSpawn",void 0),e}(t("./SpawnBaseState").SpawnBaseState);r.SpawnStateSpawn=l,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"./SpawnBaseState":"SpawnBaseState"}],SubAIBehaviorTree:[function(t,e,r){"use strict";cc._RF.push(e,"78c58XuTstLu4RPh2QHMauC","SubAIBehaviorTree");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.SubAIBehaviorTree=void 0;var s=t("../../../../../../../framework/container/Container"),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tmTree=new Map,e.time=0,e}return n(e,t),e.prototype.onEnter=function(t){var e=this.ComAI.param,r=this.Battle.ref2id(t);if(r){var o=e[r].type,n=this.ComAI.CreateBehaviorTree(r,o);this.tmTree.has(r)&&this.ComAI.DestroyBehaviorTree(this.tmTree.get(r)),this.tmTree.set(r,n)}},e.prototype.onUpdate=function(t){var e=this.time+t;e>.1&&(e-=.1,this.onUpdateInner(.1)),this.time=e},e.prototype.onUpdateInner=function(t){var e,r;try{for(var o=a(this.tmTree),n=o.next();!n.done;n=o.next()){var i=l(n.value,2);i[0],i[1].Update(t)}}catch(s){e={error:s}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}},e.prototype.onExit=function(t){var e=this.Battle.ref2id(t);if(e){var r=this.tmTree.get(e);this.tmTree.delete(e),this.ComAI.DestroyBehaviorTree(r)}},e.__cname="SubAIBehaviorTree",i([s.injectField("ComAI")],e.prototype,"ComAI",void 0),i([s.injectField("Battle")],e.prototype,"Battle",void 0),e}(t("../SubAI").SubAI);r.SubAIBehaviorTree=c,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../SubAI":"SubAI"}],SubAIControllable:[function(t,e,r){"use strict";cc._RF.push(e,"d2e734yIRJE+6QOpfzMAzpk","SubAIControllable");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.SubAIControllable=void 0;var l=t("../../../../../../../framework/container/Container"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.onEnter=function(t){this.ComState.SwitchIdle(t)},e.prototype.onUpdate=function(t){var e,r,o=this.ComAI.param,n=this.ComState,i=this.comPos,l=this.Battle,s=this.next_degree,c=this.next_moving;try{for(var u=a(this.refs),p=u.next();!p.done;p=u.next()){var f=p.value,h=l.ref2id(f);if(h&&(0!=o[h].moving||0!=c))if(c){var y=s,d=(y*=-1)*Math.PI/180,m=i.x[h],v=i.y[h],_=Math.cos(d)*t*1,S=Math.sin(d)*t*1;m+=_,v+=S,n.SwitchMove(f,m,v,1),o[h].degree=y,o[h].moving=c}else n.SwitchIdle(f),o[h].moving=c}}catch(g){e={error:g}}finally{try{p&&!p.done&&(r=u.return)&&r.call(u)}finally{if(e)throw e.error}}},e.prototype.onExit=function(t){this.ComState.SwitchIdle(t)},e.prototype.setParams=function(t,e){this.next_degree=t,this.next_moving=e},e.__cname="SubAIControllable",i([l.injectField("ComState")],e.prototype,"ComState",void 0),i([l.injectField("ComPos")],e.prototype,"comPos",void 0),i([l.injectField("ComAI")],e.prototype,"ComAI",void 0),i([l.injectField("Battle")],e.prototype,"Battle",void 0),e}(t("../SubAI").SubAI);r.SubAIControllable=s,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../SubAI":"SubAI"}],SubAIIdle:[function(t,e,r){"use strict";cc._RF.push(e,"d29c7fUtFhJlIe9MzhXTySY","SubAIIdle");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.SubAIIdle=void 0;var a=t("../../../../../../../framework/container/Container"),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.onEnter=function(t){this.ComState.SwitchIdle(t)},e.prototype.onUpdate=function(){},e.prototype.onExit=function(t){this.ComState.SwitchIdle(t)},e.__cname="SubAIIdle",i([a.injectField("ComState")],e.prototype,"ComState",void 0),e}(t("../SubAI").SubAI);r.SubAIIdle=l,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../SubAI":"SubAI"}],SubAISeek:[function(t,e,r){"use strict";cc._RF.push(e,"8c644nOZA9GFIMltmx5bzJW","SubAISeek");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.SubAISeek=void 0;var a=t("../../../../../../../framework/container/Container"),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.onEnter=function(t){this.ComState.SwitchIdle(t)},e.prototype.onExit=function(t){this.ComState.SwitchIdle(t)},e.prototype.onUpdate=function(){},e.__cname="SubAISeek",i([a.injectField("ComState")],e.prototype,"ComState",void 0),i([a.injectField("ComPos")],e.prototype,"comPos",void 0),i([a.injectField("ComAI")],e.prototype,"ComAI",void 0),i([a.injectField("SystemMap")],e.prototype,"SystemMap",void 0),e}(t("../SubAI").SubAI);r.SubAISeek=l,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../SubAI":"SubAI"}],SubAIWander:[function(t,e,r){"use strict";cc._RF.push(e,"fa7c0edgkhN2ZQ4I12gP7DA","SubAIWander");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.SubAIWander=void 0;var s=t("../../../../../../../framework/container/Container"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.onEnter=function(){},e.prototype.onUpdate=function(){var t,e,r=this.ComAI.param,o=.001*cc.director.getTotalTime(),n=this.Battle;try{for(var i=a(this.refs),s=i.next();!s.done;s=i.next()){var c=s.value,u=n.ref2id(c);if(u&&!(o<r[u].lastTime+r[u].step)){var p=l(this.SystemMap.GetRandomPos(),2),f=p[0],h=p[1];this.ComState.SwitchMove(c,f,h,20),r[u].lastTime=o}}}catch(y){t={error:y}}finally{try{s&&!s.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}},e.prototype.onExit=function(t){this.ComState.SwitchIdle(t)},e.__cname="SubAIWander",i([s.injectField("ComState")],e.prototype,"ComState",void 0),i([s.injectField("ComAI")],e.prototype,"ComAI",void 0),i([s.injectField("SystemMap")],e.prototype,"SystemMap",void 0),i([s.injectField("Battle")],e.prototype,"Battle",void 0),e}(t("../SubAI").SubAI);r.SubAIWander=c,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../SubAI":"SubAI"}],SubAI:[function(t,e,r){"use strict";cc._RF.push(e,"9f3f4xXPT1PXaSjeXHKJWnS","SubAI");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.SubAI=void 0;var a=t("../../../../../../framework/container/Container"),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.refs=new Set,e}return n(e,t),e.prototype.enter=function(t){this.refs.add(t),this.onEnter(t)},e.prototype.exit=function(t){this.onExit(t),this.refs.delete(t)},e.prototype.Update=function(t){this.onUpdate(t)},i([a.injectField("Battle")],e.prototype,"Battle",void 0),e}(t("../../base/BaseSubBattleSystem").BaseSubBattleSystem);r.SubAI=l,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../base/BaseSubBattleSystem":"BaseSubBattleSystem"}],SubAttrBreach:[function(t,e,r){"use strict";cc._RF.push(e,"d1a4evAleRK/rgOhA0YwqxI","SubAttrBreach");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.SubAttrBreach=void 0;var s=t("../../../../framework/container/Container"),c=t("./AttrWrap"),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnEnter=function(){var t,e,r=this,o=this.tmAttr;try{for(var n=a(this.ModelAttr.RefAttr.getRefAll()),i=n.next();!i.done;i=n.next()){var l=i.value.key;o.set(l,new c.AttrWrap)}}catch(s){t={error:s}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.toolSet.addListener(this.ModelVO.VORoleBag.GetEventProxy(),"OnChanged",function(){r.MarkDirty()})},e.prototype.OnUpdateDirty=function(){var t,e,r,o,n,i,s=this.ModelVO.VORoleBag.GetOne(),c=this.tmAttr;try{for(var u=a(c),p=u.next();!p.done;p=u.next()){var f=l(p.value,2);f[0],f[1].Clear()}}catch(S){t={error:S}}finally{try{p&&!p.done&&(e=u.return)&&e.call(u)}finally{if(t)throw t.error}}try{for(var h=a(s.GetRuntimeAttrList()),y=h.next();!y.done;y=h.next()){var d=y.value;this.tmAttr.get(d.attr).base+=d.value}}catch(g){r={error:g}}finally{try{y&&!y.done&&(o=h.return)&&o.call(h)}finally{if(r)throw r.error}}this.tlSkillGroup.length=0;try{for(var m=a(s.GetRuntimeSkillGroup()),v=m.next();!v.done;v=m.next()){var _=v.value;this.tlSkillGroup.push(_)}}catch(b){n={error:b}}finally{try{v&&!v.done&&(i=m.return)&&i.call(m)}finally{if(n)throw n.error}}this.CalSkillGroup2Attr()},e.__cname="SubAttrBreach",i([s.injectField("ModelAttr")],e.prototype,"ModelAttr",void 0),i([s.injectField("ModelVO")],e.prototype,"ModelVO",void 0),e}(t("./SubAttr").SubAttr);r.SubAttrBreach=u,cc._RF.pop()},{"../../../../framework/container/Container":void 0,"./AttrWrap":"AttrWrap","./SubAttr":"SubAttr"}],SubAttrBuff:[function(t,e,r){"use strict";cc._RF.push(e,"07f9dGFRt1DqabgC2uVOJsh","SubAttrBuff");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.SubAttrBuff=void 0;var a=t("../../../../framework/FW"),l=t("./SubAttr"),s=t("./AttrWrap"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnEnter=function(){var t,e,r=this.tmAttr;try{for(var o=i(this.ModelAttr.RefAttr.getRefAll()),n=o.next();!n.done;n=o.next()){var a=n.value.key;r.set(a,new s.AttrWrap)}}catch(l){t={error:l}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}},e.prototype.OnUpdateDirty=function(){a.FW.ZJJ.log("attr buff change"),this.Dump()},e.__cname="SubAttrBuff",e}(l.SubAttr);r.SubAttrBuff=c,cc._RF.pop()},{"../../../../framework/FW":void 0,"./AttrWrap":"AttrWrap","./SubAttr":"SubAttr"}],SubAttrEquip:[function(t,e,r){"use strict";cc._RF.push(e,"95127qhQPRC3Jgvz44aYJtZ","SubAttrEquip");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.SubAttrEquip=void 0;var s=t("../../../../framework/container/Container"),c=t("./AttrWrap"),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnEnter=function(){var t,e,r=this,o=this.tmAttr;try{for(var n=a(this.ModelAttr.RefAttr.getRefAll()),i=n.next();!i.done;i=n.next()){var l=i.value.key;o.set(l,new c.AttrWrap)}}catch(s){t={error:s}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.toolSet.addListener(this.ModelVO.VOEquipBag.GetEventProxy(),"OnChanged",function(){r.MarkDirty()}),this.toolSet.addListener(this.ModelVO.VORoleBag.GetEventProxy(),"OnChanged",function(){r.MarkDirty()})},e.prototype.OnUpdateDirty=function(){var t,e,r,o,n,i,s,c;this.tlSkillGroup.length=0;var u=this.tmAttr;try{for(var p=a(u),f=p.next();!f.done;f=p.next()){var h=l(f.value,2);h[0],h[1].Clear()}}catch(M){t={error:M}}finally{try{f&&!f.done&&(e=p.return)&&e.call(p)}finally{if(t)throw t.error}}try{for(var y=a(this.ModelEquip.GetWearData()),d=y.next();!d.done;d=y.next()){var m=l(d.value,2),v=(m[0],m[1]);try{for(var _=(n=void 0,a(v.GetRuntimeAttrList())),S=_.next();!S.done;S=_.next()){var g=S.value;this.tmAttr.get(g.attr).base+=g.value}}catch(w){n={error:w}}finally{try{S&&!S.done&&(i=_.return)&&i.call(_)}finally{if(n)throw n.error}}try{for(var b=(s=void 0,a(v.GetRuntimeSkillGroup())),C=b.next();!C.done;C=b.next()){var R=C.value;this.tlSkillGroup.push(R)}}catch(O){s={error:O}}finally{try{C&&!C.done&&(c=b.return)&&c.call(b)}finally{if(s)throw s.error}}}}catch(B){r={error:B}}finally{try{d&&!d.done&&(o=y.return)&&o.call(y)}finally{if(r)throw r.error}}this.CalSkillGroup2Attr()},e.__cname="SubAttrEquip",i([s.injectField("ModelAttr")],e.prototype,"ModelAttr",void 0),i([s.injectField("ModelEquip")],e.prototype,"ModelEquip",void 0),i([s.injectField("ModelVO")],e.prototype,"ModelVO",void 0),e}(t("./SubAttr").SubAttr);r.SubAttrEquip=u,cc._RF.pop()},{"../../../../framework/container/Container":void 0,"./AttrWrap":"AttrWrap","./SubAttr":"SubAttr"}],SubAttrHero:[function(t,e,r){"use strict";cc._RF.push(e,"1ce8dRG3rtOJJlqB7LMlx5Y","SubAttrHero");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.SubAttrHero=void 0;var s=t("../../../../framework/container/Container"),c=t("./AttrWrap"),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnEnter=function(){var t,e,r=this,o=this.tmAttr;try{for(var n=a(this.ModelAttr.RefAttr.getRefAll()),i=n.next();!i.done;i=n.next()){var l=i.value.key;o.set(l,new c.AttrWrap)}}catch(s){t={error:s}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.toolSet.addListener(this.ModelVO.VOHeroBag.GetEventProxy(),"OnChanged",function(){r.MarkDirty()})},e.prototype.OnUpdateDirty=function(){var t,e,r,o,n,i,s=this.ModelVO.VORoleBag.GetOne().GetHeroId(),c=this.tmAttr;try{for(var u=a(c),p=u.next();!p.done;p=u.next()){var f=l(p.value,2);f[0],(S=f[1]).Clear()}}catch(R){t={error:R}}finally{try{p&&!p.done&&(e=u.return)&&e.call(u)}finally{if(t)throw t.error}}var h=this.ModelVO.VOHeroBag.GetBag().get(s);try{for(var y=a(h.GetRuntimeTmAttr()),d=y.next();!d.done;d=y.next()){var m=l(d.value,2),v=m[0],_=m[1],S=this.tmAttr.get(v);this.log("attrwrap:",v),this.log("attrwrap2",this.tmAttr),S.base+=_}}catch(M){r={error:M}}finally{try{d&&!d.done&&(o=y.return)&&o.call(y)}finally{if(r)throw r.error}}this.tlSkillGroup.length=0;try{for(var g=a(h.GetRuntimeSkillGroup()),b=g.next();!b.done;b=g.next()){var C=b.value;this.tlSkillGroup.push(C)}}catch(w){n={error:w}}finally{try{b&&!b.done&&(i=g.return)&&i.call(g)}finally{if(n)throw n.error}}this.CalSkillGroup2Attr()},e.__cname="SubAttrHero",i([s.injectField("ModelAttr")],e.prototype,"ModelAttr",void 0),i([s.injectField("ModelVO")],e.prototype,"ModelVO",void 0),e}(t("./SubAttr").SubAttr);r.SubAttrHero=u,cc._RF.pop()},{"../../../../framework/container/Container":void 0,"./AttrWrap":"AttrWrap","./SubAttr":"SubAttr"}],SubAttrRune:[function(t,e,r){"use strict";cc._RF.push(e,"e8cddHcCgBH8Is9JFcnzfiq","SubAttrRune");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.SubAttrRune=void 0;var s=t("../../../../framework/container/Container"),c=t("./AttrWrap"),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnEnter=function(){var t,e,r=this,o=this.tmAttr;try{for(var n=a(this.ModelAttr.RefAttr.getRefAll()),i=n.next();!i.done;i=n.next()){var l=i.value.key;o.set(l,new c.AttrWrap)}}catch(s){t={error:s}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.toolSet.addCallback(this.ModelRune.updateRuneSynthesisRd,function(){r.MarkDirty()})},e.prototype.OnUpdateDirty=function(){var t,e,r,o,n,i,s,c,u=this.tmAttr;try{for(var p=a(u),f=p.next();!f.done;f=p.next()){var h=l(f.value,2);h[0],h[1].Clear()}}catch(M){t={error:M}}finally{try{f&&!f.done&&(e=p.return)&&e.call(p)}finally{if(t)throw t.error}}this.tlSkillGroup.length=0;try{for(var y=a(this.ModelRune.GetRuneSlotMap()),d=y.next();!d.done;d=y.next()){var m=l(d.value,2),v=(m[0],m[1]);try{for(var _=(n=void 0,a(v.GetRuntimeAttrList())),S=_.next();!S.done;S=_.next()){var g=S.value;this.tmAttr.get(g.attr).base+=g.value}}catch(w){n={error:w}}finally{try{S&&!S.done&&(i=_.return)&&i.call(_)}finally{if(n)throw n.error}}try{for(var b=(s=void 0,a(v.GetRuntimeSkillGroup())),C=b.next();!C.done;C=b.next()){var R=C.value;this.tlSkillGroup.push(R)}}catch(O){s={error:O}}finally{try{C&&!C.done&&(c=b.return)&&c.call(b)}finally{if(s)throw s.error}}}}catch(B){r={error:B}}finally{try{d&&!d.done&&(o=y.return)&&o.call(y)}finally{if(r)throw r.error}}this.CalSkillGroup2Attr()},e.__cname="SubAttrRune",i([s.injectField("ModelAttr")],e.prototype,"ModelAttr",void 0),i([s.injectField("ModelRune")],e.prototype,"ModelRune",void 0),i([s.injectField("ModelVO")],e.prototype,"ModelVO",void 0),e}(t("./SubAttr").SubAttr);r.SubAttrRune=u,cc._RF.pop()},{"../../../../framework/container/Container":void 0,"./AttrWrap":"AttrWrap","./SubAttr":"SubAttr"}],SubAttr:[function(t,e,r){"use strict";cc._RF.push(e,"76f787GmB9B7K6Eot/SUd/f","SubAttr");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.SubAttr=void 0;var s=t("../../../../framework/base/ScriptObject"),c=t("../../../../framework/container/Container"),u=t("../../../../framework/utils/Toolset"),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tmAttr=new Map,e.tlSkillGroup=[],e.battleBuff=[],e._tlLastSkillGroup=new Set,e._tlNowSkillGroup=new Set,e}return n(e,t),e.prototype.Init=function(t){this.toolSet=u.ToolSet.createToolSet(),this.CtrlAttr=t,this.OnInit()},e.prototype.onDestroy=function(){this.OnRelease(),u.ToolSet.destroyToolSet(this.toolSet)},e.prototype.Enter=function(){this.OnEnter(),this.MarkDirty()},e.prototype.Exit=function(){this.OnExit()},e.prototype.Update=function(t){this._dirty&&(this._dirty=!1,this.OnUpdateDirty(t),this.CtrlAttr.MarkDirty())},e.prototype.OnInit=function(){},e.prototype.OnRelease=function(){},e.prototype.OnEnter=function(){},e.prototype.OnExit=function(){},e.prototype.MarkDirty=function(){this._dirty=!0},e.prototype.OnUpdateDirty=function(){},e.prototype.GetTmAttr=function(){return this.tmAttr},e.prototype.Dump=function(){var t,e,r=this.tmAttr,o=this.className;o+="\u5c5e\u6027\uff1a";try{for(var n=a(r),i=n.next();!i.done;i=n.next()){var s=l(i.value,2),c=s[0],u=s[1];u.GetValue()>0&&(o+=" "+c+":"+u.Dump()+" ")}}catch(p){t={error:p}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}return o},e.prototype.CalSkillGroup2Attr=function(){this.SetupSystemSkillGroup(this.tlSkillGroup)},e.prototype.AddAttr=function(t,e){var r=this.ModelAttr.RefAttr.getRef("refId",t),o=this.tmAttr.get(r.key);return null!=r&&("\u56fa\u5b9a\u503c"==r.type?(o.base+=e,!0):"\u767e\u5206\u6bd4"==r.type&&(e/=1e4,o.rate+=e,!0))},e.prototype.SetupSystemSkillGroup=function(t){var e,r,o,n,i,l,s=this._tlLastSkillGroup,c=this._tlNowSkillGroup;c.clear();try{for(var u=a(t),p=u.next();!p.done;p=u.next()){var f=p.value;c.add(f)}}catch(v){e={error:v}}finally{try{p&&!p.done&&(r=u.return)&&r.call(u)}finally{if(e)throw e.error}}try{for(var h=a(c),y=h.next();!y.done;y=h.next())f=y.value,0==s.has(f)&&this.CtrlBuff.AddSkillGroupId(f)}catch(_){o={error:_}}finally{try{y&&!y.done&&(n=h.return)&&n.call(h)}finally{if(o)throw o.error}}if(s.size>0)try{for(var d=a(s),m=d.next();!m.done;m=d.next())f=m.value,0==c.has(f)&&this.CtrlBuff.RemoveSkillGroupId(f)}catch(S){i={error:S}}finally{try{m&&!m.done&&(l=d.return)&&l.call(d)}finally{if(i)throw i.error}}s.clear(),this._tlLastSkillGroup=this._tlNowSkillGroup,this._tlNowSkillGroup=s},e.__cname="SubAttr",i([c.injectField("ModelSkill")],e.prototype,"ModelSkill",void 0),i([c.injectField("ModelAttr")],e.prototype,"ModelAttr",void 0),i([c.injectField("CtrlBuff")],e.prototype,"CtrlBuff",void 0),e}(s.ScriptObject);r.SubAttr=p,cc._RF.pop()},{"../../../../framework/base/ScriptObject":void 0,"../../../../framework/container/Container":void 0,"../../../../framework/utils/Toolset":void 0}],SubBuffCarrierMgr:[function(t,e,r){"use strict";cc._RF.push(e,"f6c7bVg4I9CVLbocyH2Mbsg","SubBuffCarrierMgr");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.SubBuffCarrierMgr=void 0;var s=t("../../../../../../../framework/base/ScriptObject"),c=t("../../../../../../../framework/container/Container"),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tlUpdate=new Set,e.tmSub=new Map,e}return n(e,t),e.prototype.OnInit=function(t){this.container=t},e.prototype.onDestroy=function(){var t,e;try{for(var r=a(this.tmSub),o=r.next();!o.done;o=r.next()){var n=l(o.value,2);n[0],n[1].destroy()}}catch(i){t={error:i}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}this.tmSub.clear()},e.prototype.OnStart=function(){var t,e;try{for(var r=a(this.tmSub),o=r.next();!o.done;o=r.next()){var n=l(o.value,2),i=(n[0],n[1]);this.container.inject(i)}}catch(s){t={error:s}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},e.prototype.OnUpdate=function(t){var e,r;try{for(var o=a(this.tlUpdate),n=o.next();!n.done;n=o.next())n.value.Update(t)}catch(i){e={error:i}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}},e.prototype.CreateSub=function(t,e){this.assert(0==this.tmSub.has(t),"\u91cd\u590d\u6ce8\u518cBuffCarrier"+t);var r=new e;return this.container.inject(r),r.Setup(),this.tmSub.set(t,r),r},e.prototype.GetSub=function(t){return this.tmSub.get(t)},e.prototype.CheckSubEnable=function(t){var e=this.GetSub(t);e.ids.size>0?this.tlUpdate.add(e):this.tlUpdate.delete(e)},e.__cname="SubBuffCarrierMgr",i([c.injectField("ModelSkill")],e.prototype,"ModelSkill",void 0),e}(s.ScriptObject);r.SubBuffCarrierMgr=u,cc._RF.pop()},{"../../../../../../../framework/base/ScriptObject":void 0,"../../../../../../../framework/container/Container":void 0}],SubComPanel:[function(t,e,r){"use strict";cc._RF.push(e,"505a4/NMndAiYEI24yVx7ZM","SubComPanel"),Object.defineProperty(r,"__esModule",{value:!0}),r.SubComPanel=void 0;var o=function(){function t(){}return t.prototype.Init=function(t,e){this.com=t,this.proxy=e},t.prototype.Release=function(){},t.prototype.Enter=function(){},t.prototype.Exit=function(){},t.prototype.Update=function(){},t.prototype.GetDirty=function(){var t=this.OnGetClazz();return this.proxy.ui.GetDirty(t)},t.prototype.ClearDirty=function(){var t=this.OnGetClazz();this.proxy.ui.ClearDirty(t)},t}();r.SubComPanel=o,cc._RF.pop()},{}],SubDebugCommand:[function(t,e,r){"use strict";cc._RF.push(e,"3d0e9Eu6QhLiZjwXTWLHVzZ","SubDebugCommand");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.SubDebugCommand=void 0;var s=t("../../../../../framework/container/Container"),c=t("../../../../../framework/FW"),u=t("../base/BaseSubBattleSystem"),p=t("../ConstBattle"),f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tmCmd=new Map,e._tlcmd=[],e}return n(e,t),e.prototype.OnInit=function(){this.InitRegister()},e.prototype.onDestroy=function(){},e.prototype.GetTlCmd=function(){return this._tlcmd},e.prototype.RegistCommand=function(t,e,r){var o={cmd:t,desc:e,callback:r};this.tmCmd.set(t,o),this._tlcmd.push(o)},e.prototype.RumCommand=function(t){var e=t.split(" "),r=e[0],o=e.slice(1),n=this.tmCmd.get(r);n?n.callback(o):this.showtips(c.FW.G_W("\u6307\u4ee4\u4e0d\u5b58\u5728"))},e.prototype.showtips=function(t){this.CtrlAlert.LayerShowTip.SetData({context:t}),this.CtrlAlert.LayerShowTip.load()},e.prototype.InitRegister=function(){var t=this;this.RegistCommand("drop","drop \u6389\u843d\u9053\u5177id \u9053\u5177\u53c2\u6570",function(e){var r=parseInt(e[0]),o=parseInt(e[1]);t.SystemCommon.handlerDebug(r,o)}),this.RegistCommand("spawn","spawn (\u602a\u7269id,\u9635\u578b,\u7a00\u758f\u5ea6) (\u602a\u7269id,\u9635\u578b,\u7a00\u758f\u5ea6)",function(e){var r,o;try{for(var n=a(e),i=n.next();!i.done;i=n.next()){var s=i.value;if(" "!=s){var u=s.match(/\((\d+),(\d+),(\d+)\)/);if(null!=u){var p=l(u,4),f=(p[0],p[1]),h=p[2],y=p[3],d=parseInt(f),m=parseInt(h),v=parseInt(y);t.Battle.startConfig.debugField,t.SystemSpawn.PushDebugWave(d,m,v),t.SystemSpawn.SetDebugSpawn(!0)}else t.showtips(c.FW.G_W("\u6307\u4ee4\u9519\u8bef\uff0c\u6ce8\u610f\u4f7f\u7528\u82f1\u6587\u62ec\u53f7/\u9017\u53f7\uff0c\u62ec\u53f7\u5185\u4e0d\u8981\u7559\u6709\u7a7a\u683c"))}}}catch(_){r={error:_}}finally{try{i&&!i.done&&(o=n.return)&&o.call(n)}finally{if(r)throw r.error}}}),this.RegistCommand("skill","skill \u6280\u80fdid \u7b49\u7ea7",function(e){try{var r=parseInt(e[0]),o=parseInt(e[1]);t.GPHeroSkill.UpgradeSkill(r,o),t.GPHeroSkill.GetSkill(r).Apply()}catch(n){c.FW.ZJJ.error(n),t.CtrlAlert.LayerShowTip.SetData({context:"\u6307\u4ee4\u51fa\u9519"}),t.CtrlAlert.LayerShowTip.load()}}),this.RegistCommand("supply","supply \u8865\u7ed9id \u7b49\u7ea7",function(e){try{var r=parseInt(e[0]),o=parseInt(e[1]);t.GPHeroSupply.UpgradeSupply(r,o),t.GPHeroSupply.GetSupply(r).Apply()}catch(n){c.FW.ZJJ.error(n),t.CtrlAlert.LayerShowTip.SetData({context:"\u6307\u4ee4\u51fa\u9519"}),t.CtrlAlert.LayerShowTip.load()}}),this.RegistCommand("clear","clear \u6e05\u573a",function(){t.SystemEvent.sendkillAllMonsterBoss()}),this.RegistCommand("win","win \u76f4\u63a5\u901a\u5173\u5956\u52b1\u6ee1\u989d\u53d1\u653e",function(){t.SystemEvent.sendDebugWin()}),this.RegistCommand("multeSpeed","multeSpeed \u65f6\u95f4\u500d\u901f",function(e){var r=parseInt(e[0]);r=Math.min(p.BATTLE_MAX_TIME_MULIT,r),t.Battle.startConfig.multeSpeed=r})},e.__cname="SubDebugCommand",i([s.injectField("CtrlAlert")],e.prototype,"CtrlAlert",void 0),i([s.injectField("LayerBatterCommand")],e.prototype,"LayerBatterCommand",void 0),i([s.injectField("SystemEvent")],e.prototype,"SystemEvent",void 0),i([s.injectField("Battle")],e.prototype,"Battle",void 0),i([s.injectField("SystemCommon")],e.prototype,"SystemCommon",void 0),i([s.injectField("SystemSpawn")],e.prototype,"SystemSpawn",void 0),i([s.injectField("GPHeroSkill")],e.prototype,"GPHeroSkill",void 0),i([s.injectField("GPHeroSupply")],e.prototype,"GPHeroSupply",void 0),e}(u.BaseSubBattleSystem);r.SubDebugCommand=f,cc._RF.pop()},{"../../../../../framework/FW":void 0,"../../../../../framework/container/Container":void 0,"../ConstBattle":"ConstBattle","../base/BaseSubBattleSystem":"BaseSubBattleSystem"}],SubDebugDraw:[function(t,e,r){"use strict";cc._RF.push(e,"853c1OlTPxJAKxCg6LnHBZw","SubDebugDraw");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.SubDebugDraw=void 0;var l=t("../../../../../framework/container/Container"),s=t("../base/BaseSubBattleSystem"),c=t("../logic/state/SystemState"),u=t("../logic/type/ComType"),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.canvas=cc.director.getScene().getChildByName("Canvas"),e.nodes=new Map,e.tlUpdate=new Set,e.tlRm=new Set,e.ids=new Set,e.tlTextNode=[],e.tlText=[],e}return n(e,t),e.prototype.SetRoot=function(t){this.root=t},e.prototype.OnInit=function(){var t=this.canvas,e=new cc.Node("Debug");t.addChild(e);var r=e.convertToWorldSpace(cc.Vec2.ZERO);e.x-=r.x,e.y-=r.y;var o=e.addComponent(cc.Graphics);o.lineWidth=3,this.root=e,this.graph=o},e.prototype.onDestroy=function(){this.canvas.removeChild(this.root)},e.prototype.OnUpdate=function(){this.onUpdateInner(),this.onUpdateName()},e.prototype.onUpdateInner=function(){var t,e,r,o,n,i,l,s,p,f,h,y,d,m,v=this.graph,_=this.ComType,S=this.ComPos,g=S.x,b=S.y,C=this.ComCollision.r;v.clear(!0);try{for(var R=a(_.GetGroup(u.EComType.Monster)),M=R.next();!M.done;M=R.next()){var w=M.value;v.strokeColor=cc.Color.RED,v.circle(g[w],b[w],C[w]),v.stroke();var O=this.ComVelocity.vx,B=this.ComVelocity.vy;v.strokeColor=cc.Color.BLUE,v.moveTo(g[w],b[w]),v.lineTo(g[w]+20*O[w],b[w]+20*B[w]),v.stroke();var P=this.ComVelocity.vgx,G=this.ComVelocity.vgy;v.strokeColor=cc.Color.WHITE,v.moveTo(g[w],b[w]),v.lineTo(g[w]+60*P[w],b[w]+60*G[w]),v.stroke()}}catch(ot){t={error:ot}}finally{try{M&&!M.done&&(e=R.return)&&e.call(R)}finally{if(t)throw t.error}}try{for(var k=a(_.GetGroup(u.EComType.Player)),x=k.next();!x.done;x=k.next())w=x.value,v.strokeColor=cc.Color.BLUE,v.circle(g[w],b[w],C[w]),v.stroke()}catch(nt){r={error:nt}}finally{try{x&&!x.done&&(o=k.return)&&o.call(k)}finally{if(r)throw r.error}}try{for(var T=a(_.GetGroup(u.EComType.BossGuardMonster)),j=T.next();!j.done;j=T.next())w=j.value,v.strokeColor=cc.Color.BLUE,v.circle(g[w],b[w],C[w]),v.stroke()}catch(it){n={error:it}}finally{try{j&&!j.done&&(i=T.return)&&i.call(T)}finally{if(n)throw n.error}}try{for(var I=a(_.GetGroup(u.EComType.Bullet)),D=I.next();!D.done;D=I.next())w=D.value,v.strokeColor=cc.Color.GREEN,v.circle(g[w],b[w],C[w]),v.stroke(),O=this.ComVelocity.vx,B=this.ComVelocity.vy,v.strokeColor=cc.Color.BLUE,v.moveTo(g[w],b[w]),v.lineTo(g[w]+50*O[w],b[w]+50*B[w]),v.stroke(),P=this.ComVelocity.vgx,G=this.ComVelocity.vgy,v.strokeColor=cc.Color.WHITE,v.moveTo(g[w],b[w]),v.lineTo(g[w]+50*P[w],b[w]+50*G[w]),v.stroke()}catch(at){l={error:at}}finally{try{D&&!D.done&&(s=I.return)&&s.call(I)}finally{if(l)throw l.error}}var F=this.SystemState.getSub(c.ComStateType.BAT);try{for(var L=a(F.ids),E=L.next();!E.done;E=L.next())w=E.value,F.updateDebug(w)}catch(lt){p={error:lt}}finally{try{E&&!E.done&&(f=L.return)&&f.call(L)}finally{if(p)throw p.error}}var A=this.SystemMove.getCullingRect(),V=this.SystemMap.gridSize,U=A.xs*V,W=A.ys*V,H=Math.abs(A.xe-A.xs)*V,N=Math.abs(A.ye-A.ys)*V;v.strokeColor=cc.Color.RED,v.rect(U,W,H,N),v.stroke();var q=cc.Camera.main.node,K=q.x-q.anchorX*q.width,X=q.y-q.anchorY*q.height;H=q.width,N=q.height,v.strokeColor=cc.Color.BLUE,v.rect(K,X,H,N),v.stroke(),V=this.SystemMap.gridSize;try{for(var z=a(_.GetGroup(u.EComType.Monster)),J=z.next();!J.done;J=z.next()){w=J.value;var Y=this.ComPos.gx[w]*V,Z=this.ComPos.gy[w]*V;v.strokeColor=cc.Color.RED,v.rect(Y,Z,V,V),v.stroke()}}catch(st){h={error:st}}finally{try{J&&!J.done&&(y=z.return)&&y.call(z)}finally{if(h)throw h.error}}try{for(var Q=a(_.GetGroup(u.EComType.Player)),$=Q.next();!$.done;$=Q.next()){w=$.value;var tt=this.ComPos.gx[w]*V,et=this.ComPos.gy[w]*V;v.strokeColor=cc.Color.RED,v.rect(tt,et,V,V),v.stroke()}}catch(ct){d={error:ct}}finally{try{$&&!$.done&&(m=Q.return)&&m.call(Q)}finally{if(d)throw d.error}}A=this.SystemMap.mapRect,v.strokeColor=cc.Color.RED,v.rect(A.x,A.y,A.width,A.height),v.stroke();var rt=this.SystemMap.mapBound;v.strokeColor=cc.Color.GREEN,v.rect(rt.x,rt.y,rt.width,rt.height),v.stroke(),rt=this.SystemMap.BossBound,v.strokeColor=cc.Color.RED,v.rect(rt.x,rt.y,rt.width,rt.height),v.stroke()},e.prototype.getGraph=function(){return this.graph},e.prototype.onUpdateName=function(){var t,e,r,o,n,i,l,s,c=this.root,p=this.tlUpdate,f=(this.tlRm,this.tlTextNode),h=this.tlText,y=this.ids;p.clear();var d=this.ComType.GetGroup(u.EComType.Monster);try{for(var m=a(d),v=m.next();!v.done;v=m.next()){var _=v.value;p.add(_)}}catch(x){t={error:x}}finally{try{v&&!v.done&&(e=m.return)&&e.call(m)}finally{if(t)throw t.error}}var S=this.ComType.GetGroup(u.EComType.Bullet);try{for(var g=a(S),b=g.next();!b.done;b=g.next())_=b.value,p.add(_)}catch(T){r={error:T}}finally{try{b&&!b.done&&(o=g.return)&&o.call(g)}finally{if(r)throw r.error}}var C=this.ComType.GetGroup(u.EComType.BossGuardMonster);try{for(var R=a(C),M=R.next();!M.done;M=R.next())_=M.value,p.add(_)}catch(j){n={error:j}}finally{try{M&&!M.done&&(i=R.return)&&i.call(R)}finally{if(n)throw n.error}}for(_=0;_<h.length;_++)null!=(G=h[_])&&(p.has(_)||(G.string=""));var w=this.ComPos.x,O=this.ComPos.y;this.ComVar.NAME;try{for(var B=a(p),P=B.next();!P.done;P=B.next()){var G=h[_=P.value],k=f[_];null==G&&(k=new cc.Node,c.addChild(k),G=k.addComponent(cc.Label),f[_]=k,h[_]=G,y.add(_)),k.x=w[_],k.y=O[_],G.string=_.toString()}}catch(I){l={error:I}}finally{try{P&&!P.done&&(s=B.return)&&s.call(B)}finally{if(l)throw l.error}}},e.__cname="SubDebugDraw",i([l.injectField("SystemMap")],e.prototype,"SystemMap",void 0),i([l.injectField("SystemMove")],e.prototype,"SystemMove",void 0),i([l.injectField("ComType")],e.prototype,"ComType",void 0),i([l.injectField("ComPos")],e.prototype,"ComPos",void 0),i([l.injectField("ComVar")],e.prototype,"ComVar",void 0),i([l.injectField("ComVelocity")],e.prototype,"ComVelocity",void 0),i([l.injectField("ComCollision")],e.prototype,"ComCollision",void 0),i([l.injectField("SystemState")],e.prototype,"SystemState",void 0),e}(s.BaseSubBattleSystem);r.SubDebugDraw=p,cc._RF.pop()},{"../../../../../framework/container/Container":void 0,"../base/BaseSubBattleSystem":"BaseSubBattleSystem","../logic/state/SystemState":"SystemState","../logic/type/ComType":"ComType"}],SubGamePlay:[function(t,e,r){"use strict";cc._RF.push(e,"6ed55iNF1xC46wIvq1ILjuU","SubGamePlay");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.SubGamePlay=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnBeforeStart=function(){return null},e.__cname="SubGamePlay",e}(t("../../base/BaseSubBattleSystem").BaseSubBattleSystem);r.SubGamePlay=i,cc._RF.pop()},{"../../base/BaseSubBattleSystem":"BaseSubBattleSystem"}],SubServerDefault:[function(t,e,r){"use strict";cc._RF.push(e,"7b5ab9D+Z1M85lS44bRG8RK","SubServerDefault");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.SubServerDefault=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetHost=function(){return this.ServerAddress.host},e.prototype.GetPort=function(){return this.ServerAddress.port},e.prototype.GetIsWSS=function(){return!1},e.__cname="SubServerDefault",e}(t("./SubServerHandler").SubServerHandler);r.SubServerDefault=i,cc._RF.pop()},{"./SubServerHandler":"SubServerHandler"}],SubServerHandler:[function(t,e,r){"use strict";cc._RF.push(e,"3a5191YT3NJ0Y89sSNJEwSB","SubServerHandler"),Object.defineProperty(r,"__esModule",{value:!0}),r.SubServerHandler=void 0;var o=function(){function t(){}return Object.defineProperty(t.prototype,"ServerAddress",{get:function(){return this.ModelServer.GetServerAddress()},enumerable:!1,configurable:!0}),t.__cname="SubServerHandler",t}();r.SubServerHandler=o,cc._RF.pop()},{}],SubServerWX:[function(t,e,r){"use strict";cc._RF.push(e,"4cfbeA3GvpEEKi17TefZPMA","SubServerWX");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.SubServerWX=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetHost=function(){return this.ServerAddress.wssHost},e.prototype.GetPort=function(){return this.ServerAddress.wssPort},e.prototype.GetIsWSS=function(){return!0},e.__cname="SubServerWX",e}(t("./SubServerHandler").SubServerHandler);r.SubServerWX=i,cc._RF.pop()},{"./SubServerHandler":"SubServerHandler"}],SubSpawnBox:[function(t,e,r){"use strict";cc._RF.push(e,"36e50rJH/pH5phQzKz0PbGG","SubSpawnBox");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.SubSpawnBox=void 0;var l=t("../../../../../../../framework/container/Container"),s=t("../WaveType"),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tmDropPlan=new Map,e.tmPoint2BoxDropPlan=new Map,e.tmPoint2DropPlan=new Map,e}return n(e,t),e.prototype.OnInit=function(){},e.prototype.OnEnter=function(){var t,e,r=this.Battle.startConfig.fubenId,o=this.ModelBattleDrop.GetTlDropPlan(r);try{for(var n=a(o),i=n.next();!i.done;i=n.next()){var l=i.value;this.SetPoint2Box(l)}}catch(s){t={error:s}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}},e.prototype.OnExit=function(){},e.prototype.OnUpdate=function(t){this.UpdateWave(),this.UpdateHandler(t)},e.prototype.GetTime=function(){return this.SystemSpawn.SubTimer.GetTime()},e.prototype.KeepBox=function(){var t=this.ComVar.HEROID,e=this.ComPos.x,r=this.ComPos.y,o=this.SystemSpawn.SubBuilder.getFirstBuilderBy(s.WaveType.Box);null!=o&&(o.SetStartXY(e[t],r[t]),o.Apply())},e.prototype.RunCreateBox=function(t,e){var r=this.ComPos.x,o=this.ComPos.y,n=this.ComVar.HEROID,i=t.GetBoxDropPlan();if(null!=i){var a=this.SystemSpawn.SubBuilder.getFirstBuilderBy(s.WaveType.Box);if(null!=a){var l=a.GetContext();l.num=i.refreshNum,l.radiusMin=e.GetRadiusMin(),l.radiusMax=e.GetRadiusMax(),l.numMax=e.GetMaxNum(),l.radiusDestroy=e.GetOpenRadius(),a.SetContext(l),a.SetStartXY(r[n],o[n]),a.Apply()}}},e.prototype.UpdateWave=function(){var t=this.SystemSpawn.GetPoint();this.lastPoint!=t&&(this.lastPoint=t,this.OnUpdateWave())},e.prototype.OnUpdateWave=function(){var t=this.lastPoint,e=this.GetBoxHandlerByPoint(t);e&&this.ApplyHandler(e)},e.prototype.ApplyHandler=function(t){this.running!==t&&(this.running&&this.running.Exit(),this.running=t,this.running.Enter())},e.prototype.UpdateHandler=function(t){this.running&&this.running.Update(t)},e.prototype.SetPoint2Box=function(t){var e=t.GetPoint(),r=t.GetBoxDropPlan();if(null!=r){var o=r.id,n=(r.refreshNum,r.refreshTime,this.GetBoxHandler(o));if(null==n){var i=this.ModelBattleDrop.GetBoxDropPlan(o);this.assert(null!=i,"\u7b56\u5212\u68c0\u67e5, battleBoxDropPlan.json\u4e0d\u5b58\u5728:"+o),(n=new u).refBoxDropPlan=i,n.SubSpawnBox=this,this.tmDropPlan.set(o,n)}this.tmPoint2BoxDropPlan.set(e,n),this.tmPoint2DropPlan.set(e,t)}},e.prototype.GetBoxHandler=function(t){return this.tmDropPlan.get(t)},e.prototype.GetBoxHandlerByPoint=function(t){for(var e=this.tmPoint2BoxDropPlan.keys(),r=e.next();!r.done;){var o=e.next();if(o.done)break;if(t<o.value)break;r=o}var n=r.value,i=(this.Battle.startConfig.fubenId,null);return this.tmPoint2BoxDropPlan.has(n)&&(i=this.tmPoint2BoxDropPlan.get(n)),i},e.prototype.GetDropPlanByPoint=function(t){for(var e=this.tmPoint2DropPlan.keys(),r=e.next();!r.done;){var o=e.next();if(o.done)break;if(t<o.value)break;r=o}var n=r.value,i=this.Battle.startConfig.fubenId,a=this.tmPoint2DropPlan.get(n);return this.assert(null!=a,"\u65e0\u6cd5\u627e\u5230\u9676\u7f50\u5237\u65b0\u8282\u70b9\u4fe1\u606f: fubenId:"+i+" point:"+t),a},e.prototype.GetCurDropPlan=function(){var t=this.SystemSpawn.GetPoint();return this.GetDropPlanByPoint(t)},e.__cname="SubSpawnBox",i([l.injectField("ComVar")],e.prototype,"ComVar",void 0),i([l.injectField("ComPos")],e.prototype,"ComPos",void 0),i([l.injectField("Battle")],e.prototype,"Battle",void 0),i([l.injectField("ModelBattleDrop")],e.prototype,"ModelBattleDrop",void 0),e}(t("./SubSpawn").SubSpawn);r.SubSpawnBox=c;var u=function(){function t(){this.nextTime=0}return t.prototype.Enter=function(){this.nextTime=0},t.prototype.Exit=function(){},t.prototype.Update=function(){var t=this.SubSpawnBox.GetCurDropPlan();if(null!=t){var e=t.GetBoxDropPlan();if(null!=e){var r=e.refreshTime,o=this.SubSpawnBox.GetTime();o>this.nextTime&&(this.nextTime=o+r,this.SubSpawnBox.RunCreateBox(t,this.refBoxDropPlan))}}},t}();cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../WaveType":"WaveType","./SubSpawn":"SubSpawn"}],SubSpawnBuilder:[function(t,e,r){"use strict";cc._RF.push(e,"55eb5AYMg5EOL79jm6Fj2Ey","SubSpawnBuilder");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.SubSpawnBuilder=void 0;var s=t("../../../../../../../framework/container/Container"),c=t("../builder/SBBoss"),u=t("../builder/SBBox"),p=t("../builder/SBLeftRight"),f=t("../builder/SBRing"),h=t("../builder/SBSquare"),y=t("../builder/SBSquareAngle"),d=t("../builder/SBTopBot"),m=t("../WaveType"),v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tmBuilderClazz=new Map,e.tmBuilder=new Map,e.tmType2Builder=new Map,e.isEnter=!1,e}return n(e,t),e.prototype.OnInit=function(){this.SystemSpawn.SubBuilder.setBuilderClazz(m.WaveType.Box,u.SBBox),this.SystemSpawn.SubBuilder.setBuilderClazz(m.WaveType.Square,h.SBSquare),this.SystemSpawn.SubBuilder.setBuilderClazz(m.WaveType.SquareAngle,y.SBSquareAngle),this.SystemSpawn.SubBuilder.setBuilderClazz(m.WaveType.Ring,f.SBRing),this.SystemSpawn.SubBuilder.setBuilderClazz(m.WaveType.TopBot,d.SBTopBot),this.SystemSpawn.SubBuilder.setBuilderClazz(m.WaveType.LeftRight,p.SBLeftRight),this.SystemSpawn.SubBuilder.setBuilderClazz(m.WaveType.Boss,c.SBBoss)},e.prototype.onDestroy=function(){var t,e;try{for(var r=a(this.tmBuilder),o=r.next();!o.done;o=r.next()){var n=l(o.value,2);n[0],n[1].Release()}}catch(i){t={error:i}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}this.clearAllBuilder()},e.prototype.OnEnter=function(){var t,e,r,o,n,i;try{for(var s=a(this.ModelBattleWave.RefWaveType.getRefAll()),c=s.next();!c.done;c=s.next()){var u=c.value;this.createBuilder(u.id)}}catch(_){t={error:_}}finally{try{c&&!c.done&&(e=s.return)&&e.call(s)}finally{if(t)throw t.error}}this.isEnter=!0;try{for(var p=a(this.tmBuilder),f=p.next();!f.done;f=p.next()){var h=l(f.value,2),y=(h[0],h[1]);this.container.inject(y),y.SetContainer(this.container)}}catch(S){r={error:S}}finally{try{f&&!f.done&&(o=p.return)&&o.call(p)}finally{if(r)throw r.error}}try{for(var d=a(this.tmBuilder),m=d.next();!m.done;m=d.next()){var v=l(m.value,2);v[0],(y=v[1]).Enter()}}catch(g){n={error:g}}finally{try{m&&!m.done&&(i=d.return)&&i.call(d)}finally{if(n)throw n.error}}},e.prototype.OnExit=function(){var t,e;this.isEnter=!1;try{for(var r=a(this.tmBuilder),o=r.next();!o.done;o=r.next()){var n=l(o.value,2);n[0],n[1].Exit()}}catch(i){t={error:i}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},e.prototype.setBuilderClazz=function(t,e){this.tmBuilderClazz.set(t,e)},e.prototype.clearAllBuilder=function(){this.tmBuilderClazz.clear()},e.prototype.createBuilder=function(t){var e=this.ModelBattleWave.GetWaveType(t);this.assert(null!=e,"\u914d\u7f6e\u8868\u9519\u8bef\u8bf7\u68c0\u67e5: \u5237\u602a\u9635\u578b\u8868 "+t);var r=e.GetType(),o=this.tmBuilderClazz.get(r);this.assert(null!=o,"\u5237\u602a\u7c7b\u578b\u672a\u6ce8\u518c\uff0c\u8bf7\u8054\u7cfb\u7a0b\u5e8f typeId:"+t+" type:"+r);var n=new o;return n.SetRefWaveType(e),n.Init(),this.tmBuilder.set(t,n),0==this.tmType2Builder.has(r)&&this.tmType2Builder.set(r,n),n},e.prototype.getBuilder=function(t){return this.tmBuilder.get(t)},e.prototype.getFirstBuilderBy=function(t){return this.tmType2Builder.get(t)},e.__cname="SubSpawnBuilder",i([s.injectField("ModelBattleWave")],e.prototype,"ModelBattleWave",void 0),e}(t("./SubSpawn").SubSpawn);r.SubSpawnBuilder=v,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../WaveType":"WaveType","../builder/SBBoss":"SBBoss","../builder/SBBox":"SBBox","../builder/SBLeftRight":"SBLeftRight","../builder/SBRing":"SBRing","../builder/SBSquare":"SBSquare","../builder/SBSquareAngle":"SBSquareAngle","../builder/SBTopBot":"SBTopBot","./SubSpawn":"SubSpawn"}],SubSpawnCameraZoom:[function(t,e,r){"use strict";cc._RF.push(e,"cd3f2/JchZOjLQIwz01taTx","SubSpawnCameraZoom");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.SubSpawnCameraZoom=void 0;var l=t("../../../../../../../framework/container/Container"),s=t("../../../view/camera/SubSysCameraZoom"),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tmPoint2level=new Map,e}return n(e,t),Object.defineProperty(e.prototype,"startConfig",{get:function(){return this.Battle.startConfig},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"time",{get:function(){return this.SystemSpawn.SubTimer.GetTime()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"point",{get:function(){return this.SystemSpawn.GetPoint()},enumerable:!1,configurable:!0}),e.prototype.OnEnter=function(){this.SubSysCameraZoom=this.SystemCamera.GetSubSystem(s.SubSysCameraZoom),this.initPointData()},e.prototype.OnUpdate=function(){this.updatePointData()},e.prototype.initPointData=function(){var t,e,r=this.startConfig.waveId,o=this.ModelBattleWave.GetWave(r),n=this.ModelBattleWave.GetWaveNums(o.wavePlanId);try{for(var i=a(n),l=i.next();!l.done;l=i.next()){var s=l.value,c=Math.max(0,s.GetPoint());this.tmPoint2level.has(c)||this.tmPoint2level.set(c,s.GetCameraZoom())}}catch(u){t={error:u}}finally{try{l&&!l.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}},e.prototype.updatePointData=function(){var t=this.point;if(this.lastpoint!=t){this.lastpoint=t;var e=this.tmPoint2level.get(t);null!=e&&0!=e&&this.SubSysCameraZoom.NextCameraZoomLevel(e)}},e.__cname="SubSpawnCameraZoom",i([l.injectField("SystemCamera")],e.prototype,"SystemCamera",void 0),i([l.injectField("ModelBattleWave")],e.prototype,"ModelBattleWave",void 0),i([l.injectField("Battle")],e.prototype,"Battle",void 0),e}(t("./SubSpawn").SubSpawn);r.SubSpawnCameraZoom=c,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../../view/camera/SubSysCameraZoom":"SubSysCameraZoom","./SubSpawn":"SubSpawn"}],SubSpawnClear:[function(t,e,r){"use strict";cc._RF.push(e,"7071dqfqPdEaI28jFlKrgq/","SubSpawnClear");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.SubSpawnClear=void 0;var s=t("../../../../../../../framework/container/Container"),c=t("../../../../../../../framework/FW"),u=t("../../type/ComType"),p=t("./SubSpawn"),f=2e3,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.clear_range=f,e._cleartime=0,e._tlDestroy=[],e._tlMove=[],e._tempgrid=[],e}return n(e,t),e.prototype.OnInit=function(){},e.prototype.OnEnter=function(){var t="battleMonsterActiveRange",e=this.ModelGameConfig.GetGameConfigValueByKey(t);null!=e&&"number"==typeof e?this.clear_range=e:c.FW.ZJJ.error("\u6570\u636e\u914d\u7f6e\u5f02\u5e38 key:"+t)},e.prototype.EnterAsync=function(){},e.prototype.OnExit=function(){},e.prototype.OnUpdate=function(t){this.UpdateTime(t)},e.prototype.UpdateTime=function(t){var e=this._cleartime+t,r=!1;e>1&&(e-=1,r=!0),this._cleartime=e,r&&this.ClearMonster()},e.prototype.ClearMonster=function(){var t,e,r,o,n,i,l=this.ComState,s=(this.SystemRole,this.ComVar.MONSTER_REF),p=this.ComVar.HEROID,f=this.ComPos.x,h=this.ComPos.y,y=this._tlDestroy,d=this._tlMove,m=this.clear_range;y.length=0,d.length=0;var v=this.ComType.GetGroup(u.EComType.Monster),_=m*m;try{for(var S=a(v),g=S.next();!g.done;g=S.next()){var b=g.value,C=f[p]-f[b],R=h[p]-h[b];if(!(C*C+R*R<_)){var M=s[b];M.GetIsMonster()?y.push(b):M.GetIsElite()&&d.push(b)}}}catch(G){t={error:G}}finally{try{g&&!g.done&&(e=S.return)&&e.call(S)}finally{if(t)throw t.error}}try{for(var w=a(y),O=w.next();!O.done;O=w.next())b=O.value,l.SwitchDestroy(b)}catch(k){r={error:k}}finally{try{O&&!O.done&&(o=w.return)&&o.call(w)}finally{if(r)throw r.error}}y.length>0&&c.FW.ZJJ.log("\u5df2\u9500\u6bc1\u5c0f\u602a:"+y.length),y.length=0,d.length>0&&this.RefreshTempGrid();try{for(var B=a(d),P=B.next();!P.done;P=B.next())b=P.value,this.RandomPos(b)}catch(x){n={error:x}}finally{try{P&&!P.done&&(i=B.return)&&i.call(B)}finally{if(n)throw n.error}}d.length=0},e.prototype.RefreshTempGrid=function(){var t=this._tempgrid;t.length=0,this.SystemMove.GetGridOutView(200,t)},e.prototype.RandomPos=function(t){var e,r,o=this._tempgrid,n=this.ComPos.x,i=this.ComPos.y;if(o.length>0){var a=this.SystemMap.gridSize,s=o[Math.floor(Math.random()*o.length)];s&&(e=(s.gx+.5)*a,r=(s.gy+.5)*a)}if(null==e){var u=Math.max(100,this.clear_range-200)+200*Math.random(),p=2*Math.PI*Math.random();e=u*Math.cos(p),r=u*Math.sin(p)}if(null!=e&&!isNaN(e)){var f=l(this.SystemMove.fixPos(e,r),2),h=f[0],y=f[1];n[t]=h,i[t]=y,c.FW.ZJJ.log("\u602a\u7269 "+t+" \u4f4d\u79fb: "+e+","+r)}},e.__cname="SubSpawnClear",i([s.injectField("ComType")],e.prototype,"ComType",void 0),i([s.injectField("ComVar")],e.prototype,"ComVar",void 0),i([s.injectField("ComPos")],e.prototype,"ComPos",void 0),i([s.injectField("ComState")],e.prototype,"ComState",void 0),i([s.injectField("SystemMove")],e.prototype,"SystemMove",void 0),i([s.injectField("SystemMap")],e.prototype,"SystemMap",void 0),i([s.injectField("SystemRole")],e.prototype,"SystemRole",void 0),i([s.injectField("ModelGameConfig")],e.prototype,"ModelGameConfig",void 0),e}(p.SubSpawn);r.SubSpawnClear=h,cc._RF.pop()},{"../../../../../../../framework/FW":void 0,"../../../../../../../framework/container/Container":void 0,"../../type/ComType":"ComType","./SubSpawn":"SubSpawn"}],SubSpawnMonster:[function(t,e,r){"use strict";cc._RF.push(e,"d2d64sWQKtOEJgGpspNE4Zk","SubSpawnMonster");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.SubSpawnMonster=void 0;var s=t("../../../../../../../framework/container/Container"),c=t("../ConstSpawn"),u=t("../WaveType"),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tlTimeline=[],e.tmPoint=new Map,e.tmRecordPoint=new Set,e.tlPoint=[],e.tmBossPoint=new Set,e.spawnedPoint=new Set,e.runninWave=[],e._lastIsBoss=!1,e._apply=!1,e}return n(e,t),Object.defineProperty(e.prototype,"startConfig",{get:function(){return this.Battle.startConfig},enumerable:!1,configurable:!0}),e.prototype.OnInit=function(){},e.prototype.onDestroy=function(){},e.prototype.OnEnter=function(){this.initWaveData()},e.prototype.OnExit=function(){},e.prototype.OnUpdate=function(){0==this.Battle.startConfig.debugField&&this.UpdateWave(),this._apply&&this.ApplyWaveInner()},Object.defineProperty(e.prototype,"time",{get:function(){return this.SystemSpawn.SubTimer.GetTime()},enumerable:!1,configurable:!0}),e.prototype.initWaveData=function(){var t,e,r,o,n,i,s,p,f=this.startConfig.waveId,h=this.ModelBattleWave.GetWave(f),y=h.wavePlanId,d=this.ModelBattleWave.GetWavePlan(y),m=this.ModelBattleWave.GetWaveNums(d.id),v=this.tlTimeline;try{for(var _=a(m),S=_.next();!S.done;S=_.next()){var g=S.value,b=new c.WaveData,C=this.ModelBattleWave.GetWaveType(g.GetTypeId());b.SetupByRef(g.GetRef(),h,C),v.push(b)}}catch(q){t={error:q}}finally{try{S&&!S.done&&(e=_.return)&&e.call(_)}finally{if(t)throw t.error}}var R=this.tmPoint,M=this.tmRecordPoint,w=this.tlPoint,O=0,B=0,P=this.tmBossPoint;try{for(var G=a(v),k=G.next();!k.done;k=G.next()){var x=k.value,T=x.GetPoint(),j=x.GetDuration(),I=T+j;I>O&&(O=T,B=j),M.add(T),x.GetType()==u.WaveType.Boss&&P.add(T);var D=function(t,e){var r=R.get(t);null==r&&(r=[],R.set(t,r),w.push(t)),r.push(e)};if(j<=1)D(T,x);else for(var F=T;F<I;F++)D(F,x)}}catch(K){r={error:K}}finally{try{k&&!k.done&&(o=G.return)&&o.call(G)}finally{if(r)throw r.error}}try{for(var L=a(this.tmPoint),E=L.next();!E.done;E=L.next()){var A=l(E.value,2),V=(T=A[0],A[1]),U=null;try{for(var W=(s=void 0,a(V)),H=W.next();!H.done;H=W.next()){var N=H.value;if(N.IsBoss()){U=N;break}}}catch(X){s={error:X}}finally{try{H&&!H.done&&(p=W.return)&&p.call(W)}finally{if(s)throw s.error}}U&&(V.length=0,V.push(U))}}catch(z){n={error:z}}finally{try{E&&!E.done&&(i=L.return)&&i.call(L)}finally{if(n)throw n.error}}this.pointLimit=O+B,this.pointMax=O},e.prototype.UpdateWave=function(){var t,e,r,o=this.time,n=Math.floor(o),i=this.spawnedPoint;0==i.has(n)&&(i.add(n),this.tmPoint.has(n)&&(r=this.tmPoint.get(n)));var l=this.tmRecordPoint;if(r){var s=Math.floor(this.time),c=this.lastPoint,u=this.runninWave,p=!1;if(u)try{for(var f=a(u),h=f.next();!h.done;h=f.next())if(h.value.IsBoss()){p=!0;break}}catch(y){t={error:y}}finally{try{h&&!h.done&&(e=f.return)&&e.call(f)}finally{if(t)throw t.error}}this.lastPoint=s,this.runninWave=r,p&&(this.lastBossPoint=c),this.OnWaveChange(),l.has(s)&&(this.lastRecordPoint=s)}},e.prototype.GetCurWave=function(){return this.runninWave},e.prototype.GetLastPoint=function(){return this.lastPoint},e.prototype.GetLastRecordPoint=function(){return this.lastRecordPoint},e.prototype.GetPointLimit=function(){return this.pointLimit},e.prototype.OnWaveChange=function(){var t,e,r=this.GetCurWave();1==this._lastIsBoss?(this._lastIsBoss=!1,this.GPNetSync.MarkSyncBeat(!0,!0)):this.GPNetSync.MarkSyncBeat();var o=!1;try{for(var n=a(r),i=n.next();!i.done;i=n.next())if(i.value.IsBoss()){o=!0,this._lastIsBoss=!0;break}}catch(l){t={error:l}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}o?this.SystemSpawn.SpawnFSM.SwitchBoss():this.SystemSpawn.SpawnFSM.SwitchSpawn()},e.prototype.ApplyWave=function(t){void 0===t&&(t=!1),t?this.ApplyWaveInner():this._apply=!0},e.prototype.ApplyWaveInner=function(){var t,e,r=Math.floor(this.time);this._apply=!1;try{for(var o=a(this.GetCurWave()),n=o.next();!n.done;n=o.next()){var i=n.value,l=i.GetMonster(),s=i.GetSparseByTime(r);if(0!=l){var c=this.SystemSpawn.SubBuilder.getBuilder(i.GetTypeId());c.Setup(l,s),c.Apply()}}}catch(u){t={error:u}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}},e.prototype.ApplyDebug=function(t,e,r){var o=this.SystemSpawn.SubBuilder.getFirstBuilderBy(e);if(null!=o){var n=this.ComVar.HEROID,i=this.ComPos.x[n],a=this.ComPos.y[n];e==u.WaveType.Boss&&(a+=400),o.SetStartXY(i,a),o.Setup(t,r),o.Apply()}},e.prototype.GetNextWave=function(){var t=this.lastPoint,e=this.tlPoint.indexOf(t);if(-1!=e){var r=this.tlPoint[e+1];return this.tmPoint.get(r)[0]}return null},e.prototype.NextWave=function(){var t=this.lastPoint,e=this.tlPoint.indexOf(t);if(-1!=e){var r=this.pointLimit,o=this.tlPoint[e+1];o&&(r=o),this.SystemSpawn.SubTimer.SetTime(r),this.UpdateWave()}},e.prototype.HasNextWave=function(){return Math.floor(this.time)<this.pointLimit},e.prototype.GetTmBossPoint=function(){return this.tmBossPoint},e.prototype.GetLastBossPoint=function(){return this.lastBossPoint},e.__cname="SubSpawnMonster",i([s.injectField("ComPos")],e.prototype,"ComPos",void 0),i([s.injectField("ComVar")],e.prototype,"ComVar",void 0),i([s.injectField("Battle")],e.prototype,"Battle",void 0),i([s.injectField("ModelBattleWave")],e.prototype,"ModelBattleWave",void 0),i([s.injectField("GPNetSync")],e.prototype,"GPNetSync",void 0),e}(t("./SubSpawn").SubSpawn);r.SubSpawnMonster=p,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../ConstSpawn":"ConstSpawn","../WaveType":"WaveType","./SubSpawn":"SubSpawn"}],SubSpawnPrefab:[function(t,e,r){"use strict";cc._RF.push(e,"648881UgetKbYRq/5RXW9ZB","SubSpawnPrefab");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},c=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.SubSpawnPrefab=void 0;var u=t("../../../../../../../framework/container/Container"),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.canvas=cc.director.getScene().getChildByName("Battle"),e.tmPrefab=new Map,e}return n(e,t),e.prototype.OnInit=function(){},e.prototype.onDestroy=function(){this.UnloadRes(),this.root.destroy(),this.root=null,t.prototype.onDestroy.call(this)},e.prototype.EnterAsync=function(){var t=new cc.Node("SystemSpawn");return this.root=t,this.canvas.addChild(t,1),this.LoadRes()},e.prototype.LoadRes=function(){return a(this,void 0,void 0,function(){var t,e,r=this;return l(this,function(){return t=[],(e=this.ModelPrefab.CreateAsset("\u516c\u5171_Boss\u9886\u57df")).then(function(t){r.tmPrefab.set("\u516c\u5171_Boss\u9886\u57df",t),r.root.addChild(t,0),t.active=!1}),t.push(e),[2,Promise.all(t)]})})},e.prototype.UnloadRes=function(){var t,e;try{for(var r=s(this.tmPrefab),o=r.next();!o.done;o=r.next()){var n=c(o.value,2),i=(n[0],n[1]);i.removeFromParent(),this.ModelPrefab.DestroyAsset(i)}}catch(a){t={error:a}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},e.prototype.GetPrefab=function(t){return this.tmPrefab.get(t)},e.__cname="SubSpawnPrefab",i([u.injectField("ModelPrefab")],e.prototype,"ModelPrefab",void 0),e}(t("./SubSpawn").SubSpawn);r.SubSpawnPrefab=p,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"./SubSpawn":"SubSpawn"}],SubSpawnTimer:[function(t,e,r){"use strict";cc._RF.push(e,"19523XIpidCC7ZN/RhlMZA1","SubSpawnTimer");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.SubSpawnTimer=void 0;var a=t("../../../../../../../framework/container/Container"),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.time=0,e.jump=!1,e._curtime=0,e}return n(e,t),e.prototype.GetMulte=function(){return this.Battle.startConfig.multeSpeed||1},e.prototype.OnInit=function(){},e.prototype.onDestroy=function(){},e.prototype.OnEnter=function(){},e.prototype.OnUpdate=function(t){t*=this.GetMulte();var e=this.time+t;this.time=e,this.jump&&(this.jump=!1,this.SystemSpawn.SubMonster.NextWave()),this.updateTimer(t)},e.prototype.updateTimer=function(t){var e=this._curtime;(e+=t)>=1&&(e-=1,this.ComVar.takeGametime(this.ComVar.GAMETIME+1)),this._curtime=e},e.prototype.JumpNextWave=function(){this.jump=!0},e.prototype.GetTime=function(){return this.time},e.prototype.GetPoint=function(){return Math.floor(this.time)},e.prototype.SetTime=function(t){this.time=t},e.prototype.SetStartTime=function(t){this.SetTime(t);var e=this.Battle.startConfig.waveId;this.ComVar.takeTotalTime(this.ModelBattleWave.GetTotalTime(e)),this.ComVar.takeStartTime(0),this.ComVar.takeGametime(t)},e.__cname="SubSpawnTimer",i([a.injectField("ComVar")],e.prototype,"ComVar",void 0),i([a.injectField("Battle")],e.prototype,"Battle",void 0),i([a.injectField("ModelBattleWave")],e.prototype,"ModelBattleWave",void 0),e}(t("./SubSpawn").SubSpawn);r.SubSpawnTimer=l,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"./SubSpawn":"SubSpawn"}],SubSpawnTips:[function(t,e,r){"use strict";cc._RF.push(e,"752ea8x1CBBhbH6j5UP2cd4","SubSpawnTips");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.SubSpawnTips=void 0;var l=t("../../../../../../../framework/container/Container"),s=t("../../../../../../ref/RefWaveNum"),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tmPoint=new Map,e.tlPoint=[],e.pointIndex=0,e}return n(e,t),Object.defineProperty(e.prototype,"startConfig",{get:function(){return this.Battle.startConfig},enumerable:!1,configurable:!0}),e.prototype.OnInit=function(){},e.prototype.onDestroy=function(){},e.prototype.OnEnter=function(){this.UpdateData()},e.prototype.OnExit=function(){},e.prototype.OnUpdate=function(){this.OnUpdateTips()},Object.defineProperty(e.prototype,"time",{get:function(){return this.SystemSpawn.SubTimer.GetTime()},enumerable:!1,configurable:!0}),e.prototype.UpdateData=function(){var t,e,r=this.startConfig.waveId,o=this.ModelBattleWave.GetWave(r),n=this.ModelBattleWave.GetWaveNums(o.wavePlanId);try{for(var i=a(n),l=i.next();!l.done;l=i.next()){var c=l.value;if(c.GetTips()!=s.RefWaveNumTips.None){var u=Math.max(0,c.GetPoint()-0);0==this.tmPoint.has(u)&&(this.tmPoint.set(u,{point:u,type:c.GetTips()}),this.tlPoint.push(u))}}}catch(p){t={error:p}}finally{try{l&&!l.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}},e.prototype.OnUpdateTips=function(){var t=null,e=Math.ceil(this.time);this.tmPoint.forEach(function(r){r.point-0<=e&&(t=r)}),t&&Math.floor(this.time)>=t.point&&(!this._lastTime||this._lastTime<=t.point)&&(this.sendTips(t.type),this._lastTime=e)},e.prototype.sendTips=function(t){switch(t){case s.RefWaveNumTips.Monster:this.SystemEvent.sendTipsMonster();break;case s.RefWaveNumTips.Boss:this.SystemEvent.sendTipsBoss()}},e.__cname="SubSpawnTips",i([l.injectField("ModelBattleWave")],e.prototype,"ModelBattleWave",void 0),i([l.injectField("Battle")],e.prototype,"Battle",void 0),i([l.injectField("SystemEvent")],e.prototype,"SystemEvent",void 0),e}(t("./SubSpawn").SubSpawn);r.SubSpawnTips=c,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../../../../../ref/RefWaveNum":"RefWaveNum","./SubSpawn":"SubSpawn"}],SubSpawn:[function(t,e,r){"use strict";cc._RF.push(e,"b2280FRBktFWJrI9Q+oLYrw","SubSpawn");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.SubSpawn=void 0;var i=function(t){function e(){return t.call(this)||this}return n(e,t),e.prototype.Init=function(t,e){this.container=e,this.SystemSpawn=t,this.OnInit()},e.prototype.Update=function(t){this.OnUpdate(t)},e.prototype.Enter=function(){this.OnEnter()},e.prototype.Exit=function(){this.OnExit()},e.prototype.OnInit=function(){},e.prototype.OnEnter=function(){},e.prototype.EnterAsync=function(){},e.prototype.OnExit=function(){},e.prototype.OnUpdate=function(){},e.__cname="SubSpawn",e}(t("../../../../../../../framework/base/ScriptObject").ScriptObject);r.SubSpawn=i,cc._RF.pop()},{"../../../../../../../framework/base/ScriptObject":void 0}],SubStateBat:[function(t,e,r){"use strict";cc._RF.push(e,"ea77aZ20hxJUqU0/CEzxcTP","SubStateBat");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.SubStateBat=void 0;var l=t("../../../../../../../framework/container/Container"),s=t("../../../../../../../framework/Func"),c=t("../../../debug/SubDebugDraw"),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._time=[],e._rad_start=[],e._rad_sector=[],e._scriptparam=[],e.initD=[],e}return n(e,t),e.prototype.getParam=function(){return this.ComState.param},e.prototype.getScriptParam=function(t){if(null==this._scriptparam[t]){var e=this.ComVar.BULLET_SCRIPT_PARAMS;this._scriptparam[t]={angular:parseInt(e[t][0])||0,duration:(parseInt(e[t][1])||0)/1e3}}return this._scriptparam[t]},e.prototype.onEnter=function(t){var e=this.ComVelocity.vx,r=this.ComVelocity.vy,o=this.ComVelocity.vgx,n=this.ComVelocity.vgy,i=this.ComVelocity.moving;this._time[t]=0,e[t]=0,r[t]=0,o[t]=0,n[t]=0,i[t]=!0},e.prototype.onExit=function(t){this._time[t]=null,this._scriptparam[t]=null,this.ComCollision.SetCustomCollided(t,null,null)},e.prototype.onUpdate=function(t){var e,r;try{for(var o=a(this.ids),n=o.next();!n.done;n=o.next()){var i=n.value;this.updateSector(i,t)}}catch(l){e={error:l}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}},e.prototype.updateSector=function(t,e){var r=this.ComPos.d,o=this.ComPos.x,n=this.ComPos.y,i=this.getParam(),a=this.getScriptParam(t),l=(this._rad_sector,this._rad_start),s=i[t].sender,c=this.Battle.ref2id(s);if(this._time[t]>a.duration)return this.ComState.SwitchDestroy(t),void(this.initD[t]=null);this._time[t]+=e;var u=this.initD[t];u||(u=r[c],this.initD[t]=r[c]),l[t]=u+.25*Math.PI,o[t]=o[c],n[t]=n[c],r[t]=r[c];var p=this.ComVelocity.speed[t]*this._time[t]*10/(300*Math.PI),f=l[t]-p*Math.PI;o[t]=o[c]+150*Math.cos(f),n[t]=n[c]+150*Math.sin(f),r[t]=f},e.prototype.isCollided=function(t,e){var r=this.getParam(),o=this.ComPos.x,n=this.ComPos.y,i=this.ComCollision.r,a=Math.max(0,r[t].radius+(i[t]+i[e])),l=this._rad_start,c=this._rad_sector,u=o[e],p=n[e],f=o[t],h=n[t],y=f+Math.cos(l[t])*a,d=h+Math.sin(l[t])*a,m=f+Math.cos(c[t])*a,v=h+Math.sin(c[t])*a;return s.Func.isPointInFan(u,p,f,h,y,d,m,v)},e.prototype.updateDebug=function(t){if(0!=this.Battle.startConfig.debug){var e=this.getParam(),r=this.ComPos.x,o=this.ComPos.y,n=this._rad_start,i=this._rad_sector,a=(this.getScriptParam(t),e[t].radius),l=this.SystemDebug.GetSubSystem(c.SubDebugDraw).getGraph(),s=r[t],u=o[t],p=s+Math.cos(i[t])*a,f=u+Math.sin(i[t])*a;l.strokeColor=cc.Color.WHITE,l.moveTo(s,u),l.lineTo(p,f),l.stroke(),s=r[t],u=o[t],p=s+Math.cos(n[t])*a,f=u+Math.sin(n[t])*a,l.strokeColor=cc.Color.WHITE,l.moveTo(s,u),l.lineTo(p,f),l.stroke()}},e.__cname="SubStateBat",i([l.injectField("ComState")],e.prototype,"ComState",void 0),i([l.injectField("ComVar")],e.prototype,"ComVar",void 0),i([l.injectField("ComCollision")],e.prototype,"ComCollision",void 0),i([l.injectField("ComPrefab")],e.prototype,"ComPrefab",void 0),i([l.injectField("SystemMove")],e.prototype,"SystemMove",void 0),i([l.injectField("Battle")],e.prototype,"Battle",void 0),i([l.injectField("SystemDebug")],e.prototype,"SystemDebug",void 0),e}(t("./BaseBulletSubState").BaseBulletSubState);r.SubStateBat=u,cc._RF.pop()},{"../../../../../../../framework/Func":void 0,"../../../../../../../framework/container/Container":void 0,"../../../debug/SubDebugDraw":"SubDebugDraw","./BaseBulletSubState":"BaseBulletSubState"}],SubStateBoomerangeSuper:[function(t,e,r){"use strict";cc._RF.push(e,"24fc487A9ZGer6mzClRcVM6","SubStateBoomerangeSuper");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.SubStateBoomerangeSuper=void 0;var s=t("../../../../../../../framework/container/Container"),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._scriptParam=[],e.time=[],e.cenRadStart=[],e.startX=[],e.startY=[],e}return n(e,t),e.prototype.getParam=function(){return this.ComState.param},e.prototype.getScriptParam=function(t){if(null==this._scriptParam[t]){var e=this.ComVar.BULLET_SCRIPT_PARAMS[t];this._scriptParam[t]={turnspeed:parseInt(e[0]||0),lineSpeed:parseInt(e[1]||0)}}return this._scriptParam[t]},e.prototype.onEnter=function(t){var e=this.ComVelocity.vx,r=this.ComVelocity.vy,o=this.ComVelocity.vgx,n=this.ComVelocity.vgy,i=Math.atan2(r[t],e[t]);this.cenRadStart[t]=this.face2Center(i),this.startX[t]=this.ComPos.x[t],this.startY[t]=this.ComPos.y[t],this.time[t]=0,o[t]=0,n[t]=0,e[t]=0,r[t]=0},e.prototype.onExit=function(t){this.time[t]=null,this._scriptParam[t]=null,this.cenRadStart[t]=null,this.startX[t]=null,this.startY[t]=null},e.prototype.onUpdate=function(t){var e,r,o=this.ComVar.BULLET_LIFETIME,n=this.ComVelocity.moving,i=this.time,s=this.cenRadStart,c=this.startX,u=this.startY,p=this.ComPos.x,f=this.ComPos.y,h=this.ComPos.d;try{for(var y=a(this.ids),d=y.next();!d.done;d=y.next()){var m=d.value;if(i[m]+=t,i[m]>=o[m])this.ComState.SwitchDestroy(m);else{var v=this.getScriptParam(m),_=v.turnspeed/180*Math.PI,S=s[m]+i[m]*_,g=v.lineSpeed*i[m],b=Math.cos(S)*g,C=Math.sin(S)*g;b+=c[m],C+=u[m];var R=l(this.SystemMove.fixPos(b,C),2),M=R[0],w=R[1];p[m]=M,f[m]=w,h[m]=this.center2face(S),n[m]=!0}}}catch(O){e={error:O}}finally{try{d&&!d.done&&(r=y.return)&&r.call(y)}finally{if(e)throw e.error}}},e.prototype.face2Center=function(t){return t-.5*Math.PI},e.prototype.center2face=function(t){return t+.5*Math.PI},e.__cname="SubStateBoomerangeSuper",i([s.injectField("ComState")],e.prototype,"ComState",void 0),i([s.injectField("ComVar")],e.prototype,"ComVar",void 0),i([s.injectField("ComCollision")],e.prototype,"ComCollision",void 0),i([s.injectField("SystemMove")],e.prototype,"SystemMove",void 0),i([s.injectField("CtrlAudio")],e.prototype,"CtrlAudio",void 0),i([s.injectField("Battle")],e.prototype,"Battle",void 0),e}(t("./BaseBulletSubState").BaseBulletSubState);r.SubStateBoomerangeSuper=c,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"./BaseBulletSubState":"BaseBulletSubState"}],SubStateBoomerange:[function(t,e,r){"use strict";cc._RF.push(e,"2e0567L3OtF2o2XIcNklwGG","SubStateBoomerange");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.SubStateBoomerange=void 0;var l,s=t("../../../../../../../framework/container/Container"),c=t("./BaseBulletSubState");(function(t){t[t.Move=0]="Move",t[t.Collision=1]="Collision",t[t.Back=2]="Back"})(l||(l={}));var u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state=[],e.time=[],e.d_end=[],e._scriptParam=[],e}return n(e,t),e.prototype.getParam=function(){return this.ComState.param},e.prototype.getScriptParam=function(t){if(null==this._scriptParam[t]){var e=this.ComVar.BULLET_SCRIPT_PARAMS;this._scriptParam[t]={backDistance:parseInt(e[t][0]||0),backSpeed:parseInt(e[t][1]||0)/100,collisionDistance:parseInt(e[t][2]||0)}}return this._scriptParam[t]},e.prototype.onEnter=function(t){this.SwitchMove(t)},e.prototype.onExit=function(t){this.state[t]=null,this.time[t]=null,this._scriptParam[t]=null,this.d_end[t]=null},e.prototype.onUpdate=function(t){var e,r;try{for(var o=a(this.ids),n=o.next();!n.done;n=o.next()){var i=n.value;switch(this.state[i]){case l.Move:this.UpdateStateMove(i,t);break;case l.Back:this.UpdateStateBack(i,t);break;case l.Collision:this.UpdateCollision(i,t)}}}catch(s){e={error:s}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}},e.prototype.SwitchCollision=function(t){this.state[t]=l.Collision,this.time[t]=0},e.prototype.UpdateCollision=function(t,e){var r=this.getScriptParam(t),o=this.ComVelocity.speed,n=this.ComVelocity.moving;this.time[t]+=e,this.time[t]*o[t]>r.collisionDistance?this.SwitchBack(t):n[t]=!0},e.prototype.SwitchMove=function(t){this.state[t]=l.Move},e.prototype.UpdateStateMove=function(t,e){var r=this.ComVelocity.speed,o=this.ComVelocity.moving,n=this.getScriptParam(t),i=this.ComCollision.colliding,a=this.time;1!=i[t]?(a[t]+=e,a[t]*r[t]>=n.backDistance?this.SwitchBack(t):o[t]=!0):this.SwitchCollision(t)},e.prototype.SwitchBack=function(t){var e=this.ComVelocity.vgx,r=this.ComVelocity.vgy,o=this.ComPos.d,n=this.ComVelocity.speed,i=this.getScriptParam(t);this.d_end[t]=o[t]+Math.PI,this.state[t]=l.Back,this.time[t]=0,e[t]*=-1,r[t]*=-1,n[t]*=i.backSpeed},e.prototype.UpdateStateBack=function(t,e){var r=this.time,o=this.d_end,n=this.ComVar.BULLET_LIFETIME,i=this.ComVelocity.moving,a=this.ComVelocity.vx,l=this.ComVelocity.vy,s=this.ComVelocity.vgx,c=this.ComVelocity.vgy,u=this.ComPos.d;r[t]+=e,r[t]>=n[t]&&this.ComState.SwitchDestroy(t),this.ComCollision.recycle[t]||(this.ComCollision.recycle[t]=!0);var p=Math.abs(a[t]-s[t]);if(p>0){var f=.1/p;a[t]=cc.misc.lerp(a[t],s[t],f)}var h=Math.abs(l[t]-c[t]);h>0&&(f=.1/h,l[t]=cc.misc.lerp(l[t],c[t],f));var y=Math.abs(u[t]-o[t]);y<=.01?u[t]=o[t]:(f=.1/y,u[t]=cc.misc.lerp(u[t],o[t],f)),i[t]=!0},e.__cname="SubStateBoomerange",i([s.injectField("ComState")],e.prototype,"ComState",void 0),i([s.injectField("ComVar")],e.prototype,"ComVar",void 0),i([s.injectField("ComCollision")],e.prototype,"ComCollision",void 0),i([s.injectField("ComPrefab")],e.prototype,"ComPrefab",void 0),i([s.injectField("SystemMove")],e.prototype,"SystemMove",void 0),e}(c.BaseBulletSubState);r.SubStateBoomerange=u,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"./BaseBulletSubState":"BaseBulletSubState"}],SubStateBoom:[function(t,e,r){"use strict";cc._RF.push(e,"0c53ebMZUBCArZEj2BTHh7J","SubStateBoom");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.SubStateBoom=void 0;var l=t("../../../../../../../framework/container/Container"),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.time=[],e}return n(e,t),e.prototype.onEnter=function(t){this.time[t]=0},e.prototype.onExit=function(t){this.time[t]=null},e.prototype.onUpdate=function(t){var e,r,o=this.time,n=this.ComVar.BULLET_LIFETIME;try{for(var i=a(this.ids),l=i.next();!l.done;l=i.next()){var s=l.value;o[s]+=t,o[s]>=n[s]&&this.ComState.SwitchDestroy(s)}}catch(c){e={error:c}}finally{try{l&&!l.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}},e.__cname="SubStateBoom",i([l.injectField("ComState")],e.prototype,"ComState",void 0),e}(t("./BaseBulletSubState").BaseBulletSubState);r.SubStateBoom=s,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"./BaseBulletSubState":"BaseBulletSubState"}],SubStateBrick:[function(t,e,r){"use strict";cc._RF.push(e,"ca814HRJiJHQ4M9fgtsxwA+","SubStateBrick");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.SubStateBrick=void 0;var l=t("../../../../../../../framework/container/Container"),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.time=[],e.count=[],e.timex=[],e}return n(e,t),e.prototype.getParam=function(){return this.ComState.param},e.prototype.onEnter=function(t){var e=this.ComVelocity.vgx,r=this.ComVelocity.vgy,o=this.ComVelocity.vx,n=this.ComVelocity.vy,i=this.ComVar.BULLET_SCRIPT_PARAMS[t][0];this.time[t]=0,this.timex[t]=0;var a=Math.sign(Math.random()-.5),l=i.split(","),s=.1*a*Number(l[0]),c=1*Number(l[1]);e[t]=s,r[t]=c,o[t]=s,n[t]=c},e.prototype.onExit=function(t){this.time[t]=null,this.timex[t]=null,this.count[t]=null},e.prototype.onUpdate=function(t){var e,r,o=this.ComState,n=this.ComVelocity.moving,i=this.ComVelocity.vx,l=this.ComVelocity.vy,s=this.ComPos.y,c=this.ComPos.d,u=this.ComVar.BULLET_LIFETIME,p=this.GetMapBound(),f=this.SystemMap.mapRect,h=(p.height-f.height)/2;try{for(var y=a(this.ids),d=y.next();!d.done;d=y.next()){var m=d.value;this.time[m]+=t,u[m]-=t,u[m]<=0||h>=s[m]?o.SwitchDestroy(m):(this.updateHorizon(m,t),this.updateVertical(m,t),c[m]=Math.atan2(l[m],i[m]),n[m]=!0)}}catch(v){e={error:v}}finally{try{d&&!d.done&&(r=y.return)&&r.call(y)}finally{if(e)throw e.error}}},e.prototype.updateVertical=function(t,e){var r=this.ComVelocity.vgy,o=this.ComVelocity.vy,n=(this.ComVelocity.vx,this.ComPos.d,r[t]),i=.9*e;n=Math.max(-1,n-i),r[t]=n,o[t]=n},e.prototype.updateHorizon=function(t,e){var r=this.ComVelocity.vgx,o=this.ComVelocity.vx;this.timex[t]+=e,this.timex[t]>2&&(r[t]=0,o[t]=0)},e.__cname="SubStateBrick",i([l.injectField("ComState")],e.prototype,"ComState",void 0),i([l.injectField("ComVar")],e.prototype,"ComVar",void 0),i([l.injectField("ComCollision")],e.prototype,"ComCollision",void 0),i([l.injectField("SystemMove")],e.prototype,"SystemMove",void 0),i([l.injectField("SystemMap")],e.prototype,"SystemMap",void 0),e}(t("./BaseBulletSubState").BaseBulletSubState);r.SubStateBrick=s,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"./BaseBulletSubState":"BaseBulletSubState"}],SubStateChargeLeave:[function(t,e,r){"use strict";cc._RF.push(e,"c2afcJtxvlPlaO2QEsHiVoO","SubStateChargeLeave");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.SubStateChargeLeave=void 0;var l,s=t("../../../../../../../framework/container/Container"),c=t("../../../../../../../framework/coord/Coord"),u=t("../../../../../../../framework/Func"),p=t("../../../view/nodeproxy/NodeProxy"),f=t("../SubState");(function(t){t[t.Idle=0]="Idle",t[t.Run=1]="Run",t[t.Leave=2]="Leave",t[t.Destroy=3]="Destroy"})(l||(l={}));var h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state=[],e.time=[],e}return n(e,t),e.prototype.getParam=function(){return this.ComState.param},e.prototype.onEnter=function(t){this.ComPrefab.ChangeModel(t,null,p.INodeProxyAni.Walk),this.switchIdle(t)},e.prototype.onExit=function(t){this.time[t]=null,this.state[t]=null},e.prototype.onUpdate=function(t){var e,r,o=this.state;try{for(var n=a(this.ids),i=n.next();!i.done;i=n.next()){var s=i.value;switch(o[s]){case l.Idle:this.updateIdle(t,s);break;case l.Run:this.updateRun(t,s);break;case l.Leave:this.updateLeave(t,s);break;case l.Destroy:}}}catch(c){e={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}},e.prototype.switchIdle=function(t){this.state[t]=l.Idle;var e=this.ComPos.x,r=this.ComPos.y,o=this.ComPos.d,n=this.ComVelocity.vx,i=this.ComVelocity.vy,a=this.ComVelocity.vgx,s=this.ComVelocity.vgy,c=this.ComVelocity.moving,u=(this.ComState,this.ComVar.MONSTER_COLLID),p=this.getParam()[t].target,f=this.Battle.ref2id(p);if(null!=f){var h=Math.atan2(r[f]-r[t],e[f]-e[t]);o[t]=h,n[t]=Math.cos(h),i[t]=Math.sin(h),a[t]=n[t],s[t]=i[t],c[t]=!0,u[t]=!1,this.time[t]=0}else this.switchDestory(t)},e.prototype.updateIdle=function(t,e){var r=this.ComPos.x,o=this.ComPos.y,n=this.ComVelocity.moving,i=this.time,a=this.SystemCamera.cameraBound,l=a.x,s=a.y,c=a.x+a.width,p=a.y+a.height;u.Func.isPointInRect2(l,s,c,p,r[e],o[e])?this.switchRun(e):(i[e]+=t,i[e]>5&&this.switchDestory(e),n[e]=!0)},e.prototype.switchRun=function(t){this.state[t]=l.Run,this.time[t]=0},e.prototype.updateRun=function(t,e){var r=this.ComPos.x,o=this.ComPos.y,n=this.ComVelocity.moving,i=this.ComVelocity.speed,a=this.time;a[e]+=t;var l=!1;if(i[e]>0&&i[e]*a[e]>c.Coord.logicSize.height&&(l=!0),l){var s=this.SystemCamera.cameraBound,p=s.x,f=s.y,h=s.x+s.width,y=s.y+s.height;if(0==u.Func.isPointInRect2(p,f,h,y,r[e],o[e]))return void this.switchLeave(e)}l&&this.GetIsMapBound(e,t)?this.switchLeave(e):n[e]=!0},e.prototype.switchLeave=function(t){this.state[t]=l.Leave,this.time[t]=0},e.prototype.updateLeave=function(t,e){var r=this.time;r[e]+=t,r[e]>2&&this.switchDestory(e)},e.prototype.switchDestory=function(t){var e=this.ComState;this.state[t]=l.Destroy,e.SwitchDestroy(t)},e.__cname="SubStateChargeLeave",i([s.injectField("ComState")],e.prototype,"ComState",void 0),i([s.injectField("Battle")],e.prototype,"Battle",void 0),i([s.injectField("ComPrefab")],e.prototype,"ComPrefab",void 0),i([s.injectField("ComVar")],e.prototype,"ComVar",void 0),i([s.injectField("SystemMove")],e.prototype,"SystemMove",void 0),i([s.injectField("ComPos")],e.prototype,"ComPos",void 0),e}(f.SubState);r.SubStateChargeLeave=h,cc._RF.pop()},{"../../../../../../../framework/Func":void 0,"../../../../../../../framework/container/Container":void 0,"../../../../../../../framework/coord/Coord":void 0,"../../../view/nodeproxy/NodeProxy":"NodeProxy","../SubState":"SubState"}],SubStateCharge:[function(t,e,r){"use strict";cc._RF.push(e,"8d792bwFaxA1JoPXucQ0F7o","SubStateCharge");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.SubStateCharge=void 0;var l,s=t("../../../../../../../framework/container/Container"),c=t("../../../../../../../framework/pool/Pool"),u=t("../../../../../../../framework/tween/TweenEase"),p=t("../../../../utils/PorcessTimeline"),f=t("../../../view/effect/SubSysEffectWarning"),h=t("../../../view/nodeproxy/NodeProxy"),y=t("../SubState"),d=.4,m=.7*d;(function(t){t[t.Idle=0]="Idle",t[t.Timeline=1]="Timeline",t[t.Search=2]="Search"})(l||(l={}));var v=function(t){function e(){var e=t.call(this)||this;return e.runState=[],e.cd=[],e.timeline=[],e._candidate=[],e.pool=new c.Pool(function(){return new p.PorcessTimeline},function(t){t.destroy()},function(t,r){var o=e.ComPrefab.model,n=e.getParam(),i=e.Battle.ref2id(n[r].target),a=e.ComPos.x,l=e.ComPos.y,s=e.ComPos.d,c=e.ComVelocity.moving,p=e.ComVelocity.speed,y=e.ComVelocity.basespeed,v=e.ComCollision.r,_=cc.game.getFrameRate(),S=y[r],g=.2,b=e.SystemView.GetNodeProxy(r);if(b){var C=b.GetAnimationDruation(h.INodeProxyAni.Conjure);C>0&&(g=C)}var R=(g=Math.max(g,d))*_,M=60/_*S*3;t.addEvent(0,"ready",function(){var t=Math.max(0,m);e.processMoveTo(r,i,t);var o=e.ComPrefab.model[r];e.ComPrefab.ChangeModel(r,o,h.INodeProxyAni.Conjure);var n={type:f.EEffectWarnningType.Square,x:a[r],y:l[r],target:null,direction:s[r],lineWidth:2*v[r],min:50,max:M,duration:g};e.SystemViewEffect.AddEffectWarning(n),c[r]=!1}),t.addEvent(R,"charge",function(){e.ComPrefab.ChangeModel(r,o[r],h.INodeProxyAni.Walk)}),t.addKeyframe(R,60,function(t,e){var o=u.TweenEase.Linear(t,2.8,3,e);p[r]=S*o,c[r]=!0}),t.addKeyframe(R+60+1,12,function(){e.ComPrefab.ChangeModel(r,o[r],h.INodeProxyAni.Idle),p[r]=S,c[r]=!1}),t.addEvent(R+60+14,"end",function(){e.ComPrefab.ChangeModel(r,o[r],h.INodeProxyAni.Walk),c[r]=!0})},function(t){return t.stop(),t.clear(),!0}),e}return n(e,t),e.prototype.getParam=function(){return this.ComState.param},e.prototype.onDestroy=function(){this.pool.returnAllToPool(),this.pool.destroy(),t.prototype.onDestroy.call(this)},e.prototype.onEnter=function(t){this.resumeCD(t),this.switchState(t,l.Idle)},e.prototype.onExit=function(t){this.cd[t]=null},e.prototype.onUpdate=function(t){var e,r,o=this.Battle,n=this.getParam();try{for(var i=a(this.ids),l=i.next();!l.done;l=i.next()){var s=l.value;if(null==o.ref2id(n[s].target))return void this.sitchSearch(s);this.updateState(t,s)}}catch(c){e={error:c}}finally{try{l&&!l.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}},e.prototype.updateCD=function(t,e){var r=this.cd[e];r&&(r-=t,r=Math.max(0,r),this.cd[e]=r)},e.prototype.checkCD=function(t){return this.cd[t]<=0},e.prototype.resumeCD=function(t){this.cd[t]=5},e.prototype.updateState=function(t,e){switch(this.runState[e]){case l.Timeline:this.updateTimeline(t,e);break;case l.Idle:this.updateCD(t,e),this.updateSeek(e);break;case l.Search:this.updateSearch(e,t)}},e.prototype.switchState=function(t,e){this.runState[t]=e},e.prototype.updateSeek=function(t){this.ComState;var e=this.ComPos.x,r=this.ComPos.y,o=(this.ComVelocity.vx,this.ComVelocity.vy,this.ComVelocity.vgx,this.ComVelocity.vgy,this.ComPos.d,this.ComVelocity.moving),n=this.Battle,i=this.getParam(),a=(i[t].stop,i[t].distance),s=n.ref2id(i[t].target),c=e[s]-e[t],u=r[s]-r[t];if(c*c+u*u<=a*a&&this.checkCD(t))return this.resumeCD(t),void this.switchState(t,l.Timeline);this.processBeHit(t)||(this.processMoveTo(t,s),o[t]=!0)},e.prototype.updateTimeline=function(t,e){var r=this.timeline[e],o=this.ComVar.BEHIT_DURATION;if(null==r&&((r=this.pool.getFromPool(e)).start(),this.timeline[e]=r),o[e]>0&&r.stop(),r.isStop())return this.pool.returnToPool(r),this.switchState(e,l.Idle),this.resumeCD(e),void(this.timeline[e]=null);r.update(t)},e.prototype.sitchSearch=function(t){this.runState[t]=l.Search,this._searchtime[t]=1},e.prototype.updateSearch=function(t,e){(this._searchtime[t]+=e)>1&&(this._searchtime[t]=0,this.onSearch(t)&&this.switchState(t,l.Idle))},e.prototype.onSearch=function(t){var e=this.ComPos.x,r=this.ComPos.y,o=this.ComVar.REACTION,n=this.ComVar.CAMP,i=(this.ComVar.ALIVE,this.ComVar.SHOOT_TARGET),a=this._candidate;return a.length=0,this.SystemMove.findOtherCampNoBullet(n[t],e[t],r[t],o[t],a),a.length>0&&(i[t]=a[0],!0)},e.__cname="SubStateCharge",i([s.injectField("ComState")],e.prototype,"ComState",void 0),i([s.injectField("Battle")],e.prototype,"Battle",void 0),i([s.injectField("ComPrefab")],e.prototype,"ComPrefab",void 0),i([s.injectField("ComVar")],e.prototype,"ComVar",void 0),i([s.injectField("SystemMove")],e.prototype,"SystemMove",void 0),i([s.injectField("ComPos")],e.prototype,"ComPos",void 0),i([s.injectField("SystemViewEffect")],e.prototype,"SystemViewEffect",void 0),i([s.injectField("SystemView")],e.prototype,"SystemView",void 0),e}(y.SubState);r.SubStateCharge=v,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../../../../../../framework/pool/Pool":void 0,"../../../../../../../framework/tween/TweenEase":void 0,"../../../../utils/PorcessTimeline":"PorcessTimeline","../../../view/effect/SubSysEffectWarning":"SubSysEffectWarning","../../../view/nodeproxy/NodeProxy":"NodeProxy","../SubState":"SubState"}],SubStateConjure:[function(t,e,r){"use strict";cc._RF.push(e,"8a7c8+2umNJhp9VrbA4xREy","SubStateConjure");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.SubStateConjure=void 0;var l=t("../../../../../../../framework/container/Container"),s=t("../../../view/nodeproxy/NodeProxy"),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.time=[],e.isResume=[],e}return n(e,t),e.prototype.onEnter=function(t){var e=this.ComState.param;this.isResume[t]=e[t].isresume,this.SwitchEnter(t)},e.prototype.onExit=function(t){this.time[t]=null},e.prototype.onUpdate=function(t){var e,r,o=this.time;try{for(var n=a(this.ids),i=n.next();!i.done;i=n.next()){var l=i.value;o[l]-=t,o[l]<0&&this.SwitchExit(l)}}catch(s){e={error:s}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}},e.prototype.SwitchEnter=function(t){var e=this.time;this.ComVelocity.moving[t]=!1;var r=this.ComPrefab.model[t];this.ComPrefab.ChangeModel(t,r,s.INodeProxyAni.Conjure);var o=1,n=this.SystemView.GetNodeProxy(t);if(n){var i=n.GetAnimationDruation(s.INodeProxyAni.Conjure);i>0&&(o=i)}e[t]=o},e.prototype.SwitchExit=function(t){if(this.time[t]=null,this.isResume[t])this.ComState.ResumeLastState(t);else{var e=this.Battle.getRef(t);this.ComState.SwitchIdle(e)}},e.__cname="SubStateConjure",i([l.injectField("ComPrefab")],e.prototype,"ComPrefab",void 0),i([l.injectField("SystemView")],e.prototype,"SystemView",void 0),i([l.injectField("ComState")],e.prototype,"ComState",void 0),i([l.injectField("Battle")],e.prototype,"Battle",void 0),e}(t("../SubState").SubState);r.SubStateConjure=c,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../../view/nodeproxy/NodeProxy":"NodeProxy","../SubState":"SubState"}],SubStateCrossBow:[function(t,e,r){"use strict";cc._RF.push(e,"4051fk5mRBJOYTnLPz+iudO","SubStateCrossBow");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.SubStateCrossBow=void 0;var l=t("../../../../../../../framework/container/Container"),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._scriptParam=[],e.candidate=[],e}return n(e,t),e.prototype.getParam=function(){return this.ComState.param},e.prototype.getScriptParam=function(t){if(null==this._scriptParam[t]){var e=this.ComVar.BULLET_SCRIPT_PARAMS;this._scriptParam[t]={is_first_double:"1"==e[t][0]}}return this._scriptParam[t]},e.prototype.onEnter=function(t){this.getParam();var e=this.getScriptParam(t),r=this.ComVar.BULLET_ATTR_FIRST_HIT;this.ComVelocity.moving[t]=!0,e.is_first_double&&(r[t]=!0)},e.prototype.onExit=function(t){this.ComVelocity.vx[t]=0,this.ComVelocity.vy[t]=0,this.ComVelocity.vgx[t]=0,this.ComVelocity.vgy[t]=0,this.ComVelocity.moving[t]=!1},e.prototype.onUpdate=function(t){var e,r,o=this.ComState,n=this.getParam(),i=this.ComPos.d,l=this.ComVelocity.vx,s=this.ComVelocity.vy,c=this.ComVelocity.moving,u=this.ComVar.BULLET_LIFETIME;try{for(var p=a(this.ids),f=p.next();!f.done;f=p.next()){var h=f.value;this.GetIsMapBound(h,t)?o.SwitchDestroy(h):null!=n[h]&&(u[h]-=t,u[h]<=0?o.SwitchDestroy(h):(i[h]=Math.atan2(s[h],l[h]),c[h]=!0))}}catch(y){e={error:y}}finally{try{f&&!f.done&&(r=p.return)&&r.call(p)}finally{if(e)throw e.error}}},e.__cname="SubStateCrossBow",i([l.injectField("ComState")],e.prototype,"ComState",void 0),i([l.injectField("ComVar")],e.prototype,"ComVar",void 0),i([l.injectField("ComCollision")],e.prototype,"ComCollision",void 0),i([l.injectField("SystemMove")],e.prototype,"SystemMove",void 0),i([l.injectField("CtrlAudio")],e.prototype,"CtrlAudio",void 0),i([l.injectField("Battle")],e.prototype,"Battle",void 0),e}(t("./BaseBulletSubState").BaseBulletSubState);r.SubStateCrossBow=s,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"./BaseBulletSubState":"BaseBulletSubState"}],SubStateDartSuperRed:[function(t,e,r){"use strict";cc._RF.push(e,"981b67WM3BKV4Ynq/OC4GZq","SubStateDartSuperRed");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.SubStateDartSuperRed=void 0;var l=t("../../../../../../../framework/container/Container"),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._scriptParam=[],e._splite=[],e}return n(e,t),e.prototype.getParam=function(){return this.ComState.param},e.prototype.getScriptParam=function(t){if(null==this._scriptParam[t]){var e=this.ComVar.BULLET_SCRIPT_PARAMS[t];this._scriptParam[t]={splitNum:null!=e[0]?parseInt(e[0]):null,bullet:null!=e[1]?parseInt(e[1]):null}}return this._scriptParam[t]},e.prototype.onEnter=function(t){this.getParam(),this.ComVelocity.moving[t]=!0,this._splite[t]=!1},e.prototype.onExit=function(t){this.HandlerSplite(t),this.ComVelocity.vx[t]=0,this.ComVelocity.vy[t]=0,this.ComVelocity.vgx[t]=0,this.ComVelocity.vgy[t]=0,this.ComVelocity.moving[t]=!1,this._splite[t]=null},e.prototype.onUpdate=function(t){var e,r,o=this.getParam(),n=this.ComPos.d,i=this.ComVelocity.vx,l=this.ComVelocity.vy,s=this.ComVelocity.moving,c=this.ComVar.BULLET_LIFETIME;try{for(var u=a(this.ids),p=u.next();!p.done;p=u.next()){var f=p.value;this.GetIsMapBound(f,t)?this.HandlerDestroy(f):null!=o[f]&&(c[f]-=t,c[f]<=0?this.HandlerDestroy(f):(n[f]=Math.atan2(l[f],i[f]),s[f]=!0))}}catch(h){e={error:h}}finally{try{p&&!p.done&&(r=u.return)&&r.call(u)}finally{if(e)throw e.error}}},e.prototype.HandlerDestroy=function(t){this.HandlerSplite(t),this.ComState.SwitchDestroy(t)},e.prototype.HandlerSplite=function(t){if(0==this._splite[t]){this._splite[t]=!0;var e=this.getScriptParam(t),r=this.ComVar.BULLET_BUILDER,o=this.ComVar.BULLET_SENDER;if(e.splitNum&&r[t])for(var n=e.splitNum,i=e.bullet,a=0;a<n;a++)this.SkillHandlerDart.Shoot_red(o[t],t,i,r[t])}},e.__cname="SubStateDartSuperRed",i([l.injectField("ComState")],e.prototype,"ComState",void 0),i([l.injectField("ComVar")],e.prototype,"ComVar",void 0),i([l.injectField("ComCollision")],e.prototype,"ComCollision",void 0),i([l.injectField("SystemMove")],e.prototype,"SystemMove",void 0),i([l.injectField("SkillHandlerDart")],e.prototype,"SkillHandlerDart",void 0),i([l.injectField("CtrlAudio")],e.prototype,"CtrlAudio",void 0),i([l.injectField("Battle")],e.prototype,"Battle",void 0),e}(t("./BaseBulletSubState").BaseBulletSubState);r.SubStateDartSuperRed=s,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"./BaseBulletSubState":"BaseBulletSubState"}],SubStateDart:[function(t,e,r){"use strict";cc._RF.push(e,"37d226oKhFD3qWOpxFLnmkv","SubStateDart");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.SubStateDart=void 0;var l=t("../../../../../../../framework/container/Container"),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.time=[],e._scriptParam=[],e.isSplit=[],e.candidate=[],e._vec1=new cc.Vec2,e._vec2=new cc.Vec2,e._vec3=new cc.Vec2,e}return n(e,t),e.prototype.getParam=function(){return this.ComState.param},e.prototype.getScriptParam=function(t){if(null==this._scriptParam[t]){var e=this.ComVar.BULLET_SCRIPT_PARAMS[t];this._scriptParam[t]={turnspeed:parseInt(e[0]),splitNum:null!=e[1]?parseInt(e[1]):null,bullet:null!=e[2]?parseInt(e[2]):null}}return this._scriptParam[t]},e.prototype.onEnter=function(t){this.getParam(),this.ComVelocity.moving[t]=!0,this.isSplit[t]=!1,this.time[t]=0},e.prototype.onExit=function(t){this.HandlerSplit(t),this.ComVelocity.vx[t]=0,this.ComVelocity.vy[t]=0,this.ComVelocity.vgx[t]=0,this.ComVelocity.vgy[t]=0,this.ComVelocity.moving[t]=!1,this._scriptParam[t]=null,this.time[t]=null,this.isSplit[t]=null},e.prototype.onUpdate=function(t){var e,r,o=this.getParam(),n=this.ComPos.x,i=this.ComPos.y,l=this.ComPos.d,s=this.ComVelocity.vx,c=this.ComVelocity.vy,u=this.ComVar.ALIVE,p=this.ComVar.SHOOT_TARGET,f=this.Battle,h=this.ComVelocity.moving,y=this.ComVar.BULLET_LIFETIME;try{for(var d=a(this.ids),m=d.next();!m.done;m=d.next()){var v=m.value,_=this.time;if(this.GetIsMapBound(v,t))this.HandlerDestroy(v);else if(null!=o[v])if(y[v]-=t,y[v]<=0)this.HandlerDestroy(v);else{_[v]+=t;var S=p[f.ref2id(o[v].sender)];S&&u[S]&&this.UpdateMoveXY(v,t,n[S],i[S]),l[v]=Math.atan2(c[v],s[v]),h[v]=!0}}}catch(g){e={error:g}}finally{try{m&&!m.done&&(r=d.return)&&r.call(d)}finally{if(e)throw e.error}}},e.prototype.UpdateMoveXY=function(t,e,r,o){this.time;var n=this.ComPos.x,i=this.ComPos.y,a=this.ComPos.d,l=this.ComVelocity.vx,s=this.ComVelocity.vy,c=this.ComVelocity.vgx,u=this.ComVelocity.vgy,p=this.getParam(),f=(this.Battle.ref2id(p[t].sender),this._vec1),h=this._vec2,y=this._vec3;f.x=n[t],f.y=i[t],h.x=r,h.y=o;var d=f.cross(h),m=f.dot(h);if(!(0==d&&m>=0)){f.x=l[t],f.y=s[t],h.x=r-n[t],h.y=o-i[t],f.normalizeSelf(),h.normalizeSelf();var v=6*e;f.lerp(h,v,y),a[t]=Math.atan2(y.y,y.x),l[t]=y.x,s[t]=y.y,c[t]=l[t],u[t]=s[t]}},e.prototype.HandlerDestroy=function(t){this.HandlerSplit(t),this.ComState.SwitchDestroy(t)},e.prototype.HandlerSplit=function(t){0==this.isSplit[t]&&(this.isSplit[t]=!0);var e=this.getScriptParam(t),r=this.ComVar.BULLET_BUILDER,o=this.ComVar.BULLET_SENDER;if(e.splitNum&&r[t])for(var n=e.splitNum,i=e.bullet,a=this.ComVar.SHOOT_TARGET,l=0;l<n;l++)this.SkillHandlerDart.Shoot(o[t],t,i,r[t],a[t])},e.__cname="SubStateDart",i([l.injectField("ComState")],e.prototype,"ComState",void 0),i([l.injectField("ComVar")],e.prototype,"ComVar",void 0),i([l.injectField("ComCollision")],e.prototype,"ComCollision",void 0),i([l.injectField("SystemMove")],e.prototype,"SystemMove",void 0),i([l.injectField("SkillHandlerDart")],e.prototype,"SkillHandlerDart",void 0),i([l.injectField("CtrlAudio")],e.prototype,"CtrlAudio",void 0),i([l.injectField("Battle")],e.prototype,"Battle",void 0),e}(t("./BaseBulletSubState").BaseBulletSubState);r.SubStateDart=s,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"./BaseBulletSubState":"BaseBulletSubState"}],SubStateDestroy:[function(t,e,r){"use strict";cc._RF.push(e,"c01665Yn0xKAYF9MxS4UhGK","SubStateDestroy");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.SubStateDestroy=void 0;var s=t("../../../../../../../framework/container/Container"),c=t("../../../../../../../framework/tween/TweenEase"),u=t("../../../view/nodeproxy/NodeProxy"),p=t("../../type/ComType"),f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tmDie=new Map,e.tmHit2Die=new Map,e}return n(e,t),e.prototype.onDestroy=function(){var t,e;try{for(var r=a(this.tmDie),o=r.next();!o.done;o=r.next()){var n=l(o.value,2),i=n[0];n[1],this.SystemRole.DestroyRole(i)}}catch(s){t={error:s}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},e.prototype.onEnter=function(t){this.ComState.locked[t]=!0;var e=this.ComType.GetType(t);e==p.EComType.Monster?(this.ComVelocity.moving[t]=!1,this.ComVar.BEHIT_DURATION[t]>0?this.switchHitToDie(t):this.switchDie(t)):e==p.EComType.PropBox?this.switchDie(t):(this.ComVar.ALIVE[t]=!1,this.ComVar.DESTROY[t]=!0,this.SystemRole.DestroyRole(t))},e.prototype.onExit=function(){},e.prototype.onUpdate=function(t){this.UpdateDie(t),this.UpdateHit2Die(t)},e.prototype.switchDie=function(t){this.ComVelocity.vx[t]=0,this.ComVelocity.vy[t]=0,this.ComVelocity.vgx[t]=0,this.ComVelocity.vgy[t]=0,this.ComVelocity.moving[t]=!1,this.ComVar.ALIVE[t]=!1,this.ComVar.DESTROY[t]=!0,this.ComPrefab.ChangeModel(t,this.ComPrefab.model[t],u.INodeProxyAni.Die),this.tmDie.set(t,.5)},e.prototype.UpdateDie=function(t){var e,r,o=this.tmDie;try{for(var n=a(o),i=n.next();!i.done;i=n.next()){var s=l(i.value,2),c=s[0],u=s[1];(u-=t)>0?o.set(c,u):(o.delete(c),this.SystemRole.DestroyRole(c))}}catch(p){e={error:p}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}},e.prototype.switchHitToDie=function(t){this.ComVar.ALIVE[t]=!1,this.ComVar.DESTROY[t]=!0,this.ComPrefab.ChangeModel(t,this.ComPrefab.model[t],u.INodeProxyAni.Die),this.ComCollision.activeCollision[t]=!1;var e=Math.max(.5,this.ComVar.BEHIT_DURATION[t]);this.tmHit2Die.set(t,e)},e.prototype.UpdateHit2Die=function(t){var e,r,o=this.tmHit2Die,n=this.ComVelocity.moving;try{for(var i=a(o),s=i.next();!s.done;s=i.next()){var c=l(s.value,2),u=c[0],p=c[1];(p-=t)>0?(n[u]=!0,this.processBeHit(u),o.set(u,p)):(o.delete(u),n[u]=!1,this.SystemRole.DestroyRole(u))}}catch(f){e={error:f}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}},e.prototype.updateBehitView=function(t){var e=this.ComVar.BEHIT_DURATION,r=this.ComVar.BEHIT_TIME,o=(this.ComVar.BE_HIT_LIST,this.ComVar.BEHIT_SENDER,this.ComPrefab),n=.5*e[t],i=e[t]-n;if(r[t]>n){var a=c.TweenEase.Linear(r[t]-n,1,-1,i);o.ChangeModel(t,o.model[t],u.INodeProxyAni.Die,a)}},e.__cname="SubStateDestroy",i([s.injectField("SystemRole")],e.prototype,"SystemRole",void 0),i([s.injectField("ComVar")],e.prototype,"ComVar",void 0),i([s.injectField("ComPrefab")],e.prototype,"ComPrefab",void 0),i([s.injectField("ComType")],e.prototype,"ComType",void 0),i([s.injectField("ComPos")],e.prototype,"ComPos",void 0),i([s.injectField("ComVelocity")],e.prototype,"ComVelocity",void 0),i([s.injectField("ComState")],e.prototype,"ComState",void 0),e}(t("../SubState").SubState);r.SubStateDestroy=f,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../../../../../../framework/tween/TweenEase":void 0,"../../../view/nodeproxy/NodeProxy":"NodeProxy","../../type/ComType":"ComType","../SubState":"SubState"}],SubStateDie:[function(t,e,r){"use strict";cc._RF.push(e,"f8349HCgwdGoZv3F1+UDykd","SubStateDie");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.SubStateDie=void 0;var a=t("../../../../../../../framework/container/Container"),l=t("../../../view/nodeproxy/NodeProxy"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.onEnter=function(t){var e=this.ComPrefab.model;this.ComPrefab.ChangeModel(t,e[t],l.INodeProxyAni.Die)},e.prototype.onUpdate=function(){},e.prototype.onExit=function(){},e.__cname="SubStateDie",i([a.injectField("ComPrefab")],e.prototype,"ComPrefab",void 0),e}(t("../SubState").SubState);r.SubStateDie=s,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../../view/nodeproxy/NodeProxy":"NodeProxy","../SubState":"SubState"}],SubStateDrillSuper:[function(t,e,r){"use strict";cc._RF.push(e,"879dbgUO+pF0ZhBkToAj3/U","SubStateDrillSuper");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.SubStateDrillSuper=void 0;var l,s=t("../../../../../../../framework/container/Container"),c=t("./BaseBulletSubState");(function(t){t[t.Idle=0]="Idle",t[t.Move=1]="Move"})(l||(l={}));var u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._scriptParam=[],e.time=[],e.state=[],e.searchtime=[],e.searchtarget=[],e._vec1=new cc.Vec2,e._vec2=new cc.Vec2,e._vec3=new cc.Vec2,e._candidate=[],e}return n(e,t),e.prototype.getParam=function(){return this.ComState.param},e.prototype.getScriptParam=function(t){if(null==this._scriptParam[t]){var e=this.ComVar.BULLET_SCRIPT_PARAMS[t];this._scriptParam[t]={turnspeed:parseInt(e[0])}}return this._scriptParam[t]},e.prototype.onEnter=function(t){this.getParam(),this.ComVelocity.moving[t]=!0,this.time[t]=0,this.searchtime[t]=0,this.SwitchIdle(t)},e.prototype.onExit=function(t){this.ComVelocity.vx[t]=0,this.ComVelocity.vy[t]=0,this.ComVelocity.vgx[t]=0,this.ComVelocity.vgy[t]=0,this.ComVelocity.moving[t]=!1,this._scriptParam[t]=null,this.time[t]=null,this.state[t]=null,this.searchtime[t]=null,this.searchtarget[t]=null},e.prototype.onUpdate=function(t){var e,r;try{for(var o=a(this.ids),n=o.next();!n.done;n=o.next()){var i=n.value;switch(this.state[i]){case l.Idle:this.UpdateIdle(i,t);break;case l.Move:this.UpdateMove(i,t)}}}catch(s){e={error:s}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}},e.prototype.SwitchIdle=function(t){var e=this.ComVelocity.moving;this.state[t]=l.Idle,this.time[t]=0,this.searchtarget[t]=null,this.searchtime[t]=0,e[t]=!0},e.prototype.UpdateIdle=function(t,e){var r=this.time,o=(this.getScriptParam(t),this.ComPos.x),n=this.ComPos.y,i=(this.ComPos.d,this.ComVelocity.speed),a=this.getParam(),l=this.Battle.ref2id(a[t].sender);if(null!=l){r[t]+=e;var s=360/(600*Math.PI/i[t])*r[t]%360/360*2*Math.PI,c=o[l]+300*Math.cos(s),u=n[l]+300*Math.sin(s);this.UpdateMoveXY(t,e,c,u),this.UpdateSearch(t,e)}},e.prototype.SwitchMove=function(t){var e=this.ComVelocity.vx,r=this.ComVelocity.vy,o=this.ComVelocity.vgx,n=this.ComVelocity.vgy,i=this.ComPos.d;this.state[t]=l.Move,this.time[t]=0,e[t]=Math.cos(i[t]),r[t]=Math.sin(i[t]),o[t]=e[t],n[t]=r[t]},e.prototype.UpdateMove=function(t,e){for(var r=this.ComPos.x,o=this.ComPos.y,n=this.ComVar.ALIVE;;){var i=this.searchtarget[t];if(null==i)break;if(0==n[i])break;if(this.GetIsScreenBound(t,e))break;if(this.GetIsMapBound(t,e))break;var a=r[i],l=o[i];return void this.UpdateMoveXY(t,e,a,l)}this.SwitchIdle(t),this.UpdateIdle(t,e)},e.prototype.UpdateMoveXY=function(t,e,r,o){this.time,this.getScriptParam(t);var n=this.ComPos.x,i=this.ComPos.y,a=this.ComPos.d,l=this.ComVelocity.vx,s=this.ComVelocity.vy,c=this.ComVelocity.vgx,u=this.ComVelocity.vgy,p=this.getParam(),f=(this.Battle.ref2id(p[t].sender),this._vec1),h=this._vec2,y=this._vec3;f.x=n[t],f.y=i[t],h.x=r,h.y=o;var d=f.cross(h),m=f.dot(h);0==d&&m>=0||(f.x=l[t],f.y=s[t],h.x=r-n[t],h.y=o-i[t],f.normalizeSelf(),h.normalizeSelf(),f.lerp(h,.1,y),a[t]=Math.atan2(y.y,y.x),l[t]=y.x,s[t]=y.y,c[t]=l[t],u[t]=s[t])},e.prototype.UpdateSearch=function(t,e){var r=this.searchtime,o=this.searchtarget;if(r[t]+=e,!(r[t]<.5)){r[t]=0,this.ComPos.x,this.ComPos.y,this.ComVar.REACTION,this.ComVar.CAMP;var n=this.ComVar.ALIVE,i=(this.ComVar.HP,this.getParam()),a=this.Battle.ref2id(i[t].sender),l=this.ComVar.SHOOT_TARGET[a];l&&n[l]&&(o[t]=l,this.SwitchMove(t))}},e.__cname="SubStateDrillSuper",i([s.injectField("ComState")],e.prototype,"ComState",void 0),i([s.injectField("ComVar")],e.prototype,"ComVar",void 0),i([s.injectField("ComCollision")],e.prototype,"ComCollision",void 0),i([s.injectField("ComType")],e.prototype,"ComType",void 0),i([s.injectField("SystemMove")],e.prototype,"SystemMove",void 0),i([s.injectField("CtrlAudio")],e.prototype,"CtrlAudio",void 0),i([s.injectField("Battle")],e.prototype,"Battle",void 0),e}(c.BaseBulletSubState);r.SubStateDrillSuper=u,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"./BaseBulletSubState":"BaseBulletSubState"}],SubStateDrill:[function(t,e,r){"use strict";cc._RF.push(e,"6970cTyYYlHN62NTOAvOrxi","SubStateDrill");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.SubStateDrill=void 0;var s,c=t("../../../../../../../framework/container/Container"),u=t("../../../../../../../framework/Func"),p=t("../../../../../../../framework/FW"),f=t("./BaseBulletSubState");(function(t){t[t.Move=0]="Move",t[t.Truning=1]="Truning"})(s||(s={}));var h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.time=[],e.count=[],e.v_n=[],e.v_in=[],e.bound=[],e.state=[],e.tvx=[],e.tvy=[],e.mybound=new cc.Rect,e}return n(e,t),e.prototype.getParam=function(){return this.ComState.param},e.prototype.onEnter=function(t){var e=this.ComVelocity.vx,r=this.ComVelocity.vy;this.count[t]=0,this.time[t]=0,this.v_n[t]=new cc.Vec2,this.v_in[t]=new cc.Vec2,this.bound[t]=new cc.Rect,this.tvx[t]=e[t],this.tvy[t]=r[t],this.processTward(t),this.SwitchMove(t)},e.prototype.onExit=function(t){this.count[t]=null,this.time[t]=null,this.v_n[t]=null,this.v_in[t]=null,this.bound[t]=null},e.prototype.onUpdate=function(t){var e,r;try{for(var o=a(this.ids),n=o.next();!n.done;n=o.next()){var i=n.value;switch(this.state[i]){case s.Move:this.UpdateStateMove(i,t);break;case s.Truning:this.UpdateStateTurning(i,t)}}}catch(l){e={error:l}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}},e.prototype.GetCustomBound=function(){var t=cc.director.getTotalFrames(),e=!1;this.lastframe!=t&&(e=!0,this.lastframe=t);var r=this.mybound;if(e){var o=this.GetMapBound(),n=this.GetScreenBound(),i=o.x,a=o.y,s=o.x+o.width,c=o.y+o.height,p=n.x,f=n.y,h=n.x+n.width,y=n.y+n.height,d=l(u.Func.crossRectOfTwoRects(i,a,s,c,p,f,h,y),5),m=d[0],v=d[1],_=d[2],S=d[3],g=d[4];m?(r.x=v,r.y=_,r.width=S-v,r.height=g-_):r.set(o)}return r},e.prototype.reboundWall=function(t,e){var r=this.ComPos.x,o=this.ComPos.y,n=this.ComVelocity.vx,i=this.ComVelocity.vy,a=(this.ComVelocity.vgx,this.ComVelocity.vgy,this.ComPos.d,this.ComVelocity.moving,this.v_n[t]),l=this.v_in[t];l.x=n[t],l.y=i[t],l.normalizeSelf();var s,c=Math.atan2(l.y,l.x)/Math.PI*180,u=r[t]-e.x,f=e.y+e.height-o[t],h=e.x+e.width-r[t],y=o[t]-e.y;switch(Math.min(u,f,h,y)){case u:a.x=1,a.y=0;break;case f:a.x=0,a.y=-1;break;case h:a.x=-1,a.y=0;break;case y:a.x=0,a.y=1}var d=l.dot(a);s=0==d?l.add(a.sub(l).mul(.3)):d<0?l.sub(a.mul(2*l.dot(a))):l.add(a.mul(2*l.dot(a))),(Math.abs(s.y)<=.1||Math.abs(s.x)<=.1)&&(s.x=(Math.sign(s.x)||1)*Math.max(.1,Math.abs(s.x)),s.y=(Math.sign(s.y)||1)*Math.max(.1,Math.abs(s.y)));var m=Math.atan2(s.y,s.x),v=m/Math.PI*180;p.FW.ZJJ.log("\u53cd\u5f39\u7ed3\u679c\uff1a"+c+", "+v),this.tvx[t]=Math.cos(m),this.tvy[t]=Math.sin(m)},e.prototype.processTward=function(t){var e=this.ComVelocity.vx,r=this.ComVelocity.vy,o=this.ComPos.d;o[t]=o[t]=Math.atan2(r[t],e[t])},e.prototype.checkTruning=function(t,e){var r=this.ComPos.x,o=this.ComPos.y,n=this.tvx,i=this.tvy,a=this.ComVelocity.speed,l=this.ComCollision.r,s=r[t],c=o[t],p=1*n[t]*e*a[t],f=1*i[t]*e*a[t];p+=Math.sign(p)*l[t],f+=Math.sign(f)*l[t];var h=this.GetCustomBound();return 0==u.Func.isPointInRect({x:h.x,y:h.y},{x:h.x+h.width,y:h.y},{x:h.x+h.width,y:h.y+h.height},{x:h.x,y:h.y+h.height},{x:s+p,y:c+f})},e.prototype.SwitchMove=function(t){var e=this.ComPos.d,r=this.ComVelocity.vx,o=this.ComVelocity.vy;this.state[t]=s.Move,e[t]=Math.atan2(o[t],r[t])},e.prototype.UpdateStateMove=function(t,e){var r=this.ComState,o=(this.bound,this.ComVelocity.moving),n=this.ComVar.BULLET_LIFETIME,i=this.ComVar.BULLET_REBOUND,a=this.count;-1!=i[t]&&a[t]>=i[t]?r.SwitchDestroy(t):(n[t]-=e,n[t]<=0?r.SwitchDestroy(t):this.checkTruning(t,e)?this.SwitchTurning(t,e):o[t]=!0)},e.prototype.SwitchTurning=function(t,e){this.ComState,this.bound,this.ComVelocity.moving,this.ComVar.BULLET_LIFETIME,this.ComVar.BULLET_REBOUND;var r=this.count;this.state[t]=s.Truning,this.checkTruning(t,e)&&(this.processRebound(t),r[t]++)},e.prototype.processRebound=function(t){var e=this.bound;e[t].set(this.GetCustomBound()),this.reboundWall(t,e[t])},e.prototype.UpdateStateTurning=function(t,e){var r=this.ComState,o=(this.bound,this.ComVelocity.moving,this.ComVar.BULLET_LIFETIME),n=this.ComVar.BULLET_REBOUND,i=this.ComVelocity.vx,a=this.ComVelocity.vy,l=this.tvx,s=this.tvy,c=this.ComPos.d,u=(this.getParam(),this.count);if(this.time,-1!=n[t]&&u[t]>=n[t])r.SwitchDestroy(t);else if(o[t]-=e,o[t]<=0)r.SwitchDestroy(t);else{this.checkTruning(t,e)&&this.processRebound(t);var p=Math.abs(i[t]-l[t]),f=Math.abs(a[t]-s[t]);if(p<=1e-4||f<=1e-4)return i[t]=l[t],a[t]=s[t],void this.SwitchMove(t);i[t]=cc.misc.lerp(i[t],l[t],.2),a[t]=cc.misc.lerp(a[t],s[t],.2),c[t]=Math.atan2(a[t],i[t])}},e.__cname="SubStateDrill",i([c.injectField("ComState")],e.prototype,"ComState",void 0),i([c.injectField("ComVar")],e.prototype,"ComVar",void 0),i([c.injectField("ComCollision")],e.prototype,"ComCollision",void 0),i([c.injectField("SystemMove")],e.prototype,"SystemMove",void 0),e}(f.BaseBulletSubState);r.SubStateDrill=h,cc._RF.pop()},{"../../../../../../../framework/FW":void 0,"../../../../../../../framework/Func":void 0,"../../../../../../../framework/container/Container":void 0,"./BaseBulletSubState":"BaseBulletSubState"}],SubStateDurian:[function(t,e,r){"use strict";cc._RF.push(e,"817e7Xu0StEFZnz5P3Jqp39","SubStateDurian");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.SubStateDurian=void 0;var l=t("../../../../../../../framework/container/Container"),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.time=[],e.count=[],e.v_n=[],e.v_in=[],e.bound=[],e}return n(e,t),e.prototype.getParam=function(){return this.ComState.param},e.prototype.onEnter=function(t){this.count[t]=0,this.time[t]=0,this.v_n[t]=new cc.Vec2,this.v_in[t]=new cc.Vec2,this.bound[t]=new cc.Rect},e.prototype.onExit=function(t){this.count[t]=null,this.time[t]=null,this.v_n[t]=null,this.v_in[t]=null,this.bound[t]=null},e.prototype.onUpdate=function(t){this.ComState;var e,r,o=this.bound,n=this.ComVelocity.moving,i=this.getParam();this.count,this.time;try{for(var l=a(this.ids),s=l.next();!s.done;s=l.next()){var c=s.value;if(null!=i[c]){var u=this.GetScreenBound();if(this.CheckIsBound(c,1*t,u))return o[c].set(u),void this.reboundWall(c,o[c]);if(u=this.GetMapBound(),this.CheckIsBound(c,1*t,u))return o[c].set(u),void this.reboundWall(c,o[c]);var p=this.ComVar,f=p.CalHeroAttr("s7064",0);if(f>0){var h=this.ComPos.x[p.HEROID],y=this.ComPos.y[p.HEROID],d=h-f/2,m=y-f/2;if(u=new cc.Rect(d,m,f,f),this.CheckIsBound(c,1*t,u))return o[c].set(u),void this.reboundWall(c,o[c])}n[c]=!0}}}catch(v){e={error:v}}finally{try{s&&!s.done&&(r=l.return)&&r.call(l)}finally{if(e)throw e.error}}},e.prototype.reboundWall=function(t,e){var r=this.ComPos.x,o=this.ComPos.y,n=this.ComVelocity.vx,i=this.ComVelocity.vy,a=this.ComVelocity.vgx,l=this.ComVelocity.vgy,s=this.ComPos.d,c=this.ComVelocity.moving,u=this.v_n[t],p=this.v_in[t];p.x=n[t],p.y=i[t],p.normalizeSelf();var f,h=r[t]-e.x,y=e.y+e.height-o[t],d=e.x+e.width-r[t],m=o[t]-e.y;switch(Math.min(h,y,d,m)){case h:u.x=1,u.y=0;break;case y:u.x=0,u.y=-1;break;case d:u.x=-1,u.y=0;break;case m:u.x=0,u.y=1}var v=p.dot(u);f=0==v?p.add(u.sub(p).mul(.3)):v<0?p.sub(u.mul(2*p.dot(u))):p.add(u.mul(2*p.dot(u))),(Math.abs(f.y)<=.1||Math.abs(f.x)<=.1)&&(f.x=(Math.sign(f.x)||1)*Math.max(.1,Math.abs(f.x)),f.y=(Math.sign(f.y)||1)*Math.max(.1,Math.abs(f.y)));var _=Math.atan2(f.y,f.x);n[t]=Math.cos(_),i[t]=Math.sin(_),a[t]=Math.cos(_),l[t]=Math.sin(_),s[t]=s[t]=Math.atan2(l[t],a[t]),c[t]=!0},e.__cname="SubStateDurian",i([l.injectField("ComState")],e.prototype,"ComState",void 0),i([l.injectField("ComVar")],e.prototype,"ComVar",void 0),i([l.injectField("ComCollision")],e.prototype,"ComCollision",void 0),i([l.injectField("SystemMove")],e.prototype,"SystemMove",void 0),e}(t("./BaseBulletSubState").BaseBulletSubState);r.SubStateDurian=s,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"./BaseBulletSubState":"BaseBulletSubState"}],SubStateFieldSlow:[function(t,e,r){"use strict";cc._RF.push(e,"0c3866RBjlCio0HkXtDHlCF","SubStateFieldSlow");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.SubStateFieldSlow=void 0;var l=t("../../../../../../../framework/container/Container"),s=t("../../../../../../../framework/utils/Toolset"),c=t("../../event/SystemEvent"),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.time=[],e.takeCollid=new Map,e.toolSet=s.ToolSet.createToolSet(),e._tmListener=new Map,e}return n(e,t),e.prototype.onDestroy=function(){s.ToolSet.destroyToolSet(this.toolSet)},e.prototype.onEnter=function(t){this.time[t]=0,this.ListenOnCollid(t)},e.prototype.onExit=function(t){this.time[t]=null,this.UnListenOnCollid(t)},e.prototype.onUpdate=function(t){var e,r,o=this.time,n=this.ComVar.BULLET_LIFETIME,i=this.ComBuffCarrier,l=this.ComVar.BULLET_SENDER;try{for(var s=a(this.ids),c=s.next();!c.done;c=s.next()){var u=c.value;if(o[u]+=t,o[u]>=n[u])this.ComState.SwitchDestroy(u);else{if(this.takeCollid.has(u)){var p=this.takeCollid.get(u);p&&i.DoSlow(l[u],p),this.takeCollid.delete(u)}this.followHero(u)}}}catch(f){e={error:f}}finally{try{c&&!c.done&&(r=s.return)&&r.call(s)}finally{if(e)throw e.error}}},e.prototype.followHero=function(t){var e=this.ComVar.HEROID;this.ComPos.x[t]=this.ComPos.x[e],this.ComPos.y[t]=this.ComPos.y[e]+5},e.prototype.ListenOnCollid=function(t){var e=this,r=this.SystemEvent.GetEventPorxy(),o=this._tmListener;o.has(t)&&this.UnListenOnCollid(t);var n=this.toolSet.addListener(r,c.EBattleEvent.BulletCollid,function(r,o){r==t&&e.OnCollid(r,o)});o.set(t,n)},e.prototype.UnListenOnCollid=function(t){var e=this._tmListener;if(e.has(t)){var r=e.get(t);this.toolSet.removeListener(r),e.delete(t)}},e.prototype.OnCollid=function(t,e){this.takeCollid.set(t,e)},e.__cname="SubStateFieldSlow",i([l.injectField("ComState")],e.prototype,"ComState",void 0),i([l.injectField("SystemEvent")],e.prototype,"SystemEvent",void 0),i([l.injectField("ComBuffCarrier")],e.prototype,"ComBuffCarrier",void 0),e}(t("./BaseBulletSubState").BaseBulletSubState);r.SubStateFieldSlow=u,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../../../../../../framework/utils/Toolset":void 0,"../../event/SystemEvent":"SystemEvent","./BaseBulletSubState":"BaseBulletSubState"}],SubStateField:[function(t,e,r){"use strict";cc._RF.push(e,"816dblxqR5EY5rd9ckYx21o","SubStateField");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.SubStateField=void 0;var l=t("../../../../../../../framework/container/Container"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getParam=function(){return this.ComState.param},e.prototype.onEnter=function(){},e.prototype.onExit=function(){},e.prototype.onUpdate=function(){this.ComPos;var t,e,r=this.ComPos.x,o=this.ComPos.y,n=this.getParam();try{for(var i=a(this.ids),l=i.next();!l.done;l=i.next()){var s=l.value,c=0;n[s]&&n[s].sender&&(c=this.Battle.ref2id(n[s].sender)),r[s]=r[c],o[s]=o[c]}}catch(u){t={error:u}}finally{try{l&&!l.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}},e.__cname="SubStateField",i([l.injectField("ComState")],e.prototype,"ComState",void 0),i([l.injectField("Battle")],e.prototype,"Battle",void 0),i([l.injectField("ComPrefab")],e.prototype,"ComPrefab",void 0),e}(t("./BaseBulletSubState").BaseBulletSubState);r.SubStateField=s,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"./BaseBulletSubState":"BaseBulletSubState"}],SubStateFollow:[function(t,e,r){"use strict";cc._RF.push(e,"41d2cITirJIvLgLtOnVeZdy","SubStateFollow");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.SubStateFollow=void 0;var l=t("../../../../../../../framework/container/Container"),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.time=[],e}return n(e,t),e.prototype.onEnter=function(t){this.time[t]=0},e.prototype.onExit=function(t){this.time[t]=null},e.prototype.getParam=function(){return this.ComState.param},e.prototype.onUpdate=function(t){var e,r,o=this.time,n=this.ComVar.BULLET_LIFETIME,i=this.ComPos.d,l=this.ComPos.x,s=this.ComPos.y;try{for(var c=a(this.ids),u=c.next();!u.done;u=c.next()){var p=u.value;if(o[p]+=t,this.Battle.startConfig.isVulcan=!0,o[p]>=n[p])this.ComState.SwitchDestroy(p),this.Battle.startConfig.isVulcan=!1;else{var f=this.getParam()[p].sender,h=this.Battle.ref2id(f);l[p]=l[h]+100*Math.cos(i[h]),s[p]=s[h]+100*Math.sin(i[h]),i[p]=i[h]}}}catch(y){e={error:y}}finally{try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(e)throw e.error}}},e.__cname="SubStateFollow",i([l.injectField("ComState")],e.prototype,"ComState",void 0),i([l.injectField("Battle")],e.prototype,"Battle",void 0),e}(t("./BaseBulletSubState").BaseBulletSubState);r.SubStateFollow=s,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"./BaseBulletSubState":"BaseBulletSubState"}],SubStateFootball:[function(t,e,r){"use strict";cc._RF.push(e,"9604bbCtPpF76x+PaLCsCLX","SubStateFootball");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.SubStateFootball=void 0;var l=t("../../../../../../../framework/container/Container"),s=t("../../../../../../../framework/utils/Toolset"),c=t("../../var/ComVar"),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.time=[],e.count=[],e.v_n=[],e.v_in=[],e.bound=[],e.takedamage=new Map,e.toolSet=s.ToolSet.createToolSet(),e._tmListener=new Map,e}return n(e,t),e.prototype.onDestroy=function(){s.ToolSet.destroyToolSet(this.toolSet)},e.prototype.getParam=function(){return this.ComState.param},e.prototype.onEnter=function(t){this.getParam(),this.ComVelocity,this.ListenTakedamage(t),this.count[t]=0,this.time[t]=0,this.v_n[t]=new cc.Vec2,this.v_in[t]=new cc.Vec2,this.bound[t]=new cc.Rect},e.prototype.onExit=function(t){this.UnListenTakeDamage(t),this.takedamage.delete(t),this.count[t]=null,this.time[t]=null,this.v_n[t]=null,this.v_in[t]=null,this.bound[t]=null},e.prototype.onUpdate=function(t){var e,r,o=this.ComState,n=this.bound,i=this.ComVelocity.moving,l=this.ComVar.BULLET_LIFETIME,s=this.ComVar.BULLET_REBOUND,c=this.count;try{for(var u=a(this.ids),p=u.next();!p.done;p=u.next()){var f=p.value;if(-1!=s[f]&&c[f]>=s[f])o.SwitchDestroy(f);else if(l[f]-=t,l[f]<=0)o.SwitchDestroy(f);else{var h=this.GetMapBound();if(this.CheckIsBound(f,1*t,h)&&(n[f].set(h),this.reboundWall(f,n[f]),this.GPAudio.hit(),c[f]++),h=this.GetScreenBound(),this.CheckIsBound(f,1*t,h))return n[f].set(h),this.reboundWall(f,n[f]),this.GPAudio.hit(),void c[f]++;if(this.takedamage.has(f)){var y=this.takedamage.get(f);y&&(c[f]++,this.reboundCollision(f,y)),this.takedamage.delete(f)}i[f]=!0}}}catch(d){e={error:d}}finally{try{p&&!p.done&&(r=u.return)&&r.call(u)}finally{if(e)throw e.error}}},e.prototype.findNearCollision=function(t){var e,r,o,n=this.ComCollision.collisons,i=this.ComPos.x,l=this.ComPos.y;if(this.ComVar.ALIVE,n[t]){var s=Number.MAX_SAFE_INTEGER;try{for(var c=a(n[t]),u=c.next();!u.done;u=c.next()){var p=u.value,f=(i[p]-i[t])*(i[p]-i[t])+(l[p]-l[t])*(l[p]-l[t]);f<s&&(o=p,s=f)}}catch(h){e={error:h}}finally{try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(e)throw e.error}}}return o},e.prototype.reboundCollision=function(t,e){var r=this.ComPos.x,o=this.ComPos.y,n=this.ComPos.d,i=this.ComVelocity.vx,a=this.ComVelocity.vy,l=this.ComVelocity.vgx,s=this.ComVelocity.vgy,c=this.ComVelocity.moving,u=this.v_n[t],p=this.v_in[t];p.x=i[t],p.y=a[t];var f=r[e]-r[t],h=o[e]-o[t],y=Math.atan2(h,f);f>=0?y+=.5*Math.PI:y-=.5*Math.PI,u.x=Math.cos(y),u.y=Math.sin(y);var d=p.sub(u.mul(2*p.dot(u))),m=Math.atan2(d.y,d.x);i[t]=Math.cos(m),a[t]=Math.sin(m),l[t]=Math.cos(m),s[t]=Math.sin(m),n[t]=Math.atan2(s[t],l[t]),c[t]=!0},e.prototype.reboundWall=function(t,e){var r=this.ComPos.x,o=this.ComPos.y,n=this.ComVelocity.vx,i=this.ComVelocity.vy,a=this.ComVelocity.vgx,l=this.ComVelocity.vgy,s=this.ComPos.d,c=this.ComVelocity.moving,u=this.v_n[t],p=this.v_in[t];p.x=n[t],p.y=i[t],p.normalizeSelf();var f,h=r[t]-e.x,y=e.y+e.height-o[t],d=e.x+e.width-r[t],m=o[t]-e.y;switch(Math.min(h,y,d,m)){case h:u.x=1,u.y=0;break;case y:u.x=0,u.y=-1;break;case d:u.x=-1,u.y=0;break;case m:u.x=0,u.y=1}var v=p.dot(u);f=0==v?p.add(u.sub(p).mul(.3)):v<0?p.sub(u.mul(2*p.dot(u))):p.add(u.mul(2*p.dot(u))),(Math.abs(f.y)<=.1||Math.abs(f.x)<=.1)&&(f.x=(Math.sign(f.x)||1)*Math.max(.1,Math.abs(f.x)),f.y=(Math.sign(f.y)||1)*Math.max(.1,Math.abs(f.y)));var _=Math.atan2(f.y,f.x);n[t]=Math.cos(_),i[t]=Math.sin(_),a[t]=Math.cos(_),l[t]=Math.sin(_),s[t]=s[t]=Math.atan2(l[t],a[t]),c[t]=!0},e.prototype.ListenTakedamage=function(t){var e=this,r=this.ComVar.GetEventProxy(),o=this._tmListener;o.has(t)&&this.UnListenTakeDamage(t);var n=this.toolSet.addListener(r,c.EComEvent.TakeDamage,function(r,o){r==t&&e.OnTakeDamage(r,o)});o.set(t,n)},e.prototype.UnListenTakeDamage=function(t){var e=this._tmListener;if(e.has(t)){var r=e.get(t);this.toolSet.removeListener(r),e.delete(t)}},e.prototype.OnTakeDamage=function(t,e){this.takedamage.set(t,e)},e.__cname="SubStateFootball",i([l.injectField("Battle")],e.prototype,"Battle",void 0),i([l.injectField("ComState")],e.prototype,"ComState",void 0),i([l.injectField("ComCollision")],e.prototype,"ComCollision",void 0),i([l.injectField("SystemMap")],e.prototype,"SystemMap",void 0),i([l.injectField("GPAudio")],e.prototype,"GPAudio",void 0),e}(t("./BaseBulletSubState").BaseBulletSubState);r.SubStateFootball=u,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../../../../../../framework/utils/Toolset":void 0,"../../var/ComVar":"ComVar","./BaseBulletSubState":"BaseBulletSubState"}],SubStateGuarder:[function(t,e,r){"use strict";cc._RF.push(e,"2549bRtyuhBdY4GTBgX5PFQ","SubStateGuarder");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.SubStateGuarder=void 0;var l=t("../../../../../../../framework/container/Container"),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.time=[],e.offset=0,e.offsetState=1,e}return n(e,t),e.prototype.getParam=function(){return this.ComState.param},e.prototype.onEnter=function(t){this.time[t]=0,this.offset=0,this.offsetState=1},e.prototype.onExit=function(t){this.time[t]=null},e.prototype.onUpdate=function(t){var e,r,o=this.ComState,n=this.ComPos.x,i=this.ComPos.y,l=this.ComPos.d,s=this.ComVelocity.speed,c=this.ComVar.BULLET_LIFETIME,u=this.getParam(),p=this.time,f=this.ComVar.BULLET_SENDER,h=this.ComVar.ALIVE,y=null;try{for(var d=a(this.ids),m=d.next();!m.done;m=d.next()){var v=m.value;if(u[v]&&u[v].sender&&h[v]){y=v;var _=this.Battle.ref2id(u[v].sender);if(p[v]+=t,c[v]-=t,c[v]<=0)o.SwitchDestroy(v);else if(null!=f[v]&&h[f[v]]){var S=u[v].r,g=s[v]*p[v]/(2*Math.PI*S),b=u[v].startangle+g*Math.PI;n[v]=n[_]+(S+this.offset)*Math.cos(b),i[v]=i[_]+(S+this.offset)*Math.sin(b),l[v]=b}else o.SwitchDestroy(v)}else o.SwitchDestroy(v)}}catch(R){e={error:R}}finally{try{m&&!m.done&&(r=d.return)&&r.call(d)}finally{if(e)throw e.error}}var C=this.ComVar.CalHeroAttr("s7146",0);0!=C&&10030==this.ComVar.BULLET_SKILL[y]&&(this.offset+=1*this.offsetState,this.offset>C?this.offsetState=-1:this.offset<=0&&(this.offsetState=1))},e.__cname="SubStateGuarder",i([l.injectField("ComState")],e.prototype,"ComState",void 0),i([l.injectField("ComVelocity")],e.prototype,"ComVelocity",void 0),i([l.injectField("Battle")],e.prototype,"Battle",void 0),e}(t("./BaseBulletSubState").BaseBulletSubState);r.SubStateGuarder=s,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"./BaseBulletSubState":"BaseBulletSubState"}],SubStateIdle:[function(t,e,r){"use strict";cc._RF.push(e,"f3d17rfIpNOZ7LZ4Sl7xDEE","SubStateIdle");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.SubStateIdle=void 0;var a=t("../../../../../../../framework/container/Container"),l=t("../../../view/nodeproxy/NodeProxy"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.onEnter=function(t){this.ComVelocity.moving[t]=!1,this.ComPrefab.ChangeModel(t,null,l.INodeProxyAni.Idle)},e.prototype.onExit=function(){},e.prototype.onUpdate=function(){},e.__cname="SubStateIdle",i([a.injectField("ComPrefab")],e.prototype,"ComPrefab",void 0),e}(t("../SubState").SubState);r.SubStateIdle=s,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../../view/nodeproxy/NodeProxy":"NodeProxy","../SubState":"SubState"}],SubStateKeep:[function(t,e,r){"use strict";cc._RF.push(e,"50d2cp6w1tIHKGPFqmqaovi","SubStateKeep");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.SubStateKeep=void 0;var l=t("../../../../../../../framework/container/Container"),s=t("../../../view/nodeproxy/NodeProxy"),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.runState=[],e.wandertime=[],e}return n(e,t),e.prototype.getParam=function(){return this.ComState.param},e.prototype.onEnter=function(t){this.ComPrefab.ChangeModel(t,null,s.INodeProxyAni.Walk),this.resumeWanderTime(t),this.switchState(t,0)},e.prototype.onExit=function(t){this.runState[t]=null,this.wandertime[t]=null},e.prototype.onUpdate=function(t){var e,r;try{for(var o=a(this.ids),n=o.next();!n.done;n=o.next()){var i=n.value;this.updateState(t,i)}}catch(l){e={error:l}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}},e.prototype.switchState=function(t,e){this.runState[t]=e,1==e&&this.onSwitchWander(t)},e.prototype.updateState=function(t,e){switch(this.runState[e]){case 1:this.updateWanderTime(t,e),this.updateStateWander(t,e);break;case 0:default:this.updateStateSeek(t,e)}},e.prototype.updateStateSeek=function(t,e){var r,o=this.ComVelocity.moving,n=this.Battle,i=this.getParam();if(i&&i[e]){var a=n.ref2id(null===(r=i[e])||void 0===r?void 0:r.target);this.checkArrived(e)?this.switchState(e,1):(this.processMoveTo(e,a),o[e]=!0)}},e.prototype.checkArrived=function(t){var e=this.ComPos.x,r=this.ComPos.y,o=this.getParam(),n=this.Battle.ref2id(o[t].target),i=o[t].distance,a=e[n]-e[t],l=r[n]-r[t];return a*a+l*l<=i*i},e.prototype.updateWanderTime=function(t,e){var r=this.wandertime[e];r&&(r-=t,r=Math.max(r,0),this.wandertime[e]=r)},e.prototype.resumeWanderTime=function(t){this.wandertime[t]=.5},e.prototype.checkWanderTime=function(t){return this.wandertime[t]<=0},e.prototype.onSwitchWander=function(t){this.resumeWanderTime(t);var e=this.ComPos.x,r=this.ComPos.y,o=this.ComVelocity.vgx,n=this.ComVelocity.vgy,i=this.ComPos.d,a=this.getParam(),l=this.Battle.ref2id(a[t].target),s=e[l]-e[t],c=r[l]-r[t],u=Math.atan2(c,s),p=Math.random()-.5,f=u+Math.PI/2*Math.sign(p)-5*Math.abs(p);o[t]=Math.cos(f),n[t]=Math.sin(f),i[t]=u},e.prototype.updateStateWander=function(t,e){var r=this.ComVelocity.moving;if(!this.processBeHit(e))return this.checkWanderTime(e)?(this.resumeWanderTime(e),void(this.checkArrived(e)?this.switchState(e,1):this.switchState(e,0))):void(r[e]=!0)},e.__cname="SubStateKeep",i([l.injectField("ComState")],e.prototype,"ComState",void 0),i([l.injectField("ComVar")],e.prototype,"ComVar",void 0),i([l.injectField("Battle")],e.prototype,"Battle",void 0),i([l.injectField("ComPrefab")],e.prototype,"ComPrefab",void 0),e}(t("../SubState").SubState);r.SubStateKeep=c,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../../view/nodeproxy/NodeProxy":"NodeProxy","../SubState":"SubState"}],SubStateLightningSuper:[function(t,e,r){"use strict";cc._RF.push(e,"11e431pPLNAl4aaK+HSOSJH","SubStateLightningSuper");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.SubStateLightningSuper=void 0;var a=t("../../../../../../../framework/fork/Fork"),l=t("./SubStateLightning"),s=function(){function t(){this.DURATION_IDLE=1/12*1,this.DURATION_DAMAGE=1/12*10,this.DURATION_EXIT=1/12*4}return t.__cname="ConstData",t}(),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}var r;return n(e,t),r=e,e.prototype.OnGetConstData=function(){return s},e.__cname="SubStateLightningSuper",i([a.forkClass(r,null)],e)}(l.SubStateLightning);r.SubStateLightningSuper=c,cc._RF.pop()},{"../../../../../../../framework/fork/Fork":void 0,"./SubStateLightning":"SubStateLightning"}],SubStateLightning:[function(t,e,r){"use strict";cc._RF.push(e,"3b4a07X9otFgo368nu1pTCG","SubStateLightning");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.SubStateLightning=void 0;var l,s=t("../../../../../../../framework/container/Container"),c=t("../../../../../../../framework/fork/Fork"),u=t("./BaseBulletSubState");(function(t){t[t.Idle=0]="Idle",t[t.Damage=1]="Damage",t[t.Exit=2]="Exit"})(l||(l={}));var p=function(){function t(){this.DURATION_IDLE=.25,this.DURATION_DAMAGE=1/12*8,this.DURATION_EXIT=0}return t.__cname="ConstData",t}(),f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._time=[],e._state=[],e}var r;return n(e,t),r=e,Object.defineProperty(e.prototype,"ConstData",{get:function(){if(this._ConstData)return this._ConstData;var t=this.OnGetConstData();return this._ConstData=new t,this._ConstData},enumerable:!1,configurable:!0}),e.prototype.OnGetConstData=function(){return p},e.prototype.getParam=function(){return this.ComState.param},e.prototype.onEnter=function(t){this.SwitchIdle(t)},e.prototype.onExit=function(t){this._time[t]=null},e.prototype.onUpdate=function(t){var e,r;try{for(var o=a(this.ids),n=o.next();!n.done;n=o.next()){var i=n.value;switch(this._state[i]){case l.Idle:this.UpdateSateIdle(i,t);break;case l.Damage:this.UpdateStateDamage(i,t);break;case l.Exit:this.UpdateStateExit(i,t)}}}catch(s){e={error:s}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}},e.prototype.SwitchIdle=function(t){this._state[t]=l.Idle,this._time[t]=0,this.ComCollision.SetActive(t,!1)},e.prototype.UpdateSateIdle=function(t,e){var r=this.getParam(),o=this.ComPos.x,n=this.ComPos.y;if(this._time[t]+=e,this._time[t]>=this.ConstData.DURATION_IDLE&&this.SwitchDamage(t),r[t].target){var i=this.Battle.ref2id(r[t].target);i&&(o[t]=cc.misc.lerp(o[t],o[i],.3),n[t]=cc.misc.lerp(n[t],n[i],.3))}},e.prototype.SwitchDamage=function(t){this._state[t]=l.Damage,this._time[t]=0,this.ComCollision.SetActive(t,!0)},e.prototype.UpdateStateDamage=function(t,e){var r=this.getParam(),o=this.ComPos.x,n=this.ComPos.y;if(this._time[t]+=e,this._time[t]>=this.ConstData.DURATION_DAMAGE)this.SwitchExit(t);else if(r[t].target){var i=this.Battle.ref2id(r[t].target);i&&(o[t]=cc.misc.lerp(o[t],o[i],.3),n[t]=cc.misc.lerp(n[t],n[i],.3))}},e.prototype.SwitchExit=function(t){this._state[t]=l.Exit,this._time[t]=0,this.ComCollision.SetActive(t,!1),this.UpdateStateExit(t,0)},e.prototype.UpdateStateExit=function(t,e){this._time[t]+=e,this._time[t]>=this.ConstData.DURATION_DAMAGE&&this.ComState.SwitchDestroy(t)},e.__cname="SubStateLightning",i([s.injectField("ComState")],e.prototype,"ComState",void 0),i([s.injectField("Battle")],e.prototype,"Battle",void 0),i([s.injectField("ComCollision")],e.prototype,"ComCollision",void 0),i([c.forkClass(r,null)],e)}(u.BaseBulletSubState);r.SubStateLightning=f,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../../../../../../framework/fork/Fork":void 0,"./BaseBulletSubState":"BaseBulletSubState"}],SubStateMissile:[function(t,e,r){"use strict";cc._RF.push(e,"ecb41TXfqRHpIk1cH7vpXtX","SubStateMissile");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.SubStateMissile=void 0;var l,s=t("../../../../../../../framework/container/Container"),c=t("../../../view/nodeproxy/NodeProxy"),u=t("./BaseBulletSubState");(function(t){t[t.Move=0]="Move",t[t.Boom=1]="Boom"})(l||(l={}));var p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.time=[],e.state=[],e.isPenerateToBoom=[],e._scriptParam=[],e}return n(e,t),e.prototype.getParam=function(){return this.ComState.param},e.prototype.getScriptParam=function(t){if(null==this._scriptParam[t]){var e=this.ComVar.BULLET_SCRIPT_PARAMS[t];this._scriptParam[t]={model:e[0],range:parseInt(e[1])||0,boomTime:(parseInt(e[2])||1e3)/1e3,collisionTime:(parseInt(e[3])||300)/1e3}}return this._scriptParam[t]},e.prototype.onEnter=function(t){var e=this.ComVar.PENETRATE;this.time[t]=0,e[t]>0&&(this.isPenerateToBoom[t]=!0),this.ComVar.PENETRATE_DESTROY[t]=!1,this.switch_move(t)},e.prototype.onExit=function(t){this.time[t]=null,this.state[t]=null,this._scriptParam[t]=null},e.prototype.onUpdate=function(t){var e,r,o=this.time,n=this.state;try{for(var i=a(this.ids),s=i.next();!s.done;s=i.next()){var c=s.value;switch(o[c]+=t,n[c]){case l.Move:this.process_move(c,t);break;case l.Boom:this.process_boom(c,t)}}}catch(u){e={error:u}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}},e.prototype.switch_move=function(t){var e=this.getParam(),r=this.ComVelocity,o=this.ComPrefab.order;this.state[t]=l.Move,o[t]=c.NodeProxyOrder.Role;var n=e[t].degree/180*Math.PI;r.vx[t]=Math.cos(n),r.vy[t]=Math.sin(n),r.vgx[t]=Math.cos(n),r.vgy[t]=Math.sin(n),r.moving[t]=!0},e.prototype.process_move=function(t,e){var r=this.time,o=this.ComVelocity,n=this.ComPos.d,i=this.ComVelocity.vx,a=this.ComVelocity.vy,l=this.ComCollision.colliding,s=this.ComVar.BULLET_LIFETIME,c=this.ComVar.PENETRATE,u=this.isPenerateToBoom;if(r[t]>=s[t])this.switch_boom(t);else if(this.GetIsMapBound(t,e))this.switch_boom(t);else{if(u[t]){if(c[t]<=0)return void this.switch_boom(t)}else if(l[t])return void this.switch_boom(t);n[t]=Math.atan2(a[t],i[t]),o[t]=!0}},e.prototype.switch_boom=function(t){this.GPAudio.boom();var e=this.ComPrefab,r=this.ComVelocity.moving,o=this.ComPos.d,n=this.ComPrefab.order,i=this.getScriptParam(t).model||"\u767e\u604b_\u6280\u80fd_\u706b\u7075\u5492_\u547d\u4e2d";n[t]=c.NodeProxyOrder.EffectBack,o[t]=0,r[t]=!1,this.state[t]=l.Boom,this.time[t]=0,e.ChangeModel(t,i,c.INodeProxyAni.Idle)},e.prototype.process_boom=function(t,e){var r=this.ComState,o=this.getScriptParam(t),n=this.ComVar.BULLET_MODEL_PROTOTYPE_SIZE,i=o.range;this.time[t]+=e,this.time[t]>o.boomTime?r.SwitchDestroy(t):(this.time[t]>o.collisionTime&&(this.ComCollision.activeCollision[t]=!1),n[t]=cc.misc.lerp(.6*i,i,this.time[t]/o.boomTime))},e.__cname="SubStateMissile",i([s.injectField("Battle")],e.prototype,"Battle",void 0),i([s.injectField("ComState")],e.prototype,"ComState",void 0),i([s.injectField("ComPrefab")],e.prototype,"ComPrefab",void 0),i([s.injectField("ComCollision")],e.prototype,"ComCollision",void 0),i([s.injectField("GPAudio")],e.prototype,"GPAudio",void 0),e}(u.BaseBulletSubState);r.SubStateMissile=p,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../../view/nodeproxy/NodeProxy":"NodeProxy","./BaseBulletSubState":"BaseBulletSubState"}],SubStateMolotov:[function(t,e,r){"use strict";cc._RF.push(e,"6807aQiyxpJNYjZ9Eurm3Li","SubStateMolotov");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.SubStateMolotov=void 0;var l,s=t("../../../../../../../framework/container/Container"),c=t("../../../view/nodeproxy/NodeProxy"),u=t("./BaseBulletSubState");(function(t){t[t.Move=0]="Move",t[t.Ani=1]="Ani",t[t.Boom=2]="Boom"})(l||(l={}));var p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.time=[],e.state=[],e._scriptParam=[],e}return n(e,t),e.prototype.getParam=function(){return this.ComState.param},e.prototype.getScriptParam=function(t){if(null==this._scriptParam[t]){var e=this.ComVar.BULLET_SCRIPT_PARAMS[t];this._scriptParam[t]={model:e[0],flyTime:(parseInt(e[1])||0)/1e3,model2:e[2],time2:(parseInt(e[3])||0)/1e3}}return this._scriptParam[t]},e.prototype.onEnter=function(t){this.SwitchMove(t)},e.prototype.onExit=function(t){this.time[t]=null,this.state[t]=null,this._scriptParam[t]=null},e.prototype.onUpdate=function(t){var e,r;try{for(var o=a(this.ids),n=o.next();!n.done;n=o.next()){var i=n.value;switch(this.state[i]){case l.Move:this.UpdateStateMove(i,t);break;case l.Ani:this.UpdateStateAni(i,t);case l.Boom:this.UpdateStateBoom(i,t)}}}catch(s){e={error:s}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}},e.prototype.SwitchMove=function(t){this.state[t]=l.Move,this.time[t]=0,this.ComCollision.SetActive(t,!1)},e.prototype.UpdateStateMove=function(t,e){var r=this.getScriptParam(t),o=this.ComVelocity.moving;this.time[t]+=e,this.time[t]>=r.flyTime?this.NextState(t):o[t]=!0},e.prototype.NextState=function(t){var e=this.getScriptParam(t),r=this.ComPos.d;this.ComCollision.SetActive(t,!0),r[t]=0,e.model2?this.SwitchAni(t):this.SwitchBoom(t)},e.prototype.SwitchAni=function(t){var e=this.getScriptParam(t),r=this.ComCollision.r,o=this.ComVar.BULLET_MODEL_PROTOTYPE_SIZE,n=this.ComPrefab.order,i=this.ComVar.BULLET_REF,a=e.model2;this.state[t]=l.Ani,this.time[t]=0,n[t]=c.NodeProxyOrder.EffectBack;var s=i[t].GetPrototypeSizeBy(a),u=this.ComVar.CalBulletPrototypeSize(t,s),p=i[t].GetDamageRadiusBy(a),f=this.ComVar.CalBulletPrototypeSize(t,p);o[t]=s,r[t]=this.ComVar.CalAttr(t,"s7024",f),this.ComPrefab.ChangeModel(t,a,null,null,null,this.ComVar.CalAttr(t,"s7024",u))},e.prototype.UpdateStateAni=function(t,e){var r=this.getScriptParam(t),o=this.ComVelocity.moving;this.time[t]+=e,this.time[t]>r.time2?this.SwitchBoom(t):o[t]=!1},e.prototype.SwitchBoom=function(t){var e=this.getScriptParam(t).model,r=this.ComCollision.r,o=this.ComVar.BULLET_MODEL_PROTOTYPE_SIZE,n=(this.ComPos.d,this.ComPrefab.order),i=this.ComVar.BULLET_REF[t];this.state[t]=l.Boom,this.time[t]=0,n[t]=c.NodeProxyOrder.EffectBack;var a=i.GetPrototypeSizeBy(e),s=this.ComVar.CalBulletPrototypeSize(t,a),u=i.GetDamageRadiusBy(e),p=this.ComVar.CalBulletPrototypeSize(t,u);o[t]=this.ComVar.CalHeroAttr("s7024",a),r[t]=this.ComVar.CalHeroAttr("s7024",p),this.ComPrefab.ChangeModel(t,e,1,null,null,this.ComVar.CalHeroAttr("s7024",s))},e.prototype.UpdateStateBoom=function(t,e){this.getScriptParam(t);var r=this.ComVar.BULLET_EFFECT_TIME,o=this.ComVelocity.moving;this.time[t]+=e,this.time[t]>r[t]?this.ComState.SwitchDestroy(t):o[t]=!1},e.__cname="SubStateMolotov",i([s.injectField("Battle")],e.prototype,"Battle",void 0),i([s.injectField("ComState")],e.prototype,"ComState",void 0),i([s.injectField("ComPrefab")],e.prototype,"ComPrefab",void 0),i([s.injectField("ComCollision")],e.prototype,"ComCollision",void 0),i([s.injectField("GPAudio")],e.prototype,"GPAudio",void 0),i([s.injectField("ModelPrefab")],e.prototype,"ModelPrefab",void 0),e}(u.BaseBulletSubState);r.SubStateMolotov=p,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../../view/nodeproxy/NodeProxy":"NodeProxy","./BaseBulletSubState":"BaseBulletSubState"}],SubStateMove:[function(t,e,r){"use strict";cc._RF.push(e,"0ecc36f1mlJA7YJNN3isUjT","SubStateMove");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.SubStateMove=void 0;var l=t("../../../../../../../framework/container/Container"),s=t("../../../view/nodeproxy/NodeProxy"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.onEnter=function(t){var e=this.ComPos,r=this.ComVelocity,o=this.ComState.param,n=e.x[t],i=e.y[t],a=o[t].tx-n,l=o[t].ty-i,c=a*a+l*l;if(c>0){var u=Math.sqrt(c);a/=u,l/=u}r.vx[t]=a,r.vy[t]=l,r.moving[t]=!0,this.ComPrefab.ChangeModel(t,this.ComPrefab.model[t],s.INodeProxyAni.Walk)},e.prototype.onUpdate=function(){var t,e,r=this.ComPos.x,o=this.ComPos.y,n=(this.ComVelocity.vgx,this.ComVelocity.vgy,this.ComVelocity.vx),i=this.ComVelocity.vy,l=this.ComPos.d,s=this.Battle,c=this.ComState.param;try{for(var u=a(this.ids),p=u.next();!p.done;p=u.next()){var f=p.value,h=s.getRef(f);if(s.ref2id(h)){var y=c[f].tx,d=c[f].ty,m=c[f].stop,v=y-r[f],_=d-o[f];l[f]=Math.atan2(i[f],n[f]),v*v+_*_<m&&this.ComState.SwitchIdle(h)}}}catch(S){t={error:S}}finally{try{p&&!p.done&&(e=u.return)&&e.call(u)}finally{if(t)throw t.error}}},e.prototype.onExit=function(t){this.ComVelocity.vx[t]=0,this.ComVelocity.vy[t]=0,this.ComVelocity.moving[t]=!1},e.__cname="SubStateMove",i([l.injectField("ComState")],e.prototype,"ComState",void 0),i([l.injectField("ComPos")],e.prototype,"ComPos",void 0),i([l.injectField("ComVelocity")],e.prototype,"ComVelocity",void 0),i([l.injectField("ComPrefab")],e.prototype,"ComPrefab",void 0),i([l.injectField("Battle")],e.prototype,"Battle",void 0),e}(t("../SubState").SubState);r.SubStateMove=c,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../../view/nodeproxy/NodeProxy":"NodeProxy","../SubState":"SubState"}],SubStatePulses:[function(t,e,r){"use strict";cc._RF.push(e,"abdfcKyWihGD5aWqYsqnICI","SubStatePulses");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.SubStatePulses=void 0;var l=t("../../../../../../../framework/container/Container"),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._scriptParam=[],e.time=[],e}return n(e,t),e.prototype.getScriptParam=function(t){if(null==this._scriptParam[t]){var e=this.ComVar.BULLET_SCRIPT_PARAMS[t];this._scriptParam[t]={range:e[0]}}return this._scriptParam[t]},e.prototype.onEnter=function(t){this.time[t]=0},e.prototype.onExit=function(t){this.time[t]=null},e.prototype.onUpdate=function(t){var e,r,o=this.time,n=this.ComVar.BULLET_LIFETIME;try{for(var i=a(this.ids),l=i.next();!l.done;l=i.next()){var s=l.value;o[s]+=t,o[s]>=n[s]?this.ComState.SwitchDestroy(s):this.process_boom(s,t)}}catch(c){e={error:c}}finally{try{l&&!l.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}},e.prototype.process_boom=function(t,e){var r=this.getScriptParam(t),o=this.ComVar.BULLET_MODEL_PROTOTYPE_SIZE,n=this.ComVar.BULLET_LIFETIME,i=r.range;this.time[t]+=e,o[t]=cc.misc.lerp(.6*i,i,this.time[t]/n[t])},e.__cname="SubStatePulses",i([l.injectField("ComState")],e.prototype,"ComState",void 0),e}(t("./BaseBulletSubState").BaseBulletSubState);r.SubStatePulses=s,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"./BaseBulletSubState":"BaseBulletSubState"}],SubStateRadiation:[function(t,e,r){"use strict";cc._RF.push(e,"83f4cmJzS1I1ZV5Azw21ss0","SubStateRadiation");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.SubStateRadiation=void 0;var l=t("../../../../../../../framework/container/Container"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getParam=function(){return this.ComState.param},e.prototype.onEnter=function(){},e.prototype.onExit=function(){},e.prototype.onUpdate=function(){var t,e,r=this.ComPos.x,o=this.ComPos.y,n=this.getParam();try{for(var i=a(this.ids),l=i.next();!l.done;l=i.next()){var s=l.value,c=0;n[s]&&n[s].sender&&(c=this.Battle.ref2id(n[s].sender)),r[s]=r[c],o[s]=o[c]}}catch(u){t={error:u}}finally{try{l&&!l.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}},e.__cname="SubStateRadiation",i([l.injectField("ComState")],e.prototype,"ComState",void 0),i([l.injectField("Battle")],e.prototype,"Battle",void 0),i([l.injectField("ComPrefab")],e.prototype,"ComPrefab",void 0),e}(t("./BaseBulletSubState").BaseBulletSubState);r.SubStateRadiation=s,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"./BaseBulletSubState":"BaseBulletSubState"}],SubStateReborn:[function(t,e,r){"use strict";cc._RF.push(e,"466f5jyKrZDQ7k9OLSocUX3","SubStateReborn");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.SubStateReborn=void 0;var a=t("../../../../../../../framework/container/Container"),l=t("../../../view/nodeproxy/NodeProxy"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.onEnter=function(t){var e=this.ComPrefab.model;this.ComPrefab.ChangeModel(t,e[t],l.INodeProxyAni.Idle);var r=this.Battle.getRef(t);this.ComState.SwitchIdle(r)},e.prototype.onUpdate=function(){},e.prototype.onExit=function(){},e.__cname="SubStateReborn",i([a.injectField("ComPrefab")],e.prototype,"ComPrefab",void 0),i([a.injectField("ComState")],e.prototype,"ComState",void 0),i([a.injectField("Battle")],e.prototype,"Battle",void 0),e}(t("../SubState").SubState);r.SubStateReborn=s,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../../view/nodeproxy/NodeProxy":"NodeProxy","../SubState":"SubState"}],SubStateRobotBullet:[function(t,e,r){"use strict";cc._RF.push(e,"d8fc2Vt3gxHIqgcqS5KAFZv","SubStateRobotBullet");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.SubStateRobotBullet=void 0;var l,s=t("../../../../../../../framework/container/Container"),c=t("../../../../../../../framework/tween/TweenEase"),u=t("./BaseBulletSubState");(function(t){t[t.Move=0]="Move",t[t.Boom=1]="Boom"})(l||(l={}));var p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._state=[],e._time=[],e._svx=[],e._svy=[],e._sduration=[],e._srad=[],e._sign=[],e._scriptParam=[],e}return n(e,t),e.prototype.getParam=function(){return this.ComState.param},e.prototype.getScriptParam=function(t){if(null==this._scriptParam[t]){var e=this.ComVar.BULLET_SCRIPT_PARAMS;this._scriptParam[t]={targetModel:e[t][0],boomModel:e[t][1],boomDuration:(parseInt(e[t][2])||0)/1e3}}return this._scriptParam[t]},e.prototype.onEnter=function(t){this.SwitchMove(t)},e.prototype.onExit=function(t){this._state[t]=null,this._time[t]=null,this._scriptParam[t]=null},e.prototype.onUpdate=function(t){var e,r;try{for(var o=a(this.ids),n=o.next();!n.done;n=o.next()){var i=n.value;switch(this._state[i]){case l.Move:this.UpdateStateMove(i,t);break;case l.Boom:this.UpdateStateBoom(i,t)}}}catch(s){e={error:s}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}},e.prototype.SwitchMove=function(t){var e=this.ComVelocity.vx,r=this.ComVelocity.vy,o=this.ComVelocity.vgx,n=this.ComVelocity.vgy,i=this.ComPos.x,a=this.ComPos.y,s=this.ComCollision.activeCollision,c=this.getParam(),u=this.getScriptParam(t),p=c[t].x,f=c[t].y,h=this.ComVelocity.speed;this._state[t]=l.Move,this._time[t]=0,this._svx[t]=i[t],this._svy[t]=a[t];var y=p-i[t],d=f-a[t],m=Math.atan2(d,y),v=y/(h[t]*Math.cos(m)),_=d/(h[t]*Math.sin(m));this._sduration[t]=Math.max(v,_),this._srad[t]=m,this._sign[t]=Math.sign(Math.random()-.5),e[t]=0,r[t]=0,o[t]=0,n[t]=0,s[t]=!1,this.SystemViewEffect.AddEffectXY(u.targetModel,p,f)},e.prototype.UpdateStateMove=function(t,e){var r=this.ComPos.x,o=this.ComPos.y,n=this.ComPos.d,i=this.ComVelocity.moving,a=this._svx,l=this._svy,s=this._sduration,u=this._srad,p=this.ComVelocity.speed,f=this._sign[t];if(this._time[t]+=e,this._time[t]>s[t])this.SwitchBoom(t);else{var h=this._time[t],y=r[t],d=o[t],m=c.TweenEase.Quad.easeOut(h,.3,-.3,s[t])*Math.PI,v=u[t],_=p[t]*h,S=v+f*m;r[t]=a[t]+Math.cos(S)*_,o[t]=l[t]+Math.sin(S)*_,n[t]=Math.atan2(o[t]-d,r[t]-y),i[t]=!0}},e.prototype.SwitchBoom=function(t){var e=this.getScriptParam(t),r=this.ComCollision.activeCollision,o=this.ComPos.x,n=this.ComPos.y;this._state[t]=l.Boom,this._time[t]=0,r[t]=!0;var i=1;0!=this.ComVar.CalHeroAttr("s7116",0)&&10022==this.ComVar.BULLET_SKILL[t]&&(i=2),this.SystemViewEffect.AddEffectXY(e.boomModel,o[t],n[t],!1,!0,null,i)},e.prototype.UpdateStateBoom=function(t,e){var r=this.ComVelocity.moving,o=this.getScriptParam(t);this._time[t]+=e,this._time[t]>=o.boomDuration?this.ComState.SwitchDestroy(t):r[t]=!1},e.__cname="SubStateRobotBullet",i([s.injectField("ComState")],e.prototype,"ComState",void 0),i([s.injectField("ComCollision")],e.prototype,"ComCollision",void 0),i([s.injectField("SystemViewEffect")],e.prototype,"SystemViewEffect",void 0),e}(u.BaseBulletSubState);r.SubStateRobotBullet=p,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../../../../../../framework/tween/TweenEase":void 0,"./BaseBulletSubState":"BaseBulletSubState"}],SubStateSeek:[function(t,e,r){"use strict";cc._RF.push(e,"709f0/ZOkBAQKoErEqIJs4F","SubStateSeek");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.SubStateSeek=void 0;var l=t("../../../../../../../framework/container/Container"),s=t("../../../view/nodeproxy/NodeProxy"),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._count=5,e}return n(e,t),e.prototype.getParam=function(){return this.ComState.param},e.prototype.onEnter=function(t){this.ComPrefab.ChangeModel(t,null,s.INodeProxyAni.Walk)},e.prototype.onExit=function(){},e.prototype.onUpdate=function(){var t,e;if(this._count+=1,!(this._count<5)){this._count=0;var r=this.ComState,o=this.ComPos.x,n=this.ComPos.y,i=this.ComVelocity.moving,l=this.Battle,s=this.getParam();try{for(var c=a(this.ids),u=c.next();!u.done;u=c.next()){var p=u.value;if(s[p]&&s[p].stop){var f=s[p].stop,h=l.ref2id(s[p].target);if(null!=h){var y=o[h]-o[p],d=n[h]-n[p];if(y*y+d*d<f*f)i[p]=!1;else{if(this.processBeHit(p))return;this.processMoveTo(p,h),i[p]=!0}}else r.SwitchDestroy(p)}else r.SwitchDestroy(p)}}catch(m){t={error:m}}finally{try{u&&!u.done&&(e=c.return)&&e.call(c)}finally{if(t)throw t.error}}}},e.__cname="SubStateSeek",i([l.injectField("ComState")],e.prototype,"ComState",void 0),i([l.injectField("Battle")],e.prototype,"Battle",void 0),i([l.injectField("ComPrefab")],e.prototype,"ComPrefab",void 0),e}(t("../SubState").SubState);r.SubStateSeek=c,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../../view/nodeproxy/NodeProxy":"NodeProxy","../SubState":"SubState"}],SubStateSelfBoom:[function(t,e,r){"use strict";cc._RF.push(e,"01a3d6c2itGaJCnWe32i4x7","SubStateSelfBoom");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.SubStateSelfBoom=void 0;var l,s=t("../../../../../../../framework/container/Container"),c=t("../../../view/nodeproxy/NodeProxy"),u=t("../SubState");(function(t){t[t.Seek=0]="Seek"})(l||(l={}));var p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.runState=[],e.time=[],e}return n(e,t),e.prototype.getParam=function(){return this.ComState.param},e.prototype.onEnter=function(t){this.ComPrefab.ChangeModel(t,null,c.INodeProxyAni.Walk),this.switchSeek(t)},e.prototype.onExit=function(t){this.runState[t]=null,this.time[t]=null},e.prototype.onUpdate=function(t){var e,r;try{for(var o=a(this.ids),n=o.next();!n.done;n=o.next()){var i=n.value;this.updateState(t,i)}}catch(l){e={error:l}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}},e.prototype.updateState=function(t,e){switch(this.runState[e]){case l.Seek:this.updateSeek(e,t)}},e.prototype.switchSeek=function(t){var e=this.ComCollision.activeCollision,r=this.ComVar.SEARCHABLE;this.runState[t]=l.Seek,e[t]=!1,r[t]=!1},e.prototype.updateSeek=function(t){var e=this.ComVelocity.moving,r=this.Battle,o=this.getParam(),n=(o[t].stop,r.ref2id(o[t].target));this.processMoveTo(t,n),e[t]=!0},e.__cname="SubStateSelfBoom",i([s.injectField("ComState")],e.prototype,"ComState",void 0),i([s.injectField("ComVar")],e.prototype,"ComVar",void 0),i([s.injectField("ComCollision")],e.prototype,"ComCollision",void 0),i([s.injectField("ComPrefab")],e.prototype,"ComPrefab",void 0),i([s.injectField("Battle")],e.prototype,"Battle",void 0),i([s.injectField("SystemViewEffect")],e.prototype,"SystemViewEffect",void 0),i([s.injectField("ModelBattleSkill")],e.prototype,"ModelBattleSkill",void 0),i([s.injectField("ModelPrefab")],e.prototype,"ModelPrefab",void 0),e}(u.SubState);r.SubStateSelfBoom=p,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../../view/nodeproxy/NodeProxy":"NodeProxy","../SubState":"SubState"}],SubStateShoot:[function(t,e,r){"use strict";cc._RF.push(e,"bdfdfr8GDRK8LBTmSfeH33m","SubStateShoot");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.SubStateShoot=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.onEnter=function(){},e.prototype.onExit=function(){},e.prototype.onUpdate=function(){},e.__cname="SubStateShoot",e}(t("../SubState").SubState);r.SubStateShoot=i,cc._RF.pop()},{"../SubState":"SubState"}],SubStateStatic:[function(t,e,r){"use strict";cc._RF.push(e,"de58aGiHbJHQ50s2mErEi6p","SubStateStatic");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.SubStateStatic=void 0;var l=t("../../../../../../../framework/container/Container"),s=t("../../../view/nodeproxy/NodeProxy"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.onEnter=function(t){this.ComPrefab.ChangeModel(t,this.ComPrefab.model[t],s.INodeProxyAni.Idle)},e.prototype.onExit=function(){},e.prototype.onUpdate=function(){var t,e,r=this.ComPos.d,o=this.ComPos.x,n=this.ComPos.y,i=this.ComVar.SHOOT_TARGET;try{for(var l=a(this.ids),s=l.next();!s.done;s=l.next()){var c=s.value,u=i[c];if(u){var p=o[u]-o[c],f=n[u]-n[c];r[c]=Math.atan2(f,p)}}}catch(h){t={error:h}}finally{try{s&&!s.done&&(e=l.return)&&e.call(l)}finally{if(t)throw t.error}}},e.__cname="SubStateStatic",i([l.injectField("ComPrefab")],e.prototype,"ComPrefab",void 0),e}(t("../SubState").SubState);r.SubStateStatic=c,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../../view/nodeproxy/NodeProxy":"NodeProxy","../SubState":"SubState"}],SubStateStorm:[function(t,e,r){"use strict";cc._RF.push(e,"42378lURU1ApLiUlZRFIaGu","SubStateStorm");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.SubStateStorm=void 0;var l=t("../../../../../../../framework/container/Container"),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.time=[],e}return n(e,t),e.prototype.onEnter=function(t){this.time[t]=0},e.prototype.onExit=function(t){this.time[t]=null},e.prototype.onUpdate=function(t){var e,r,o=this.time,n=this.ComVar.BULLET_LIFETIME;try{for(var i=a(this.ids),l=i.next();!l.done;l=i.next()){var s=l.value;o[s]+=t,o[s]>=n[s]&&this.ComState.SwitchDestroy(s)}}catch(c){e={error:c}}finally{try{l&&!l.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}},e.__cname="SubStateStorm",i([l.injectField("ComState")],e.prototype,"ComState",void 0),e}(t("./BaseBulletSubState").BaseBulletSubState);r.SubStateStorm=s,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"./BaseBulletSubState":"BaseBulletSubState"}],SubStateStraight:[function(t,e,r){"use strict";cc._RF.push(e,"ea3586EeRtLEb5dU2GtOGme","SubStateStraight");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.SubStateStraight=void 0;var l=t("../../../../../../../framework/container/Container"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getParam=function(){return this.ComState.param},e.prototype.onEnter=function(t){this.ComVelocity.moving[t]=!0},e.prototype.onExit=function(t){this.ComVelocity.vx[t]=0,this.ComVelocity.vy[t]=0,this.ComVelocity.vgx[t]=0,this.ComVelocity.vgy[t]=0,this.ComVelocity.moving[t]=!1},e.prototype.onUpdate=function(t){var e,r,o=this.ComState,n=this.getParam(),i=this.ComPos.d,l=this.ComVelocity.vx,s=this.ComVelocity.vy,c=this.ComVelocity.moving,u=this.ComVar.BULLET_LIFETIME;try{for(var p=a(this.ids),f=p.next();!f.done;f=p.next()){var h=f.value;if(this.GetIsMapBound(h,t))o.SwitchDestroy(h);else if(null!=n[h])if(u[h]-=t,u[h]<=0)o.SwitchDestroy(h);else if(i[h]=Math.atan2(s[h],l[h]),c[h]=!0,10017==this.ComVar.BULLET_SKILL[h]){var y,d=this.ComVar.CalHeroAttr("s7046",0);0!=d?(y=this.SystemView.GetNodeProxy(h))&&y.GetPrefab()&&(y.GetPrefab().children[0].angle-=20*d):(y=this.SystemView.GetNodeProxy(h))&&y.GetPrefab()&&(y.GetPrefab().children[0].angle=0)}}}catch(m){e={error:m}}finally{try{f&&!f.done&&(r=p.return)&&r.call(p)}finally{if(e)throw e.error}}},e.__cname="SubStateStraight",i([l.injectField("ComState")],e.prototype,"ComState",void 0),i([l.injectField("ComVar")],e.prototype,"ComVar",void 0),i([l.injectField("ComCollision")],e.prototype,"ComCollision",void 0),i([l.injectField("SystemMove")],e.prototype,"SystemMove",void 0),i([l.injectField("CtrlAudio")],e.prototype,"CtrlAudio",void 0),i([l.injectField("Battle")],e.prototype,"Battle",void 0),i([l.injectField("SystemView")],e.prototype,"SystemView",void 0),e}(t("./BaseBulletSubState").BaseBulletSubState);r.SubStateStraight=s,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"./BaseBulletSubState":"BaseBulletSubState"}],SubStateSwordField:[function(t,e,r){"use strict";cc._RF.push(e,"84f07M0KYZND6aJc8P6FylA","SubStateSwordField");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.SubStateSwordField=void 0;var s=t("../../../../../../../framework/container/Container"),c=t("../../var/ComVar"),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.stateMap=new Map,e.tlSound=new Map,e._scriptParam=[],e.time=[],e.speed=[],e.swordtime=new Map,e}return n(e,t),e.prototype.getParam=function(){return this.ComState.param},e.prototype.getScriptParam=function(t){if(null==this._scriptParam[t]){var e=this.ComVar.BULLET_SCRIPT_PARAMS[t];this._scriptParam[t]={swordtime:parseInt(e[0]||0)/1e3,swordDistance:parseInt(e[1]||0)}}return this._scriptParam[t]},e.prototype.onEnter=function(t){this.getParam();var e=this.ComVelocity,r=this.ComPos.d,o=this.ComVelocity.speed;this.stateMap.set(t,1),this.swordtime.set(t,0),this.speed[t]=o[t],e.moving[t]=!0,r[t]=0,this.switch_move(t),this.time[t]=0},e.prototype.onExit=function(t){this.ComVelocity.vx[t]=0,this.ComVelocity.vy[t]=0,this.ComVelocity.vgx[t]=0,this.ComVelocity.vgy[t]=0,this.ComVelocity.moving[t]=!1,this._scriptParam[t]=null,this.time[t]=null},e.prototype.onUpdate=function(t){var e,r,o=this.stateMap;try{for(var n=a(this.ids),i=n.next();!i.done;i=n.next()){var l=i.value;switch(o.get(l)){case 1:this.process_move(l,t);break;case 2:this.process_boom(l,t);break;case 3:this.process_back(l,t)}}}catch(s){e={error:s}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}},e.prototype.switch_move=function(t){this.getParam();var e=this.ComVelocity.speed;this.stateMap.set(t,1),e[t]=this.speed[t]},e.prototype.process_move=function(t,e){this.getParam();var r=this.getScriptParam(t),o=this.time,n=this.ComVelocity.speed,i=this.ComCollision.colliding;o[t]+=e,i[t]?this.switch_boom(t):o[t]*n[t]>=r.swordDistance&&this.switch_boom(t)},e.prototype.switch_boom=function(t){this.stateMap.set(t,2)},e.prototype.process_boom=function(t,e){var r=this.getScriptParam(t),o=this.ComPos.d,n=this.ComVelocity.speed;o[t]=0,n[t]=cc.misc.lerp(n[t],0,.1);var i=this.swordtime.get(t)||0;if(i+=e,this.swordtime.set(t,i),i>r.swordtime)this.switch_back(t);else if(10034==this.ComVar.BULLET_SKILL[t]){var a=this.ComVar.CalHeroAttr("s7166",0);a>0&&this.processMoveToMonster(t,a)}},e.prototype.process_sound=function(t,e){var r=this.tlSound.get(t)||0;(r-=e)<=0?(this.tlSound.set(t,.6),this.GPAudio.sword()):this.tlSound.set(t,r)},e.prototype.processMoveToMonster=function(t,e){var r=this.ComPos.x,o=this.ComPos.y,n=[];this.SystemMove.findOtherCampNoBullet(c.EComCamp.Hero,r[t],o[t],e,n);for(var i=0;i<n.length;i++){var a=n[i],s=this.ComVar.MONSTER_REF[a];if((null==s?void 0:s.GetIsElite())||(null==s?void 0:s.GetIsBoss())){this.ComVelocity.speed[t]=320;var u=l(this.calVelocity(r[t],o[t],r[a],o[a]),2),p=u[0],f=u[1];this.ComVelocity.vx[t]=p,this.ComVelocity.vy[t]=f,this.ComPos.d[t]=0;var h=r[a],y=o[a],d=h-r[t],m=y-o[t],v=this.getParam()[t].stop,_=this.ComVelocity.moving;if(d*d+m*m<v*v)return void(_[t]=!1);if(d*this.ComVelocity.vx[t]<0)return void(_[t]=!1);if(m*this.ComVelocity.vx[t]<0)return void(_[t]=!1);_[t]=!0;break}}},e.prototype.switch_back=function(t){this.ComPrefab;var e=this.stateMap,r=(this.ComCollision.r,this.getParam(),this.ComVelocity.speed);e.set(t,3),r[t]=this.speed[t]},e.prototype.process_back=function(t){var e=this.ComVar,r=(this.ComCollision,this.getParam()),o=this.ComPos.x,n=this.ComPos.y,i=this.ComVelocity.vx,a=this.ComVelocity.vy,s=this.ComVelocity.moving,c=this.ComPos.d,u=e.HEROID,p=l(this.calVelocity(o[t],n[t],o[u],n[u]),2),f=p[0],h=p[1];i[t]=f,a[t]=h,c[t]=0;var y=o[u],d=n[u],m=y-o[t],v=d-n[t],_=r[t].stop;m*m+v*v<_*_?this.defer(t):m*i[t]<0?this.defer(t):v*a[t]<0?this.defer(t):s[t]=!0},e.prototype.defer=function(t){var e=this.ComVelocity.moving,r=this.stateMap,o=this.ComState,n=this.tlSound;r.has(t)&&(e[t]=!1,r.delete(t),n.delete(t),o.SwitchDestroy(t))},e.__cname="SubStateSwordField",i([s.injectField("ComState")],e.prototype,"ComState",void 0),i([s.injectField("ComVar")],e.prototype,"ComVar",void 0),i([s.injectField("ComCollision")],e.prototype,"ComCollision",void 0),i([s.injectField("ComPrefab")],e.prototype,"ComPrefab",void 0),i([s.injectField("GPAudio")],e.prototype,"GPAudio",void 0),i([s.injectField("SystemMove")],e.prototype,"SystemMove",void 0),e}(t("./BaseBulletSubState").BaseBulletSubState);r.SubStateSwordField=u,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../var/ComVar":"ComVar","./BaseBulletSubState":"BaseBulletSubState"}],SubStateVenom:[function(t,e,r){"use strict";cc._RF.push(e,"725b00ParFGSK58bxkRbhhI","SubStateVenom");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.SubStateVenom=void 0;var l=t("../../../../../../../framework/container/Container"),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.time=[],e.effectIds=[],e}return n(e,t),e.prototype.getParam=function(){return this.ComState.param},e.prototype.getScriptParam=function(t){return this.ComVar.BULLET_SCRIPT_PARAMS[t][0]||0},e.prototype.onEnter=function(t){var e=this.ComVelocity.moving,r=this.ComCollision.isTrigger;this.time[t]=0,e[t]=!1,r[t]=!0},e.prototype.onExit=function(){},e.prototype.onUpdate=function(t){var e,r,o,n,i=this,l=this.ComVar.BULLET_LIFETIME;try{for(var s=a(this.ids),c=s.next();!c.done;c=s.next()){var u=c.value;l[u]-=t;var p=this.getScriptParam(u);if(p){var f=this.ComCollision.collisons[u];this.effectIds[u]||(this.effectIds[u]=[]),this.effectIds[u].forEach(function(t){i.ComVar.SPEED_REDUCE[t]=1});try{for(var h=(o=void 0,a(f)),y=h.next();!y.done;y=h.next()){var d=y.value;this.effectIds[u].push(d),this.ComVar.SPEED_REDUCE[d]=1-Number(p)/1e4}}catch(m){o={error:m}}finally{try{y&&!y.done&&(n=h.return)&&n.call(h)}finally{if(o)throw o.error}}}l[u]<=0&&(p&&this.effectIds[u].forEach(function(t){i.ComVar.SPEED_REDUCE[t]=1}),this.ComState.SwitchDestroy(u))}}catch(v){e={error:v}}finally{try{c&&!c.done&&(r=s.return)&&r.call(s)}finally{if(e)throw e.error}}},e.__cname="SubStateVenom",i([l.injectField("ComState")],e.prototype,"ComState",void 0),i([l.injectField("Battle")],e.prototype,"Battle",void 0),i([l.injectField("ComPrefab")],e.prototype,"ComPrefab",void 0),i([l.injectField("ComCollision")],e.prototype,"ComCollision",void 0),e}(t("./BaseBulletSubState").BaseBulletSubState);r.SubStateVenom=s,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"./BaseBulletSubState":"BaseBulletSubState"}],SubStateWanderVertical:[function(t,e,r){"use strict";cc._RF.push(e,"68355gxGOVCoL8D9aijXD3S","SubStateWanderVertical");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.SubStateWanderVertical=void 0;var s=t("../../../../../../../framework/container/Container"),c=t("../../../../../../../framework/coord/Coord"),u=t("../../../view/nodeproxy/NodeProxy"),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tx=[],e.ty=[],e}return n(e,t),e.prototype.getParam=function(){return this.ComState.param},e.prototype.onEnter=function(t){this.ComPrefab.ChangeModel(t,null,u.INodeProxyAni.Walk),this.seekPos(t)},e.prototype.onExit=function(t){this.tx[t]=null,this.ty[t]=null},e.prototype.onUpdate=function(){var t,e,r=this.Battle,o=this.getParam();try{for(var n=a(this.ids),i=n.next();!i.done;i=n.next()){var l=i.value;if(null==r.ref2id(o[l].target))return;if(this.processBeHit(l))return;this.checkArrived(l)&&this.seekPos(l),this.updateWalk(l)}}catch(s){t={error:s}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}},e.prototype.getWidth=function(){var t=this.width;if(null==t){var e=c.Coord.logicSize.width,r=this.SystemMap.mapBound.width;t=Math.min(e,r),this.width=t}return t},e.prototype.checkArrived=function(t){var e=this.ComPos.x,r=this.ComPos.y,o=this.tx,n=this.ty;return(o[t]-e[t])*(o[t]-e[t])+(n[t]-r[t])*(n[t]-r[t])<=400},e.prototype.seekPos=function(t){var e=this.ComPos.x,r=this.ComPos.y,o=this.getParam(),n=o[t].distance,i=this.Battle.ref2id(o[t].target),a=this.getWidth(),s=Math.random()*a,c=e[i]-a/2+s,u=r[i]+Math.sign(r[i]-r[t])*n,p=l(this.SystemMove.fixPos(c,u),2),f=p[0],h=p[1];this.tx[t]=f,this.ty[t]=h},e.prototype.updateWalk=function(t){var e=this.ComPos.x,r=this.ComPos.y,o=this.ComVelocity.vgx,n=this.ComVelocity.vgy,i=this.ComPos.d,a=this.ComVelocity.moving,s=this.tx,c=this.ty,u=l(this.calVelocity(e[t],r[t],s[t],c[t]),2),p=u[0],f=u[1];o[t]=p,n[t]=f,i[t]=Math.atan2(n[t],o[t]),a[t]=!0},e.__cname="SubStateWanderVertical",i([s.injectField("ComVar")],e.prototype,"ComVar",void 0),i([s.injectField("ComState")],e.prototype,"ComState",void 0),i([s.injectField("Battle")],e.prototype,"Battle",void 0),i([s.injectField("SystemMap")],e.prototype,"SystemMap",void 0),i([s.injectField("SystemMove")],e.prototype,"SystemMove",void 0),i([s.injectField("ComPrefab")],e.prototype,"ComPrefab",void 0),e}(t("../SubState").SubState);r.SubStateWanderVertical=p,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../../../../../../framework/coord/Coord":void 0,"../../../view/nodeproxy/NodeProxy":"NodeProxy","../SubState":"SubState"}],SubStateWander:[function(t,e,r){"use strict";cc._RF.push(e,"60d78h78CNK7LAPeyNIC/U/","SubStateWander");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.SubStateWander=void 0;var s=t("../../../../../../../framework/container/Container"),c=t("../../../view/nodeproxy/NodeProxy"),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tx=[],e.ty=[],e}return n(e,t),e.prototype.getParam=function(){return this.ComState.param},e.prototype.onEnter=function(t){this.ComPrefab.ChangeModel(t,null,c.INodeProxyAni.Walk),this.seekPos(t)},e.prototype.onExit=function(t){this.tx[t]=null,this.ty[t]=null},e.prototype.onUpdate=function(){var t,e,r=this.Battle,o=this.getParam();try{for(var n=a(this.ids),i=n.next();!i.done;i=n.next()){var l=i.value;if(null==r.ref2id(o[l].target))return;if(this.processBeHit(l))return;this.checkArrived(l)&&this.seekPos(l),this.updateWalk(l)}}catch(s){t={error:s}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}},e.prototype.checkArrived=function(t){var e=this.ComPos.x,r=this.ComPos.y,o=this.tx,n=this.ty;return(o[t]-e[t])*(o[t]-e[t])+(n[t]-r[t])*(n[t]-r[t])<=400},e.prototype.seekPos=function(t){var e=this.ComPos.x,r=this.ComPos.y,o=this.getParam(),n=o[t].distance,i=this.Battle.ref2id(o[t].target),a=Math.min(2*n,600),s=e[i]-e[t],c=r[i]-r[t],u=Math.atan2(c,s),p=Math.random(),f=60/180*Math.PI,h=u-f/2+p*f,y=e[t]+Math.cos(h)*a,d=r[t]+Math.sin(h)*a,m=l(this.SystemMove.fixPosMove(y,d),2),v=m[0],_=m[1];this.tx[t]=v,this.ty[t]=_},e.prototype.updateWalk=function(t){var e=this.ComPos.x,r=this.ComPos.y,o=this.ComVelocity.vgx,n=this.ComVelocity.vgy,i=this.ComPos.d,a=this.ComVelocity.moving,s=this.Battle,c=this.getParam(),u=(c[t].distance,s.ref2id(c[t].target),this.tx),p=this.ty,f=l(this.calVelocity(e[t],r[t],u[t],p[t]),2),h=f[0],y=f[1];o[t]=h,n[t]=y,i[t]=Math.atan2(n[t],o[t]),a[t]=!0},e.__cname="SubStateWander",i([s.injectField("ComVar")],e.prototype,"ComVar",void 0),i([s.injectField("ComState")],e.prototype,"ComState",void 0),i([s.injectField("Battle")],e.prototype,"Battle",void 0),i([s.injectField("SystemMap")],e.prototype,"SystemMap",void 0),i([s.injectField("SystemMove")],e.prototype,"SystemMove",void 0),i([s.injectField("ComPrefab")],e.prototype,"ComPrefab",void 0),e}(t("../SubState").SubState);r.SubStateWander=u,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../../view/nodeproxy/NodeProxy":"NodeProxy","../SubState":"SubState"}],SubState:[function(t,e,r){"use strict";cc._RF.push(e,"e4a47wFgmBMFI6YZFvtF6FA","SubState");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a},l=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.SubState=void 0;var s=t("../../../../../../framework/base/ScriptObject"),c=t("../../../../../../framework/container/Container"),u=t("../../../../../../framework/Func"),p={A:{x:0,y:0},B:{x:0,y:0},C:{x:0,y:0},D:{x:0,y:0},P:{x:0,y:0}},f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ids=new Set,e._screenbound=new cc.Rect,e._behit_running=[],e._behitvec=new cc.Vec2,e._behit_speed=[],e._behit_dist_min=0,e._behit_dist_max=0,e}return n(e,t),e.prototype.enter=function(t){this.ids.add(t),this.onEnter(t),this.onEnterBeHit(t)},e.prototype.exit=function(t){this.ids.delete(t),this.onExitBeHit(t),this.onExit(t)},e.prototype.Update=function(t){this.onUpdate(t),this.onUpdateBeHit(t)},e.prototype.GetIsMapBound=function(t,e){return this.CheckIsBound(t,e,this.SystemMap.mapSafeRect)},e.prototype.GetIsMoveBound=function(t,e){return this.CheckIsBound(t,e,this.SystemMap.mapBound)},e.prototype.CheckIsBound=function(t,e,r){var o=this.ComPos.x,n=this.ComPos.y,i=this.ComVelocity.vx,a=this.ComVelocity.vy,l=this.ComVelocity.speed,s=this.ComCollision.r,c=p,f=o[t],h=n[t],y=0,d=0;return l[t]&&(y=i[t]*l[t]*e,d=a[t]*l[t]*e),y+=Math.sign(y)*s[t],d+=Math.sign(d)*s[t],c.A.x=r.x,c.A.y=r.y,c.B.x=r.x+r.width,c.B.y=r.y,c.C.x=r.x+r.width,c.C.y=r.y+r.height,c.D.x=r.x,c.D.y=r.y+r.height,c.P.x=f+y,c.P.y=h+d,!u.Func.isPointInRect(c.A,c.B,c.C,c.D,c.P)},e.prototype.GetMapBound=function(){return this.SystemMap.mapBound},e.prototype.GetScreenBound=function(){return this.SystemCamera.cameraBound},e.prototype.GetIsScreenBound=function(t,e){var r=this.GetScreenBound();return this.CheckIsBound(t,e,r)},e.prototype.processMoveTo=function(t,e,r){void 0===r&&(r=null);var o=this.ComPos.x,n=this.ComPos.y,i=this.ComVelocity.vgx,l=this.ComVelocity.vgy,s=this.ComPos.d,c=o[e],u=n[e];if(null!=r){var p=this.ComVelocity.vx,f=this.ComVelocity.vy,h=this.ComVelocity.speed;c+=p[e]*h[e]*r,u+=f[e]*h[e]*r}var y=a(this.calVelocity(o[t],n[t],c,u),2),d=y[0],m=y[1];i[t]=d,l[t]=m,s[t]=Math.atan2(l[t],i[t])},e.prototype.calVelocity=function(t,e,r,o){var n=r-t,i=o-e,a=n*n+i*i;if(a>0){var l=Math.sqrt(a);n/=l,i/=l}return[n,i]},e.prototype.onEnterBeHit=function(){this._behit_dist_min=this.ModelGameConfig.GetGameConfigValueByKey("battleMonsterHitDistanceMin"),this._behit_dist_max=this.ModelGameConfig.GetGameConfigValueByKey("battleMonsterHitDistanceMax")},e.prototype.onExitBeHit=function(t){this._behit_speed[t]=null},e.prototype.processBeHit=function(t){var e=this.ComVar.BEHIT_DURATION,r=this.ComVelocity.speed,o=this._behit_speed,n=this._behit_running,i=this.ComVar.ALIVE;if(e[t]&&e[t]>0)return null==o[t]&&(o[t]=r[t]),n.push(t),!0;var a=this.ComVelocity.speed;return o[t]&&(i[t]?(a[t]=o[t],o[t]=null):a[t]=0),!1},e.prototype.processBeHitInner=function(){var t,e;if(!(this._behit_running.length<=0)){var r=this.ComVar.BEHIT_DURATION,o=this._behit_dist_min,n=this._behit_dist_max,i=this.ComPos.x,a=this.ComPos.y,s=this.ComVelocity.vx,c=this.ComVelocity.vy,u=this.ComVelocity.speed,p=this.ComVar.BEHIT_SENDER,f=this._behitvec,h=this.ComVar.BULLET_REPEL,y=this.ComVar.MONSTER_DEF_REPEL,d=this.ComVar.BULLET_SENDER,m=this.ComVar.REPL_MAX;try{for(var v=l(this._behit_running),_=v.next();!_.done;_=v.next()){var S=_.value;if(0!=(r[S]&&r[S]>0)){var g=p[S],b=0;if(g&&(b=Math.max(0,Math.min(m,h[g]-y[S]))),b>0){var C=b/m,R=cc.misc.lerp(o,n,C)/r[S],M=d[g]||g;f.x=i[S]-i[M],f.y=a[S]-a[M],f.normalizeSelf(),s[S]=f.x,c[S]=f.y,u[S]=R}}}}catch(w){t={error:w}}finally{try{_&&!_.done&&(e=v.return)&&e.call(v)}finally{if(t)throw t.error}}}},e.prototype.onUpdateBeHit=function(t){this.processBeHitInner(t),this._behit_running.length=0},i([c.injectField("ComPos")],e.prototype,"ComPos",void 0),i([c.injectField("ComVar")],e.prototype,"ComVar",void 0),i([c.injectField("ComVelocity")],e.prototype,"ComVelocity",void 0),i([c.injectField("ComCollision")],e.prototype,"ComCollision",void 0),i([c.injectField("SystemMap")],e.prototype,"SystemMap",void 0),i([c.injectField("SystemCamera")],e.prototype,"SystemCamera",void 0),i([c.injectField("ModelGameConfig")],e.prototype,"ModelGameConfig",void 0),e}(s.ScriptObject);r.SubState=f,cc._RF.pop()},{"../../../../../../framework/Func":void 0,"../../../../../../framework/base/ScriptObject":void 0,"../../../../../../framework/container/Container":void 0}],SubSysBCTrigger:[function(t,e,r){"use strict";cc._RF.push(e,"94bd0YsxsJMyax1154g5469","SubSysBCTrigger");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.SubSysBCTrigger=void 0;var i=t("../../../base/BaseSubBattleSystem"),a=t("../trigger/SBCTriggerMgr"),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnInit=function(){this.mgr=new a.SBCTriggerMgr(this.container)},e.prototype.onDestroy=function(){this.mgr.destroy()},e.prototype.OnEnter=function(){},e.prototype.OnExit=function(){},e.prototype.OnUpdate=function(t){this.mgr.Update(t)},e.prototype.CreateTrigger=function(t){return this.mgr.CreateTrigger(t)},e.prototype.DestroyTrigger=function(t){return this.mgr.DestroyTrigger(t)},e.__cname="SubSysBCTrigger",e}(i.BaseSubBattleSystem);r.SubSysBCTrigger=l,cc._RF.pop()},{"../../../base/BaseSubBattleSystem":"BaseSubBattleSystem","../trigger/SBCTriggerMgr":"SBCTriggerMgr"}],SubSysCameraFollow:[function(t,e,r){"use strict";cc._RF.push(e,"0ad7bK63cxKb59jaGEqK5tw","SubSysCameraFollow");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.SubSysCameraFollow=void 0;var a=t("../../../../../../framework/container/Container"),l=t("../../../../../../framework/coord/Coord"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnInit=function(){},e.prototype.onDestroy=function(){},e.prototype.OnEnter=function(){},e.prototype.OnExit=function(){},e.prototype.OnUpdate=function(t){this.updateCamera(t)},e.prototype.updateCamera=function(){var t=this.ComVar.HEROID,e=this.SystemMap.mapSafeRect,r=this.SystemMap.mapRect,o=this.parent.camera,n=l.Coord.logicSize,i=l.Coord.logicSize.width/2,a=l.Coord.logicSize.height/2,s=e.width,c=e.height;if(t){var u,p,f=this.ComPos.x[t],h=this.ComPos.y[t];if(r.width<=n.width?(u=e.width/2,p=h,p=Math.min(p,c-a),p=Math.max(p,0+a)):r.height<=n.height?(p=e.height/2,u=f,u=Math.min(u,s-i),u=Math.max(u,0+i)):(u=f,u=Math.min(u,s-i),u=Math.max(u,0+i),p=h,p=Math.min(p,c-a),p=Math.max(p,0+a)),null==this.last_x||u!=f||p!=h){o.node.setPosition(u,p);var y=this.parent.sceneWidth,d=this.parent.sceneHeight,m=this.parent.cameraBound;m.x=u-y/2,m.y=p-d/2,m.width=y,m.height=d}}},e.__cname="SubSysCameraFollow",i([a.injectField("ComPos")],e.prototype,"ComPos",void 0),i([a.injectField("ComVar")],e.prototype,"ComVar",void 0),i([a.injectField("SystemMap")],e.prototype,"SystemMap",void 0),e}(t("../../base/BaseSubBattleSystem").BaseSubBattleSystem);r.SubSysCameraFollow=s,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../../../../../framework/coord/Coord":void 0,"../../base/BaseSubBattleSystem":"BaseSubBattleSystem"}],SubSysCameraZoom:[function(t,e,r){"use strict";cc._RF.push(e,"6bab3VcdgBICKW/a1N4baS+","SubSysCameraZoom");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.SubSysCameraZoom=void 0;var a=t("../../../../../../framework/container/Container"),l=t("../../../../../../framework/FW"),s=t("../../../../../../framework/tween/TweenEase"),c=t("../../base/BaseSubBattleSystem"),u=["BattleCameraZoom_1","BattleCameraZoom_2","BattleCameraZoom_3"];function p(t){return 1/t}var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tmCameraRate=new Map,e._start=!1,e}return n(e,t),e.prototype.OnInit=function(){},e.prototype.onDestroy=function(){},e.prototype.OnEnter=function(){console.log("camera ddd",this),this.camera=this.parent.camera;var t=this.ModelGameConfig.GetGameConfigValueByKey("battleCameraZoomLevelLimit");t!=u.length&&l.FW.Log.error("\u6444\u50cf\u673a\u6700\u9ad8\u6863\u4f4d\u914d\u7f6e\u6709\u53d8\u66f4\uff0c\u8bf7\u8054\u7cfb\u7a0b\u5e8f\u5b9e\u73b0 limit:"+t+" keys:"+u),this.limit=t;var e=this.ModelGameConfig.GetGameConfigValueByKey("battleCameraZoomDuration");this.aniDuration=e;for(var r=this.tmCameraRate,o=void 0,n=0;n<u.length;n++){var i=u[n],a=n+1,s=this.ModelGameConfig.GetGameConfigValueByKey(i);r.set(a,s),null==o&&(o=a)}null==this.curLevel&&null!=o&&this.SetCameraRatioByLevel(o)},e.prototype.OnExit=function(){},e.prototype.OnUpdate=function(t){this.OnUpdateZoomAni(t)},e.prototype.NextCameraZoomLevel=function(t){t>this.curLevel&&this.SetCameraZoomLevel(t)},e.prototype.SetCameraZoomLevel=function(t){if(t!=this.curLevel&&t!=this.nextLevel){var e=this.tmCameraRate.get(t);if(null==e)return;this.nextLevel=t;var r=p(e);this.StartZoomAni(r),this.parent.SetCameraRate(e)}},e.prototype.SetCameraRatioByLevel=function(t){var e=this.tmCameraRate.get(t);null!=e&&(this.curLevel=t,this.SetCameraZoomRatioByRate(e),this.parent.SetCameraRate(e))},e.prototype.SetCameraZoomRatioByRate=function(t){var e=p(t);this.camera.zoomRatio=e},e.prototype.StartZoomAni=function(t){this._time=0,this._start=!0,this._from=this.camera.zoomRatio,this._to=t},e.prototype.StopZoomAni=function(){this._time=0,this._start=!1;var t=this.nextLevel;this.nextLevel=null,this.curLevel=t,this.SetCameraRatioByLevel(t)},e.prototype.OnUpdateZoomAni=function(t){if(0!=this._start){var e=this._time+t;if(this._time=e,e>this.aniDuration)this.StopZoomAni();else{var r,o,n,i;r=e,o=this._from,n=this._to-this._from,i=this.aniDuration;var a=s.TweenEase.Quart.easeOut(r,o,n,i);this.camera.zoomRatio=a}}},e.prototype.GetRuntimeKey=function(){return"__"+this.className},e.prototype.GetRuntimtData=function(){return this.curLevel},e.prototype.ResumeRuntmeData=function(t){if(t){var e=parseInt(t);this.SetCameraRatioByLevel(e)}},e.__cname="SubSysCameraZoom",i([a.injectField("ModelGameConfig")],e.prototype,"ModelGameConfig",void 0),i([a.injectField("SystemMap")],e.prototype,"SystemMap",void 0),e}(c.BaseSubBattleSystem);r.SubSysCameraZoom=f,cc._RF.pop()},{"../../../../../../framework/FW":void 0,"../../../../../../framework/container/Container":void 0,"../../../../../../framework/tween/TweenEase":void 0,"../../base/BaseSubBattleSystem":"BaseSubBattleSystem"}],SubSysEffectWarning:[function(t,e,r){"use strict";cc._RF.push(e,"88e12LZGI9CHoh1C6MJbHlY","SubSysEffectWarning");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.SubSysEffectWarning=r.EEffectWarnningType=void 0;var s,c=t("../../../../../../framework/container/Container"),u=t("../../../../../../framework/pool/Pool"),p=t("../../../../../../framework/tween/TweenEase"),f=t("../../base/BaseSubBattleSystem"),h=t("../nodeproxy/NodeProxy");(function(t){t[t.Square=0]="Square",t[t.Circular=1]="Circular"})(s=r.EEffectWarnningType||(r.EEffectWarnningType={}));var y=[{type:s.Circular,model:"\u6218\u6597_\u6218\u6597\u573a\u666f\u7279\u6548_\u4f24\u5bb3\u5706\u5f62",width:240,height:240},{type:s.Square,model:"\u6218\u6597_\u6218\u6597\u573a\u666f\u7279\u6548_\u4f24\u5bb3\u957f\u65b9\u5f62",width:240,height:100}],d=function(){function t(){this.time=0}return t.prototype.Init=function(t,e){this.parent=t,this.data=e,this.x=e.x,this.y=e.y,this.w=e.lineWidth,this.h=e.min,this.d=e.min},t.prototype.UpdateData=function(t){if(this.time+=t,this.time>this.data.duration)return!1;switch(this.data.type){case s.Square:this.UpdateData_Square(t);break;case s.Circular:this.UpdateData_Circular(t)}return!0},t.prototype.UpdateData_Square=function(){var t=this.data,e=this.time,r=(t.x,t.y,t.lineWidth,t.min),o=t.max-r,n=p.TweenEase.Quart.easeOut(e,r,o,t.duration);this.h=n},t.prototype.UpdateData_Circular=function(){var t=this.data,e=this.time,r=(t.x,t.y,t.min),o=t.max-r,n=p.TweenEase.Linear(e,r,o,t.duration);this.d=n},t.prototype.UpdateView=function(){switch(this.data.type){case s.Square:this.UpdateView_Square();break;case s.Circular:this.UpdateView_Circular()}},t.prototype.UpdateView_Square=function(){var t=this.nodeProxy,e=this.parent.GetResDataByType(this.data.type),r=this.data,o=this.x,n=this.y,i=this.w,a=this.h/e.width,l=i/e.height,s=180*r.direction/Math.PI;t.SetActive(!0),t.SetXY(o,n),t.SetRotation(s),t.SetLocalScale(a,l)},t.prototype.UpdateView_Circular=function(){var t=this.nodeProxy,e=this.parent.GetResDataByType(this.data.type),r=this.data,o=this.x,n=this.y,i=this.d/e.width,a=r.max/e.width,l=t.FindChild("position.sprite2",null);null!=l&&(l.scale=i);var s=t.FindChild("position.sprite",null);null!=s&&(s.scale=a),t.SetActive(!0),t.SetXY(o,n)},t.prototype.ResumeNodeProxy=function(){var t=this.nodeProxy;if(t.SetActive(!1),t.SetXY(-999,-999),t.SetRotation(0),t.SetLocalScale(1,1),this.data.type==s.Circular){var e=t.FindChild("position.sprite2",null);null!=e&&(e.scale=1)}},t.prototype.InitNodeProxy=function(){this.nodeProxy.SetActive(!1)},t}(),m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tmPool=new Map,e.tmType2Data=new Map,e.tlObject=new Set,e.tlDestroy=new Set,e}return n(e,t),e.prototype.OnInit=function(){},e.prototype.onDestroy=function(){},e.prototype.OnEnter=function(){var t,e,r,o,n,i=this.NodeProxyMgr,l=this.tmType2Data,s=this.tmPool;try{for(var c=a(y),p=c.next();!p.done;p=c.next()){var f=p.value;l.set(f.type,f)}}catch(S){t={error:S}}finally{try{p&&!p.done&&(e=c.return)&&e.call(c)}finally{if(t)throw t.error}}if(this.OnOffMgr.OnOffEffectWeakening.GetValue()){var d=this.ModelGameConfig.GetGameConfigValueByKey("BattleEffectWeak");n=d/100}var m=function(t){var e=t.model,r=new u.Pool(function(){var t=i.CreateProxy();return t.SetZIndex(h.NodeProxyOrder.EffectBack),t.SetPropertype("model",e),t.SetActive(!1),null!=n&&t.SetPropertype("alpha",n),t},function(t){i.DestroyProxy(t)},function(){},function(t){return t.SetActive(!1),!0});s.set(e,r)};try{for(var v=a(y),_=v.next();!_.done;_=v.next())m(f=_.value)}catch(g){r={error:g}}finally{try{_&&!_.done&&(o=v.return)&&o.call(v)}finally{if(r)throw r.error}}},e.prototype.OnExit=function(){var t,e;try{for(var r=a(this.tmPool),o=r.next();!o.done;o=r.next()){var n=l(o.value,2),i=(n[0],n[1]);i.returnAllToPool(),i.destroy()}}catch(s){t={error:s}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},e.prototype.OnUpdate=function(t){this.UpateEffect(t)},e.prototype.GetModelByType=function(t){return this.tmType2Data.get(t).model},e.prototype.GetResDataByType=function(t){return this.tmType2Data.get(t)},e.prototype.AddEffect=function(t){var e=this.CreateEffectData(t);this.tlObject.add(e)},e.prototype.UpateEffect=function(t){var e,r,o,n,i,l,s=this.tlObject,c=this.tlDestroy;try{for(var u=a(s),p=u.next();!p.done;p=u.next())0==(y=p.value).UpdateData(t)&&(s.delete(y),c.add(y))}catch(v){e={error:v}}finally{try{p&&!p.done&&(r=u.return)&&r.call(u)}finally{if(e)throw e.error}}try{for(var f=a(c),h=f.next();!h.done;h=f.next()){var y=h.value;this.DestroyEffectData(y)}}catch(_){o={error:_}}finally{try{h&&!h.done&&(n=f.return)&&n.call(f)}finally{if(o)throw o.error}}c.clear();try{for(var d=a(s),m=d.next();!m.done;m=d.next())(y=m.value).UpdateView(t)}catch(S){i={error:S}}finally{try{m&&!m.done&&(l=d.return)&&l.call(d)}finally{if(i)throw i.error}}},e.prototype.CreateNodeProxy=function(t){return this.tmPool.get(t).getFromPool()},e.prototype.DestroyNodeProxy=function(t,e){this.tmPool.get(t).returnToPool(e)},e.prototype.CreateEffectData=function(t){var e=this.GetModelByType(t.type),r=new d;return r.Init(this,t),r.nodeProxy=this.CreateNodeProxy(e),r.InitNodeProxy(),r},e.prototype.DestroyEffectData=function(t){var e=this.GetModelByType(t.data.type),r=t.nodeProxy;t.ResumeNodeProxy(),t.nodeProxy=null,this.DestroyNodeProxy(e,r)},e.__cname="SubSysEffectWarning",i([c.injectField("ModelPrefab")],e.prototype,"ModelPrefab",void 0),i([c.injectField("NodeProxyMgr")],e.prototype,"NodeProxyMgr",void 0),i([c.injectField("OnOffMgr")],e.prototype,"OnOffMgr",void 0),i([c.injectField("ModelGameConfig")],e.prototype,"ModelGameConfig",void 0),e}(f.BaseSubBattleSystem);r.SubSysEffectWarning=m,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../../../../../framework/pool/Pool":void 0,"../../../../../../framework/tween/TweenEase":void 0,"../../base/BaseSubBattleSystem":"BaseSubBattleSystem","../nodeproxy/NodeProxy":"NodeProxy"}],SubSysRoleStatus:[function(t,e,r){"use strict";cc._RF.push(e,"1531cRr069CkYDlKbxxK3Da","SubSysRoleStatus");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.SubSysRoleStatus=void 0;var s,c=t("../../../../../../../framework/container/Container"),u=t("../../../base/BaseSubBattleSystem");(function(t){t[t.Idle=0]="Idle",t[t.Run=1]="Run",t[t.Destroy=2]="Destroy",t[t.Destoryed=3]="Destoryed"})(s||(s={}));var p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ids=new Set,e.tmId2Handler=new Map,e.tlChanged=[],e}return n(e,t),e.prototype.OnInit=function(){},e.prototype.onDestroy=function(){},e.prototype.OnEnter=function(){},e.prototype.OnExit=function(){},e.prototype.OnUpdate=function(){this.UpdateRoleStatus()},e.prototype.OnAddEntity=function(t){this.ids.add(t)},e.prototype.OnRemoveEntity=function(t){this.ids.delete(t)},e.prototype.GetTmHandler=function(t){var e=this.tmId2Handler.get(t);return null==e&&(e=new Map,this.tmId2Handler.set(t,e)),e},e.prototype.GetHandler=function(t,e){var r=this.GetTmHandler(t),o=r.get(e);return null==o&&(o={eid:t,key:e,model:null,count:0,state:s.Idle,nextstate:s.Idle},r.set(e,o)),o},e.prototype.AddRoleStatusRef=function(t,e){var r=this.ModelBattleStatus.GetStatusIcon(e),o=this.GetHandler(t,e);o.count++,o.nextstate=s.Run,o.model=r.GetPath(),this.tlChanged.push(o)},e.prototype.RemoveRoleStatusRef=function(t,e){var r=this.GetHandler(t,e);r.count=Math.max(0,r.count-1),this.tlChanged.push(r)},e.prototype.ClearRoleStatus=function(t){var e,r;try{for(var o=a(this.GetTmHandler(t)),n=o.next();!n.done;n=o.next()){var i=l(n.value,2),c=(i[0],i[1]);c.nextstate=s.Destroy,this.tlChanged.push(c)}}catch(u){e={error:u}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}this.UpdateRoleStatus()},e.prototype.UpdateRoleStatus=function(){var t,e;try{for(var r=a(this.tlChanged),o=r.next();!o.done;o=r.next()){var n=o.value,i=n.state,l=n.nextstate;i==l&&i==s.Run&&n.count<=0&&(l=s.Destroy),i!=l&&i!=s.Destoryed&&(l==s.Destroy?(l=s.Destoryed,n.model&&this.SystemViewWedgit.RemoveWedgit(n.eid,n.model)):l==s.Run&&this.SystemViewWedgit.AddWedgit(n.eid,n.model),n.state=l,n.nextstate=l),n.state==s.Destoryed&&this.GetTmHandler(n.eid).delete(n.key)}}catch(c){t={error:c}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}this.tlChanged.length=0},e.__cname="SubSysRoleStatus",i([c.injectField("SystemViewEffect")],e.prototype,"SystemViewEffect",void 0),i([c.injectField("SystemViewWedgit")],e.prototype,"SystemViewWedgit",void 0),i([c.injectField("ModelBattleStatus")],e.prototype,"ModelBattleStatus",void 0),e}(u.BaseSubBattleSystem);r.SubSysRoleStatus=p,cc._RF.pop()},{"../../../../../../../framework/container/Container":void 0,"../../../base/BaseSubBattleSystem":"BaseSubBattleSystem"}],SysAttrBehavior:[function(t,e,r){"use strict";cc._RF.push(e,"f947akdNXNPuJnKxQ6mMYsu","SysAttrBehavior");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.SysAttrBehavior=void 0;var l=t("../../../../../framework/container/Container"),s=t("../../../../../framework/FW"),c=t("../../attr/SubAttrBuff"),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnGetRef=function(){return this.ModelSkill.GetBuff(this.resIdOrGroupId)},e.prototype.OnApply=function(){var t,e;try{for(var r=a(this.ref.GetEffect()),o=r.next();!o.done;o=r.next()){var n=o.value,i=n.resId,l=n.value,u=this.CtrlAttr.GetSub(c.SubAttrBuff);i&&(u.AddAttr(i,l)?u.MarkDirty():s.FW.ZJJ.warn("\u4e0d\u652f\u6301\u7684\u5c5e\u6027 buffId:"+this.ref.GetRef().refId+" attrId:"+i))}}catch(p){t={error:p}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},e.prototype.OnUnuse=function(){var t,e;try{for(var r=a(this.ref.GetEffect()),o=r.next();!o.done;o=r.next()){var n=o.value,i=n.resId,l=n.value,s=this.CtrlAttr.GetSub(c.SubAttrBuff);i&&(l*=-1,s.AddAttr(i,l)&&s.MarkDirty())}}catch(u){t={error:u}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},e.__cname="SysAttrBehavior",i([l.injectField("CtrlAttr")],e.prototype,"CtrlAttr",void 0),i([l.injectField("ModelSkill")],e.prototype,"ModelSkill",void 0),e}(t("../base/BuffBehavior").BuffBehavior);r.SysAttrBehavior=u,cc._RF.pop()},{"../../../../../framework/FW":void 0,"../../../../../framework/container/Container":void 0,"../../attr/SubAttrBuff":"SubAttrBuff","../base/BuffBehavior":"BuffBehavior"}],SysBuffBehaviorMgr:[function(t,e,r){"use strict";cc._RF.push(e,"5e40bLCEqNHuL0wgrKvSiAy","SysBuffBehaviorMgr");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.SysBuffBehaviorMgr=void 0;var s=t("../../../../../framework/container/Container"),c=t("../../../../ref/RefBuff"),u=t("../base/BuffBehavior"),p=t("./SysAttrBehavior"),f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.Create=function(t){var r=new e;return r.container=t,t.inject(r),r},e.prototype.OnFilter=function(t){return t instanceof c.RefBuff&&1==t.GetPreCalculate()},e.prototype.Start=function(){var t,e;try{for(var r=a(this.ModelSkill.GetTmBuff()),o=r.next();!o.done;o=r.next()){var n=l(o.value,2),i=(n[0],n[1]);1==i.GetPreCalculate()&&i.GetEventType()==c.RefBuffEventType.Attr&&this.SetBuffClass(i.GetRef().refId,p.SysAttrBehavior)}}catch(s){t={error:s}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},e.__cname="SysBuffBehaviorMgr",i([s.injectField("ModelSkill")],e.prototype,"ModelSkill",void 0),e}(u.BuffBehaviorMgr);r.SysBuffBehaviorMgr=f,cc._RF.pop()},{"../../../../../framework/container/Container":void 0,"../../../../ref/RefBuff":"RefBuff","../base/BuffBehavior":"BuffBehavior","./SysAttrBehavior":"SysAttrBehavior"}],SystemAI:[function(t,e,r){"use strict";cc._RF.push(e,"c9899m/5f1LCpk/ICimVOed","SystemAI");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.SystemAI=void 0;var l=t("../../../../../../framework/container/Container"),s=t("../../../../../../framework/ecs/GroupSet"),c=t("./ComAI"),u=t("./subState/SubAIBehaviorTree"),p=t("./subState/SubAIControllable"),f=t("./subState/SubAIIdle"),h=t("./subState/SubAISeek"),y=t("./subState/SubAIWander"),d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tlComClazz=[c.ComAI],e.tmSub=new Array,e}return n(e,t),e.prototype.onRemoveEntity=function(e){this.ExitState(e),t.prototype.onRemoveEntity.call(this,e)},e.prototype.createSub=function(t,e,r){var o=t.collectClass(r);return this.tmSub[e]=o,o},e.prototype.onInit=function(t,e){this.createSub(e,c.ComAIType.IDLE,f.SubAIIdle),this.createSub(e,c.ComAIType.WANDER,y.SubAIWander),this.createSub(e,c.ComAIType.CONTROLLABLE,p.SubAIControllable),this.createSub(e,c.ComAIType.SEEK,h.SubAISeek),this.createSub(e,c.ComAIType.BEHAVIOR_TREE,u.SubAIBehaviorTree)},e.prototype.onDestroy=function(){t.prototype.onDestroy.call(this),this.ComAI=null,this.tmSub=null,this.tlComClazz=null},e.prototype.onUpdate=function(t){var e,r,o,n,i=this.ComAI.type,l=this.ComAI.nextType,s=this.ComAI.param,c=this.ComAI.nextParam,u=this.Battle,p=this.tmSub;try{for(var f=a(this.ids),h=f.next();!h.done;h=f.next()){var y=h.value,d=u.getRef(y),m=i[y],v=l[y],_=s[y],S=c[y];if(m!=v||_!=S){var g=p[m],b=p[v];g&&g.exit(d),i[y]=v,s[y]=S,b&&b.enter(d)}}}catch(M){e={error:M}}finally{try{h&&!h.done&&(r=f.return)&&r.call(f)}finally{if(e)throw e.error}}try{for(var C=a(this.tmSub),R=C.next();!R.done;R=C.next())R.value.Update(t)}catch(w){o={error:w}}finally{try{R&&!R.done&&(n=C.return)&&n.call(C)}finally{if(o)throw o.error}}},e.prototype.ExitState=function(t){var e=this.tmSub[this.ComAI.type[t]];if(e){var r=this.Battle.getRef(t);e.exit(r)}},e.prototype.onReceiveJoystick=function(t,e){this.tmSub[c.ComAIType.CONTROLLABLE].setParams(t,e)},e.__cname="SystemAI",i([l.injectField("ComAI")],e.prototype,"ComAI",void 0),i([l.injectField("Battle")],e.prototype,"Battle",void 0),e}(s.GroupSet);r.SystemAI=d,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../../../../../framework/ecs/GroupSet":void 0,"./ComAI":"ComAI","./subState/SubAIBehaviorTree":"SubAIBehaviorTree","./subState/SubAIControllable":"SubAIControllable","./subState/SubAIIdle":"SubAIIdle","./subState/SubAISeek":"SubAISeek","./subState/SubAIWander":"SubAIWander"}],SystemAsset:[function(t,e){"use strict";cc._RF.push(e,"50bbbbEUDZJk4/0elIo7vzl","SystemAsset"),cc._RF.pop()},{}],SystemBrocast:[function(t,e,r){"use strict";cc._RF.push(e,"d1c45Du7+5Dq4yLT0NWCHYX","SystemBrocast");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.SystemBrocast=void 0;var l=t("../../../../../../framework/container/Container"),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tlBrocast=[],e}return n(e,t),e.prototype.onDestroy=function(){this.container=null,this.tlBrocast=null},e.prototype.Send=function(t){var e=new t;return this.container.inject(e),this.tlBrocast.push(e),e},e.prototype.onUpdate=function(t){var e,r;try{for(var o=a(this.tlBrocast),n=o.next();!n.done;n=o.next())n.value.process(t)}catch(i){e={error:i}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}this.tlBrocast.splice(0)},e.__cname="SystemBrocast",i([l.injectField("Container")],e.prototype,"container",void 0),e}(t("../../base/BaseBattleSystem").BaseBattleSystem);r.SystemBrocast=s,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../base/BaseBattleSystem":"BaseBattleSystem"}],SystemBuffCarrier:[function(t,e,r){"use strict";cc._RF.push(e,"c82a3QIpD5OPKROIxsgVA2Y","SystemBuffCarrier");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.SystemBuffCarrier=void 0;var l=t("../../../../../../framework/container/Container"),s=t("../../base/BaseBattleGroupSet"),c=t("./ComBuffCarrier"),u=t("./effect/SBCEffectMgr"),p=t("./role/BuffCarrierBleed"),f=t("./role/BuffCarrierHandler"),h=t("./role/BuffCarrierInsectCoat"),y=t("./role/BuffCarrierJacket"),d=t("./role/BuffCarrierProtective"),m=t("./role/BuffCarrierReborn"),v=t("./role/BuffCarrierRebornEffect"),_=t("./role/BuffCarrierSlow"),S=t("./role/BuffCarrier_300060"),g=t("./role/BuffCarrier_300061"),b=t("./role/BuffCarrier_300070"),C=t("./role/BuffCarrier_300080"),R=t("./role/BuffCarrier_300090"),M=t("./role/BuffCarrier_300100"),w=t("./role/BuffCarrier_300101"),O=t("./role/BuffCarrier_300110"),B=t("./role/BuffCarrier_300111"),P=t("./role/BuffCarrier_300120"),G=t("./role/BuffCarrier_300130"),k=t("./role/BuffCarrier_300140"),x=t("./role/BuffCarrier_300150"),T=t("./role/BuffCarrier_300160"),j=t("./role/BuffCarrier_300161"),I=t("./role/BuffCarrier_300170"),D=t("./role/BuffCarrier_300180"),F=t("./role/BuffCarrier_300190"),L=t("./role/BuffCarrier_300200"),E=t("./role/BuffCarrier_300210"),A=t("./role/BuffCarrier_300220"),V=t("./role/BuffCarrier_300230"),U=t("./role/BuffCarrier_300240"),W=t("./role/BuffCarrier_300241"),H=t("./role/BuffCarrier_300250"),N=t("./role/BuffCarrier_300500"),q=t("./role/BuffCarrier_300520"),K=t("./role/BuffCarrier_300521"),X=t("./role/BuffCarrier_300530"),z=t("./role/BuffCarrier_300540"),J=t("./role/BuffCarrier_300550"),Y=t("./role/SubBuffCarrierMgr"),Z=t("./sub/SubSysBCTrigger"),Q=t("./sub/SubSysRoleStatus"),$=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tlComClazz=[c.ComBuffCarrier],e.tlId2Buff=new Map,e}return n(e,t),e.prototype.onInit=function(t,e){this.BuffCarrierHandlerMgr=new f.BuffCarrierHandlerMgr,this.SubBuffCarrierMgr=new Y.SubBuffCarrierMgr,this.SubBuffCarrierMgr.OnInit(e),this.SubBuffCarrierMgr.CreateSub("BuffCarrierBleed",p.BuffCarrierBleed),this.SubBuffCarrierMgr.CreateSub("BuffCarrierInsectCoat",h.BuffCarrierInsectCoat),this.SubBuffCarrierMgr.CreateSub("BuffCarrier_Slow",_.BuffCarrierSlow),this.SubBuffCarrierMgr.CreateSub("BuffCarrierJacket",y.BuffCarrierJacket),this.SubBuffCarrierMgr.CreateSub("BuffCarrierProtective",d.BuffCarrierProtective),this.SubBuffCarrierMgr.CreateSub("BuffCarrierReborn",m.BuffCarrierReborn),this.SubBuffCarrierMgr.CreateSub("BuffCarrierRebornEffect",v.BuffCarrierRebornEffect),this.SubBuffCarrierMgr.CreateSub("BuffCarrier_300060",S.BuffCarrier_300060),this.SubBuffCarrierMgr.CreateSub("BuffCarrier_300061",g.BuffCarrier_300061),this.SubBuffCarrierMgr.CreateSub("BuffCarrier_300070",b.BuffCarrier_300070),this.SubBuffCarrierMgr.CreateSub("BuffCarrier_300080",C.BuffCarrier_300080),this.SubBuffCarrierMgr.CreateSub("BuffCarrier_300090",R.BuffCarrier_300090),this.SubBuffCarrierMgr.CreateSub("BuffCarrier_300150",x.BuffCarrier_300150),this.SubBuffCarrierMgr.CreateSub("BuffCarrier_300100",M.BuffCarrier_300100),this.SubBuffCarrierMgr.CreateSub("BuffCarrier_300101",w.BuffCarrier_300101),this.SubBuffCarrierMgr.CreateSub("BuffCarrier_300140",k.BuffCarrier_300140),this.SubBuffCarrierMgr.CreateSub("BuffCarrier_300110",O.BuffCarrier_300110),this.SubBuffCarrierMgr.CreateSub("BuffCarrier_300111",B.BuffCarrier_300111),this.SubBuffCarrierMgr.CreateSub("BuffCarrier_300120",P.BuffCarrier_300120),this.SubBuffCarrierMgr.CreateSub("BuffCarrier_300130",G.BuffCarrier_300130),this.SubBuffCarrierMgr.CreateSub("BuffCarrier_300160",T.BuffCarrier_300160),this.SubBuffCarrierMgr.CreateSub("BuffCarrier_300161",j.BuffCarrier_300161),this.SubBuffCarrierMgr.CreateSub("BuffCarrier_300170",I.BuffCarrier_300170),this.SubBuffCarrierMgr.CreateSub("BuffCarrier_300180",D.BuffCarrier_300180),this.SubBuffCarrierMgr.CreateSub("BuffCarrier_300190",F.BuffCarrier_300190),this.SubBuffCarrierMgr.CreateSub("BuffCarrier_300200",L.BuffCarrier_300200),this.SubBuffCarrierMgr.CreateSub("BuffCarrier_300210",E.BuffCarrier_300210),this.SubBuffCarrierMgr.CreateSub("BuffCarrier_300220",A.BuffCarrier_300220),this.SubBuffCarrierMgr.CreateSub("BuffCarrier_300230",V.BuffCarrier_300230),this.SubBuffCarrierMgr.CreateSub("BuffCarrier_300240",U.BuffCarrier_300240),this.SubBuffCarrierMgr.CreateSub("BuffCarrier_300241",W.BuffCarrier_300241),this.SubBuffCarrierMgr.CreateSub("BuffCarrier_300250",H.BuffCarrier_300250),this.SubBuffCarrierMgr.CreateSub("BuffCarrier_300500",N.BuffCarrier_300500),this.SubBuffCarrierMgr.CreateSub("BuffCarrier_300520",q.BuffCarrier_300520),this.SubBuffCarrierMgr.CreateSub("BuffCarrier_300521",K.BuffCarrier_300521),this.SubBuffCarrierMgr.CreateSub("BuffCarrier_300530",X.BuffCarrier_300530),this.SubBuffCarrierMgr.CreateSub("BuffCarrier_300540",z.BuffCarrier_300540),this.SubBuffCarrierMgr.CreateSub("BuffCarrier_300550",J.BuffCarrier_300550),this.SBCEffectMgr=new u.SBCEffectMgr(e),this.SubSysRoleStatus=this.AddSubSystem(Q.SubSysRoleStatus),this.SubSysBCTrigger=this.AddSubSystem(Z.SubSysBCTrigger)},e.prototype.onRelease=function(){this.SBCEffectMgr.destroy(),this.SubBuffCarrierMgr.destroy(),this.BuffCarrierHandlerMgr.Destroy()},e.prototype.onStart=function(){this.SubBuffCarrierMgr.OnStart()},e.prototype.onUpdate=function(t){this.SubBuffCarrierMgr.OnUpdate(t),this.SubSysBCTrigger.OnUpdate(t),this.SubSysRoleStatus.OnUpdate(t)},e.prototype.onAddEntity=function(e){this.SubSysRoleStatus.OnAddEntity(e),t.prototype.onAddEntity.call(this,e)},e.prototype.onRemoveEntity=function(e){this.ClearHandler(e),this.SubSysRoleStatus.OnRemoveEntity(e),t.prototype.onRemoveEntity.call(this,e)},e.prototype.HandlerBuff=function(t){var e,r,o=t.resId,n=this.ModelSkill.GetBuffCarrier(o);t.ref=n;var i=this.SubBuffCarrierMgr.GetSub(n.GetScript());if(i){var l=i.GetTarget(t),s=[];try{for(var c=a(l),u=c.next();!u.done;u=c.next()){var p=u.value,h=f.BuffCarrierHandler.Create(t.sender,p,t.resId);h.Copy(t),h.target=p,this.AddHandler(h),s.push(h)}}catch(y){e={error:y}}finally{try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(e)throw e.error}}return s}},e.prototype.AddHandler=function(t){t.resId;var e=t.ref.GetScript();this.SubBuffCarrierMgr.GetSub(e).AddEntity(t),this.SubBuffCarrierMgr.CheckSubEnable(e);var r=t.target;this.GetTlBuff(r).add(t)},e.prototype.DeleteHandler=function(t){if(!this.destroyed){t.resId;var e=t.ref.GetScript();this.SubBuffCarrierMgr.GetSub(e).RemoveEntity(t),this.SubBuffCarrierMgr.CheckSubEnable(e);var r=t.target;this.GetTlBuff(r).delete(t)}},e.prototype.ClearHandler=function(t){var e,r,o=this.GetTlBuff(t);try{for(var n=a(o),i=n.next();!i.done;i=n.next()){var l=i.value;this.DeleteHandler(l)}}catch(s){e={error:s}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}},e.prototype.AddRoleStatus=function(t,e){this.SubSysRoleStatus.AddRoleStatusRef(t,e)},e.prototype.RemoveRoleStatus=function(t,e){this.SubSysRoleStatus.RemoveRoleStatusRef(t,e)},e.prototype.GetEffect=function(t){return this.SBCEffectMgr.GetEffect(t)},e.prototype.GetTlBuff=function(t){var e=this.tlId2Buff.get(t);return null==e&&(e=new Set,this.tlId2Buff.set(t,e)),e},e.__cname="SystemBuffCarrier",i([l.injectField("ModelSkill")],e.prototype,"ModelSkill",void 0),e}(s.BaseBattleGroupSet);r.SystemBuffCarrier=$,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../base/BaseBattleGroupSet":"BaseBattleGroupSet","./ComBuffCarrier":"ComBuffCarrier","./effect/SBCEffectMgr":"SBCEffectMgr","./role/BuffCarrierBleed":"BuffCarrierBleed","./role/BuffCarrierHandler":"BuffCarrierHandler","./role/BuffCarrierInsectCoat":"BuffCarrierInsectCoat","./role/BuffCarrierJacket":"BuffCarrierJacket","./role/BuffCarrierProtective":"BuffCarrierProtective","./role/BuffCarrierReborn":"BuffCarrierReborn","./role/BuffCarrierRebornEffect":"BuffCarrierRebornEffect","./role/BuffCarrierSlow":"BuffCarrierSlow","./role/BuffCarrier_300060":"BuffCarrier_300060","./role/BuffCarrier_300061":"BuffCarrier_300061","./role/BuffCarrier_300070":"BuffCarrier_300070","./role/BuffCarrier_300080":"BuffCarrier_300080","./role/BuffCarrier_300090":"BuffCarrier_300090","./role/BuffCarrier_300100":"BuffCarrier_300100","./role/BuffCarrier_300101":"BuffCarrier_300101","./role/BuffCarrier_300110":"BuffCarrier_300110","./role/BuffCarrier_300111":"BuffCarrier_300111","./role/BuffCarrier_300120":"BuffCarrier_300120","./role/BuffCarrier_300130":"BuffCarrier_300130","./role/BuffCarrier_300140":"BuffCarrier_300140","./role/BuffCarrier_300150":"BuffCarrier_300150","./role/BuffCarrier_300160":"BuffCarrier_300160","./role/BuffCarrier_300161":"BuffCarrier_300161","./role/BuffCarrier_300170":"BuffCarrier_300170","./role/BuffCarrier_300180":"BuffCarrier_300180","./role/BuffCarrier_300190":"BuffCarrier_300190","./role/BuffCarrier_300200":"BuffCarrier_300200","./role/BuffCarrier_300210":"BuffCarrier_300210","./role/BuffCarrier_300220":"BuffCarrier_300220","./role/BuffCarrier_300230":"BuffCarrier_300230","./role/BuffCarrier_300240":"BuffCarrier_300240","./role/BuffCarrier_300241":"BuffCarrier_300241","./role/BuffCarrier_300250":"BuffCarrier_300250","./role/BuffCarrier_300500":"BuffCarrier_300500","./role/BuffCarrier_300520":"BuffCarrier_300520","./role/BuffCarrier_300521":"BuffCarrier_300521","./role/BuffCarrier_300530":"BuffCarrier_300530","./role/BuffCarrier_300540":"BuffCarrier_300540","./role/BuffCarrier_300550":"BuffCarrier_300550","./role/SubBuffCarrierMgr":"SubBuffCarrierMgr","./sub/SubSysBCTrigger":"SubSysBCTrigger","./sub/SubSysRoleStatus":"SubSysRoleStatus"}],SystemBuff:[function(t,e,r){"use strict";cc._RF.push(e,"cf2ddtAoXhBe6XQKw6FFNZ2","SystemBuff");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.SystemBuff=void 0;var l=t("../../../../../../framework/container/Container"),s=t("../../../../../../framework/FW"),c=t("../../../../../../framework/utils/Toolset"),u=t("../../../../../ref/RefBuff"),p=t("../../base/BaseBattleSystem"),f=t("../event/SystemEvent"),h=t("./BattleBuffBehaviorMgr"),y=t("./BattleBuffProxy"),d=t("./BuffVar"),m=t("./custom/BattleAttrBehavior"),v=t("./custom/BattleBuff_201104"),_=t("./custom/BattleBuff_201304"),S=t("./custom/BattleBuff_201503"),g=t("./custom/BattleBuff_201504"),b=t("./custom/BattleDoAddBuff"),C=t("./custom/BattleSkillAttrBehavior"),R=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tmBuffProxy=new Map,e.tlApply=new Set,e.tmBehavior=new Map,e}return n(e,t),e.prototype.onInit=function(){this.toolSet=c.ToolSet.createToolSet(),this.InitBuffVar()},e.prototype.onRelease=function(){this.ReleaseBuffVar(),this.BuffProxyMgr.destroy(),this.tmBuffProxy.clear(),c.ToolSet.destroyToolSet(this.toolSet)},e.prototype.onStart=function(){var t=this.container;this.BuffBehaviorMgr=h.BattleBuffBehaviorMgr.Create(t),this.BuffProxyMgr=y.BattleBuffProxyMgr.Create(t,this.BuffBehaviorMgr),this.InitBuff(),this.BuffBehaviorMgr.Start(),this.EnterBuffVar(),this.InitEquipBuff(),this.InitEvent()},e.prototype.Update=function(t){this.UpdateTlApply(),this.BuffBehaviorMgr&&this.BuffBehaviorMgr.Update(t)},e.prototype.GetBuffProxyMgr=function(){return this.BuffProxyMgr},e.prototype.AddSkillGroupId=function(t){this.RemoveSkillGroupId(t);var e=this.BuffProxyMgr.CreateProxy();this.tmBuffProxy.set(t,e),e.SetSkillGroupId(t),this.PushTlApply(e)},e.prototype.RemoveSkillGroupId=function(t){var e=this.tmBuffProxy;if(e.has(t)){var r=e.get(t);this.BuffProxyMgr.DestroyProxy(r),e.delete(t)}},e.prototype.PushTlApply=function(t){this.tlApply.add(t)},e.prototype.UpdateTlApply=function(){var t,e;try{for(var r=a(this.tlApply),o=r.next();!o.done;o=r.next())o.value.Apply()}catch(n){t={error:n}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}this.tlApply.clear()},e.prototype.InitEquipBuff=function(){var t,e,r=this.Battle.startConfig.buffs;if(r){try{for(var o=a(r),n=o.next();!n.done;n=o.next()){var i=n.value;i&&this.AddSkillGroupId(i)}}catch(l){t={error:l}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}s.FW.ZJJ.log("buff proxy",this.tmBuffProxy)}},e.prototype.InitBuffVar=function(){this.BuffVarMgr=new d.BuffVarMgr,this.container.collectObj(this.BuffVarMgr)},e.prototype.EnterBuffVar=function(){this.container.inject(this.BuffVarMgr)},e.prototype.ReleaseBuffVar=function(){this.BuffVarMgr.destroy()},e.prototype.InitBuff=function(){var t=this.BuffBehaviorMgr;t.SetBuffByType("1001",m.BattleAttrBehavior),t.SetBuffByType("250007",m.BattleAttrBehavior),t.SetBuffByType("1013",C.BattleSkillAttrBehavior),t.SetBuffByType("1009",b.BattleDoAddBuff),t.SetBuffByType("201104",v.BattleBuff_201104),t.SetBuffByType("201503",S.BattleBuff_201503),t.SetBuffByType("201504",g.BattleBuff_201504),t.SetBuffByType("201304",_.BattleBuff_201304)},e.prototype.SetBehavior=function(t){this.assert(0==this.tmBehavior.has(t),"\u91cd\u590d\u6ce8\u518c");var e=new t;this.tmBehavior.set(t,e)},e.prototype.GetBehavior=function(t){return this.tmBehavior.get(t)},e.prototype.InitEvent=function(){this.toolSet.addListener(this.SystemEvent.GetEventPorxy(),f.EBattleEvent.KillMonster,this.OnKillMonster,this)},e.prototype.OnKillMonster=function(){var t=u.RefBuffTriggerType.KillMonster;this.BuffBehaviorMgr.SendTriggerEvent(t,null)},e.__cname="SystemBuff",i([l.injectField("Battle")],e.prototype,"Battle",void 0),i([l.injectField("SystemEvent")],e.prototype,"SystemEvent",void 0),i([l.injectField("Ref")],e.prototype,"Ref",void 0),e}(p.BaseBattleSystem);r.SystemBuff=R,cc._RF.pop()},{"../../../../../../framework/FW":void 0,"../../../../../../framework/container/Container":void 0,"../../../../../../framework/utils/Toolset":void 0,"../../../../../ref/RefBuff":"RefBuff","../../base/BaseBattleSystem":"BaseBattleSystem","../event/SystemEvent":"SystemEvent","./BattleBuffBehaviorMgr":"BattleBuffBehaviorMgr","./BattleBuffProxy":"BattleBuffProxy","./BuffVar":"BuffVar","./custom/BattleAttrBehavior":"BattleAttrBehavior","./custom/BattleBuff_201104":"BattleBuff_201104","./custom/BattleBuff_201304":"BattleBuff_201304","./custom/BattleBuff_201503":"BattleBuff_201503","./custom/BattleBuff_201504":"BattleBuff_201504","./custom/BattleDoAddBuff":"BattleDoAddBuff","./custom/BattleSkillAttrBehavior":"BattleSkillAttrBehavior"}],SystemCamera:[function(t,e,r){"use strict";cc._RF.push(e,"4eca1VsTT5FZ646PKKRl36U","SystemCamera");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.SystemCamera=void 0;var l=t("../../../../../../framework/coord/Coord"),s=t("../BaseViewSystem"),c=t("./SubSysCameraFollow"),u=t("./SubSysCameraZoom"),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.cameraBound=new cc.Rect,e._cameraRate=1,e}return n(e,t),Object.defineProperty(e.prototype,"sceneWidth",{get:function(){return l.Coord.logicSize.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sceneHeight",{get:function(){return l.Coord.logicSize.height},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cameraRate",{get:function(){return l.Coord.cameraRate},enumerable:!1,configurable:!0}),e.prototype.onInit=function(){var t=this,e=cc.Camera.main;this.camera=e.getComponent(cc.Camera),this.viewMask=this.camera.node.getChildByName("viewMask"),this.viewMask.active=!1,cc.view.setResizeCallback(function(){t.refershCameraViewSize()}),this.refershCameraViewSize(),this.AddSubSystem(c.SubSysCameraFollow),this.AddSubSystem(u.SubSysCameraZoom)},e.prototype.refershCameraViewSize=function(){var t=cc.winSize.height/cc.winSize.width;this.camera.alignWithScreen=!1;var e=t>2?665:575;this.camera.orthoSize=e},e.prototype.onDestroy=function(){l.Coord.cameraRate=1},e.prototype.beforeStartAsync=function(){return i(this,void 0,Promise,function(){return a(this,function(){return[2]})})},e.prototype.onStart=function(){},e.prototype.onRelease=function(){},e.prototype.onUpdate=function(){},e.prototype.SetCameraRate=function(t){this._cameraRate=t,this.OnCameraRateChanged()},e.prototype.SetViewMask=function(t,e){if(t){this.viewMask.active=!0;var r=this.viewMask.getComponent(cc.Sprite).getMaterial(0),o=e/this.viewMask.width;r.setProperty("radius",o)}else this.viewMask.active=!1},e.prototype.OnCameraRateChanged=function(){l.Coord.cameraRate=this._cameraRate},e.__cname="SystemCamera",e}(s.BaseViewSystem);r.SystemCamera=p,Object.assign(cc.Camera.prototype,{beforeDraw:function(){if(this._camera){if(this._alignWithScreen)this._onAlignWithScreen();else{var t=this._fov*cc.macro.RAD;this.node.z=2*this._orthoSize/(2*Math.tan(t/2)),t=2*Math.atan(Math.tan(t/2)/this.zoomRatio),this._camera.setFov(t),this._camera.setOrthoHeight(this._orthoSize/this.zoomRatio)}this._camera.dirty=!0}}}),cc._RF.pop()},{"../../../../../../framework/coord/Coord":void 0,"../BaseViewSystem":"BaseViewSystem","./SubSysCameraFollow":"SubSysCameraFollow","./SubSysCameraZoom":"SubSysCameraZoom"}],SystemCollision:[function(t,e,r){"use strict";cc._RF.push(e,"1f375oz3t5P87fgcaofO6Tw","SystemCollision");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.SystemCollision=void 0;var l=t("../../../../../../framework/container/Container"),s=t("../../../../../../framework/ecs/GroupSet"),c=t("../move/ComPos"),u=t("../type/ComType"),p=t("./ComCollision"),f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tlComClazz=[p.ComCollision,c.ComPos],e.temp=[],e._v_monster=new cc.Vec2,e}return n(e,t),e.prototype.onInit=function(){},e.prototype.onDestroy=function(){t.prototype.onDestroy.call(this)},e.prototype.onAddEntity=function(){},e.prototype.onRemoveEntity=function(){},e.prototype.onUpdate=function(){this.ComCollision.ResetCollide(),this.updatePlayer(),this.updateBullet(),this.updateMonster()},e.prototype.updateBullet=function(){var t,e,r,o,n=this.SystemMove,i=this.ComPos.x,l=this.ComPos.y,s=this.ComCollision.r,c=this.ComVar.CAMP,p=(this.ComVar.BULLET_KILLER,this.ComType),f=this.ComCollision.colliding,h=this.ComCollision.collisons,y=this.ComType.GetGroup(u.EComType.Bullet),d=this.temp;try{for(var m=a(y),v=m.next();!v.done;v=m.next()){var _=v.value;d.length=0,n.findOtherCamp(c[_],i[_],l[_],s[_],d,_);try{for(var S=(r=void 0,a(d)),g=S.next();!g.done;g=S.next()){var b=g.value;if(this.isCollided(_,b)){var C=p.GetType(b);if(C==u.EComType.Bullet&&0==this.ComVar.CheckBulletCollision(_,b))continue;if(10013==this.ComVar.BULLET_SKILL[_]&&C==u.EComType.Monster){var R=this.ComVar.CalHeroAttr("s7026",1);R>1&&(this.ComVar.HURT_ADD[b]=R)}f[_]=!0,f[b]=!0,h[_].add(b)}else this.ComVar.HURT_ADD[b]=0}}catch(M){r={error:M}}finally{try{g&&!g.done&&(o=S.return)&&o.call(S)}finally{if(r)throw r.error}}}}catch(w){t={error:w}}finally{try{v&&!v.done&&(e=m.return)&&e.call(m)}finally{if(t)throw t.error}}},e.prototype.updateMonster=function(){this.SystemMove;var t=this.ComPos.x,e=this.ComPos.y,r=(this.ComCollision.r,this.ComVar.CAMP,this._v_monster),o=this.ComVar.MONSTER_COLLID,n=this.ComCollision.colliding,i=(this.ComCollision.collisons,this.ComCollision.collisionsMonster),a=this.ComType.GetGroup(u.EComType.Monster);t:for(var l=0;l<a.length;l++)for(var s=l+1;s<a.length;s++){if(0==o[l])continue t;if(0!=o[s]){var c=a[l],p=a[s];if(this.isCollided(c,p)){n[c]=!0,n[p]=!0;var f=0==i[c].has(p);if(i[c].add(p),i[p].add(c),f){r.x=t[p]-t[c],r.y=e[p]-e[c];var h=Math.atan2(r.y,r.x);t[c]+=1.5*Math.cos(h),e[c]+=1.5*Math.cos(h),r.x=t[c]-t[p],r.y=e[c]-e[p],h=Math.atan2(r.y,r.x),t[c]+=1.5*Math.cos(h),e[c]+=1.5*Math.cos(h)}}}}},e.prototype.updatePlayer=function(){var t,e,r,o,n=this.SystemMove,i=this.ComPos.x,l=this.ComPos.y,s=this.ComCollision.r,c=this.ComVar.CAMP,p=this.ComCollision.colliding,f=this.ComCollision.collisons,h=this.ComCollision.collisionsMonster,y=this.ComType.GetGroup(u.EComType.Player),d=this.temp;this.ComType;try{for(var m=a(y),v=m.next();!v.done;v=m.next()){var _=v.value;d.length=0,n.findOtherCampNoBullet(c[_],i[_],l[_],s[_],d);try{for(var S=(r=void 0,a(d)),g=S.next();!g.done;g=S.next()){var b=g.value;this.isCollided(_,b)&&(p[_]=!0,p[b]=!0,f[_].add(b),h[_].add(b),h[b].add(_))}}catch(C){r={error:C}}finally{try{g&&!g.done&&(o=S.return)&&o.call(S)}finally{if(r)throw r.error}}}}catch(R){t={error:R}}finally{try{v&&!v.done&&(e=m.return)&&e.call(m)}finally{if(t)throw t.error}}},e.prototype.isCollided=function(t,e){var r=this.ComCollision.customCollided,o=this.ComCollision.customCaller;if(r[t]){var n=o[t];return r[t].call(n,t,e)}return this.isCircleCollided(t,e)},e.prototype.isCircleCollided=function(t,e){var r=this.ComPos.x,o=this.ComPos.y,n=this.ComCollision.r,i=this.ComCollision.activeCollision;if(0==i[t]||0==i[e])return!1;var a=(n[t]+n[e])*(n[t]+n[e]),l=r[e]-r[t],s=o[e]-o[t];return l*l+s*s<=a},e.__cname="SystemCollision",i([l.injectField("ComCollision")],e.prototype,"ComCollision",void 0),i([l.injectField("ComPos")],e.prototype,"ComPos",void 0),i([l.injectField("ComType")],e.prototype,"ComType",void 0),i([l.injectField("ComVar")],e.prototype,"ComVar",void 0),i([l.injectField("ComState")],e.prototype,"ComState",void 0),i([l.injectField("ComVelocity")],e.prototype,"ComVelocity",void 0),i([l.injectField("SystemMove")],e.prototype,"SystemMove",void 0),i([l.injectField("SystemMap")],e.prototype,"SystemMap",void 0),i([l.injectField("SystemRole")],e.prototype,"SystemRole",void 0),e}(s.GroupSet);r.SystemCollision=f,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../../../../../framework/ecs/GroupSet":void 0,"../move/ComPos":"ComPos","../type/ComType":"ComType","./ComCollision":"ComCollision"}],SystemCommon:[function(t,e,r){"use strict";cc._RF.push(e,"b74acWvHZxKT6XAxybIHYbC","SystemCommon");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.SystemCommon=r.EBProp=void 0;var s,c=t("../../../../../../framework/FW"),u=t("../../../../../../framework/container/Container"),p=t("../../../../../../framework/tween/TweenEase"),f=t("../../../../../../framework/utils/Toolset"),h=t("../../../utils/UIDGenerator"),y=t("../BaseLogicSystem"),d=t("../event/SystemEvent"),m=t("./BPropBoom"),v=t("./BPropExpBall"),_=t("./BPropGold"),S=t("./BPropGoldChest"),g=t("./BPropItem"),b=t("./BPropMagnet"),C=t("./BPropRestore"),R=t("./BPropSkillChest"),M=t("./BPropVulcan"),w=t("./ChestMgr"),O=t("./PropMgr");(function(t){t[t.NONE=0]="NONE",t[t.RESTORE=1]="RESTORE",t[t.MAGNET=2]="MAGNET",t[t.EXPBALL=3]="EXPBALL",t[t.GOLD=4]="GOLD",t[t.GOLD_CHEST=5]="GOLD_CHEST",t[t.SKILL_CHEST=6]="SKILL_CHEST",t[t.BOOM=7]="BOOM",t[t.ITEM=8]="ITEM",t[t.Vulcan=9]="Vulcan"})(s=r.EBProp||(r.EBProp={}));var B=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tmSub=new Map,e.idpool=new h.UIDGenerator,e.dropIds=[],e.temp=[],e.tmList=[],e._chest=[],e}return n(e,t),e.prototype.onInit=function(){this.toolSet=f.ToolSet.createToolSet()},e.prototype.onDestroy=function(){f.ToolSet.destroyToolSet(this.toolSet),this.PropMgr.destroy()},e.prototype.onStart=function(){var t=this;this.CreteSub(v.BPropExpBall),this.CreteSub(C.BPropRestore),this.CreteSub(b.BPropMagnet),this.CreteSub(_.BPropGold),this.CreteSub(S.BPropGoldChest),this.CreteSub(R.BPropSkillChest),this.CreteSub(m.BPropBoom),this.CreteSub(g.BPropItem),this.CreteSub(M.BPropVulcan),this.posData=new G(this.SystemMap.gridSize),this.PropMgr=new O.PropMgr,this.container.inject(this.PropMgr),this.ChestMgr=new w.ChestMgr,this.container.inject(this.ChestMgr),this.toolSet.addListener(this.SystemEvent.GetEventPorxy(),d.EBattleEvent.KillMonster,function(e){t.ComVar.BOSS_COPY.includes(e)||(t.handlerMonsterDrop(e),t.dropIds.length>0&&(t.dropIds.forEach(function(r){t.monsterDrop(r,e)}),t.dropIds=[]))}),this.toolSet.addListener(this.SystemEvent.GetEventPorxy(),d.EBattleEvent.KillBox,function(e){t.handlerBox(e)}),this.toolSet.addListener(this.SystemEvent.GetEventPorxy(),d.EBattleEvent.FirstGoldChest,function(e){t.Battle.startConfig.notDropGold||t.handlerFirstGoldChest(e)},this),this.toolSet.addListener(this.SystemEvent.GetEventPorxy(),d.EBattleEvent.StartDrop,function(e,r,o){t.handlerStartDrop(e,r,o)}),this.toolSet.addListener(this.SystemEvent.GetEventPorxy(),d.EBattleEvent.BossNodeChest,function(){t.handlerBossNodeSkillChest()},this)},e.prototype.onUpdate=function(t){this.updateChest(t),this.updateProp(t)},e.prototype.updateChest=function(t){var e,r,o=this.ComVar.HEROID,n=this.ComPos.x[o],i=this.ComPos.y[o],l=this.ComCollision.r[o],s=this._chest;s.length=0;var c=l+40;this.ChestMgr.findNear(n,i,c,s);try{for(var u=a(s),p=u.next();!p.done;p=u.next()){var f=p.value;this.ChestMgr.pickChest(f)}}catch(h){e={error:h}}finally{try{p&&!p.done&&(r=u.return)&&r.call(u)}finally{if(e)throw e.error}}this.ChestMgr.updatePick(t)},e.prototype.updateProp=function(t){var e,r,o,n,i,l,s=this.ComVar.HEROID,c=this.ComPos.x[s],u=this.ComPos.y[s],f=this.ComVar.PICK_RANGE[s],h=this.temp;h.length=0,this.PropMgr.findNear(c,u,f,h);try{for(var y=a(h),d=y.next();!d.done;d=y.next()){var m=d.value;this.PropMgr.pickProp(m)}}catch(T){e={error:T}}finally{try{d&&!d.done&&(r=y.return)&&r.call(y)}finally{if(e)throw e.error}}var v=this.posData.x,_=this.posData.y,S=this.PropMgr.ani_during,g=this.PropMgr.ani_time,b=this.PropMgr.ani_sx,C=this.PropMgr.ani_sy,R=this.tmList;R.length=0;try{for(var M=a(this.PropMgr.picks),w=M.next();!w.done;w=M.next())if(g[m=w.value]>=S)this.PropMgr.takeProp(m),R.push(m);else{g[m]+=t;var O=g[m],B=b[m],P=c-b[m],G=S;v[m]=p.TweenEase.Back.easeIn(O,B,P,G),O=g[m],B=C[m],P=u-C[m],G=S,_[m]=p.TweenEase.Back.easeIn(O,B,P,G)}}catch(j){o={error:j}}finally{try{w&&!w.done&&(n=M.return)&&n.call(M)}finally{if(o)throw o.error}}try{for(var k=a(R),x=k.next();!x.done;x=k.next())m=x.value,this.PropMgr.destroyProp(m)}catch(I){i={error:I}}finally{try{x&&!x.done&&(l=k.return)&&l.call(k)}finally{if(i)throw i.error}}R.length=0},e.prototype.handlerMonsterDrop=function(t){var e,r,o=this.ComVar.takeMonsterDrop(t);if(o){var n=this.ComPos.x,i=this.ComPos.y;try{for(var c=a(o),u=c.next();!u.done;u=c.next()){var p=u.value;if(this.Battle.startConfig.notDropGold){var f=(v=p.ref).GetType();if(f==s.GOLD||f==s.GOLD_CHEST)continue}var h=l(this.RandomPos(n[t],i[t]),2),y=h[0],d=h[1];this.createPropOrChest(p.ref,p.value,y,d)}}catch(_){e={error:_}}finally{try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(e)throw e.error}}if(Math.random()+1<=this.ComVar.MONSTER_HP_DROP){var m=l(this.RandomPos(n[t],i[t]),2),v=(y=m[0],d=m[1],this.ModelBattleDrop.GetReward(101));this.createPropOrChest(v,100,y,d)}}},e.prototype.createPropOrChest=function(t,e,r,o){var n=l(this.SystemMove.fixPos(r,o),2),i=n[0],a=n[1];t.GetType()==s.SKILL_CHEST||t.GetType()==s.GOLD_CHEST?this.ChestMgr.createChest(t,e,i,a):this.PropMgr.createProp(t,e,i,a)},e.prototype.RandomPos=function(t,e){var r=Math.random()*Math.PI*2,o=50+50*Math.random(),n=t+Math.cos(r)*o,i=e+Math.sin(r)*o,a=l(this.SystemMove.fixMapPos(n,i),2);return[a[0],a[1]]},e.prototype.handlerBox=function(t){var e,r,o=this.ComVar.takeBox(t);if(c.FW.ZJJ.log("[\u9676\u7f50"+t+"] \u6389\u843d\uff1a"+JSON.stringify(o)),o){var n=this.ComPos.x,i=this.ComPos.y;try{for(var u=a(o),p=u.next();!p.done;p=u.next()){var f=p.value;if(!this.Battle.startConfig.notDropGold||f.ref.GetType()!=s.GOLD){var h=l(this.RandomPos(n[t],i[t]),2),y=h[0],d=h[1];this.createPropOrChest(f.ref,f.value,y,d)}}}catch(m){e={error:m}}finally{try{p&&!p.done&&(r=u.return)&&r.call(u)}finally{if(e)throw e.error}}}},e.prototype.handlerFirstGoldChest=function(t){var e=this.ComVar.HEROID,r=this.ComPos.x,o=this.ComPos.y,n=r[e],i=o[e]+500,a=l(this.SystemMove.fixPos(n,i),2),s=a[0],c=a[1],u=this.Battle.startConfig.fubenId,p=this.SystemSpawn.GetPoint(),f=this.ModelBattleDrop.GetDropPlanBy(u,p);if(f){var h=f.GetGoldChestProp(),y=this.ModelBattleDrop.GetReward(h);this.createPropOrChest(y,t,s,c)}},e.prototype.handlerBossNodeSkillChest=function(){var t=this.ComVar.HEROID,e=this.ComPos.x,r=this.ComPos.y,o=e[t],n=r[t]+400,i=l(this.RandomPos(o,n),2),a=i[0],s=i[1],c=this.ModelBattleDrop.GetReward(105);this.createPropOrChest(c,1001,a,s);var u=r[t]+300,p=l(this.RandomPos(o,u),2),f=p[0],h=p[1],y=this.ModelBattleDrop.GetReward(104);this.createPropOrChest(y,8001,f,h)},e.prototype.handlerStartDrop=function(t,e,r){for(var o=this.ComVar.HEROID,n=this.ComPos.x,i=this.ComPos.y,a=this.ModelBattleDrop.GetReward(t),l=0;l<e;l++){var s=.2*r+.8*Math.random()*r,c=Math.random()*Math.PI*2,u=n[o]+Math.cos(c)*s,p=i[o]+Math.sin(c)*s;this.createPropOrChest(a,a.GetValue(),u,p)}},e.prototype.handlerDebug=function(t,e){var r=this.ModelBattleDrop.GetReward(t);if(r){var o=this.ComPos.x,n=this.ComPos.y,i=this.ComVar.HEROID,a=Math.random()*Math.PI*2,l=o[i]+120*Math.cos(a),s=n[i]+120*Math.sin(a),c=e||r.GetValue();this.createPropOrChest(r,c,l,s)}},e.prototype.CreteSub=function(t){var e=new t;this.tmSub.set(e.type,e),this.container.inject(e)},e.prototype.GetSub=function(t){return this.tmSub.get(t)},e.prototype.pickAllOfType=function(t){var e,r,o=this.tmSub.get(t);try{for(var n=a(o.ids),i=n.next();!i.done;i=n.next()){var l=i.value;this.PropMgr.pickProp(l)}}catch(s){e={error:s}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}},e.prototype.handleBattleDrop=function(t,e,r){var o=this;this.dropIds||(this.dropIds=[]),e.forEach(function(e){2==t?o.monsterDrop(e,r):o.dropIds.push(e)})},e.prototype.monsterDrop=function(t,e){var r=this.Ref.RefMgritem.getRef("resId",t);if(r){var o=this.ComPos.x[e],n=this.ComPos.y[e],i=l(this.RandomPos(o,n),2),a=i[0],s=i[1];this.PropMgr.createItemProp(r,1,a,s)}},e.__cname="SystemCommon",i([u.injectField("ComVar")],e.prototype,"ComVar",void 0),i([u.injectField("ComPos")],e.prototype,"ComPos",void 0),i([u.injectField("ComCollision")],e.prototype,"ComCollision",void 0),i([u.injectField("SystemEvent")],e.prototype,"SystemEvent",void 0),i([u.injectField("SystemRole")],e.prototype,"SystemRole",void 0),i([u.injectField("SystemMap")],e.prototype,"SystemMap",void 0),i([u.injectField("SystemSpawn")],e.prototype,"SystemSpawn",void 0),i([u.injectField("SystemMove")],e.prototype,"SystemMove",void 0),i([u.injectField("ModelBattleDrop")],e.prototype,"ModelBattleDrop",void 0),i([u.injectField("Battle")],e.prototype,"Battle",void 0),i([u.injectField("Ref")],e.prototype,"Ref",void 0),e}(y.BaseLogicSystem);r.SystemCommon=B;var P=function(){this.ids=new Set},G=function(){function t(t){this.x=[],this.y=[],this.gx=[],this.gy=[],this.model=[],this.loaded=[],this.order=[],this.grids=[],this.gridsize=t}return t.prototype.setupXY=function(t,e,r){this.x[t]=e,this.y[t]=r,this.upsetGrid(t);var o=this.gridsize,n=Math.floor(e/o),i=Math.floor(r/o);this.gx[t]=n,this.gy[t]=i,this.getGrid(n,i).ids.add(t)},t.prototype.upsetXY=function(t){this.upsetGrid(t),this.x[t]=0,this.y[t]=0},t.prototype.upsetGrid=function(t){var e=this.gx[t],r=this.gy[t];(e||r)&&this.getGrid(e,r).ids.delete(t)},t.prototype.getGrid=function(t,e){var r=this.grids,o=r[t]||(r[t]=[]);return o[e]||(o[e]=new P)},t}();cc._RF.pop()},{"../../../../../../framework/FW":void 0,"../../../../../../framework/container/Container":void 0,"../../../../../../framework/tween/TweenEase":void 0,"../../../../../../framework/utils/Toolset":void 0,"../../../utils/UIDGenerator":"UIDGenerator","../BaseLogicSystem":"BaseLogicSystem","../event/SystemEvent":"SystemEvent","./BPropBoom":"BPropBoom","./BPropExpBall":"BPropExpBall","./BPropGold":"BPropGold","./BPropGoldChest":"BPropGoldChest","./BPropItem":"BPropItem","./BPropMagnet":"BPropMagnet","./BPropRestore":"BPropRestore","./BPropSkillChest":"BPropSkillChest","./BPropVulcan":"BPropVulcan","./ChestMgr":"ChestMgr","./PropMgr":"PropMgr"}],SystemDamageText:[function(t,e,r){"use strict";cc._RF.push(e,"753fdPDMhlFrp9ZGeWJ/wme","SystemDamageText");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.SystemDamageText=void 0;var a=t("../../../../../framework/container/Container"),l=t("../../../../../framework/ecs/GroupSet"),s=t("../../../../../framework/utils/Toolset"),c=t("../logic/event/SystemEvent"),u=t("../logic/move/ComPos"),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tlComClazz=[u.ComPos],e}return n(e,t),e.prototype.onInit=function(t,e){this.container=e,this.toolSet=s.ToolSet.createToolSet()},e.prototype.onDestroy=function(){s.ToolSet.destroyToolSet(this.toolSet)},e.prototype.onStart=function(){var t=this;this.toolSet.addListener(this.SystemEvent.GetEventPorxy(),c.EBattleEvent.DamageText,function(e,r){t.LayerBattleDamageText.PushToTask(e,r)}),this.LayerBattleDamageText.load()},e.__cname="SystemDamageText",i([a.injectField("SystemEvent")],e.prototype,"SystemEvent",void 0),i([a.injectField("LayerBattleDamageText")],e.prototype,"LayerBattleDamageText",void 0),e}(l.GroupSet);r.SystemDamageText=p,cc._RF.pop()},{"../../../../../framework/container/Container":void 0,"../../../../../framework/ecs/GroupSet":void 0,"../../../../../framework/utils/Toolset":void 0,"../logic/event/SystemEvent":"SystemEvent","../logic/move/ComPos":"ComPos"}],SystemDamage:[function(t,e,r){"use strict";cc._RF.push(e,"78c20843CFMWaKL2v4r0xCh","SystemDamage");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.SystemDamage=r.DamageInfo=void 0;var s=t("../../../../../framework/container/Container"),c=t("../../../../../framework/ecs/GroupSet"),u=t("../../../../../framework/event/EventCallback"),p=t("../../../../../framework/utils/Toolset"),f=t("./damage/RoulettelProxy"),h=t("./event/SystemEvent"),y=t("./type/ComType"),d=t("./var/ComVar"),m=.3,v=function(){function t(){this.damageTag={},this.damageValue={},this.damageValue.base=0,this.damageValue.fixed=0,this.damageValue.rate=0}return t.CreateEmpty=function(){return new t},t.CreateDefault=function(e,r){var o=new t;return o.sid=e,o.tid=r,o},t.CreateBullet=function(t,e,r,o){var n=this.CreateDefault(t,e);return n.bulletInfo={skillId:r,sender:o},n.damageTag.Bullet=!0,n},t.prototype.GetDamage=function(){var t=(this.damageValue.base+(this.damageValue.fixed||0))*(1+(this.damageValue.rate||0));return Math.round(100*t)/100},t.prototype.GetDamageStr=function(){var t=this.GetDamage();return(t=Math.floor(t)).toString()},t.prototype.GetSkillId=function(){var t;return null===(t=this.bulletInfo)||void 0===t?void 0:t.skillId},t.prototype.GetIsBullet=function(){return this.damageTag.Bullet},t.prototype.GetSender=function(){return this.GetIsBullet()?this.bulletInfo.sender:this.sid},t}();r.DamageInfo=v;var _=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tlComClazz=[d.ComVar],e.toolSet=p.ToolSet.createToolSet(),e.damageCallback=new u.EventCallback,e.tmDirty=new Map,e}return n(e,t),e.prototype.SetShowHeroDamage=function(t){this._showHeroDamage=t},e.prototype.GetShowHeroDamage=function(){return this._showHeroDamage},e.prototype.GetDamageCallback=function(){return this.damageCallback},e.prototype.onStart=function(){var t=this;this.RouttelProxyMgr=new f.RouttelProxyMgr(this.Battle),this.toolSet.addListener(this.SystemEvent.GetEventPorxy(),h.EBattleEvent.KillAllMonsterBoss,function(){t.MarkDirty("KillAllMonsterBoss")}),this.toolSet.addListener(this.SystemEvent.GetEventPorxy(),h.EBattleEvent.KillMonsterBoom,function(){t.MarkDirty("KillMonsterBoom")}),this.toolSet.addListener(this.SystemEvent.GetEventPorxy(),h.EBattleEvent.KillMonsterBullet,function(){t.MarkDirty("KillMonsterBullet")}),m=this.ModelGameConfig.GetGameConfigValueByKey("battleMonsterHitDuration")},e.prototype.onDestroy=function(){this.RouttelProxyMgr.destroy(),p.ToolSet.destroyToolSet(this.toolSet)},e.prototype.onAddEntity=function(t){this.RouttelProxyMgr.AddRouttel(t)},e.prototype.onRemoveEntity=function(t){this.RouttelProxyMgr.RemoveRouttel(t)},e.prototype.onUpdate=function(t){this.RouttelProxyMgr.Update(t),this.updateKill(t),this.updateBullet(t),this.updateHero(t),this.heroBeHitBack(t)},e.prototype.applyDamage=function(t){return t.tid==this.ComVar.HEROID&&this.SystemEvent.SendTriggerBeHit(t),!t.damageTag.Failure&&(this.ComVar.takeDamage(t.sid,t.tid,t),this.applyBuff(t),this.damageCallback.execute(t),this.AfterApplyDamage(t),!0)},e.prototype.AfterApplyDamage=function(t){var e=t.GetSkillId(),r=t.sid,o=this.ComVar.BULLET_SENDER[r],n=this.ComVar.HP_Max;if(e&&o&&this.GPSkillData.HasSkillAttr(e,"hrp")){var i=n[o],a=this.GPSkillData.GetSkillAttr(e,"hrp",i),l=Math.max(0,a.GetValue()-i);l>0&&this.ComVar.takeRDE(o,l)}},e.prototype.applyBuff=function(t){this.BuffVarMgr.SendOnDamage(t.sid,t)},e.prototype.calCrit=function(t){var e=this.ComVar.CRIT_RATE;return Math.random()+1<e[t]},e.prototype.calCritDamage=function(t,e){return e*this.ComVar.CRIT_DAMAGE[t]},e.prototype.calThump=function(t){var e=this.ComVar.CalAttr(t,"tpr",1);return Math.random()+1<e},e.prototype.calThumpDamage=function(t,e){return e*this.ComVar.CalAttr(t,"tpd",2)},e.prototype.calCritTenDamage=function(t,e){var r=this.ComVar.TEN_DAMAGE_RATE;return Math.random()+1<r[t]?10*e:0},e.prototype.calSecKillDamage=function(t){var e=this.ComVar.CalAttr(t,"imd",1);return Math.random()+1<e},e.prototype.updateBullet=function(){var t,e,r,o,n=this.ComVar,i=this.ComType.GetGroup(y.EComType.Bullet),l=this.ComCollision.collisons,s=this.ComVar.BULLET_SENDER,c=this.ComVar.ATK,u=this.ComVar.ALIVE,p=(this.ComVar.BULLET_KILLER,this.ComVar.PENETRATE),f=this.ComVar.PENETRATE_DESTROY,h=this.ComVar.BULLET_DAMAGE_INTERVAL,d=this.ComVar.BULLET_ATTR_DAMAGE_RATE,m=this.ComVar.BULLET_ATTR_FIRST_HIT,_=this.ComVar.BULLET_IS_FIRST_HIT,S=(this.ComPos.x,this.ComPos.y,this.ComVar.BULLET_SKILL),g=this.SystemEvent;try{for(var b=a(i),C=b.next();!C.done;C=b.next()){var R=C.value,M=this.Battle.getRef(R);try{for(var w=(r=void 0,a(l[R])),O=w.next();!O.done;O=w.next()){var B=O.value;if(0!=u[B])if(n.CAMP[R]!=n.CAMP[B]){var P=this.ComType.GetType(B);if(P!=y.EComType.Bullet){10033!=S[R]&&10034!=S[R]||P!=y.EComType.Monster||1!=(U=n.CalHeroAttr("s7164",1))&&(n.SPEED_REDUCE[B]=U,this.ComBuffCarrier.DoSlow(R,B)),g.SendBulletCollid(R,B);var G=M,k=this.Battle.getRef(B),x=h[R];if(this.RouttelProxyMgr.checkDamateRoulettle(G,k,x)){var T=s[R],j=v.CreateBullet(R,B,S[R],T);j.damageTag.Remote=1;var I=this.ComVar.SPECIAL_ATK[R]||c[T];if(j.damageValue.base=I*d[R],T==n.HEROID){var D=j.damageValue.base,F=n.CalAttr(T,"\u5de5\u5320",1);F>1&&(D+=this.ModelEquip.getEquipATKAdd()*(F-1)),j.damageValue.base=n.CalAttr(T,"sdi",D)}var L=this.ComVar.MONSTER_REF[B];if(L&&!L.GetIsElite()&&!L.GetIsBoss()&&this.calSecKillDamage(s[R])){var E=this.ComVar.HP[B];j.damageValue.base=E,j.damageTag.Crit=1,j.damageTag.Seckill=!0}else{var A=this.calCritTenDamage(s[R],j.damageValue.base);if(A)j.damageValue.base=A,j.damageTag.Crit=1,j.damageTag.TenDamage=!0;else if(this.calThump(s[R])){var V=this.calThumpDamage(s[R],j.damageValue.base);j.damageValue.base=V,j.damageTag.Crit=1,j.damageTag.Thump=!0,this.ComVar.THUMP_BLOOD&&this.ComBuffCarrier.DoBleed(R,B)}else this.calCrit(s[R])&&(V=this.calCritDamage(s[R],j.damageValue.base),j.damageValue.base=V,j.damageTag.Crit=1)}if(S[R]&&(U=this.ComVar.GetAttr(T,"dip"))&&(j.damageValue.base+=U.base+U.addition,j.damageValue.rate+=U.rate),this.ComVar.calDamage(j),m[R]&&0==_[R]&&(_[R]=!0,j.damageValue.rate+=1),this.ComVar.INVINCIBLE[j.tid]&&(j.damageTag.Failure=!0),this.applyDamage(j)&&this.sufferDamage(j),P==y.EComType.BossGuardMonster)break;if(p[R]>0&&(p[R]=Math.max(0,p[R]-1)),-1==p[R])break;if(0==f[R])break;if(p[R]<=0){this.ComState.SwitchDestroy(R);break}}}else this.ComVar.CheckBulletKill(R,B)&&this.ComVar.takeDie(B,"\u51fb\u843d\u5b50\u5f39")}else{var U;this.ComCollision.recycle[R]&&B==n.HEROID&&(U=n.HERO_ATTR.GetAttr("rec")).getEffectId(S[R])&&(this.ComCollision.recycle[R]=!1,this.SystemSkill.GetSkillById(S[R]).resetSkillState(),this.ComState.SwitchDestroy(R))}}}catch(W){r={error:W}}finally{try{O&&!O.done&&(o=w.return)&&o.call(w)}finally{if(r)throw r.error}}}}catch(H){t={error:H}}finally{try{C&&!C.done&&(e=b.return)&&e.call(b)}finally{if(t)throw t.error}}},e.prototype.sufferDamage=function(t){var e=t.sid,r=t.tid,o=this.ComType.GetType(r),n=this.ComPos.x,i=this.ComPos.y,a=t.damageTag.Crit||t.damageTag.Melee||t.damageTag.Remote;if(o==y.EComType.Monster&&(t.damageTag.Crit?this.GPAudio.hitCrit():this.GPAudio.hit(),this.SystemEvent.sendDamageText(r,t),a)){var l=n[r]>n[e];this.SystemViewEffect.AddEffectXY("\u767e\u604b_\u6218\u6597\u573a\u666f\u7279\u6548_\u53d7\u51fb",n[r],i[r],l)}o==y.EComType.Player&&(this.GPAudio.hit(),this.GetShowHeroDamage()&&this.SystemEvent.sendDamageText(r,t)),a&&this.ComVar.takeBehit(t.tid,t.sid,m)},e.prototype.updateHero=function(){var t,e,r,o,n=this.ComType.GetGroup(y.EComType.Player),i=this.ComCollision.collisons,l=this.ComType,s=this.ComVar.ATK,c=this.ComVar.ALIVE;try{for(var u=a(n),p=u.next();!p.done;p=u.next()){var f=p.value;try{for(var h=(r=void 0,a(i[f])),d=h.next();!d.done;d=h.next()){var m=d.value,_=l.GetType(m);if((_==y.EComType.Monster||_==y.EComType.BossGuardMonster)&&0!=c[m]){var S=this.Battle.getRef(m),g=this.ComVar.HEROREF;if(this.RouttelProxyMgr.checkDamateRoulettle(S,g,2)){var b=v.CreateDefault(m,f);b.damageTag.Melee=1,b.damageValue.base=s[m],this.ComVar.calDamage(b),this.GPAudio.hit(),this.GetShowHeroDamage()&&this.SystemEvent.sendDamageText(f,b),this.ComVar.INVINCIBLE[b.tid]&&(b.damageTag.Failure=!0),this.applyDamage(b),_==y.EComType.BossGuardMonster&&(this._duration=.2,this.ComVar.BEHIT_SENDER[f]=m)}}}}catch(C){r={error:C}}finally{try{d&&!d.done&&(o=h.return)&&o.call(h)}finally{if(r)throw r.error}}}}catch(R){t={error:R}}finally{try{p&&!p.done&&(e=u.return)&&e.call(u)}finally{if(t)throw t.error}}},e.prototype.heroBeHitBack=function(t){if(this._duration>0){this.SystemAI.onReceiveJoystick(0,!1);var e=this.ComVar.HEROID,r=(this.ComVar.BEHIT_SENDER[e],this.ModelGameConfig.GetGameConfigValueByKey("battleMonsterHitDistanceMin")),o=this.ModelGameConfig.GetGameConfigValueByKey("battleMonsterHitDistanceMax"),n=this.ComPos.x,i=this.ComPos.y,a=this.ComVelocity.vx,l=this.ComVelocity.vy;this.ComVelocity.moving[e]=!0;var s=this.ComVelocity.speed,c=this.ComVar.REPL_MAX,u=new cc.Vec2,p=40/c,f=cc.misc.lerp(r,o,p);this._speedNew=this._speedNew?this._speedNew:f/this._duration;var h=this._speedNew,y=this.SystemMap.BossBound,d=[y.x+y.width/2,y.y+y.height/2];u.x=d[0]-n[e],u.y=d[1]-i[e],u.normalizeSelf(),a[e]=u.x,l[e]=u.y,this._speedOld||(this._speedOld=s[e]),s[e]=h,this._duration-=t,this._duration<=0&&(a[e]=0,l[e]=0,s[e]=this._speedOld,this._speedOld=null)}},e.prototype.MarkDirty=function(t){this.tmDirty.set(t,!0)},e.prototype.ClearDirty=function(t){this.tmDirty.delete(t)},e.prototype.updateKill=function(){var t,e;try{for(var r=a(this.tmDirty),o=r.next();!o.done;o=r.next()){var n=l(o.value,2),i=n[0];switch(n[1],i){case"KillMonsterBoom":this.ClearDirty(i),this.KillMonster_Boom();break;case"KillAllMonsterBoss":this.ClearDirty(i),this.KillMonster_Boss();break;case"KillMonsterBullet":this.ClearDirty(i),this.KillMonsterBullet()}}}catch(s){t={error:s}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},e.prototype.KillMonster_Boss=function(){var t,e,r,o,n,i,l=this.ComVar,s=this.ComType.GetGroup(y.EComType.Monster),c="killAllMonster";try{for(var u=a(s),p=u.next();!p.done;p=u.next()){var f=p.value;l.takeDie(f,c)}}catch(_){t={error:_}}finally{try{p&&!p.done&&(e=u.return)&&e.call(u)}finally{if(t)throw t.error}}s=this.ComType.GetGroup(y.EComType.PropBox),c="killAllMonster";try{for(var h=a(s),d=h.next();!d.done;d=h.next())f=d.value,l.takeDie(f,c)}catch(S){r={error:S}}finally{try{d&&!d.done&&(o=h.return)&&o.call(h)}finally{if(r)throw r.error}}s=this.ComType.GetGroupByTag(y.EComTag.MonsterBullet),c="killAllMonster";try{for(var m=a(s),v=m.next();!v.done;v=m.next())f=v.value,l.takeDie(f,c)}catch(g){n={error:g}}finally{try{v&&!v.done&&(i=m.return)&&i.call(m)}finally{if(n)throw n.error}}},e.prototype.KillMonster_Boom=function(){var t,e,r,o,n=this.ComVar,i=this.ComVar.MONSTER_REF,l=this.ComType.GetGroup(y.EComType.Monster),s=this.ComVar.HEROID,c=this.ComVar.ATK[s]||100,u=this.ModelGameConfig.GetGameConfigValueByKey("battleBoomDamageRate")||0;u/=100;var p=v.CreateEmpty();p.damageValue.base=c,p.damageValue.rate=u;try{for(var f=a(l),h=f.next();!h.done;h=f.next()){var d=h.value;p.sid=s,p.tid=d,i[d].GetIsElite()||i[d].GetIsBoss()||(this.sufferDamage(p),this.applyDamage(p))}}catch(S){t={error:S}}finally{try{h&&!h.done&&(e=f.return)&&e.call(f)}finally{if(t)throw t.error}}l=this.ComType.GetGroupByTag(y.EComTag.MonsterBullet);try{for(var m=a(l),_=m.next();!_.done;_=m.next())d=_.value,n.takeDie(d,"killAllMonster")}catch(g){r={error:g}}finally{try{_&&!_.done&&(o=m.return)&&o.call(m)}finally{if(r)throw r.error}}},e.prototype.KillMonsterBullet=function(){var t,e,r=this.ComVar,o=this.ComType.GetGroupByTag(y.EComTag.MonsterBullet);try{for(var n=a(o),i=n.next();!i.done;i=n.next()){var l=i.value;r.takeDie(l,"killAllMonster")}}catch(s){t={error:s}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}},e.prototype.BuffDamage=function(t){this.sufferDamage(t),this.applyDamage(t)},e.__cname="SystemDamage",i([s.injectField("ComType")],e.prototype,"ComType",void 0),i([s.injectField("ComVar")],e.prototype,"ComVar",void 0),i([s.injectField("ComPos")],e.prototype,"ComPos",void 0),i([s.injectField("ComVelocity")],e.prototype,"ComVelocity",void 0),i([s.injectField("SystemJoystick")],e.prototype,"SystemJoystick",void 0),i([s.injectField("SystemAI")],e.prototype,"SystemAI",void 0),i([s.injectField("ComCollision")],e.prototype,"ComCollision",void 0),i([s.injectField("SystemRole")],e.prototype,"SystemRole",void 0),i([s.injectField("SystemEvent")],e.prototype,"SystemEvent",void 0),i([s.injectField("ComState")],e.prototype,"ComState",void 0),i([s.injectField("SystemViewEffect")],e.prototype,"SystemViewEffect",void 0),i([s.injectField("GPAudio")],e.prototype,"GPAudio",void 0),i([s.injectField("ModelGameConfig")],e.prototype,"ModelGameConfig",void 0),i([s.injectField("GPSkillData")],e.prototype,"GPSkillData",void 0),i([s.injectField("BuffVarMgr")],e.prototype,"BuffVarMgr",void 0),i([s.injectField("SystemMap")],e.prototype,"SystemMap",void 0),i([s.injectField("ModelEquip")],e.prototype,"ModelEquip",void 0),i([s.injectField("SystemSkill")],e.prototype,"SystemSkill",void 0),i([s.injectField("SystemViewWedgit")],e.prototype,"SystemViewWedgit",void 0),i([s.injectField("ComBuffCarrier")],e.prototype,"ComBuffCarrier",void 0),e}(c.GroupSet);r.SystemDamage=_,cc._RF.pop()},{"../../../../../framework/container/Container":void 0,"../../../../../framework/ecs/GroupSet":void 0,"../../../../../framework/event/EventCallback":void 0,"../../../../../framework/utils/Toolset":void 0,"./damage/RoulettelProxy":"RoulettelProxy","./event/SystemEvent":"SystemEvent","./type/ComType":"ComType","./var/ComVar":"ComVar"}],SystemDebug:[function(t,e,r){"use strict";cc._RF.push(e,"6ae9a5RXOFPBIcKf9cX82AW","SystemDebug");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.SystemDebug=void 0;var a=t("../../../../../framework/container/Container"),l=t("../base/BaseBattleSystem"),s=t("./SubDebugCommand"),c=t("./SubDebugDraw"),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.onInit=function(){this.world.startConfig.debug&&(this.SubDebugDraw=this.AddSubSystem(c.SubDebugDraw)),this.SubDebugCommand=this.AddSubSystem(s.SubDebugCommand)},e.prototype.onDestroy=function(){},e.prototype.onUpdate=function(t){this.SubDebugDraw&&this.SubDebugDraw.OnUpdate(t)},e.prototype.onStart=function(){this.world.startConfig.debugField&&(this.LayerRolePanel.SetShowHp(!0),this.SystemDamage.SetShowHeroDamage(!0))},e.__cname="SystemDebug",i([a.injectField("LayerRolePanel")],e.prototype,"LayerRolePanel",void 0),i([a.injectField("SystemDamage")],e.prototype,"SystemDamage",void 0),e}(l.BaseBattleSystem);r.SystemDebug=u,cc._RF.pop()},{"../../../../../framework/container/Container":void 0,"../base/BaseBattleSystem":"BaseBattleSystem","./SubDebugCommand":"SubDebugCommand","./SubDebugDraw":"SubDebugDraw"}],SystemEquipment:[function(t,e,r){"use strict";cc._RF.push(e,"e044bdQ9mJN3oCdIqeNGaDq","SystemEquipment");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.SystemEquipment=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.__cname="SystemEquipment",e}(t("../../base/BaseBattleSystem").BaseBattleSystem);r.SystemEquipment=i,cc._RF.pop()},{"../../base/BaseBattleSystem":"BaseBattleSystem"}],SystemEvent:[function(t,e,r){"use strict";cc._RF.push(e,"23b5dyrACNKP7FXNLXUpTM6","SystemEvent");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.SystemEvent=r.EBattleEvent=void 0;var i,a=t("../../../../../../framework/event/EventProxy"),l=t("../../base/BaseBattleSystem");(function(t){t[t.KillMonster=0]="KillMonster",t[t.KillBox=1]="KillBox",t[t.LevelUp=2]="LevelUp",t[t.LevelUpEnd=3]="LevelUpEnd",t[t.Paused=4]="Paused",t[t.Resume=5]="Resume",t[t.EnterSelector=6]="EnterSelector",t[t.SelectUpgrade=7]="SelectUpgrade",t[t.StartDrop=8]="StartDrop",t[t.SkillReplace=9]="SkillReplace",t[t.FirstGoldChest=10]="FirstGoldChest",t[t.GoldChest=11]="GoldChest",t[t.DropSkillChest=12]="DropSkillChest",t[t.SkillChest=13]="SkillChest",t[t.BossNodeChest=14]="BossNodeChest",t[t.EliteDown=15]="EliteDown",t[t.KillMonsterBoom=16]="KillMonsterBoom",t[t.KillAllMonsterBoss=17]="KillAllMonsterBoss",t[t.KillMonsterBullet=18]="KillMonsterBullet",t[t.BossDown=19]="BossDown",t[t.BossGenerate=20]="BossGenerate",t[t.TipsBoss=21]="TipsBoss",t[t.TipsMonster=22]="TipsMonster",t[t.DamageText=23]="DamageText",t[t.Shake=24]="Shake",t[t.TrySpawnAfterKill=25]="TrySpawnAfterKill",t[t.DebugWin=26]="DebugWin",t[t.GameFinally=27]="GameFinally",t[t.BulletCollid=28]="BulletCollid",t[t.TriggerBehit=29]="TriggerBehit",t[t.TriggerReadyDie=30]="TriggerReadyDie",t[t.TriggerRestore=31]="TriggerRestore",t[t.TriggerTake=32]="TriggerTake",t[t.TriggerHpChange=33]="TriggerHpChange",t[t.TriggerAtk=34]="TriggerAtk"})(i=r.EBattleEvent||(r.EBattleEvent={}));var s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.eventProxy=new a.EventProxy,e}return n(e,t),e.prototype.GetEventPorxy=function(){return this.eventProxy},e.prototype.sendKillMonster=function(t,e){this.eventProxy.execute(i.KillMonster,t,e)},e.prototype.sendEliteDown=function(t){this.eventProxy.execute(i.EliteDown,t)},e.prototype.sendKillBox=function(t){this.eventProxy.execute(i.KillBox,t)},e.prototype.sendLevelUp=function(){this.eventProxy.execute(i.LevelUp)},e.prototype.sendLevelUpEnd=function(){this.eventProxy.execute(i.LevelUpEnd)},e.prototype.sendPaused=function(t){this.eventProxy.execute(i.Paused,t)},e.prototype.sendResume=function(t){this.eventProxy.execute(i.Resume,t)},e.prototype.sendEnterSelector=function(){this.eventProxy.execute(i.EnterSelector)},e.prototype.sendSkillReplace=function(){this.eventProxy.execute(i.SkillReplace)},e.prototype.sendStartDrop=function(t,e,r){this.eventProxy.execute(i.StartDrop,t,e,r)},e.prototype.sendTipsBoss=function(){this.eventProxy.execute(i.TipsBoss)},e.prototype.sendTipsMonster=function(){this.eventProxy.execute(i.TipsMonster)},e.prototype.sendKillMonsterBoom=function(){this.eventProxy.execute(i.KillMonsterBoom)},e.prototype.sendkillAllMonsterBoss=function(){this.eventProxy.execute(i.KillAllMonsterBoss)},e.prototype.sendKillMonsterBullet=function(){this.eventProxy.execute(i.KillMonsterBullet)},e.prototype.sendBossDown=function(t){this.eventProxy.execute(i.BossDown,t)},e.prototype.sendBossGen=function(t){this.eventProxy.execute(i.BossGenerate,t)},e.prototype.sendFirstGoldChest=function(t){this.eventProxy.execute(i.FirstGoldChest,t)},e.prototype.sendBossNodeChest=function(){this.eventProxy.execute(i.BossNodeChest)},e.prototype.sendGoldChest=function(t){this.eventProxy.execute(i.GoldChest,t)},e.prototype.sendSkillChest=function(t){this.eventProxy.execute(i.SkillChest,t)},e.prototype.sendDamageText=function(t,e){this.eventProxy.execute(i.DamageText,t,e)},e.prototype.sendShake=function(){this.eventProxy.execute(i.Shake)},e.prototype.sendTrySpawnAfterKill=function(){this.eventProxy.execute(i.TrySpawnAfterKill)},e.prototype.sendDebugWin=function(){this.eventProxy.execute(i.DebugWin)},e.prototype.sendGameFinally=function(){this.eventProxy.execute(i.GameFinally)},e.prototype.SendTriggerBeHit=function(t){this.eventProxy.execute(i.TriggerBehit,t)},e.prototype.SendTriggerReadyDie=function(t){this.eventProxy.execute(i.TriggerReadyDie,t)},e.prototype.SendTriggerRestore=function(t){this.eventProxy.execute(i.TriggerRestore,t)},e.prototype.SendTriggerTake=function(){this.eventProxy.execute(i.TriggerTake)},e.prototype.SendTriggerHpChange=function(t){this.eventProxy.execute(i.TriggerHpChange,t)},e.prototype.SendTriggerATK=function(t){this.eventProxy.execute(i.TriggerAtk,t)},e.prototype.SendBulletCollid=function(t,e){this.eventProxy.execute(i.BulletCollid,t,e)},e.__cname="SystemEvent",e}(l.BaseBattleSystem);r.SystemEvent=s,cc._RF.pop()},{"../../../../../../framework/event/EventProxy":void 0,"../../base/BaseBattleSystem":"BaseBattleSystem"}],SystemGamePlay:[function(t,e,r){"use strict";cc._RF.push(e,"d7555mRekdEAoNjIjB6k7DI","SystemGamePlay");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},l=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},s=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.SystemGamePlay=void 0;var c=t("../BaseLogicSystem"),u=t("./sub/draw/GPDraw"),p=t("./sub/GPAudio"),f=t("./sub/GPChest"),h=t("./sub/GPDamageStastic"),y=t("./sub/GPEvolution"),d=t("./sub/GPGameover"),m=t("./sub/GPGuide"),v=t("./sub/GPHeroSkill"),_=t("./sub/GPHeroSupply"),S=t("./sub/GPLevelUp"),g=t("./sub/GPNetSync"),b=t("./sub/GPPlaySound"),C=t("./sub/GPSkillData"),R=t("./sub/GPSpecialEffect"),M=t("./sub/GPStart"),w=t("./sub/GPStartDrop"),O=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tmSub=new Map,e}return n(e,t),e.prototype.onInit=function(){this.createSub(M.GPStart),this.createSub(S.GPLevelUp),this.createSub(R.GPSpecialEffect),this.createSub(v.GPHeroSkill),this.createSub(_.GPHeroSupply),this.createSub(d.GPGameover),this.createSub(g.GPNetSync),this.createSub(p.GPAudio),this.createSub(f.GPChest),this.createSub(y.GPEvolution),this.createSub(C.GPSkillData),this.createSub(b.GPPlaySound),this.createSub(h.GPDamageStastic),this.createSub(w.GPStartDrop),this.createSub(u.GPDraw),this.createSub(m.GPGuide)},e.prototype.beforeStartAsync=function(){return i(this,void 0,Promise,function(){var t,e,r,o,n,i,c,u;return a(this,function(a){switch(a.label){case 0:a.trys.push([0,5,6,7]),t=l(this.tmSub),e=t.next(),a.label=1;case 1:return e.done?[3,4]:((r=s(e.value,2))[0],o=r[1],(n=o.OnBeforeStart())?[4,n]:[3,3]);case 2:a.sent(),a.label=3;case 3:return e=t.next(),[3,1];case 4:return[3,7];case 5:return i=a.sent(),c={error:i},[3,7];case 6:try{e&&!e.done&&(u=t.return)&&u.call(t)}finally{if(c)throw c.error}return[7];case 7:return[2]}})})},e.prototype.onStart=function(){var t,e;try{for(var r=l(this.tmSub),o=r.next();!o.done;o=r.next()){var n=s(o.value,2),i=(n[0],n[1]);this.container.inject(i)}}catch(a){t={error:a}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},e.prototype.onSubStart=function(){this.GetSub(d.GPGameover).OnEnter(),this.GetSub(S.GPLevelUp).OnEnter(),this.GetSub(R.GPSpecialEffect).OnEnter(),this.GetSub(v.GPHeroSkill).OnEnter(),this.GetSub(_.GPHeroSupply).OnEnter(),this.GetSub(M.GPStart).OnEnter(),this.GetSub(w.GPStartDrop).OnEnter(),this.GetSub(g.GPNetSync).OnEnter(),this.GetSub(p.GPAudio).OnEnter(),this.GetSub(f.GPChest).OnEnter(),this.GetSub(y.GPEvolution).OnEnter(),this.GetSub(C.GPSkillData).OnEnter(),this.GetSub(b.GPPlaySound).OnEnter(),this.GetSub(h.GPDamageStastic).OnEnter(),this.GetSub(u.GPDraw).OnEnter(),this.GetSub(m.GPGuide).OnEnter()},e.prototype.onDestroy=function(){var t,e,r,o;try{for(var n=l(this.tmSub),i=n.next();!i.done;i=n.next()){var a=s(i.value,2);a[0],a[1].OnExit()}}catch(f){t={error:f}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}try{for(var c=l(this.tmSub),u=c.next();!u.done;u=c.next()){var p=s(u.value,2);p[0],p[1].destroy()}}catch(h){r={error:h}}finally{try{u&&!u.done&&(o=c.return)&&o.call(c)}finally{if(r)throw r.error}}},e.prototype.onUpdate=function(t){null==this._start?(this._start=!0,this.onSubStart()):(this.GetSub(d.GPGameover).OnUpdate(t),this.GetSub(f.GPChest).OnUpdate(t),this.GetSub(b.GPPlaySound).OnUpdate(t),this.GetSub(g.GPNetSync).OnUpdate(t))},e.prototype.createSub=function(t){var e=new t(this.container);this.container.collectObj(e),this.tmSub.set(t,e),e.OnInit()},e.prototype.GetSub=function(t){return this.tmSub.get(t)},e.prototype.Win=function(){this.world.startConfig.debugField||this.GetSub(d.GPGameover).Win()},e.prototype.DebugWin=function(){this.world.startConfig.debugField||this.GetSub(d.GPGameover).DebugWin()},e.__cname="SystemGamePlay",e}(c.BaseLogicSystem);r.SystemGamePlay=O,cc._RF.pop()},{"../BaseLogicSystem":"BaseLogicSystem","./sub/GPAudio":"GPAudio","./sub/GPChest":"GPChest","./sub/GPDamageStastic":"GPDamageStastic","./sub/GPEvolution":"GPEvolution","./sub/GPGameover":"GPGameover","./sub/GPGuide":"GPGuide","./sub/GPHeroSkill":"GPHeroSkill","./sub/GPHeroSupply":"GPHeroSupply","./sub/GPLevelUp":"GPLevelUp","./sub/GPNetSync":"GPNetSync","./sub/GPPlaySound":"GPPlaySound","./sub/GPSkillData":"GPSkillData","./sub/GPSpecialEffect":"GPSpecialEffect","./sub/GPStart":"GPStart","./sub/GPStartDrop":"GPStartDrop","./sub/draw/GPDraw":"GPDraw"}],SystemGraph:[function(t,e,r){"use strict";cc._RF.push(e,"59755RWl0NEfamS6vGQEYIP","SystemGraph");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.SystemGraph=void 0;var a=t("../../../../../framework/container/Container"),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.canvas=cc.director.getScene().getChildByName("Canvas"),e}return n(e,t),e.prototype.onStart=function(){var t=new cc.Node;this.canvas.addChild(t),this.root=t;var e=t.addComponent(cc.Graphics);e.lineWidth=3,this.graph=e},e.prototype.onUpdate=function(){this.ComPos,this.ComVar},e.__cname="SystemGraph",i([a.injectField("ComPos")],e.prototype,"ComPos",void 0),i([a.injectField("ComVar")],e.prototype,"ComVar",void 0),i([a.injectField("Battle")],e.prototype,"Battle",void 0),e}(t("../base/BaseBattleSystem").BaseBattleSystem);r.SystemGraph=l,cc._RF.pop()},{"../../../../../framework/container/Container":void 0,"../base/BaseBattleSystem":"BaseBattleSystem"}],SystemHandler:[function(t,e,r){"use strict";cc._RF.push(e,"439b7H7dqdBRq8JnxYwG06/","SystemHandler");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.SystemHandler=void 0;var l=t("../../../../../../framework/container/Container"),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tlHandler=[],e}return n(e,t),e.prototype.Request=function(t){var e=new t;return this.container.inject(e),this.tlHandler.push(e),e},e.prototype.onUpdate=function(t){var e,r;try{for(var o=a(this.tlHandler),n=o.next();!n.done;n=o.next())n.value.process(t)}catch(i){e={error:i}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}this.tlHandler.splice(0)},e.__cname="SystemHandler",i([l.injectField("Container")],e.prototype,"container",void 0),e}(t("../../base/BaseBattleSystem").BaseBattleSystem);r.SystemHandler=s,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../base/BaseBattleSystem":"BaseBattleSystem"}],SystemJoystick:[function(t,e,r){"use strict";cc._RF.push(e,"15ad1kmz8VGmYvt3W9A58a2","SystemJoystick");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.SystemJoystick=void 0;var s=t("../../../../../../framework/container/Container"),c=t("../../../../../../framework/utils/Toolset"),u=t("../BaseViewSystem"),p=t("./JoystickModule"),f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.onDestroy=function(){this.container=null,this.toolSet&&c.ToolSet.destroyToolSet(this.toolSet),this.LayerJoystick.SetCtrlable(!1),this.LayerJoystick=null},e.prototype.beforeStartAsync=function(){return a(this,void 0,Promise,function(){var t,e;return l(this,function(){return this.toolSet=c.ToolSet.createToolSet(),t=this.LayerJoystick.GetEventproxy(),e=this.SystemAI,this.LayerJoystick.SetCtrlable(!0),this.toolSet.addListener(t,p.default.JoystickMoving,function(t){e.onReceiveJoystick(t,!0)},this),this.toolSet.addListener(t,p.default.JoystickUp,function(){e.onReceiveJoystick(0,!1)},this),[2]})})},e.prototype.SetControlable=function(t){this.LayerJoystick.SetCtrlable(t)},e.__cname="SystemJoystick",i([s.injectField("Container")],e.prototype,"container",void 0),i([s.injectField("LayerJoystick")],e.prototype,"LayerJoystick",void 0),i([s.injectField("SystemAI")],e.prototype,"SystemAI",void 0),e}(u.BaseViewSystem);r.SystemJoystick=f,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../../../../../framework/utils/Toolset":void 0,"../BaseViewSystem":"BaseViewSystem","./JoystickModule":"JoystickModule"}],SystemMap:[function(t,e,r){"use strict";cc._RF.push(e,"7f759pf4GNG05giiYgWlwKU","SystemMap");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.SystemMap=void 0;var s=t("../../../../../art/MapBuilder/MapBuilderBase"),c=t("../../../../../art/MapBuilder/MapBuilder_Fixed"),u=t("../../../../../framework/container/Container"),p=t("../../../../../framework/coord/Coord"),f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.BossBound=new cc.Rect,e.canvas=cc.director.getScene().getChildByName("Battle"),e._monsterNode=[],e}return n(e,t),Object.defineProperty(e.prototype,"startConfig",{get:function(){return this.Battle.startConfig},enumerable:!1,configurable:!0}),e.prototype.onDestroy=function(){this.mapNode.removeFromParent(),this.ModelPrefab.DestroyAsset(this.mapNode),t.prototype.onDestroy.call(this)},e.prototype.beforeStartAsync=function(){return a(this,void 0,Promise,function(){var t,e,r,o,n,i,a,u,f,h,y,d,m,v,_,S,g,b,C;return l(this,function(l){switch(l.label){case 0:return t=this.startConfig.map,e=this.ModelMap.GetMapPath(t),r=this,[4,this.ModelPrefab.CreateAsset(e)];case 1:return r.mapNode=l.sent(),this.canvas.addChild(this.mapNode,0),o=this.mapNode.getComponentInChildren(s.default),this.mapBuilder=o,n=o.mapSize,i=o.gridSize,a=o.bound.width<1e3||o.bound.height<1e3?100:300,u=new cc.Size(o.bound.width-a,o.bound.height-a),y=Math.max(p.Coord.winSize.width+300,n.width),d=Math.max(p.Coord.winSize.height+300,n.height),this.gridSize=i,this.gridXCount=Math.ceil(y/i),this.gridYCount=Math.ceil(d/i),this.mapSafeRect=new cc.Rect(0,0,this.gridSize*this.gridXCount,this.gridSize*this.gridYCount),f=(this.mapSafeRect.width-n.width)/2,h=(this.mapSafeRect.height-n.height)/2,m=this.mapSafeRect,_=m.x+(m.width-n.width)/2,S=m.y+(m.height-n.height)/2,this.mapRect=new cc.Rect(_,S,n.width,n.height),v=this.mapRect,_=v.x+(v.width-u.width)/2,S=v.y+(v.height-u.height)/2,this.mapBound=new cc.Rect(_,S,u.width,u.height),o instanceof c.MapBuilder_Fixed?(g=this.mapSafeRect,b=g.x+g.width/2,C=g.y+g.height/2,b+=f||0,C+=h||0,this.mapNode.getChildByName("map").setPosition(b,C)):(b=0,C=0,b+=f||0,C+=h||0,this.mapNode.getChildByName("map").setPosition(b,C)),[2]}})})},e.prototype.onStart=function(){},e.prototype.onUpdate=function(t){this.updateCulling(t)},e.prototype.GetRandomPos=function(){return[this.mapRect.x*Math.random(),this.mapRect.y*Math.random()]},e.prototype.GetRandomPosRadius=function(t,e,r){return[t+r*Math.cos(Math.random()),e+r*Math.sin(Math.random())]},e.prototype.GetMapBuilder=function(){return this.mapBuilder},e.prototype.updateMap=function(){var t=this.ComVar.HEROID,e=this.ComPos.x,r=this.ComPos.y;this.mapBuilder.setPos(e[t],r[t])},e.prototype.updateCulling=function(t){this.ComVar.HEROID;var e=this.gridYCount,r=this.gridXCount,o=this.gridSize,n=cc.Camera.main.node,i=Math.floor(n.x/o),a=Math.floor(n.y/o);if(i!=this._gx_last||a!=this._gy_last){this.updateMap(t),this._gx_last=i,this._gy_last=a;var l=this.SystemCamera.sceneWidth/2,s=this.SystemCamera.sceneHeight/2,c=Math.ceil(l/o)+1,u=Math.ceil(s/o)+1,p=Math.max(0,i-c),f=Math.max(0,a-u),h=Math.min(i+c,r),y=Math.min(a+u,e);this.SystemMove.updateCullingSpace(p,f,h,y),this.upCullingVer()}},e.prototype.getCullingVer=function(){return this.culling_ver},e.prototype.upCullingVer=function(){this.culling_ver=(this.culling_ver+1)%60},e.prototype.ModifyBossBound=function(t,e,r,o,n){this.bossBoundType=n;var i=this.mapBound,a=t;a=Math.max(i.x,a),a=Math.min(i.x+i.width-r,a),r>i.width&&(a=i.x,r=i.width);var l=e;l=Math.max(i.y,l),l=Math.min(i.y+i.height-o,l),o>i.height&&(l=i.y,o=i.height);var s=this.BossBound;return s.x=a,s.y=l,s.width=r,s.height=o,s},e.prototype.GetBossBound=function(){return this.BossBound},e.prototype.getBossBoundType=function(){return this.bossBoundType},e.prototype.refreshMonsterFence=function(t){return a(this,void 0,void 0,function(){var e,r,o,n,i,a,s,c,u,p;return l(this,function(){for(e=this.Battle.startConfig.bossAreaType,r=2*this.Battle.startConfig.bossAreaRadius,o=this.Battle.startConfig.bossAreaModel,n=Math.floor(this.Battle.startConfig.bossAreaRadius/500*80),i=[],1==e?i=this.getSquarePoints(cc.v2(t[0],t[1]),r+20,n):2==e&&(a=this.BossBound.width>this.BossBound.height?this.BossBound.height:this.BossBound.width,i=this.distributePointsOnCircle([t[0],t[1]],a/2+20,n)),s=0;s<i.length;s++)c=i[s],u=c[0]<0?0:c[0],p=c[1]<0?0:c[1],this._monsterNode.push(this.SystemRole.CreateEntity(o,u,p));return[2]})})},e.prototype.deleteMonsterFence=function(){var t=this;this._monsterNode.length>0&&(this._monsterNode.forEach(function(e){t.SystemRole.DestroyRole(e)}),this._monsterNode=[])},e.prototype.getSquarePoints=function(t,e,r){for(var o=t.x,n=t.y,i=o-e/2,a=o+e/2,l=n-e/2,s=n+e/2,c=[[i=i<0?0:i,s],[a,s],[a,l=l<0?0:l],[i,l]],u=Math.floor(r/4)-1,p=(a-i)/u,f=(s-l)/u,h=0;h<u;h++)c.push([i+h*p,s]);for(h=0;h<u;h++)c.push([a,s-h*f]);for(h=0;h<u;h++)c.push([i,l+h*f]);for(h=0;h<u;h++)c.push([a-h*p,l]);return c},e.prototype.distributePointsOnCircle=function(t,e,r){for(var o=[],n=2*Math.PI/r,i=0;i<r;i++){var a=t[0]+e*Math.cos(n*i-90),l=t[1]+e*Math.sin(n*i-90);o.push([a,l])}return o},e.__cname="SystemMap",i([u.injectField("ModelPrefab")],e.prototype,"ModelPrefab",void 0),i([u.injectField("ComPos")],e.prototype,"ComPos",void 0),i([u.injectField("ComVar")],e.prototype,"ComVar",void 0),i([u.injectField("ComCollision")],e.prototype,"ComCollision",void 0),i([u.injectField("ComVelocity")],e.prototype,"ComVelocity",void 0),i([u.injectField("SystemMove")],e.prototype,"SystemMove",void 0),i([u.injectField("Battle")],e.prototype,"Battle",void 0),i([u.injectField("ModelMap")],e.prototype,"ModelMap",void 0),i([u.injectField("SystemCamera")],e.prototype,"SystemCamera",void 0),i([u.injectField("SystemRole")],e.prototype,"SystemRole",void 0),e}(t("../base/BaseBattleSystem").BaseBattleSystem);r.SystemMap=f,cc._RF.pop()},{"../../../../../art/MapBuilder/MapBuilderBase":void 0,"../../../../../art/MapBuilder/MapBuilder_Fixed":void 0,"../../../../../framework/container/Container":void 0,"../../../../../framework/coord/Coord":void 0,"../base/BaseBattleSystem":"BaseBattleSystem"}],SystemMove:[function(t,e,r){"use strict";cc._RF.push(e,"2ac44Rsl49JprdMF645pKlh","SystemMove");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a},l=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.SystemMove=r.Grid=void 0;var s=t("../../../../../../framework/container/Container"),c=t("../../../../../../framework/coord/Coord"),u=t("../../../../../../framework/ecs/Group"),p=t("../../../../../../framework/Func"),f=t("../../../../../../framework/FW"),h=t("../../util/CollisionUtil"),y=t("../type/ComType"),d=t("./ComPos"),m=function(){this.ids=new Set};r.Grid=m;var v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tlComClazz=[d.ComPos],e.ids=new Set,e.ids_add=new Set,e.ids_remove=new Set,e.ids_culling=new Set,e.grids=[],e.gx_start=3,e.gy_start=4,e.gx_ended=6,e.gy_ended=12,e.gxy_dirty=!0,e.culling_ver=0,e.culling_rect={xs:0,ys:0,xe:0,ye:0},e.isBoss=!1,e}return n(e,t),e.prototype.updateCullingSpace=function(t,e,r,o){this.gx_start=t,this.gy_start=e,this.gx_ended=r,this.gy_ended=o,this.gxy_dirty=!0},e.prototype.getCullingRect=function(){var t=this.culling_rect;return t.xs=this.gx_start,t.ys=this.gy_start,t.xe=this.gx_ended,t.ye=this.gy_ended,t},e.prototype.getCullingVer=function(){return this.culling_ver},e.prototype.upCullingVer=function(){this.culling_ver=(this.culling_ver+1)%60},e.prototype.onDestroy=function(){t.prototype.onDestroy.call(this),this.tlComClazz=null,this.ids=null,this.ids_remove=null,this.ids_add=null,this.ids_culling=null,this.grids=null,this.ComPos=null,this.ComVelocity=null,this.SystemMap=null,this.Battle=null},e.prototype.onAddEntity=function(t){this.ids_add.add(t),this.gxy_dirty=!0},e.prototype.onRemoveEntity=function(t){if(0!=this.ids.has(t)){this.ids_remove.add(t);var e=this.ComPos.gx,r=this.ComPos.gy,o=this.grids;this.ids,this.ids_culling,this.Battle,this.ids_add.delete(t),this.ids.delete(t);var n=e[t],i=r[t];o[i]&&o[i][n]&&(o[i][n].ids.delete(t),this.gxy_dirty=!0)}else this.ids_remove.add(t)},e.prototype.onStart=function(){for(var t=this.SystemMap.gridYCount,e=this.SystemMap.gridXCount,r=-2;r<=t+2;r++){var o=[];this.grids.push(o);for(var n=-2;n<=e+2;n++){var i=new m;i.gx=n,i.gy=r,o.push(i)}}},e.prototype.onUpdate=function(t){var e,r,o,n,i,s,c,u,p=this,h=this.ComPos.x,d=this.ComPos.y,m=this.ComPos.gx,v=this.ComPos.gy,_=(this.ComPos.d,this.ComVelocity.vx),S=this.ComVelocity.vy,g=(this.ComVelocity.vgx,this.ComVelocity.vgy,this.ComVelocity.moving),b=this.ComVelocity.speed,C=this.SystemMap.gridSize,R=(this.SystemMap.mapBound.width,this.SystemMap.mapBound.height,this.grids),M=this.ComType.typeSet,w=this.ids,O=this.ids_culling,B=this.ids_add,P=this.ids_remove,G=this.gx_start,k=this.gx_ended,x=this.gy_start,T=this.gy_ended,j=this.gxy_dirty;this.gxy_dirty=!1;var I=this.Battle;j&&this.upCullingVer();var D=function(t){var e=Math.floor(h[t]/C),r=Math.floor(d[t]/C),o=m[t],n=v[t],i=p.ComType.GetType(t);if(p.ComVar.ALIVE[t]&&e&&r&&(e!=o||r!=n||p.gxy_dirty||i==y.EComType.BossGuardMonster)){m[t]=e,v[t]=r,o>=0&&n>=0&&R[n][o].ids.delete(t);try{R[r][e].ids.add(t)}catch(s){p.SystemRole.DestroyRole(t),f.FW.Log.error("\u5750\u6807\u9519\u8bef: id: "+t+" pos:["+h[t]+", "+d[t]+"] old:["+o+", "+n+"] new:["+e+", "+r+"]"),cc.error(s)}var a=O.has(t),l=e>=G&&e<=k&&r>=x&&r<=T;l!=a&&(l?(O.add(t),I._addCullingEntity(t)):O.delete(t)&&I._removeCullingEntity(t))}},F=function(e){var r=g[e]?b[e]:0,o=_[e]||0,n=S[e]||0,i=M.get(e);if(i==y.EComType.Monster&&p.ComVar.SPEED_REDUCE[e]&&(r*=p.ComVar.SPEED_REDUCE[e]),h[e]=h[e]+o*t*r,d[e]=d[e]+n*t*r,i==y.EComType.Monster||i==y.EComType.Player){var l=a(p.fixPosMove(h[e],d[e]),2),s=l[0],c=l[1];h[e]=s,d[e]=c}else{var u=a(p.fixPos(h[e],d[e]),2);s=u[0],c=u[1],h[e]=s,d[e]=c}D(e)},L=function(t){var e=m[t],r=v[t];D(t);var o=p.ComType.GetType(t),n=O.has(t),i=e>=G&&e<=k&&r>=x&&r<=T;i==n&&o!=y.EComType.BossGuardMonster||(i?(O.add(t),I._addCullingEntity(t)):O.delete(t)&&I._removeCullingEntity(t))},E=function(t,e){g[t]||e?F(t):j&&L(t)};try{for(var A=l(P),V=A.next();!V.done;V=A.next()){var U=V.value;0!=w.has(U)?(w.delete(U),O.has(U)&&(O.delete(U),I._removeCullingEntity(U)),P.delete(U)):P.delete(U)}}catch(z){e={error:z}}finally{try{V&&!V.done&&(r=A.return)&&r.call(A)}finally{if(e)throw e.error}}try{for(var W=l(B),H=W.next();!H.done;H=W.next())U=H.value,1!=P.has(U)?E(U,!0):B.delete(U)}catch(J){o={error:J}}finally{try{H&&!H.done&&(n=W.return)&&n.call(W)}finally{if(o)throw o.error}}try{for(var N=l(w),q=N.next();!q.done;q=N.next())E(U=q.value,!1)}catch(Y){i={error:Y}}finally{try{q&&!q.done&&(s=N.return)&&s.call(N)}finally{if(i)throw i.error}}try{for(var K=l(B),X=K.next();!X.done;X=K.next())U=X.value,w.add(U)}catch(Z){c={error:Z}}finally{try{X&&!X.done&&(u=K.return)&&u.call(K)}finally{if(c)throw c.error}}B.clear(),I._applyCulling()},e.prototype.findNear=function(t,e,r,o,n){var i,a,s=this.SystemMap,c=this.grids,u=s.gridSize,f=s.gridXCount,h=s.gridYCount,y=Math.floor(t/u),d=Math.floor(e/u),m=Math.ceil(r/u);if(y>=0&&d>=0)for(var v=-m;v<=m;v++)for(var _=-m;_<=m;_++){var S=y+v,g=d+_;if(0<=S&&S<f&&0<=g&&g<h){var b=S*u,C=g*u;if(p.Func.isCircRectIntersect(t,e,r,b,C,u,u))try{for(var R=(i=void 0,l(c[g][S].ids)),M=R.next();!M.done;M=R.next()){var w=M.value;(null==n||n(w))&&o.push(w)}}catch(O){i={error:O}}finally{try{M&&!M.done&&(a=R.return)&&a.call(R)}finally{if(i)throw i.error}}}}},e.prototype.findOtherCampNoBullet=function(t,e,r,o,n){var i=this.ComVar.ALIVE,a=this.ComVar.CAMP,l=this.ComVar.SEARCHABLE,s=this.ComType;this.findNear(e,r,o,n,function(e){return 0!=l[e]&&0!=i[e]&&a[e]!=t&&s.GetType(e)!=y.EComType.Bullet&&s.GetType(e)!=y.EComType.BossGuardMonster})},e.prototype.findOtherCamp=function(t,e,r,o,n,i){var a=this,l=this.ComVar.ALIVE,s=this.ComVar.CAMP,c=this.ComVar.SEARCHABLE;this.ComType,this.findNear(e,r,o,n,function(e){return 0!=c[e]&&0!=l[e]&&!(s[e]==t&&!a.ComCollision.recycle[i])})},e.prototype.GetGridsInView=function(t){for(var e=c.Coord.logicSize,r=cc.Camera.main.node,o=r.x-e.width/2,n=r.y-e.height/2,i=e.width,a=e.height,l=this.SystemMap.gridSize,s=Math.floor(o/l),u=Math.floor(n/l),p=Math.ceil(i/l),f=Math.ceil(a/l),h=this.grids,y=s;y<=s+p;y++)for(var d=u;d<=u+f;d++)t.push(h[d][y])},e.prototype.GetIsGridInView=function(t,e){var r=this.SystemMap.gridSize,o=c.Coord.logicSize,n=cc.Camera.main.node,i=n.x-o.width/2,a=n.y-o.height/2,l=o.width,s=o.height;return!!h.default.CheckCollisionAABB(i,a,l,s,t,e,r,r)},e.prototype.GetGridOutView=function(t,e){for(var r=c.Coord.logicSize,o=cc.Camera.main.node,n=o.x-r.width/2,i=o.y-r.height/2,a=r.width+t,l=r.height+t,s=this.SystemMap.gridSize,u=Math.floor(n/s),f=Math.floor(i/s),h=Math.ceil(a/s),y=Math.ceil(l/s),d=n,m=i,v=d+a,_=m+l,S=this.grids,g=p.Func.isRectIntersect,b=u;b<=u+h;b++)for(var C=f;C<=f+y;C++){var R=b*s,M=C*s;g(d,m,v,_,R,M,R+s,M+s)||e.push(S[C][b])}},e.prototype.fixPos=function(t,e){var r=this.SystemMap.mapSafeRect,o=r.x+1,n=r.y+1,i=r.x+r.width-1,a=r.y+r.height-1;return[Math.max(Math.min(t,i),o),Math.max(Math.min(e,a),n)]},e.prototype.fixMapPos=function(t,e){var r=this.SystemMap.mapBound,o=r.x+1,n=r.y+1,i=r.x+r.width-1,a=r.y+r.height-1;return[Math.max(Math.min(t,i),o),Math.max(Math.min(e,a),n)]},e.prototype.fixPosMove=function(t,e){if(!this.isBoss)return this.fixPosEntity(t,e);var r=this.SystemMap.GetBossBound(),o=this.SystemMap.getBossBoundType();if(2==o){var n=r.width/2,i=cc.v2(r.x+n,r.y+n),a=cc.v2(t,e).sub(i);if(a.len()<n)return[t,e];var l=180*a.angle(cc.v2(1,0))/Math.PI;l=l>90?180-l:l;var s=n*Math.sin(l*Math.PI/180),c=n*Math.cos(l*Math.PI/180);return a.y<0&&(s=-s),a.x<0&&(c=-c),[i.x+c,i.y+s]}if(1==o){var u=r.x+r.width,p=r.x,f=r.y+r.height,h=r.y;return[Math.max(Math.min(t,u),p),Math.max(Math.min(e,f),h)]}},e.prototype.fixPosEntity=function(t,e){var r=this.SystemMap.mapBound,o=r.x+1,n=r.y+1,i=r.x+r.width-1,a=r.y+r.height-1;return[Math.max(Math.min(t,i),o),Math.max(Math.min(e,a),n)]},e.prototype.SetBossArea=function(t){this.isBoss=t},e.prototype.pos2Grids=function(t,e){var r=this.SystemMap.gridSize;return[Math.floor(t/r),Math.floor(e/r)]},e.prototype.TryGetGrid=function(t,e){return this.grids[e]&&this.grids[e][t]?this.grids[e][t]:null},e.__cname="SystemMove",i([s.injectField("ComVar")],e.prototype,"ComVar",void 0),i([s.injectField("ComPos")],e.prototype,"ComPos",void 0),i([s.injectField("ComVelocity")],e.prototype,"ComVelocity",void 0),i([s.injectField("SystemMap")],e.prototype,"SystemMap",void 0),i([s.injectField("ComType")],e.prototype,"ComType",void 0),i([s.injectField("SystemRole")],e.prototype,"SystemRole",void 0),i([s.injectField("ComCollision")],e.prototype,"ComCollision",void 0),i([s.injectField("Battle")],e.prototype,"Battle",void 0),e}(u.Group);r.SystemMove=v,cc._RF.pop()},{"../../../../../../framework/FW":void 0,"../../../../../../framework/Func":void 0,"../../../../../../framework/container/Container":void 0,"../../../../../../framework/coord/Coord":void 0,"../../../../../../framework/ecs/Group":void 0,"../../util/CollisionUtil":"CollisionUtil","../type/ComType":"ComType","./ComPos":"ComPos"}],SystemNode:[function(t,e,r){"use strict";cc._RF.push(e,"2c85egqZCVNAZ4fmW28HV9P","SystemNode");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.SystemNode=void 0;var l=t("../../../../../../framework/container/Container"),s=t("../../../../../../framework/utils/Toolset"),c=t("../../base/BaseBattleSystem"),u=t("../../logic/event/SystemEvent"),p=t("./NodeProxyMgr"),f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.canvas=cc.director.getScene().getChildByName("Battle"),e}return n(e,t),e.prototype.onInit=function(t,e){this.toolSet=s.ToolSet.createToolSet(),this.NodeProxyMgr=new p.NodeProxyMgr,e.collectObj(this.NodeProxyMgr)},e.prototype.onDestroy=function(){this.NodeProxyMgr.destroy(),this.root.removeAllChildren(),this.root.destroy(),this.root=null,s.ToolSet.destroyToolSet(this.toolSet)},e.prototype.onStart=function(){var t=this,e=new cc.Node("SystemNode");this.canvas.addChild(e),this.root=e,this.NodeProxyMgr.SetRoot(e);var r=this.SystemEvent.GetEventPorxy();this.toolSet.addListener(r,u.EBattleEvent.Paused,function(){t.PauseAllAnimate()}),this.toolSet.addListener(r,u.EBattleEvent.Resume,function(){t.ResumeAllAnimate()})},e.prototype.onUpdate=function(t){this.NodeProxyMgr.Update(t)},e.prototype.PauseAllAnimate=function(){var t,e;try{for(var r=a(this.NodeProxyMgr.GetTlNodeProxy()),o=r.next();!o.done;o=r.next())o.value.PauseAnimation()}catch(n){t={error:n}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},e.prototype.ResumeAllAnimate=function(){var t,e;try{for(var r=a(this.NodeProxyMgr.GetTlNodeProxy()),o=r.next();!o.done;o=r.next())o.value.ResumeAnimation()}catch(n){t={error:n}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},e.__cname="SystemNode",i([l.injectField("SystemEvent")],e.prototype,"SystemEvent",void 0),e}(c.BaseBattleSystem);r.SystemNode=f,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../../../../../framework/utils/Toolset":void 0,"../../base/BaseBattleSystem":"BaseBattleSystem","../../logic/event/SystemEvent":"SystemEvent","./NodeProxyMgr":"NodeProxyMgr"}],SystemRigidbody:[function(t,e,r){"use strict";cc._RF.push(e,"e0598oq4YZI46HQbglxhmPI","SystemRigidbody");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.SystemRigidbody=void 0;var l=t("../../../../../../framework/container/Container"),s=t("../../../../../../framework/ecs/Group"),c=t("../move/ComPos"),u=t("../move/ComVelocity"),p=t("../type/ComType"),f=t("./ComCollision"),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tlComClazz=[c.ComPos,u.ComVelocity,f.ComCollision],e.ids=new Set,e}return n(e,t),e.prototype.onAddEntity=function(t){this.ids.add(t)},e.prototype.onRemoveEntity=function(t){this.ids.delete(t)},e.prototype.onUpdate=function(t){this.updateVelocity(t),this.updateCollision()},e.prototype.updateVelocity=function(t){var e,r,o=this.ComType.GetGroup(p.EComType.Monster),n=this.ComVelocity.vx,i=this.ComVelocity.vy,l=this.ComVelocity.vgx,s=this.ComVelocity.vgy,c=t;try{for(var u=a(o),f=u.next();!f.done;f=u.next()){var h=f.value;n[h]=cc.misc.lerp(n[h],l[h],c),i[h]=cc.misc.lerp(i[h],s[h],c)}}catch(y){e={error:y}}finally{try{f&&!f.done&&(r=u.return)&&r.call(u)}finally{if(e)throw e.error}}},e.prototype.updateCollision=function(){var t,e,r,o,n=this.ComCollision.collisionsMonster,i=(this.ComVar.HEROID,this.ComCollision.isTrigger);try{for(var l=a(this.ids),s=l.next();!s.done;s=l.next()){var c=s.value,u=this.ComType.GetType(c);if(!i[c]&&u!=p.EComType.BossGuardMonster&&n[c])try{for(var f=(r=void 0,a(n[c])),h=f.next();!h.done;h=f.next()){var y=h.value,d=this.ComType.GetType(y);i[y]||d==p.EComType.BossGuardMonster||this.changeVelocityAndDirection(c,y)}}catch(m){r={error:m}}finally{try{h&&!h.done&&(o=f.return)&&o.call(f)}finally{if(r)throw r.error}}}}catch(v){t={error:v}}finally{try{s&&!s.done&&(e=l.return)&&e.call(l)}finally{if(t)throw t.error}}},e.prototype.changeVelocityAndDirection=function(t,e){var r=this.ComVelocity.vx,o=this.ComVelocity.vy,n=this.ComPos.x,i=this.ComPos.y,a=this.ComCollision.mass,l=this.ComCollision.cr,s=(this.ComCollision.r,new cc.Vec2(r[t],o[t])),c=new cc.Vec2(r[e],o[e]),u=new cc.Vec2(n[t]-n[e],i[t]-i[e]),p=(u.mag(),u.normalize()),f=new cc.Vec2(-p.y,p.x),h=s.dot(p),y=s.dot(f),d=c.dot(p),m=c.dot(f),v=Math.min(l[e],l[t]),_=(a[t]*h+a[e]*d+a[e]*v*(d-h))/(a[t]+a[e]),S=(a[t]*h+a[e]*d+a[t]*v*(h-d))/(a[t]+a[e]);if(!(_<S)){var g=p.mul(_),b=f.mul(y).mul(1),C=p.mul(S),R=f.mul(m).mul(1),M=g.add(b),w=C.add(R);r[t]=M.x||0,o[t]=M.y||0,r[e]=w.x||0,o[e]=w.y||0}},e.__cname="SystemRigidbody",i([l.injectField("ComCollision")],e.prototype,"ComCollision",void 0),i([l.injectField("ComPos")],e.prototype,"ComPos",void 0),i([l.injectField("ComVelocity")],e.prototype,"ComVelocity",void 0),i([l.injectField("ComType")],e.prototype,"ComType",void 0),i([l.injectField("ComVar")],e.prototype,"ComVar",void 0),e}(s.Group);r.SystemRigidbody=h,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../../../../../framework/ecs/Group":void 0,"../move/ComPos":"ComPos","../move/ComVelocity":"ComVelocity","../type/ComType":"ComType","./ComCollision":"ComCollision"}],SystemRole:[function(t,e,r){"use strict";cc._RF.push(e,"d3491O8E0tIroUFW1KOogNK","SystemRole");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a},s=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(l(arguments[e]));return t};Object.defineProperty(r,"__esModule",{value:!0}),r.SystemRole=void 0;var c=t("../../../../../../framework/container/Container"),u=t("../../../../../../framework/event/EventProxy"),p=t("../../../../../../framework/FW"),f=t("../../base/BaseBattleSystem"),h=t("../type/ComType"),y=t("./RBBat"),d=t("./RBBoom"),m=t("./RBBoomerange"),v=t("./RBBoomerangeSuper"),_=t("./RBBox"),S=t("./RBBrick"),g=t("./RBCrossBow"),b=t("./RBDart"),C=t("./RBDartSuperRed"),R=t("./RBDrill"),M=t("./RBDrillSuper"),w=t("./RBDurian"),O=t("./RBDurianSuper"),B=t("./RBField"),P=t("./RBFieldSlow"),G=t("./RBFollow"),k=t("./RBFootball"),x=t("./RBGuarder"),T=t("./RBHero"),j=t("./RBLightning"),I=t("./RBLightningSuper"),D=t("./RBMissile"),F=t("./RBMolotov"),L=t("./RBMonster"),E=t("./RBPulses"),A=t("./RBRadiation"),V=t("./RBRobotBullet"),U=t("./RBStorm"),W=t("./RBStraights"),H=t("./RBSwordField"),N=t("./RBVenom"),q=t("./RoleBuilder"),K=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.eventProxy=new u.EventProxy,e.tmBuilderClazz=new Map,e.RBBox=e.CollectBuilder(_.RBBox),e.RBHero=e.CollectBuilder(T.RBHero),e.RBMonster=e.CollectBuilder(L.RBMonster),e.RBBrick=e.CollectBuilder(S.RBBrick),e.RBDart=e.CollectBuilder(b.RBDart),e.RBDartSuperRed=e.CollectBuilder(C.RBDartSuperRed),e.RBDrill=e.CollectBuilder(R.RBDrill),e.RBDrillSuper=e.CollectBuilder(M.RBDrillSuper),e.RBDurian=e.CollectBuilder(w.RBDurian),e.RBDurianSuper=e.CollectBuilder(O.RBDurianSuper),e.RBField=e.CollectBuilder(B.RBField),e.RBFootball=e.CollectBuilder(k.RBFootball),e.RBGuarder=e.CollectBuilder(x.RBGuarder),e.RBMissile=e.CollectBuilder(D.RBMissile),e.RBSwordField=e.CollectBuilder(H.RBSwordField),e.RBStraights=e.CollectBuilder(W.RBStraights),e.RBBoomerange=e.CollectBuilder(m.RBBoomerange),e.RBBoomerangeSuper=e.CollectBuilder(v.RBBoomerangeSuper),e.RBLightning=e.CollectBuilder(j.RBLightning),e.RBLightningSuper=e.CollectBuilder(I.RBLightningSuper),e.RBMolotov=e.CollectBuilder(F.RBMolotov),e.RBRobotBullet=e.CollectBuilder(V.RBRobotBullet),e.RBBat=e.CollectBuilder(y.RBBat),e.RBVenom=e.CollectBuilder(N.RBVenom),e.RBCrossBow=e.CollectBuilder(g.RBCrossBow),e.RBFieldSlow=e.CollectBuilder(P.RBFieldSlow),e.RBStorm=e.CollectBuilder(U.RBStorm),e.RBPulses=e.CollectBuilder(E.RBPulses),e.RBRadiation=e.CollectBuilder(A.RBRadiation),e.RBBoom=e.CollectBuilder(d.RBBoom),e.RBFollow=e.CollectBuilder(G.RBFollow),e.tlDestroy=new Set,e.tmFrame=new Map,e._needDestoryIds=new Map,e}return n(e,t),Object.defineProperty(e.prototype,"startConfig",{get:function(){return this.Battle.startConfig},enumerable:!1,configurable:!0}),e.prototype.GetEventProxy=function(){return this.eventProxy},e.prototype.CollectBuilder=function(t){var e=t.__cname;this.tmBuilderClazz.set(e,t)},e.prototype.GetBuilderByAlias=function(t){var e=this.tmBuilderClazz.get(t);return this.assert(null!=e,"\u6784\u9020\u5668\u672a\u88ab\u6536\u96c6\uff1a"+t),e},e.prototype.GetBulletBuilder=function(t){var e=this.ModelBattleSkill.GetBullet(t).GetScript();return this.SystemRole.GetBuilderByAlias(e)},e.prototype.onUpdate=function(){this.updateDestroy(),this.updateType()},e.prototype.DestroyRole=function(t){this.ComType.GetType(t)==h.EComType.PropBox&&p.FW.ZJJ.log("[\u9676\u7f50]\u9500\u6bc1"+t);var e=cc.director.getTotalFrames();this.tlDestroy.add(t),this.tmFrame.set(t,e)},e.prototype.updateDestroy=function(){var t,e,r=this.Battle,o=this.tlDestroy,n=this.tmFrame,i=cc.director.getTotalFrames();if(o.size>0){var l=!1;try{for(var s=a(o),c=s.next();!c.done;c=s.next()){var u=c.value;i-n.get(u)>0&&(l=!0,this.ComVar.BEHIT_DURATION[u]=0,o.delete(u),n.delete(u),r.removeEntity(u))}}catch(p){t={error:p}}finally{try{c&&!c.done&&(e=s.return)&&e.call(s)}finally{if(t)throw t.error}}l&&r.applyModify()}},e.prototype.updateType=function(){this.ComType.ApplyAdd()},e.prototype.CreateHero=function(t){var e=T.RBHero.Create(t),r=this.ApplyBuilder(e);return this.GetEventProxy().execute("CreateHero"),r},e.prototype.CreateBox=function(t,e){var r=l(this.SystemMove.fixPosMove(t,e),2),o=r[0],n=r[1],i=_.RBBox.Create(o,n);return this.ApplyBuilder(i)},Object.defineProperty(e.prototype,"rbMonster",{get:function(){if(null==this._rbMonster){var t=new q.RBContext;this._rbMonster=new L.RBMonster,this._rbMonster.Setup(t)}else this._rbMonster.Setup(this._rbMonster.context);return this._rbMonster},enumerable:!1,configurable:!0}),e.prototype.CreateEntity=function(t,e,r){isNaN(e);var o=this.rbMonster,n=o.context,i=l(this.SystemMove.fixPosMove(e,r),2),a=i[0],s=i[1];o.UpdateContext(n,t,a,s);var c=this.ApplyBuilder(o);return this.ComVar.SHOOT_TARGET[c]=this.ComVar.HEROID,c},e.prototype.ApplyBuilder=function(t,e){var r,o=l((r=this.Battle).addEntity2.apply(r,s(t.GetTlComClazz())),2),n=o[0],i=o[1];if(e){var a=this._needDestoryIds.get(e),c=this.Battle.getRef(n);a?a.push(c):this._needDestoryIds.set(e,[c])}return t.SetContainer(this.Battle.GetContainer()),t.SetCom(i),t.Apply(n),n},e.__cname="SystemRole",i([c.injectField("ComVar")],e.prototype,"ComVar",void 0),i([c.injectField("ComType")],e.prototype,"ComType",void 0),i([c.injectField("Battle")],e.prototype,"Battle",void 0),i([c.injectField("SystemMap")],e.prototype,"SystemMap",void 0),i([c.injectField("SystemMove")],e.prototype,"SystemMove",void 0),i([c.injectField("SystemRole")],e.prototype,"SystemRole",void 0),i([c.injectField("ModelBattleWave")],e.prototype,"ModelBattleWave",void 0),i([c.injectField("ModelHero")],e.prototype,"ModelHero",void 0),i([c.injectField("ModelBattleSkill")],e.prototype,"ModelBattleSkill",void 0),e}(f.BaseBattleSystem);r.SystemRole=K,cc._RF.pop()},{"../../../../../../framework/FW":void 0,"../../../../../../framework/container/Container":void 0,"../../../../../../framework/event/EventProxy":void 0,"../../base/BaseBattleSystem":"BaseBattleSystem","../type/ComType":"ComType","./RBBat":"RBBat","./RBBoom":"RBBoom","./RBBoomerange":"RBBoomerange","./RBBoomerangeSuper":"RBBoomerangeSuper","./RBBox":"RBBox","./RBBrick":"RBBrick","./RBCrossBow":"RBCrossBow","./RBDart":"RBDart","./RBDartSuperRed":"RBDartSuperRed","./RBDrill":"RBDrill","./RBDrillSuper":"RBDrillSuper","./RBDurian":"RBDurian","./RBDurianSuper":"RBDurianSuper","./RBField":"RBField","./RBFieldSlow":"RBFieldSlow","./RBFollow":"RBFollow","./RBFootball":"RBFootball","./RBGuarder":"RBGuarder","./RBHero":"RBHero","./RBLightning":"RBLightning","./RBLightningSuper":"RBLightningSuper","./RBMissile":"RBMissile","./RBMolotov":"RBMolotov","./RBMonster":"RBMonster","./RBPulses":"RBPulses","./RBRadiation":"RBRadiation","./RBRobotBullet":"RBRobotBullet","./RBStorm":"RBStorm","./RBStraights":"RBStraights","./RBSwordField":"RBSwordField","./RBVenom":"RBVenom","./RoleBuilder":"RoleBuilder"}],SystemSkill:[function(t,e,r){"use strict";cc._RF.push(e,"214600+qJNCdp3u/GKfev7n","SystemSkill");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.SystemSkill=void 0;var s=t("../../../../../../framework/container/Container"),c=t("../BaseLogicSystem"),u=t("./handler/SkillHandlerDart"),p=t("./hero/HeroSkillBat"),f=t("./hero/HeroSkillBoomerange"),h=t("./hero/HeroSkillBoomerangeSuper"),y=t("./hero/HeroSkillBow"),d=t("./hero/HeroSkillBrick"),m=t("./hero/HeroSkillBrickSuper"),v=t("./hero/HeroSkillDart"),_=t("./hero/HeroSkillDartSuper"),S=t("./hero/HeroSkillDrill"),g=t("./hero/HeroSkillDrillSuper"),b=t("./hero/HeroSkillDurian"),C=t("./hero/HeroSkillDurianSuper"),R=t("./hero/HeroSkillField"),M=t("./hero/HeroSkillFieldSuper"),w=t("./hero/HeroSkillFootball"),O=t("./hero/HeroSkillGuarder"),B=t("./hero/HeroSkillGuarderSuper"),P=t("./hero/HeroSkillKanata"),G=t("./hero/HeroSkillKanataS"),k=t("./hero/HeroSkillLightning"),x=t("./hero/HeroSkillLunhui"),T=t("./hero/HeroSkillMissile"),j=t("./hero/HeroSkillMolotov"),I=t("./hero/HeroSkillRobotBullet"),D=t("./hero/HeroSkillRobotBulletSuper"),F=t("./hero/HeroSkillShotgun"),L=t("./hero/HeroSkillShotgunSuper"),E=t("./hero/HeroSkillSwordField"),A=t("./others/OtherSkillBrickSuper"),V=t("./others/OtherSkillCharge"),U=t("./others/OtherSkillCircle"),W=t("./others/OtherSkillDeathWhisper"),H=t("./others/OtherSkillGuarder"),N=t("./others/OtherSkillSelfBoom"),q=t("./others/OtherSkillShotgun"),K=t("./others/OthersSkillDart"),X=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._start=!1,e.tmId2Skill=new Map,e.tmHandler=new Map,e}return n(e,t),e.prototype.beforeStartAsync=function(){return null},e.prototype.onInit=function(){this.CreateHandler(u.SkillHandlerDart),this.CreateSkill(1e4,v.HeroSkillDart),this.CreateSkill(10001,_.HeroSkillDartSuper),this.CreateSkill(10029,O.HeroSkillGuarder),this.CreateSkill(10030,B.HeroSkillGuarderSuper),this.CreateSkill(10018,T.HeroSkillMissile),this.CreateSkill(10019,T.HeroSkillMissile),this.CreateSkill(10027,w.HeroSkillFootball),this.CreateSkill(10028,w.HeroSkillFootball),this.CreateSkill(10016,d.HeroSkillBrick),this.CreateSkill(10017,m.HeroSkillBrickSuper),this.CreateSkill(10020,b.HeroSkillDurian),this.CreateSkill(10021,C.HeroSkillDurianSuper),this.CreateSkill(10033,E.HeroSkillSwordField),this.CreateSkill(10034,E.HeroSkillSwordField),this.CreateSkill(10025,S.HeroSkillDrill),this.CreateSkill(10026,g.HeroSkillDrillSuper),this.CreateSkill(10014,R.HeroSkillField),this.CreateSkill(10015,M.HeroSkillFieldSuper),this.CreateSkill(10035,x.HeroSkillLunhui),this.CreateSkill(10036,x.HeroSkillLunhui),this.CreateSkill(10010,f.HeroSkillBoomerange),this.CreateSkill(10011,h.HeroSkillBoomerangeSuper),this.CreateSkill(10031,k.HeroSkillLightning),this.CreateSkill(10032,k.HeroSkillLightning),this.CreateSkill(10012,j.HeroSkillMolotov),this.CreateSkill(10013,j.HeroSkillMolotov),this.CreateSkill(10023,I.HeroSkillRobotBullet),this.CreateSkill(10024,I.HeroSkillRobotBullet),this.CreateSkill(10022,D.HeroSkillRobotBulletSuper),this.CreateSkill(10002,F.HeroSkillShotgun),this.CreateSkill(10003,L.HeroSkillShotgunSuper),this.CreateSkill(10004,y.HeroSkillBow),this.CreateSkill(10005,y.HeroSkillBow),this.CreateSkill(10037,p.HeroSkillBat),this.CreateSkill(10038,p.HeroSkillBat),this.CreateSkill(10006,P.HeroSkillKanata),this.CreateSkill(10007,P.HeroSkillKanata),this.CreateSkill(10008,G.HeroSkillKanataS),this.CreateSkill(10009,G.HeroSkillKanataS),this.CreateSkill(13e3,K.OthersSkillDart),this.CreateSkill(13010,q.OtherSkillShotgun),this.CreateSkill(13020,H.OtherSkillGuarder),this.CreateSkill(13030,U.OtherSkillCircle),this.CreateSkill(13040,A.OtherSkillBrickSuper),this.CreateSkill(13050,W.OtherSkillDeathWhisper),this.CreateSkill(13060,N.OtherSkillSelfBoom),this.CreateSkill(13070,V.OtherSkillCharge)},e.prototype.onStart=function(){var t,e,r,o;try{for(var n=a(this.tmHandler),i=n.next();!i.done;i=n.next()){var s=l(i.value,2),c=(s[0],s[1]);this.container.inject(c)}}catch(y){t={error:y}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}try{for(var u=a(this.tmId2Skill),p=u.next();!p.done;p=u.next()){var f=l(p.value,2),h=(f[0],f[1]);this.container.inject(h),h.Enter(this.container)}}catch(d){r={error:d}}finally{try{p&&!p.done&&(o=u.return)&&o.call(u)}finally{if(r)throw r.error}}this._start=!0},e.prototype.onDestroy=function(){var t,e,r,o;try{for(var n=a(this.tmId2Skill),i=n.next();!i.done;i=n.next()){var s=l(i.value,2);s[0],s[1].Exit()}}catch(f){t={error:f}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}try{for(var c=a(this.tmId2Skill),u=c.next();!u.done;u=c.next()){var p=l(u.value,2);p[0],p[1].destroy()}}catch(h){r={error:h}}finally{try{u&&!u.done&&(o=c.return)&&o.call(c)}finally{if(r)throw r.error}}this.tmId2Skill.clear()},e.prototype.onUpdate=function(t){var e,r;if(0!=this._start&&!this.Battle.startConfig.bossNodeChest)try{for(var o=a(this.tmId2Skill),n=o.next();!n.done;n=o.next()){var i=l(n.value,2);i[0],i[1].OnUpdate(t)}}catch(s){e={error:s}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}},e.prototype.CreateSkill=function(t,e){var r=new e;r.SetResId(t),this.tmId2Skill.set(t,r)},e.prototype.CreateHandler=function(t){var e=new t;this.container.collectObj(e),this.tmHandler.set(t,e)},e.prototype.GetHandler=function(t){return this.tmHandler.get(t)},e.prototype.GetSkillById=function(t){return this.tmId2Skill.get(t)},e.__cname="SystemSkill",i([s.injectField("Ref")],e.prototype,"Ref",void 0),i([s.injectField("ModelBattleSkill")],e.prototype,"ModelBattleSkill",void 0),i([s.injectField("Battle")],e.prototype,"Battle",void 0),e}(c.BaseLogicSystem);r.SystemSkill=X,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../BaseLogicSystem":"BaseLogicSystem","./handler/SkillHandlerDart":"SkillHandlerDart","./hero/HeroSkillBat":"HeroSkillBat","./hero/HeroSkillBoomerange":"HeroSkillBoomerange","./hero/HeroSkillBoomerangeSuper":"HeroSkillBoomerangeSuper","./hero/HeroSkillBow":"HeroSkillBow","./hero/HeroSkillBrick":"HeroSkillBrick","./hero/HeroSkillBrickSuper":"HeroSkillBrickSuper","./hero/HeroSkillDart":"HeroSkillDart","./hero/HeroSkillDartSuper":"HeroSkillDartSuper","./hero/HeroSkillDrill":"HeroSkillDrill","./hero/HeroSkillDrillSuper":"HeroSkillDrillSuper","./hero/HeroSkillDurian":"HeroSkillDurian","./hero/HeroSkillDurianSuper":"HeroSkillDurianSuper","./hero/HeroSkillField":"HeroSkillField","./hero/HeroSkillFieldSuper":"HeroSkillFieldSuper","./hero/HeroSkillFootball":"HeroSkillFootball","./hero/HeroSkillGuarder":"HeroSkillGuarder","./hero/HeroSkillGuarderSuper":"HeroSkillGuarderSuper","./hero/HeroSkillKanata":"HeroSkillKanata","./hero/HeroSkillKanataS":"HeroSkillKanataS","./hero/HeroSkillLightning":"HeroSkillLightning","./hero/HeroSkillLunhui":"HeroSkillLunhui","./hero/HeroSkillMissile":"HeroSkillMissile","./hero/HeroSkillMolotov":"HeroSkillMolotov","./hero/HeroSkillRobotBullet":"HeroSkillRobotBullet","./hero/HeroSkillRobotBulletSuper":"HeroSkillRobotBulletSuper","./hero/HeroSkillShotgun":"HeroSkillShotgun","./hero/HeroSkillShotgunSuper":"HeroSkillShotgunSuper","./hero/HeroSkillSwordField":"HeroSkillSwordField","./others/OtherSkillBrickSuper":"OtherSkillBrickSuper","./others/OtherSkillCharge":"OtherSkillCharge","./others/OtherSkillCircle":"OtherSkillCircle","./others/OtherSkillDeathWhisper":"OtherSkillDeathWhisper","./others/OtherSkillGuarder":"OtherSkillGuarder","./others/OtherSkillSelfBoom":"OtherSkillSelfBoom","./others/OtherSkillShotgun":"OtherSkillShotgun","./others/OthersSkillDart":"OthersSkillDart"}],SystemSpawnPreload:[function(t,e,r){"use strict";cc._RF.push(e,"cdb2fd9CptPQrF8yJAhwpPx","SystemSpawnPreload");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},c=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.SystemSpawnPreload=void 0;var u=t("../../../../../../framework/container/Container"),p=t("../../../../../../framework/FW"),f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._tmPreload=new Map,e._temp=new Map,e._PreloadBy=[],e._hasLoadPoint=new Set,e}return n(e,t),e.prototype.onDestroy=function(){},e.prototype.onInit=function(){},e.prototype.onRelease=function(){},e.prototype.beforeStartAsync=function(){return a(this,void 0,void 0,function(){return l(this,function(t){switch(t.label){case 0:return this.InitData(),[4,this.PreloadFrist()];case 1:return t.sent(),p.FW.ZJJ.log("\u9884\u52a0\u8f7d\u6210\u529f"),[2]}})})},e.prototype.onStart=function(){},e.prototype.Update=function(e){t.prototype.Update.call(this,e),this.LateUpdate(e)},e.prototype.LateUpdate=function(){var t=this.SystemSpawn.GetPoint();this.PreloadBy(t)},e.prototype.InitData=function(){var t,e,r,o,n=this.Battle.startConfig.waveId,i=this.ModelBattleWave.GetWave(n).wavePlanId,a=this.ModelBattleWave.GetWaveNums(i),l=this._temp,u=this._tmPreload;l.clear(),u.clear();try{for(var p=s(a),f=p.next();!f.done;f=p.next()){var h=f.value,y=h.GetMonster(),d=h.GetPoint();0==l.has(y)&&l.set(y,d)}}catch(M){t={error:M}}finally{try{f&&!f.done&&(e=p.return)&&e.call(p)}finally{if(t)throw t.error}}try{for(var m=s(l),v=m.next();!v.done;v=m.next()){var _=c(v.value,2),S=(y=_[0],d=_[1],this.ModelBattleWave.GetMonsterBy(n,y)),g="\u602a\u7269\u914d\u7f6e\u9519\u8bef: waveId:"+n+" monsterIndex:"+y+" point:"+d;this.assert(null!=S,g);var b=S.GetModel();this.assert(null!=b,g);var C=this.ModelBattleWave.FixPointTime(n,d-5),R={point:C,model:b};this.AddTmPreload(C,R),(null==this._firstPoint||this._firstPoint>C)&&(this._firstPoint=C)}}catch(w){r={error:w}}finally{try{v&&!v.done&&(o=m.return)&&o.call(m)}finally{if(r)throw r.error}}},e.prototype.AddTmPreload=function(t,e){var r=this._tmPreload.get(t);null==r&&(r=[],this._tmPreload.set(t,r)),r.push(e)},e.prototype.GetPreloadHandlerByPoint=function(t){return this._tmPreload.get(t)},e.prototype.PreloadBy=function(t){return a(this,void 0,void 0,function(){var e,r,o,n,i,a,c,u,f,h,y,d;return l(this,function(l){switch(l.label){case 0:if(this._hasLoadPoint.has(t))return[2];if(this._hasLoadPoint.add(t),(e=this._PreloadBy).length=0,r=this.GetPreloadHandlerByPoint(t))try{for(o=s(r),n=o.next();!n.done;n=o.next())i=n.value,a=i.model,c=this.ModelPrefab.PreLoadAsset(a),e.push(c)}catch(m){y={error:m}}finally{try{n&&!n.done&&(d=o.return)&&d.call(o)}finally{if(y)throw y.error}}return p.FW.ZJJ.getEnabled()&&(u=r.map(function(t){return t.model}).join(),p.FW.ZJJ.log("\u9884\u52a0\u8f7d: "+u)),e&&e.length>0?(f=!1,h=function(){f=!0},Promise.all(r).then(function(){return h()}).catch(function(t){h(),t&&p.FW.ZJJ.error(t)}),[4,p.FW.Task.waitUntil(function(){return f})]):[3,2];case 1:l.sent(),l.label=2;case 2:return[2]}})})},e.prototype.PreloadFrist=function(){return a(this,void 0,void 0,function(){var t;return l(this,function(e){switch(e.label){case 0:return null==(t=this._firstPoint)?[3,2]:[4,this.PreloadBy(t)];case 1:e.sent(),e.label=2;case 2:return[2]}})})},e.__cname="SystemSpawnPreload",i([u.injectField("ModelBattleWave")],e.prototype,"ModelBattleWave",void 0),i([u.injectField("ModelPrefab")],e.prototype,"ModelPrefab",void 0),i([u.injectField("Battle")],e.prototype,"Battle",void 0),i([u.injectField("SystemSpawn")],e.prototype,"SystemSpawn",void 0),e}(t("../BaseViewSystem").BaseViewSystem);r.SystemSpawnPreload=f,cc._RF.pop()},{"../../../../../../framework/FW":void 0,"../../../../../../framework/container/Container":void 0,"../BaseViewSystem":"BaseViewSystem"}],SystemSpawn:[function(t,e,r){"use strict";cc._RF.push(e,"47c2dTgmstOBLCsodV++MbH","SystemSpawn");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.SystemSpawn=void 0;var s=t("../../../../../../framework/container/Container"),c=t("../../../../../../framework/utils/Toolset"),u=t("../BaseLogicSystem"),p=t("../event/SystemEvent"),f=t("./fsm/SpawnFSM"),h=t("./sub/SubSpawnBox"),y=t("./sub/SubSpawnBuilder"),d=t("./sub/SubSpawnCameraZoom"),m=t("./sub/SubSpawnClear"),v=t("./sub/SubSpawnMonster"),_=t("./sub/SubSpawnPrefab"),S=t("./sub/SubSpawnTimer"),g=t("./sub/SubSpawnTips"),b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tmSub=new Map,e.debugwin=!1,e.pause=!1,e.stop=!1,e._tlDebugWave=[],e}return n(e,t),Object.defineProperty(e.prototype,"startConfig",{get:function(){return this.Battle.startConfig},enumerable:!1,configurable:!0}),e.prototype.onInit=function(t,e){var r,o;this.container=e,this.toolSet=c.ToolSet.createToolSet(),this.SubBuilder=this.CreateSub(y.SubSpawnBuilder),this.SubPrefab=this.CreateSub(_.SubSpawnPrefab),this.SubMonster=this.CreateSub(v.SubSpawnMonster),this.SubTimer=this.CreateSub(S.SubSpawnTimer),this.SubBox=this.CreateSub(h.SubSpawnBox),this.SubSpawnTips=this.CreateSub(g.SubSpawnTips),this.SubSpawnCameraZoom=this.CreateSub(d.SubSpawnCameraZoom),this.SubSpawnClear=this.CreateSub(m.SubSpawnClear),this.initFSM();try{for(var n=a(this.tmSub),i=n.next();!i.done;i=n.next()){var s=l(i.value,2);s[0],s[1].Init(this,e)}}catch(u){r={error:u}}finally{try{i&&!i.done&&(o=n.return)&&o.call(n)}finally{if(r)throw r.error}}},e.prototype.onDestroy=function(){var t,e,r,o;try{for(var n=a(this.tmSub),i=n.next();!i.done;i=n.next()){var s=l(i.value,2);s[0],s[1].Exit()}}catch(h){t={error:h}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}try{for(var u=a(this.tmSub),p=u.next();!p.done;p=u.next()){var f=l(p.value,2);f[0],f[1].destroy()}}catch(y){r={error:y}}finally{try{p&&!p.done&&(o=u.return)&&o.call(u)}finally{if(r)throw r.error}}this.tmSub.clear(),this.SpawnFSM.Release(),this.releaseFSM(),c.ToolSet.destroyToolSet(this.toolSet)},e.prototype.beforeStartAsync=function(){var t,e,r,o;try{for(var n=a(this.tmSub),i=n.next();!i.done;i=n.next()){var s=l(i.value,2),c=(s[0],s[1]);this.container.inject(c)}}catch(d){t={error:d}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}var u=[];try{for(var p=a(this.tmSub),f=p.next();!f.done;f=p.next()){var h=l(f.value,2),y=(h[0],(c=h[1]).EnterAsync());y&&u.push(y)}}catch(m){r={error:m}}finally{try{f&&!f.done&&(o=p.return)&&o.call(p)}finally{if(r)throw r.error}}return Promise.all(u)},e.prototype.onStart=function(){var t,e,r=this;this.SpawnFSM.Start(),this.startConfig.starttime&&this.SetStartTime(this.startConfig.starttime),this.InitGameTime();try{for(var o=a(this.tmSub),n=o.next();!n.done;n=o.next()){var i=l(n.value,2);i[0],i[1].Enter()}}catch(s){t={error:s}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}this.startConfig.debugField?this.SpawnFSM.switchTo("debugfield"):this.SpawnFSM.SwitchIdle(),this.toolSet.addListener(this.SystemEvent.GetEventPorxy(),p.EBattleEvent.DebugWin,function(){r.debugwin=!0})},e.prototype.onUpdate=function(t){this.pause||this.UpdateMain(t),this.SpawnFSM.update(t),this.SubPrefab.Update(t),this.SubBuilder.Update(t)},e.prototype.UpdateMain=function(t){if(!this.stop){if(this.SubTimer.Update(t),this.debugwin)return this.stop=!0,this.SystemEvent.sendkillAllMonsterBoss(),void this.SystemGamePlay.DebugWin();var e=this.SubTimer.GetTime()>10,r=0==this.SubMonster.HasNextWave();if(e&&r)return console.log("\u80dc\u5229\u4e86"),this.stop=!0,this.SystemEvent.sendkillAllMonsterBoss(),void this.SystemGamePlay.Win();this.SubMonster.Update(t),this.SubSpawnTips.Update(t),this.SubBox.Update(t),this.SubSpawnCameraZoom.Update(t),this.SubSpawnClear.Update(t)}},e.prototype.SetStartTime=function(t){this.SubTimer.SetStartTime(t)},e.prototype.CreateSub=function(t){var e=new t;return this.tmSub.set(t,e),e},e.prototype.GetSub=function(t){return this.tmSub.get(t)},e.prototype.initFSM=function(){var t=new f.SpawnFSM(this.container);this.SpawnFSM=t},e.prototype.releaseFSM=function(){this.SpawnFSM.destroy()},e.prototype.GetSpawnFsm=function(){return this.SpawnFSM},e.prototype.GetPoint=function(){return this.SubTimer.GetPoint()},e.prototype.ApplyCurrentWave=function(){this.SubMonster.ApplyWave()},e.prototype.PushDebugWave=function(t,e,r){this._tlDebugWave.push([t,e,r])},e.prototype.ApplyDebugWave=function(){var t,e;try{for(var r=a(this._tlDebugWave),o=r.next();!o.done;o=r.next()){var n=o.value;this.SubMonster.ApplyDebug(n[0],n[1],n[2])}}catch(i){t={error:i}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}this._tlDebugWave.length=0},e.prototype.HasDebugWave=function(){return this._tlDebugWave.length>0},e.prototype.SetDebugSpawn=function(t){this._debugSpawn=t},e.prototype.GetDebugSpwan=function(){return this._debugSpawn},e.prototype.InitGameTime=function(){var t=this.Battle.startConfig.waveId;this.ComVar.takeTotalTime(this.ModelBattleWave.GetTotalTime(t)),this.ComVar.takeStartTime(0),this.ComVar.takeGametime(this.SubTimer.GetTime())},e.__cname="SystemSpawn",i([s.injectField("Battle")],e.prototype,"Battle",void 0),i([s.injectField("ComVar")],e.prototype,"ComVar",void 0),i([s.injectField("SystemEvent")],e.prototype,"SystemEvent",void 0),i([s.injectField("SystemGamePlay")],e.prototype,"SystemGamePlay",void 0),i([s.injectField("ModelBattleWave")],e.prototype,"ModelBattleWave",void 0),e}(u.BaseLogicSystem);r.SystemSpawn=b,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../../../../../framework/utils/Toolset":void 0,"../BaseLogicSystem":"BaseLogicSystem","../event/SystemEvent":"SystemEvent","./fsm/SpawnFSM":"SpawnFSM","./sub/SubSpawnBox":"SubSpawnBox","./sub/SubSpawnBuilder":"SubSpawnBuilder","./sub/SubSpawnCameraZoom":"SubSpawnCameraZoom","./sub/SubSpawnClear":"SubSpawnClear","./sub/SubSpawnMonster":"SubSpawnMonster","./sub/SubSpawnPrefab":"SubSpawnPrefab","./sub/SubSpawnTimer":"SubSpawnTimer","./sub/SubSpawnTips":"SubSpawnTips"}],SystemState:[function(t,e,r){"use strict";cc._RF.push(e,"25a6dpab9RKWYxE/Jvp4LgP","SystemState");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.SystemState=r.ComStateType=void 0;var s,c=t("../../../../../../framework/container/Container"),u=t("../../../../../../framework/ecs/GroupSet"),p=t("./base/SubStateConjure"),f=t("./base/SubStateDestroy"),h=t("./base/SubStateDie"),y=t("./base/SubStateIdle"),d=t("./base/SubStateMove"),m=t("./bullet/SubStateBat"),v=t("./bullet/SubStateBoom"),_=t("./bullet/SubStateBoomerange"),S=t("./bullet/SubStateBoomerangeSuper"),g=t("./bullet/SubStateBrick"),b=t("./bullet/SubStateCrossBow"),C=t("./bullet/SubStateDart"),R=t("./bullet/SubStateDartSuperRed"),M=t("./bullet/SubStateDrill"),w=t("./bullet/SubStateDrillSuper"),O=t("./bullet/SubStateDurian"),B=t("./bullet/SubStateField"),P=t("./bullet/SubStateFieldSlow"),G=t("./bullet/SubStateFollow"),k=t("./bullet/SubStateFootball"),x=t("./bullet/SubStateGuarder"),T=t("./bullet/SubStateLightning"),j=t("./bullet/SubStateLightningSuper"),I=t("./bullet/SubStateMissile"),D=t("./bullet/SubStateMolotov"),F=t("./bullet/SubStatePulses"),L=t("./bullet/SubStateRadiation"),E=t("./bullet/SubStateRobotBullet"),A=t("./bullet/SubStateStorm"),V=t("./bullet/SubStateStraight"),U=t("./bullet/SubStateSwordField"),W=t("./bullet/SubStateVenom"),H=t("./ComState"),N=t("./others/SubStateCharge"),q=t("./others/SubStateChargeLeave"),K=t("./others/SubStateKeep"),X=t("./others/SubStateReborn"),z=t("./others/SubStateSeek"),J=t("./others/SubStateSelfBoom"),Y=t("./others/SubStateShoot"),Z=t("./others/SubStateStatic"),Q=t("./others/SubStateWander"),$=t("./others/SubStateWanderVertical");(function(t){t[t.IDLE=0]="IDLE",t[t.MOVE=1]="MOVE",t[t.DESTROY=2]="DESTROY",t[t.DIE=3]="DIE",t[t.REBORN=4]="REBORN",t[t.CONJURE=5]="CONJURE",t[t.STRAIGHT=6]="STRAIGHT",t[t.DART=7]="DART",t[t.DART_SUPER_RED=8]="DART_SUPER_RED",t[t.SWORD_FIELD=9]="SWORD_FIELD",t[t.BOOMERANGE=10]="BOOMERANGE",t[t.BOOMERANGE_SUPER=11]="BOOMERANGE_SUPER",t[t.FIELD=12]="FIELD",t[t.GUARDER=13]="GUARDER",t[t.MISSILE=14]="MISSILE",t[t.FOOTBALL=15]="FOOTBALL",t[t.BRICK=16]="BRICK",t[t.DURIAN=17]="DURIAN",t[t.DRILL=18]="DRILL",t[t.DRILL_SUPER=19]="DRILL_SUPER",t[t.LIGHTNING=20]="LIGHTNING",t[t.LIGHTNING_SUPER=21]="LIGHTNING_SUPER",t[t.MOLOTOV=22]="MOLOTOV",t[t.ROBOT_BULLET=23]="ROBOT_BULLET",t[t.BAT=24]="BAT",t[t.VENOM=25]="VENOM",t[t.CROSS_BOW=26]="CROSS_BOW",t[t.FIELD_SLOW=27]="FIELD_SLOW",t[t.STORM=28]="STORM",t[t.PULSES=29]="PULSES",t[t.RADIATION=30]="RADIATION",t[t.BOOM=31]="BOOM",t[t.FOLLOW=32]="FOLLOW",t[t.STATIC=33]="STATIC",t[t.SEEK=34]="SEEK",t[t.CHARGE=35]="CHARGE",t[t.KEEP=36]="KEEP",t[t.WANDER_VERTICAL=37]="WANDER_VERTICAL",t[t.WANDER=38]="WANDER",t[t.CHARGE_LEAVE=39]="CHARGE_LEAVE",t[t.SELF_BOOM=40]="SELF_BOOM",t[t.SHOOT=41]="SHOOT",t[t.COUNT=42]="COUNT"})(s=r.ComStateType||(r.ComStateType={}));var tt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tlComClazz=[H.ComState],e.tmSub=new Map,e}return n(e,t),e.prototype.createSub=function(t,e){var r=this.container.collectClass(e);return this.tmSub.set(t,r),r},e.prototype.getSub=function(t){return this.tmSub.get(t)},e.prototype.onRemoveEntity=function(e){this.ExitState(e),t.prototype.onRemoveEntity.call(this,e)},e.prototype.onInit=function(){this.createSub(s.IDLE,y.SubStateIdle),this.createSub(s.MOVE,d.SubStateMove),this.createSub(s.DESTROY,f.SubStateDestroy),this.createSub(s.DIE,h.SubStateDie),this.createSub(s.REBORN,X.SubStateReborn),this.createSub(s.CONJURE,p.SubStateConjure),this.createSub(s.STRAIGHT,V.SubStateStraight),this.createSub(s.DART,C.SubStateDart),this.createSub(s.DART_SUPER_RED,R.SubStateDartSuperRed),this.createSub(s.SWORD_FIELD,U.SubStateSwordField),this.createSub(s.BOOMERANGE,_.SubStateBoomerange),this.createSub(s.BOOMERANGE_SUPER,S.SubStateBoomerangeSuper),this.createSub(s.FIELD,B.SubStateField),this.createSub(s.GUARDER,x.SubStateGuarder),this.createSub(s.MISSILE,I.SubStateMissile),this.createSub(s.FOOTBALL,k.SubStateFootball),this.createSub(s.BRICK,g.SubStateBrick),this.createSub(s.DURIAN,O.SubStateDurian),this.createSub(s.DRILL,M.SubStateDrill),this.createSub(s.DRILL_SUPER,w.SubStateDrillSuper),this.createSub(s.LIGHTNING,T.SubStateLightning),this.createSub(s.LIGHTNING_SUPER,j.SubStateLightningSuper),this.createSub(s.MOLOTOV,D.SubStateMolotov),this.createSub(s.ROBOT_BULLET,E.SubStateRobotBullet),this.createSub(s.BAT,m.SubStateBat),this.createSub(s.VENOM,W.SubStateVenom),this.createSub(s.CROSS_BOW,b.SubStateCrossBow),this.createSub(s.FIELD_SLOW,P.SubStateFieldSlow),this.createSub(s.STORM,A.SubStateStorm),this.createSub(s.PULSES,F.SubStatePulses),this.createSub(s.RADIATION,L.SubStateRadiation),this.createSub(s.BOOM,v.SubStateBoom),this.createSub(s.FOLLOW,G.SubStateFollow),this.createSub(s.STATIC,Z.SubStateStatic),this.createSub(s.SEEK,z.SubStateSeek),this.createSub(s.SHOOT,Y.SubStateShoot),this.createSub(s.CHARGE,N.SubStateCharge),this.createSub(s.KEEP,K.SubStateKeep),this.createSub(s.WANDER_VERTICAL,$.SubStateWanderVertical),this.createSub(s.WANDER,Q.SubStateWander),this.createSub(s.CHARGE_LEAVE,q.SubStateChargeLeave),this.createSub(s.SELF_BOOM,J.SubStateSelfBoom)},e.prototype.onDestroy=function(){var e,r;try{for(var o=a(this.tmSub),n=o.next();!n.done;n=o.next()){var i=l(n.value,2);i[0],i[1].destroy()}}catch(s){e={error:s}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}t.prototype.onDestroy.call(this),this.ComState=null,this.tlComClazz=null,this.tmSub=null},e.prototype.onUpdate=function(t){var e,r,o,n,i=this.ComState.type,c=this.ComState.nextType,u=this.ComState.lastType,p=this.ComState.nextDestory,f=this.ComState.param,h=this.ComState.nextParam,y=this.ComState.lastParam,d=this.ComState.locked,m=this.tmSub;try{for(var v=a(this.ids),_=v.next();!_.done;_=v.next()){var S=_.value,g=c[S];if(!d[S]||g===s.DESTROY||g===s.DIE||p[S]){var b=i[S],C=f[S],R=h[S];if(c[S]=null,h[S]=null,null!=g&&(b!=g||C!=R)){u[S]==g?(u[S]=null,y[S]=null):(u[S]=b,y[S]=C);var M=m.get(b),w=m.get(g);M&&M.exit(S),i[S]=g,f[S]=R,w&&w.enter(S)}}}}catch(G){e={error:G}}finally{try{_&&!_.done&&(r=v.return)&&r.call(v)}finally{if(e)throw e.error}}try{for(var O=a(this.tmSub),B=O.next();!B.done;B=O.next()){var P=l(B.value,2);P[0],P[1].Update(t)}}catch(k){o={error:k}}finally{try{B&&!B.done&&(n=O.return)&&n.call(O)}finally{if(o)throw o.error}}},e.prototype.ExitState=function(t){var e=this.tmSub,r=this.ComState.type[t],o=e.get(r);o&&o.exit(t)},e.__cname="SystemState",i([c.injectField("ComState")],e.prototype,"ComState",void 0),e}(u.GroupSet);r.SystemState=tt,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../../../../../framework/ecs/GroupSet":void 0,"./ComState":"ComState","./base/SubStateConjure":"SubStateConjure","./base/SubStateDestroy":"SubStateDestroy","./base/SubStateDie":"SubStateDie","./base/SubStateIdle":"SubStateIdle","./base/SubStateMove":"SubStateMove","./bullet/SubStateBat":"SubStateBat","./bullet/SubStateBoom":"SubStateBoom","./bullet/SubStateBoomerange":"SubStateBoomerange","./bullet/SubStateBoomerangeSuper":"SubStateBoomerangeSuper","./bullet/SubStateBrick":"SubStateBrick","./bullet/SubStateCrossBow":"SubStateCrossBow","./bullet/SubStateDart":"SubStateDart","./bullet/SubStateDartSuperRed":"SubStateDartSuperRed","./bullet/SubStateDrill":"SubStateDrill","./bullet/SubStateDrillSuper":"SubStateDrillSuper","./bullet/SubStateDurian":"SubStateDurian","./bullet/SubStateField":"SubStateField","./bullet/SubStateFieldSlow":"SubStateFieldSlow","./bullet/SubStateFollow":"SubStateFollow","./bullet/SubStateFootball":"SubStateFootball","./bullet/SubStateGuarder":"SubStateGuarder","./bullet/SubStateLightning":"SubStateLightning","./bullet/SubStateLightningSuper":"SubStateLightningSuper","./bullet/SubStateMissile":"SubStateMissile","./bullet/SubStateMolotov":"SubStateMolotov","./bullet/SubStatePulses":"SubStatePulses","./bullet/SubStateRadiation":"SubStateRadiation","./bullet/SubStateRobotBullet":"SubStateRobotBullet","./bullet/SubStateStorm":"SubStateStorm","./bullet/SubStateStraight":"SubStateStraight","./bullet/SubStateSwordField":"SubStateSwordField","./bullet/SubStateVenom":"SubStateVenom","./others/SubStateCharge":"SubStateCharge","./others/SubStateChargeLeave":"SubStateChargeLeave","./others/SubStateKeep":"SubStateKeep","./others/SubStateReborn":"SubStateReborn","./others/SubStateSeek":"SubStateSeek","./others/SubStateSelfBoom":"SubStateSelfBoom","./others/SubStateShoot":"SubStateShoot","./others/SubStateStatic":"SubStateStatic","./others/SubStateWander":"SubStateWander","./others/SubStateWanderVertical":"SubStateWanderVertical"}],SystemTarget:[function(t,e,r){"use strict";cc._RF.push(e,"265b2ep/69HH6UO4DeubpdC","SystemTarget");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.SystemTarget=void 0;var l=t("../../../../../framework/container/Container"),s=t("../../../../../framework/ecs/GroupSet"),c=t("./ai/ComAI"),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tlComClazz=[c.ComAI],e.candidate=[],e}return n(e,t),e.prototype.onUpdate=function(){this.findNearTarget()},e.prototype.findNearTarget=function(){var t,e,r,o,n=this.ComVar.SHOOT_TARGET,i=this.SystemMove,l=this.ComPos.x,s=this.ComPos.y,c=this.ComVar.REACTION,u=(this.ComVar.ALIVE,this.candidate),p=this.ComVar.CAMP;this.ComType;try{for(var f=a(this.ids),h=f.next();!h.done;h=f.next()){var y=h.value;u.length=0,i.findOtherCampNoBullet(p[y],l[y],s[y],c[y],u);var d=void 0,m=void 0;try{for(var v=(r=void 0,a(u)),_=v.next();!_.done;_=v.next()){var S=_.value,g=l[S]-l[y],b=s[S]-s[y],C=g*g+b*b;(null==d||C<m)&&(d=S,m=C)}}catch(R){r={error:R}}finally{try{_&&!_.done&&(o=v.return)&&o.call(v)}finally{if(r)throw r.error}}n[y]=d}}catch(M){t={error:M}}finally{try{h&&!h.done&&(e=f.return)&&e.call(f)}finally{if(t)throw t.error}}},e.__cname="SystemTarget",i([l.injectField("ComVar")],e.prototype,"ComVar",void 0),i([l.injectField("ComPos")],e.prototype,"ComPos",void 0),i([l.injectField("SystemMove")],e.prototype,"SystemMove",void 0),i([l.injectField("ComType")],e.prototype,"ComType",void 0),e}(s.GroupSet);r.SystemTarget=u,cc._RF.pop()},{"../../../../../framework/container/Container":void 0,"../../../../../framework/ecs/GroupSet":void 0,"./ai/ComAI":"ComAI"}],SystemVar:[function(t,e,r){"use strict";cc._RF.push(e,"19167GXt79EY6HDdvhXJkqw","SystemVar");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},c=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.SystemVar=void 0;var u=t("../../../../../../framework/container/Container"),p=t("../../../../../../framework/coroutine/Cor"),f=t("../../../../../../framework/ecs/GroupSet"),h=t("../../../../../../framework/tween/TweenEase"),y=t("../../../../../../framework/utils/Toolset"),d=t("../../../attr/AttrWrapHandler"),m=t("../../view/nodeproxy/NodeProxy"),v=t("../event/SystemEvent"),_=t("../type/ComType"),S=t("./ComVar"),g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tlComClazz=[S.ComVar],e._isGameFinally=!1,e._behit=new Set,e._isLevelup=!1,e._time=0,e}return n(e,t),e.prototype.onInit=function(){this.toolSet=y.ToolSet.createToolSet(),this.cor_levelup=new p.Cor},e.prototype.onDestroy=function(){this.cor_levelup&&this.cor_levelup.destroy(),y.ToolSet.destroyToolSet(this.toolSet),t.prototype.onDestroy.call(this)},e.prototype.onStart=function(){var t,e,r=this;this.ComVar.updateExpMax(),this.toolSet.addListener(this.SystemEvent.GetEventPorxy(),v.EBattleEvent.KillMonster,function(){r.ComVar.takeKill()}),this.toolSet.addListener(this.SystemEvent.GetEventPorxy(),v.EBattleEvent.BossDown,function(t){r.GPAudio.resumeBoss(),r.ComVar.takeBossDown(t)},this),this.toolSet.addListener(this.SystemEvent.GetEventPorxy(),v.EBattleEvent.GameFinally,function(){r.GPAudio.resumeBoss(),r.OnGameFinally()});var o=new d.AttrWrapHandler;this.container.inject(o),this.toolSet.addDefer(function(){r.ComVar.HERO_ATTR=null});try{for(var n=s(this.CtrlAttr.GetTmAttr()),i=n.next();!i.done;i=n.next()){var a=c(i.value,2),l=a[0],u=a[1];o.CreateAttr(l).AddAttr(u)}}catch(p){t={error:p}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.toolSet.addCallback(o.GetChangeCallback(),function(){r._isGameFinally||r.update_hero_attr()}),this.ComVar.HERO_ATTR=o},e.prototype.onRelease=function(){},e.prototype.onUpdate=function(t){this.updateMonster(),this.updateInvincible(t),this.updateBehit(t),this.updateLevelup(),this.refershLevelUp(),this.update_rde(t)},e.prototype.OnGameFinally=function(){this._isGameFinally=!0,this.toolSet.removeAllCallback()},e.prototype.updateMonster=function(){var t,e,r,o,n=this.ComType.GetGroup(_.EComType.Monster),i=(this.ComVar.ALIVE,this.ComState),a=this.ComType,l=this.ComVar,c=(this.ComVelocity,this.ComVar.MONSTER_REF);try{for(var u=s(n),p=u.next();!p.done;p=u.next()){var f=p.value;l.HURT_ADD[f]>1?this.SystemViewWedgit.AddWedgit(f,"\u6218\u6597_\u6218\u6597\u573a\u666f\u7279\u6548_BUFF\u8bc5\u5492"):this.SystemViewWedgit.RemoveWedgit(f,"\u6218\u6597_\u6218\u6597\u573a\u666f\u7279\u6548_BUFF\u8bc5\u5492")}}catch(S){t={error:S}}finally{try{p&&!p.done&&(e=u.return)&&e.call(u)}finally{if(t)throw t.error}}try{for(var h=s(l.DIELIST),y=h.next();!y.done;y=h.next()){var d=y.value;l.SPEED_REDUCE[d]=0;var m=a.GetType(d);if(m!=_.EComType.Monster&&m!=_.EComType.BossGuardMonster)m!=_.EComType.PropBox?m!=_.EComType.Bullet||i.SwitchDestroy(d):(i.SwitchDestroy(d),this.SystemEvent.sendKillBox(d));else{this.SystemViewWedgit.RemoveWedgit(d,"\u6218\u6597_\u6218\u6597\u573a\u666f\u7279\u6548_BUFF\u72c2\u66b4"),this.SystemViewWedgit.RemoveWedgit(d,"\u6218\u6597_\u6218\u6597\u573a\u666f\u7279\u6548_BUFF\u9b54\u5316"),this.SystemViewWedgit.RemoveWedgit(d,"\u6218\u6597_\u6218\u6597\u573a\u666f\u7279\u6548_BUFF\u8bc5\u5492"),i.locked[d]=!1,i.nextDestory[d]=!0,i.SwitchDestroy(d),this.SystemEvent.sendKillMonster(d);var v=c[d];v&&v.GetIsElite()&&this.SystemEvent.sendEliteDown(d)}}}catch(g){r={error:g}}finally{try{y&&!y.done&&(o=h.return)&&o.call(h)}finally{if(r)throw r.error}}l.DIELIST.clear()},e.prototype.updateInvincible=function(t){var e,r,o=this.ComVar.INVINCIBLE,n=this.ComVar.INVINCIBLELIST;try{for(var i=s(n),a=i.next();!a.done;a=i.next()){var l=a.value;o[l]-=t,o[l]<=0&&(n.delete(l),o[l]=0)}}catch(c){e={error:c}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}},e.prototype.updateBehit=function(t){var e,r,o=this._behit,n=this.ComPrefab,i=(this.ComVar,this.ComVar.BEHIT_DURATION),a=this.ComVar.BEHIT_TIME,l=this.ComVar.BE_HIT_LIST,c=this.ComVar.BEHIT_SENDER;try{for(var u=s(l),p=u.next();!p.done;p=u.next()){var f=p.value;if(a[f]+=t,0==o.has(f))o.add(f),n.ChangeModel(f,n.model[f],n.anim[f],m.INodeProxyAni.Walk);else if(a[f]>i[f]){o.delete(f),l.delete(f),c[f]=null,a[f]=0,i[f]=0,n.ChangeModel(f,n.model[f],n.anim[f],m.INodeProxyAni.Idle);continue}this.updateBehitView(f)}}catch(h){e={error:h}}finally{try{p&&!p.done&&(r=u.return)&&r.call(u)}finally{if(e)throw e.error}}},e.prototype.updateBehitView=function(t){var e=this.ComVar.BEHIT_DURATION,r=this.ComVar.BEHIT_TIME,o=(this.ComVar.BE_HIT_LIST,this.ComVar.BEHIT_SENDER,this.ComPrefab),n=.5*e[t],i=e[t]-n;if(r[t]>n){var a=h.TweenEase.Linear(r[t]-n,1,-1,i);o.ChangeModel(t,o.model[t],o.anim[t],a)}},e.prototype.updateLevelup=function(){if(this.cor_levelup&&this.cor_levelup.Update(),this.ComVar.canLevelup()){if(this._isLevelup)return;this._isLevelup=!0,this.ComVar.LEVEL,this.ComVar.EXP>=this.ComVar.EXP_MAX&&(this.ComVar.isTakeLevelUp=!1,this.SystemEvent.sendLevelUp(),this.ComVar.takeLevelUpMonster())}},e.prototype.refershLevelUp=function(){var t=this.ComVar.EXP,e=this.ComVar.EXP_MAX,r=this.ComVar.LEVEL;if(1==this.ComVar.isTakeLevelUp){this.ComVar.isTakeLevelUp=!1;var o=t-e;this.ComVar.EXP=o,this.ComVar.LEVEL++,this.ComVar.updateExpMax(),this._isLevelup=!1,this.ComVar.LEVEL!=r&&this.SystemEvent.sendLevelUpEnd()}},e.prototype.updateLevelup_cor=function(t){return a(this,void 0,void 0,function(){var e,r,o,n=this;return l(this,function(i){switch(i.label){case 0:return 0==this.ComVar.canLevelup()?[3,4]:(e=this.ComVar.EXP,r=this.ComVar.EXP_MAX,e>=r?(this.ComVar.isTakeLevelUp=!1,this.SystemEvent.sendLevelUp(),this.ComVar.takeLevelUpMonster(),[4,p.Cor.WaitUntil_cor(t,function(){return 1==n.ComVar.isTakeLevelUp})]):[3,2]);case 1:return i.sent(),this.ComVar.isTakeLevelUp=!1,o=e-r,this.ComVar.EXP=o,this.ComVar.LEVEL++,this.ComVar.updateExpMax(),[3,3];case 2:return[3,4];case 3:return[3,0];case 4:return[2]}})})},e.prototype.update_rde=function(t){var e=this.ComVar.HEROID;if(this.ComVar.ALIVE[e]&&(this._time+=t,this._time>=5)){this._time=0;var r=this.ComVar.HP_Max[e],o=this.ComVar.GetAttrValue(e,"rde",0)+(this.ComVar.CalAttr(e,"rdem",r)-r);o>0&&this.ComVar.takeRDE(e,o)}},e.prototype.update_hero_attr=function(){if(!this._isGameFinally){var t=this.ComVelocity,e=this.ComVar;if(null!=e&&0!=e.isValid){var r=this.ComVar.HEROID;null!=r&&(t.speed[r]=e.GetAttrValue(r,"spd",100),e.takeHpMax(r,e.GetAttrValue(r,"hp",0)),e.ATK[r]=e.GetAttrValue(r,"atk",0),e.PICK_RANGE[r]=e.GetAttrValue(r,"pua",100),e.DEFENCE[r]=e.GetAttrValue(r,"dmr",0),e.MONSTER_ATK_ADD=e.CalAttr(r,"mda",1),e.MONSTER_HP_ADD=e.CalAttr(r,"mha",1),e.MONSTER_SPEED_ADD=e.CalAttr(r,"msa",1),e.BOSS_CREATE_NUM=e.CalAttr(r,"bpn",0),e.HERO_SKILL_LIMIT=e.CalAttr(r,"skf",0),e.MONSTER_DROP_RATE=e.CalAttr(r,"idp",1),e.ROLE_VIEW_RADIUS=e.CalAttr(r,"fvp",0),e.CRIT_RATE[r]=e.CalAttr(r,"crs",1),e.CRIT_DAMAGE[r]=e.CalAttr(r,"crd",2),e.TEN_DAMAGE_RATE[r]=e.CalAttr(r,"Hol",1),e.MONSTER_HP_DROP=e.CalAttr(r,"mhd",1),this.SystemCamera.SetViewMask(0!=e.ROLE_VIEW_RADIUS,e.ROLE_VIEW_RADIUS),e.UP_ADD_HP_FIX=e.CalAttr(r,"brh",0),e.UP_ADD_HP=e.CalAttr(r,"brp",1),this.Battle.startConfig.whosyourdaddy&&(e.INVINCIBLE[r]=Number.MAX_SAFE_INTEGER,e.ATK[r]=999999),e.HERO_ATTR.Dump())}}},e.__cname="SystemVar",i([u.injectField("ComVar")],e.prototype,"ComVar",void 0),i([u.injectField("ComType")],e.prototype,"ComType",void 0),i([u.injectField("ComState")],e.prototype,"ComState",void 0),i([u.injectField("ComPrefab")],e.prototype,"ComPrefab",void 0),i([u.injectField("ComVelocity")],e.prototype,"ComVelocity",void 0),i([u.injectField("ComPos")],e.prototype,"ComPos",void 0),i([u.injectField("ComCollision")],e.prototype,"ComCollision",void 0),i([u.injectField("SystemCamera")],e.prototype,"SystemCamera",void 0),i([u.injectField("SystemEvent")],e.prototype,"SystemEvent",void 0),i([u.injectField("SystemRole")],e.prototype,"SystemRole",void 0),i([u.injectField("ModelBattleLevel")],e.prototype,"ModelBattleLevel",void 0),i([u.injectField("CtrlAttr")],e.prototype,"CtrlAttr",void 0),i([u.injectField("GPAudio")],e.prototype,"GPAudio",void 0),i([u.injectField("SystemViewWedgit")],e.prototype,"SystemViewWedgit",void 0),i([u.injectField("SystemBuff")],e.prototype,"SystemBuff",void 0),e}(f.GroupSet);r.SystemVar=g,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../../../../../framework/coroutine/Cor":void 0,"../../../../../../framework/ecs/GroupSet":void 0,"../../../../../../framework/tween/TweenEase":void 0,"../../../../../../framework/utils/Toolset":void 0,"../../../attr/AttrWrapHandler":"AttrWrapHandler","../../view/nodeproxy/NodeProxy":"NodeProxy","../event/SystemEvent":"SystemEvent","../type/ComType":"ComType","./ComVar":"ComVar"}],SystemViewCulling:[function(t,e,r){"use strict";cc._RF.push(e,"41c90/2+SpJbrv/9d43Dp1I","SystemViewCulling");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.SystemViewCulling=void 0;var l=t("../../../../../framework/container/Container"),s=t("../logic/move/ComPos"),c=t("../logic/type/ComType"),u=t("./CullingGroup"),p=t("./prefab/ComPrefab"),f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tlComClazz=[p.ComPrefab],e.ids=new Set,e}return n(e,t),e.prototype.onAddEntity=function(t){var e=this.SystemView.GetNodeProxy(t);e&&(this.ids.add(t),e.SetActive(!0))},e.prototype.onRemoveEntity=function(t){var e=this.SystemView.GetNodeProxy(t);e&&e.SetActive(!1),this.ids.delete(t)},e.prototype.onUpdate=function(){var t,e,r=this.ComPos.x,o=this.ComPos.y,n=this.ComPos.d,i=this.ComPos.dType,l=this.ComPrefab.order;try{for(var u=a(this.ids),p=u.next();!p.done;p=u.next()){var f=p.value,h=this.SystemView.GetNodeProxy(f);if(null!=h){if(h.SetActive(!0),h.SetXY(r[f],o[f]),i[f]==s.EDirectionType.Normal){var y=180*n[f]/Math.PI;0==r[f]&&o[f],h.SetPropertype("rotation",y)}else if(i[f]==s.EDirectionType.LeftRight){(y=180*n[f]/Math.PI)<0&&(y+=360);var d=0<=y&&y<=90||270<=y%360;this.ComType.GetType(f)!=c.EComType.BossGuardMonster&&h.SetPropertype("flip",!d)}h.SetZIndex(l[f])}}}catch(m){t={error:m}}finally{try{p&&!p.done&&(e=u.return)&&e.call(u)}finally{if(t)throw t.error}}},e.__cname="SystemViewCulling",i([l.injectField("SystemView")],e.prototype,"SystemView",void 0),i([l.injectField("ComPos")],e.prototype,"ComPos",void 0),i([l.injectField("ComVelocity")],e.prototype,"ComVelocity",void 0),i([l.injectField("SystemMap")],e.prototype,"SystemMap",void 0),i([l.injectField("ComPrefab")],e.prototype,"ComPrefab",void 0),i([l.injectField("ComType")],e.prototype,"ComType",void 0),e}(u.CullingGroup);r.SystemViewCulling=f,cc._RF.pop()},{"../../../../../framework/container/Container":void 0,"../logic/move/ComPos":"ComPos","../logic/type/ComType":"ComType","./CullingGroup":"CullingGroup","./prefab/ComPrefab":"ComPrefab"}],SystemViewEffect:[function(t,e,r){"use strict";cc._RF.push(e,"ca4b5uUjexOeZ5ZglmPXzu2","SystemViewEffect");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.SystemViewEffect=void 0;var s=t("../../../../../framework/container/Container"),c=t("../../../../../framework/utils/Toolset"),u=t("../../utils/UIDGenerator"),p=t("./BaseViewSystem"),f=t("./effect/SubSysEffectWarning"),h=t("./nodeproxy/NodeProxy"),y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.canvas=cc.director.getScene().getChildByName("Battle"),e.queueX=[],e.queueY=[],e.queueKey=[],e.queueScaleX=[],e.idpool=new u.UIDGenerator,e.tmUpdate=new Map,e.tmDuration=new Map,e.tlNodeProxy=new Set,e.tlLoading=new Set,e.tmTime=new Map,e}return n(e,t),e.prototype.onInit=function(){this.toolSet=c.ToolSet.createToolSet(),this.AddSubSystem(f.SubSysEffectWarning)},e.prototype.onDestroy=function(){this.tlNodeProxy.clear(),c.ToolSet.destroyToolSet(this.toolSet)},e.prototype.onStart=function(){},e.prototype.onUpdate=function(){this.UpdateXY(),this.UpdateDestroy()},e.prototype.AddEffectXY=function(t,e,r,o,n,i,a){void 0===o&&(o=!1),void 0===n&&(n=!0),void 0===i&&(i=null),void 0===a&&(a=1);var l=this.CreateProxy();l.SetXY(e,r),l.SetPropertype("model",t),l.SetPropertype("flip",o),l.SetPropertype("animation",0),l.SetPropertype("scale",a);var s=n?h.NodeProxyOrder.Effect:h.NodeProxyOrder.EffectBack;if(l.SetZIndex(s),this.OnOffMgr.OnOffEffectWeakening.GetValue()){var c=this.ModelGameConfig.GetGameConfigValueByKey("BattleEffectWeak")/100;l.SetPropertype("alpha",c)}return null!=i&&this.tmDuration.set(l,i),this.tlLoading.add(l),l},e.prototype.AddEffectEntity=function(t,e,r,o){void 0===r&&(r=!1),void 0===o&&(o=!0);var n=this.Battle.ref2id(e);if(n){var i=this.ComPos.x[n],a=this.ComPos.y[n],l=this.AddEffectXY(t,i,a,r,o);this.tmUpdate.set(l,{entity:e,proxy:l})}},e.prototype.CreateProxy=function(){var t=this.NodeProxyMgr.CreateProxy();return this.tlNodeProxy.add(t),t},e.prototype.DestroyProxy=function(t){this.tlNodeProxy.delete(t),this.NodeProxyMgr.DestroyProxy(t),this.tmDuration.delete(t),this.tmUpdate.has(t)&&this.tmUpdate.delete(t)},e.prototype.ClearAllProxy=function(){var t,e;try{for(var r=a(this.tlNodeProxy),o=r.next();!o.done;o=r.next()){var n=o.value;this.NodeProxyMgr.DestroyProxy(n)}}catch(i){t={error:i}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},e.prototype.UpdateDestroy=function(){var t,e,r,o,n=this.tlLoading,i=this.tmTime;try{for(var s=a(n),c=s.next();!c.done;c=s.next()){var u=c.value;this.UpdateProxyRunning(u)}}catch(d){t={error:d}}finally{try{c&&!c.done&&(e=s.return)&&e.call(s)}finally{if(t)throw t.error}}var p=cc.director.getTotalTime()/1e3;try{for(var f=a(i),h=f.next();!h.done;h=f.next()){var y=l(h.value,2);u=y[0],p>y[1]&&(this.DestroyProxy(u),i.delete(u))}}catch(m){r={error:m}}finally{try{h&&!h.done&&(o=f.return)&&o.call(f)}finally{if(r)throw r.error}}},e.prototype.UpdateProxyRunning=function(t){var e=this.tlLoading,r=this.tmDuration;if(t.GetPrefab()){e.delete(t);var o=r.get(t);if(null==o){var n=t.GetAnimate();if(n){var i=n.currentClip;i&&(o=i.duration)}null==o&&(o=.5)}var a=cc.director.getTotalTime()/1e3;this.tmTime.set(t,a+o)}},e.prototype.UpdateXY=function(){var t,e,r=this.ComPos.x,o=this.ComPos.y;try{for(var n=a(this.tmUpdate),i=n.next();!i.done;i=n.next()){var s=l(i.value,2),c=(s[0],s[1]),u=this.Battle.ref2id(c.entity);if(!u)return void this.DestroyProxy(c.proxy);c.proxy.SetXY(r[u],o[u])}}catch(p){t={error:p}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}},e.prototype.AddEffectWarning=function(t){this.GetSubSystem(f.SubSysEffectWarning).AddEffect(t)},e.__cname="SystemViewEffect",i([s.injectField("ModelPrefab")],e.prototype,"ModelPrefab",void 0),i([s.injectField("OnOffMgr")],e.prototype,"OnOffMgr",void 0),i([s.injectField("ModelGameConfig")],e.prototype,"ModelGameConfig",void 0),i([s.injectField("NodeProxyMgr")],e.prototype,"NodeProxyMgr",void 0),i([s.injectField("ComPos")],e.prototype,"ComPos",void 0),i([s.injectField("Battle")],e.prototype,"Battle",void 0),e}(p.BaseViewSystem);r.SystemViewEffect=y,cc._RF.pop()},{"../../../../../framework/container/Container":void 0,"../../../../../framework/utils/Toolset":void 0,"../../utils/UIDGenerator":"UIDGenerator","./BaseViewSystem":"BaseViewSystem","./effect/SubSysEffectWarning":"SubSysEffectWarning","./nodeproxy/NodeProxy":"NodeProxy"}],SystemViewProp:[function(t,e,r){"use strict";cc._RF.push(e,"e9f818l1HBMTrYgZt4jU6LT","SystemViewProp");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.SystemViewProp=void 0;var s=t("../../../../../framework/container/Container"),c=t("../../../../../framework/Func"),u=t("../../../../../framework/utils/Toolset"),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.canvas=cc.director.getScene().getChildByName("Battle"),e.dirty=!1,e.updateSet=new Set,e.removeSet=new Set,e.tmPrefab=new Map,e.tmModel=new Map,e.tlNodeProxy=new Map,e.m_cullingVer=null,e.isDirtyCulling=!0,e.tlDirty=new Set,e}return n(e,t),e.prototype.onInit=function(){this.toolSet=u.ToolSet.createToolSet()},e.prototype.onDestroy=function(){this.tlNodeProxy.clear(),u.ToolSet.destroyToolSet(this.toolSet)},e.prototype.onStart=function(){var t=this;this.toolSet.addCallback(this.SystemCommon.PropMgr.addOrUpdateCallback,function(e){null==t.GetProxy(e)?t.CreateProxy(e):t.MarkProxyDirty(e)}),this.toolSet.addCallback(this.SystemCommon.PropMgr.deleteCallback,function(e){t.DestroyProxy(e)}),this.toolSet.addCallback(this.SystemCommon.ChestMgr.addOrUpdateCallback,function(e){null==t.GetProxy(e)?t.CreateProxy(e):t.MarkProxyDirty(e)}),this.toolSet.addCallback(this.SystemCommon.ChestMgr.deleteCallback,function(e){t.DestroyProxy(e)})},e.prototype.onUpdate=function(t){this.UpdateChange(t)},e.prototype.CreateProxy=function(t){var e=this.NodeProxyMgr.CreateProxy();this.tlNodeProxy.set(t,e),this.UpdateNodeProxyChange(t);var r=this.SystemCommon.posData,o=r.x,n=r.y;return e.SetXY(o[t],n[t]),e},e.prototype.DestroyProxy=function(t){if(this.tlNodeProxy.has(t)){var e=this.tlNodeProxy.get(t);this.tlNodeProxy.delete(t),this.NodeProxyMgr.DestroyProxy(e)}},e.prototype.ClearAllProxy=function(){var t,e;try{for(var r=a(this.tlNodeProxy),o=r.next();!o.done;o=r.next()){var n=l(o.value,2),i=(n[0],n[1]);this.NodeProxyMgr.DestroyProxy(i)}}catch(s){t={error:s}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}this.tlNodeProxy.clear()},e.prototype.GetProxy=function(t){return this.tlNodeProxy.get(t)},e.prototype.MarkProxyDirty=function(t){this.tlDirty.add(t),this.dirty=!0},e.prototype.UpdateChange=function(){var t,e,r,o,n,i,s,c,u,p;if(this.dirty){this.dirty=!1;try{for(var f=a(this.tlDirty),h=f.next();!h.done;h=f.next()){var y=h.value;this.UpdateNodeProxyChange(y)}}catch(T){t={error:T}}finally{try{h&&!h.done&&(e=f.return)&&e.call(f)}finally{if(t)throw t.error}}this.tlDirty.clear()}if(this.isDirtyCulling){this.isDirtyCulling=!1;try{for(var d=a(this.tlNodeProxy),m=d.next();!m.done;m=d.next()){var v=l(m.value,2);y=v[0],v[1],this.UpdateNodeProxyCulling(y)}}catch(j){r={error:j}}finally{try{m&&!m.done&&(o=d.return)&&o.call(d)}finally{if(r)throw r.error}}}var _=this.tlNodeProxy,S=this.SystemCommon.posData.x,g=this.SystemCommon.posData.y;try{for(var b=a(this.SystemCommon.PropMgr.picks),C=b.next();!C.done;C=b.next())y=C.value,(x=_.get(y))&&x.SetXY(S[y],g[y])}catch(I){n={error:I}}finally{try{C&&!C.done&&(i=b.return)&&i.call(b)}finally{if(n)throw n.error}}var R=this.SystemMap.getCullingVer();this.m_cullingVer!=R&&(this.m_cullingVer=R,this.isDirtyCulling=!0);var M=this.SystemCommon.PropMgr.ids_loading,w=this.SystemCommon.PropMgr.ids,O=this.SystemCommon.posData.loaded;try{for(var B=a(M),P=B.next();!P.done;P=B.next())y=P.value,(x=_.get(y)).GetPrefab()&&(O[y]=!0,M.delete(y),w.add(y))}catch(D){s={error:D}}finally{try{P&&!P.done&&(c=B.return)&&c.call(B)}finally{if(s)throw s.error}}M=this.SystemCommon.ChestMgr.ids_loading,w=this.SystemCommon.ChestMgr.ids,O=this.SystemCommon.posData.loaded;try{for(var G=a(M),k=G.next();!k.done;k=G.next()){var x;y=k.value,(x=_.get(y)).GetPrefab()&&(O[y]=!0,M.delete(y),w.add(y))}}catch(F){u={error:F}}finally{try{k&&!k.done&&(p=G.return)&&p.call(G)}finally{if(u)throw u.error}}},e.prototype.UpdateNodeProxyChange=function(t){var e=this.SystemCommon.posData,r=e.model,o=e.order,n=this.tlNodeProxy.get(t);n.SetPropertype("model",r[t]),n.SetZIndex(o[t])},e.prototype.UpdateNodeProxyCulling=function(t){var e=this.tlNodeProxy.get(t),r=this.SystemCommon.posData.x,o=this.SystemCommon.posData.y,n=this.SystemMove.getCullingRect(),i=l(this.SystemMove.pos2Grids(r[t],o[t]),2),a=i[0],s=i[1];c.Func.isPointInRect2(n.xs,n.ys,n.xe,n.ye,a,s)||this.Battle.GetPaused()?e.SetActive(!0):e.SetActive(!1)},e.__cname="SystemViewProp",i([s.injectField("ModelPrefab")],e.prototype,"ModelPrefab",void 0),i([s.injectField("SystemCommon")],e.prototype,"SystemCommon",void 0),i([s.injectField("SystemMove")],e.prototype,"SystemMove",void 0),i([s.injectField("SystemMap")],e.prototype,"SystemMap",void 0),i([s.injectField("NodeProxyMgr")],e.prototype,"NodeProxyMgr",void 0),i([s.injectField("Battle")],e.prototype,"Battle",void 0),e}(t("./BaseViewSystem").BaseViewSystem);r.SystemViewProp=p,cc._RF.pop()},{"../../../../../framework/Func":void 0,"../../../../../framework/container/Container":void 0,"../../../../../framework/utils/Toolset":void 0,"./BaseViewSystem":"BaseViewSystem"}],SystemViewWedgit:[function(t,e,r){"use strict";cc._RF.push(e,"6fc6bUEplRILbIUlN3SKM+r","SystemViewWedgit");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.SystemViewWedgit=void 0;var s=t("../../../../../framework/container/Container"),c=t("../../../../../framework/ecs/GroupSet"),u=t("../../../../../framework/utils/StringUtil"),p=t("./nodeproxy/NodeProxy"),f=t("./prefab/behavior/FlipPrefabBehavior"),h=t("./prefab/behavior/RobotPrefabBehavior"),y=t("./prefab/ComPrefab"),d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tlComClazz=[y.ComPrefab],e.isStart=!1,e.tmHandler=new Map,e.tmId2Key=new Map,e.tlDirty=new Set,e.dirty=!1,e.tmBehavior=new Map,e.tmZIndex=new Map,e}return n(e,t),e.prototype.onStart=function(){this.CreateBehavior("\u767e\u604b_\u82f1\u96c4_\u9646\u5929\u6daf_\u6b66\u5668",f.FlipPrefabBehavior),this.CreateBehavior("\u767e\u604b_\u82f1\u96c4_\u7389\u5154_\u6b66\u5668",f.FlipPrefabBehavior),this.CreateBehavior("\u767e\u604b_\u82f1\u96c4_\u6076\u4fee\u7f57_\u6b66\u5668",f.FlipPrefabBehavior),this.CreateBehavior("\u767e\u604b_\u6280\u80fd_\u795e\u5251\u8bdb\u4ed9",h.RobotPrefabBehavior,p.NodeProxyOrder.RoleWedgitBack),this.CreateBehavior("\u767e\u604b_\u6280\u80fd_\u65e0\u90aa\u5251",h.RobotPrefabBehavior),this.CreateBehavior("\u767e\u604b_\u6280\u80fd_\u65ad\u9b42\u5251",h.RobotPrefabBehavior),this.CreateBehavior("\u6218\u6597_\u6218\u6597\u573a\u666f\u7279\u6548_BUFF\u72c2\u66b4",f.FlipPrefabBehavior),this.CreateBehavior("\u6218\u6597_\u6218\u6597\u573a\u666f\u7279\u6548_BUFF\u8bc5\u5492",f.FlipPrefabBehavior),this.CreateBehavior("\u6218\u6597_\u6218\u6597\u573a\u666f\u7279\u6548_BUFF\u9b54\u5316",f.FlipPrefabBehavior,p.NodeProxyOrder.RoleWedgitBack),this.CreateBehavior("\u767e\u604b_\u88c5\u5907\u6280\u80fd_\u4e00\u6b21\u62a4\u76fe",f.FlipPrefabBehavior,p.NodeProxyOrder.RoleWedgit),this.CreateBehavior("\u767e\u604b_\u88c5\u5907\u6280\u80fd_\u4e07\u9b42\u6ce2\u52a8",f.FlipPrefabBehavior,p.NodeProxyOrder.RoleWedgit),this.CreateBehavior("\u767e\u604b_\u88c5\u5907\u6280\u80fd_\u4f24\u5bb3\u51cf\u514d",f.FlipPrefabBehavior,p.NodeProxyOrder.RoleWedgit),this.CreateBehavior("\u767e\u604b_\u88c5\u5907\u6280\u80fd_\u4f24\u5bb3\u63d0\u5347",f.FlipPrefabBehavior,p.NodeProxyOrder.RoleWedgit),this.CreateBehavior("\u767e\u604b_\u88c5\u5907\u6280\u80fd_\u4fee\u70bc\u9886\u57df",f.FlipPrefabBehavior,p.NodeProxyOrder.RoleWedgit),this.CreateBehavior("\u767e\u604b_\u88c5\u5907\u6280\u80fd_\u52a0\u901f",f.FlipPrefabBehavior,p.NodeProxyOrder.RoleWedgit),this.CreateBehavior("\u767e\u604b_\u88c5\u5907\u6280\u80fd_\u5c0f\u8303\u56f4\u7206\u70b8",f.FlipPrefabBehavior,p.NodeProxyOrder.RoleWedgit),this.CreateBehavior("\u767e\u604b_\u88c5\u5907\u6280\u80fd_\u5f13\u7bad\u7206\u70b8",f.FlipPrefabBehavior,p.NodeProxyOrder.RoleWedgit),this.CreateBehavior("\u767e\u604b_\u88c5\u5907\u6280\u80fd_\u5f3a\u529b\u8109\u51b2",f.FlipPrefabBehavior,p.NodeProxyOrder.RoleWedgit),this.CreateBehavior("\u767e\u604b_\u88c5\u5907\u6280\u80fd_\u6218\u573a\u7edf\u6cbb\u8005",f.FlipPrefabBehavior,p.NodeProxyOrder.RoleWedgit),this.CreateBehavior("\u767e\u604b_\u88c5\u5907\u6280\u80fd_\u62a4\u76fe\u51b2\u51fb\u6ce2",f.FlipPrefabBehavior,p.NodeProxyOrder.RoleWedgit),this.CreateBehavior("\u767e\u604b_\u88c5\u5907\u6280\u80fd_\u62a4\u76fe\u51b2\u51fb\u6ce2_\u63a8\u5f00",f.FlipPrefabBehavior,p.NodeProxyOrder.RoleWedgit),this.CreateBehavior("\u767e\u604b_\u88c5\u5907\u6280\u80fd_\u65e0\u654c",f.FlipPrefabBehavior,p.NodeProxyOrder.RoleWedgit),this.CreateBehavior("\u767e\u604b_\u88c5\u5907\u6280\u80fd_\u6d41\u8840",f.FlipPrefabBehavior,p.NodeProxyOrder.RoleWedgit),this.CreateBehavior("\u767e\u604b_\u88c5\u5907\u6280\u80fd_\u79d2\u6740",f.FlipPrefabBehavior,p.NodeProxyOrder.RoleWedgit),this.CreateBehavior("\u767e\u604b_\u88c5\u5907\u6280\u80fd_\u8303\u56f4\u51cf\u901f",f.FlipPrefabBehavior,p.NodeProxyOrder.RoleWedgit),this.CreateBehavior("\u767e\u604b_\u88c5\u5907\u6280\u80fd_\u8f90\u5c04\u5708",f.FlipPrefabBehavior,p.NodeProxyOrder.RoleWedgit),this.CreateBehavior("\u767e\u604b_\u88c5\u5907\u6280\u80fd_\u91cd\u51fb",f.FlipPrefabBehavior,p.NodeProxyOrder.RoleWedgit),this.CreateBehavior("\u767e\u604b_\u88c5\u5907\u6280\u80fd_\u592a\u5200\u5200\u5149",f.FlipPrefabBehavior,p.NodeProxyOrder.RoleWedgit),this.isStart=!0},e.prototype.onRelease=function(){},e.prototype.onAddEntity=function(e){this.tmId2Key.set(e,new Set),t.prototype.onAddEntity.call(this,e)},e.prototype.onRemoveEntity=function(e){this.ClearWedgit(e),this.tmId2Key.delete(e),t.prototype.onRemoveEntity.call(this,e)},e.prototype.Update=function(t){this.UpdateDirty(),this.UpdateHandler(t)},e.prototype.MarkDirty=function(t){this.tlDirty.add(t),this.dirty=!0,this.UpdateDirty()},e.prototype.UpdateDirty=function(){var t,e,r,o,n,i;if(0!=this.isStart&&this.dirty){this.dirty=!1;var l=this.ComPrefab.addWedgit,s=this.ComPrefab.removeWedgit;try{for(var c=a(this.tlDirty),u=c.next();!u.done;u=c.next()){var p=u.value;if(l[p])try{for(var f=(r=void 0,a(l[p])),h=f.next();!h.done;h=f.next()){var y=h.value;this.AddWedgit(p,y)}}catch(v){r={error:v}}finally{try{h&&!h.done&&(o=f.return)&&o.call(f)}finally{if(r)throw r.error}}if(l[p])try{for(var d=(n=void 0,a(s[p])),m=d.next();!m.done;m=d.next())y=m.value,this.RemoveWedgit(p,y)}catch(_){n={error:_}}finally{try{m&&!m.done&&(i=d.return)&&i.call(d)}finally{if(n)throw n.error}}}}catch(S){t={error:S}}finally{try{u&&!u.done&&(e=c.return)&&e.call(c)}finally{if(t)throw t.error}}}},e.prototype.CreateBehavior=function(t,e,r){void 0===r&&(r=p.NodeProxyOrder.RoleWedgit);var o=new e;return this.container.inject(o),this.tmBehavior.set(t,o),this.tmZIndex.set(t,r),o},e.prototype.GetBehavior=function(t){return this.tmBehavior.get(t)},e.prototype.GetZIndex=function(t){return this.tmZIndex.get(t)},e.prototype.AddWedgit=function(t,e){var r=this.Hash(t,e);if(!this.tmHandler.has(r)){var o=this.ComCollision.r,n=this.ComPos.x,i=this.ComPos.y,a=this.NodeProxyMgr.CreateProxy(),l=this.GetBehavior(e),s=this.GetZIndex(e);a.SetPropertype("model",e),a.SetZIndex(s),a.SetXY(n[t],i[t]),a.SetPropertype("animation",0),o[t]&&a.SetPrototypeSize(2*o[t]);var c={eid:t,model:e,nodeproxy:a,behavior:l};this.tmHandler.set(r,c);var u=this.tmId2Key.get(t);if(u)u.add(r);else{var p=new Set;p.add(r),this.tmId2Key.set(t,p)}}},e.prototype.RemoveWedgit=function(t,e){var r=this.Hash(t,e);if(this.tmHandler.has(r)){var o=this.tmHandler.get(r);this.NodeProxyMgr.DestroyProxy(o.nodeproxy),this.tmHandler.delete(r),this.tmId2Key.get(t).delete(r)}},e.prototype.ClearWedgit=function(t){var e,r,o=this.tmId2Key.get(t);if(o){try{for(var n=a(o),i=n.next();!i.done;i=n.next()){var l=i.value,s=this.tmHandler.get(l);this.RemoveWedgit(t,s.model)}}catch(c){e={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}o.clear()}},e.prototype.Hash=function(t,e){return u.StringUtil.format("{0}_{1}",t,e)},e.prototype.UpdateHandler=function(t){var e,r;try{for(var o=a(this.tmHandler),n=o.next();!n.done;n=o.next()){var i=l(n.value,2),s=(i[0],i[1]),c=s.behavior;if(c)c.Update(s.nodeproxy,s.eid,t);else{var u=s.nodeproxy,p=this.ComPos.x,f=this.ComPos.y,h=s.eid;u.SetXY(p[h],f[h])}}}catch(y){e={error:y}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}},e.__cname="SystemViewWedgit",i([s.injectField("NodeProxyMgr")],e.prototype,"NodeProxyMgr",void 0),i([s.injectField("ComPrefab")],e.prototype,"ComPrefab",void 0),i([s.injectField("ComPos")],e.prototype,"ComPos",void 0),i([s.injectField("ComCollision")],e.prototype,"ComCollision",void 0),e}(c.GroupSet);r.SystemViewWedgit=d,cc._RF.pop()},{"../../../../../framework/container/Container":void 0,"../../../../../framework/ecs/GroupSet":void 0,"../../../../../framework/utils/StringUtil":void 0,"./nodeproxy/NodeProxy":"NodeProxy","./prefab/ComPrefab":"ComPrefab","./prefab/behavior/FlipPrefabBehavior":"FlipPrefabBehavior","./prefab/behavior/RobotPrefabBehavior":"RobotPrefabBehavior"}],SystemView:[function(t,e,r){"use strict";cc._RF.push(e,"89127USXYpLUqvcYdFdL3ts","SystemView");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.SystemView=void 0;var s=t("../../../../../framework/container/Container"),c=t("../../../../../framework/ecs/GroupSet"),u=t("../../../../../framework/utils/Toolset"),p=t("./prefab/ComPrefab"),f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tlComClazz=[p.ComPrefab],e.nodes=new Map,e.isStart=!1,e.tmNodeProxy=new Map,e.tlDirty=new Set,e}return n(e,t),e.prototype.onStart=function(){this.isStart=!0,this.toolSet=u.ToolSet.createToolSet()},e.prototype.onDestroy=function(){var e,r;t.prototype.onDestroy.call(this),this.ComPos=null,this.tlComClazz=null,this.tmNodeProxy.clear(),this.ModelPrefab;try{for(var o=a(this.nodes),n=o.next();!n.done;n=o.next()){var i=l(n.value,2),s=(i[0],i[1]);this.NodeProxyMgr.DestroyProxy(s)}}catch(c){e={error:c}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}this.nodes.clear(),this.nodes.clear(),this.nodes=null,u.ToolSet.destroyToolSet(this.toolSet)},e.prototype.onAddEntity=function(e){t.prototype.onAddEntity.call(this,e),this.AddNodeProxy(e),this.UpdateChangeNodeProxy(e)},e.prototype.onRemoveEntity=function(e){t.prototype.onRemoveEntity.call(this,e),this.RemoveNodeProxy(e)},e.prototype.onUpdate=function(){var t,e;try{for(var r=a(this.tlDirty),o=r.next();!o.done;o=r.next()){var n=o.value;this.UpdateChangeNodeProxy(n)}}catch(i){t={error:i}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}this.tlDirty.clear()},e.prototype.AddNodeProxy=function(t){var e=this.tmNodeProxy;e.has(t)&&this.RemoveNodeProxy(t);var r=this.NodeProxyMgr.CreateProxy();e.set(t,r)},e.prototype.RemoveNodeProxy=function(t){var e=this.tmNodeProxy;if(e.has(t)){var r=e.get(t);e.delete(t),this.NodeProxyMgr.DestroyProxy(r)}},e.prototype.GetNodeProxy=function(t){return this.tmNodeProxy.get(t)},e.prototype.pushStateQueue=function(t){this.tmNodeProxy.has(t)&&this.tlDirty.add(t)},e.prototype.UpdateChangeNodeProxy=function(t){var e=this.GetNodeProxy(t);if(null!=e){var r=this.ComPrefab.model,o=this.ComPrefab.anim,n=this.ComPrefab.scale,i=this.ComPrefab.white,a=this.ComPrefab.alpha,l=this.ComPrefab.prototypeSize,s=this.ComPrefab.nextModel,c=this.ComPrefab.nextAnim,u=this.ComPrefab.nextScale,p=this.ComPrefab.nextWhite,f=this.ComPrefab.nextPrototypeSize;r[t]=s[t],o[t]=c[t],n[t]=u[t],i[t]=p[t],l[t]=f[t],e.SetPropertype("model",r[t]),e.SetPropertype("animation",o[t]),e.SetPropertype("scale",n[t]),e.SetPropertype("additionColor",i[t]),e.SetPropertype("alpha",a[t]),e.SetPrototypeSize(l[t])}},e.__cname="SystemView",i([s.injectField("ModelPrefab")],e.prototype,"ModelPrefab",void 0),i([s.injectField("ComPos")],e.prototype,"ComPos",void 0),i([s.injectField("ComPrefab")],e.prototype,"ComPrefab",void 0),i([s.injectField("ComType")],e.prototype,"ComType",void 0),i([s.injectField("ComVelocity")],e.prototype,"ComVelocity",void 0),i([s.injectField("ComVar")],e.prototype,"ComVar",void 0),i([s.injectField("OnOffMgr")],e.prototype,"OnOffMgr",void 0),i([s.injectField("ModelGameConfig")],e.prototype,"ModelGameConfig",void 0),i([s.injectField("SystemMap")],e.prototype,"SystemMap",void 0),i([s.injectField("SystemEvent")],e.prototype,"SystemEvent",void 0),i([s.injectField("Battle")],e.prototype,"Battle",void 0),i([s.injectField("NodeProxyMgr")],e.prototype,"NodeProxyMgr",void 0),e}(c.GroupSet);r.SystemView=f,cc._RF.pop()},{"../../../../../framework/container/Container":void 0,"../../../../../framework/ecs/GroupSet":void 0,"../../../../../framework/utils/Toolset":void 0,"./prefab/ComPrefab":"ComPrefab"}],TabAchieveTask:[function(t,e,r){"use strict";cc._RF.push(e,"32d9eMRdW5DZ7DBlTmRDxvq","TabAchieveTask");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.TabAchieveTaskUI=r.TabAchieveTask=void 0;var a=t("../../../../../../framework/container/Container"),l=t("../../../../../../framework/layer/common/UIOrder"),s=t("../../../../../generated/netProto/CmdInterface"),c=t("../../../../model/System/ModelSystem"),u=t("../../../../ui/GameTab"),p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUrl=function(){return"ui://\u9996\u9875_\u4fee\u70bc_\u4efb\u52a1\u7cfb\u7edf/\u7ec4\u4ef6_\u4efb\u52a1_\u6210\u5c31"},e.prototype.getUIClass=function(){return f},e.prototype.getSortOrder=function(){return l.LayerOrder.TowLevel},e.prototype.getSystemId=function(){return c.SystemId.AchieveTask},e.__cname="TabAchieveTask",e}(u.GameTabProxy);r.TabAchieveTask=p;var f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.init=function(){var t=this;t.com.toFullCenterParent(t.container),t.InitList()},e.prototype.enter=function(){this.updateView(),this.ModelMgr.ModelTask.GetEventProxy().addListener("achieveTaskChange",this,this.updateView)},e.prototype.exit=function(){this.ModelMgr.ModelTask.GetEventProxy().removeListener("achieveTaskChange",this,this.updateView)},e.prototype.InitList=function(){var t=this,e=this;e.com.tm("list").asList.initVirtualList(e,function(r,o,n){var i=o.asCom,a=t.ModelMgr.ModelTask.GetRefAchieveTask(n.resId),l=i.tm("\u8fdb\u5ea6\u6761_\u4efb\u52a1\u8fdb\u5ea6").asProgress,c=a.param.count||a.param.level;c||(c=a.param.talent),l.max=c;var u,p=n.count;u=p>c?c:p,l.value=u,i.tm("\u6587\u672c_\u6807\u9898").text=a.name;var f=a.reward,h=e.ModelMgr.ModelTask.GetRefTaskReward(f).reward,y=e.ModelMgr.ModelGoods.CreateGoods(h[0].resId);y.SetNumber(h[0].number),i.tm("com_goods").UpdateByGoods(y);var d=n.rewardState;i.setSelectedIndex("\u5b8c\u6210\u72b6\u6001",d),d!=s.CmdCommonState.REWARDED&&i.tm("\u6309\u94ae_\u524d\u5f80").setClick(function(){if(0==d){var r=a.gotoKey;e.CtrlMgr.JumpLayer(r)&&t.parent.proxy.unload()}else 1==d&&e.ModelMgr.ModelTask.RequestTaskReward(a.resId,s.CmdTaskType.ACHIEVEMENT_TASK)},i)})},e.prototype.updateView=function(){this.updateList()},e.prototype.updateList=function(){var t=this.ModelMgr.ModelTask.GetTlRefAchieveTask();t.sort(function(t,e){var r=t.resId,o=e.resId;return r+=t.rewardState%2==1?1e5:1e5*-t.rewardState,(o+=e.rewardState%2==1?1e5:1e5*-e.rewardState)-r}),this.com.tm("list").asList.update(t)},e.__cname="TabAchieveTaskUI",i([a.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([a.injectField("TimeUtil")],e.prototype,"TimeUtil",void 0),e}(u.GameTabUI);r.TabAchieveTaskUI=f,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../../../../../framework/layer/common/UIOrder":void 0,"../../../../../generated/netProto/CmdInterface":"CmdInterface","../../../../model/System/ModelSystem":"ModelSystem","../../../../ui/GameTab":"GameTab"}],TabAdventure:[function(t,e,r){"use strict";cc._RF.push(e,"2dddeli5stNVopUUwOCG/l8","TabAdventure");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.TabAdventureUI=r.TabAdventure=void 0;var s=t("../../../../../engine/EngineMain"),c=t("../../../../../framework/FW"),u=t("../../../../../framework/container/Container"),p=t("../../../../../framework/fgui/FairyMgr"),f=t("../../../../../framework/utils/StringUtil"),h=t("../../../model/System/ModelSystem"),y=t("../../../model/goods/ModelGoods"),d=t("../../../model/vo/Other/VOFuben"),m=t("../../../ui/GameTab"),v=t("../../alert/CtrlAlert"),_=new Map;_.set(0,"\u6bcf\u65e5\u6311\u6218\u526f\u672c.\u6309\u94ae_\u5b9d\u7bb1_\u94dc"),_.set(1,"\u6bcf\u65e5\u6311\u6218\u526f\u672c.\u6309\u94ae_\u5b9d\u7bb1_\u94f6"),_.set(2,"\u6bcf\u65e5\u6311\u6218\u526f\u672c.\u6309\u94ae_\u5b9d\u7bb1_\u91d1");var S=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return g},e.prototype.getUrl=function(){return"ui://\u9996\u9875_\u5947\u9047/\u7ec4\u4ef6_\u9996\u9875_\u5947\u9047_\u5947\u9047\u526f\u672c\u5165\u53e3"},e.prototype.getSystemId=function(){return h.SystemId.Adventure},e.__cname="TabAdventure",e}(m.GameTabProxy);r.TabAdventure=S;var g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isCanBuy=!0,e.isGetReward=!0,e}return n(e,t),e.prototype.init=function(){var t=this;this.com.toFullCenterParent(this.container),this.dailyConsumeSta=this.ModelMgr.ModelGameConfig.GetGameConfigValueByKey("dailyChallenge")||10;var e=this.ModelMgr.ModelGoods.CreateGoods(y.ECurrencyType.gem);this.com.tm("\u6bcf\u65e5\u6311\u6218\u526f\u672c.\u6309\u94ae_\u6bcf\u65e5\u6311\u6218_\u8d2d\u4e70.icon").SetUrlByIcon(e.GetIconUrl()),this.fubenSubset=this.ModelMgr.ModelVO.VOFubenBag.CreateSubset(),this.fubenSubset.SetFilter(function(){return!0}),this.toolSet.addDefer(function(){t.ModelMgr.ModelVO.VOFubenBag.DestroySubset(t.fubenSubset),t.fubenSubset=null}),this.toolSet.addListener(this.fubenSubset.GetEventProxy(),"OnChanged",function(){t.dailyVo=t.fubenSubset.GetVOBySift(function(t,e){return e.CheckFubenType(d.FubenType.daily)}),t.goldVo=t.fubenSubset.GetVOBySift(function(t,e){return e.CheckFubenType(d.FubenType.gold)}),t.updateLayer(),t.updateBoxState()},this),this.dailyVo=this.fubenSubset.GetVOBySift(function(t,e){return e.CheckFubenType(d.FubenType.daily)}),this.goldVo=this.fubenSubset.GetVOBySift(function(t,e){return e.CheckFubenType(d.FubenType.gold)}),this.updateLayer(),this.updateBoxState(),this.InitTime(),this.InitClick(),this.InitList(),this.InitLayer(),this.InitListen(),this.updateList()},e.prototype.enter=function(){var t=this;this.com.tm("\u6bcf\u65e5\u6311\u6218\u526f\u672c").asCom.setSelectedIndex("\u5c55\u793a\u5956\u52b1",0),this.isCanShowDaily&&this.checkShowBuff()&&this.toolSet.addDelay(500,function(){t.LayerAdventureBuff.load()})},e.prototype.InitTime=function(){var t=this,e=t.com,r=function(){e.tm("\u6587\u672c_\u5012\u8ba1\u65f6").asTextField.setVar("time",t.TimeUtil.timeSec2HMSStr11(!1)).flushVars()};t.toolSet.addTimer(1e3,function(){r()}),r()},e.prototype.InitLayer=function(){var t=this,e=t.com,r=t.ModelMgr.ModelFuben.GetDailyFubenPlanByResId(t.dailyVo.getRefId()),o=t.ModelMgr.ModelGoods.CreateGoodsByCmd(r.buySpend);e.tm("\u6bcf\u65e5\u6311\u6218\u526f\u672c.\u6309\u94ae_\u6bcf\u65e5\u6311\u6218_\u8d2d\u4e70.icon").SetUrlByIcon(o.GetIconUrl()),e.tm("\u6bcf\u65e5\u6311\u6218\u526f\u672c.\u6309\u94ae_\u6bcf\u65e5\u6311\u6218_\u8d2d\u4e70.title").text="X"+r.buySpend.number,e.tm("\u88c5\u8f7d\u5668_\u84dd\u8272\u7c92\u5b50").SetUrlByModel(v.particlesMap.get("\u7eff\u8272\u7c92\u5b50"))},e.prototype.InitListen=function(){var t=this,e=function(){var e=c.FW.ExprMgr.GetResult("[finishChapter:601]")?1:0;t.com.setSelectedIndex("\u662f\u5426\u89e3\u9501\u6bcf\u65e5",e),t.isCanShowDaily=!1};this.toolSet.AddScriptListener("[finishChapter:601]",e,this),e()},e.prototype.InitClick=function(){var t=this,e=this,r=e.com;e.setFairyBtnEvent(r.tm("\u91d1\u5e01\u526f\u672c.\u6309\u94ae_\u91d1\u5e01\u526f\u672c_\u5f00\u59cb\u6311\u6218"),function(){return a(t,void 0,void 0,function(){var t;return l(this,function(r){switch(r.label){case 0:return[4,e.ModelMgr.ModelFuben.RequestFuben(e.goldVo.getRefId(),2)];case 1:return r.sent()?[4,e.ModelMgr.ModelFuben.RequestFubenEnter()]:[2];case 2:return t=r.sent(),[4,e.CtrlMgr.CtrlBattle.StartByNet(t)];case 3:return r.sent(),[2]}})})}),e.setFairyBtnEvent(r.tm("\u6bcf\u65e5\u6311\u6218\u526f\u672c.\u6309\u94ae_\u6bcf\u65e5\u6311\u6218_\u5f00\u59cb\u6311\u6218"),function(){return a(t,void 0,void 0,function(){var t,r;return l(this,function(o){switch(o.label){case 0:return e.ModelMgr.ModelFuben.SetData({gobjTarget:this.com.tm("\u6bcf\u65e5\u6311\u6218\u526f\u672c.\u6309\u94ae_\u6bcf\u65e5\u6311\u6218_\u5f00\u59cb\u6311\u6218"),HostCom:this.container,ConsumeEnd:this.dailyConsumeSta}),[4,e.ModelMgr.ModelFuben.RequestFuben(e.dailyVo.getRefId(),3)];case 1:return o.sent()?(t=!1,e.ModelMgr.ModelFuben.BeforRequestFubenEnter().then(function(){return t=!0}).catch(function(e){c.FW.LWX.error("\u8d27\u5e01\u8868\u73b0\u5931\u8d25,errMsg:"+e),t=!0}),[4,c.FW.Task.waitUntil(function(){return t})]):[2];case 2:return o.sent(),[4,e.ModelMgr.ModelFuben.RequestFubenEnter()];case 3:return r=o.sent(),[4,e.CtrlMgr.CtrlBattle.StartByNet(r)];case 4:return o.sent(),[2]}})})}),r.tm("\u6bcf\u65e5\u6311\u6218\u526f\u672c.\u6309\u94ae_\u6bcf\u65e5\u6311\u6218_\u8d2d\u4e70").setClick(function(){e.isCanBuy?e.ModelMgr.ModelFuben.RequestFubenBuyTimes(e.dailyVo.getRefId(),3):e.CtrlAlert.LayerMessage.addMessage(c.FW.G_W("\u4eca\u65e5\u8d2d\u4e70\u6b21\u6570\u5df2\u7ecf\u7528\u5b8c\u4e86\uff0c\u8bf7\u660e\u5929\u518d\u6765\u5427~"))},e);for(var o=e.ModelMgr.ModelFuben.GetBoxRewardByRewardId(e.dailyVo.GetRewardId()),n=function(t){var n=_.get(t);r.tm(n).setClick(function(){var i=e.dailyVo.GetBoxStateByType(o[t].id);if(1!=i){e.isGetReward=0!=i;var a=o[t];e.updatePopList(a.reward),e.updatePopPos(r.tm(n).asCom)}else e.ModelMgr.ModelFuben.RequestFubenDailyReward(o[t].id)},e)},i=0;i<_.size;i++)n(i);r.tm("\u6bcf\u65e5\u6311\u6218\u526f\u672c.\u6309\u94ae_\u6bcf\u65e5\u6311\u6218_\u8d50\u798f").setClick(function(){},e),r.tm("\u6bcf\u65e5\u6311\u6218\u526f\u672c.\u6309\u94ae_\u6bcf\u65e5\u6311\u6218_\u715e\u6c14").setClick(function(){},e)},e.prototype.InitList=function(){var t=this,e=t.com;e.tm("\u91d1\u5e01\u526f\u672c.\u5217\u8868_\u91d1\u5e01\u526f\u672c_\u5956\u52b1").asList.init(t,function(e,r,o){var n=t.ModelMgr.ModelGoods.CreateGoods(o),i=r.asCom.tm("com_goods");i.UpdateByGoods(n),i.GetBehavior().onNumberVisible(!1),i.ClickItem(!0,n,t.parent.proxy)}),e.tm("\u6bcf\u65e5\u6311\u6218\u526f\u672c.\u5956\u52b1\u5c55\u793a.\u5217\u8868_\u5c55\u793a").asList.init(t,function(e,r,o){var n=r.asCom.tm("com_goods"),i=t.ModelMgr.ModelGoods.CreateGoodsByCmd({resId:o.resId,number:String(o.number),quality:o.quality});n.UpdateByGoods(i),n.ClickItem(!0,i,t.parent.proxy);var a=t.isGetReward?1:0;r.asCom.setSelectedIndex("\u9886\u53d6\u72b6\u6001",a)})},e.prototype.updateList=function(){var t=this.com.tm("\u91d1\u5e01\u526f\u672c.\u5217\u8868_\u91d1\u5e01\u526f\u672c_\u5956\u52b1").asList,e=[y.ECurrencyType.coin];t.update(e)},e.prototype.updatePopList=function(t){var e=this.com.tm("\u6bcf\u65e5\u6311\u6218\u526f\u672c.\u5956\u52b1\u5c55\u793a.\u5217\u8868_\u5c55\u793a").asList;e.update(t),e.resizeToFit()},e.prototype.updateLayer=function(){var t=this,e=t.com,r=t.goldVo.GetFreeTimes();e.tm("\u91d1\u5e01\u526f\u672c.\u6587\u672c_\u91d1\u5e01\u526f\u672c_\u6b21\u6570").asTextField.setVar("times",r.toString()).flushVars(),e.tm("\u91d1\u5e01\u526f\u672c.\u6309\u94ae_\u91d1\u5e01\u526f\u672c_\u5f00\u59cb\u6311\u6218.\u7ea2\u70b9").OnRDUpdate(r);var o=t.dailyVo.GetFreeTimes(),n=0;if(o>0)e.tm("\u6bcf\u65e5\u6311\u6218\u526f\u672c.\u6587\u672c_\u6bcf\u65e5\u6311\u6218_\u6b21\u6570").asTextField.setVar("times",o.toString()).flushVars();else{n=1;var i=t.dailyVo.GetBuyTimes();t.isCanBuy=!0,i<=0&&(t.isCanBuy=!1),e.tm("\u6bcf\u65e5\u6311\u6218\u526f\u672c.\u6309\u94ae_\u6bcf\u65e5\u6311\u6218_\u8d2d\u4e70").grayed=!t.isCanBuy}var a=this.ModelMgr.ModelSta.GetEnd(),l=o>0&&a>=this.dailyConsumeSta;e.tm("\u6bcf\u65e5\u6311\u6218\u526f\u672c.\u6309\u94ae_\u6bcf\u65e5\u6311\u6218_\u5f00\u59cb\u6311\u6218.\u7ea2\u70b9").OnRDUpdate(l),e.tm("\u6bcf\u65e5\u6311\u6218\u526f\u672c").asCom.setSelectedIndex("\u6bcf\u65e5\u6311\u6218\u662f\u5426\u8d2d\u4e70\u6b21\u6570",n)},e.prototype.updateBoxState=function(){for(var t=this,e=t.com,r=t.ModelMgr.ModelFuben.GetBoxRewardByRewardId(t.dailyVo.GetRewardId()),o=0;o<_.size;o++){var n=_.get(o),i=t.dailyVo.GetBoxStateByType(r[o].id);e.tm(n).asCom.setSelectedIndex("\u9886\u53d6\u72b6\u6001",i),e.tm(n).asCom.tm("\u7ea2\u70b9").OnRDUpdate(i)}},e.prototype.checkShowBuff=function(){var t=this.ModelMgr.ModelVO.VORoleBag.GetOne(),e=this.TimeUtil.getDayString(this.TimeUtil.LocalNow()),r=f.StringUtil.format("adventureOpen_{0}",t.GetRoleId()),o=s.EngineMain.readLocalStorage(r,"");return(""==o||o!=e)&&(s.EngineMain.saveLocalStorage(r,e),!0)},e.prototype.updatePopPos=function(t){var e=this.com;e.tm("\u6bcf\u65e5\u6311\u6218\u526f\u672c").asCom.setSelectedIndex("\u5c55\u793a\u5956\u52b1",1);var r=e.tm("\u6bcf\u65e5\u6311\u6218\u526f\u672c.\u5956\u52b1\u5c55\u793a"),o=e.tm("\u6bcf\u65e5\u6311\u6218\u526f\u672c.\u5956\u52b1\u5c55\u793a.com_float"),n=p.PopInfoDirect.bottommid,i=t.localToGlobal(),a=t.width/2,l=t.height/2,s=r.width/2,c=o.height/2,u=i.x+a-s,f=i.y-l-c,h=r.parent.globalToLocal(u,f);r.x=h.x,r.y=h.y,o.setArrowVisible(n)},e.__cname="TabAdventureUI",i([u.injectField("TimeUtil")],e.prototype,"TimeUtil",void 0),i([u.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([u.injectField("CtrlMain")],e.prototype,"CtrlMain",void 0),i([u.injectField("CtrlAlert")],e.prototype,"CtrlAlert",void 0),i([u.injectField("LayerAdventureBuff")],e.prototype,"LayerAdventureBuff",void 0),e}(m.GameTabUI);r.TabAdventureUI=g,cc._RF.pop()},{"../../../../../engine/EngineMain":void 0,"../../../../../framework/FW":void 0,"../../../../../framework/container/Container":void 0,"../../../../../framework/fgui/FairyMgr":void 0,"../../../../../framework/utils/StringUtil":void 0,"../../../model/System/ModelSystem":"ModelSystem","../../../model/goods/ModelGoods":"ModelGoods","../../../model/vo/Other/VOFuben":"VOFuben","../../../ui/GameTab":"GameTab","../../alert/CtrlAlert":"CtrlAlert"}],TabDayTask:[function(t,e,r){"use strict";cc._RF.push(e,"9637aqop7VP7bNvhLjFwS6G","TabDayTask");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.TabDayTaskUI=r.TabDayTask=void 0;var l=t("../../../../../../framework/container/Container"),s=t("../../../../../../framework/layer/common/UIOrder"),c=t("../../../../../generated/netProto/CmdInterface"),u=t("../../../../model/System/ModelSystem"),p=t("../../../../ui/GameTab"),f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUrl=function(){return"ui://\u9996\u9875_\u4fee\u70bc_\u4efb\u52a1\u7cfb\u7edf/\u7ec4\u4ef6_\u4efb\u52a1_\u65e5\u5e38"},e.prototype.getUIClass=function(){return h},e.prototype.getSortOrder=function(){return s.LayerOrder.TowLevel},e.prototype.getSystemId=function(){return u.SystemId.DayTask},e.__cname="TabDayTask",e}(p.GameTabProxy);r.TabDayTask=f;var h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.init=function(){var t=this;t.com.toFullCenterParent(t.container),t.InitList(),t.toolSet.addTimer(1e3,function(){t.updateTime()})},e.prototype.enter=function(){this.updateView(),this.ModelMgr.ModelTask.GetEventProxy().addListener("dayTaskChange",this,this.updateView)},e.prototype.exit=function(){this.ModelMgr.ModelTask.GetEventProxy().removeListener("dayTaskChange",this,this.updateView)},e.prototype.InitList=function(){var t=this,e=this;e.com.tm("list").asList.initVirtualList(e,function(r,o,n){var i=o.asCom,a=t.ModelMgr.ModelTask.GetRefDailyTask(n.resId),l=i.tm("\u8fdb\u5ea6\u6761_\u4efb\u52a1\u8fdb\u5ea6").asProgress,s=a.param.count||a.param.level;s||(s=a.param.talent),l.max=s;var u,p=n.count;u=p>s?s:p,l.value=u,i.tm("\u6587\u672c_\u6807\u9898").text=a.name;var f=a.reward,h=e.ModelMgr.ModelTask.GetRefTaskReward(f).reward,y=e.ModelMgr.ModelGoods.CreateGoods(h[0].resId);y.SetNumber(h[0].number),i.tm("com_goods").UpdateByGoods(y);var d=n.rewardState;i.setSelectedIndex("\u5b8c\u6210\u72b6\u6001",d),2!=d&&i.tm("\u6309\u94ae_\u524d\u5f80").setClick(function(){if(0==d){var r=a.gotoKey;e.CtrlMgr.JumpLayer(r)&&t.parent.proxy.unload()}else 1==d&&e.ModelMgr.ModelTask.RequestTaskReward(a.resId,c.CmdTaskType.DAILY_TASK)},i)})},e.prototype.updateView=function(){var t=this;t.updateHuoYue(),t.updateList(),t.updateTime()},e.prototype.updateHuoYue=function(){var t,e,r=this,o=this,n=o.com,i=[],l=o.ModelMgr.ModelTask.GetTlRefActiveTask(0),s=o.ModelMgr.ModelRole.GetRole(),c=function(t){var e,r,n=t.reward,l=o.ModelMgr.ModelTask.GetRefTaskReward(n),c=[];try{for(var u=(e=void 0,a(l.reward)),p=u.next();!p.done;p=u.next()){var f=p.value;c.push({resId:f.resId,number:f.number})}}catch(h){e={error:h}}finally{try{p&&!p.done&&(r=u.return)&&r.call(u)}finally{if(e)throw e.error}}i.push({checkListen:function(){return t.process>s.GetDailyActive()||s.GetDailyActiveTake()>=t.process},rewardList:c,getRewardListen:function(){o.ModelMgr.ModelTask.RequestTakeActiveReward(0)},name:t.process.toString()})};try{for(var u=a(l),p=u.next();!p.done;p=u.next())c(p.value)}catch(h){t={error:h}}finally{try{p&&!p.done&&(e=u.return)&&e.call(u)}finally{if(t)throw t.error}}var f=n.tm("\u7ec4\u4ef6_\u8fdb\u5ea6\u6846");f.Init(i,o.parent.proxy),f.SetFilter(function(t){return l[t].process>s.GetDailyActive()?0:(r.log("role.GetDailyActiveTake():",s.GetDailyActiveTake()),s.GetDailyActiveTake()>=l[t].process?2:1)}),f.updateProgress(s.GetDailyActive(),l[l.length-1].process)},e.prototype.updateList=function(){var t=this.ModelMgr.ModelTask.GetTlDayTask();t.sort(function(t,e){var r=t.resId,o=e.resId;return r+=t.rewardState%2==1?1e3:1e3*-t.rewardState,(o+=e.rewardState%2==1?1e3:1e3*-e.rewardState)-r}),this.com.tm("list").asList.update(t)},e.prototype.updateTime=function(){var t=this.com,e=this.TimeUtil.timeSec2HMSStr11(!1);t.tm("\u6587\u672c_\u5012\u8ba1\u65f6").asTextField.setVar("time",e).flushVars()},e.__cname="TabDayTaskUI",i([l.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([l.injectField("TimeUtil")],e.prototype,"TimeUtil",void 0),e}(p.GameTabUI);r.TabDayTaskUI=h,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../../../../../framework/layer/common/UIOrder":void 0,"../../../../../generated/netProto/CmdInterface":"CmdInterface","../../../../model/System/ModelSystem":"ModelSystem","../../../../ui/GameTab":"GameTab"}],TabFriendsApply:[function(t,e,r){"use strict";cc._RF.push(e,"ed043JTbOJIAKdVcO0ZQD0q","TabFriendsApply");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.TabFriendsApplyUI=r.TabFriendsApply=void 0;var i=t("../../../../../../framework/layer/common/UIOrder"),a=t("../../../../model/System/ModelSystem"),l=t("../../../../ui/GameTab"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUrl=function(){return"ui://\u9996\u9875_\u4fee\u70bc_\u597d\u53cb\u7cfb\u7edf/\u7ec4\u4ef6_\u597d\u53cb\u7cfb\u7edf_\u7533\u8bf7\u5217\u8868"},e.prototype.getUIClass=function(){return c},e.prototype.getSortOrder=function(){return i.LayerOrder.TowLevel},e.prototype.getSystemId=function(){return a.SystemId.None},e.prototype.OnGetRDExpr=function(){return"[RDFriendsApply]"},e.__cname="TabFriendsApply",e}(l.GameTabProxy);r.TabFriendsApply=s;var c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.init=function(){var t=this;this.com.toFullCenterParent(this.container),this.InitClick(),this.InitList(),this.toolSet.addListener(this.ModelMgr.ModelVO.VOApplyFirendBag.GetEventProxy(),"OnChanged",function(){t.UpdateView()})},e.prototype.enter=function(){this.UpdateView()},e.prototype.InitClick=function(){var t=this;this.com.tm("\u6309\u94ae_\u5168\u90e8\u901a\u8fc7").setClick(function(){t.ModelMgr.ModelFriends.RequestFriendAgreeOneKey()},this),this.com.tm("\u6309\u94ae_\u5168\u90e8\u62d2\u7edd").setClick(function(){t.ModelMgr.ModelFriends.RequestFriendRefuseOneKey()},this)},e.prototype.InitList=function(){var t=this;this.com.tm("\u5217\u8868_\u7533\u8bf7\u5217\u8868").asList.initVirtualList(this,function(e,r,o){var n=r.tm("\u7ec4\u4ef6_\u4fe1\u606f");console.log("vo:",o),n.UpdateByFirendInfo(o.GetDetail()),n.ClickRoleDetail(),r.setSelectedPage("\u7c7b\u578b","\u88ab\u7533\u8bf7\u5217\u8868"),r.tm("\u6309\u94ae_\u901a\u8fc7").setClick(function(){t.ModelMgr.ModelFriends.RequestFriendsAdd(o.GetRoleId())},t),r.tm("\u6309\u94ae_\u62d2\u7edd").setClick(function(){t.ModelMgr.ModelFriends.RequestFriendsRefuse(o.GetRoleId())},t)})},e.prototype.UpdateView=function(){var t=this,e=this.ModelMgr.ModelVO.VOApplyFirendBag.GetBagAsArray();0==e.length?t.com.setSelectedPage("\u6709\u65e0\u5185\u5bb9","\u65e0"):(t.com.setSelectedPage("\u6709\u65e0\u5185\u5bb9","\u6709"),t.com.tm("\u5217\u8868_\u7533\u8bf7\u5217\u8868").asList.update(e))},e.__cname="TabFriendsApplyUI",e}(l.GameTabUI);r.TabFriendsApplyUI=c,cc._RF.pop()},{"../../../../../../framework/layer/common/UIOrder":void 0,"../../../../model/System/ModelSystem":"ModelSystem","../../../../ui/GameTab":"GameTab"}],TabFriendsBlack:[function(t,e,r){"use strict";cc._RF.push(e,"4f1b59PC2BM54zRgRl4LTyG","TabFriendsBlack");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.TabFriendsBlackUI=r.TabFriendsBlack=void 0;var i=t("../../../../../../framework/layer/common/UIOrder"),a=t("../../../../model/System/ModelSystem"),l=t("../../../../ui/GameTab"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUrl=function(){return"ui://\u9996\u9875_\u4fee\u70bc_\u597d\u53cb\u7cfb\u7edf/\u7ec4\u4ef6_\u597d\u53cb\u7cfb\u7edf_\u9ed1\u540d\u5355"},e.prototype.getUIClass=function(){return c},e.prototype.getSortOrder=function(){return i.LayerOrder.TowLevel},e.prototype.getSystemId=function(){return a.SystemId.None},e.__cname="TabFriendsBlack",e}(l.GameTabProxy);r.TabFriendsBlack=s;var c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.init=function(){var t=this;this.com.toFullCenterParent(this.container),this.InitList(),this.toolSet.addListener(this.ModelMgr.ModelVO.VOBlackFriendBag.GetEventProxy(),"OnChanged",function(){t.UpdateView()})},e.prototype.enter=function(){this.UpdateView()},e.prototype.InitList=function(){var t=this;this.com.tm("\u5217\u8868_\u9ed1\u540d\u5355").asList.initVirtualList(this,function(e,r,o){var n=r.tm("\u7ec4\u4ef6_\u4fe1\u606f");n.UpdateByFirendInfo(o.GetDetail()),n.ClickRoleDetail(),r.setSelectedPage("\u7c7b\u578b","\u9ed1\u540d\u5355\u5217\u8868"),r.tm("\u6309\u94ae_\u79fb\u9664\u9ed1\u540d\u5355").setClick(function(){t.ModelMgr.ModelFriends.RequestFriendBlackRemove(o.GetRoleId())},t)})},e.prototype.UpdateView=function(){var t=this.ModelMgr.ModelVO.VOBlackFriendBag.GetBagAsArray();0==t.length?this.com.setSelectedPage("\u6709\u65e0\u5185\u5bb9","\u65e0"):(this.com.setSelectedPage("\u6709\u65e0\u5185\u5bb9","\u6709"),this.com.tm("\u5217\u8868_\u9ed1\u540d\u5355").asList.update(t));var e=this.ModelMgr.ModelFriends.GetMaxBlackListNumber(),r=t.length+"/"+e;this.com.tm("\u6587\u672c_\u9ed1\u540d\u5355\u6570\u91cf").asTextField.setVar("value",r).flushVars()},e.__cname="TabFriendsBlackUI",e}(l.GameTabUI);r.TabFriendsBlackUI=c,cc._RF.pop()},{"../../../../../../framework/layer/common/UIOrder":void 0,"../../../../model/System/ModelSystem":"ModelSystem","../../../../ui/GameTab":"GameTab"}],TabFriendsReceive:[function(t,e,r){"use strict";cc._RF.push(e,"c4c0eJY63hD8L7rcy0uf9PD","TabFriendsReceive");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.TabFriendsReceiveUI=r.TabFriendsReceive=void 0;var i=t("../../../../../../framework/FW"),a=t("../../../../../../framework/layer/common/UIOrder"),l=t("../../../../model/System/ModelSystem"),s=t("../../../../ui/GameTab"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUrl=function(){return"ui://\u9996\u9875_\u4fee\u70bc_\u597d\u53cb\u7cfb\u7edf/\u7ec4\u4ef6_\u597d\u53cb\u7cfb\u7edf_\u4f53\u529b\u9886\u53d6"},e.prototype.getUIClass=function(){return u},e.prototype.getSortOrder=function(){return a.LayerOrder.TowLevel},e.prototype.getSystemId=function(){return l.SystemId.None},e.prototype.OnGetRDExpr=function(){return"[RDFriendsReceive]"},e.__cname="TabFriendsReceive",e}(s.GameTabProxy);r.TabFriendsReceive=c;var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.init=function(){var t=this;this.com.toFullCenterParent(this.container),this.InitBtn(),this.InitList(),this.voSubSet=this.ModelMgr.ModelVO.VOFirendBag.CreateSubset(),this.voSubSet.SetFilter(function(t){return t.GetTodayReceive()&&!t.GetTodayTake()}),this.toolSet.addListener(this.voSubSet.GetEventProxy(),"OnChanged",function(){t.UpdateView()}),this.toolSet.addDefer(function(){t.ModelMgr.ModelVO.VOFirendBag.DestroySubset(t.voSubSet),t.voSubSet=null})},e.prototype.enter=function(){this.UpdateView()},e.prototype.InitBtn=function(){var t=this;this.com.tm("\u6309\u94ae_\u4e00\u952e\u9886\u53d6").setClick(function(){t.ModelMgr.ModelRole.GetRole().GetTodayTakeEndNum()<=0?i.FW.showTip("\u4eca\u65e5\u9886\u53d6\u6b21\u6570\u5df2\u7528\u5b8c"):t.ModelMgr.ModelFriends.RequestFriendGetEndOneKey()},this)},e.prototype.InitList=function(){var t=this;this.com.tm("\u5217\u8868_\u4f53\u529b\u9886\u53d6").asList.initVirtualList(this,function(e,r,o){var n=r.tm("\u7ec4\u4ef6_\u4fe1\u606f");n.UpdateByFirendInfo(o.GetDetail()),n.ClickRoleDetail(),r.setSelectedPage("\u7c7b\u578b","\u4f53\u529b\u9886\u53d6\u5217\u8868"),r.tm("\u6309\u94ae_\u9886\u53d6\u4f53\u529b").setClick(function(){t.ModelMgr.ModelRole.GetRole().GetTodayTakeEndNum()<=0?i.FW.showTip("\u4eca\u65e5\u9886\u53d6\u6b21\u6570\u5df2\u7528\u5b8c"):t.ModelMgr.ModelFriends.RequestFriendGetEnd(o.GetRoleId())},t)})},e.prototype.UpdateView=function(){var t=this.ModelMgr.ModelRole.GetRole().GetTodayTakeEndNum(),e=this.ModelMgr.ModelFriends.GetMaxReceiveStaTimes(),r=this.voSubSet.GetTlVO();0==r.length?this.com.setSelectedPage("\u6709\u65e0\u5185\u5bb9","\u65e0"):(this.com.setSelectedPage("\u6709\u65e0\u5185\u5bb9","\u6709"),this.com.tm("\u5217\u8868_\u4f53\u529b\u9886\u53d6").asList.update(r));var o=t+"/"+e;this.com.tm("\u6587\u672c_\u4eca\u65e5\u53ef\u9886\u53d6\u6570\u91cf").asTextField.setVar("value",o).flushVars()},e.__cname="TabFriendsReceiveUI",e}(s.GameTabUI);r.TabFriendsReceiveUI=u,cc._RF.pop()},{"../../../../../../framework/FW":void 0,"../../../../../../framework/layer/common/UIOrder":void 0,"../../../../model/System/ModelSystem":"ModelSystem","../../../../ui/GameTab":"GameTab"}],TabFriends:[function(t,e,r){"use strict";cc._RF.push(e,"391dbDMFDNBDqrOH3G02QS4","TabFriends");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.TabFriendsUI=r.TabFriends=void 0;var i=t("../../../../../../framework/FW"),a=t("../../../../../../framework/layer/common/UIOrder"),l=t("../../../../model/System/ModelSystem"),s=t("../../../../ui/GameTab"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUrl=function(){return"ui://\u9996\u9875_\u4fee\u70bc_\u597d\u53cb\u7cfb\u7edf/\u7ec4\u4ef6_\u597d\u53cb\u7cfb\u7edf_\u597d\u53cb"},e.prototype.getUIClass=function(){return u},e.prototype.getSortOrder=function(){return a.LayerOrder.TowLevel},e.prototype.getSystemId=function(){return l.SystemId.None},e.__cname="TabFriends",e}(s.GameTabProxy);r.TabFriends=c;var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.init=function(){var t=this;this.com.toFullCenterParent(this.container),this.InitBtn(),this.InitList(),this.toolSet.addListener(this.ModelMgr.ModelVO.VOFirendBag.GetEventProxy(),"OnChanged",function(){t.UpdateView()})},e.prototype.enter=function(){this.UpdateView()},e.prototype.InitBtn=function(){var t=this;this.com.tm("\u6309\u94ae_\u4e00\u952e\u8d60\u9001").setClick(function(){t.SetDelectState(!1);var e=t.ModelMgr.ModelRole.GetRole();e&&e.GetTodaySendEndNum()<=0&&i.FW.showTip("\u4eca\u65e5\u8d60\u9001\u4f53\u529b\u6b21\u6570\u5df2\u7528\u5b8c"),t.ModelMgr.ModelFriends.RequestFriendSendEndOneKey()},this),this.com.tm("\u6309\u94ae_\u5220\u9664\u597d\u53cb").setClick(function(){t.SetDelectState(!0)},this),this.com.tm("\u6309\u94ae_\u53d6\u6d88\u5220\u9664").setClick(function(){t.SetDelectState(!1)},this),this.com.tm("\u6309\u94ae_\u6dfb\u52a0\u597d\u53cb").setClick(function(){t.SetDelectState(!1),t.CtrlMgr.CtrlFriends._LayerAddFriend.load()},this)},e.prototype.InitList=function(){var t=this;this.com.tm("\u5217\u8868_\u597d\u53cb").asList.initVirtualList(this,function(e,r,o){r.setSelectedPage("\u7c7b\u578b","\u597d\u53cb\u5217\u8868");var n=r.tm("\u7ec4\u4ef6_\u4fe1\u606f");if(n.UpdateByFirendInfo(o.GetDetail()),n.ClickRoleDetail(),t.GetDelectState())r.setSelectedPage("\u597d\u53cb\u72b6\u6001","\u53ef\u5220\u9664"),r.tm("\u6309\u94ae_\u5220\u9664\u597d\u53cb").setClick(function(){t.CtrlMgr.CtrlAlert.LayerShowTip.SetData({context:i.FW.G_W("\u5b9d~\u662f\u5426\u5220\u9664\u597d\u53cb:")+o.GetRoleName(),sumitFuncion:function(){t.ModelMgr.ModelFriends.RequestFriendsRemove(o.GetRoleId())}}),t.CtrlMgr.CtrlAlert.LayerShowTip.load()},t);else{var a=t.ModelMgr.ModelRole.GetRole();o.GetTodaySend()?r.setSelectedPage("\u597d\u53cb\u72b6\u6001","\u5df2\u8d60\u9001"):a&&a.GetTodaySendEndNum()<=0?r.setSelectedPage("\u597d\u53cb\u72b6\u6001","\u4e0d\u53ef\u8d60\u9001"):r.setSelectedPage("\u597d\u53cb\u72b6\u6001","\u672a\u8d60\u9001"),r.tm("\u6309\u94ae_\u8d60\u9001\u4f53\u529b").setClick(function(){t.ModelMgr.ModelFriends.RequestFriendSendEnd(o.GetRoleId())},t)}})},e.prototype.UpdateView=function(){var t=this,e=t.ModelMgr.ModelVO.VOFirendBag.GetBagAsArray();0==e.length?this.com.setSelectedPage("\u6709\u65e0\u5185\u5bb9","\u65e0"):(this.com.setSelectedPage("\u6709\u65e0\u5185\u5bb9","\u6709"),this.com.tm("\u5217\u8868_\u597d\u53cb").asList.update(e));var r=e.length,o=t.ModelMgr.ModelFriends.GetMaxFriendNumber(),n=t.ModelMgr.ModelRole.GetRole().GetTodaySendEndNum();t.com.tm("\u6587\u672c_\u597d\u53cb\u6570\u91cf").asTextField.setVar("value",r+"/"+o).flushVars(),t.com.tm("\u5bcc\u6587\u672c_\u4eca\u65e5\u53ef\u8d60\u9001\u6b21\u6570").asTextField.setVar("times",String(n)).flushVars()},e.prototype.SetDelectState=function(t){this.com.setSelectedPage("\u662f\u5426\u5220\u9664\u72b6\u6001",t?"\u662f":"\u5426"),this.isdelete=t},e.prototype.GetDelectState=function(){return this.isdelete},e.__cname="TabFriendsUI",e}(s.GameTabUI);r.TabFriendsUI=u,cc._RF.pop()},{"../../../../../../framework/FW":void 0,"../../../../../../framework/layer/common/UIOrder":void 0,"../../../../model/System/ModelSystem":"ModelSystem","../../../../ui/GameTab":"GameTab"}],TabGMCacheList:[function(t,e,r){"use strict";cc._RF.push(e,"7a8b4CjGmtHUJOKxGzxHeVE","TabGMCacheList");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.TabGMCacheListUI=r.TabGMCacheList=void 0;var i=t("../../ui/GameTab"),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return l},e.prototype.getUrl=function(){return"ui://GM/\u7ec4\u4ef6_\u7f13\u5b58\u6c60\u5217\u8868"},e.__cname="TabGMCacheList",e}(i.GameTabProxy);r.TabGMCacheList=a;var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.init=function(){this.com.toFullCenterParent(this.container)},e.__cname="TabGMCacheListUI",e}(i.GameTabUI);r.TabGMCacheListUI=l,cc._RF.pop()},{"../../ui/GameTab":"GameTab"}],TabGMClient:[function(t,e,r){"use strict";cc._RF.push(e,"7ec285sd31FEL2Dhu+WGPWY","TabGMClient");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.TabGMClientUI=r.TabGMClient=void 0;var s=t("../../../../framework/container/Container"),c=t("../../../../framework/FW"),u=t("../../../../framework/log/Log"),p=t("../../../example/TestConstraint"),f=t("../../../example/TestCor"),h=t("../../../example/TestExpr"),y=t("../../../example/TestGeometry"),d=t("../../../example/TestGloader"),m=t("../../../example/TestGobjGoods"),v=t("../../../example/TestHttp"),_=t("../../../example/TestPhysis"),S=t("../../../example/TestPopupPanel"),g=t("../../../example/TestPromise"),b=t("../../../example/TestQuickSort"),C=t("../../../example/TestRef"),R=t("../../ui/GameTab"),M=t("./TabGMCommand"),w=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return O},e.prototype.getUrl=function(){return"ui://GM/\u7ec4\u4ef6_GM_\u5ba2\u6237\u7aef"},e.__cname="TabGMClient",e}(R.GameTabProxy);r.TabGMClient=w;var O=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tmHandlers=new Map,e._requestIng=!1,e}return n(e,t),e.prototype.init=function(){var t=this,e=t.com;e.toFullCenterParent(this.container),t.updateView(),e.tm("\u6587\u672c_GM").text="",e.tm("\u6309\u94ae_\u786e\u5b9a").setClick(t.onClickOk,t)},e.prototype.release=function(){this.onReleaseHandler(),this.onRelease()},e.prototype.onReleaseHandler=function(){},e.prototype.initGMData=function(){var t,e,r=this,o=this.com.tm("list").asList,n=(this.modelPublicData.appCustomData.serverVersion,[{gm:"testPromise",desc:"\u6d4b\u8bd5Promise"},{gm:"testRef",desc:"\u6d4b\u8bd5Ref"},{gm:"testQuickSort",desc:"\u6d4b\u8bd5\u5feb\u6392"},{gm:"testTestHttp",desc:"\u6d4b\u8bd5Http"},{gm:"testGloader",desc:"\u6d4b\u8bd5Gloader"},{gm:"testGoods",desc:"\u6d4b\u8bd5Goods"},{gm:"testPopup",desc:"\u6d4b\u8bd5Popup"},{gm:"testBattle",desc:"\u6d4b\u8bd5\u6218\u6597"},{gm:"testGeometry",desc:"\u6d4b\u8bd5\u51e0\u4f55"},{gm:"testConstraint",desc:"\u6d4b\u8bd5\u7ea6\u675f"},{gm:"TestPhysis",desc:"\u6d4b\u8bd5\u7b80\u6613\u7269\u7406\u5f15\u64ce"},{gm:"TestCor",desc:"\u6d4b\u8bd5Cor\u534f\u7a0b"},{gm:"TestCloseSocket",desc:"\u6d4b\u8bd5\u65adSocket"},{gm:"TestReconnectSocket",desc:"\u6d4b\u8bd5Socket\u91cd\u8fde"},{gm:"TestExpr",desc:"\u6d4b\u8bd5Expr\u8868\u8fbe\u5f0f"}]);try{for(var i=a(u.Log.tmLogsss),R=i.next();!R.done;R=i.next()){var M=l(R.value,2),w=M[0],O=(M[1],s.Container.inst().getByAlias("OnOffMgr").GetSub(w));if(O){var B=O.GetValue();n.unshift({gm:"log "+w,desc:(B?"\u5173\u95ed":"\u6253\u5f00")+w})}}}catch(P){t={error:P}}finally{try{R&&!R.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}this.registerHandler("log",function(){var t=r.com.tm("\u6587\u672c_GM").text.replace("log ",""),e=s.Container.inst().getByAlias("OnOffMgr").GetSub(t);if(e){var o=e.GetValue();e.SetValue(!o),e.Save()}r.unload()}),this.registerHandler("fps",function(){cc.debug.setDisplayStats(!cc.debug.isDisplayStats()),c.FW.Log.log("\u663e\u793a\u5e27\u7387: ",cc.debug.isDisplayStats()),c.FW.Log.log("\u5e27\u7387: ",cc.game.getFrameRate())}),this.registerHandler("testPromise",function(){g.TestPromise.Test()}),this.registerHandler("testRef",function(){C.TestRef.Test()}),this.registerHandler("testQuickSort",function(){b.TestQuickSort.Test()}),this.registerHandler("testTestHttp",function(){v.TestHttp.Test()}),this.registerHandler("testGloader",function(){r.unload(),d.TestGloader.Test()}),this.registerHandler("testGoods",function(){r.unload(),m.TestGobjGoods.Test()}),this.registerHandler("testPopup",function(){r.unload(),S.TestPopupPanel.Test()}),this.registerHandler("testGeometry",function(){r.unload(),y.TestGeometry.Test()}),this.registerHandler("testConstraint",function(){r.unload(),p.TestConstraint.Test()}),this.registerHandler("TestPhysis",function(){r.unload(),_.TestPhysis.Test()}),this.registerHandler("TestCor",function(){r.unload(),f.TestCor.Test()}),this.registerHandler("TestExpr",function(){r.unload(),h.TestExpr.Test()}),this.registerHandler("TestCloseSocket",function(){r.unload(),r.Net.closeSocket().then(function(){c.FW.ZJJ.log("\u5df2\u5173\u95edsocket"),c.FW.ZJJ.log(r.Net)})}),this.registerHandler("TestReconnectSocket",function(){r.unload(),r.Net.netSocket.reconnect()}),o.update(n)},e.prototype.registerHandler=function(t,e){this.tmHandlers.set(t,e)},e.prototype.triggerHanlder=function(t){if(this.tmHandlers.has(t)){var e=this.tmHandlers.get(t);return e&&e(),!0}return!1},e.prototype.onRelease=function(){this.modelRole=null,this.modelPublicData=null,this.appCustomInfo=null,this.ctrlGM=null},e.prototype.updateView=function(){var t=this;t.com.tm("list").asList.initVirtualList(t,t.renderListItem,t.onClickItem),this.modelPublicData.appCustomData.serverVersion,this.getShowVersonStr(),this.appCustomInfo,this.initGMData()},e.prototype.renderListItem=function(t,e,r){e.tm("\u6587\u672c_GM").text=r.gm,e.tm("\u6587\u672c_\u8bf4\u660e").text=r.desc},e.prototype.onClickItem=function(t,e,r){var o=this,n=o.com;o._selectIndex=t;var i=M.TabGMCommandUI.tmTempData.get(o._selectIndex);n.tm("\u6587\u672c_GM").text=i||r.gm},e.prototype.onClickOk=function(){var t=this,e=t.com.tm("\u6587\u672c_GM").text;if(e){if(M.TabGMCommandUI.initText=e,null!=t._selectIndex&&M.TabGMCommandUI.tmTempData.set(t._selectIndex,e),"serverDay"!=e){var r=e.split(" ")[0];this.triggerHanlder(r)||cc.error("\u65e0\u6cd5\u53d1\u9001\u6570\u636e")}}else c.FW.showTip("\u8bf7\u8f93\u5165\u547d\u4ee4")},e.prototype.getShowVersonStr=function(){var t=this.modelPublicData.appCustomData;return t.serverVersion+","+t.versionCode+"_"},e.prototype.unload=function(){this.ctrlGM.LayerGMMain.unload()},e.__cname="TabGMClientUI",e.tmTempData=new Map,e.initText="add",i([s.injectField("OnOffMgr")],e.prototype,"OnOffMgr",void 0),i([s.injectField("Net")],e.prototype,"Net",void 0),i([s.injectField("ModelRole")],e.prototype,"modelRole",void 0),i([s.injectField("ModelPublicData")],e.prototype,"modelPublicData",void 0),i([s.injectField("AppCustomInfo")],e.prototype,"appCustomInfo",void 0),i([s.injectField("CtrlGM")],e.prototype,"ctrlGM",void 0),e}(R.GameTabUI);r.TabGMClientUI=O,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/container/Container":void 0,"../../../../framework/log/Log":void 0,"../../../example/TestConstraint":"TestConstraint","../../../example/TestCor":"TestCor","../../../example/TestExpr":"TestExpr","../../../example/TestGeometry":"TestGeometry","../../../example/TestGloader":"TestGloader","../../../example/TestGobjGoods":"TestGobjGoods","../../../example/TestHttp":"TestHttp","../../../example/TestPhysis":"TestPhysis","../../../example/TestPopupPanel":"TestPopupPanel","../../../example/TestPromise":"TestPromise","../../../example/TestQuickSort":"TestQuickSort","../../../example/TestRef":"TestRef","../../ui/GameTab":"GameTab","./TabGMCommand":"TabGMCommand"}],TabGMCommand:[function(t,e,r){"use strict";cc._RF.push(e,"45e94aew1VPKLHWnIkPqmFO","TabGMCommand");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.TabGMCommandUI=r.TabGMCommand=void 0;var l=t("../../../../engine/EngineMain"),s=t("../../../../framework/container/Container"),c=t("../../../../framework/FW"),u=t("../../../../framework/utils/StringUtil"),p=t("../../../example/TestGeometry"),f=t("../../../example/TestGloader"),h=t("../../../example/TestGobjGoods"),y=t("../../../example/TestHttp"),d=t("../../../example/TestPromise"),m=t("../../../example/TestQuickSort"),v=t("../../../example/TestRef"),_=t("../../../generated/requestMsg/RequestSystemMsg"),S=t("../../gamestate/GameStateMgr"),g=t("../../ui/GameTab"),b=t("../battle/CtrlBattle"),C=t("../battle/debug/SubDebugCommand"),R=t("./TabGMCacheList"),M=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return w},e.prototype.getUrl=function(){return"ui://GM/\u7ec4\u4ef6_GM"},e.__cname="TabGMCommand",e}(g.GameTabProxy);r.TabGMCommand=M;var w=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tmHandlers=new Map,e._requestIng=!1,e}return n(e,t),e.prototype.getHasBackground=function(){return!0},e.prototype.init=function(){var t=this,r=this,o=r.com;o.toFullCenterParent(this.container),r.initView(),o.tm("\u6587\u672c_GM").text=e.initText,o.tm("\u6309\u94ae_\u786e\u5b9a").setClick(r.onClickOk,r),o.tm("\u6309\u94ae_\u7f13\u5b58\u6c60").setClick(function(){t.proxy.switchTab(R.TabGMCacheList)},r),this.toolSet.addListener(this.Net.getEventProxy(),"CmdGmListRspMsg",function(e){t.initGMList(e.cmd)},this),this.Net.netSocket.isSocketConnected&&this.CtrlGameNet.send(new _.RequestGmList({})),this.updateView()},e.prototype.release=function(){this.onReleaseHandler(),this.onRelease()},e.prototype.onReleaseHandler=function(){this.layerBattle=null,this.sDKMgr=null,this.tmHandlers=null},e.prototype.initGMData=function(){var t=this,e=(this.com.tm("list").asList,this.modelPublicData.appCustomData.serverVersion),r=[{gm:"fps",desc:u.StringUtil.format("fps\u663e\u793a:{0} v:{1}",cc.game.getFrameRate(),e)},{gm:"testPve",desc:this.OnOffMgr.OnOffBattleParams.GetValue()?"\u9690\u85cf\u6218\u6597\u53c2\u6570":"\u663e\u793a\u6218\u6597\u53c2\u6570"},{gm:"battle (10000,1,10002,1)(2100100,2,1.5)",desc:"\u865a\u62df\u6218\u573a (\u88c5\u5907id,\u7b49\u7ea7)(\u602a\u7269,\u9635\u578b,\u5f3a\u5ea6)"},{gm:"battlefuben 1 101",desc:"\u8fdb\u5165\u526f\u672c \u526f\u672c\u7c7b\u578b resId"},{gm:"testLogin",desc:"\u5207\u6362\u8d26\u53f7"},{gm:"clearRole",desc:"\u6e05\u53f7"},{gm:"clearCacheWX",desc:"\u6e05\u7406\u5fae\u4fe1\u7f13\u5b58"},{gm:"end",desc:"\u4f53\u529b\u7533\u8bf7"},{gm:"testEquipSection",desc:"\u89e6\u53d1\u88c5\u5907\u7a7f\u6234\u6307\u5f15"},{gm:"filterBuffId",desc:"\u8fc7\u6ee4buffID"},{gm:"clearFilterBuffId",desc:"\u6e05\u9664\u8fc7\u6ee4buffID"}],o=s.Container.inst().getByAlias("CtrlBattle");if(o.GetIsBattleRunning()&&(r.push({gm:"drop",desc:"drop \u6389\u843d\u9053\u5177id \u9053\u5177\u53c2\u6570"}),r.push({gm:"spawn (2100100,2,100)",desc:"spawn (\u602a\u7269id,\u9635\u578b,\u7a00\u758f\u5ea6) (\u602a\u7269id,\u9635\u578b,\u7a00\u758f\u5ea6)"}),r.push({gm:"skill 10000 5",desc:"skill \u6280\u80fdid \u7b49\u7ea7"}),r.push({gm:"supply 1003 5",desc:"supply \u8865\u7ed9id \u7b49\u7ea7"}),r.push({gm:"clear",desc:"clear \u6e05\u573a"}),r.push({gm:"win",desc:"win \u76f4\u63a5\u901a\u5173\u5956\u52b1\u6ee1\u989d\u53d1\u653e"}),r.push({gm:"multeSpeed 1",desc:"multeSpeed \u65f6\u95f4\u500d\u901f"})),this.registerHandler("fps",function(){cc.debug.setDisplayStats(!cc.debug.isDisplayStats()),c.FW.Log.log("\u663e\u793a\u5e27\u7387: ",cc.debug.isDisplayStats()),c.FW.Log.log("\u5e27\u7387: ",cc.game.getFrameRate())}),this.registerHandler("testPve",function(){t.unload();var e=t.OnOffMgr.OnOffBattleParams,r=e.GetValue();e.SetValue(!r),e.Save()}),this.registerHandler("battle",function(){var e,r=t.com.tm("\u6587\u672c_GM").text.split(" "),n=function(){e={};var t=r[1].match(/([\d,\.\s]+)/g),o=t[0].split(",").map(function(t){return parseInt(t)}),n=t[1].split(",").map(function(t){return parseInt(t)});e.skills=o.reduce(function(t,e,r){return r%2==0&&t.push(e),t},[]),e.level=o.reduce(function(t,e,r){return r%2==1&&t.push(e),t},[]),e.monster=n[0],e.type=n[1],e.strong=n[2]},i=function(){try{n();var r=s.Container.inst().getByAlias("CtrlBattle"),o=r.GetSub(b.EBattleType.Field);o.Setup(null),o.ResetSkill();for(var i=0;i<e.skills.length;i++){var a=e.skills[i],l=e.level[i];o.SetSkill(a,l),0==i&&o.SetMainSkill(a)}o.SetupByParam(11e4,e.monster,e.type,e.strong),r.StartBattleField(o)}catch(u){return c.FW.ZJJ.error(u),t.CtrlMgr.CtrlAlert.LayerShowTip.SetData({context:"\u53c2\u6570\u9519\u8bef"}),t.CtrlMgr.CtrlAlert.LayerShowTip.load(),null}};t.unload(),o.GetIsBattleRunning()?o.TryExitBattle().then(function(){i()}):i()}),this.registerHandler("battlefuben",function(){var e=function(){try{var e=t.com.tm("\u6587\u672c_GM").text.split(" "),r=parseInt(e[1])||1,o=parseInt(e[2]);s.Container.inst().getByAlias("CtrlBattle").StartBattleByFubenId(r,o)}catch(n){c.FW.ZJJ.error(n),t.CtrlMgr.CtrlAlert.LayerShowTip.SetData({context:"\u53c2\u6570\u9519\u8bef"}),t.CtrlMgr.CtrlAlert.LayerShowTip.load()}};t.unload(),o.GetIsBattleRunning()?o.TryExitBattle().then(function(){e()}):e()}),this.registerHandler("testLogin",function(){S.GameStateMgr.instance.switchToLogin()}),this.registerHandler("testPromise",function(){d.TestPromise.Test()}),this.registerHandler("testRef",function(){v.TestRef.Test()}),this.registerHandler("testGeometry",function(){p.TestGeometry.Test()}),this.registerHandler("testQuickSort",function(){m.TestQuickSort.Test()}),this.registerHandler("testTestHttp",function(){y.TestHttp.Test()}),this.registerHandler("testGloader",function(){t.unload(),f.TestGloader.Test()}),this.registerHandler("testGoods",function(){t.unload(),h.TestGobjGoods.Test()}),this.registerHandler("clearCacheWx",function(){cc.sys.platform==cc.sys.WECHAT_GAME&&(cc.assetManager.cacheManager.clearCache(),t.CtrlMgr.CtrlAlert.LayerShowTip.SetData({context:"\u6e05\u7406\u6210\u529f\uff0c\u8bf7\u91cd\u65b0\u8fdb\u5165\u6e38\u620f"}),t.CtrlMgr.CtrlAlert.LayerShowTip.load())}),this.registerHandler("end",function(){t.unload();var e=t.TimeUtil.now();t.ModelMgr.ModelSta.RequestRoleEndUpdate({time:e})}),o.GetIsBattleRunning()){var n=o.GetRunningBattle().GetContainer().getByAlias("SystemDebug").GetSubSystem(C.SubDebugCommand),i=function(){var e=t.com.tm("\u6587\u672c_GM").text;n.RumCommand(e),t.unload()};this.registerHandler("drop",function(){i()}),this.registerHandler("spawn",function(){i()}),this.registerHandler("skill",function(){i()}),this.registerHandler("supply",function(){i()}),this.registerHandler("clear",function(){i()}),this.registerHandler("win",function(){i()}),this.registerHandler("multeSpeed",function(){i()})}var g=!1;this.registerHandler("clearRole",function(){g||(g=!0,t.CtrlMgr.CtrlAlert.LayerShowTip.SetData({context:"\u786e\u5b9a\u5220\u9664\u8d26\u53f7",sumitFuncion:function(){t.ModelAccount.SendDeleteAccount_cor().then(function(){g=!1,l.EngineMain.clearLocalStorage(),S.GameStateMgr.instance.switchToLogin()})}}),t.CtrlMgr.CtrlAlert.LayerShowTip.load())}),this.registerHandler("getAllEquip",function(){var e,r,o=s.Container.inst().getByAlias("Ref").RefMgrequip.getRefAll(),n=t.com.tm("\u6587\u672c_GM").text.split(" ")[1];try{for(var i=a(o),l=i.next();!l.done;l=i.next()){var c=l.value,p={cmd:u.StringUtil.format("add {0} 1 {1}",c.resId,n)};t.CtrlGameNet.send(new _.RequestSystemGm(p,t,function(){},function(){}))}}catch(f){e={error:f}}finally{try{l&&!l.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}}),this.registerHandler("getAllItem",function(){var e,r,o=s.Container.inst().getByAlias("Ref").RefMgritem.getRefAll();try{for(var n=a(o),i=n.next();!i.done;i=n.next()){var l=i.value,c={cmd:u.StringUtil.format("add {0} 1",l.resId)};t.CtrlGameNet.send(new _.RequestSystemGm(c,t,function(){},function(){}))}}catch(p){e={error:p}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}}),this.registerHandler("filterBuffId",function(){var e=t.com.tm("\u6587\u672c_GM").text.split(" "),r=[];if(e[1]){var o=parseInt(e[1]);o&&r.push(o)}if(e[2]){var n=parseInt(e[2]);n&&r.push(n)}if(e[3]){var i=parseInt(e[3]);i&&r.push(i)}l.EngineMain.saveLocalStorage("filterIds",JSON.stringify(r)),t.CtrlMgr.CtrlAlert.LayerMessage.addMessage("\u8fc7\u6ee4buff: "+e[1]+", "+e[2])}),this.registerHandler("clearFilterBuffId",function(){l.EngineMain.saveLocalStorage("filterIds",JSON.stringify([])),t.CtrlMgr.CtrlAlert.LayerMessage.addMessage("\u6e05\u7a7a\u8fc7\u6ee4buff")}),this.tlDesc=r},e.prototype.registerHandler=function(t,e){this.tmHandlers.set(t,e)},e.prototype.triggerHanlder=function(t){if(this.tmHandlers.has(t)){var e=this.tmHandlers.get(t);return e&&e(),!0}return!1},e.prototype.onRelease=function(){this.modelRole=null,this.modelPublicData=null,this.appCustomInfo=null,this.ctrlGM=null},e.prototype.updateView=function(){this.com.tm("list").asList.update(this.tlDesc)},e.prototype.initView=function(){var t=this;t.com.tm("list").asList.initVirtualList(t,t.renderListItem,t.onClickItem),this.modelPublicData.appCustomData.serverVersion,this.getShowVersonStr(),this.appCustomInfo,this.printWXInfo(),this.initGMData()},e.prototype.renderListItem=function(t,e,r){e.tm("\u6587\u672c_GM").text=r.gm,e.tm("\u6587\u672c_\u8bf4\u660e").text=r.desc},e.prototype.onClickItem=function(t,r,o){var n=this,i=n.com;n._selectIndex=t;var a=e.tmTempData.get(n._selectIndex);i.tm("\u6587\u672c_GM").text=a||o.gm},e.prototype.onClickOk=function(){var t=this,r=t.com.tm("\u6587\u672c_GM").text;if(r){if(e.initText=r,null!=t._selectIndex&&e.tmTempData.set(t._selectIndex,r),"serverDay"!=r){var o=r.split(" ")[0];if(!this.triggerHanlder(o)){var n={cmd:r};this.CtrlGameNet.send(new _.RequestSystemGm(n,t,function(){c.FW.showTip("\u6210\u529f\uff01")}))}}}else c.FW.showTip("\u8bf7\u8f93\u5165\u547d\u4ee4")},e.prototype.getShowVersonStr=function(){var t=this.modelPublicData.appCustomData;return t.serverVersion+","+t.versionCode+"_"},e.prototype.unload=function(){this.ctrlGM.LayerGMMain.unload()},e.prototype.printWXInfo=function(){var t="";if(l.EngineMain.isMiniGameWeiXin){var e=window.wx;if(e.getMenuButtonBoundingClientRect){console.log("wx.getMenuButtonBoundingClientRect");var r=e.getMenuButtonBoundingClientRect();console.log(r),r&&(console.log(r.width),console.log(r.height),console.log(r.top),console.log(r.right),console.log(r.bottom),console.log(r.left),t="bt:"+r.bottom)}else console.log("wx.getMenuButtonBoundingClientRect null");if(e.getWindowInfo){console.log("wx.getWindowInfo");var o=e.getWindowInfo();console.log(o),o&&(console.log(o.pixelRatio),console.log(o.screenWidth),console.log(o.screenHeight),console.log(o.windowWidth),console.log(o.windowHeight),console.log(o.statusBarHeight),console.log(o.screenTop),console.log(o.safeArea),t=(t=(t=(t=(t=t+" r:"+o.pixelRatio)+" bh:"+o.statusBarHeight)+" st:"+o.screenTop)+" top:"+o.safeArea.top)+" b:"+o.safeArea.bottom)}else console.log("wx.getWindowInfo null")}console.log(t)},e.prototype.initGMList=function(t){var e,r;if(!this._isInitGMList){this._isInitGMList=!0;try{for(var o=a(t),n=o.next();!n.done;n=o.next()){var i=n.value;this.tlDesc.push({gm:i.cmd,desc:i.desc})}}catch(l){e={error:l}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}this.updateView()}},e.__cname="TabGMCommandUI",e.tmTempData=new Map,e.initText="add",i([s.injectField("LayerBattle")],e.prototype,"layerBattle",void 0),i([s.injectField("ModelAccount")],e.prototype,"ModelAccount",void 0),i([s.injectField("SDKMgr")],e.prototype,"sDKMgr",void 0),i([s.injectField("OnOffMgr")],e.prototype,"OnOffMgr",void 0),i([s.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([s.injectField("TimeUtil")],e.prototype,"TimeUtil",void 0),i([s.injectField("ModelRole")],e.prototype,"modelRole",void 0),i([s.injectField("ModelPublicData")],e.prototype,"modelPublicData",void 0),i([s.injectField("AppCustomInfo")],e.prototype,"appCustomInfo",void 0),i([s.injectField("CtrlGM")],e.prototype,"ctrlGM",void 0),i([s.injectField("CtrlGameNet")],e.prototype,"CtrlGameNet",void 0),i([s.injectField("Net")],e.prototype,"Net",void 0),e}(g.GameTabUI);r.TabGMCommandUI=w,cc._RF.pop()},{"../../../../engine/EngineMain":void 0,"../../../../framework/FW":void 0,"../../../../framework/container/Container":void 0,"../../../../framework/utils/StringUtil":void 0,"../../../example/TestGeometry":"TestGeometry","../../../example/TestGloader":"TestGloader","../../../example/TestGobjGoods":"TestGobjGoods","../../../example/TestHttp":"TestHttp","../../../example/TestPromise":"TestPromise","../../../example/TestQuickSort":"TestQuickSort","../../../example/TestRef":"TestRef","../../../generated/requestMsg/RequestSystemMsg":"RequestSystemMsg","../../gamestate/GameStateMgr":"GameStateMgr","../../ui/GameTab":"GameTab","../battle/CtrlBattle":"CtrlBattle","../battle/debug/SubDebugCommand":"SubDebugCommand","./TabGMCacheList":"TabGMCacheList"}],TabHero:[function(t,e,r){"use strict";cc._RF.push(e,"2090ec2ARlOpo1E0EXENbTZ","TabHero");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},c=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.TabHeroUI=r.TabHero=void 0;var u,p=t("../../../../framework/FW"),f=t("../../../../framework/container/Container"),h=t("../../../../framework/layer/common/UIOrder"),y=t("../../fguiExtend/GObjRD"),d=t("../../model/System/ModelSystem"),m=t("../../model/vo/Goods/Goods"),v=t("../../model/vo/Goods/VOEquip"),_=t("../../ui/GameTab"),S=t("../alert/CtrlAlert"),g=t("./LayerItemDetail");(function(t){t[t.quality=0]="quality",t[t.level=1]="level",t[t.position=2]="position"})(u||(u={}));var b=["equip0","equip1","equip2","equip3","equip4","equip5"],C=[m.EGoodsType.weapon,m.EGoodsType.armor,m.EGoodsType.amulet,m.EGoodsType.belt,m.EGoodsType.glove,m.EGoodsType.shoe],R=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return M},e.prototype.getUrl=function(){return"ui://\u82f1\u96c4/\u7ec4\u4ef6_\u82f1\u96c4_\u4e3b\u754c\u9762"},e.prototype.getSortOrder=function(){return h.LayerOrder.OneLevel},e.prototype.getSystemId=function(){return d.SystemId.Hero},e.__cname="TabHero",e}(_.GameTabProxy);r.TabHero=R;var M=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.maxDefaultCapacity=15,e.equitList=[],e.drawingList=[],e.materialList=[],e.slotMap=new Map,e.sortFunArr=[e.QualitySort,e.LevelSort,e.PositionSort],e.sortType=u.quality,e.title1=[{title:p.FW.G_W("\u56fe\u7eb8")}],e.title2=[{title:p.FW.G_W("\u901a\u7528\u5408\u6210\u6750\u6599")}],e.bagList=[],e}return n(e,t),e.prototype.initAsync=function(){return a(this,void 0,Promise,function(){return l(this,function(t){switch(t.label){case 0:return p.FW.showLoading(),[4,p.FW.FairyMgr.loadByPkgNameAsync("\u82f1\u96c4_\u516c\u7528\u5305")];case 1:return t.sent(),[4,p.FW.FairyMgr.loadByPkgNameAsync("\u82f1\u96c4")];case 2:return t.sent(),[2]}})})},e.prototype.init=function(){var t=this,e=this.com;this.com.toFullCenterParent(this.container),e.tm("\u88c5\u8f7d\u5668_\u7167\u5c04\u7c92\u5b50").SetUrlByModel(S.particlesMap.get("\u53f3\u7167\u5c04\u91d1\u8272\u7c92\u5b50")),e.tm("\u88c5\u8f7d\u5668_\u5de6\u7c92\u5b50").SetUrlByModel(S.particlesMap.get("\u5de6\u7167\u5c04\u91d1\u8272\u7c92\u5b50")),e.tm("\u6309\u94ae_\u7b26\u6587.\u88c5\u8f7d\u5668_\u706b\u7130\u7279\u6548").SetUrlByIcon("\u7279\u6548_\u767e\u604b_\u6309\u94ae\u706b\u7130"),this.ModelMgr.ModelHero.eventCallBack.addCallback(function(){t.equipVoSubset=t.ModelMgr.ModelVO.VOEquipBag.CreateSubset();var e=t.ModelMgr.ModelGoodsBag.GetTlGoodsTypeByTlShowBag([m.ShowBagType.equipBag]);t.equipVoSubset.SetFilter(function(t){return!!e.has(t.GetGoodsType())}),t.updateView()}),this.row=5;for(var r=0;r<b.length;r++)if(!this.slotMap.has(C[r])){var o=this.com.tm(b[r]);this.slotMap.set(C[r],o)}this.InitBtn(),this.InitVoBag(),this.InitList()},e.prototype.enter=function(){this.UpdateRoleInfo(),this.updateView(),p.FW.removeLoading()},e.prototype.update=function(){this.dirty&&(this.dirty=!1,this.updateView()),this.roleDirty&&(this.roleDirty=!1,this.UpdateRoleInfo())},e.prototype.InitBtn=function(){var t=this,e=this;e.AddBtnBehavior(e.com.tm("\u6309\u94ae_\u7b26\u6587"),{systemId:d.SystemId.RuneMain,OnRdChanged:function(t){e.com.tm("\u6309\u94ae_\u7b26\u6587.\u7ea2\u70b9").OnRDUpdate(t)}}),e.AddBtnBehavior(e.com.tm("\u6309\u94ae_\u89d2\u8272"),{systemId:d.SystemId.HeroBag}),e.AddBtnBehavior(e.com.tm("\u6309\u94ae_\u5408\u6210"),{systemId:d.SystemId.EquipSynthesis,OnRdChanged:function(t){e.com.tm("\u6309\u94ae_\u5408\u6210.\u7ea2\u70b9").OnRDUpdate(t)}}),e.com.tm("\u6309\u94ae_\u6574\u7406").setClick(function(){var r=e.com.getController("\u6392\u5e8f").pageCount;t.sortType=t.sortType+1,t.sortType==r&&(t.sortType=0),e.com.setSelectedIndex("\u6392\u5e8f",t.sortType),t.updateView()},this)},e.prototype.InitList=function(){var t=this,e=function(e,r,o){var n=r.tm("item");if(o){n.visible=!0,n.UpdateByGoods(o.vo);var i=t.ModelMgr.ModelGoods.GetGoodsBagByRefId(o.vo.GetRefId());if(n.GetBehavior().onNumberVisible(i!=t.ModelMgr.ModelVO.VOEquipBag),o.vo instanceof v.VOEquip){var a=o.vo;n.GetBehavior().onLevelVisible(!0);var l=a.GetEquiType(),s=l!=v.EquipType.general&&l!=t.heroEquipType;n.grayed=s;var c=n.GetBehavior().OnGetRDComponent(),u=y.RDType.wearRedDot,p=t.ModelMgr.ModelVO.VOEquipBag.ChaeckIsOpenRed(a);c.OnRDUpdate(p,u)}}else n.visible=!1},r=function(e,r,o){if(o&&o.vo){var n=r.tm("item");t.OnclickItem(o.vo,n)}},o=this.com.tm("\u6211\u7684\u9053\u5177\u80cc\u5305"),n=function(e){var r=t.bagList[e];return!r[0]||r[0].vo?"ui://\u82f1\u96c4/\u7ec4\u4ef6_\u7269\u54c1\u884c":"ui://\u82f1\u96c4/\u7ec4\u4ef6_\u7269\u54c1\u6807\u9898"};o.initVirtualList(this,function(o,i,a){if("ui://\u82f1\u96c4/\u7ec4\u4ef6_\u7269\u54c1\u884c"==n(o)){var l=i.tm("\u9053\u5177\u884c");l.init(t,e,r),l.update(a),l.resizeToFit()}else i.tm("title").text=p.FW.G_W(a[0].title)},null,n),o.setVirtual()},e.prototype.InitVoBag=function(){var t=this,e=this.ModelMgr.ModelGoodsBag.GetTlGoodsTypeByTlShowBag([m.ShowBagType.itemBag_EquipDrawing]);this.drawingVoSubset=this.ModelMgr.ModelVO.VOItemBag.CreateSubset(),this.drawingVoSubset.SetFilter(function(t){return!!e.has(t.GetGoodsType())});var r=this.ModelMgr.ModelGoodsBag.GetTlGoodsTypeByTlShowBag([m.ShowBagType.itemBag_EquipMaterials]);this.equipMaterialVoSubset=this.ModelMgr.ModelVO.VOItemBag.CreateSubset(),this.equipMaterialVoSubset.SetFilter(function(t){return!!r.has(t.GetGoodsType())}),this.equipVoSubset=this.ModelMgr.ModelVO.VOEquipBag.CreateSubset();var o=this.ModelMgr.ModelGoodsBag.GetTlGoodsTypeByTlShowBag([m.ShowBagType.equipBag]);this.equipVoSubset.SetFilter(function(t){return!!o.has(t.GetGoodsType())}),this.roleVoSubset=this.ModelMgr.ModelVO.VORoleBag.CreateSubset(),this.roleVoSubset.SetFilter(function(){return!0}),this.toolSet.addDefer(function(){t.ModelMgr.ModelVO.VOItemBag.DestroySubset(t.equipMaterialVoSubset),t.equipMaterialVoSubset=null,t.ModelMgr.ModelVO.VOItemBag.DestroySubset(t.drawingVoSubset),t.drawingVoSubset=null,t.ModelMgr.ModelVO.VOEquipBag.DestroySubset(t.equipVoSubset),t.equipVoSubset=null,t.ModelMgr.ModelVO.VORoleBag.DestroySubset(t.roleVoSubset),t.roleVoSubset=null}),this.toolSet.addListener(this.drawingVoSubset.GetEventProxy(),"OnChanged",function(){t.markDirty()}),this.toolSet.addListener(this.equipMaterialVoSubset.GetEventProxy(),"OnChanged",function(){t.markDirty()}),this.toolSet.addListener(this.equipVoSubset.GetEventProxy(),"OnChanged",function(){t.markDirty()}),this.toolSet.addListener(this.roleVoSubset.GetEventProxy(),"OnChanged",function(){t.markRoleDirty()}),this.toolSet.addCallback(this.CtrlAttr.GetChangeCallback(),function(){t.markRoleDirty()})},e.prototype.markDirty=function(){this.dirty=!0},e.prototype.markRoleDirty=function(){this.roleDirty=!0},e.prototype.QualitySort=function(t,e){var r=t.GetQuality(),o=e.GetQuality();return r!=o?o-r:(r=t.GetPhase())!=(o=e.GetPhase())?o-r:(r=t.GetLevel())!=(o=e.GetLevel())?o-r:(r=t.GetGoodsType())!=(o=e.GetGoodsType())?r-o:-1},e.prototype.LevelSort=function(t,e){var r=t.GetLevel(),o=e.GetLevel();return r!=o?o-r:(r=t.GetQuality())!=(o=e.GetQuality())?o-r:(r=t.GetGoodsType())!=(o=e.GetGoodsType())?r-o:-1},e.prototype.PositionSort=function(t,e){var r=t.GetGoodsType(),o=e.GetGoodsType();return r!=o?r-o:(r=t.GetQuality())!=(o=e.GetQuality())?o-r:(r=t.GetLevel())!=(o=e.GetLevel())?o-r:-1},e.prototype.updateListData=function(){var t,e,r,o,n,i,a=this,l=this.drawingVoSubset.GetTlVO(),c=this.equipMaterialVoSubset.GetTlVO(),u=this.equipVoSubset.GetTlVO();this.equitList=[],this.drawingList=[],this.materialList=[];try{for(var p=s(u),f=p.next();!f.done;f=p.next())(d=f.value).GetIsPutOn()||this.equitList.push({vo:d})}catch(R){t={error:R}}finally{try{f&&!f.done&&(e=p.return)&&e.call(p)}finally{if(t)throw t.error}}try{for(var h=s(l),y=h.next();!y.done;y=h.next()){var d=y.value;this.drawingList.push({vo:d})}}catch(M){r={error:M}}finally{try{y&&!y.done&&(o=h.return)&&o.call(h)}finally{if(r)throw r.error}}try{for(var m=s(c),_=m.next();!_.done;_=m.next())d=_.value,this.materialList.push({vo:d})}catch(w){n={error:w}}finally{try{_&&!_.done&&(i=m.return)&&i.call(m)}finally{if(n)throw n.error}}var S,g,b=function(t,e,r){for(var o=Math.ceil(e.length/r),n=0;n<o;n++){var i=e.slice(n*r,(n+1)*r);t.push(i)}},C=function(t){for(var e=t.length,r=a.maxDefaultCapacity,o=a.row,n=e<r?r-e:o-(e%o||o);n--;)t.push(null)};this.bagList.length=0,S=this.equitList,g=this.sortType,S.sort(function(t,e){return a.sortFunArr[g](t.vo,e.vo)}),this.equitList.sort(function(t,e){var r=t.vo,o=e.vo,n=r.GetEquiType(),i=o.GetEquiType();return n!=v.EquipType.general&&n!=a.heroEquipType?1:i!=v.EquipType.general&&i!=a.heroEquipType?-1:0}),C(this.materialList),C(this.equitList),C(this.drawingList),b(this.bagList,this.equitList,this.row),this.bagList.push(this.title1),b(this.bagList,this.drawingList,this.row),this.bagList.push(this.title2),b(this.bagList,this.materialList,this.row)},e.prototype.OnclickItem=function(t,e){var r=this;if(t instanceof v.VOEquip&&(t.GetEquiType()==v.EquipType.general||t.GetEquiType()==this.heroEquipType)){var o=t;this.CtrlMain.LayerItemDetail.load(),this.CtrlMain.LayerItemDetail.SetEquip(o),this.CtrlMain.LayerItemDetail.SetOpenPosition(g.OpenPosition.Bag),this.CtrlMain.LayerItemDetail.SetOnclickBtn1(function(){r.ModelMgr.ModelEquip.RequestEquipPutOn(o.GetId())})}else{var n=t;e.GetBehavior().showTips(n,this.parent.proxy)}},e.prototype.updateView=function(){var t=(this.roleVoSubset||this.ModelMgr.ModelVO.VORoleBag.CreateSubset()).GetOneVO().GetHeroId(),e=this.ModelMgr.ModelHero.GetHeroRef(t);this.heroEquipType=e.equipType,this.updateListData(),this.com.tm("\u6211\u7684\u9053\u5177\u80cc\u5305").update(this.bagList)},e.prototype.UpdateRoleInfo=function(){var t=this,e=t.com,r=this.ModelMgr.ModelRole.GetRole().GetHeroId();if(null!=r){var o=this.ModelMgr.ModelVO.VOHeroBag.Get(r).GetHeroRef();e.tm("\u6309\u94ae_\u89d2\u8272.icon").SetUrlByModel(o.bodyModel);var n=t.ModelMgr.ModelGameConfig.GetGameConfigValueByKey("showHeroScale");e.tm("\u6309\u94ae_\u89d2\u8272.icon").GetPromise().then(function(){e.tm("\u6309\u94ae_\u89d2\u8272.icon").GetNode().setScale(n,n)}),e.tm("\u7ec4\u4ef6_\u653b\u51fb.\u6587\u672c_\u57fa\u7840\u503c").text=String(Math.round(this.CtrlAttr.GetAttrByKey("atk").GetValue())),e.tm("\u7ec4\u4ef6_\u751f\u547d.\u6587\u672c_\u57fa\u7840\u503c").text=String(Math.round(this.CtrlAttr.GetAttrByKey("hp").GetValue())),t.UpdateWearEquipList()}},e.prototype.UpdateWearEquipList=function(){var t,e,r=this,o=this.ModelEquip.GetWearData(),n=function(t,e){var n=e.tm("item");if(o.has(t)){var a=o.get(t),l=i.slotMap.get(t),s=l.tm("item");s.visible=!0,s.UpdateByGoods(a);var c=s.GetBehavior();c.onNumberVisible(!1),c.onLevelVisible(!0);var u=s.GetBehavior().OnGetRDComponent(),p=y.RDType.upgradeRedDot,f=i.ModelMgr.ModelVO.VOEquipBag.ChaeckIsOpenRed(a);u.OnRDUpdate(f,p),l.setClick(function(){r.CtrlMain.LayerItemDetail.load(),r.CtrlMain.LayerItemDetail.SetEquip(a),r.CtrlMain.LayerItemDetail.SetOpenPosition(g.OpenPosition.equipSlot),r.CtrlMain.LayerItemDetail.SetOnclickBtn1(function(){r.ModelMgr.ModelEquip.RequestEquipTakeOff(a.GetId()),s.UpdateByGoods(null),s.visible=!1,l.clearClick()})},i)}else n.UpdateByGoods(null),n.visible=!1,e.clearClick()},i=this;try{for(var a=s(this.slotMap),l=a.next();!l.done;l=a.next()){var u=c(l.value,2);n(u[0],u[1])}}catch(p){t={error:p}}finally{try{l&&!l.done&&(e=a.return)&&e.call(a)}finally{if(t)throw t.error}}},e.prototype.GetListItem=function(){for(var t=this,e=t.com.tm("\u6211\u7684\u9053\u5177\u80cc\u5305").asList,r=-1,o=0;o<t.equitList.length;o++){var n=t.equitList[o];if(n){var i=n.vo.GetEquiType();if(i==v.EquipType.general||i==this.heroEquipType){r=o;break}}}if(-1==r)return null;var a=e.itemIndexToChildIndex(r);return e.getChildAt(a).asCom.tm("\u9053\u5177\u884c").asList.getChildAt(r)},e.prototype.ClickListItem=function(t){var e=this.com.tm("\u6211\u7684\u9053\u5177\u80cc\u5305").asList.getChildAt(t).asCom.tm("\u9053\u5177\u884c").asList,r=e.getChildAt(t);e.onClickItemWrap(r)},e.__cname="TabHeroUI",i([f.injectField("CtrlMain")],e.prototype,"CtrlMain",void 0),i([f.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([f.injectField("ModelEquip")],e.prototype,"ModelEquip",void 0),i([f.injectField("CtrlAttr")],e.prototype,"CtrlAttr",void 0),i([f.injectField("CtrlAlert")],e.prototype,"CtrlAlert",void 0),e}(_.GameTabUI);r.TabHeroUI=M,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/container/Container":void 0,"../../../../framework/layer/common/UIOrder":void 0,"../../fguiExtend/GObjRD":"GObjRD","../../model/System/ModelSystem":"ModelSystem","../../model/vo/Goods/Goods":"Goods","../../model/vo/Goods/VOEquip":"VOEquip","../../ui/GameTab":"GameTab","../alert/CtrlAlert":"CtrlAlert","./LayerItemDetail":"LayerItemDetail"}],TabMall:[function(t,e,r){"use strict";cc._RF.push(e,"e644cRNp7dAJ6fvsrm2kyiS","TabMall");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.TabMallUI=r.TabMall=r.ShopBuyType=r.DrawState=r.DrawCount=void 0;var s=t("../../../../../framework/FW"),c=t("../../../../../framework/container/Container"),u=t("../../../model/System/ModelSystem"),p=t("../../../model/mall/ModelMall"),f=t("../../../ui/GameTab"),h=t("./MallModuleChapterGift"),y=t("./MallModuleDailyShop"),d=t("./MallModuleGloden"),m=t("./MallModuleLuckDraw"),v=t("./MallModuleRecharge"),_=t("./MallModuleSEquip");(function(t){t[t.single=1]="single",t[t.ten=10]="ten"})(r.DrawCount||(r.DrawCount={})),function(t){t[t.prop=1]="prop",t[t.Gem=2]="Gem",t[t.free=3]="free"}(r.DrawState||(r.DrawState={})),function(t){t[t.free=0]="free",t[t.buy=1]="buy"}(r.ShopBuyType||(r.ShopBuyType={}));var S=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return g},e.prototype.getUrl=function(){return"ui://\u9996\u9875_\u5546\u57ce/\u7ec4\u4ef6_\u5546\u57ce_\u4e3b\u754c\u9762"},e.prototype.getShowLoad=function(){return!0},e.prototype.getSystemId=function(){return u.SystemId.Mall},e.prototype.SetPageData=function(t){var e=this.ModelMgr.ModelMall.GetModuleIdByKey(t);this.ui.JumpByIndex(e-1)},e.prototype.GetPageData=function(){return this.pageData},e.prototype.GetModuleAndJump=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];if(this.ui)return this.ui.GetModuleAndJump(t,e);s.FW.LWX.log("\u754c\u9762\u8fd8\u6ca1\u6709\u6253\u5f00")},e.__cname="TabMall",e}(f.GameTabProxy);r.TabMall=S;var g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.moduleList=[],e.openModuleMap=new Map,e}return n(e,t),e.prototype.CreateSub=function(t,e){var r=new e;return c.Container.inst().inject(r),r.SetParentProxy(this.parent.proxy),r.Init(t),this.moduleList[t]=r,r},e.prototype.initAsync=function(){return a(this,void 0,void 0,function(){return l(this,function(){return s.FW.showLoading(),[2]})})},e.prototype.init=function(){this.com.toFullCenterParent(this.container),this.CreateSub(p.MallModule.ChapterGift,h.MallModuleChapterGift),this.CreateSub(p.MallModule.DailyShop,y.MallModuleDailyShop),this.CreateSub(p.MallModule.LimitLuckDraw,_.MallModuleSEquip),this.CreateSub(p.MallModule.SEquip,_.MallModuleSEquip),this.CreateSub(p.MallModule.LuckDraw,m.MallModuleLuckDraw),this.CreateSub(p.MallModule.Recharge,v.MallModuleRecharge),this.CreateSub(p.MallModule.Gloden,d.MallModuleGloden),this.toolSet.addListener(this.ModelMgr.ModelMall.GetEventModuleOpenProxy(),"OnModuleOpen",this.OpenModuleById,this),this.toolSet.addListener(this.ModelMgr.ModelMall.GetEventModuleCloseProxy(),"OnModuleClose",this.CloseModuleById,this),this.isListen=!1},e.prototype.enterAsync=function(){return a(this,void 0,Promise,function(){return l(this,function(t){switch(t.label){case 0:return[4,this.ModelMgr.ModelMall.RequestMallGetData()];case 1:return t.sent(),this.ModelMgr.ModelMall.GetMallModuleData(),this.UpdateLayer(),s.FW.removeLoading(),[2,null]}})})},e.prototype.UpdateLayer=function(){var t=this,e=this.com.tm("\u5217\u8868_\u5546\u5e97\u7c7b\u578b");this.openModuleMap=this.ModelMgr.ModelMall.GetOpenModuleMap(),this.moduleList.forEach(function(r,o){s.FW.LWX.log("id:"+o);var n=t.ModelMgr.ModelMall.GetModuleDataById(o);e.addChildAt(r.com,n.sort),e.getChildAt(o-1).name=r.GetUrl()+o,t.openModuleMap.has(o)?t.OpenModuleById(o):t.CloseModuleById(o)})},e.prototype.exitAsync=function(){return this.moduleList.forEach(function(t){t.Exit()}),null},e.prototype.onDestroy=function(){this.moduleList.forEach(function(t){t.OnDestroy()})},e.prototype.CloseModuleById=function(t){var e=this.com.tm("\u5217\u8868_\u5546\u5e97\u7c7b\u578b").getChildByPath(this.moduleList[t].GetUrl()+t);e?(s.FW.LWX.log("\u5173\u95ed\u6a21\u5757:"+t),e.visible=!1,this.moduleList[t].Exit()):s.FW.LWX.log("ui\u8fd8\u6ca1\u52a0\u8f7d")},e.prototype.OpenModuleById=function(t){var e=this.com.tm("\u5217\u8868_\u5546\u5e97\u7c7b\u578b").getChildByPath(this.moduleList[t].GetUrl()+t);e?(e.visible=!0,this.moduleList[t].Enter()):s.FW.LWX.log("ui\u8fd8\u6ca1\u52a0\u8f7d")},e.prototype.ChangeModuleStateById=function(t,e){this.com.tm("\u5217\u8868_\u5546\u5e97\u7c7b\u578b").getChildByPath(this.moduleList[t].GetUrl()+t).visible=e},e.prototype.JumpByIndex=function(t){if(t>this.moduleList.length)s.FW.LWX.error("\u5546\u57ce\u7d22\u5f15\u8d8a\u754c: "+t);else if(this.openModuleMap.has(t+1)){var e=this.com.tm("\u5217\u8868_\u5546\u5e97\u7c7b\u578b"),r=e.getChildAt(t),o=e.scrollPane;o.posX=r.x,o.posY=r.y}else s.FW.LWX.error("\u529f\u80fd\u672a\u5f00\u542f: "+t)},e.prototype.GetModuleAndJump=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var o=this;o.JumpByIndex(t-1);var n=o.moduleList[t];return n.GetChild(e)},e.__cname="TabMallUI",i([c.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([c.injectField("CtrlMgr")],e.prototype,"CtrlMgr",void 0),e}(f.GameTabUI);r.TabMallUI=g,cc._RF.pop()},{"../../../../../framework/FW":void 0,"../../../../../framework/container/Container":void 0,"../../../model/System/ModelSystem":"ModelSystem","../../../model/mall/ModelMall":"ModelMall","../../../ui/GameTab":"GameTab","./MallModuleChapterGift":"MallModuleChapterGift","./MallModuleDailyShop":"MallModuleDailyShop","./MallModuleGloden":"MallModuleGloden","./MallModuleLuckDraw":"MallModuleLuckDraw","./MallModuleRecharge":"MallModuleRecharge","./MallModuleSEquip":"MallModuleSEquip"}],TabWeekTask:[function(t,e,r){"use strict";cc._RF.push(e,"6c29aUD9kpFDb1S7yNoFcco","TabWeekTask");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.TabWeekTaskUI=r.TabWeekTask=void 0;var l=t("../../../../../../framework/container/Container"),s=t("../../../../../../framework/layer/common/UIOrder"),c=t("../../../../../generated/netProto/CmdInterface"),u=t("../../../../model/System/ModelSystem"),p=t("../../../../ui/GameTab"),f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUrl=function(){return"ui://\u9996\u9875_\u4fee\u70bc_\u4efb\u52a1\u7cfb\u7edf/\u7ec4\u4ef6_\u4efb\u52a1_\u5468\u5e38"},e.prototype.getUIClass=function(){return h},e.prototype.getSortOrder=function(){return s.LayerOrder.TowLevel},e.prototype.getSystemId=function(){return u.SystemId.WeekTask},e.__cname="TabWeekTask",e}(p.GameTabProxy);r.TabWeekTask=f;var h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.init=function(){var t=this;t.com.toFullCenterParent(t.container),t.InitList(),t.toolSet.addTimer(1e3,function(){t.updateTime()})},e.prototype.enter=function(){this.updateView(),this.ModelMgr.ModelTask.GetEventProxy().addListener("weekTaskChange",this,this.updateView)},e.prototype.exit=function(){this.ModelMgr.ModelTask.GetEventProxy().removeListener("weekTaskChange",this,this.updateView)},e.prototype.InitList=function(){var t=this,e=this;e.com.tm("list").asList.initVirtualList(e,function(r,o,n){var i=o.asCom,a=t.ModelMgr.ModelTask.GetRefWeekTask(n.resId),l=i.tm("\u8fdb\u5ea6\u6761_\u4efb\u52a1\u8fdb\u5ea6").asProgress,s=a.param.count||a.param.level;s||(s=a.param.talent),l.max=s;var u,p=n.count;u=p>s?s:p,l.value=u,i.tm("\u6587\u672c_\u6807\u9898").text=a.name;var f=a.reward,h=e.ModelMgr.ModelTask.GetRefTaskReward(f).reward,y=e.ModelMgr.ModelGoods.CreateGoods(h[0].resId);y.SetNumber(h[0].number),i.tm("com_goods").UpdateByGoods(y);var d=n.rewardState;i.setSelectedIndex("\u5b8c\u6210\u72b6\u6001",d),2!=d&&i.tm("\u6309\u94ae_\u524d\u5f80").setClick(function(){if(0==d){var r=a.gotoKey;e.CtrlMgr.JumpLayer(r)&&t.parent.proxy.unload()}else 1==d&&e.ModelMgr.ModelTask.RequestTaskReward(a.resId,c.CmdTaskType.WEEKLY_TASK)},i)})},e.prototype.updateView=function(){var t=this;t.updateHuoYue(),t.updateList(),t.updateTime()},e.prototype.updateHuoYue=function(){var t,e,r=this,o=r.com,n=[],i=r.ModelMgr.ModelTask.GetTlRefActiveTask(1),l=r.ModelMgr.ModelRole.GetRole(),s=function(t){var e,o,i=t.reward,s=r.ModelMgr.ModelTask.GetRefTaskReward(i),c=[];try{for(var u=(e=void 0,a(s.reward)),p=u.next();!p.done;p=u.next()){var f=p.value;c.push({resId:f.resId,number:f.number})}}catch(h){e={error:h}}finally{try{p&&!p.done&&(o=u.return)&&o.call(u)}finally{if(e)throw e.error}}n.push({checkListen:function(){return t.process>l.GetWeeklyActive()||l.GetWeeklyActiveTake()>=t.process},rewardList:c,getRewardListen:function(){r.ModelMgr.ModelTask.RequestTakeActiveReward(1)},name:t.process.toString()})};try{for(var c=a(i),u=c.next();!u.done;u=c.next())s(u.value)}catch(f){t={error:f}}finally{try{u&&!u.done&&(e=c.return)&&e.call(c)}finally{if(t)throw t.error}}var p=o.tm("\u7ec4\u4ef6_\u8fdb\u5ea6\u6846");p.Init(n,r.parent.proxy),p.SetFilter(function(t){return i[t].process>l.GetWeeklyActive()?0:l.GetWeeklyActiveTake()>=i[t].process?2:1}),p.updateProgress(l.GetWeeklyActive(),i[i.length-1].process)},e.prototype.updateList=function(){var t=this.ModelMgr.ModelTask.GetTlWeekTask();t.sort(function(t,e){var r=t.resId,o=e.resId;return r+=t.rewardState%2==1?1e3:1e3*-t.rewardState,(o+=e.rewardState%2==1?1e3:1e3*-e.rewardState)-r}),this.com.tm("list").asList.update(t)},e.prototype.updateTime=function(){var t=this.com,e=this.TimeUtil.timeSec2HMSStr11(!0);t.tm("\u6587\u672c_\u5012\u8ba1\u65f6").asTextField.setVar("time",e).flushVars()},e.__cname="TabWeekTaskUI",i([l.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([l.injectField("TimeUtil")],e.prototype,"TimeUtil",void 0),e}(p.GameTabUI);r.TabWeekTaskUI=h,cc._RF.pop()},{"../../../../../../framework/container/Container":void 0,"../../../../../../framework/layer/common/UIOrder":void 0,"../../../../../generated/netProto/CmdInterface":"CmdInterface","../../../../model/System/ModelSystem":"ModelSystem","../../../../ui/GameTab":"GameTab"}],TabXiulian:[function(t,e,r){"use strict";cc._RF.push(e,"c29aaSvu+ZORIsfTPHAnKku","TabXiulian");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.TabXiulianUI=r.TabXiulian=r.hartArray=void 0;var s=t("../../../../../framework/container/Container"),c=t("../../../../../framework/FW"),u=t("../../../../../framework/layer/PopLayerMgr"),p=t("../../../../generated/netProto/CmdInterface"),f=t("../../../fguiExtend/GObjRD"),h=t("../../../model/expr/ModelExpr"),y=t("../../../model/guide/ModelGuide"),d=t("../../../model/public/AppCustomData"),m=t("../../../model/System/ModelSystem"),v=t("../../../ui/GameTab"),_=t("../../alert/CtrlAlert"),S=t("./Entrance/GObjEntrance");r.hartArray=[null,"\u56fe\u6807_\u56f0\u96be\u80cc\u666f","\u56fe\u6807_\u5730\u72f1\u80cc\u666f"];var g=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return b},e.prototype.getUrl=function(){return"ui://\u9996\u9875_\u4fee\u70bc/\u7ec4\u4ef6_\u4fee\u70bc_\u4e3b\u754c\u9762"},e.__cname="TabXiulian",e}(v.GameTabProxy);r.TabXiulian=g;var b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isExit=!1,e.oneDayTime=864e5,e.onClickBegin=!1,e}return n(e,t),e.prototype.initAsync=function(){return a(this,void 0,void 0,function(){return l(this,function(t){switch(t.label){case 0:return c.FW.showLoading(),[4,c.FW.FairyMgr.loadByPkgNameAsyncRef("\u6302\u673a\u5b9d\u7bb1\u5c55\u793a",this)];case 1:return t.sent(),[4,c.FW.FairyMgr.loadByPkgNameAsyncRef("\u9996\u9875_\u4fee\u70bc",this)];case 2:return t.sent(),[4,c.FW.FairyMgr.loadByPkgNameAsyncRef("\u516c\u7528\u7279\u6548\u7d20\u67501",this)];case 3:return t.sent(),[4,this.Ref.RefMgricon.preloadRef()];case 4:return t.sent(),c.FW.removeLoading(),[2]}})})},e.prototype.init=function(){var t=this,e=this;e.com.toFullCenterParent(e.container);var r=e.com;if(r.tm("effect").SetUrlByModel("\u767e\u604b_\u7279\u6548_\u4fee\u70bc\u6a31\u82b1"),r.tm("\u88c5\u8f7d\u5668_\u53f3\u6269\u6563").SetUrlByModel(_.particlesMap.get("\u53f3\u6269\u6563\u91d1\u8272\u7c92\u5b50")),r.tm("\u88c5\u8f7d\u5668_\u5de6\u6269\u6563").SetUrlByModel(_.particlesMap.get("\u5de6\u6269\u6563\u91d1\u8272\u7c92\u5b50")),this.InitBtn(),this.InitAnimation(),this.updateTab(),e.toolSet.addListener(e.ModelMgr.ModelChapter.GetEventProxy(),"selectResIdChange",function(){e.updateTab()}),e.toolSet.addListener(e.ModelMgr.ModelVO.VORoleBag.GetEventProxy(),"OnChanged",function(){var r=e.ModelMgr.ModelVO.VORoleBag.GetOne();null!=e.selectHeroId&&e.selectHeroId==r.GetHeroId()||t.updateHeroModel(r.GetHeroId())}),this.toolSet.addTimer(1e3,function(){var e=t.ModelMgr.ModelRole.GetRole();if(null!=e){var r=e.GetHangTime(),o=1e3*t.TimeUtil.now(),n=Math.max(o-r,1e3);n=Math.min(o-r,t.oneDayTime);var i=t.TimeUtil.timeSec2HMSStr10(.001*n);t.com.tm("\u6587\u672c_\u4fee\u70bc\u65f6\u957f").asTextField.setVar("time",i).flushVars(),t.com.setSelectedPage("\u662f\u5426\u589e\u52a0\u63d0\u793a",n>=18e6?"\u662f":"\u5426")}},this),this.CtrlMgr.CtrlGuide.CheckAndStartClientTriggerSection(y.GuideKey.FirstEnterGame),0==d.AppCustomData.instance.audit){var o=this.ModelMgr.ModelVO.VOSpecialGiftBag.GetOne(),n=1e3*this.TimeUtil.now();o&&n<o.GetEndTime()&&u.PopLayerMgr.inst().AddLayer(this,this.CtrlMain.LayerSpecialGift)}},e.prototype.enter=function(){this.isExit=!1;var t=this.ModelMgr.ModelVO.VORoleBag.GetOne();this.updateHeroModel(t.GetHeroId())},e.prototype.exit=function(){this.audioTimer&&(this.toolSet.removeDelay(this.audioTimer),this.audioTimer=null),this.transTimer&&(this.toolSet.removeTimer(this.transTimer),this.transTimer=null),this.isExit=!0},e.prototype.release=function(){},e.prototype.update=function(){var t=this;this.CtrlMain.ShowAbandon&&(this.LayerShowTip.SetData({title:c.FW.G_W("\u6218\u6597"),context:c.FW.G_W("\u5b9d~\u662f\u5426\u7ee7\u7eed\u521a\u624d\u7684\u6218\u6597\u5462\uff0c\u52a0\u6cb9\uff0c\u79bb\u6700\u540e\u7684\u80dc\u5229\u53ea\u5dee\u4e00\u6b65\u4e86"),sumitFuncion:function(){return a(t,void 0,void 0,function(){var t;return l(this,function(e){switch(e.label){case 0:return[4,this.ModelMgr.ModelFuben.RequestFubenEnter()];case 1:return t=e.sent(),this.ModelMgr.ModelChapter.SetSelectResId(t.resId),this.CtrlBattle.StartByNet(t),this.CtrlMain.ShowAbandon=!1,[2]}})})},celFunction:function(){return a(t,void 0,void 0,function(){return l(this,function(t){switch(t.label){case 0:return[4,this.ModelMgr.ModelFuben.RequestAbandonBattle()];case 1:return t.sent(),this.CtrlMain.ShowAbandon=!1,[2]}})})}}),this.LayerShowTip.load(),this.CtrlMain.ShowAbandon=!1)},e.prototype.InitBtn=function(){var t=this,e=this,r=e.com;r.tm("\u6309\u94ae_\u53d6\u6d88\u6269\u5c55").setClick(function(){r.getTransition("\u52a8\u6548_\u8bbe\u7f6e\u6269\u5c55_\u51fa\u73b0").playReverse(function(){r.setSelectedPage("\u663e\u793a\u8bbe\u7f6e\u83dc\u5355","\u5426")}),r.tm("\u7ec4\u4ef6_\u6d3b\u52a8\u4e2d\u5fc3").asCom.getTransition("\u8fdb\u5165").playReverse(function(){r.setSelectedPage("\u663e\u793a\u6d3b\u52a8\u83dc\u5355","\u5426")})},this),this.toolSet.AddScriptListener(h.RDExprType.RDXiulianMail,function(e){t.log("\u90ae\u4ef6rd\uff1a",e),r.tm("\u6309\u94ae_\u8bbe\u7f6e.\u7ea2\u70b9").OnRDUpdate(e)},this),r.tm("\u6309\u94ae_\u8bbe\u7f6e").setClick(function(){r.setSelectedPage("\u663e\u793a\u8bbe\u7f6e\u83dc\u5355","\u662f"),r.getTransition("\u52a8\u6548_\u8bbe\u7f6e\u6269\u5c55_\u51fa\u73b0").play()},this),this.AddBtnBehavior(r.tm("\u7ec4\u4ef6_\u8bbe\u7f6e\u83dc\u5355.\u6309\u94ae_\u90ae\u4ef6"),{systemId:m.SystemId.Mail,OnVisibleChanged:function(t,e){t.visible=e},OnRdChanged:function(t){console.log("LayerMail RD:",t),r.tm("\u7ec4\u4ef6_\u8bbe\u7f6e\u83dc\u5355.\u6309\u94ae_\u90ae\u4ef6.\u7ea2\u70b9").OnRDUpdate(t,f.RDType.ordinaryRedDots)}}),r.tm("\u7ec4\u4ef6_\u8bbe\u7f6e\u83dc\u5355.\u6309\u94ae_\u6269\u5c55\u8bbe\u7f6e").setClick(function(){t.LayerSetting.load()},this),this.setFairyBtnEvent(r.tm("\u7ec4\u4ef6_\u8bbe\u7f6e\u83dc\u5355.\u6309\u94ae_\u516c\u544a"),function(){return a(t,void 0,void 0,function(){return l(this,function(t){switch(t.label){case 0:return[4,this.CtrlNotice.RequestNoticeData()];case 1:return t.sent().json.list.length?this.LayerNotice.load():(this.LayerShowTip.SetData({context:c.FW.G_W("\u5730\u5e9c\u53d1\u6765\u7684\u516c\u544a\u4e22\u5931\u4e86~")}),this.LayerShowTip.load()),[2]}})})}),r.tm("\u7ec4\u4ef6_\u6309\u94ae\u7ec4\u5de6").Init(S.BelondType.left,this),r.tm("\u7ec4\u4ef6_\u6309\u94ae\u7ec4\u53f3").Init(S.BelondType.right,this),r.tm("\u7ec4\u4ef6_\u6d3b\u52a8\u4e2d\u5fc3").Init(S.BelondType.activity,this),r.tm("\u6309\u94ae_\u5173\u5361").setClick(function(){t.LayerChapterSelect.load()},this),this.AddBtnBehavior(r.tm("\u7ec4\u4ef6_\u5173\u5361\u5956\u52b1\u5b9d\u7bb1.\u6309\u94ae_\u5173\u5361\u5956\u52b1\u5b9d\u7bb1"),{systemId:m.SystemId.ChapterReward,clickCb:function(){var t=r.tm("\u7ec4\u4ef6_\u5173\u5361\u5956\u52b1\u5b9d\u7bb1").asCom.getTransition("\u52a8\u6548_\u5956\u52b1\u5b9d\u7bb1_\u6253\u5f00");t.play(),c.FW.Task.delay(t.getTransitionTime()).then(function(){var t=e.ModelMgr.ModelChapter.GetRewardChapterResId();e.LayerChapterSelect.SetChooseChapterResId(t),e.LayerChapterSelect.load(),e.LayerChapterReward.SetChooseChapterResId(t),e.LayerChapterReward.load()})},OnVisibleChanged:function(e,r){var o=t.com;e.visible=r,r&&o.tm("\u7ec4\u4ef6_\u5173\u5361\u5956\u52b1\u5b9d\u7bb1").asCom.tmt("\u52a8\u6548_\u5956\u52b1\u5b9d\u7bb1_\u51fa\u73b0").play()},OnRdChanged:function(t){r.tm("\u7ec4\u4ef6_\u5173\u5361\u5956\u52b1\u5b9d\u7bb1.\u6309\u94ae_\u5173\u5361\u5956\u52b1\u5b9d\u7bb1.\u7ea2\u70b9").OnRDUpdate(t,f.RDType.numberRedDot)}}),r.tm("\u6309\u94ae_\u5b9d\u7bb1.effect").SetUrlByIcon("\u6309\u94ae\u7279\u6548"),this.AddBtnBehavior(r.tm("\u6309\u94ae_\u5b9d\u7bb1"),{systemId:m.SystemId.XiuLianOnHook,OnVisibleChanged:function(t,e){t.visible=e,r.tm("\u6587\u672c_\u4fee\u70bc\u65f6\u957f").visible=e,r.tm("\u6302\u673a\u52a8\u753b").visible=e},OnRdChanged:function(t){r.tm("\u6309\u94ae_\u5b9d\u7bb1.\u7ea2\u70b9").OnRDUpdate(t)}}),r.tm("\u6309\u94ae_\u7a81\u7834.effect").SetUrlByIcon("\u7279\u6548_\u767e\u604b_\u7a81\u7834\u7279\u6548"),this.AddBtnBehavior(r.tm("\u6309\u94ae_\u7a81\u7834"),{systemId:m.SystemId.Breach,OnVisibleChanged:function(t,e){t.visible=e},OnRdChanged:function(t){r.tm("\u6309\u94ae_\u7a81\u7834.\u7ea2\u70b9").OnRDUpdate(t)}});var o=this.ModelMgr.ModelFuben;this.setFairyBtnEvent(r.tm("\u6309\u94ae_\u5f00\u59cb\u4fee\u70bc"),function(){return a(t,void 0,void 0,function(){var t,e,n,i,a,s=this;return l(this,function(l){switch(l.label){case 0:return this.onClickBegin?[2]:(t=this.ModelMgr.ModelGameConfig.GetGameConfigValueByKey("normalChapter"),o.SetData({gobjTarget:r.tm("\u6309\u94ae_\u5f00\u59cb\u4fee\u70bc"),HostCom:this.container,ConsumeEnd:t}),this.updateTab(),e=this.ModelMgr.ModelChapter.GetSelectResId(),[4,o.RequestFuben(e,p.CmdFuBenType.CHAPTER)]);case 1:return l.sent()?(this.onClickBegin=!0,n=!1,o.BeforRequestFubenEnter().then(function(){n=!0}).catch(function(t){c.FW.ZJJ.warn(t),n=!0}),[4,c.FW.Task.waitUntil(function(){return 1==n})]):[2];case 2:return l.sent(),[4,o.RequestFubenEnter()];case 3:return i=l.sent(),a={ret:i,leftCb:function(){i.bossSavePoint=!1,i.cmdBattleBeat.args=[],i.cmdBattleBeat.extend="",i.cmdBattleBeat.roles=[],s.CtrlBattle.StartByNet(i),s.onClickBegin=!1},rightCb:function(){var t,e,r=null===(e=null===(t=i.cmdBattleBeat)||void 0===t?void 0:t.args)||void 0===e?void 0:e.find(function(t){return"gold"==t.key});(null==r?void 0:r.value)&&(r.value=0),s.CtrlBattle.StartByNet(i,!0),s.onClickBegin=!1}},i.bossSavePoint?this.LayerBossNodeReconnect.load(a):(this.CtrlBattle.StartByNet(i),this.toolSet.addDelay(500,function(){s.onClickBegin=!1})),[2]}})})})},e.prototype.InitAnimation=function(){var t=this.com,e=t.tm("\u6302\u673a\u52a8\u753b").asCom.getTransition("\u52a8\u6548_\u653b\u51fb");t.tm("\u6302\u673a\u52a8\u753b.\u88c5\u8f7d\u5668_\u53d7\u51fb\u7279\u6548").SetUrlByModel("\u767e\u604b_\u6218\u6597\u573a\u666f\u7279\u6548_\u53d7\u51fb"),e.setHook("\u53d7\u51fb",function(){var e=t.tm("\u6302\u673a\u52a8\u753b.\u88c5\u8f7d\u5668_\u53d7\u51fb\u7279\u6548").GetNode();e&&e.getComponentInChildren(cc.Animation).play()}),e.setHook("\u653b\u51fb",function(){var e=t.tm("\u6302\u673a\u52a8\u753b.\u88c5\u8f7d\u5668_\u82f1\u96c4\u653b\u51fb").GetNode();e&&e.getComponentInChildren(cc.Animation).play()}),e.setHook("\u5f85\u673a",function(){var e=t.tm("\u6302\u673a\u52a8\u753b.\u88c5\u8f7d\u5668_\u82f1\u96c4\u5f85\u673a").GetNode();e&&e.getComponentInChildren(cc.Animation).play()}),e.setHook("\u602a\u7269\u884c\u8d70",function(){var e=t.tm("\u6302\u673a\u52a8\u753b.\u88c5\u8f7d\u5668_\u602a\u7269\u884c\u8d70").GetNode();if(e){var r=e.getComponentInChildren(cc.Animation),o=r.getClips()[1];r.play(o.name),r.play()}}),e.setHook("\u602a\u7269\u6b7b\u4ea1",function(){var e=t.tm("\u6302\u673a\u52a8\u753b.\u88c5\u8f7d\u5668_\u602a\u7269\u6b7b\u4ea1").GetNode();if(e){var r=e.getComponentInChildren(cc.Animation),o=r.getClips()[2];r.play(o.name)}}),t.tm("\u6302\u673a\u52a8\u753b").asCom.getTransition("\u52a8\u6548_\u51fa\u573a").setHook("\u51fa\u573a",function(){var e=t.tm("\u6302\u673a\u52a8\u753b.\u88c5\u8f7d\u5668_\u82f1\u96c4\u51fa\u573a").GetNode();e&&e.getComponentInChildren(cc.Animation).play()})},e.prototype.playAnimation=function(){var t=this.com.tm("\u6302\u673a\u52a8\u753b").asCom.getTransition("\u52a8\u6548_\u653b\u51fb");t.playing||this.isExit||t.play()},e.prototype.updateHeroModel=function(t){var e=this,r=this.com,o=this.ModelMgr.ModelVO.VOHeroBag.Get(t);if(null!=o){var n=o.GetHeroAnimationRef(),i=[];r.tm("\u6302\u673a\u52a8\u753b.\u88c5\u8f7d\u5668_\u82f1\u96c4\u51fa\u573a").SetUrlByModel(n.appearancesModel),i.push(r.tm("\u6302\u673a\u52a8\u753b.\u88c5\u8f7d\u5668_\u82f1\u96c4\u51fa\u573a").GetPromise()),r.tm("\u6302\u673a\u52a8\u753b.\u88c5\u8f7d\u5668_\u82f1\u96c4\u653b\u51fb").SetUrlByModel(n.atkModel),i.push(r.tm("\u6302\u673a\u52a8\u753b.\u88c5\u8f7d\u5668_\u82f1\u96c4\u653b\u51fb").GetPromise()),r.tm("\u6302\u673a\u52a8\u753b.\u88c5\u8f7d\u5668_\u82f1\u96c4\u5f85\u673a").SetUrlByModel(n.awaitModel),i.push(r.tm("\u6302\u673a\u52a8\u753b.\u88c5\u8f7d\u5668_\u82f1\u96c4\u5f85\u673a").GetPromise()),this.transTimer&&(this.toolSet.removeTimer(this.transTimer),this.transTimer=null),Promise.all(i).then(function(){e.com.tm("\u6302\u673a\u52a8\u753b").asCom.getTransition("\u52a8\u6548_\u51fa\u573a").play(function(){var t=r.tm("\u6302\u673a\u52a8\u753b").asCom.getTransition("\u52a8\u6548_\u653b\u51fb");e.transTimer=e.toolSet.addTimer(t.getTransitionTime(),function(){e.playAnimation()},e)},.2)}),this.StartRegards(t)}},e.prototype.updateMonsterModel=function(){var t=this,e=t.com,r=this.ModelMgr.ModelChapter.GetRefChapter().monsterModelId,o=t.Ref.RefMgrchapterMonster.getRef("resId",r),n=[];e.tm("\u6302\u673a\u52a8\u753b.\u88c5\u8f7d\u5668_\u602a\u7269\u884c\u8d70").SetUrlByModel(o.awaitModel),n.push(e.tm("\u6302\u673a\u52a8\u753b.\u88c5\u8f7d\u5668_\u602a\u7269\u884c\u8d70").GetPromise()),e.tm("\u6302\u673a\u52a8\u753b.\u88c5\u8f7d\u5668_\u602a\u7269\u6b7b\u4ea1").SetUrlByModel(o.dieModel),n.push(e.tm("\u6302\u673a\u52a8\u753b.\u88c5\u8f7d\u5668_\u602a\u7269\u6b7b\u4ea1").GetPromise()),Promise.all(n).then(function(){var r=t.ModelMgr.ModelGameConfig.GetGameConfigValueByKey("xiulianMonstarScale");e.tm("\u6302\u673a\u52a8\u753b.\u88c5\u8f7d\u5668_\u602a\u7269\u884c\u8d70").GetNode().setScale(r,r),e.tm("\u6302\u673a\u52a8\u753b.\u88c5\u8f7d\u5668_\u602a\u7269\u6b7b\u4ea1").GetNode().setScale(r,r),t.playAnimation()})},e.prototype.StartRegards=function(t){var e=this;if(null!=t){var r=this.ModelMgr.ModelVO.VOHeroBag.Get(t).GetHeroAudioRef();null!=r&&1!=e.isExit&&(e.audioTimer=e.toolSet.addDelay(1e3*r.regardInterval,function(){Math.random()<=r.regardPro&&e.CtrlMgr.CtrlAudio.PlaySound("\u767e\u604b_\u5546\u5e97_\u732b\u638c\u67dc1")}))}},e.prototype.updateTab=function(){var t=this.ModelMgr.ModelChapter.GetSelectResId(),e=this.ModelMgr.ModelChapter.GetLiveTime(t),o=this.ModelMgr.ModelChapter.GetRefChapter(t);this.com.setSelectedIndex("\u96be\u5ea6",o.difficulty-1),this.com.tm("\u6309\u94ae_\u5173\u5361.title").SeturlByTest(o.title),this.com.tm("\u6309\u94ae_\u5173\u5361.bg").SeturlByTest(o.chapterIcon),this.com.tm("\u6309\u94ae_\u5173\u5361.\u88c5\u8f7d\u5668_\u9634\u5f71").SetUrlByIcon(o.chapterIcon),this.com.tm("\u88c5\u8f7d\u5668_\u96be\u5ea6\u80cc\u666f").SetUrlByIcon(r.hartArray[o.difficulty-1]),this.com.tm("\u6587\u672c_\u96be\u5ea6").asTextField.setVar("time",this.TimeUtil.timeSec2HMSStr13(e)).flushVars(),this.updateMonsterModel()},e.__cname="TabXiulianUI",i([s.injectField("LayerChapterSelect")],e.prototype,"LayerChapterSelect",void 0),i([s.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([s.injectField("CtrlMain")],e.prototype,"CtrlMain",void 0),i([s.injectField("LayerSetting")],e.prototype,"LayerSetting",void 0),i([s.injectField("CtrlBattle")],e.prototype,"CtrlBattle",void 0),i([s.injectField("TimeUtil")],e.prototype,"TimeUtil",void 0),i([s.injectField("Ref")],e.prototype,"Ref",void 0),i([s.injectField("LayerChapterReward")],e.prototype,"LayerChapterReward",void 0),i([s.injectField("LayerShowTip")],e.prototype,"LayerShowTip",void 0),i([s.injectField("LayerNotice")],e.prototype,"LayerNotice",void 0),i([s.injectField("CtrlNotice")],e.prototype,"CtrlNotice",void 0),i([s.injectField("LayerUnlockSkill")],e.prototype,"LayerUnlockSkill",void 0),i([s.injectField("LayerBossNodeReconnect")],e.prototype,"LayerBossNodeReconnect",void 0),e}(v.GameTabUI);r.TabXiulianUI=b,cc._RF.pop()},{"../../../../../framework/FW":void 0,"../../../../../framework/container/Container":void 0,"../../../../../framework/layer/PopLayerMgr":void 0,"../../../../generated/netProto/CmdInterface":"CmdInterface","../../../fguiExtend/GObjRD":"GObjRD","../../../model/System/ModelSystem":"ModelSystem","../../../model/expr/ModelExpr":"ModelExpr","../../../model/guide/ModelGuide":"ModelGuide","../../../model/public/AppCustomData":"AppCustomData","../../../ui/GameTab":"GameTab","../../alert/CtrlAlert":"CtrlAlert","./Entrance/GObjEntrance":"GObjEntrance"}],TestConstraint:[function(t,e,r){"use strict";cc._RF.push(e,"e60fcJu8KpD0IoX/ZxZvkMS","TestConstraint");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.TestConstraint=void 0;var c=t("../../framework/layer/common/UIMgr"),u=function(){function t(){}return t.Test=function(){var t=this;c.UIMgr.instance.unLoadAll(!0);var e=cc.director.getScene().getChildByName("Canvas"),r=new cc.Node;e.addChild(r);var o=r.addComponent(y);this.preload().then(function(){var e,r;try{for(var n=s(t.res),i=n.next();!i.done;i=n.next()){var a=i.value;o.assets.push(a)}}catch(l){e={error:l}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}o.run()})},t.preload=function(){return a(this,void 0,void 0,function(){var t,e,r,o,n,i=this;return l(this,function(a){switch(a.label){case 0:for(t=["art/role/longwang/longwang","art/role/nvgui/nvgui"],e=[],r=function(r){var n=t[r],a=o.loadAssets(n,cc.Prefab);a.then(function(t){i.res[r]=t}),e.push(a)},o=this,n=0;n<t.length;n++)r(n);return[4,Promise.all(e)];case 1:return a.sent(),[2]}})})},t.loadAssets=function(t,e){return a(this,void 0,Promise,function(){return l(this,function(){return[2,new Promise(function(r,o){cc.resources.load(t,e,function(t,e){t?(console.error(t),o()):(e.addRef(),r(e))})})]})})},t.__cname="TestConstraint",t.res=[],t}();r.TestConstraint=u;var p=cc._decorator,f=p.ccclass,h=p.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.assets=[],e.isRun=!1,e.nodes=[],e.moving=[],e.time=0,e}return n(e,t),e.prototype.start=function(){},e.prototype.update=function(){this.isRun&&this.updateRole()},e.prototype.run=function(){this.enablePhysics(),this.initRole(),this.isRun=!0},e.prototype.enablePhysics=function(){var t=cc.director.getPhysicsManager();t.enabled=!0,t.gravity=cc.v2(),t.enabledAccumulator=!0,cc.PhysicsManager.FIXED_TIME_STEP=1/30,cc.PhysicsManager.VELOCITY_ITERATIONS=2,cc.PhysicsManager.POSITION_ITERATIONS=2},e.prototype.initRole=function(){for(var t=0;t<600;t++)this.createOne(0,20,1);for(t=0;t<200;t++)this.createOne(1,10,2)},e.prototype.createOne=function(t,e,r){var o=this.node,n=this.assets[t],i=cc.instantiate(n);o.addChild(i);var a=this.nodes.length;this.nodes.push(i),this.moving.push(!1);var l=i.addComponent(cc.RigidBody);l.type=cc.RigidBodyType.Dynamic,l.fixedRotation=!0;var s=i.addComponent(cc.PhysicsCircleCollider);return s.radius=e,s.restitution=.2,s.density=r,s.apply(),a},e.prototype.randomPos=function(t){var e=this.nodes[t],r=Math.random()*Math.PI*2,o=800*Math.cos(r),n=800*Math.sin(r);e.setPosition(o,n)},e.prototype.randomPos2=function(t){var e=this.nodes[t],r=Math.random()*Math.PI*1/6;r+=Math.floor(4*Math.random())*Math.PI/2;var o=800*Math.cos(r),n=800*Math.sin(r);e.setPosition(o,n)},e.prototype.goCenter=function(t,e){var r=this.nodes[t],o=Math.atan2(r.y,r.x),n=Math.cos(o+Math.PI)*e,i=Math.sin(o+Math.PI)*e;r.getComponent(cc.RigidBody).linearVelocity=new cc.Vec2(n,i),this.moving[t]=e>0},e.prototype.updateMoving=function(t,e){if(0!=this.moving[t]){var r=this.nodes[t],o=r.x,n=r.y;o*o+n*n<=1e4?(this.randomPos(t),this.goCenter(t,e)):this.goCenter(t,e)}},e.prototype.updateRole=function(){for(var t=0;t<600;t++)this.updateMoving(t,90);for(t=0;t<200;t++)this.updateMoving(600+t,270);var e=cc.director.getTotalTime();e>this.time&&(this.time=e+999999999,this.updateRoleInner())},e.prototype.updateRoleInner=function(){for(var t=this,e=0,r=0;r<600;r++){e++;var o=r;this.randomPos(o),this.goCenter(o,90)}var n=e;for(r=0;r<200;r++)o=n+r,this.randomPos2(o),this.goCenter(o,0);setTimeout(function(){for(var r=e,o=0;o<200;o++){var n=r+o;t.goCenter(n,270)}},2e3)},i([h({type:cc.Prefab})],e.prototype,"assets",void 0),i([f],e)}(cc.Component);r.default=y,cc._RF.pop()},{"../../framework/layer/common/UIMgr":void 0}],TestCor:[function(t,e,r){"use strict";cc._RF.push(e,"5001eNn9cZIrraIn0lN4zfA","TestCor");var o=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},n=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.TestCor=void 0;var i=t("../../framework/coroutine/Cor"),a=t("../../framework/utils/Toolset"),l=function(){function t(){}return t.Test=function(){var t=this,e=a.ToolSet.createToolSet(),r=function(t){cc.log((t||"\u6253\u5370")+": "+cc.director.getTotalTime()/1e3+" s")},l=new i.Cor;e.addUpdateFrame(function(){l.Update()}),l.Resume(function(){return o(t,void 0,void 0,function(){return n(this,function(t){switch(t.label){case 0:return r("1"),[4,i.Cor.WaitTime_cor(l,1)];case 1:return t.sent(),r("2"),[4,i.Cor.WaitTime_cor(l,1)];case 2:return t.sent(),r("3"),[4,i.Cor.WaitTime_cor(l,1)];case 3:return t.sent(),r("4"),[4,i.Cor.WaitTime_cor(l,1)];case 4:return t.sent(),[2]}})})}).then(function(t){r(String(t))}),e.addDelay(2e3,function(){l.Stop()})},t.__cname="TestCor",t}();r.TestCor=l,cc._RF.pop()},{"../../framework/coroutine/Cor":void 0,"../../framework/utils/Toolset":void 0}],TestExpr:[function(t,e,r){"use strict";cc._RF.push(e,"a5056hqHCVHQLqTOjK91/bO","TestExpr");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.TestExpr=void 0;var i=t("../../framework/expr/ExprVarBase"),a=t("../../framework/FW"),l=t("../../framework/utils/StringUtil"),s=t("../../framework/utils/Toolset"),c=a.FW.Log.info.bind(a.FW.Log),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.t=0,e}return n(e,t),e.prototype.Setup=function(e,r,o,n){r=r||0,o=o||0,n=n||0,t.prototype.Setup.call(this,e,r,o,n),c("\u8bbe\u7f6e\u8868\u8fbe\u5f0f:"+Array.prototype.slice.apply(arguments).join())},e.prototype.OnEnter=function(){var t=this;this.assert(null==this.toolSet,"\u91cd\u590d\u8d4b\u503c\uff01"),this.toolSet=s.ToolSet.createToolSet(),this.toolSet.addTimer(1e3,function(){t.t++,t.MarkDirty()})},e.prototype.OnExit=function(){s.ToolSet.destroyToolSet(this.toolSet)},e.prototype.OnComputeResult=function(){var t=this.t;return t+=this.GetP1(),t+=this.GetP2(),t+=this.GetP3(),c("\u8868\u8fbe\u5f0f:"+this.GetVarName()+" \u6c42\u503c:"+t),t},e.__cname="VarTime",e}(i.ExprVarBase),p=function(){function t(){}return t.Init=function(){this._isinit||(this._isinit=!0,a.FW.ExprMgr.RegistVarClass("time",u))},t.Test=function(){var t=this;this.Init(),this.RegistTest("\u8868\u8fbe\u5f0f\u4e34\u65f6\u6c42\u503c",function(t){var e=a.FW.ExprMgr.GetResult("[time:1] > 0");t(1==e,"script: [time:1] > 0, result: "+e)}),this.RegistTest("\u6ce8\u518c\u8868\u8fbe\u5f0f",function(e){var r=s.ToolSet.createToolSet(),o="[time:1] > 0";a.FW.ExprMgr.AddScriptRef(o),r.addDefer(function(){a.FW.ExprMgr.RemoveScriptRef(o)});var n=a.FW.ExprMgr.AddScriptListener(o,function(){var t=a.FW.ExprMgr.GetResult(o);c("\u76d1\u542c script: "+o+", result: "+t)},t);r.addDefer(function(){a.FW.ExprMgr.RemoveScriptListener(n)}),r.addTimer(3e3,function(){s.ToolSet.destroyToolSet(r),r=null,e(!0,"")})}),this.RegistTest("\u6d4b\u8bd5\u5408\u5e76\u6761\u4ef6",function(e){var r=s.ToolSet.createToolSet(),o=[l.StringUtil.format("!({0}) && {1}","([time:0] ) > 2","\u65f6\u95f4\u4e0d\u5927\u4e8e2"),l.StringUtil.format("!({0}) && {1}","([time:0] ) > 6 ","\u65f6\u95f4\u4e0d\u5927\u4e8e6")].map(function(t){return"("+t+")"}).join("||");a.FW.ExprMgr.AddScriptRef(o),r.addDefer(function(){a.FW.ExprMgr.RemoveScriptRef(o)}),a.FW.ExprMgr.AddScriptListener("[time:1] > 0",function(){var t=a.FW.ExprMgr.GetResult(o);c("script: "+o+", result: "+t)},t),r.addTimer(3e3,function(){s.ToolSet.destroyToolSet(r),r=null,e(!0,"")})}),this.RegistTest("\u6d4b\u8bd5\u6587\u672c\u6a21\u677f",function(t){var e=l.StringUtil.format("!({0}) && {1}","5 > 2","[=[5\u4e0d[=[\u5927]=]\u4e8e2]=]"),r=l.StringUtil.format("!({0}) && {1}","5 == 2","[=[5\u4e0d[=[\u7b49]=]\u4e8e2]=]"),o=l.StringUtil.format("({0}) || ({1})",e,r),n=a.FW.ExprMgr.GetResult(o);t("5\u4e0d\u7b49\u4e8e2"==n,"script: "+o+", result: "+n)}),this.RegistTest("\u6253\u5370\u8282\u70b9\u6811",function(t){var e="((!([close]))&&[=[\u901a\u5173\u5173\u5361\u4e0d\u8db3]=])";t(!0,"script: "+e+", result: "+a.FW.ExprMgr.GetResult(e,!0))}),this.RegistTest("\u6d4b\u8bd5\u591a\u4e2a\u8868\u8fbe\u5f0f\u8fde\u7eed\u4f7f\u7528\u6216",function(t){var e="[close]||[close]||[close]||[open]",r=a.FW.ExprMgr.GetResult(e,!0);t(1==r,"script: "+e+", result: "+r)}),this.RegistTest("\u6d4b\u8bd5\u591a\u4e2a\u8868\u8fbe\u5f0f \u6216 \u4e0e \u4ea4\u53c9\u4f7f\u7528",function(t){var e="[close]||[close]&&[close]||[open]",r=a.FW.ExprMgr.GetResult(e,!0);t(0==r,"script: "+e+", result: "+r)}),this.RunTest()},t.RegistTest=function(t,e){this.tmTest.set(t,e)},t.RunTest=function(){c("\u5f00\u59cb\u6d4b\u8bd5:");var t=this.tmTest.entries(),e=function(r){var o=t.next();if(!o.done){var n=o.value[0],i=o.value[1];c("\u8fd0\u884c\u3010"+n+"\u3011"),i(function(t,o){c("\u7ed3\u679c\u3010"+n+"\u3011"+t+" "+o+"\n"),e(r)})}};e(t)},t.__cname="TestExpr",t._isinit=!1,t.tmTest=new Map,t}();r.TestExpr=p,cc._RF.pop()},{"../../framework/FW":void 0,"../../framework/expr/ExprVarBase":void 0,"../../framework/utils/StringUtil":void 0,"../../framework/utils/Toolset":void 0}],TestGeometry:[function(t,e,r){"use strict";cc._RF.push(e,"d529fTdQ5BNy4LSVsZlGCKP","TestGeometry");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},l=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},s=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.TestGeometry=void 0;var c,u=t("../../framework/base/ScriptObject"),p=t("../../framework/layer/common/UIMgr"),f=t("../../framework/utils/Toolset"),h=t("../utils/MathUtil"),y=function(){function t(){}return t.Test=function(){p.UIMgr.instance.unLoadAll(!0);var t=cc.director.getTotalTime();this.app=new C,this.app.Init().then(function(){console.log("\u542f\u52a8\u7528\u65f6\uff1a"+(cc.director.getTotalTime()-t))})},t.Exit=function(){this.app.destroy()},t.__cname="TestGeometry",t}();r.TestGeometry=y,function(t){t.YELLOW="#F8FE29",t.GREEN="#C8F424",t.GREEN_DARK="#0B2918",t.CYRN="#97E3FE",t.PURPLE="#9A53D0",t.PURPLE_DARK="0F1546",t.RED="#D32729",t.PINK="#F4545E",t.BLUE="#F4545E",t.BLUE_DARK="#25091C",t.ORIGIN="#E1664C"}(c||(c={}));var d,m,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tmSystem=new Map,e.tmCom=new Map,e.length=0,e}return n(e,t),e.prototype.Init=function(){return i(this,void 0,Promise,function(){var t,e,r,o,n,i,c,u,p,f,h,y,d,m,v;return a(this,function(a){switch(a.label){case 0:return[4,this.onInit()];case 1:a.sent();try{for(t=l(this.tmSystem),e=t.next();!e.done;e=t.next())(r=s(e.value,2))[0],r[1].Init()}catch(_){f={error:_}}finally{try{e&&!e.done&&(h=t.return)&&h.call(t)}finally{if(f)throw f.error}}try{for(o=l(this.tmCom),n=o.next();!n.done;n=o.next())(i=s(n.value,2))[0],i[1].Init()}catch(S){y={error:S}}finally{try{n&&!n.done&&(d=o.return)&&d.call(o)}finally{if(y)throw y.error}}try{for(c=l(this.tmSystem),u=c.next();!u.done;u=c.next())(p=s(u.value,2))[0],p[1].Start()}catch(g){m={error:g}}finally{try{u&&!u.done&&(v=c.return)&&v.call(c)}finally{if(m)throw m.error}}return[2]}})})},e.prototype.onDestroy=function(){var e,r,o,n,i,a;try{for(var c=l(this.tmSystem),u=c.next();!u.done;u=c.next()){var p=s(u.value,2);p[0],p[1].Exit()}}catch(_){e={error:_}}finally{try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(e)throw e.error}}try{for(var f=l(this.tmSystem),h=f.next();!h.done;h=f.next()){var y=s(h.value,2);y[0],y[1].destroy()}}catch(S){o={error:S}}finally{try{h&&!h.done&&(n=f.return)&&n.call(f)}finally{if(o)throw o.error}}try{for(var d=l(this.tmCom),m=d.next();!m.done;m=d.next()){var v=s(m.value,2);v[0],v[1].destroy()}}catch(g){i={error:g}}finally{try{m&&!m.done&&(a=d.return)&&a.call(d)}finally{if(i)throw i.error}}t.prototype.onDestroy.call(this)},e.prototype.addSystem=function(t){var e=new t;return e.world=this,this.tmSystem.set(t,e),e},e.prototype.getSystem=function(t){return this.tmSystem.get(t)},e.prototype.addCom=function(t){var e=new t;return e.world=this,this.tmCom.set(t,e),e},e.prototype.getCom=function(t){return this.tmCom.get(t)},e.prototype.AddEntity=function(){for(var t,e,r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];var n=this.length;this.length++;var i=this.tmCom;try{for(var a=l(r),s=a.next();!s.done;s=a.next()){var c=s.value;i.get(c).AddEntity(n)}}catch(u){t={error:u}}finally{try{s&&!s.done&&(e=a.return)&&e.call(a)}finally{if(t)throw t.error}}return n},e.prototype.RemoveEntity=function(t){var e,r;try{for(var o=l(this.tmCom),n=o.next();!n.done;n=o.next()){var i=s(n.value,2);i[0],i[1].RemoveEntity(t)}}catch(a){e={error:a}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}},e}(u.ScriptObject),_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.length=0,e.tlNumStr=new Array,e}return n(e,t),e.prototype.Init=function(){this.onInit()},e.prototype.AddEntity=function(t){for(var e,r,o,n;t>=this.length;){try{for(var i=(e=void 0,l(this.tlNumStr)),a=i.next();!a.done;a=i.next())(u=a.value)[1].push(u[0])}catch(p){e={error:p}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}this.length++}try{for(var s=l(this.tlNumStr),c=s.next();!c.done;c=s.next()){var u;(u=c.value)[1][t]=u[0]}}catch(f){o={error:f}}finally{try{c&&!c.done&&(n=s.return)&&n.call(s)}finally{if(o)throw o.error}}this.OnAddEntity(t)},e.prototype.RemoveEntity=function(t){var e,r;try{for(var o=l(this.tlNumStr),n=o.next();!n.done;n=o.next()){var i=n.value;i[1][t]=i[0]}}catch(a){e={error:a}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}this.OnRemoveEntity(t)},e.prototype.Create=function(t){void 0===t&&(t=null);var e=new Array;return this.tlNumStr.push([t,e]),e},e.prototype.OnAddEntity=function(){},e.prototype.OnRemoveEntity=function(){},e}(u.ScriptObject),S=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.Init=function(){this.onInit()},e.prototype.Start=function(){this.onStart()},e.prototype.Exit=function(){this.onExit()},e.prototype.Update=function(t){this.onUpdate(t)},e.prototype.onStart=function(){},e.prototype.onExit=function(){},e.prototype.onUpdate=function(){},e}(u.ScriptObject);(function(t){t[t.Longwang=0]="Longwang",t[t.Nvgui=1]="Nvgui",t[t.Houyi=2]="Houyi",t[t.Bullet_1=3]="Bullet_1"})(d||(d={})),function(t){t[t.Idle=0]="Idle",t[t.Walk=1]="Walk",t[t.Bullet_A=0]="Bullet_A",t[t.Bullet_B=1]="Bullet_B",t[t.Bullet_C=2]="Bullet_C",t[t.Bullet_D=3]="Bullet_D"}(m||(m={}));var g,b=["art/role/\u706b\u9f99\u679c/root","art/role/\u706b\u9f99\u679c/root","art/role/tt/tt_64"],C=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.assetsPath=b,e.dic=new Map,e.res=[],e.mapRes=new Map,e}return n(e,t),e.prototype.perload=function(){return i(this,void 0,void 0,function(){var t,e,r,o,n,i,s,c;return a(this,function(a){switch(a.label){case 0:t=this.assetsPath,e=[];try{for(r=l(t),o=r.next();!o.done;o=r.next())n=o.value,i=this.loadAssets(n,cc.Prefab),e.push(i)}catch(u){s={error:u}}finally{try{o&&!o.done&&(c=r.return)&&c.call(r)}finally{if(s)throw s.error}}return[4,Promise.all(e)];case 1:return a.sent(),[2]}})})},e.prototype.onInit=function(){return i(this,void 0,Promise,function(){var t,e,r,o=this;return a(this,function(n){switch(n.label){case 0:return t=cc.director.getScene().getChildByName("Canvas"),e=new cc.Node,t.addChild(e),this.root=e,(r=e.addComponent(cc.Graphics)).lineWidth=3,this.graph=r,[4,this.perload()];case 1:return n.sent(),this.addCom(R),this.addCom(U),this.addCom(V),this.addCom(Z),this.addSystem(M),this.addSystem(w),this.addSystem(O),this.addSystem(B),this.addSystem(G),this.addSystem(k),this.addSystem(x),this.addSystem(T),this.addSystem(Y),this.addSystem(j),this.addSystem(Q),this.toolSet=f.ToolSet.createToolSet(),this.toolSet.addUpdateFrame(function(t){o.update(t/1e3)},this),this.toolSet.addTimer(1/12,function(){o.renderer(1/12)},this),[2]}})})},e.prototype.onDestroy=function(){this.unloadAll(),f.ToolSet.destroyToolSet(this.toolSet),this.toolSet=null},e.prototype.update=function(t){var e=this,r=cc.director.getTotalTime();null==this._st&&(this._st=r);var o,n=function(t){var o=cc.director.getTotalTime();e.dic.set(t,(o-r)/1e3)};this.getSystem(M).Update(t),n("SystemInput"),this.getSystem(B).Update(t),n("SystemRole"),this.getSystem(Y).Update(t),n("SystemState"),this.getSystem(G).Update(t),n("SystemMove"),this.getSystem(j).Update(t),n("SystemCollision"),this.getSystem(x).Update(t),n("SystemView"),this.getSystem(Q).Update(t),n("SystemSprite"),this.getSystem(k).Update(t),n("SystemCamera"),(o=cc.director.getTotalTime())-e._st>5e3&&(e._st=o,console.log(e.dic))},e.prototype.renderer=function(t){this.getSystem(w).Update(t)},e.prototype.unloadAll=function(){var t,e;try{for(var r=l(this.res),o=r.next();!o.done;o=r.next())o.value.decRef()}catch(n){t={error:n}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}this.mapRes.clear(),this.res.splice(0)},e.prototype.loadAssets=function(t,e){return i(this,void 0,Promise,function(){var r;return a(this,function(){return r=this,[2,new Promise(function(o,n){cc.resources.load(t,e,function(e,i){e?(console.error(e),n()):(i.addRef(),r.res.push(i),r.mapRes.set(t,i),o(i))})})]})})},e.prototype.getAssets=function(t,e){var r=this.mapRes.get(t),o=cc.instantiate(r);return e.addChild(o),o},e.prototype.returnAssets=function(t){t.destroy()},e.__cname="App",e}(v),R=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ids=new Set,e.x=e.Create(0),e.y=e.Create(0),e.vx=e.Create(0),e.vy=e.Create(0),e.direction=e.Create(0),e.speed=e.Create(10),e.moving=e.Create(!0),e.gx=e.Create(-1),e.gy=e.Create(-1),e.graphId=e.Create(0),e.type=e.Create("circle"),e.z=e.Create(0),e.w=e.Create(0),e.color=e.Create(c.BLUE),e.active=e.Create(!0),e.visible=e.Create(!0),e.target=e.Create(null),e.reaction=e.Create(500),e.camp=e.Create(-1),e}return n(e,t),e.prototype.onInit=function(){},e.prototype.OnAddEntity=function(t){this.ids.add(t)},e.prototype.OnRemoveEntity=function(t){this.ids.delete(t)},e.prototype.isAlive=function(t){return 1==this.active[t]},e.prototype.check=function(t,e){var r=this.x[t],o=this.y[t],n=this.z[t],i=this.x[e],a=this.y[e],l=this.z[e],s=i-r,c=a-o;return s*s+c*c<=(n+l)*(n+l)},e.__cname="ComGraph",e}(_),M=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.onInit=function(){this.systemRole=this.world.getSystem(B),this.systemState=this.world.getSystem(Y),this.comGraph=this.world.getCom(R);var t=cc.Camera.main.node;t.on(cc.Node.EventType.TOUCH_START,this.touchBegin,this),t.on(cc.Node.EventType.TOUCH_MOVE,this.touchMove,this),t.on(cc.Node.EventType.TOUCH_END,this.touchEnd,this)},e.prototype.onUpdate=function(t){var e=this.systemRole.GetHeroId(),r=this.systemState,o=this.comGraph;if(this.moving){var n=this.degree/180*Math.PI,i=o.speed[e],a=o.x[e]+10*Math.cos(n)*t*i,l=o.y[e]+10*Math.sin(n)*t*i;r.comState.SwitchMove(e,a,l,10)}else r.comState.SwitchIdle(e)},e.prototype.touchBegin=function(t){var e=cc.Camera.main,r=(e.node,t.getLocation());this.startX=r.x,this.startY=r.y,console.log("\u89e6\u6478\u5750\u6807:"+r.x+","+r.y);var o=cc.v2(0,0);e.getScreenToWorldPoint(r,o),console.log("\u4e16\u754c\u5750\u6807:"+o.x+","+o.y),console.log("--------------------")},e.prototype.touchMove=function(t){this.moving=!0;var e=t.getLocation(),r=e.x-this.startX,o=e.y-this.startY;this.degree=180*Math.atan2(o,r)/Math.PI},e.prototype.touchEnd=function(){this.moving=!1},e.__cname="SystemInput",e}(S),w=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.list=[],e}return n(e,t),e.prototype.onInit=function(){},e.prototype.onUpdate=function(){var t,e,r=this.world.graph;r.clear();try{for(var o=l(this.list),n=o.next();!n.done;n=o.next()){var i=n.value;r.strokeColor.fromHEX(i.c),"rect"==i.t?r.rect(i.x,i.y,i.z,i.w):"circle"==i.t&&r.circle(i.x,i.y,i.z),r.stroke()}}catch(a){t={error:a}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}},e.prototype.add=function(t,e,r,o,n,i){var a=this.list,l=a.length;return a.push({eid:l,t:t,x:e,y:r,z:o,w:n,c:i}),l},e.prototype.updateGraph=function(t,e,r,o,n,i,a){var l=this.list[t];l&&(l.x=null==e?l.x:e,l.y=null==r?l.y:r,l.z=null==o?l.z:o,l.w=null==n?l.w:n,l.c=null==i?l.c:i,l.t=null==a?l.t:a)},e.prototype.getGraph=function(t){return this.list[t]},e.__cname="SystemCanvas",e}(S),O=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.gridXCount=9,e.gridYCount=16,e.gridSize=80,e.mapSize=new cc.Vec2(e.gridSize*e.gridXCount-1,e.gridSize*e.gridYCount-1),e.background=[],e}return n(e,t),e.prototype.onInit=function(){this.systemCanvas=this.world.getSystem(w),this.addBackground(c.PURPLE,this.background)},e.prototype.addBackground=function(t,e){for(var r=this.gridXCount,o=this.gridYCount,n=this.gridSize,i=(this.mapSize,0);i<r;i++)for(var a=0;a<o;a++){var l=i*n,s=a*n,c=this.systemCanvas.add("rect",l,s,n,n,t);e.push(c)}return e},e.prototype.getGridIndex=function(t,e){return this.gridXCount,t*this.gridYCount+e},e.prototype.getGridXY=function(t){return[Math.floor(t/this.gridYCount),t%this.gridYCount]},e.prototype.getGridGraphId=function(t,e){var r=this.getGridIndex(t,e);return this.background[r]},e.prototype.updateGridGraph=function(t,e){this.systemCanvas.updateGraph(t,null,null,null,null,e)},e.__cname="SystemMap",e}(S),B=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.obstracle=[],e.bullet=[],e._now=0,e._next=0,e._temp_obstacle=[],e._list_obstacle=new Set,e._count_dart=0,e._num_dart=20,e._list_dart=[],e._count_dartfield=0,e._num_dartfield=6,e._list_dartfield=[],e._count_football=0,e._num_football=30,e._list_football=[],e}return n(e,t),e.prototype.onInit=function(){this.systemMove=this.world.getSystem(G),this.systemMap=this.world.getSystem(O),this.systemCamera=this.world.getSystem(k),this.systemState=this.world.getSystem(Y),this.comGraph=this.world.getCom(R),this.comSprite=this.world.getCom(Z),this.heroId=this.CreateHero(),this.launchId=this.CreateLaunch(),this.systemCamera.setMaster(this.GetHeroId())},e.prototype.onStart=function(){var t=this.systemState,e=this.heroId;this.comGraph,t.comState.SwitchPlayerLauncher(this.launchId),this.world.getCom(V).setupDart(e,4,2),this.world.getCom(V).setupDartField(e,6,3,10),this.world.getCom(V).setupFootball(e,5,3,4)},e.prototype.onUpdate=function(t){var e=this._now+=t;this._next-e<=0&&(this._next=e+5,this.UpdateObstacle(100))},e.prototype.CreateLaunch=function(){var t=this.comGraph,e=this.world.AddEntity(R,U);return t.x[e]=0,t.y[e]=0,t.type[e]="none",t.camp[e]=1,e},e.prototype.GetLuncherId=function(){return this.launchId},e.prototype.CreateHero=function(){var t=this.comGraph,e=this.comSprite,r=this.world.AddEntity(R,U,V,Z),o=this.systemMap.mapSize,n=o.x/2,i=o.y/2;return t.x[r]=n,t.y[r]=i,t.type[r]="circle",t.z[r]=30,t.color[r]=c.CYRN,t.camp[r]=1,t.speed[r]=60,e.nextPath[r]=d.Houyi,e.nextAnim[r]=m.Idle,r},e.prototype.GetHeroId=function(){return this.heroId},e.prototype.UpdateObstacle=function(t){var e,r,o,n,i,a,s=this.comGraph,c=this.systemState,u=s.active,p=(this._list_obstacle,this.heroId);try{for(var f=l(this.obstracle),h=f.next();!h.done;h=f.next())0==u[m=h.value]&&this.returnObstacle(m)}catch(R){e={error:R}}finally{try{h&&!h.done&&(r=f.return)&&r.call(f)}finally{if(e)throw e.error}}var y=this.obstracle,d=this._temp_obstacle;for(d.splice(0);y.length<t;){var m=this.CreateObstacle();d.push(m)}var v=this._list_obstacle;try{for(var _=l(v),S=_.next();!S.done;S=_.next()){m=S.value;var g=this.CreateObstacle();d.push(g)}}catch(M){o={error:M}}finally{try{S&&!S.done&&(n=_.return)&&n.call(_)}finally{if(o)throw o.error}}try{for(var b=l(d),C=b.next();!C.done;C=b.next())m=C.value,s.target[m]=p,c.comState.SwitchSeek(m,p,10)}catch(w){i={error:w}}finally{try{C&&!C.done&&(a=b.return)&&a.call(b)}finally{if(i)throw i.error}}},e.prototype.getObstacle=function(){var t,e,r,o=this._list_obstacle;try{for(var n=l(o),i=n.next();!i.done;i=n.next()){r=i.value;break}}catch(a){t={error:a}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}return null!=r&&o.delete(r),null==r&&(r=this.world.AddEntity(R,U,Z),this.obstracle.push(r)),r},e.prototype.returnObstacle=function(t){this._list_obstacle.add(t)},e.prototype.CreateObstacle=function(){var t=this.systemMap.mapSize,e=this.comSprite,r=this.comGraph,o=this.getObstacle(),n=t.x*Math.random(),i=t.y*Math.random();return r.x[o]=n,r.y[o]=i,r.type[o]="circle",r.z[o]=20,r.color[o]=c.ORIGIN,r.speed[o]=30,r.camp[o]=2,r.active[o]=!0,e.nextPath[o]=Math.random()>.5?d.Longwang:d.Nvgui,e.anim[o]=-1,e.nextAnim[o]=m.Idle,o},e.prototype.GetObstracts=function(){return this.obstracle},e.prototype.getdart=function(t,e,r){var o=r[t%e];return null==o&&(o=this.world.AddEntity(R,U),r.push(o),this.bullet.push(o)),o},e.prototype.CreateDart=function(t,e){var r=this.comGraph,o=(this.comSprite,this._count_dart++),n=this._num_dart,i=this._list_dart,a=this.getdart(o,n,i);r.x[a]=r.x[t],r.y[a]=r.y[t],r.type[a]="circle",r.z[a]=4,r.color[a]=c.YELLOW,r.speed[a]=80,r.direction[a]=0,r.camp[a]=r.camp[t],r.target[a]=e,r.active[a]=!0,r.reaction[a]=100;var l=r.x[e]-r.x[t],s=r.y[e]-r.y[t],u=180*Math.atan2(s,l)/Math.PI;return this.systemState.comState.SwitchDart(a,u,500),a},e.prototype.GetDart=function(){return this._list_dart},e.prototype.CreateDartField=function(t,e,r,o){var n=this.comGraph,i=this._count_dartfield++,a=this._num_dartfield,l=this._list_dartfield,s=this.getdart(i,a,l),u=e/180*Math.PI;return n.x[s]=n.x[t]+r*Math.cos(u),n.y[s]=n.y[t]+r*Math.sin(u),n.type[s]="circle",n.z[s]=20,n.color[s]=c.YELLOW,n.speed[s]=80,n.direction[s]=e,n.camp[s]=n.camp[t],n.target[s]=null,n.active[s]=!0,n.reaction[s]=0,this.systemState.comState.SwitchDartField(s,t,e,r,o),s},e.prototype.GetDartField=function(){return this._list_dartfield},e.prototype.CreateFootball=function(t,e,r){var o=this.comGraph,n=this._count_football++,i=this._num_football,a=this._list_football,l=this.getdart(n,i,a);return Math.PI,o.x[l]=o.x[t],o.y[l]=o.y[t],o.type[l]="circle",o.z[l]=10,o.color[l]=c.YELLOW,o.speed[l]=80,o.direction[l]=e,o.camp[l]=o.camp[t],o.target[l]=null,o.active[l]=!0,o.reaction[l]=0,this.systemState.comState.SwitchFootball(l,e,r),l},e.prototype.GetFootball=function(){return this._list_football},e.__cname="SystemRole",e}(S),P=function(){this.ids=new Set},G=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.grids=[],e}return n(e,t),e.prototype.onInit=function(){this.systemMap=this.world.getSystem(O),this.comGraph=this.world.getCom(R);for(var t=0;t<this.systemMap.gridYCount;t++){var e=[];this.grids.push(e);for(var r=0;r<this.systemMap.gridXCount;r++)e.push(new P)}},e.prototype.onUpdate=function(t){var e,r,o=this.comGraph,n=this.systemMap.gridSize,i=this.systemMap.mapSize.x,a=this.systemMap.mapSize.y,s=this.grids,c=o.x,u=o.y,p=o.vx,f=o.vy,h=o.moving,y=o.speed,d=o.direction,m=o.gx,v=o.gy,_=function(e){var r=h[e]?y[e]:0;c[e]=c[e]+p[e]*t*r,u[e]=u[e]+f[e]*t*r,c[e]=Math.max(Math.min(c[e],i),0),u[e]=Math.max(Math.min(u[e],a),0),p[e]*r==0&&f[e]*r==0||(d[e]=Math.atan2(f[e],p[e]));var o=Math.floor(c[e]/n),l=Math.floor(u[e]/n),_=m[e],S=v[e];o==_&&l==S||(_>=0&&S>=0&&s[S][_].ids.delete(e),s[l][o].ids.add(e),m[e]=o,v[e]=l)};try{for(var S=l(o.ids),g=S.next();!g.done;g=S.next()){var b=g.value;h[b]&&_(b)}}catch(C){e={error:C}}finally{try{g&&!g.done&&(r=S.return)&&r.call(S)}finally{if(e)throw e.error}}},e.prototype.findNear=function(t,e,r,o,n){var i,a,s=this.systemMap,c=this.grids,u=s.gridSize,p=s.gridXCount,f=s.gridYCount,h=Math.floor(t/u),y=Math.floor(e/u),d=r/u;if(h>=0&&y>=0)for(var m=0;m<p;m++)for(var v=0;v<f;v++){var _=h-m,S=y-v;if(_*_+S*S<=d*d)try{for(var g=(i=void 0,l(c[v][m].ids)),b=g.next();!b.done;b=g.next()){var C=b.value;(null==n||n(C))&&o.push(C)}}catch(R){i={error:R}}finally{try{b&&!b.done&&(a=g.return)&&a.call(g)}finally{if(i)throw i.error}}}},e.__cname="SystemMove",e}(S),k=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.camera=cc.Camera.main,e}return n(e,t),e.prototype.onInit=function(){this.comGraph=this.world.getCom(R)},e.prototype.onUpdate=function(){if(null!=this.master){var t=this.camera,e=this.master,r=this.comGraph.x[e],o=this.comGraph.y[e];this.comGraph.moving[e],t.node.x==r&&t.node.y==o||t.node.setPosition(r,o)}},e.prototype.setMaster=function(t){this.master=t},e.__cname="SystemCamera",e}(S),x=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ids=new Set,e.graphs=[],e.ids_add=new Set,e.length=0,e}return n(e,t),e.prototype.onInit=function(){this.comGraph=this.world.getCom(R),this.systemCanvas=this.world.getSystem(w)},e.prototype.onUpdate=function(){for(var t,e,r,o,n=this.comGraph,i=this.systemCanvas,a=this.graphs,c=this.ids,u=this.ids_add,p=n.x,f=this.length;p.length>f;)u.add(f),f++;this.length=f;try{for(var h=l(u),y=h.next();!y.done;y=h.next()){var d=y.value;c.add(d);var m=n.type[d],v=n.x[d],_=n.y[d],S=n.z[d],g=n.w[d],b=n.color[d],C=i.add(m,v,_,S,g,b);a.push(C)}}catch(G){t={error:G}}finally{try{y&&!y.done&&(e=h.return)&&e.call(h)}finally{if(t)throw t.error}}u.clear();try{for(var R=l(c.entries()),M=R.next();!M.done;M=R.next()){var w=s(M.value,2),O=w[0],B=(d=w[1],C=a[O],n.x[d]),P=(_=n.y[d],S=n.z[d],g=n.w[d],b=n.color[d],n.type[d]);0==n.active[d]&&(P="none"),i.updateGraph(C,B,_,S,g,b,P)}}catch(k){r={error:k}}finally{try{M&&!M.done&&(o=R.return)&&o.call(R)}finally{if(r)throw r.error}}},e.__cname="SystemView",e}(S),T=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ids=new Set,e.id_herobg=null,e._time=0,e._space=3,e._gid=0,e._last=new Set,e.temp=[],e}return n(e,t),e.prototype.onInit=function(){this.comGraph=this.world.getCom(R),this.systemRole=this.world.getSystem(B),this.systemMap=this.world.getSystem(O),this.systemMove=this.world.getSystem(G)},e.prototype.onUpdate=function(t){this.update1(t)},e.prototype.update2=function(t){var e,r,o,n;if(this._time+=t,this._time>=this._space){this._time=0;var i=this.systemMap,a=this.systemMove.grids,u=this.comGraph,p=i.gridXCount,f=i.gridYCount,h=this._gid,y=this._last,d=s(i.getGridXY(h),2),m=d[0],v=d[1];if(m<p&&v<f){var _=this._lastGrid,S=i.getGridGraphId(m,v);_!=S&&(null!=_&&i.updateGridGraph(_,c.PURPLE),i.updateGridGraph(S,c.CYRN),this._lastGrid=S);try{for(var g=l(y),b=g.next();!b.done;b=g.next()){var C=b.value;u.color[C]=c.CYRN}}catch(w){e={error:w}}finally{try{b&&!b.done&&(r=g.return)&&r.call(g)}finally{if(e)throw e.error}}y.clear();try{for(var R=l(a[v][m].ids),M=R.next();!M.done;M=R.next())C=M.value,y.add(C),u.color[C]=c.RED}catch(O){o={error:O}}finally{try{M&&!M.done&&(n=R.return)&&n.call(R)}finally{if(o)throw o.error}}this._gid++}}},e.prototype.update1=function(){var t,e,r=this.comGraph,o=this.systemRole.GetHeroId(),n=this.systemMap,i=(this.systemMove,r.camp),a=this.systemMove.grids,s=this.ids,u=r.gx[o],p=r.gy[o],f=this.temp;(t=this.id_herobg)!=(e=n.getGridGraphId(u,p))&&(null!=t&&n.updateGridGraph(t,c.PURPLE),n.updateGridGraph(e,c.RED),this.id_herobg=e),function(){var t,e,h,y,d,m,v=n.gridXCount-1,_=n.gridYCount-1;n.gridSize;try{for(var S=l(f),g=S.next();!g.done;g=S.next()){var b=g.value;r.color[b]=c.ORIGIN}}catch(T){t={error:T}}finally{try{g&&!g.done&&(e=S.return)&&e.call(S)}finally{if(t)throw t.error}}f.splice(0),s.clear();for(var C=Math.max(u-1,0),R=Math.min(u+1,v),M=Math.max(p-1,0),w=Math.min(p+1,_),O=C;O<=R;O++)for(var B=M;B<=w;B++)try{for(var P=(h=void 0,l(a[B][O].ids)),G=P.next();!G.done;G=P.next())(b=G.value)!=o&&s.add(b)}catch(j){h={error:j}}finally{try{G&&!G.done&&(y=P.return)&&y.call(P)}finally{if(h)throw h.error}}try{for(var k=l(s),x=k.next();!x.done;x=k.next())b=x.value,i[b]!=i[o]&&(f.push(b),r.check(o,b)?r.color[b]=c.CYRN:r.color[b]=c.RED)}catch(I){d={error:I}}finally{try{x&&!x.done&&(m=k.return)&&m.call(k)}finally{if(d)throw d.error}}}()},e.__cname="SystemDebugObstract",e}(S),j=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.temp=[],e.hero_hit_enemies=new Set,e}return n(e,t),e.prototype.onInit=function(){this.systemRole=this.world.getSystem(B),this.systemMove=this.world.getSystem(G),this.comGraph=this.world.getCom(R)},e.prototype.onUpdate=function(){var t=this.systemRole;this.systemMove,this.comGraph,t.GetHeroId(),t.GetObstracts(),this.temp,this.comGraph.x,this.comGraph.y,this.comGraph.reaction,this.comGraph.camp,this.comGraph.active},e.__cname="SystemCollision",e}(S);(function(t){t[t.Idle=0]="Idle",t[t.Running=1]="Running",t[t.Ready=2]="Ready",t[t.Launch=3]="Launch"})(g||(g={}));var I,D=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.now=0,e}return n(e,t),e.prototype.Init=function(){this.onInit()},e.prototype.Update=function(t){var e=this.state,r=this.nextState;e!=r&&(this.state=r,e&&this.onExitState(e),this.onEnterState(r)),e&&this.onUpdateState(t),this.onUpdate(t)},e.prototype.SwitchState=function(t){this.nextState=t},e.prototype.CheckAndLaunch=function(){this.state==g.Ready&&this.SwitchState(g.Launch)},e.prototype.onInit=function(){this.comGraph=this.world.getCom(R),this.comPlayerLauncher=this.world.getCom(V),this.systemRole=this.world.getSystem(B),this.SwitchState(g.Running)},e.prototype.onEnterState=function(t){switch(t){case g.Running:this.enterRunning();break;case g.Launch:this.enterLaunch()}},e.prototype.onExitState=function(){},e.prototype.onUpdateState=function(t){switch(this.state){case g.Running:this.updateRunning(t);break;case g.Launch:this.updateLaunch(t)}},e.prototype.enterRunning=function(){var t=this.comPlayerLauncher,e=this.systemRole,r=this.getType(),o=t.tmParams.get(r),n=e.GetHeroId();this.now=0,o[n].next=0,o[n].ready=!1},e.prototype.updateRunning=function(t){var e=this.comPlayerLauncher,r=this.systemRole,o=this.getType(),n=e.tmParams.get(o),i=r.GetHeroId();if(null!=n[i]){var a=this.now+=t,l=n[i].cd;a-l>=n[i].next&&(n[i].next=a+l,n[i].ready=!0,this.SwitchState(g.Ready))}},e.prototype.enterLaunch=function(){},e}(u.ScriptObject),F=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.launchtime=0,e}return n(e,t),e.prototype.getType=function(){return I.Dart},e.prototype.onInit=function(){t.prototype.onInit.call(this)},e.prototype.onUpdate=function(){},e.prototype.enterLaunch=function(){this.launchtime=0},e.prototype.updateLaunch=function(t){var e=this.comPlayerLauncher,r=this.systemRole,o=this.getType(),n=e.tmParams.get(o),i=r.GetHeroId(),a=this.comGraph.target,l=this.launchtime+=t,s=n[i].num,c=i,u=a[i];this.UpdateProcessLaunch(l,.5,s,c,u)},e.prototype.UpdateProcessLaunch=function(t,e,r,o,n){var i=this._bulletIndex,a=Math.ceil(t/e);a!=i&&(this._bulletIndex=a,this.systemRole.CreateDart(o,n),a>=r&&this.SwitchState(g.Running))},e.__cname="SubLauncher_Dart",e}(D),L=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.launchtime=0,e}return n(e,t),e.prototype.getType=function(){return I.Football},e.prototype.onUpdate=function(){},e.prototype.enterLaunch=function(){this.launchtime=0,this._bulletIndex=null},e.prototype.updateLaunch=function(t){var e=this.comPlayerLauncher,r=this.systemRole,o=this.getType(),n=e.tmParams.get(o),i=r.GetHeroId(),a=this.comGraph.target,l=this.launchtime+=t,s=n[i].num,c=n[i].collision,u=i;a[i],this.UpdateProcessLaunch(l,1,s,u,c)},e.prototype.UpdateProcessLaunch=function(t,e,r,o,n){var i=this._bulletIndex,a=Math.ceil(t/e);if(a!=i){this._bulletIndex=a;var l=a/r*360;this.systemRole.CreateFootball(o,l,n),a>=r&&this.SwitchState(g.Running)}},e.__cname="SubLauncher_Football",e}(D),E=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getType=function(){return I.DartField},e.prototype.onUpdate=function(){},e.prototype.enterLaunch=function(){for(var t=this.comPlayerLauncher,e=this.systemRole,r=this.getType(),o=t.tmParams.get(r),n=e.GetHeroId(),i=o[n].num,a=n,l=0;l<i;l++){var s=l/i*360;e.CreateDartField(a,s,80,o[n].duration)}this.curtime=0},e.prototype.updateLaunch=function(t){var e=this.comPlayerLauncher,r=this.systemRole,o=this.getType(),n=e.tmParams.get(o),i=r.GetHeroId();(this.curtime+=t)>=n[i].duration&&this.SwitchState(g.Running)},e.__cname="SubLauncher_DartField",e}(D);(function(t){t[t.Dart=0]="Dart",t[t.Football=1]="Football",t[t.DartField=2]="DartField"})(I||(I={}));var A,V=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ids=new Set,e.tmSub=new Map,e.tmParams=new Map,e}return n(e,t),e.prototype.onInit=function(){var t,e;this.createSub(I.Dart,F),this.createSub(I.Football,L),this.createSub(I.DartField,E);try{for(var r=l(this.tmSub),o=r.next();!o.done;o=r.next()){var n=s(o.value,2);n[0],n[1].Init()}}catch(i){t={error:i}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},e.prototype.UpdateCom=function(t){var e,r;try{for(var o=l(this.tmSub),n=o.next();!n.done;n=o.next()){var i=s(n.value,2);i[0],i[1].Update(t)}}catch(a){e={error:a}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}},e.prototype.UpdateLaunch=function(){var t,e;try{for(var r=l(this.tmSub),o=r.next();!o.done;o=r.next()){var n=s(o.value,2);n[0],n[1].CheckAndLaunch()}}catch(i){t={error:i}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},e.prototype.OnAddEntity=function(t){this.ids.add(t)},e.prototype.OnRemoveEntity=function(t){this.ids.delete(t)},e.prototype.createSub=function(t,e){var r=new e;return r.world=this.world,this.tmSub.set(t,r),this.tmParams.set(t,[]),r},e.prototype.setupDart=function(t,e,r){var o={num:e,cd:r,next:0,ready:!1},n=I.Dart;return this.tmSub.get(n),this.tmParams.get(n)[t]=o,o},e.prototype.setupDartField=function(t,e,r,o){var n={num:e,duration:o,cd:r,next:0,ready:!1},i=I.DartField;return this.tmSub.get(i),this.tmParams.get(i)[t]=n,n},e.prototype.setupFootball=function(t,e,r,o){var n={num:e,collision:o,cd:r,next:0,ready:!1},i=I.Football;return this.tmSub.get(i),this.tmParams.get(i)[t]=n,n},e.__cname="ComPlayerLauncher",e}(_),U=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ids=new Set,e.type=e.Create(),e.param=e.Create(),e.nextType=e.Create(),e.nextParam=e.Create(),e}return n(e,t),e.prototype.onInit=function(){},e.prototype.OnAddEntity=function(t){this.ids.add(t),this.SwitchIdle(t)},e.prototype.OnRemoveEntity=function(){},e.prototype.SwitchIdle=function(t){return this.nextType[t]=A.Idle,this.nextParam[t]=null,null},e.prototype.SwitchMove=function(t,e,r,o){this.nextType[t]=A.Move;var n={tx:e,ty:r,stop:o};return this.nextParam[t]=n,n},e.prototype.SwitchSeek=function(t,e,r){var o={tid:e,r:r};return this.nextType[t]=A.Seek,this.nextParam[t]=o,o},e.prototype.SwitchPlayerLauncher=function(t){var e={};return this.nextType[t]=A.PlayerAttack,this.nextParam[t]=e,e},e.prototype.SwitchDartField=function(t,e,r,o,n){var i={degree:r,r:o,sid:e,duration:n,time:0};return this.nextType[t]=A.DartField,this.nextParam[t]=i,i},e.prototype.SwitchFootball=function(t,e,r){var o={degree:e,collision:r};return this.nextType[t]=A.Football,this.nextParam[t]=o,o},e.prototype.SwitchDart=function(t,e,r){var o={degree:e,range:r,distance:0};return this.nextType[t]=A.Dart,this.nextParam[t]=o,o},e.__cname="ComState",e}(_),W=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ids=new Set,e}return n(e,t),e.prototype.Init=function(){this.onInit()},e.prototype.Enter=function(t){this.ids.add(t),this.onEnter(t)},e.prototype.Exit=function(t){this.ids.delete(t),this.onExit(t)},e.prototype.Update=function(t){this.onUpdate(t)},e.prototype.onInit=function(){},e.prototype.onEnter=function(){},e.prototype.onExit=function(){},e}(u.ScriptObject),H=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.onUpdate=function(){},e.__cname="SubState_Idle",e}(W),N=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.onInit=function(){this.comGraph=this.world.getCom(R),this.comState=this.world.getCom(U)},e.prototype.onEnter=function(t){var e=this.comGraph,r=this.comState.param,o=e.x[t],n=e.y[t],i=r[t].tx-o,a=r[t].ty-n,l=i*i+a*a;if(l>0){var s=Math.sqrt(l);i/=s,a/=s}e.vx[t]=i,e.vy[t]=a,e.moving[t]=!0},e.prototype.onUpdate=function(){var t,e,r=this.comGraph,o=this.comState,n=o.param,i=r.x,a=r.y,s=r.vx,c=r.vy;try{for(var u=l(this.ids),p=u.next();!p.done;p=u.next()){var f=p.value,h=n[f].tx,y=n[f].ty,d=n[f].stop,m=h-i[f],v=y-a[f];m*m+v*v<d?o.SwitchIdle(f):m*s[f]<0?o.SwitchIdle(f):v*c[f]<0&&o.SwitchIdle(f)}}catch(_){t={error:_}}finally{try{p&&!p.done&&(e=u.return)&&e.call(u)}finally{if(t)throw t.error}}},e.prototype.onExit=function(t){this.comGraph.vx[t]=0,this.comGraph.vy[t]=0,this.comGraph.moving[t]=!1},e.__cname="SubState_Move",e}(W),q=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.onInit=function(){this.comGraph=this.world.getCom(R),this.comState=this.world.getCom(U)},e.prototype.onEnter=function(t){var e=this.comGraph,r=this.comState.param[t].tid,o=e.x[t],n=e.y[t],i=e.x[r],a=e.x[r],l=s(this.calVelocity(o,n,i,a),2),c=l[0],u=l[1];e.vx[t]=c,e.vy[t]=u,e.moving[t]=!0},e.prototype.onUpdate=function(){var t,e,r=this.comGraph,o=this.comState.param,n=r.x,i=r.y;try{for(var a=l(this.ids),c=a.next();!c.done;c=a.next()){var u=c.value,p=o[u].tid,f=o[u].r,h=n[p],y=i[p],d=s(this.calVelocity(n[u],i[u],n[p],i[p]),2),m=d[0],v=d[1];r.vx[u]=m,r.vy[u]=v;var _=h-n[u],S=y-i[u];_*_+S*S<f*f?r.moving[u]=!1:_*m[u]<0?r.moving[u]=!1:S*v[u]<0?r.moving[u]=!1:r.moving[u]=!0}}catch(g){t={error:g}}finally{try{c&&!c.done&&(e=a.return)&&e.call(a)}finally{if(t)throw t.error}}},e.prototype.onExit=function(t){this.comGraph.vx[t]=0,this.comGraph.vy[t]=0,this.comGraph.moving[t]=!1},e.prototype.calVelocity=function(t,e,r,o){var n=r-t,i=o-e,a=n*n+i*i;if(a>0){var l=Math.sqrt(a);n/=l,i/=l}return[n,i]},e.__cname="SubState_Seek",e}(W),K=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.candidate=[],e}return n(e,t),e.prototype.onInit=function(){this.systemRole=this.world.getSystem(B),this.systemMove=this.world.getSystem(G),this.comGraph=this.world.getCom(R),this.comState=this.world.getCom(U),this.comPlayerLauncher=this.world.getCom(V)},e.prototype.onEnter=function(){},e.prototype.onExit=function(){},e.prototype.onUpdate=function(t){var e,r=this.comGraph,o=(this.comState,this.comPlayerLauncher),n=this.systemMove,i=this.systemRole.GetHeroId(),a=(this.systemRole.GetLuncherId(),r.x),l=r.y,s=r.reaction,c=r.camp,u=r.target,p=r.active;o.UpdateCom(t),null!=u[i]&&0!=r.isAlive(u[i])||(u[i]=((e=this.candidate).splice(0),n.findNear(a[i],l[i],s[i],e,function(t){return 0!=p[t]&&c[t]!=c[i]}),0==e.length?null:(e.length>1&&h.MathUtil.quickSort2(e,function(t){var e=a[t]-a[i],r=l[t]-l[i];return e*e+r*r}),e[0]))),o.UpdateLaunch()},e.__cname="SubState_PlayerAttack",e}(W),X=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.now=0,e.candidate=[],e}return n(e,t),e.prototype.onInit=function(){this.comState=this.world.getCom(U),this.comGraph=this.world.getCom(R),this.systemMove=this.world.getSystem(G)},e.prototype.onUpdate=function(t){var e,r,o=this.comGraph,n=this.comState,i=this.systemMove,a=this.comState.param,s=this.now+=t,c=o.reaction,u=o.camp,p=o.speed,f=o.active,y=o.x,d=o.y,m=this.candidate,v=function(t){m.splice(0),i.findNear(y[t],d[t],c[t],m,function(e){return 0!=o.isAlive(e)&&u[t]!=u[e]}),h.MathUtil.quickSort2(m,function(e){var r=y[e]-y[t],o=d[e]-d[t];return r*r+o*o});var e=m[0];return null!=e&&o.check(t,e)?e:null},_=function(t){var e=a[t].r,r=a[t].sid,o=a[t].degree,n=2*Math.PI*e/p[t],i=(o+=s%n/n*360)/180*Math.PI,l=y[r]+Math.cos(i)*e,c=d[r]+Math.sin(i)*e;y[t]=l,d[t]=c},S=function(e){return a[e].time+=t,a[e].time>a[e].duration};try{for(var g=l(this.ids),b=g.next();!b.done;b=g.next()){var C=b.value,R=v(C);null!=R&&(f[R]=!1),_(C),S(C)&&(n.SwitchIdle(C),f[C]=!1)}}catch(M){e={error:M}}finally{try{b&&!b.done&&(r=g.return)&&r.call(g)}finally{if(e)throw e.error}}},e.__cname="SubState_DartField",e}(W),z=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.v_n=new cc.Vec2,e.v_in=new cc.Vec2,e.candidate=[],e}return n(e,t),e.prototype.onInit=function(){this.comState=this.world.getCom(U),this.comGraph=this.world.getCom(R),this.systemMap=this.world.getSystem(O),this.systemRole=this.world.getSystem(B),this.systemMove=this.world.getSystem(G)},e.prototype.onEnter=function(t){var e=this.comState.param,r=this.comGraph,o=r.vx,n=r.vy,i=r.moving,a=e[t].degree/180*Math.PI;o[t]=Math.cos(a),n[t]=Math.sin(a),i[t]=!0},e.prototype.onUpdate=function(t){var e,r,o=this,n=this.comGraph,i=this.comState,a=this.systemMap,s=(this.systemRole,this.systemMove),c=this.comState.param,u=a.mapSize,p=n.x,f=n.y,y=(n.z,n.vx),d=n.vy,m=n.speed,v=n.reaction,_=n.camp,S=(n.target,n.active),g=n.moving,b=this.candidate,C=function(e){var r,a=p[e]+y[e]*m[e]*t*2,l=f[e]+d[e]*m[e]*t*2;if(a<=0||l<=0||a>=u.x||l>u.y)(function(){var t=o.v_n,r=o.v_in;r.x=y[e],r.y=d[e],r.normalizeSelf();var n=p[e],i=u.y-f[e],a=u.x-p[e],l=f[e];switch(Math.min(n,i,a,l)){case n:t.x=1,t.y=0;break;case i:t.x=0,t.y=-1;break;case a:t.x=-1,t.y=0;break;case l:t.x=0,t.y=1}var s=r.sub(t.mul(2*r.dot(t))),c=Math.atan2(s.y,s.x);y[e]=Math.cos(c),d[e]=Math.sin(c),g[e]=!0})();else{var C=(b.splice(0),s.findNear(p[e],f[e],v[e],b,function(t){return 0!=n.isAlive(t)&&_[e]!=_[t]}),b.length>0&&(h.MathUtil.quickSort2(b,function(t){var r=p[t]-p[e],o=f[t]-f[e];return r*r+o*o}),n.check(e,b[0])&&(r=b[0])),r);null!=C&&(function(t){var r=o.v_n,n=o.v_in;n.x=y[e],n.y=d[e];var i=p[t]-p[e],a=f[t]-f[e],l=Math.atan2(a,i);i>=0?l+=.5*Math.PI:l-=.5*Math.PI,r.x=Math.cos(l),r.y=Math.sin(l);var s=n.sub(r.mul(2*n.dot(r))),c=Math.atan2(s.y,s.x);y[e]=Math.cos(c),d[e]=Math.sin(c),g[e]=!0}(C),function(t){c[e].collision>0&&(c[e].collision--,S[t]=!1),0==c[e].collision&&(i.SwitchIdle(e),S[e]=!1)}(C))}};try{for(var R=l(this.ids),M=R.next();!M.done;M=R.next())C(M.value)}catch(w){e={error:w}}finally{try{M&&!M.done&&(r=R.return)&&r.call(R)}finally{if(e)throw e.error}}},e.__cname="SubState_Football",e}(W),J=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.candidate=[],e}return n(e,t),e.prototype.onInit=function(){this.comGraph=this.world.getCom(R),this.comState=this.world.getCom(U),this.systemMap=this.world.getSystem(O),this.systemMove=this.world.getSystem(G)},e.prototype.onEnter=function(t){var e=this.comGraph,r=this.comState.param[t].degree/180*Math.PI;e.vx[t]=Math.cos(r),e.vy[t]=Math.sin(r),e.moving[t]=!0},e.prototype.onExit=function(t){this.comGraph.vx[t]=0,this.comGraph.vy[t]=0,this.comGraph.moving[t]=!1},e.prototype.onUpdate=function(t){var e,r,o=this.comGraph,n=this.comState,i=this.systemMap,a=this.systemMove,s=this.comState.param,c=o.x,u=o.y,p=o.vx,f=o.vy,y=o.speed,d=o.active,m=o.reaction,v=o.camp,_=i.mapSize,S=this.candidate,g=function(e){var r=c[e]+p[e]*y[e]*t*2,o=u[e]+f[e]*y[e]*t*2;return r<=0||o<=0||r>=_.x||o>_.y},b=function(t){S.splice(0),a.findNear(c[t],u[t],m[t],S,function(e){return 0!=o.isAlive(e)&&v[t]!=v[e]}),h.MathUtil.quickSort2(S,function(e){var r=c[e]-c[t],o=u[e]-u[t];return r*r+o*o});var e=S[0];return null!=e&&o.check(t,e)?e:null};try{for(var C=l(this.ids),R=C.next();!R.done;R=C.next()){var M=R.value,w=b(M);null==w?g(M)?(n.SwitchIdle(M),d[M]=!1):(s[M].distance+=y[M]*t,s[M].distance>s[M].range&&(n.SwitchIdle(M),d[M]=!1)):(n.SwitchIdle(M),d[M]=!1,d[w]=!1)}}catch(O){e={error:O}}finally{try{R&&!R.done&&(r=C.return)&&r.call(C)}finally{if(e)throw e.error}}},e.__cname="SubState_Dart",e}(W);(function(t){t[t.Idle=0]="Idle",t[t.Move=1]="Move",t[t.Seek=2]="Seek",t[t.PlayerAttack=3]="PlayerAttack",t[t.DartField=4]="DartField",t[t.Football=5]="Football",t[t.Dart=6]="Dart"})(A||(A={}));var Y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tmSub=new Map,e}return n(e,t),e.prototype.onInit=function(){var t,e;this.comState=this.world.getCom(U),this.createSub(A.Idle,H),this.createSub(A.Move,N),this.createSub(A.Seek,q),this.createSub(A.PlayerAttack,K),this.createSub(A.DartField,X),this.createSub(A.Football,z),this.createSub(A.Dart,J);try{for(var r=l(this.tmSub),o=r.next();!o.done;o=r.next()){var n=s(o.value,2);n[0],n[1].Init()}}catch(i){t={error:i}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},e.prototype.onUpdate=function(t){var e,r,o,n,i=this.comState,a=this.tmSub;try{for(var c=l(i.ids),u=c.next();!u.done;u=c.next()){var p=u.value,f=i.type[p],h=i.param[p],y=i.nextType[p],d=i.nextParam[p];f==y&&h==d||(i.type[p]=y,i.param[p]=d,f&&a.get(f).Exit(p),a.get(y).Enter(p))}}catch(S){e={error:S}}finally{try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(e)throw e.error}}try{for(var m=l(this.tmSub),v=m.next();!v.done;v=m.next()){var _=s(v.value,2);_[0],_[1].Update(t)}}catch(g){o={error:g}}finally{try{v&&!v.done&&(n=m.return)&&n.call(m)}finally{if(o)throw o.error}}},e.prototype.createSub=function(t,e){var r=new e;return r.world=this.world,this.tmSub.set(t,r),r},e.__cname="SystemState",e}(S),Z=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ids=new Set,e.path=e.Create(null),e.anim=e.Create(null),e.visible=e.Create(!0),e.isRight=e.Create(!0),e.nextPath=e.Create(-1),e.nextAnim=e.Create(0),e.nextVisible=e.Create(!0),e.nextIsRight=e.Create(!0),e.prefab=e.Create(null),e}return n(e,t),e.prototype.onInit=function(){this.comGraph=this.world.getCom(R),this.systemSprite=this.world.getSystem(Q)},e.prototype.OnAddEntity=function(t){this.ids.add(t)},e.prototype.OnRemoveEntity=function(t){this.ids.delete(t)},e.prototype.UpdateState=function(){var t,e,r=this,o=this.systemSprite,n=this.path,i=this.nextPath,a=this.anim,s=this.nextAnim,c=this.prefab,u=(this.visible,this.nextVisible,this.isRight),p=this.nextIsRight,f=this.world.assetsPath,h=o.root,y=function(t,e){n[t]=i[t],c[t]=r.world.getAssets(e,h)},d=function(t){r.world.returnAssets(c[t]),c[t]=null};try{for(var m=l(this.ids),v=m.next();!v.done;v=m.next()){var _=v.value;if(n[_]!=i[_]){if(-1==i[_]){c[_]&&(n[_]=i[_],d(_));continue}null!=c[_]&&d(_),y(_,f[i[_]]),n[_]=i[_]}if(a[_]!=s[_]&&c[_]){var S=s[_];a[_]=S;var g=c[_].getComponentInChildren(cc.Animation),b=g.getClips()[S];g.play(b.name)}if(u[_]!=p[_]&&c[_]){var C=p[_];u[_]=C,c[_].scaleX=C?1:-1}}}catch(R){t={error:R}}finally{try{v&&!v.done&&(e=m.return)&&e.call(m)}finally{if(t)throw t.error}}},e.prototype.UpdatePos=function(){var t,e,r=this.comGraph,o=this.prefab,n=this.visible,i=this.nextVisible,a=r.x,s=r.y;try{for(var c=l(this.ids),u=c.next();!u.done;u=c.next()){var p=u.value;if(n[p]!=i[p]&&o[p]){var f=i[p];n[p]=i[p],o[p].active=f}var h=o[p];h&&h.setPosition(a[p],s[p])}}catch(y){t={error:y}}finally{try{u&&!u.done&&(e=c.return)&&e.call(c)}finally{if(t)throw t.error}}},e.__cname="ComSpirte",e}(_),Q=(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}n(e,t),e.prototype.Init=function(){this.systemSprite=this.world.getSystem(Q)},e.prototype.Update=function(t){if(this.dirty){this.dirty=!1;var e=this.param,r=this.nextParam;e.path,r.path}this.onUpdate(t)},e.prototype.MarkDirty=function(){this.dirty=!0},e.prototype.onInit=function(){},e.prototype.onUpdate=function(){}}(u.ScriptObject),function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ids=new Set,e.count=0,e.list=[],e.tmEntity2Index=new Map,e}return n(e,t),e.prototype.onInit=function(){var t=cc.director.getScene().getChildByName("Canvas"),e=new cc.Node;t.addChild(e,-1,"SystemSprite"),this.root=e,this.path=this.world.assetsPath,this.comGraph=this.world.getCom(R),this.comSprite=this.world.getCom(Z),this.systemRole=this.world.getSystem(B)},e.prototype.onDestroy=function(){},e.prototype.onStart=function(){},e.prototype.onExit=function(){},e.prototype.onUpdate=function(){var t,e,r=this.comGraph,o=this.comSprite,n=r.moving,i=r.active,a=r.direction,s=(o.anim,o.nextAnim),c=o.nextVisible,u=o.nextIsRight;try{for(var p=l(o.ids),f=p.next();!f.done;f=p.next()){var h=f.value,y=a[h]%360,d=Math.PI/2,m=-d<y&&y<d;u[h]=m,c[h]=i[h],s[h]=n[h]?1:0}}catch(v){t={error:v}}finally{try{f&&!f.done&&(e=p.return)&&e.call(p)}finally{if(t)throw t.error}}o.UpdateState(),o.UpdatePos()},e.__cname="SystemSprite",e}(S));cc._RF.pop()},{"../../framework/base/ScriptObject":void 0,"../../framework/layer/common/UIMgr":void 0,"../../framework/utils/Toolset":void 0,"../utils/MathUtil":"MathUtil"}],TestGloader:[function(t,e,r){"use strict";cc._RF.push(e,"ca745cbcgJMX52wMgvbB7UN","TestGloader");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerTestGloaderUI=r.LayerTestGloader=r.TestGloader=void 0;var s=t("../../framework/container/Container"),c=t("../../framework/layer/common/UIOrder"),u=t("../game/ui/GameLayer"),p=t("../../framework/FW"),f=function(){function t(){}return t.Test=function(){s.Container.inst().getByAlias("CtrlGM").LayerTestGloader.load()},t.__cname="TestGloader",t}();r.TestGloader=f;var h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return y},e.prototype.getUrl=function(){return"ui://GM/\u7ec4\u4ef6_\u6d4b\u8bd5Gloader"},e.prototype.getSortOrder=function(){return c.LayerOrder.OneLevel},e.__cname="LayerTestGloader",e}(u.GameLayerProxy);r.LayerTestGloader=h;var y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getHasBackground=function(){return!0},e.prototype.initAsync=function(){return a(this,void 0,Promise,function(){return l(this,function(t){switch(t.label){case 0:return[4,this.Ref.RefMgritem.preloadRef()];case 1:return t.sent(),[4,this.Ref.RefMgricon.preloadRef()];case 2:return t.sent(),[2]}})})},e.prototype.init=function(){this.com.toFullCenterParent(this.container),this.com.tm("btn_i_http").setClick(this.updateByHttp,this),this.com.tm("btn_u_http").setClick(this.clearByHttp,this),this.com.tm("btn_i_ui").setClick(this.updateByUIIcon,this),this.com.tm("btn_u_ui").setClick(this.clearByUIIcon,this),this.com.tm("btn_close").setClick(this.unload,this)},e.prototype.release=function(){},e.prototype.enter=function(){},e.prototype.exit=function(){},e.prototype.update=function(){},e.prototype.updateByHttp=function(){var t=this.com.tm("list");t.init(this,function(t,e){e.tm("icon").SetUrl("http://localhost/blcx/\u6d4b\u8bd5.png?"+t)}),t.update(new Array(10).fill(0))},e.prototype.clearByHttp=function(){this.com.tm("list").clear(),setTimeout(function(){cc.sys.garbageCollect()},100)},e.prototype.updateByUIIcon=function(){var t=this.com.tm("list"),e=["ui://\u8d27\u5e01\u8d44\u6e90/\u767b\u5f55_\u767b\u9646\u80cc\u666f\u56fe"],r=this.Ref.RefMgritem.getRef("resId",201640),o=this.Ref.RefMgricon.getRef("key",r.icon);e.push(o.path),t.init(this,function(t,r){var o=r.tm("icon"),n=e[t%e.length];o.SetUrl(n)}),t.update(new Array(10).fill(0))},e.prototype.clearByUIIcon=function(){this.com.tm("list").clear(),setTimeout(function(){p.FW.FairyMgr.removeUnUsed()},100)},e.__cname="LayerTestGloaderUI",i([s.injectField("Ref")],e.prototype,"Ref",void 0),e}(u.GameLayerUI);r.LayerTestGloaderUI=y,cc._RF.pop()},{"../../framework/FW":void 0,"../../framework/container/Container":void 0,"../../framework/layer/common/UIOrder":void 0,"../game/ui/GameLayer":"GameLayer"}],TestGobjGoods:[function(t,e,r){"use strict";cc._RF.push(e,"869c6+w9JtARIcYqiWhfE3b","TestGobjGoods");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.LayerTestGobjGoodsUI=r.LayerTestGobjGoods=r.TestGobjGoods=void 0;var s=t("../../framework/container/Container"),c=t("../../framework/layer/common/UIOrder"),u=t("../../framework/utils/Toolset"),p=t("../game/model/vo/Goods/Goods"),f=t("../game/ui/GameLayer"),h=function(){function t(){}return t.Test=function(){s.Container.inst().getByAlias("CtrlGM").LayerTestGobjGoods.load()},t.__cname="TestGobjGoods",t}();r.TestGobjGoods=h;var y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return d},e.prototype.getUrl=function(){return"ui://GM/\u7ec4\u4ef6_\u6d4b\u8bd5GObjGoods"},e.prototype.getSortOrder=function(){return c.LayerOrder.OneLevel},e.prototype.getRef=function(){return this.Ref},e.__cname="LayerTestGobjGoods",i([s.injectField("Ref")],e.prototype,"Ref",void 0),e}(f.GameLayerProxy);r.LayerTestGobjGoods=y;var d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getHasBackground=function(){return!0},e.prototype.initAsync=function(){return a(this,void 0,Promise,function(){return l(this,function(t){switch(t.label){case 0:return[4,this.proxy.getRef().RefMgritem.preloadRef()];case 1:return t.sent(),[2]}})})},e.prototype.init=function(){var t=this;this.com.toFullCenterParent(this.container),this.toolSet=u.ToolSet.createToolSet(),this.voSubset=this.ModelVO.VOItemBag.CreateSubset(),this.voSubset.SetFilter(function(t){return t.GetGoodsType()==p.EGoodsType.normal||t.GetGoodsType()==p.EGoodsType.equipMaterial}),this.toolSet.addDefer(function(){t.ModelVO.VOItemBag.DestroySubset(t.voSubset),t.voSubset=null}),this.toolSet.addListener(this.voSubset.GetEventProxy(),"OnChanged",function(){t.updateList()}),this.com.tm("btn_start").setClick(this.updateList,this),this.com.tm("btn_clean").setClick(this.cleanList,this),this.com.tm("btn_close").setClick(this.unload,this)},e.prototype.release=function(){this.toolSet&&(u.ToolSet.destroyToolSet(this.toolSet),this.toolSet=null)},e.prototype.enter=function(){},e.prototype.exit=function(){},e.prototype.update=function(){},e.prototype.updateList=function(){var t=this.voSubset.GetTlVO(),e=this.com.tm("list");e.init(this,function(t,e,r){var o=e.tm("com_goods"),n=r;o.UpdateByGoods(n);var i=o.GetBehavior();i.onTitleVisible(!0),i.onNumberVisible(!0)}),e.update(t)},e.prototype.cleanList=function(){this.com.tm("list").clear()},e.__cname="LayerTestGobjGoodsUI",i([s.injectField("ModelVO")],e.prototype,"ModelVO",void 0),i([s.injectField("ModelGoods")],e.prototype,"ModelGoods",void 0),e}(f.GameLayerUI);r.LayerTestGobjGoodsUI=d,cc._RF.pop()},{"../../framework/container/Container":void 0,"../../framework/layer/common/UIOrder":void 0,"../../framework/utils/Toolset":void 0,"../game/model/vo/Goods/Goods":"Goods","../game/ui/GameLayer":"GameLayer"}],TestHttp:[function(t,e,r){"use strict";cc._RF.push(e,"3de5dGOh+BHlqVhYRgPkIaL","TestHttp");var o=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},n=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.TestHttp=void 0;var i=t("../../framework/utils/HttpLoader"),a=function(){function t(){}return t.Test=function(){this.TestAsync()},t.TestAsync=function(){return o(this,void 0,void 0,function(){var t,e,r;return n(this,function(o){switch(o.label){case 0:return t={},r=function(){console.log(t)},(e=function(e){var r=cc.director.getTotalTime();null==t[e]?t[e]=r:t[e]=r-t[e]})("texture"),[4,new Promise(function(t){i.HttpLoader.RequestTexture("http://localhost/blcx/\u6d4b\u8bd5.png").then(function(e){t(e)})})];case 1:return o.sent(),e("texture"),e("json"),[4,new Promise(function(t){i.HttpLoader.RequestJson("http://localhost/blcx/\u6d4b\u8bd5.json").then(function(e){t(e)})})];case 2:return o.sent(),e("json"),e("audio"),[4,new Promise(function(t){i.HttpLoader.RequestAudioClip("http://localhost/blcx/\u6d4b\u8bd5.mp3").then(function(e){t(e)})})];case 3:return o.sent(),e("audio"),e("text"),[4,new Promise(function(t){i.HttpLoader.RequestText("http://localhost/blcx/\u6d4b\u8bd5.txt").then(function(e){t(e)})})];case 4:return o.sent(),e("text"),r(),[2]}})})},t.__cname="TestHttp",t}();r.TestHttp=a,cc._RF.pop()},{"../../framework/utils/HttpLoader":void 0}],TestJSBridge:[function(t,e,r){"use strict";cc._RF.push(e,"47fbfMXVUJBVbMBOknyKCx+","TestJSBridge");var o=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},n=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.TestJSBridge=void 0;var i=t("../../framework/coroutine/Cor"),a=t("../../framework/FW"),l=t("../../framework/utils/Toolset"),s=t("../bridge/AppBridge"),c=function(){function t(){}return t.Test=function(){var t=this,e=new i.Cor,r=l.ToolSet.createToolSet();r.addDefer(function(){e&&e.destroy()}),r.addUpdateFrame(function(){e.Update()});var c=function(t){a.FW.Log.log(t)};e.Resume(function(){return o(t,void 0,void 0,function(){var t,o,a,u;return n(this,function(n){switch(n.label){case 0:return[4,i.Cor.WaitTime_cor(e,1)];case 1:return n.sent(),t=s.AppBridge.GetSDKInited(),c(""+t),[4,i.Cor.WaitTime_cor(e,1)];case 2:return n.sent(),c("\u767b\u5f55\u4e2d"),o=null,s.AppBridge.SDKLogin(1,"123","123",function(t){t=t||!1}),[4,i.Cor.WaitUntil_cor(e,function(){return null!=o})];case 3:return n.sent(),c("\u767b\u5f55\u56de\u8c03"+o),0==o?(c("\u767b\u5f55\u5931\u8d25"),[2]):(a=!1,s.AppBridge.ShowAlert("\u767b\u5f55\u7ed3\u679c:",""+o,function(){a=!0}),[4,i.Cor.WaitUntil_cor(e,function(){return a})]);case 4:return n.sent(),c("\u5df2\u767b\u5f55"),[4,i.Cor.WaitTime_cor(e,1)];case 5:n.sent(),u=5,n.label=6;case 6:return u>=0?(c("\u5df2\u767b\u5f55, "+u+"\u79d2\u540e\u6ce8\u9500"),[4,i.Cor.WaitTime_cor(e,1)]):[3,8];case 7:return n.sent(),u--,[3,6];case 8:return s.AppBridge.SDKLogout(function(t){c(t?"\u5df2\u6ce8\u9500":"\u6ce8\u9500\u5931\u8d25")}),l.ToolSet.destroyToolSet(r),[2]}})})})},t.__cname="TestJSBridge",t}();r.TestJSBridge=c,cc._RF.pop()},{"../../framework/FW":void 0,"../../framework/coroutine/Cor":void 0,"../../framework/utils/Toolset":void 0,"../bridge/AppBridge":"AppBridge"}],TestPhysis:[function(t,e,r){"use strict";cc._RF.push(e,"df158oA65RAmJtFybEGrP/o","TestPhysis");var o=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.TestPhysis=void 0;var n=t("../../framework/layer/common/UIMgr"),i=function(){function t(){}return t.Test=function(){n.UIMgr.instance.unLoadAll(!0);var t=cc.director.getScene().getChildByName("Canvas"),e=new cc.Node;t.addChild(e);var r=e.addComponent(cc.Graphics);new u(r)},t.__cname="TestPhysis",t}();r.TestPhysis=i;var a=function(){function t(t,e){this.x=[],this.y=[],this.r=[],this.mass=[],this.cr=[],this.spd=[],this.vx=[],this.vy=[],this.vgx=[],this.vgy=[],this.colliding=[],this.ids=[],this._i=0,this.g=t,this.gameboard=e}return t.prototype.createOne=function(t,e,r,o,n,i,a,l){void 0===a&&(a=1),void 0===l&&(l=c);var s=this._i++;return this.ids.push(s),this.x[s]=t,this.y[s]=e,this.vx[s]=o,this.vy[s]=n,this.vgx[s]=o,this.vgy[s]=n,this.r[s]=r,this.colliding[s]=0,this.mass[s]=a,this.spd[s]=i,this.cr[s]=l,s},t.prototype.updateGravity=function(t,e){var r=this.gameboard.ComPlayer.x,o=this.gameboard.ComPlayer.y,n=this.spd,i=this.x,a=this.y,l=new cc.Vec2(r,o),s=new cc.Vec2(i[e],a[e]),c=l.sub(s).normalize();this.vgx[e]=c.x*n[e],this.vgy[e]=c.y*n[e],this.vx[e]=cc.misc.lerp(this.vx[e],this.vgx[e],t),this.vy[e]=cc.misc.lerp(this.vy[e],this.vgy[e],t)},t.prototype.updatePos=function(t,e){var r=this.x,o=this.y,n=this.vx,i=this.vy,a=(this.colliding,this.gameboard.ComPlayer.x),l=this.gameboard.ComPlayer.y;(a+r[e])*(a+r[e])+(l+o[e])*(l+o[e])<1e4?(r[e]=6*(r[e]-a),o[e]=6*(o[e]-l)):(r[e]+=n[e]*t,o[e]+=i[e]*t)},t.prototype.updateView=function(t){var e=this.g,r=this.x,o=this.y,n=this.r,i=this.colliding;e.strokeColor=i[t]?cc.Color.ORANGE:cc.Color.CYAN,e.circle(r[t],o[t],n[t]),e.stroke()},t.prototype.isCircleCollided=function(t,e){var r=this.x,o=this.y,n=this.r,i=(n[t]+n[e])*(n[t]+n[e]),a=r[e]-r[t],l=o[e]-o[t];return a*a+l*l<=i},t.prototype.checkCollideWidth=function(t,e){var r=this.colliding;this.isCircleCollided(t,e)&&(r[t]=1,r[e]=1,this.changeVelocityAndDirection(t,e))},t.prototype.resetCollide=function(){var t,e,r=this.colliding;try{for(var n=o(this.ids),i=n.next();!i.done;i=n.next())r[i.value]=0}catch(a){t={error:a}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}},t.prototype.changeVelocityAndDirection=function(t,e){var r=this.vx,o=this.vy,n=this.x,i=this.y,a=this.mass,l=this.cr,s=(this.r,new cc.Vec2(r[t],o[t])),c=new cc.Vec2(r[e],o[e]),u=new cc.Vec2(n[t]-n[e],i[t]-i[e]),p=(u.mag(),u.normalize()),f=new cc.Vec2(-p.y,p.x),h=s.dot(p),y=s.dot(f),d=c.dot(p),m=c.dot(f),v=Math.min(l[e],l[t]),_=(a[t]*h+a[e]*d+a[e]*v*(d-h))/(a[t]+a[e]),S=(a[t]*h+a[e]*d+a[t]*v*(h-d))/(a[t]+a[e]);if(!(_<S)){var g=p.mul(_),b=f.mul(y).mul(1),C=p.mul(S),R=f.mul(m).mul(1),M=g.add(b),w=C.add(R);r[t]=M.x,o[t]=M.y,r[e]=w.x,o[e]=w.y}},t}(),l=function(){this.sw=cc.Camera.main.node.width,this.sh=cc.Camera.main.node.height,this.x=-this.sw/2,this.y=-this.sh/2},s=function(){var t=this;this.x=0,this.y=0,cc.Camera.main.node.on(cc.Node.EventType.MOUSE_DOWN,function(e){var r=cc.Camera.main.node.width,o=cc.Camera.main.node.height,n=new cc.Vec2(e.getLocationX(),e.getLocationY());n.x-=r/2,n.y-=o/2;var i=cc.Camera.main.node.convertToWorldSpace(n);t.x=i.x,t.y=i.y,console.log(t.x,t.y)}),cc.Camera.main.node.on(cc.Node.EventType.MOUSE_MOVE,function(){}),cc.Camera.main.node.on(cc.Node.EventType.MOUSE_UP,function(){})},c=.8,u=function(){function t(t){this.g=t,this.ComCircle=new a(t,this),this.ComMap=new l,this.ComPlayer=new s,this.initCircle(),this.startUpdate()}return t.prototype.startUpdate=function(){var t,e=this.update.bind(this),r=function(o){t||(t=o);var n=(o-t)/1e3;t=o,e(n),window.requestAnimationFrame(r)};window.requestAnimationFrame(r)},t.prototype.initCircle=function(){for(var t=this,e=(this.ComMap.sw,this.ComMap.sh,this.ComMap.x,this.ComMap.y,0);e<500;e++){var r=2*Math.random()*Math.PI,o=300*Math.random(),n=Math.cos(r)*(600+o),i=Math.sin(r)*(600+o),a=5*Math.random()+10,l=a,s=r+Math.PI,u=50*Math.cos(s),p=50*Math.sin(s),f=.1*(Math.random()-.5)*c+c;this.ComCircle.createOne(n,i,a,u,p,50,l,f)}setTimeout(function(){for(var e=0;e<300;e++){var r=2*Math.random()*Math.PI,o=600*Math.random(),n=Math.cos(r)*(600+o),i=Math.sin(r)*(600+o),a=5*Math.random()+5,l=r+Math.PI,s=150*Math.cos(l),u=150*Math.sin(l),p=.2*(Math.random()-.5)+c;t.ComCircle.createOne(n,i,a,s,u,150,30,p)}},1e3)},t.prototype.update=function(t){var e,r,n,i,a,l,s=this.g,c=this.ComCircle;s.clear(),s.lineWidth=3;try{for(var u=o(c.ids),p=u.next();!p.done;p=u.next()){var f=p.value;c.updatePos(t,f)}}catch(v){e={error:v}}finally{try{p&&!p.done&&(r=u.return)&&r.call(u)}finally{if(e)throw e.error}}try{for(var h=o(c.ids),y=h.next();!y.done;y=h.next())f=y.value,c.updateGravity(t,f)}catch(_){n={error:_}}finally{try{y&&!y.done&&(i=h.return)&&i.call(h)}finally{if(n)throw n.error}}this.checkCollision();try{for(var d=o(c.ids),m=d.next();!m.done;m=d.next())f=m.value,c.updateView(f)}catch(S){a={error:S}}finally{try{m&&!m.done&&(l=d.return)&&l.call(d)}finally{if(a)throw a.error}}},t.prototype.checkCollision=function(){var t=this.ComCircle;t.resetCollide();for(var e=t.ids,r=0;r<e.length;r++)for(var o=r+1;o<e.length;o++)this.ComCircle.checkCollideWidth(r,o)},t.prototype.checkEdgeCollision=function(){var t,e,r=this.ComCircle,n=r.x,i=r.y,a=r.vx,l=r.vy,s=r.r,u=this.ComMap.x,p=this.ComMap.y,f=this.ComMap.sw,h=this.ComMap.sh;try{for(var y=o(r.ids),d=y.next();!d.done;d=y.next()){var m=d.value;n[m]<u+s[m]?(a[m]=-a[m]*c,n[m]=u+s[m]):u+f-s[m]<n[m]&&(a[m]=-a[m]*c,n[m]=u+f-s[m]),i[m]<p+s[m]?(l[m]=-l[m]*c,i[m]=p+s[m]):p+h-s[m]<i[m]&&(l[m]=-l[m]*c,i[m]=p+h-s[m])}}catch(v){t={error:v}}finally{try{d&&!d.done&&(e=y.return)&&e.call(y)}finally{if(t)throw t.error}}},t}();cc._RF.pop()},{"../../framework/layer/common/UIMgr":void 0}],TestPopupPanel:[function(t,e,r){"use strict";cc._RF.push(e,"a8ceadkXxBBP7oqgPnFA8w0","TestPopupPanel");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.LayerTestPopupPanelUI=r.LayerTestPopupPanel=r.TestPopupPanel=void 0;var i=t("../../framework/container/Container"),a=t("../../framework/layer/common/UIOrder"),l=t("../game/ctrl/alert/PanelPopInfo"),s=t("../game/ui/GameLayer"),c=function(){function t(){}return t.Test=function(){i.Container.inst().getByAlias("CtrlGM").LayerTestPopupPanel.load()},t.__cname="TestPopupPanel",t}();r.TestPopupPanel=c;var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getUIClass=function(){return p},e.prototype.getUrl=function(){return"ui://GM/\u7ec4\u4ef6_\u6d4b\u8bd5\u5f39\u7a97"},e.prototype.getSortOrder=function(){return a.LayerOrder.OneLevel},e.__cname="LayerTestPopupPanel",e}(s.GameLayerProxy);r.LayerTestPopupPanel=u;var p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getHasBackground=function(){return!0},e.prototype.init=function(){this.com.toFullCenterParent(this.container),this.com.tm("panel.btn_close").setClick(this.unload,this),this.updateList()},e.prototype.updateList=function(){var t=this,e=[{title:"\u6d4b\u8bd5\u6c14\u6ce1\u5f39\u7a97",click:function(e,r){var o=new Array(1+e%4).fill("\u6d4b\u8bd5\u591a\u884c\u6587\u672c").join("\n"),n=t.proxy.addPanel(l.PanelPopInfo);n.SetParent(r.asCom),n.SetTitle("\u6807\u9898"),n.SetTitleVisible(!0),n.SetContent(o),n.SetShowArrow(!0)}}],r=this.com.tm("list");r.init(this,function(t,r){var o=e[t%e.length];r.asButton.title=o.title},function(t,r){var o=e[t%e.length];o.click(t,r,o)}),r.update2(12)},e.__cname="LayerTestPopupPanelUI",e}(s.GameLayerUI);r.LayerTestPopupPanelUI=p,cc._RF.pop()},{"../../framework/container/Container":void 0,"../../framework/layer/common/UIOrder":void 0,"../game/ctrl/alert/PanelPopInfo":"PanelPopInfo","../game/ui/GameLayer":"GameLayer"}],TestPromise:[function(t,e,r){"use strict";cc._RF.push(e,"51d2c23ww1HRIZ3N44wT6o/","TestPromise");var o=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},n=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.TestPromise=void 0;var i=t("../../framework/FW"),a=function(t){void 0===t&&(t=""),cc.log("["+cc.director.getTotalTime()+"]: "+t)},l=function(){function t(){}return t.Test=function(){this.TestAsync()},t.TestAsync=function(){return o(this,void 0,void 0,function(){var t,e;return n(this,function(r){switch(r.label){case 0:return a("======================= \u6d4b\u8bd5\u56de\u8c03"),(t=this.GeneratePromiseAsync()).then(function(t){a("\u5916\u90e8then\u56de\u8c03: "+t)}),[4,t];case 1:return e=r.sent(),a("await \u56de\u8c03: "+e),a("======================= End"),a("======================= async\u662fpromise\u7684\u8bed\u6cd5\u7cd6"),a("async"),[4,this.GenerateCandyAsync()];case 2:return r.sent(),a("promise"),[4,this.GenerateCandyPromise()];case 3:return r.sent(),a("======================= async\u662fpromise\u7684\u8bed\u6cd5\u7cd6"),a("======================= \u7b49\u5f85\u4e00\u5e27"),[4,i.FW.Task.delayFrame(1)];case 4:return r.sent(),a("======================= End"),a("======================= \u7b49\u5f85\u4e00\u79d2"),[4,i.FW.Task.delay(1e3)];case 5:return r.sent(),a("======================= End"),a("======================= \u7b49\u5f85\u6761\u4ef6\u4e3atrue\u65f6\u8fd4\u56de"),[4,this.GeneratePromiseWhileAsync()];case 6:return r.sent(),a("======================= End"),[2]}})})},t.GenerateCandyAsync=function(){return o(this,void 0,Promise,function(){return n(this,function(t){switch(t.label){case 0:return[4,i.FW.Task.delay(1e3)];case 1:return t.sent(),[4,i.FW.Task.delay(1e3)];case 2:return t.sent(),[2]}})})},t.GenerateCandyPromise=function(){return new Promise(function(t){i.FW.Task.delay(1e3).then(function(){i.FW.Task.delay(1e3).then(function(){t()})})})},t.GeneratePromiseAsync=function(){var t=new Promise(function(t){i.FW.Task.delay(1e3).then(function(){t(!0)})});return t.then(function(t){a("\u5185\u90e8then\u56de\u8c03: "+t)}),t},t.GeneratePromiseWhileAsync=function(){return new Promise(function(){var t,e,r,o=!1;t=function(t){a("doWhile\u7ed3\u679c:"+t),o=t},e=0,r=setInterval(function(){3==++e?(t(!0),clearInterval(r)):t(!1)},1e3);var n=i.FW.Task.waitUntil(function(){return o});return n.then(function(){a("waitSuccess")}),n})},t.__cname="TestPromise",t}();r.TestPromise=l,cc._RF.pop()},{"../../framework/FW":void 0}],TestQuickSort:[function(t,e,r){"use strict";cc._RF.push(e,"14ca7ZQ92hB1q4wEAt3RP54","TestQuickSort");var o=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.TestQuickSort=void 0;var n=t("../utils/MathUtil"),i=function(){function t(){}return t.Test=function(){this.test1()},t.test2=function(){n.MathUtil.quickSort([7,6,9,2,5])},t.test1=function(){var t=new Map,e=function(e){var r=cc.director.getTotalTime(),o=t.get(e);null==o?(o={l:r,t:0},t.set(e,o)):(o.t+=r-o.l,o.l=r)},r=function(t){var e,r,n=null;try{for(var i=o(t),a=i.next();!a.done;a=i.next()){var l=a.value;if(null!=n){if(n>l)return!1;n=l}else n=l}}catch(s){e={error:s}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return!0},i=[];e("quicksortarr");for(var a=0;a<1;a++){var l=new Array(1048576).fill(0).map(function(){return Math.round(100*Math.random())});i.push(l)}for(e("quicksortarr"),e("quicksort"),a=0;a<1;a++)n.MathUtil.quickSort(i[a]);e("quicksort"),e("quickcheck");var s=0;for(a=0;a<1;a++)r(i[a])&&s++;for(console.log("quick correct :"+s),e("quickcheck"),i=[],e("sortarr"),a=0;a<1;a++)l=new Array(1048576).fill(0).map(function(){return Math.round(100*Math.random())}),i.push(l);for(e("sortarr"),e("sort"),a=0;a<1;a++)i[a].sort(function(t,e){return t-e});e("sort"),console.log(t)},t.__cname="TestQuickSort",t}();r.TestQuickSort=i,cc._RF.pop()},{"../utils/MathUtil":"MathUtil"}],TestRef:[function(t,e,r){"use strict";cc._RF.push(e,"c90e8Yk0m9EKpnf4hELj1bF","TestRef"),Object.defineProperty(r,"__esModule",{value:!0}),r.TestRef=void 0;var o=t("../../framework/cache/GameCache"),n=t("../../framework/container/Container"),i=t("../../framework/utils/Toolset"),a=function(){function t(){}return t.Test=function(){this.testLoadRef(),this.testVO()},t.testLoadRef=function(){var t=n.Container.inst().getByAlias("Ref");cc.log("\u5c1d\u8bd5\u8bfb\u53d6\u914d\u7f6e\u8868"),t.RefMgrgameRule.preloadRef().then(function(){var e=t.RefMgrgameRule.getRef("key","banditRule");cc.log(e)})},t.testVO=function(){var t=n.Container.inst().getByAlias("ModelVO"),e=i.ToolSet.createToolSet(),r=t.VOItemBag.CreateSubset();r.SetFilter(function(){return!0}),e.addListener(r.GetEventProxy(),"OnChanged",function(){var t=r.GetTlVO();console.log("\u80cc\u5305\u6240\u6709VO"),console.log(t),console.log("\u5c55\u793a\u6570\u636e"),console.log(t.map(function(t){return"["+t.GetId()+"]:"+t.GetNumber()}).join())}),e.addDefer(function(){console.log("\u9500\u6bc1subset"),t.VOItemBag.DestroySubset(r)}),this.startServer(e,function(){i.ToolSet.destroyToolSet(e)})},t.startServer=function(t,e){var r=n.Container.inst().getByAlias("CacheMgr").getCache("CmdRole"),i=0,a={id:301,number:i};t.addTimer(1e3,function(){if(++i>10)return console.log("\u6a21\u62df\u670d\u52a1\u5173\u95ed"),void e();a.number=i,r.eventProxy.execute(o.EventType.onUpdate,a,{number:!0})})},t.__cname="TestRef",t}();r.TestRef=a,cc._RF.pop()},{"../../framework/cache/GameCache":void 0,"../../framework/container/Container":void 0,"../../framework/utils/Toolset":void 0}],TestSocket:[function(t,e){"use strict";cc._RF.push(e,"033ffKGaudB3YoKNtbbB0U5","TestSocket"),cc._RF.pop()},{}],TimeUtil:[function(t,e,r){"use strict";cc._RF.push(e,"c41f9uy4o9Oh4k1ivT01gd9","TimeUtil");var o=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.TimeUtil=void 0;var n=t("../../framework/FW"),i=t("../../framework/container/Container"),a=t("../../framework/utils/StringUtil"),l=function(){function t(){this.S_DayTime=86400,this.S_WeekTime=604800,this.localTimeDifference=0,this._timeData={h:0,m:0,s:0}}return t.prototype.now=function(){return this.ModelTime.getServerTime()},t.prototype.LocalNow=function(){return.001*Date.now()},t.prototype.timeSec2HMS=function(t){t<0&&(t=0);var e=Math.floor(t/3600);e>0&&(t-=3600*e);var r=Math.floor(t/60);r>0&&(t-=60*r),t=Math.floor(t);var o=this._timeData;return o.h=e,o.m=r,o.s=t,o},t.prototype.timeMillisecond2HMSStr=function(t){return this.timeSec2HMSStr(Math.ceil(.001*t))},t.prototype.timeSec2HMSStr=function(t){var e=this.timeSec2HMS(t),r=(e.h<10?"0":"")+e.h,o=(e.m<10?"0":"")+e.m,n=(e.s<10?"0":"")+e.s;return a.StringUtil.format("{0}:{1}:{2}",r,o,n)},t.prototype.timeSec2HMSStr2=function(t){var e=this.timeSec2HMS(t),r=Math.floor(e.h/24),o=e.h%24,i=(o<10?"0":"")+o,l=(e.m<10?"0":"")+e.m,s=(e.s<10?"0":"")+e.s;return r>0?a.StringUtil.format(n.FW.G_W("{0}\u5929{1}:{2}:{3}"),r,i,l,s):a.StringUtil.format("{0}:{1}:{2}",i,l,s)},t.prototype.timeSec2HMSStr3=function(t){var e=this.timeSec2HMS(t),r=Math.floor(e.h/24),o=e.h%24,i=(o<10?"0":"")+o,l=(e.m<10?"0":"")+e.m;return r>0?a.StringUtil.format(n.FW.G_W("{0}\u5929{1}\u5c0f\u65f6{2}\u5206\u524d"),r,i,l):a.StringUtil.format(n.FW.G_W("{0}\u5c0f\u65f6{1}\u5206\u524d"),i,l)},t.prototype.timeSec2HMSStr4=function(t,e){void 0===e&&(e=!1);var r=this.timeSec2HMS(t),o=Math.floor(r.h/24),i=r.h%24,l=(i<10?"0":"")+i,s=(r.m<10?"0":"")+r.m,c=(r.s<10?"0":"")+r.s;return o>0&&e?a.StringUtil.format(n.FW.G_W("{0}\u5929{1}:{2}:{3}"),o,l,s,c):a.StringUtil.format("{0}:{1}:{2}",l,s,c)},t.prototype.timeSec2MSStr=function(t){var e=this.timeSec2HMS(t),r=(e.m<10?"0":"")+e.m,o=(e.s<10?"0":"")+e.s;return a.StringUtil.format("{0}:{1}",r,o)},t.prototype.timeSec2HMSStr5=function(t){var e=this.timeSec2HMS(t),r=Math.floor(e.h/24),o=e.h%24;return r>0?a.StringUtil.format(n.FW.G_W("{0}\u5929\u524d"),r):o>0?a.StringUtil.format(n.FW.G_W("{0}\u5c0f\u65f6\u524d"),o):e.m>0?a.StringUtil.format(n.FW.G_W("{0}\u5206\u949f\u524d"),e.m):a.StringUtil.format(n.FW.G_W("{0}\u79d2\u524d"),e.s)},t.prototype.timeSec2HMSStr6=function(t){var e=this.timeSec2HMS(t),r=Math.floor(e.h/24),o=e.h%24;return r>0?a.StringUtil.format(n.FW.G_W("{0}\u5929"),r):o>0?a.StringUtil.format(n.FW.G_W("{0}\u5c0f\u65f6"),o):e.m>0?a.StringUtil.format(n.FW.G_W("{0}\u5206\u949f"),e.m):a.StringUtil.format(n.FW.G_W("{0}\u79d2"),e.s)},t.prototype.timeSec2HMSStr7=function(t){var e=this.timeSec2HMS(t),r=Math.floor(e.h/24),o=e.h%24,i=(o<10?"0":"")+o;return r>0?a.StringUtil.format(n.FW.G_W("{0}\u5929{1}\u5c0f\u65f6"),r,i):a.StringUtil.format("{0}\u5c0f\u65f6",i)},t.prototype.timeSec2HMSStr8=function(t){var e=this.timeSec2HMS(t),r=Math.floor(e.h/24),o=e.h%24,i=(o<10?"0":"")+o,l=e.m;return r>0?a.StringUtil.format(n.FW.G_W("{0}\u5929{1}\u5c0f\u65f6{2}\u5206\u949f"),r,i,l):o>0?a.StringUtil.format("{0}\u5c0f\u65f6{1}\u5206\u949f",i,l):a.StringUtil.format("{0}\u5206\u949f",l)},t.prototype.timeSec2HMSStr9=function(t){var e=this.timeSec2HMS(t),r=Math.floor(e.h/24),o=e.h%24,i=(o<10?"0":"")+o,l=(e.m<10?"0":"")+e.m;return r>0?a.StringUtil.format(n.FW.G_W("{0}\u5929{1}\u5c0f\u65f6{2}\u5206\u949f"),r,i,l):a.StringUtil.format("{0}\u5c0f\u65f6{1}\u5206\u949f",i,l)},t.prototype.timeSec2HMSStr10=function(t){var e=this.timeSec2HMS(t),r=(e.h<10?"0":"")+e.h,o=(e.m<10?"0":"")+e.m,i=(e.s<10?"0":"")+e.s;return e.h>0?a.StringUtil.format(n.FW.G_W("{0}\u65f6{1}\u5206"),r,o):a.StringUtil.format(n.FW.G_W("{0}\u5206{1}\u79d2"),o,i)},t.prototype.timeSec2HMSStr11=function(t){var e=this.now(),r=.001*this.getNextDay12(e,!0);if(t){var o=new Date(1e3*e).getDay(),i=.001*this.getNextDay12(e,!0);r=i+=this.S_DayTime*(7-o)}var l=r-e,s=this.timeSec2HMS(l),c=Math.floor(s.h/24),u=(c<10?"0":"")+c,p=s.h%24,f=(p<10?"0":"")+p,h=(s.m<10?"0":"")+s.m,y=(s.s<10?"0":"")+s.s;return c>0?a.StringUtil.format(n.FW.G_W("{0}\u5929{1}\u65f6"),u,f):p>0?a.StringUtil.format(n.FW.G_W("{0}\u65f6{1}\u5206"),f,h):a.StringUtil.format(n.FW.G_W("{0}\u5206{1}\u79d2"),h,y)},t.prototype.timeSec2HMSStr12=function(t){var e,r=this.now(),o=new Date(1e3*r);if(0==t)e=.001*this.getNextDay12(r,!0)-r;else if(1==t){var i=o.getDay(),l=.001*this.getNextDay12(r,!0);e=(l+=this.S_DayTime*(7-i))-r}else if(2==t){var s=o.getFullYear(),c=o.getMonth()+1;c>=12&&(c=1,s+=1),e=(l=.001*new Date(s,c,0).getTime())-r}if(e){var u=this.timeSec2HMS(e),p=((i=Math.floor(u.h/24))<10?"0":"")+i,f=u.h%24,h=(f<10?"0":"")+f,y=(u.m<10?"0":"")+u.m,d=(u.s<10?"0":"")+u.s;return i>0?a.StringUtil.format(n.FW.G_W("{0}\u5929{1}\u65f6"),p,h):f>0?a.StringUtil.format(n.FW.G_W("{0}\u65f6{1}\u5206"),h,y):a.StringUtil.format(n.FW.G_W("{0}\u5206{1}\u79d2"),y,d)}return""},t.prototype.timeSec2HMSStr13=function(t){var e=this.timeSec2HMS(t),r=Math.floor(e.h/24),o=(r<10?"0":"")+r,i=e.h%24,l=(i<10?"0":"")+i,s=(e.m<10?"0":"")+e.m,c=(e.s<10?"0":"")+e.s;return r>0?a.StringUtil.format(n.FW.G_W("{0}\u5929{1}\u65f6"),o,l):i>0?a.StringUtil.format(n.FW.G_W("{0}\u65f6{1}\u5206"),l,s):a.StringUtil.format(n.FW.G_W("{0}\u5206{1}\u79d2"),s,c)},t.prototype.timeSec2HMSStr14=function(t){var e=this.timeSec2HMS(t-this.now()),r=Math.floor(e.h/24),o=(r<10?"0":"")+r,i=e.h%24,l=(i<10?"0":"")+i,s=(e.m<10?"0":"")+e.m,c=(e.s<10?"0":"")+e.s;return r>0?a.StringUtil.format(n.FW.G_W("{0}\u5929{1}\u65f6"),o,l):i>0?a.StringUtil.format(n.FW.G_W("{0}\u65f6{1}\u5206"),l,s):a.StringUtil.format(n.FW.G_W("{0}\u5206{1}\u79d2"),s,c)},t.prototype.timeSec2HMSStr15=function(t){var e=this.timeSec2HMS(t),r=Math.floor(e.h/24),o=e.h%24;return r>10?a.StringUtil.format(n.FW.G_W("10\u5929\u4ee5\u4e0a"),r):r>0?a.StringUtil.format(n.FW.G_W("{0}\u5929"),r):o>0?a.StringUtil.format(n.FW.G_W("{0}\u5c0f\u65f6"),o):e.m>0?a.StringUtil.format(n.FW.G_W("{0}\u5206\u949f"),e.m):a.StringUtil.format(n.FW.G_W("{0}\u79d2"),e.s)},t.prototype.time2Date=function(t){return t<0&&(t=0),new Date(t)},t.prototype.time2String=function(t,e){var r=this.time2Date(t),o=null;if(r){var i=(r.getMonth()+1<10?"0":"")+(r.getMonth()+1),l=(r.getDate()<10?"0":"")+r.getDate(),s=(r.getHours()<10?"0":"")+r.getHours(),c=(r.getMinutes()<10?"0":"")+r.getMinutes(),u=(r.getSeconds()<10?"0":"")+r.getSeconds();o=e?a.StringUtil.format(n.FW.G_W("{0}\u5e74{1}\u6708{2}\u65e5{3}\u65f6{4}\u5206{5}\u79d2"),r.getFullYear(),i,l,s,c,u):a.StringUtil.format(n.FW.G_W("{0}\u6708{1}\u65e5{2}\u65f6{3}\u5206{4}\u79d2"),i,l,s,c,u)}return o},t.prototype.time2String2=function(t,e){void 0===e&&(e=!1);var r=this.time2Date(t),o="";if(r){var i=(r.getMonth()+1<10?"0":"")+(r.getMonth()+1),l=(r.getDate()<10?"0":"")+r.getDate(),s=(r.getHours()<10?"0":"")+r.getHours(),c=(r.getMinutes()<10?"0":"")+r.getMinutes(),u=(r.getSeconds()<10?"0":"")+r.getSeconds();o=e?a.StringUtil.format(n.FW.G_W("{0}/{1}-{2} {3}:{4}:{5}"),r.getFullYear(),i,l,s,c,u):a.StringUtil.format("{0}/{1} {2}:{3}:{4}",i,l,s,c,u)}return o},t.prototype.time2String2_=function(t,e){void 0===e&&(e=!1);var r=this.time2Date(t),o="";if(r){var i=(r.getMonth()+1<10?"0":"")+(r.getMonth()+1),l=(r.getDate()<10?"0":"")+r.getDate(),s=(r.getHours()<10?"0":"")+r.getHours(),c=(r.getMinutes()<10?"0":"")+r.getMinutes(),u=(r.getSeconds()<10?"0":"")+r.getSeconds();o=e?a.StringUtil.format(n.FW.G_W("{0}-{1}-{2}  {3}:{4}:{5}"),r.getFullYear(),i,l,s,c,u):a.StringUtil.format(n.FW.G_W("{0}-{1}  {2}:{3}:{4}"),i,l,s,c,u)}return o},t.prototype.time3String=function(t,e){var r=this.time2Date(t),o=null;if(r){var i=(r.getMonth()+1<10?"0":"")+(r.getMonth()+1),l=(r.getDate()<10?"0":"")+r.getDate();r.getHours(),r.getHours(),r.getMinutes(),r.getMinutes(),r.getSeconds(),r.getSeconds(),o=e?a.StringUtil.format(n.FW.G_W("{0}-{1}-{2}"),r.getFullYear(),i,l):a.StringUtil.format(n.FW.G_W("{0}-{1}"),i,l)}return o},t.prototype.time4String=function(t){var e,r=this.time2Date(t);if(e=[n.FW.G_W("\u661f\u671f\u5929"),n.FW.G_W("\u661f\u671f\u4e00"),n.FW.G_W("\u661f\u671f\u4e8c"),n.FW.G_W("\u661f\u671f\u4e09"),n.FW.G_W("\u661f\u671f\u56db"),n.FW.G_W("\u661f\u671f\u4e94"),n.FW.G_W("\u661f\u671f\u516d")][r.getDay()])return e},t.prototype.time2String3=function(t,e){void 0===e&&(e=!1);var r=this.time2Date(t),o="";if(r){var i=(r.getMonth()+1<10?"0":"")+(r.getMonth()+1),l=(r.getDate()<10?"0":"")+r.getDate(),s=(r.getHours()<10?"0":"")+r.getHours(),c=(r.getMinutes()<10?"0":"")+r.getMinutes(),u=(r.getSeconds()<10?"0":"")+r.getSeconds();o=e?a.StringUtil.format(n.FW.G_W("{0}/{1}/{2} {3}:{4}:{5}"),r.getFullYear(),i,l,s,c,u):a.StringUtil.format("{0}/{1} {2}:{3}:{4}",i,l,s,c,u)}return o},t.prototype.time2String4=function(t,e,r){void 0===e&&(e=!1),void 0===r&&(r=!1);var o=this.time2Date(t),i="";if(o){var l=(o.getMonth()+1<10?"0":"")+(o.getMonth()+1),s=(o.getDate()<10?"0":"")+o.getDate(),c=(o.getHours()<10?"0":"")+o.getHours(),u=(o.getMinutes()<10?"0":"")+o.getMinutes(),p=(o.getSeconds()<10?"0":"")+o.getSeconds();i=e?a.StringUtil.format(n.FW.G_W("{0}/{1}/{2}"),o.getFullYear(),l,s):r?a.StringUtil.format("{0}/{1}",l,s):a.StringUtil.format("{0}:{1}:{2}",c,u,p)}return i},t.prototype.time2String5=function(t){var e=this.time2Date(t),r="";if(e){var o=e.getMonth()+1,i=(e.getDate()<10?"0":"")+e.getDate();r=a.StringUtil.format(n.FW.G_W("{0}\u6708{1}\u65e5"),o,i)}return r},t.prototype.time2StringUnitMax=function(t){var e=Math.floor(t/86400);if(e>0)return e+n.FW.G_W("\u5929");var r=Math.floor(t/3600);if(r>0)return r+n.FW.G_W("\u65f6");var o=Math.floor(t/60);return o>0?o+n.FW.G_W("\u5206"):t%60+n.FW.G_W("\u79d2")},t.prototype.time2String2Year=function(t){var e=this.time2Date(t);if(!e)return"";var r=(e.getMonth()+1<10?"0":"")+(e.getMonth()+1),o=(e.getDate()<10?"0":"")+e.getDate();return a.StringUtil.format(n.FW.G_W("{0}-{1}-{2}"),e.getFullYear(),r,o)},t.prototype.time2String2Time=function(t,e){void 0===e&&(e=!0);var r=this.time2Date(t);if(r){var o=(r.getHours()<10?"0":"")+r.getHours(),n=(r.getMinutes()<10?"0":"")+r.getMinutes(),i=(r.getSeconds()<10?"0":"")+r.getSeconds();return e?a.StringUtil.format("{0}:{1}:{2}",o,n,i):a.StringUtil.format("{0}:{1}",o,n)}},t.prototype.getNextDay12=function(t,e,r){if(void 0===e&&(e=!1),void 0===r&&(r=!1),t<0)return 0;var o;t=e?1e3*t:t;var n=36e5*(24-(o=r?new Date(t+1):new Date(t+this.localTimeDifference+1)).getHours()-1)+6e4*(60-o.getMinutes()-1)+1e3*(60-o.getSeconds())+t;return 1e3*Math.floor(.001*n)},t.prototype.getDayHourTime=function(t,e,r,o){if(void 0===r&&(r=!1),void 0===o&&(o=!1),t<0)return 0;var n;t=r?1e3*t:t;var i=36e5*(e-(n=o?new Date(t+1):new Date(t+this.localTimeDifference+1)).getHours()-1)+6e4*(60-n.getMinutes()-1)+1e3*(60-n.getSeconds())+t;return 1e3*Math.floor(.001*i)},t.prototype.getDayString=function(t){var e=this.time2Date(t),r="";if(e){var o=(e.getMonth()+1<10?"0":"")+(e.getMonth()+1),i=(e.getDate()<10?"0":"")+e.getDate();r=a.StringUtil.format(n.FW.G_W("{0}-{1}-{2}"),e.getFullYear(),o,i)}return r},t.prototype.getWeekDayString=function(t){if(!this.WeekStr){this.WeekStr=n.FW.G_W("\u5468{0}");var e=n.FW.G_W("\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u65e5"),r=e.split(" ");7==r.length?this.WeekDayStr=r:this.WeekDayStr=e}return a.StringUtil.format(this.WeekStr,this.WeekDayStr[t-1])},t.prototype.getHourString=function(t){return this.HourStr||(this.HourStr="{0}:00"),a.StringUtil.format(this.HourStr,t)},t.prototype.getHour=function(t){var e=this.time2Date(t),r=0;return e&&(r=e.getHours()),r},t.prototype.getMinutes=function(t){var e=this.time2Date(t),r=0;return e&&(r=e.getMinutes()),r},t.prototype.getSecOfHour=function(t){var e=this.time2Date(t),r=e.getMinutes();return e.getSeconds()+60*r},t.prototype.getSubTimeMHS=function(t,e){void 0===e&&(e=":");var r=Math.floor(t/3600),o=Math.floor((t-3600*r)/60),n=t-(3600*r+60*o);return(r<10?"0"+r:r+"")+e+(o<10?"0"+o:o+"")+e+(n<10?"0"+n:n+"")},t.prototype.formatTime=function(t,e){void 0===e&&(e="%h:%m:%s");var r=this.timeSec2HMS(t);return e.replace(/\%\w/g,function(t){var e,o=t.charAt(1);return null!=r[o]&&(e=(e=r[o].toString()).padStart(2,"0")),e||""})},t.__cname="TimeUtil",o([i.injectField("ModelTime")],t.prototype,"ModelTime",void 0),t}();r.TimeUtil=l,cc._RF.pop()},{"../../framework/FW":void 0,"../../framework/container/Container":void 0,"../../framework/utils/StringUtil":void 0}],TriggerCountdown:[function(t,e,r){"use strict";cc._RF.push(e,"d633fWVpG9KBaDLhN5CCBE/","TriggerCountdown");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.TriggerCountdown=void 0;var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._t=0,e.start=!1,e}return n(e,t),e.prototype.Setup=function(t){this.total=t,this.start=!0},e.prototype.Update=function(t){0!=this.start&&(this._t+=t,this._t>=this.total&&(this._t=0,this.Trigger()))},e.__cname="TriggerCountdown",e}(t("../SkillTriggerBase").SkillTriggerBase);r.TriggerCountdown=i,cc._RF.pop()},{"../SkillTriggerBase":"SkillTriggerBase"}],UIDGenerator:[function(t,e,r){"use strict";cc._RF.push(e,"2967eUptJJEj4paol5QmyW6","UIDGenerator"),Object.defineProperty(r,"__esModule",{value:!0}),r.UIDGenerator=void 0;var o=function(){function t(){this.list=[],this.tmId2Index=new Map,this.tmIndex2Id=new Map,this.idPool=[],this.__id=1}return t.prototype.allocateId=function(){return this.idPool.length>0?this.idPool.shift():this.__id++},t.prototype.GetSize=function(){return this.list.length},t.prototype.GetIdPool=function(){return this.idPool},t.prototype.Add=function(t){var e=this.list.length,r=this.allocateId();return this.list[e]=t,this.tmId2Index.set(r,e),this.tmIndex2Id.set(e,r),r},t.prototype.GetItem=function(t){var e=this.tmId2Index.get(t);return this.list[e]},t.prototype.Remove=function(t){if(this.GetItem(t),1!=this.list.length){var e=this.tmId2Index,r=this.tmIndex2Id,o=this.list,n=t,i=e.get(n),a=o.length-1,l=r.get(a),s=o[i];o[i]=o[a],o[a]=s,e.set(l,i),r.set(i,l),o.length--,e.delete(n),r.delete(a)}else this.Clear()},t.prototype.Clear=function(){this.list.length=0,this.tmId2Index.clear(),this.tmIndex2Id.clear()},t}();r.UIDGenerator=o,cc._RF.pop()},{}],VOActivity:[function(t,e,r){"use strict";cc._RF.push(e,"17866R1CIlCdZQebDYopCi5","VOActivity");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.VOActivityBag=r.VOActivity=void 0;var a=t("../../../../../framework/container/Container"),l=t("../VO"),s=t("../VOBag"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetId=function(){return this.cmd.id},e.prototype.GetRefId=function(){return this.cmd.activityRefId},e.prototype.GetStartTime=function(){return this.cmd.startTime},e.prototype.GetEndTime=function(){return this.cmd.endTime},e.prototype.GetAwardTime=function(){return this.cmd.awardTime},e.prototype.GetRefByCmd=function(){return this.Ref.RefMgractivity.getRef("resId",this.GetRefId())},e.prototype.GetActivityKind=function(){return this.ref&&this.ref.type},e.prototype.GetName=function(){return this.ref.name},e.prototype.GetPlan=function(){return this.ref.plan},e.prototype.GetIcon=function(){return this.ref.icon},e.prototype.GetEffect=function(){return this.ref.effect},e.prototype.GetBelond=function(){return this.ref.belond},e.prototype.GetOrder=function(){return this.ref.sort},e.prototype.GetDeTail=function(){return this.cmd.detail},e.prototype.GetExpr=function(){return this.ref.expr},e.__cname="VOActivity",i([a.injectField("Ref")],e.prototype,"Ref",void 0),e}(l.VO);r.VOActivity=c;var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetVOClass=function(){return c},e.prototype.GetCacheName=function(){return"CmdActivity"},e.__cname="VOActivityBag",e}(s.VOBag);r.VOActivityBag=u,cc._RF.pop()},{"../../../../../framework/container/Container":void 0,"../VO":"VO","../VOBag":"VOBag"}],VOApplyFirend:[function(t,e,r){"use strict";cc._RF.push(e,"99746jFZKRJrbFjY7amyRUf","VOApplyFirend");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.VOApplyFirendBag=r.VOApplyFirend=void 0;var a=t("../../../../../framework/container/Container"),l=t("../VO"),s=t("../VOBag"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetRefByCmd=function(){return null},e.prototype.GetRoleId=function(){return this.cmd.roleId},e.prototype.GetDetail=function(){return this.cmd.friendDetail},e.prototype.GetRoleImg=function(){return this.cmd.friendDetail.roleImg},e.prototype.GetRoleName=function(){return this.cmd.friendDetail.roleName},e.prototype.GetPower=function(){return this.cmd.friendDetail.power},e.prototype.GetHeadFrame=function(){return this.cmd.friendDetail.headFrame},e.prototype.GetOnline=function(){return this.cmd.friendDetail.online||!1},e.prototype.GetPopularity=function(){return this.cmd.friendDetail.popularity||0},e.prototype.GetLastOfflineTime=function(){return this.cmd.friendDetail.lastOfflineTime||0},e.prototype.GetTodaySend=function(){return this.cmd.friendDetail.todaySend||!1},e.prototype.GetTodayReceive=function(){return this.cmd.friendDetail.todayReceive||!1},e.prototype.GetTodayTake=function(){return this.cmd.friendDetail.todayTake||!1},e.prototype.GetLevel=function(){return this.cmd.friendDetail.level||0},e.prototype.GetHeroId=function(){return this.cmd.friendDetail.heroId},e.prototype.GetTodayLike=function(){return this.cmd.friendDetail.todayLike||!1},e.prototype.GetApply=function(){return this.cmd.friendDetail.apply||!1},e.__cname="VOApplyFirend",i([a.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(l.VO);r.VOApplyFirend=c;var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetVOClass=function(){return c},e.prototype.GetCacheName=function(){return"CmdApplyFriendCache"},e.__cname="VOApplyFirendBag",e}(s.VOBag);r.VOApplyFirendBag=u,cc._RF.pop()},{"../../../../../framework/container/Container":void 0,"../VO":"VO","../VOBag":"VOBag"}],VOBagSubset:[function(t,e,r){"use strict";cc._RF.push(e,"bbcceFcZnZHHZxKX/cVwmRV","VOBagSubset");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.VOBagSubset=void 0;var l=t("../../../../framework/base/ScriptObject"),s=t("../../../../framework/event/EventProxy"),c=t("../../../../framework/FW"),u=t("../../../../framework/utils/Toolset"),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tlVO=null,e.tmVO=null,e.eventProxy=new s.EventProxy,e.filter=null,e.isDirty=!0,e.isDispatchDirty=!1,e}return n(e,t),e.prototype.onDestroy=function(){if(this.disposeCallback)try{this.disposeCallback()}catch(e){c.FW.Log.error(e)}this.tmVO=null,this.tlVO=null,this.eventProxy.destroy(),u.ToolSet.destroyToolSet(this.toolSet),t.prototype.onDestroy.call(this)},e.prototype.Init=function(t){return this.toolSet=u.ToolSet.createToolSet(),this.InitByTl([t])},e.prototype.InitByTl=function(t){var e,r,o=this;this.tlVOBag=t;try{for(var n=i(t),a=n.next();!a.done;a=n.next()){var l=a.value;this.toolSet.addListener(l.GetEventProxy(),"OnAdd",function(t){o.OnAdd(t)}),this.toolSet.addListener(l.GetEventProxy(),"OnRemove",function(t){o.OnRemove(t)}),this.toolSet.addListener(l.GetEventProxy(),"OnUpdate",function(t){o.OnUpdate(t)})}}catch(s){e={error:s}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}return this},e.prototype.SetDisposeCallback=function(t){return this.disposeCallback=t,this},e.prototype.OnAdd=function(t){this.filter?(!this.tmVO||null==this.tmVO.get(t))&&this.filter(t)&&(this.tmVO.set(t,t),this.MarkDirty()):this.MarkDirty()},e.prototype.OnRemove=function(t){this.filter?this.tmVO&&null!=this.tmVO.get(t)&&(this.tmVO.delete(t),this.MarkDirty()):this.MarkDirty()},e.prototype.OnUpdate=function(t){if(this.filter){var e=this.tmVO&&null!=this.tmVO.get(t),r=this.filter(t);!r!=!e?(this.tmVO.set(t,t),this.MarkDirty()):r&&this.MarkDispatchDirty()}else this.MarkDirty()},e.prototype.MarkDirty=function(){this.isDirty=!0,this.MarkDispatchDirty()},e.prototype.MarkDispatchDirty=function(){var t=this;this.isDispatchDirty||(this.isDispatchDirty=!0,this.toolSet.addDelay(100,function(){t.isDispatchDirty=!1,t.eventProxy.execute("OnChanged")}))},e.prototype.GetTlVO=function(){var t,e,r,o,n=this;if(this.isDirty){this.tlVO=[];var l=this.tlVO;try{for(var s=i(this.tlVOBag),c=s.next();!c.done;c=s.next()){var u=c.value.GetBag();try{for(var p=(r=void 0,i(u)),f=p.next();!f.done;f=p.next()){var h=a(f.value,2),y=(h[0],h[1]);null!=y&&null!=this.filter&&this.filter(y)&&l.push(y)}}catch(d){r={error:d}}finally{try{f&&!f.done&&(o=p.return)&&o.call(p)}finally{if(r)throw r.error}}}}catch(m){t={error:m}}finally{try{c&&!c.done&&(e=s.return)&&e.call(s)}finally{if(t)throw t.error}}this.sorter&&l.sort(function(t,e){return n.sorter(t,e)}),this.isDirty=!1}return this.tlVO},e.prototype.GetOneVO=function(){return this.GetTlVO()[0]},e.prototype.GetVOBySift=function(t){var e=this.GetTlVO(),r=0;if(t)for(var o=1;o<e.length;++o)t(e[r],e[o])&&(r=o);return e[r]},e.prototype.InitTmVO=function(){var t,e,r,o;this.tmVO=new Map;var n=this.tmVO;try{for(var l=i(this.tlVOBag),s=l.next();!s.done;s=l.next()){var c=s.value.GetBag();try{for(var u=(r=void 0,i(c)),p=u.next();!p.done;p=u.next()){var f=a(p.value,2),h=(f[0],f[1]);null!=h&&null!=this.filter&&this.filter(h)&&n.set(h,h)}}catch(y){r={error:y}}finally{try{p&&!p.done&&(o=u.return)&&o.call(u)}finally{if(r)throw r.error}}}}catch(d){t={error:d}}finally{try{s&&!s.done&&(e=l.return)&&e.call(l)}finally{if(t)throw t.error}}},e.prototype.GetTlVOBag=function(){return this.tlVOBag},e.prototype.GetOneBag=function(){var t=this.tlVOBag.entries(),e=a(t.next().value,2);return e[0],e[1]},e.prototype.GetEventProxy=function(){return this.eventProxy},e.prototype.SetFilter=function(t){this.filter=t,this.MarkDirty(),this.InitTmVO()},e.prototype.SetFilterVO=function(t){this.SetFilter(function(e){return e==t})},e.prototype.SetSorter=function(t){this.sorter=t,null!=t&&this.MarkDirty()},e.__cname="VOBagSubset",e}(l.ScriptObject);r.VOBagSubset=p,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/base/ScriptObject":void 0,"../../../../framework/event/EventProxy":void 0,"../../../../framework/utils/Toolset":void 0}],VOBag:[function(t,e,r){"use strict";cc._RF.push(e,"68a66NBQspHmZ7UA8p3D3+7","VOBag");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.VOBag=void 0;var s=t("../../../../framework/base/ScriptObject"),c=t("../../../../framework/cache/GameCache"),u=t("../../../../framework/container/Container"),p=t("../../../../framework/event/EventProxy"),f=t("../../../../framework/FW"),h=t("../../../../framework/utils/StringUtil"),y=t("../../../../framework/utils/Toolset"),d=t("../../gamestate/state/GameStateRunning"),m=t("./VOBagSubset"),v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bag=new Map,e.changed=!1,e.eventProxy=new p.EventProxy,e.tmSubset=new Map,e}return n(e,t),e.prototype.Init=function(t,e){this.container=e,this.toolSet=y.ToolSet.createToolSet(),this.modelVO=t},e.prototype.onDestroy=function(){y.ToolSet.destroyToolSet(this.toolSet),t.prototype.onDestroy.call(this)},e.prototype.OnEnterWrap=function(){var t=this;this.gameCache=this.CacheMgr.getCache(this.GetCacheName()),this.toolSet.addTimer(300,function(){t.changed&&t.Tick()},this);var e=this.gameCache.eventProxy,r=this.container;this.toolSet.addListener(e,c.EventType.onAdd,function(e){if(t.OnFilter(e)){var o=new(t.GetVOClass());r.inject(o),o.InitByCmd(e),t.Add(o)}}),this.toolSet.addListener(e,c.EventType.onUpdate,function(e,r){if(t.OnFilter(e)){var o=t.gameCache.hashKey(e),n=t.Get(o);t.Update(n,r)}}),this.toolSet.addListener(e,c.EventType.onRemove,function(e){if(t.OnFilter(e)){var r=t.gameCache.hashKey(e);t.Remove(r)}});var o=this;o.gameCache.cacheDict.work(function(t,e){if(o.OnFilter(e)){var n=new(o.GetVOClass());r.inject(n),n.InitByCmd(e),o.Add(n)}}),this.OnEnter()},e.prototype.Hash=function(t){return this.gameCache.hashKey(t.GetCmd())},e.prototype.OnExitWrap_cor=function(){var t,e;this.OnExit_cor(),this.toolSet.removeAll(),this.bag.clear();try{for(var r=a(this.tmSubset),o=r.next();!o.done;o=r.next()){var n=l(o.value,2),i=n[0];n[1],i.MarkDirty()}}catch(s){t={error:s}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},e.prototype.GetEventProxy=function(){return this.eventProxy},e.prototype.GetBag=function(){return this.bag},e.prototype.CreateSubset=function(){var t=this,e=(new m.VOBagSubset).Init(this);return this.tmSubset.set(e,e),e.SetDisposeCallback(function(){t.tmSubset.set(e,null)}),e},e.prototype.DestroySubset=function(t){null!=this.tmSubset.get(t)?t.destroy():f.FW.Log.error("\u5220\u9664\u4e0d\u5b58\u5728\u7684subset")},e.prototype.GetBagAsArray=function(t){var e,r,o=[];try{for(var n=a(this.bag),i=n.next();!i.done;i=n.next()){var s=l(i.value,2),c=(s[0],s[1]);t&&!t(c)||o.push(c)}}catch(u){e={error:u}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}return o},e.prototype.BagFilter=function(t){var e,r;try{for(var o=a(this.bag),n=o.next();!n.done;n=o.next()){var i=l(n.value,2);if(i[0],t(i[1]))return}}catch(s){e={error:s}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}},e.prototype.Get=function(t){return this.bag.get(t)},e.prototype.GetOne=function(){if(this.bag.size>0){var t=this.bag.entries(),e=l(t.next().value,2);return e[0],e[1]}return null},e.prototype.GetGameCache=function(){return this.gameCache},e.prototype.Add=function(t){var e=this.Hash(t);null!=this.bag.get(e)&&f.FW.Log.error(h.StringUtil.format("\u91cd\u590d\u6dfb\u52a0:%s",e)),this.bag.set(e,t),this.eventProxy.execute("OnAdd",t),this.changed=!0,d.GameStateRunning.isInit&&this.OnAdd(t)},e.prototype.OnAdd=function(){},e.prototype.Update=function(t,e){this.OnUpdate(t,e),this.eventProxy.execute("OnUpdate",t,e),this.changed=!0},e.prototype.OnUpdate=function(){},e.prototype.Remove=function(t){var e=this.Get(t);this.OnRemove(e),this.bag.delete(t),this.eventProxy.execute("OnRemove",e),this.changed=!0},e.prototype.OnRemove=function(){},e.prototype.Tick=function(){this.changed&&(this.changed=!1,this.OnChanged(),this.eventProxy.execute("OnChanged"))},e.prototype.OnChanged=function(){},e.prototype.OnEnter=function(){},e.prototype.OnExit_cor=function(){},e.prototype.OnFilter=function(){return!0},e.__cname="VOBagSubset",i([u.injectField("CacheMgr")],e.prototype,"CacheMgr",void 0),e}(s.ScriptObject);r.VOBag=v,cc._RF.pop()},{"../../../../framework/FW":void 0,"../../../../framework/base/ScriptObject":void 0,"../../../../framework/cache/GameCache":void 0,"../../../../framework/container/Container":void 0,"../../../../framework/event/EventProxy":void 0,"../../../../framework/utils/StringUtil":void 0,"../../../../framework/utils/Toolset":void 0,"../../gamestate/state/GameStateRunning":"GameStateRunning","./VOBagSubset":"VOBagSubset"}],VOBlackFriend:[function(t,e,r){"use strict";cc._RF.push(e,"9d5b1br5QNAjrLkmfFHecux","VOBlackFriend");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.VOBlackFirendBag=r.VOBlackFirend=void 0;var a=t("../../../../../framework/container/Container"),l=t("../VO"),s=t("../VOBag"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetRefByCmd=function(){return null},e.prototype.GetRoleId=function(){return this.cmd.roleId},e.prototype.GetDetail=function(){return this.cmd.friendDetail},e.prototype.GetRoleImg=function(){return this.cmd.friendDetail.roleImg},e.prototype.GetRoleName=function(){return this.cmd.friendDetail.roleName},e.prototype.GetPower=function(){return this.cmd.friendDetail.power},e.prototype.GetHeadFrame=function(){return this.cmd.friendDetail.headFrame},e.prototype.GetOnline=function(){return this.cmd.friendDetail.online||!1},e.prototype.GetPopularity=function(){return this.cmd.friendDetail.popularity||0},e.prototype.GetLastOfflineTime=function(){return this.cmd.friendDetail.lastOfflineTime||0},e.prototype.GetTodaySend=function(){return this.cmd.friendDetail.todaySend||!1},e.prototype.GetTodayReceive=function(){return this.cmd.friendDetail.todayReceive||!1},e.prototype.GetTodayTake=function(){return this.cmd.friendDetail.todayTake||!1},e.prototype.GetLevel=function(){return this.cmd.friendDetail.level||0},e.prototype.GetHeroId=function(){return this.cmd.friendDetail.heroId},e.prototype.GetTodayLike=function(){return this.cmd.friendDetail.todayLike||!1},e.prototype.GetApply=function(){return this.cmd.friendDetail.apply||!1},e.__cname="VOBlackFirend",i([a.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(l.VO);r.VOBlackFirend=c;var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetVOClass=function(){return c},e.prototype.GetCacheName=function(){return"CmdBlackFriendCache"},e.__cname="VOBlackFirendBag",e}(s.VOBag);r.VOBlackFirendBag=u,cc._RF.pop()},{"../../../../../framework/container/Container":void 0,"../VO":"VO","../VOBag":"VOBag"}],VOChapter:[function(t,e,r){"use strict";cc._RF.push(e,"66c29pvSZBNwIlnYqsOUlEv","VOChapter");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.VOChapterBag=r.VOChapter=void 0;var l=t("../../../../../framework/container/Container"),s=t("../VO"),c=t("../VOBag"),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetRefByCmd=function(t){return this.Ref.RefMgrchapterRef.getRef("resId",t.resId)},e.prototype.GetResId=function(){return this.cmd.resId},e.prototype.GetLiveTime=function(){return this.cmd.liveTime},e.prototype.GetIsClearance=function(){return 1==this.cmd.finishState},e.prototype.GetTlChapterBoxState=function(){return this.cmd.tlChapterBoxState||[]},e.prototype.AllBoxRewardIsReceive=function(){var t,e;try{for(var r=a(this.GetTlChapterBoxState()),o=r.next();!o.done;o=r.next())if(2!=o.value.rewardState)return!1}catch(n){t={error:n}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}return!0},e.prototype.HasRewardReceive=function(){var t,e,r=0;try{for(var o=a(this.GetTlChapterBoxState()),n=o.next();!n.done;n=o.next())1==n.value.rewardState&&(r+=1)}catch(i){t={error:i}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}return r},e.prototype.GetRewardState=function(t){var e,r;try{for(var o=a(this.GetTlChapterBoxState()),n=o.next();!n.done;n=o.next()){var i=n.value;if(i.boxResId==t)return i.rewardState}}catch(l){e={error:l}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}},e.prototype.GetRewardNum=function(){var t,e,r=0;try{for(var o=a(this.GetTlChapterBoxState()),n=o.next();!n.done;n=o.next())2==n.value.rewardState&&(r+=1)}catch(i){t={error:i}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}return r},e.__cname="VOChapter",i([l.injectField("Ref")],e.prototype,"Ref",void 0),e}(s.VO);r.VOChapter=u;var p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetCacheName=function(){return"CmdChapter"},e.prototype.GetVOClass=function(){return u},e.__cname="VOChapterBag",e}(c.VOBag);r.VOChapterBag=p,cc._RF.pop()},{"../../../../../framework/container/Container":void 0,"../VO":"VO","../VOBag":"VOBag"}],VOEquip:[function(t,e,r){"use strict";cc._RF.push(e,"0b9b7qrV6RJ0Yn3iunw5k5n","VOEquip");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.VOEquipBag=r.VOEquip=r.EquipType=void 0;var a=t("../../../../../framework/container/Container"),l=t("../../../../../framework/event/EventCallback"),s=t("../../../../../framework/FW"),c=t("../../../../../framework/utils/StringUtil"),u=t("./Goods");(function(t){t[t.general=0]="general",t[t.xiaoyao=1]="xiaoyao",t[t.yutu=2]="yutu",t[t.houyi=3]="houyi",t[t.exiuluo=4]="exiuluo",t[t.yanwang=5]="yanwang",t[t.mile=6]="mile"})(r.EquipType||(r.EquipType={}));var p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._local_phase=-1,e}return n(e,t),e.prototype.GetRefId=function(){return this.cmd&&this.cmd.resId?this.cmd.resId:this.ref.resId},e.prototype.GetId=function(){return this.cmd?this.cmd.id:0},e.prototype.GetLevel=function(){return this.cmd?this.cmd.level:1},e.prototype.GetIsPutOn=function(){return this.cmd.isPutOn},e.prototype.GetGoodsType=function(){return this.ref.type},e.prototype.GetRefByCmd=function(){return this.Ref.RefMgrequip.getRef("resId",this.cmd.resId)},e.prototype.GetDesc=function(){return this.ref.desc},e.prototype.GetName=function(){return this.ref.name},e.prototype.GetIconUrl=function(){var t=this.ref.icon+"_"+this.GetQuality();return null==t&&s.FW.Log.error("\u56fe\u6807\u5931\u6548 IRefequip name:"+this.ref.name+" resId:"+this.ref.resId+" quality:"+this.GetQuality()),t},e.prototype.GetTypeIconUrl=function(){return this.ref.typeIcon||""},e.prototype.SetQuality=function(t){this._local_quality=t},e.prototype.SetPhase=function(t){this._local_phase=t},e.prototype.GetQuality=function(){return this._local_quality?this._local_quality:this.cmd?this.cmd.quality:1},e.prototype.GetPhase=function(){return-1!=this._local_phase?this._local_phase:this.cmd?this.cmd.phase:0},e.prototype.GetIsShowPhase=function(){return this.GetPhase()>0},e.prototype.GetDownLevelState=function(){return this.cmd.level>1},e.prototype.GetDownQualityState=function(){return this.GetQuality()>=4&&this.cmd.phase>0},e.prototype.GetUpgradeCoinNumber=function(){return this.ModelEquip.GetUpgradeCoinNumber(this.GetLevel())},e.prototype.GetUpgradeDrawNumber=function(){return this.ModelEquip.GetUpgradeDrawNumber(this.GetLevel())},e.prototype.GetUpDownDrawId=function(){return this.ModelEquip.GetUpDownDrawId(this.GetGoodsType(),this.GetQuality(),this.GetPhase())},e.prototype.GetMaxLevel=function(){return this.ModelEquip.GetMaxLevel(this.GetGoodsType(),this.GetQuality(),this.GetPhase())},e.prototype.GetAdditionValue=function(){return this.ModelEquip.GetBaseAttr(this)+this.ModelEquip.GetAdditionValue(this.GetGoodsType(),this.GetQuality(),this.GetPhase())*Math.max(0,this.GetLevel()-1)},e.prototype.GetNameStr=function(){var t=this.Ref.RefMgrresitemquality.getRef("quality",this.GetQuality());return c.StringUtil.format("[color={0}]{1}[/color]",t.color,this.GetName())},e.prototype.GetIsSEquip=function(){return this.ModelEquip.GetIsSEquip(this.GetRefId())},e.prototype.GetDownLevelData=function(){return this.ModelEquip.GetDownLevelData(this)},e.prototype.GetDownQualityData=function(){return this.ModelEquip.GetDownQualityData(this)},e.prototype.GetAdditionType=function(){return this.ModelEquip.GetAdditionType(this.GetGoodsType(),this.GetQuality(),this.GetPhase())},e.prototype.GetQuiltySkill=function(){return this.ModelEquip.GetQuiltySkill(this.GetRefId())},e.prototype.GetEquiType=function(){return this.ref.equipType},e.prototype.GetEquiTypeDesc=function(){return this.ref.equipDesc},e.prototype.GetRuntimeAttrList=function(){var t=this.GetAdditionType(),e=this.GetAdditionValue(),r=[];return r.push({attr:t,value:e}),r},e.prototype.GetRuntimeSkillGroup=function(){var t=this,e=[],r=this.GetQuiltySkill().find(function(e){return e.quality==t.GetQuality()});return r&&e.push(r.skillGroupId[0]),e},e.prototype.OnGetNumber=function(){return 1},e.prototype.GetIconEffect=function(){return this.ref.iconEffect||null},e.prototype.GetUnderEffect=function(){return null},e.__cname="VOEquip",i([a.injectField("Ref")],e.prototype,"Ref",void 0),i([a.injectField("ModelEquip")],e.prototype,"ModelEquip",void 0),e}(u.Goods);r.VOEquip=p;var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.heroRedPointUpdate=new l.EventCallback,e}return n(e,t),e.prototype.GetVOClass=function(){return p},e.prototype.GetCacheName=function(){return"CmdEquip"},e.prototype.OnEnter=function(){this.isEnter=!0},e.prototype.OnAdd=function(){this.isEnter&&this.UpdateBag()},e.prototype.OnUpdate=function(){this.isEnter&&this.UpdateBag()},e.prototype.UpdateBag=function(){this.heroRedPointUpdate.execute()},e.prototype.ChaeckIsOpenRed=function(t){return t.GetIsPutOn()?this.ModelEquip.GetUpgradeState(t):this.ModelEquip.GetQualityIsHight(t)},e.__cname="VOEquipBag",i([a.injectField("ModelEquip")],e.prototype,"ModelEquip",void 0),e}(u.GoodsBag);r.VOEquipBag=f,cc._RF.pop()},{"../../../../../framework/FW":void 0,"../../../../../framework/container/Container":void 0,"../../../../../framework/event/EventCallback":void 0,"../../../../../framework/utils/StringUtil":void 0,"./Goods":"Goods"}],VOFirend:[function(t,e,r){"use strict";cc._RF.push(e,"2aaffbObhJANpMHafXqAnul","VOFirend");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.VOFirendBag=r.VOFirend=void 0;var a=t("../../../../../framework/container/Container"),l=t("../VO"),s=t("../VOBag"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetRefByCmd=function(){return null},e.prototype.GetRoleId=function(){return this.cmd.roleId},e.prototype.GetDetail=function(){return this.cmd.friendDetail},e.prototype.GetRoleImg=function(){return this.cmd.friendDetail.roleImg},e.prototype.GetRoleName=function(){return this.cmd.friendDetail.roleName},e.prototype.GetPower=function(){return this.cmd.friendDetail.power},e.prototype.GetHeadFrame=function(){return this.cmd.friendDetail.headFrame},e.prototype.GetOnline=function(){return this.cmd.friendDetail.online||!1},e.prototype.GetPopularity=function(){return this.cmd.friendDetail.popularity||0},e.prototype.GetLastOfflineTime=function(){return this.cmd.friendDetail.lastOfflineTime||0},e.prototype.GetTodaySend=function(){return this.cmd.friendDetail.todaySend||!1},e.prototype.GetTodayReceive=function(){return this.cmd.friendDetail.todayReceive||!1},e.prototype.GetTodayTake=function(){return this.cmd.friendDetail.todayTake||!1},e.prototype.GetLevel=function(){return this.cmd.friendDetail.level||0},e.prototype.GetHeroId=function(){return this.cmd.friendDetail.heroId},e.prototype.GetTodayLike=function(){return this.cmd.friendDetail.todayLike||!1},e.prototype.GetApply=function(){return this.cmd.friendDetail.apply||!1},e.__cname="VOFirend",i([a.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(l.VO);r.VOFirend=c;var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetVOClass=function(){return c},e.prototype.GetCacheName=function(){return"CmdFriendCache"},e.__cname="VOFirendBag",e}(s.VOBag);r.VOFirendBag=u,cc._RF.pop()},{"../../../../../framework/container/Container":void 0,"../VO":"VO","../VOBag":"VOBag"}],VOFuben:[function(t,e,r){"use strict";cc._RF.push(e,"de70cTWisFEHoorIVwKQkSB","VOFuben");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.VOFubenBag=r.VOFuben=r.FubenType=void 0;var a,l=t("../../../../../framework/FW"),s=t("../../../../../framework/container/Container"),c=t("../VO"),u=t("../VOBag");(function(t){t[t.gold=0]="gold",t[t.daily=1]="daily"})(a=r.FubenType||(r.FubenType={}));var p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getRefId=function(){return this.cmd.resId},e.prototype.InitByCmd=function(e){e.detail.cmdFuBenDailyDetail?this.fubenType=a.daily:e.detail.cmdFuBenGoldDetail?this.fubenType=a.gold:l.FW.LWX.error("\u4f4d\u7f6e\u526f\u672c\u6570\u636e\uff0c\u8bf7\u68c0\u67e5\u662f\u5426\u6709\u65b0\u52a0"),t.prototype.InitByCmd.call(this,e)},e.prototype.GetRefByCmd=function(){var t;switch(this.Ref||(this.Ref=s.Container.inst().getByAlias("Ref")),this.fubenType){case a.daily:t=this.Ref.RefMgrfuBenDailyPlan;break;case a.gold:t=this.Ref.RefMgrfuBenGoldPlan;break;default:t=this.Ref.RefMgrfuBenDailyPlan}return t.getRef("resId",this.getRefId())},e.prototype.GetBoxStateByType=function(t){if(this.cmd.detail.cmdFuBenDailyDetail)return this.cmd.detail.cmdFuBenDailyDetail.cmdFuBenRewardState.find(function(e){return e.resId==t}).state;l.FW.LWX.error("\u8bbf\u95ee\u9519\u6570\u636e\uff0c\u5f53\u524d\u6570\u636e\u4e3a\u91d1\u5e01\u526f\u672c\u6570\u636e")},e.prototype.GetDailyAllBoxData=function(){return this.cmd.detail.cmdFuBenDailyDetail?this.cmd.detail.cmdFuBenDailyDetail.cmdFuBenRewardState:[]},e.prototype.CheckFubenType=function(t){return this.fubenType==t},e.prototype.GetFubenId=function(){return this.ref.fuben},e.prototype.GetRewardId=function(){return this.ref.rewardId},e.prototype.GetFreeTimes=function(){return this.cmd.detail.cmdFuBenDailyDetail?this.cmd.detail.cmdFuBenDailyDetail.freeTime:this.cmd.detail.cmdFuBenGoldDetail.freeTime},e.prototype.GetBuySpend=function(){this.ref.buySpend},e.prototype.GetBuyTimes=function(){return null!=this.cmd.detail.cmdFuBenDailyDetail.buyTime?this.cmd.detail.cmdFuBenDailyDetail.buyTime:this.cmd.detail.cmdFuBenGoldDetail.buyTime},e.__cname="VOFuben",i([s.injectField("Ref")],e.prototype,"Ref",void 0),e}(c.VO);r.VOFuben=p;var f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetVOClass=function(){return p},e.prototype.GetCacheName=function(){return"CmdFuBen"},e.__cname="VOFubenBag",e}(u.VOBag);r.VOFubenBag=f,cc._RF.pop()},{"../../../../../framework/FW":void 0,"../../../../../framework/container/Container":void 0,"../VO":"VO","../VOBag":"VOBag"}],VOHero:[function(t,e,r){"use strict";cc._RF.push(e,"84852XFfNZKK4iz9L2CQq3M","VOHero");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.VOHeroBag=r.VOHero=void 0;var l=t("../../../../../framework/container/Container"),s=t("../VO"),c=t("../VOBag"),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetResId=function(){return this.cmd.resId},e.prototype.GetRefByCmd=function(t){return this.Ref.RefMgritem.getRef("resId",t.resId)},e.prototype.GetUnlock=function(){return 1==this.cmd.state},e.prototype.GetLevel=function(){return this.cmd.level||0},e.prototype.GetWeaPonId=function(){return this.cmd.equipId},e.prototype.GetHeroRef=function(){return this.ModelMgr.ModelHero.GetHeroRef(this.GetResId())},e.prototype.GetHeroAnimationRef=function(){return this.ModelMgr.ModelHero.GetHeroAnimationRef(this.GetResId())},e.prototype.GetHeroAudioRef=function(){return this.ModelMgr.ModelHero.GetHeroAudioRef(this.GetResId())},e.prototype.GetIsMaxLevel=function(){return this.ModelMgr.ModelHero.GetIsMaxLevel(this.GetLevel())},e.prototype.GetIsPutOn=function(){var t=this.ModelMgr.ModelRole.GetRole().GetHeroId();return null!=t&&t==this.GetResId()},e.prototype.CheckCanLevelUp=function(){var t,e;if(this.GetIsMaxLevel())return!1;var r=!0,o=this.ModelMgr.ModelHero.GetNextUpgradeNeed(this.GetLevel());try{for(var n=a(o),i=n.next();!i.done;i=n.next()){var l=i.value;if(this.ModelMgr.ModelGoods.GetGoodsNumberByRefId(l.resId)<l.number){r=!1;break}}}catch(s){t={error:s}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}return r},e.prototype.GetRuntimeTmAttr=function(){return this.ModelMgr.ModelHero.GetHeroAttribute(this.GetResId(),this.GetLevel())},e.prototype.GetRuntimeSkillGroup=function(){var t,e,r=this.ModelMgr.ModelHero.GetHeroSkillByHeroId(this.GetResId()),o=this.ModelMgr.ModelHero.GetTlPassiveSkill(this.GetResId());try{for(var n=a(o),i=n.next();!i.done;i=n.next()){var l=i.value;r.add(l.skillGroup)}}catch(s){t={error:s}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}return r},e.__cname="VOHero",i([l.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([l.injectField("Ref")],e.prototype,"Ref",void 0),e}(s.VO);r.VOHero=u;var p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetVOClass=function(){return u},e.prototype.GetCacheName=function(){return"CmdHero"},e.__cname="VOHeroBag",e}(c.VOBag);r.VOHeroBag=p,cc._RF.pop()},{"../../../../../framework/container/Container":void 0,"../VO":"VO","../VOBag":"VOBag"}],VOItem:[function(t,e,r){"use strict";cc._RF.push(e,"2e2197Hxx1PLby5BOHtbI/I","VOItem");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.VOItemBag=r.VOItem=void 0;var a=t("../../../../../framework/container/Container"),l=t("../../../../../framework/FW"),s=t("./Goods"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetRefId=function(){return this.cmd?this.cmd.resId:this.ref.resId},e.prototype.GetId=function(){return this._local_Id?this._local_Id:-1},e.prototype.SetId=function(t){this._local_Id=t},e.prototype.GetGoodsType=function(){return this.ref.type},e.prototype.GetRefByCmd=function(){return this.Ref.RefMgritem.getRef("resId",this.GetRefId())},e.prototype.GetDesc=function(){return this.ref.desc},e.prototype.GetName=function(){return this.ref.name},e.prototype.GetIconUrl=function(){var t=this.ref.icon;return null==t&&l.FW.Log.error("\u56fe\u6807\u5931\u6548 IRefitem name:"+this.ref.name+" resId:"+this.ref.resId),t},e.prototype.GetQuality=function(){return this.ref.quality},e.prototype.OnGetNumber=function(){return this.cmd?this.cmd.number:0},e.prototype.GetIconEffect=function(){return this.ref.iconEffect||null},e.prototype.GetUnderEffect=function(){return null},e.__cname="VOItem",i([a.injectField("Ref")],e.prototype,"Ref",void 0),e}(s.Goods);r.VOItem=c;var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetVOClass=function(){return c},e.prototype.GetCacheName=function(){return"CmdItem"},e.prototype.ClearHead=function(){},e.__cname="VOItemBag",i([a.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(s.GoodsBag);r.VOItemBag=u,cc._RF.pop()},{"../../../../../framework/FW":void 0,"../../../../../framework/container/Container":void 0,"./Goods":"Goods"}],VOLuckyCat:[function(t,e,r){"use strict";cc._RF.push(e,"965abuP9tlEQYsoyZWKHXS7","VOLuckyCat");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.VOLuckyCatBag=r.VOLuckyCat=void 0;var a=t("../../../../../framework/container/Container"),l=t("../VO"),s=t("../VOBag"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetRefByCmd=function(t){return this.Ref.RefMgrluckyCatReward.getRef("resId",t.resId)},e.prototype.GetResId=function(){return this.cmd.resId},e.prototype.GetProcess=function(){return this.cmd.process},e.prototype.GetEndTime=function(){return this.cmd.endTime},e.__cname="VOLuckyCat",i([a.injectField("Ref")],e.prototype,"Ref",void 0),i([a.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(l.VO);r.VOLuckyCat=c;var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetVOClass=function(){return c},e.prototype.GetCacheName=function(){return"CmdLuckyCatCache"},e.__cname="VOLuckyCatBag",e}(s.VOBag);r.VOLuckyCatBag=u,cc._RF.pop()},{"../../../../../framework/container/Container":void 0,"../VO":"VO","../VOBag":"VOBag"}],VOMonthCard:[function(t,e,r){"use strict";cc._RF.push(e,"f133e3AuZFJnI7S5PuLgP0F","VOMonthCard");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.VOMonthCardBag=r.VOMonthCard=void 0;var a=t("../../../../../framework/container/Container"),l=t("../VO"),s=t("../VOBag"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetRefByCmd=function(){return null},e.prototype.GetResId=function(){return this.cmd.resId},e.prototype.GetState=function(){return this.cmd.rewardState},e.prototype.GetTime=function(){return this.cmd.time},e.__cname="VOMonthCard",i([a.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(l.VO);r.VOMonthCard=c;var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetVOClass=function(){return c},e.prototype.GetCacheName=function(){return"CmdCardCache"},e.__cname="VOMonthCardBag",e}(s.VOBag);r.VOMonthCardBag=u,cc._RF.pop()},{"../../../../../framework/container/Container":void 0,"../VO":"VO","../VOBag":"VOBag"}],VORole:[function(t,e,r){"use strict";cc._RF.push(e,"c25349vwxFJzLjsfEFq2b1R","VORole");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.VORoleBag=r.VORole=void 0;var s=t("../../../../../framework/container/Container"),c=t("../../../../generated/netProto/CmdInterface"),u=t("../../goods/ModelGoods"),p=t("../VO"),f=t("../VOBag"),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getRefId=function(){return null},e.prototype.GetRefByCmd=function(){return null},e.prototype.GetRoleId=function(){return this.cmd.id},e.prototype.GetIcon=function(){return this.GetHeadIconByitemId(this.cmd.img)},e.prototype.GetImg=function(){return this.cmd.img},e.prototype.GetFramIcon=function(){return this.GetHeadIconByitemId(this.cmd.headFrame)},e.prototype.GetFram=function(){return this.cmd.headFrame},e.prototype.GetName=function(){return this.cmd.name},e.prototype.GetLevel=function(){return this.cmd.lv||1},e.prototype.GetCreateTime=function(){return this.cmd.createTime},e.prototype.GetExp=function(){return this.cmd.exp},e.prototype.GetSignTime=function(){return this.cmd.signTime},e.prototype.GetFirstRecharge=function(){return this.cmd.firstRecharge||c.CmdCommonState.UNDONE},e.prototype.GetExpMax=function(){if(this.IsMaxLevel())return 0;var t=this.GetLevel()+1;return this.Ref.RefMgrlevel.getRef("level",t).exp},e.prototype.IsMaxLevel=function(){var t=this.GetLevel();return this.ModelLevel.GetIsMaxLevel(t)},e.prototype.GetCoin=function(){return this.cmd.coin},e.prototype.GetGem=function(){return this.cmd.gem},e.prototype.GetEnd=function(){return this.ModelMgr.ModelSta.GetEnd()},e.prototype.GetEndMax=function(){return this.cmd.maxEndLimit||30},e.prototype.GetQuickTimes=function(){return this.cmd.quickHangTimes},e.prototype.GetHangTime=function(){return this.cmd.hangTime},e.prototype.GetWearEquipList=function(){return this.cmd.equip},e.prototype.GetWearRuneList=function(){return this.cmd.rune},e.prototype.Getpassive=function(){return this.cmd.passiveSkills},e.prototype.GetSpecial=function(){return this.cmd.specialSkills},e.prototype.GetHeroId=function(){return this.cmd.heroId},e.prototype.GetEnergy=function(){return this.cmd.energy},e.prototype.GetDailyActive=function(){return this.cmd.dailyActive},e.prototype.GetWeeklyActive=function(){return this.cmd.weeklyActive},e.prototype.GetDailyActiveTake=function(){return this.cmd.dailyActiveTake},e.prototype.GetWeeklyActiveTake=function(){return this.cmd.weeklyActiveTake},e.prototype.GetTodaySendEndNum=function(){return this.cmd.todaySendEndNum||0},e.prototype.GetTodayTakeEndNum=function(){return this.cmd.todayTakeEndNum||0},e.prototype.GetAttributeBy=function(t){switch(t){case u.ECurrencyType.coin:return this.GetCoin();case u.ECurrencyType.gem:return this.GetGem();case u.ECurrencyType.xp:return this.GetExp();case u.ECurrencyType.sta:return this.GetEnd();case u.ECurrencyType.ep:return this.GetLevel();default:return null}},e.prototype.GetRenameNum=function(){return this.cmd.renameNum||0},e.prototype.GetHeadIconByitemId=function(t){return this.Ref.RefMgrhead.getRef("itemId",t).icon_Key},e.prototype.GetIsFirstSign=function(){return this.cmd.weeklyActive},e.prototype.GetRuntimeAttrList=function(){var t,e,r=this.ModelMgr.ModelBreach.GetBreachAttrsByResId(this.Getpassive()),o=[];try{for(var n=a(r),i=n.next();!i.done;i=n.next()){var s=l(i.value,2),c=s[0],u=s[1];o.push({attr:c,value:u})}}catch(p){t={error:p}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}return o},e.prototype.GetRuntimeSkillGroup=function(){return this.ModelMgr.ModelBreach.GetTlSkillGroupIdByResId(this.GetSpecial())},e.prototype.GetShareState=function(){return this.cmd.alreadyShare||!1},e.__cname="VORole",i([s.injectField("Ref")],e.prototype,"Ref",void 0),i([s.injectField("ModelLevel")],e.prototype,"ModelLevel",void 0),i([s.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(p.VO);r.VORole=h;var y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetVOClass=function(){return h},e.prototype.GetCacheName=function(){return"CmdRole"},e.__cname="VORoleBag",e}(f.VOBag);r.VORoleBag=y,cc._RF.pop()},{"../../../../../framework/container/Container":void 0,"../../../../generated/netProto/CmdInterface":"CmdInterface","../../goods/ModelGoods":"ModelGoods","../VO":"VO","../VOBag":"VOBag"}],VORune:[function(t,e,r){"use strict";cc._RF.push(e,"80d489yGoJOZ4lNfoGPg+mi","VORune");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.VORuneBag=r.VORune=void 0;var a=t("../../../../../framework/FW"),l=t("../../../../../framework/container/Container"),s=t("../../../../../framework/utils/StringUtil"),c=t("./Goods"),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._local_phase=-1,e}return n(e,t),e.prototype.GetRefId=function(){return this.cmd&&this.cmd.resId?this.cmd.resId:this.ref.resId},e.prototype.GetId=function(){return this.cmd?this.cmd.id:0},e.prototype.GetIsPutOn=function(){return this.cmd.isPutOn},e.prototype.GetGoodsType=function(){var t;return null===(t=this.ref)||void 0===t?void 0:t.type},e.prototype.GetRefByCmd=function(){return this.Ref.RefMgrrune.getRef("resId",this.GetRefId())},e.prototype.GetDesc=function(){return this.ref.desc},e.prototype.GetName=function(){return this.ref.name},e.prototype.GetIconUrl=function(){var t=this.ref.icon+"_"+this.GetQuality();return null==t&&a.FW.Log.error("\u56fe\u6807\u5931\u6548 IRefrune name:"+this.ref.name+" resId:"+this.ref.resId+" quality:"+this.GetQuality()),t},e.prototype.GetSkillIconUrl=function(){return this.ref.skillIcon},e.prototype.SetQuality=function(t){this._local_quality=t},e.prototype.SetPhase=function(t){this._local_phase=t},e.prototype.GetQuality=function(){return this._local_quality?this._local_quality:this.cmd?this.cmd.quality:1},e.prototype.GetPhase=function(){return-1!=this._local_phase?this._local_phase:this.cmd?this.cmd.phase:0},e.prototype.GetPhaseStr=function(){return-1!=this._local_phase?""+this._local_phase:this.cmd?""+this.cmd.phase:"0"},e.prototype.GetNameStr=function(){var t=this.Ref.RefMgrresitemquality.getRef("quality",this.GetQuality());return null==t?(a.FW.LWX.error("\u54c1\u8d28\u989c\u8272\u83b7\u53d6\u51fa\u9519,\u8bf7\u68c0\u67e5,quality:",this.GetQuality()),this.GetName()):s.StringUtil.format("[color={0}]{1}[/color]",t.color,this.GetName())},e.prototype.GetQuiltySkill=function(){return this.ModelRune.GetQuiltySkill(this.GetRefId())},e.prototype.GetIsShowPhase=function(){return this.GetPhase()>0},e.prototype.GetAdditionValue=function(){return this.ModelRune.GetRuneAttribute1(this.GetGoodsType(),this.GetQuality(),this.GetPhase())},e.prototype.GetAdditionType=function(){return this.ModelRune.GetRuneAttributeType(this.GetGoodsType())},e.prototype.GetRuntimeAttrList=function(){var t=this.GetAdditionType(),e=this.GetAdditionValue(),r=[];return r.push({attr:t,value:e}),r},e.prototype.GetRuntimeSkillGroup=function(){var t=this.GetQuiltySkill(),e=[],r=this.GetQuality(),o=t.find(function(t){return t.quality==r});return o&&e.push(o.skillGroupId),e},e.prototype.OnGetNumber=function(){return 1},e.prototype.GetIconEffect=function(){return this.ModelRune.GetIsMaxQuality(this.GetQuality())&&this.ref.iconEffect||null},e.prototype.GetUnderEffect=function(){return this.ModelRune.GetIsMaxQuality(this.GetQuality()),null},e.__cname="VORune",i([l.injectField("Ref")],e.prototype,"Ref",void 0),i([l.injectField("ModelRune")],e.prototype,"ModelRune",void 0),e}(c.Goods);r.VORune=u;var p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetVOClass=function(){return u},e.prototype.GetCacheName=function(){return"CmdRune"},e.__cname="VORuneBag",e}(c.GoodsBag);r.VORuneBag=p,cc._RF.pop()},{"../../../../../framework/FW":void 0,"../../../../../framework/container/Container":void 0,"../../../../../framework/utils/StringUtil":void 0,"./Goods":"Goods"}],VOServerRedDot:[function(t,e,r){"use strict";cc._RF.push(e,"edd4cXjKRZMpY2Z48C7MJKT","VOServerRedDot");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.VOServerRedDotBag=r.VOServerRedDot=void 0;var a=t("../../../../../framework/container/Container"),l=t("../VO"),s=t("../VOBag"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetRefByCmd=function(){return null},e.prototype.GetRedDotType=function(){return this.cmd.redDotType},e.prototype.GetNumber=function(){return this.cmd.number},e.__cname="VOServerRedDot",i([a.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(l.VO);r.VOServerRedDot=c;var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetVOClass=function(){return c},e.prototype.GetCacheName=function(){return"CmdRedDotCache"},e.__cname="VOServerRedDotBag",e}(s.VOBag);r.VOServerRedDotBag=u,cc._RF.pop()},{"../../../../../framework/container/Container":void 0,"../VO":"VO","../VOBag":"VOBag"}],VOSpecialGift:[function(t,e,r){"use strict";cc._RF.push(e,"6148cB0TIRF/5eDTTqKGMEu","VOSpecialGift");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.VOSpecialGiftBag=r.VOSpecialGift=void 0;var a=t("../../../../../framework/container/Container"),l=t("../VO"),s=t("../VOBag"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetRefId=function(){return this.cmd&&this.cmd.resId?this.cmd.resId:this.ref.resId},e.prototype.GetRefByCmd=function(t){return this.Ref.RefMgrspecialGift.getRef("resId",t.resId)},e.prototype.GetBuyState=function(){return this.cmd.state},e.prototype.GetResId=function(){return this.cmd.resId},e.prototype.GetEndTime=function(){return this.cmd.endTime},e.prototype.GetFromId=function(){return this.GetRef().fromId},e.prototype.GetDesc=function(){return this.GetRef().desc},e.__cname="VOSpecialGift",i([a.injectField("Ref")],e.prototype,"Ref",void 0),e}(l.VO);r.VOSpecialGift=c;var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetVOClass=function(){return c},e.prototype.GetCacheName=function(){return"CmdSpecialGiftCache"},e.__cname="VOSpecialGiftBag",e}(s.VOBag);r.VOSpecialGiftBag=u,cc._RF.pop()},{"../../../../../framework/container/Container":void 0,"../VO":"VO","../VOBag":"VOBag"}],VO:[function(t,e,r){"use strict";cc._RF.push(e,"e7808MWtopCSKFZJbjFPkSd","VO"),Object.defineProperty(r,"__esModule",{value:!0}),r.VO=void 0;var o=function(){function t(){}return t.prototype.InitByCmd=function(t){this.cmd=t,this.ref=this.GetRefByCmd(t)},t.prototype.InitByRef=function(t){this.ref=t,this.cmd=null},t.prototype.GetRef=function(){return this.ref},t.prototype.GetCmd=function(){return this.cmd},t.prototype.SetCmd=function(t){this.cmd=t},t.prototype.GetClass=function(){return this.constructor},t.__cname="VO",t}();r.VO=o,cc._RF.pop()},{}],VarChapterLiveTime:[function(t,e,r){"use strict";cc._RF.push(e,"7f5cbccv3BJ4pPgERe9kpEV","VarChapterLiveTime");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.VarChapterTime=void 0;var a=t("../../../../../framework/container/Container"),l=t("../../../../../framework/expr/ExprVarBase"),s=t("../../../../../framework/utils/Toolset"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnEnter=function(){this.CheckSubSet()},e.prototype.OnComputeResult=function(){this.toolSet||(this.toolSet=s.ToolSet.createToolSet()),this.CheckSubSet();var t=this.GetP2()||0,e=this.subSet.GetOneVO();return e&&e.GetLiveTime()>=t},e.prototype.CheckSubSet=function(){var t=this;if(null==this.subSet){var e=this.ModelMgr.ModelVO.VOChapterBag.CreateSubset(),r=this.GetP1();e.SetFilter(function(t){return t.GetResId()==r}),this.subSet=e,this.toolSet.addListener(this.subSet.GetEventProxy(),"OnChanged",function(){t.MarkDirty()},this),this.toolSet.addDefer(function(){t.ModelMgr.ModelVO.VOChapterBag.DestroySubset(t.subSet),t.subSet=null})}},e.__cname="VarChapterTime",i([a.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(l.ExprVarBase);r.VarChapterTime=c,cc._RF.pop()},{"../../../../../framework/container/Container":void 0,"../../../../../framework/expr/ExprVarBase":void 0,"../../../../../framework/utils/Toolset":void 0}],VarClose:[function(t,e,r){"use strict";cc._RF.push(e,"e39bdF29KFLTramUSQV6hil","VarClose");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.VarClose=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnEnter=function(){},e.prototype.OnExit=function(){},e.prototype.OnComputeResult=function(){return!1},e.__cname="VarClose",e}(t("../../../../../framework/expr/ExprVarBase").ExprVarBase);r.VarClose=i,cc._RF.pop()},{"../../../../../framework/expr/ExprVarBase":void 0}],VarEquipNumber:[function(t,e,r){"use strict";cc._RF.push(e,"3ca401r2wZB9JFL+AWD4aGX","VarEquipNumber");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.VarEquipNumber=void 0;var a=t("../../../../../framework/container/Container"),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnEnter=function(){var t=this;this.equipSubset=this.ModelMgr.ModelVO.VOEquipBag.CreateSubset(),this.equipSubset.SetFilter(function(){return!0}),this.toolSet.addDefer(function(){t.ModelMgr.ModelVO.VOEquipBag.DestroySubset(t.equipSubset),t.equipSubset=null}),this.toolSet.addListener(this.equipSubset.GetEventProxy(),"OnChanged",function(){t.MarkDirty()},this)},e.prototype.OnComputeResult=function(){var t=this.equipSubset.GetTlVO(),e=this.GetP1();return e?t.length>=e:t.length},e.__cname="VarEquipNumber",i([a.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(t("../../../../../framework/expr/ExprVarBase").ExprVarBase);r.VarEquipNumber=l,cc._RF.pop()},{"../../../../../framework/container/Container":void 0,"../../../../../framework/expr/ExprVarBase":void 0}],VarFinishChapter:[function(t,e,r){"use strict";cc._RF.push(e,"5864cijCmZOI5HcwiF2t45g","VarFinishChapter");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.VarFinishChapter=void 0;var a=t("../../../../../framework/container/Container"),l=t("../../../../../framework/expr/ExprVarBase"),s=t("../../../../../framework/utils/Toolset"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnEnter=function(){this.CheckSubSet()},e.prototype.OnExit=function(){},e.prototype.OnComputeResult=function(){this.toolSet||(this.toolSet=s.ToolSet.createToolSet()),this.CheckSubSet();var t=this.subSet.GetOneVO();return t&&t.GetIsClearance()},e.prototype.CheckSubSet=function(){var t=this;if(null==this.subSet){var e=this.ModelMgr.ModelVO.VOChapterBag.CreateSubset(),r=this.GetP1();e.SetFilter(function(t){return t.GetRef().key==r||t.GetResId()==r}),this.subSet=e,this.toolSet.addListener(this.subSet.GetEventProxy(),"OnChanged",function(){t.MarkDirty()},this),this.toolSet.addDefer(function(){t.ModelMgr.ModelVO.VOChapterBag.DestroySubset(t.subSet),t.subSet=null})}},e.__cname="VarFinishChapter",i([a.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(l.ExprVarBase);r.VarFinishChapter=c,cc._RF.pop()},{"../../../../../framework/container/Container":void 0,"../../../../../framework/expr/ExprVarBase":void 0,"../../../../../framework/utils/Toolset":void 0}],VarFirstRechargeState:[function(t,e,r){"use strict";cc._RF.push(e,"ea323mvf71EyLsctABM2gn2","VarFirstRechargeState");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.VarFirstRechargeState=void 0;var a=t("../../../../../framework/container/Container"),l=t("../../../../../framework/expr/ExprVarBase"),s=t("../../../../generated/netProto/CmdInterface"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnEnter=function(){var t=this;this.toolSet.addListener(this.ModelMgr.ModelVO.VORoleBag.GetEventProxy(),"OnChanged",function(){t.MarkDirty()},this)},e.prototype.OnExit=function(){},e.prototype.OnComputeResult=function(){var t=this.ModelMgr.ModelVO.VORoleBag.GetOne();return!!t&&t.GetFirstRecharge()<=s.CmdCommonState.FINISH},e.__cname="VarFirstRechargeState",i([a.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(l.ExprVarBase);r.VarFirstRechargeState=c,cc._RF.pop()},{"../../../../../framework/container/Container":void 0,"../../../../../framework/expr/ExprVarBase":void 0,"../../../../generated/netProto/CmdInterface":"CmdInterface"}],VarFundVisible:[function(t,e,r){"use strict";cc._RF.push(e,"07245LepBVAX5NVGb3pFhCM","VarFundVisible");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(n,i){function a(t){try{s(o.next(t))}catch(e){i(e)}}function l(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(l){i=[6,l],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.VarFundVisible=void 0;var s=t("../../../../../framework/container/Container"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnEnter=function(){return a(this,void 0,Promise,function(){var t=this;return l(this,function(){return this.toolSet.addListener(this.ModelMgr.ModelFund.GetEventProxy(),"OnUpdateFund",function(){t.MarkDirty()},this),this.toolSet.addListener(this.ModelMgr.ModelVO.VORoleBag.GetEventProxy(),"OnChanged",function(){t.MarkDirty()},this),[2]})})},e.prototype.OnExit=function(){},e.prototype.OnComputeResult=function(){return this.ModelMgr.ModelFund.GetFundVisable()},e.__cname="VarFundVisible",i([s.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(t("../../../../../framework/expr/ExprVarBase").ExprVarBase);r.VarFundVisible=c,cc._RF.pop()},{"../../../../../framework/container/Container":void 0,"../../../../../framework/expr/ExprVarBase":void 0}],VarHasChapterReward:[function(t,e,r){"use strict";cc._RF.push(e,"83f4dHSqRpC1JRt+gn8UW0g","VarHasChapterReward");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.VarHasChapterReward=void 0;var l=t("../../../../../framework/container/Container"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnEnter=function(){var t=this;this.toolSet.addListener(this.ModelMgr.ModelVO.VOChapterBag.GetEventProxy(),"OnChanged",function(){t.MarkDirty()},this)},e.prototype.OnExit=function(){},e.prototype.OnComputeResult=function(){var t,e,r=this.ModelMgr.ModelVO.VOChapterBag.GetBagAsArray();try{for(var o=a(r),n=o.next();!n.done;n=o.next())if(n.value.GetRewardNum()>0)return!0}catch(i){t={error:i}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}return!1},e.__cname="VarHasChapterReward",i([l.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(t("../../../../../framework/expr/ExprVarBase").ExprVarBase);r.VarHasChapterReward=s,cc._RF.pop()},{"../../../../../framework/container/Container":void 0,"../../../../../framework/expr/ExprVarBase":void 0}],VarHasHeroOrEquip:[function(t,e,r){"use strict";cc._RF.push(e,"ea335TlBXFBILODRO4YJXYY","VarHasHeroOrEquip");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.VarHasHeroOrEquip=void 0;var a=t("../../../../../framework/container/Container"),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnEnter=function(){var t=this;this.toolSet.addListener(this.ModelMgr.ModelVO.VOHeroBag.GetEventProxy(),"OnChanged",function(){t.MarkDirty()}),this.toolSet.addListener(this.ModelMgr.ModelVO.VOEquipBag.GetEventProxy(),"OnChanged",function(){t.MarkDirty()}),this.MarkDirty()},e.prototype.OnExit=function(){},e.prototype.OnComputeResult=function(){return this.ModelMgr.ModelVO.VOHeroBag.GetBag().size>=2||this.ModelMgr.ModelVO.VOEquipBag.GetBag().size>=1},e.__cname="VarHasHeroOrEquip",i([a.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),e}(t("../../../../../framework/expr/ExprVarBase").ExprVarBase);r.VarHasHeroOrEquip=l,cc._RF.pop()},{"../../../../../framework/container/Container":void 0,"../../../../../framework/expr/ExprVarBase":void 0}],VarHasLuckyCat:[function(t,e,r){"use strict";cc._RF.push(e,"13750h8xzhI8KfOdbySzBka","VarHasLuckyCat");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.VarHasLuckyCat=void 0;var a=t("../../../../../framework/container/Container"),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnEnter=function(){var t=this;this.toolSet.addListener(this.ModelMgr.ModelVO.VOLuckyCatBag.GetEventProxy(),"OnChanged",function(){t.MarkDirty()},this),this.CheckEndTime()},e.prototype.OnExit=function(){this.timer&&(this.toolSet.removeDelay(this.timer),this.timer=null)},e.prototype.OnComputeResult=function(){var t=this.ModelMgr.ModelVO.VOLuckyCatBag.GetOne();if(this.log("luckyCat:",t),null==t)return!1;this.CheckEndTime();var e=1e3*this.TimeUtil.now();return this.log("luckyCat1:",e<t.GetEndTime()),e<t.GetEndTime()},e.prototype.CheckEndTime=function(){var t=this;this.timer&&(this.toolSet.removeDelay(this.timer),this.timer=null);var e=this.ModelMgr.ModelVO.VOLuckyCatBag.GetOne();if(null!=e){var r=1e3*this.TimeUtil.now(),o=.001*(e.GetEndTime()-r);if(!(o<0)){var n=this.toolSet.addDelay(o+1,function(){t.MarkDirty()});this.timer=n}}},e.__cname="VarHasLuckyCat",i([a.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([a.injectField("TimeUtil")],e.prototype,"TimeUtil",void 0),e}(t("../../../../../framework/expr/ExprVarBase").ExprVarBase);r.VarHasLuckyCat=l,cc._RF.pop()},{"../../../../../framework/container/Container":void 0,"../../../../../framework/expr/ExprVarBase":void 0}],VarHasShareType:[function(t,e,r){"use strict";cc._RF.push(e,"6cb2dskYC9G568hMIKzvXw7","VarHasShareType");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.VarHasShareType=void 0;var a=t("../../../../../framework/container/Container"),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnEnter=function(){this.MarkDirty()},e.prototype.OnExit=function(){},e.prototype.OnComputeResult=function(){return this.SDKMgr.getSDK().CheckCanShare()},e.__cname="VarHasShareType",i([a.injectField("SDKMgr")],e.prototype,"SDKMgr",void 0),i([a.injectField("TimeUtil")],e.prototype,"TimeUtil",void 0),e}(t("../../../../../framework/expr/ExprVarBase").ExprVarBase);r.VarHasShareType=l,cc._RF.pop()},{"../../../../../framework/container/Container":void 0,"../../../../../framework/expr/ExprVarBase":void 0}],VarHasSpecialGift:[function(t,e,r){"use strict";cc._RF.push(e,"0d352Fyf2lHQ5ftpcLeRUac","VarHasSpecialGift");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.VarHasSpecialGift=void 0;var a=t("../../../../../framework/container/Container"),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnEnter=function(){var t=this;this.toolSet.addListener(this.ModelMgr.ModelVO.VOSpecialGiftBag.GetEventProxy(),"OnChanged",function(){t.MarkDirty()},this),this.CheckEndTime()},e.prototype.OnExit=function(){this.timer&&(this.toolSet.removeDelay(this.timer),this.timer=null)},e.prototype.OnComputeResult=function(){var t=this.ModelMgr.ModelVO.VOSpecialGiftBag.GetOne();return null!=t&&(this.CheckEndTime(),1e3*this.TimeUtil.now()<t.GetEndTime())},e.prototype.CheckEndTime=function(){var t=this;this.timer&&(this.toolSet.removeDelay(this.timer),this.timer=null);var e=this.ModelMgr.ModelVO.VOSpecialGiftBag.GetOne();if(null!=e){var r=1e3*this.TimeUtil.now(),o=.001*(e.GetEndTime()-r);if(!(o<0)){var n=this.toolSet.addDelay(o+1,function(){t.MarkDirty()});this.timer=n}}},e.__cname="VarHasSpecialGift",i([a.injectField("ModelMgr")],e.prototype,"ModelMgr",void 0),i([a.injectField("TimeUtil")],e.prototype,"TimeUtil",void 0),e}(t("../../../../../framework/expr/ExprVarBase").ExprVarBase);r.VarHasSpecialGift=l,cc._RF.pop()},{"../../../../../framework/container/Container":void 0,"../../../../../framework/expr/ExprVarBase":void 0}],VarNotTishen:[function(t,e,r){"use strict";cc._RF.push(e,"df73bCtVUFLSratWa6Verfc","VarNotTishen");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.VarNotTishen=void 0;var i=t("../../../../../framework/expr/ExprVarBase"),a=t("../../public/AppCustomData"),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnEnter=function(){},e.prototype.OnExit=function(){},e.prototype.OnComputeResult=function(){return!a.AppCustomData.instance.audit},e.__cname="VarNotTishen",e}(i.ExprVarBase);r.VarNotTishen=l,cc._RF.pop()},{"../../../../../framework/expr/ExprVarBase":void 0,"../../public/AppCustomData":"AppCustomData"}],VarOpen:[function(t,e,r){"use strict";cc._RF.push(e,"176bepLMOxFHZ/0tQs7FQV6","VarOpen");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.VarOpen=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnEnter=function(){},e.prototype.OnExit=function(){},e.prototype.OnComputeResult=function(){return!0},e.__cname="VarOpen",e}(t("../../../../../framework/expr/ExprVarBase").ExprVarBase);r.VarOpen=i,cc._RF.pop()},{"../../../../../framework/expr/ExprVarBase":void 0}],VarRoleLevel:[function(t,e,r){"use strict";cc._RF.push(e,"cc598O2ICFDlJiV9a8yRI1A","VarRoleLevel");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.VarRoleLevel=void 0;var a=t("../../../../../framework/container/Container"),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnEnter=function(){var t=this;this.toolSet.addListener(this.ModelVO.VORoleBag.GetEventProxy(),"OnChanged",function(){t.MarkDirty()},this)},e.prototype.OnExit=function(){},e.prototype.OnComputeResult=function(){var t=this.ModelVO.VORoleBag.GetOne(),e=this.GetP1();return t&&t.GetLevel()>=e||!1},e.__cname="VarRoleLevel",i([a.injectField("ModelVO")],e.prototype,"ModelVO",void 0),e}(t("../../../../../framework/expr/ExprVarBase").ExprVarBase);r.VarRoleLevel=l,cc._RF.pop()},{"../../../../../framework/container/Container":void 0,"../../../../../framework/expr/ExprVarBase":void 0}],WXDataReportingHelper:[function(t,e,r){"use strict";cc._RF.push(e,"be5eeyUnFxEJ5FK9CzqDqMO","WXDataReportingHelper");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.WXDataReportingHelper=void 0;var i=t("../../../../../engine/EngineMain"),a=t("../../../../../framework/utils/WxUtil"),l=t("./DataReportingHelper"),s=function(t){function e(){var e=t.call(this)||this;return e.systemInfo=null,e.GetSystemInfo(),e}return n(e,t),e.prototype.GetSystemInfo=function(){var t=this;a.WxUtil.wx.getSystemInfo({success:function(e){console.log("\u83b7\u53d6wx\u4fe1\u606f\u6210\u529f,",e),t.systemInfo=e},fail:function(){console.log("\u83b7\u53d6wx\u4fe1\u606f\u5931\u8d25")}})},e.prototype.GetAPIVersion=function(){return""},e.prototype.GetClientVersion=function(){return this.appCustomData.serverVersion},e.prototype.GetCreative=function(){return this.appCustomData.channel},e.prototype.GetExtra=function(){return"1"},e.prototype.GetGameId=function(){return this.appCustomData.gameId},e.prototype.GetPhone=function(){return this.systemInfo.model||""},e.prototype.GetRatio=function(){return cc.view.getFrameSize().toString()},e.prototype.GetServerId=function(){var t,e=(null===(t=this.ModelMgr.ModelAccount.getServerAddress())||void 0===t?void 0:t.id)||0;return String(e)},e.prototype.GetSource=function(){return cc.sys.os},e.prototype.GetSystem=function(){return this.systemInfo.system||""},e.prototype.GetUdId=function(){var t=i.EngineMain.readLocalStorage("account_num","null"),e=i.EngineMain.readLocalStorage("UUID"+t,"");return""!=e&&(this._udid=e),""==this._udid&&(this._udid=l.UniqueId.createUniqueId()+"-"+this.GetPhone()+"-"+this.GetSystem()),this._udid},e.__cname="WXDataReportingHelper",e}(l.DataReportingHelper);r.WXDataReportingHelper=s,cc._RF.pop()},{"../../../../../engine/EngineMain":void 0,"../../../../../framework/utils/WxUtil":void 0,"./DataReportingHelper":"DataReportingHelper"}],WaveType:[function(t,e,r){"use strict";cc._RF.push(e,"84633iETtNCTIYiNSXuaC1E","WaveType"),Object.defineProperty(r,"__esModule",{value:!0}),r.WaveType=void 0,function(t){t[t.Square=0]="Square",t[t.SquareAngle=1]="SquareAngle",t[t.Ring=2]="Ring",t[t.TopBot=3]="TopBot",t[t.LeftRight=4]="LeftRight",t[t.Boss=99]="Boss",t[t.Box=999]="Box"}(r.WaveType||(r.WaveType={})),cc._RF.pop()},{}],newScreenAdapter:[function(t,e,r){"use strict";cc._RF.push(e,"19caaFZEFZK3ZPSiPsaBAIP","newScreenAdapter");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__decorate||function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(r,"__esModule",{value:!0});var a=cc._decorator,l=a.ccclass,s=(a.property,a.executionOrder),c=a.help,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isScreenAdapter=!0,e.isScreenAdapterResize=!0,e}var r;return n(e,t),r=e,e.prototype.onLoad=function(){cc.game.setFrameRate(30),cc.debug.setDisplayStats(!1),this.startAdapter()},e.prototype.startAdapter=function(){var t=this;this.isScreenAdapter&&(this.isScreenAdapterResize?(console.log("===setResizeCallback true,\u76d1\u542c\u7a97\u53e3\u5927\u5c0f\u53d8\u5316==="),cc.view.setResizeCallback(function(){t.adapter(),r.resizeCallback()})):console.log("===setResizeCallback false,\u4e0d\u76d1\u542c\u7a97\u53e3\u5927\u5c0f\u53d8\u5316==="),this.adapter())},e.prototype.adapter=function(){var t=cc.winSize,e=cc.Canvas.instance.designResolution,o=t.width/t.height,n=t.height/t.width,i=e.width/e.height;console.log("===\u7a97\u53e3\u5927\u5c0f\u53d8\u5316==="),console.log("winSize: ",t.width,t.height,o,n),console.log("designResolution: ",e.width,e.height,i,e.height/e.width);var a=null===fgui||void 0===fgui?void 0:fgui.GRoot;if(a&&a._inst){var l=fgui.GRoot.inst,s=l.width/l.height;console.log("fgui: ",l.width,l.height,s,l.height/l.width)}n>=2&&(r.isFullPhone=!0);var c;c=o<=1&&o<=i?this.setFixWidth():this.setFixHeight(),this._preStrategy!=c&&(this._preStrategy=c,cc.view._resizeEvent(!0))},e.prototype.setFixHeight=function(){console.log("===setFixHeight,\u9ad8\u5145\u6ee1,\u5bbd\u81ea\u52a8\u9002\u914d===");var t=cc.Canvas.instance;return t.fitHeight=!0,t.fitWidth=!1,1},e.prototype.setFixWidth=function(){console.log("===setFixWidth,\u5bbd\u5145\u6ee1, \u9ad8\u81ea\u52a8\u9002\u914d===");var t=cc.Canvas.instance;return t.fitHeight=!1,t.fitWidth=!0,2},e.prototype.fixShowAll=function(){console.log("===fixShowAll,\u6709\u9ed1\u8fb9,\u8bbe\u8ba1\u5206\u8fa8\u7387\u8303\u56f4\u7684\u6240\u6709\u5185\u5bb9\u90fd\u663e\u793a\u5728\u5c4f\u5e55\u4e0a===");var t=cc.Canvas.instance;t.fitHeight=!0,t.fitWidth=!0},e.prototype.fixNoBorder=function(){console.log("===fixNoBorder,\u53ef\u80fd\u88ab\u526a\u88c1,\u6ca1\u9ed1\u8fb9,\u8bbe\u8ba1\u5206\u8fa8\u7387\u8303\u56f4\u7684\u6240\u6709\u5185\u5bb9\u90fd\u663e\u793a\u5728\u5c4f\u5e55\u4e0a===");var t=cc.Canvas.instance;t.fitHeight=!1,t.fitWidth=!1},e.resizeCallback=function(){},e.isFullPhone=!1,r=i([l,s(0),c("https://docs.cocos.com/creator/manual/zh/ui/multi-resolution.html")],e)}(cc.Component);r.default=u,cc._RF.pop()},{}]},{},["App","AppMain","Global","AppBridge","ConstBradge","TestConstraint","TestCor","TestExpr","TestGeometry","TestGloader","TestGobjGoods","TestHttp","TestJSBridge","TestPhysis","TestPopupPanel","TestPromise","TestQuickSort","TestRef","TestSocket","GameBehavior","ActivityObject","ActivityObjectList","ActivityObjectSubset","CtrlActivity","LayerNewPlayerSign","LayerSevenDayChallenge","CtrlBehavior","CtrlMgr","DataReporting","DataReportingInterface","SDKDataReporting","BrowserDataReportingHelper","DataReportingHelper","DataReportingHelperMgr","DefaultDataReportingHelper","WXDataReportingHelper","LayerDayWeekMonthGift","LayerEveryDaySignIn","CtrlLuckyCat","LayerLuckyCat","CtrlPay","ObjPayGift","CtrlPlayer","LayerPlayerDetail","CtrlAlert","LayerBuyGoods","LayerDisconnect","LayerMessage","LayerShowTip","LayerTipBuy","LayerWaiting","LayerHeroGet","LayerRewardDetail","LayerShowRewards","PanelPopInfo","PanelPopUse","CtrlAnimation","AttrWrap","AttrWrapHandler","CtrlAttr","SubAttr","SubAttrBreach","SubAttrBuff","SubAttrEquip","SubAttrHero","SubAttrRune","CtrlAudio","Battle","BattleStartConfig","BattleUtil","ConstBattle","CtrlBattle","LayerBattle","LayerBattleDebug","BaseBattleGroupSet","BaseBattleSystem","BaseSubBattleSystem","BattleConfigBase","BattleConfigChapter","BattleConfigDaily","BattleConfigField","BattleConfigGold","BattleConfigGuide","LayerBatterCommand","SubDebugCommand","SubDebugDraw","SystemDebug","SystemGraph","BaseLogicSystem","SystemDamage","SystemMap","SystemTarget","ComAI","SubAI","SystemAI","BTTest","BTActionIdle","BTActionRun","BTActionUseSkill","BTAction","BTFactory","BTNode","BTTree","BTDataSkill","ConstBattleBT","BTCheckDistance","BTCheckSkillReady","BTPercondiction","BTInvert","BTParallel","BTPriority","BTPrioritySelector","BTPrioritySequence","BTBoss","BTBossCharge","BTBossRemote","BTBossStatic","SubAIBehaviorTree","SubAIControllable","SubAIIdle","SubAISeek","SubAIWander","BO","BOBag","BOBagSubset","BOMgr","ComBuffCarrier","SystemBuffCarrier","SBCEffect","SBCEffectAddBuff","SBCEffectInvincible","SBCEffectMgr","SBCEffectModifyAttr","SBCEffectReborn","SBCEffectRestorePrecent","SBCEffectShootBullet","SBCEffectTakedamageHPP","BaseSubBuffCarrier","BuffCarrierBleed","BuffCarrierHandler","BuffCarrierInsectCoat","BuffCarrierJacket","BuffCarrierProtective","BuffCarrierReborn","BuffCarrierRebornEffect","BuffCarrierSlow","BuffCarrier_300060","BuffCarrier_300061","BuffCarrier_300070","BuffCarrier_300080","BuffCarrier_300090","BuffCarrier_300100","BuffCarrier_300101","BuffCarrier_300110","BuffCarrier_300111","BuffCarrier_300120","BuffCarrier_300130","BuffCarrier_300140","BuffCarrier_300150","BuffCarrier_300160","BuffCarrier_300161","BuffCarrier_300170","BuffCarrier_300180","BuffCarrier_300190","BuffCarrier_300200","BuffCarrier_300210","BuffCarrier_300220","BuffCarrier_300230","BuffCarrier_300240","BuffCarrier_300241","BuffCarrier_300250","BuffCarrier_300500","BuffCarrier_300520","BuffCarrier_300521","BuffCarrier_300530","BuffCarrier_300540","BuffCarrier_300550","SubBuffCarrierMgr","SubSysBCTrigger","SubSysRoleStatus","SBCTrigger","SBCTriggerMSAtk","SBCTriggerMSMove","SBCTriggerMSTimer","SBCTriggerMgr","SBCTriggerOnBeHit","SBCTriggerOnHpChange","SBCTriggerOnImmediately","SBCTriggerOnKillEliteOrBoss","SBCTriggerOnKillMonster","SBCTriggerOnReadyDie","SBCTriggerOnRestore","SBCTriggerOnTake","BaseBattleBuffBehavior","BattleBuffBehaviorMgr","BattleBuffProxy","BuffVar","SystemBuff","BaseBattleBehavior","BaseBattleCustomBehavior","BattleAttrBehavior","BattleBuff_201104","BattleBuff_201206","BattleBuff_201304","BattleBuff_201503","BattleBuff_201504","BattleDoAddBuff","BattleSkillAttrBehavior","BattleLuncherBehavior","BattleLuncher_1010331","BProp","BPropBoom","BPropExpBall","BPropGold","BPropGoldChest","BPropItem","BPropMagnet","BPropRestore","BPropSkillChest","BPropVulcan","ChestMgr","PropMgr","SystemCommon","RoulettelProxy","SystemEquipment","SystemEvent","SubGamePlay","SystemGamePlay","ConstSubGameplay","GPAudio","GPChest","GPDamageStastic","GPEvolution","GPGameover","GPGuide","GPHeroSkill","GPHeroSupply","GPLevelUp","GPNetDisconnet","GPNetSync","GPOCure_pre","GPOItem","GPOSkill","GPOSkillModify","GPOSpecialEffect","GPOSupply","GPPlaySound","GPSkillData","GPSpecialEffect","GPStart","GPStartDrop","GPDradObject","GPDraw","GPDrawObjectCure","GPDrawObjectGold","GPDrawObjectSkill","GPDrawObjectSupply","Handler","HandlerCollider","SystemHandler","ComPos","ComVelocity","SystemMove","ComCollision","SystemCollision","SystemRigidbody","RBBat","RBBoom","RBBoomerange","RBBoomerangeSuper","RBBoomerangeSuperFire","RBBox","RBBrick","RBCrossBow","RBDart","RBDartSuperRed","RBDrill","RBDrillSuper","RBDurian","RBDurianSuper","RBField","RBFieldSlow","RBFollow","RBFootball","RBGuarder","RBHero","RBLightning","RBLightningSuper","RBMissile","RBMolotov","RBMonster","RBPulses","RBRadiation","RBRobotBullet","RBStorm","RBStraights","RBSwordField","RBVenom","RoleBuilder","SystemRole","BaseSkill","ComSkill","SkillEventBase","SkillEventHelper","SkillTriggerBase","SkillTriggerHelper","SystemSkill","SkillContext","BaseSkillHandler","SkillHandlerDart","BaseHeroSkill","HeroSkillBat","HeroSkillBoomerange","HeroSkillBoomerangeSuper","HeroSkillBow","HeroSkillBrick","HeroSkillBrickSuper","HeroSkillDart","HeroSkillDartSuper","HeroSkillDrill","HeroSkillDrillSuper","HeroSkillDurian","HeroSkillDurianSuper","HeroSkillField","HeroSkillFieldSuper","HeroSkillFootball","HeroSkillGuarder","HeroSkillGuarderSuper","HeroSkillKanata","HeroSkillKanataS","HeroSkillLightning","HeroSkillLunhui","HeroSkillMissile","HeroSkillMolotov","HeroSkillRobotBullet","HeroSkillRobotBulletSuper","HeroSkillShotgun","HeroSkillShotgunSuper","HeroSkillSwordField","BaseOthersSkill","OtherSkillBrickSuper","OtherSkillCharge","OtherSkillCircle","OtherSkillDeathWhisper","OtherSkillGuarder","OtherSkillSelfBoom","OtherSkillShotgun","OthersSkillDart","TriggerCountdown","ConstSpawn","SystemSpawn","WaveType","SBBoss","SBBox","SBLeftRight","SBRing","SBSquare","SBSquareAngle","SBTopBot","SpawnBuilder","SpawnBaseState","SpawnFSM","SpawnStateBoss","SpawnStateDebugField","SpawnStateIdle","SpawnStateSpawn","SubSpawn","SubSpawnBox","SubSpawnBuilder","SubSpawnCameraZoom","SubSpawnClear","SubSpawnMonster","SubSpawnPrefab","SubSpawnTimer","SubSpawnTips","ComState","SubState","SystemState","SubStateConjure","SubStateDestroy","SubStateDie","SubStateIdle","SubStateMove","BaseBulletSubState","SubStateBat","SubStateBoom","SubStateBoomerange","SubStateBoomerangeSuper","SubStateBrick","SubStateCrossBow","SubStateDart","SubStateDartSuperRed","SubStateDrill","SubStateDrillSuper","SubStateDurian","SubStateField","SubStateFieldSlow","SubStateFollow","SubStateFootball","SubStateGuarder","SubStateLightning","SubStateLightningSuper","SubStateMissile","SubStateMolotov","SubStatePulses","SubStateRadiation","SubStateRobotBullet","SubStateStorm","SubStateStraight","SubStateSwordField","SubStateVenom","SubStateCharge","SubStateChargeLeave","SubStateKeep","SubStateReborn","SubStateSeek","SubStateSelfBoom","SubStateShoot","SubStateStatic","SubStateWander","SubStateWanderVertical","ComType","BattleAttr","ComRole","ComVar","ConstAttr","SystemVar","ModelBattleDrop","ModelBattleLevel","ModelBattleSkill","ModelBattleStatus","ModelBattleWave","CollisionUtil","BaseViewSystem","CtrlBattleView","CullingGroup","SystemDamageText","SystemView","SystemViewCulling","SystemViewEffect","SystemViewProp","SystemViewWedgit","SystemAsset","Brocast","BrocastDamage","SystemBrocast","SubSysCameraFollow","SubSysCameraZoom","SystemCamera","BattleLayerOrder","HeroReticleComPanel","HeroUIComPanel","SubComPanel","LayerBatterCamerEffect","LayerBattleChest","LayerBattleDamageText","LayerBattleExitTips","LayerBattlePause","LayerDamageStastic","LayerFightGuide","LayerJoystick","LayerReborn","LayerRolePanel","LayerSelectUpgrade","LayerSettle","LayerSkillReplace","LayerSkillReplaceTips","LayerTopMenu","LayerUnlockSkill","SubSysEffectWarning","JoystickModule","SystemJoystick","NodeProxy","NodeProxyMgr","SystemNode","ComPrefab","BasePrefabBehavior","FlipPrefabBehavior","RobotPrefabBehavior","SystemSpawnPreload","CtrlBuff","BuffBehavior","BuffProxy","BuffTrigger","BuffTriggerCounter","SkillGroupMgr","SysAttrBehavior","SysBuffBehaviorMgr","CtrlClickOnEffect","LayerClickOnEffect","LayerFirstRecharge","LayerFund","CtrlGameLogin","CtrlGameNet","CtrlGM","LayerGMEntrance","LayerGMMain","TabGMCacheList","TabGMClient","TabGMCommand","CtrlGoods","EquipBehavior","GObjGoodsBehavior","ItemBehavior","RuneBehavior","CtrlGuide","GuideBehaviorBase","GuideSection","GuideSectionMgr","LayerGuide","ClickScript","FightScript","GuideScript","FirstBattleSection","FirstEnterGame","FirstEnterMallSection","FirstSelectBattleSkillSection","CtrlJoint","CtrlLogin","LayerAccount","LayerAgeTip","LayerLogin","LayerLoginLoading","CtrlAdventure","LayerAdventureBuff","TabAdventure","CtrlMain","LayerEquipDecomposition","LayerHeroBag","LayerHeroLevelUp","LayerOneKeySynthesisDisplay","PanelPopBreach","LayerRuneBag","LayerRuneDetails","LayerRuneMain","LayerRuneReplace","LayerRuneSynthesis","LayerRuneSynthesisDisplay","LayerEquipSynthesis","LayerItemDetail","LayerMain","LayerMainAnimation","LayerMainMenu","LayerMainResources","LayerSynthesisDisplay","TabHero","CtrlXiulian","GObjActivityList","GObjEntrance","GObjMonthCard","LayerBossNodeReconnect","LayerBreach","LayerBuySta","LayerChapterReward","LayerChapterSelect","LayerHeroUnlock","LayerMail","LayerMailVerbose","LayerMainStaConsumeAnimation","LayerMonthCard","LayerXiulianBag","LayerXiulianOnHook","LayerXiulianQuick","LayerCustomerService","LayerGiftPackage","LayerLogoutTips","LayerSetting","LayerShare","TabXiulian","LayerXiulianTask","TabAchieveTask","TabDayTask","TabWeekTask","ConstFiends","CtrlFriends","GObjFriendInformation","LayerAddFriend","LayerContacts","TabFriends","TabFriendsApply","TabFriendsBlack","TabFriendsReceive","CtrlMall","LayerMallChestDetails","MallModuleBase","MallModuleChapterGift","MallModuleDailyShop","MallModuleGloden","MallModuleLuckDraw","MallModuleRecharge","MallModuleSEquip","TabMall","LayerMallDrawDisplay","LayerMallLuckyDrawDisplay","CtrlNotice","LayerNotice","CtrlRole","LayerInformation","LayerInformationTips","ConstSDK","SDKInterface","SDKMgr","BaseSDKComponent","BaseSDKObject","LayerSpecialGift","CtrlSystem","LayerSystemOpen","CommonUtlis","PanelUseDiamondTips","PorcessTimeline","UIDGenerator","AppGloaderEx","FguiExtendMgr","GObjGoods","GObjMessagePop","GObjPopupFrame","GObjProgressBox","GObjRD","GameState","GameStateMgr","GameStateLogin","GameStateRunning","GameStateStart","ModelActivity","ModelEveryDaySignIn","ModelHangling","ModelAttr","ModelEquipSynthesis","ModelHero","ModelIcon","ModelLuckyCat","ModelML","ModelBehavior","ModelMgr","ModelSevenDayChallenge","ModelNewPlayerSign","ModelSta","ModelSystem","ModelBattle","ModelBox","ModelBreach","ModelChapter","ModelDayWeekMonthGift","ModelExpr","RDConsumablesBag","RDGoodsBagNewBase","RDPropBag","RDRuneBag","RDXiuLianBag","RDFriends","RDFriendsApply","RDFriendsReceive","RDClientSet","RDDailyShop","RDGloden","RDLuckDraw","RDMall","RDSEquip","RDBreach","RDChapterRewards","RDInformation","RDLuckyCat","RDXiulianOnHook","RDAchievementRewards","RDDailyRewards","RDDayWeekMonthGift","RDEveryDaySignIn","RDHeroRewards","RDMonthCard","RDServerBase","RDWeeklyRewards","RDXiulianMail","RDDailyFuben","RDGoldFuben","RDEquipSynthesis","RDHasBattleEquip","RDRuneSynthesis","RDActivityCenter","RDFund","RDNewPlayerSignIn","RDSevenDayChallenge","VarChapterLiveTime","VarClose","VarEquipNumber","VarFinishChapter","VarFirstRechargeState","VarFundVisible","VarHasChapterReward","VarHasHeroOrEquip","VarHasLuckyCat","VarHasShareType","VarHasSpecialGift","VarNotTishen","VarOpen","VarRoleLevel","ModelFriends","ModelFuben","ModelFund","ModelEquip","ModelGoods","ModelGoodsBag","ModelRune","ModelGuide","ModelHead","ModelJump","ModelAccount","ModelMail","ModelMall","ModelMallChapterGift","ModelMallDailyShop","ModelMallGloden","ModelMallLuckDraw","ModelMallRecharge","ModelMallSEquip","ModelMap","ModelMonthCard","ModelPayChannel","BuyPayObj","DrawPayObj","ModelPay","PayObj","ModelGameConfig","ModelLevel","ModelPlayer","ModelPrefab","AppCustomData","AppCustomInfo","IPublicData","ModelPublicData","ModelRole","ModelServer","SubServerDefault","SubServerHandler","SubServerWX","ModelSkill","ModelTask","ModelTime","VOApplyFirend","VOBlackFriend","VOFirend","Goods","VOEquip","VOItem","VORune","ModelVO","VOActivity","VOChapter","VOFuben","VOHero","VOLuckyCat","VOMonthCard","VORole","VOServerRedDot","VOSpecialGift","VO","VOBag","VOBagSubset","GameLayer","GameLayerMain","GamePanel","GameScene","GameTab","GameUIUtil","BL_LayerMain","SG_SubStateLightning","SG_SubStateLightningSuper","SG_LayerBatterCamerEffect","SG_LayerSelectUpgrade","SG_LayerSettle","SG_LayerMain","SG_MallModuleGloden","SG_MallModuleRecharge","SG_ModelRune","CacheMgrGen","CmdInterface","RefBase","RefEnum","RequestActivityMsg","RequestBattleMsg","RequestBreachMsg","RequestBuyStaMsg","RequestCardMsg","RequestChapterMsg","RequestCodeMsg","RequestDayWeekMonthGiftMsg","RequestEquipMsg","RequestEveryDaySignMsg","RequestFirstRechargeMsg","RequestFriendsMsg","RequestFuBenMsg","RequestFundMsg","RequestGuideMsg","RequestHallMsg","RequestHangMsg","RequestHeroMsg","RequestItemMsg","RequestMailMsg","RequestMallMsg","RequestRankMsg","RequestRedDotMsg","RequestRoleMsg","RequestRuneMsg","RequestShareMsg","RequestSystemMsg","RequestTaskMsg","CacheMgr","Net","NetMgr","newScreenAdapter","Ref","RefBattleBoxDropPlan","RefBattleBullet","RefBattleBulletTagCollision","RefBattleChestRewardRef","RefBattleDropConfig","RefBattleDropPlan","RefBattleMonster","RefBattleMonsterBehavior","RefBattleSkill","RefBattleSkillChest","RefBattleSkillEvolution","RefBattleSkillLevel","RefBattleSkillMonster","RefBattleSkillTypeMonster","RefBattleStatusIcon","RefBattleSupply","RefBattleSupplyLevel","RefBattleWaveType","RefBuff","RefBuffCarrier","RefChapterMonsterStrong","RefFuben","RefSkillGroup","RefSkillLuncher","RefWaveNum","RefWrap","RefroleAttribute","CustomListWrap","MathUtil","OnOff","OnOffBattleParams","OnOffEffectWeakening","OnOffJoystick","OnOffLog","OnOffMgr","OnOffMusic","OnOffSound","PrefabMgr","ServerTime","TimeUtil"]);